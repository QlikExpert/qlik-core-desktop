/*!
 * sense-client@6.105.4
 * 
 * Copyright(C) 2019 Qlik International AB
 * All Rights Reserved
 * 
 */
(window["qJsonp"]=window["qJsonp"]||[]).push([[29],{1488:function(e,n,t){"use strict";var i,a;!(i=[t(117)],a=function(e){return["standardSelectDialogService","connectionId",function(n,t){var i={getConnectionInfo:function n(){return e.currentApp.getDatabaseInfo({qConnectionId:t}).then(function(e){return{dbusage:a(e.qInfo.qDBUsage),ownerusage:a(e.qInfo.qOwnerUsage),dbfirst:a(e.qInfo.qDBFirst),specialchars:e.qInfo.qSpecialChars,dbseparator:e.qInfo.qDBSeparator,defaultdatabase:e.qInfo.qDefaultDatabase,ownerseparator:e.qInfo.qOwnerSeparator,quotesuffix:e.qInfo.qQuoteSuffix||"",quoteprefix:e.qInfo.qQuotePreffix||e.qInfo.qQuotePrefix||"",dbmsname:e.qInfo.qDBMSName,keywords:e.qInfo.qKeywords}},function(e){e.isHandled=true;return{dbusage:false,ownerusage:false,dbfirst:false,specialchars:"",dbseparator:"",defaultdatabase:"",ownerseparator:"",quotesuffix:"",quoteprefix:"",dbmsname:"",keywords:""}})},getDatabases:function n(){return e.currentApp.getDatabases({qConnectionId:t}).then(function(e){return e.qDatabases},function(e){e.isHandled=true;return[]})},getOwners:function n(i){return e.currentApp.getDatabaseOwners({qConnectionId:t,qDatabase:i}).then(function(e){return e.qOwners},function(e){e.isHandled=true;return[]})},getTables:function n(i,a){return e.currentApp.getDatabaseTables({qConnectionId:t,qDatabase:i,qOwner:a}).then(function(e){return e.qTables},function(e){e.isHandled=true;return[]})},getFields:function n(i,a,o){return e.currentApp.getDatabaseTableFields({qConnectionId:t,qDatabase:i,qOwner:a,qTable:o}).then(function(e){return e.qFields},function(e){e.isHandled=true;return[]})},getPreview:function n(i,a,o,s){var c={qType:0,qWherePredicate:""};s&&s.filterInfo&&s.filterInfo.filterClause&&(c={qType:1,qWherePredicate:s.filterInfo.filterClause});return e.currentApp.getDatabaseTablePreview({qConnectionId:t,qDatabase:i,qOwner:a,qTable:o,qConditions:c}).then(function(e){e.qRowCount&&e.qPreview&&(e.qPreview.sourceRowCount=e.qRowCount);return e.qPreview},function(e){e.isHandled=true;return[]})}};n.showStandardDialog(i,{showTablePanel:true});function a(e){return!(!e||"false"===e)}}]}.apply(n,i),void 0!==a&&(e.exports=a))},1489:function(e,n,t){"use strict";var i,a;!(i=[t(117)],a=function(e){function n(e){return!(!e||"false"===e)}function t(t,i){function a(){return e.currentApp.getDatabaseInfo({qConnectionId:t}).then(function(e){return{dbusage:n(e.qInfo.qDBUsage),ownerusage:n(e.qInfo.qOwnerUsage),dbfirst:n(e.qInfo.qDBFirst),specialchars:e.qInfo.qSpecialChars,dbseparator:e.qInfo.qDBSeparator,defaultdatabase:e.qInfo.qDefaultDatabase,ownerseparator:e.qInfo.qOwnerSeparator,quotesuffix:e.qInfo.qQuoteSuffix||"",quoteprefix:e.qInfo.qQuotePreffix||e.qInfo.qQuotePrefix||"",dbmsname:e.qInfo.qDBMSName,keywords:e.qInfo.qKeywords}},function(e){e.isHandled=true;return{dbusage:false,ownerusage:false,dbfirst:false,specialchars:"",dbseparator:"",defaultdatabase:"",ownerseparator:"",quotesuffix:"",quoteprefix:"",dbmsname:"",keywords:""}})}function o(){return e.currentApp.getDatabases({qConnectionId:t}).then(function(e){return e.qDatabases},function(e){e.isHandled=true;return[]})}function s(n){return e.currentApp.getDatabaseOwners({qConnectionId:t,qDatabase:n}).then(function(e){return e.qOwners},function(e){e.isHandled=true;return[]})}function c(n,i){return e.currentApp.getDatabaseTables({qConnectionId:t,qDatabase:n,qOwner:i}).then(function(e){return e.qTables},function(e){e.isHandled=true;return[]})}function r(n,i,a){return e.currentApp.getDatabaseTableFields({qConnectionId:t,qDatabase:n,qOwner:i,qTable:a}).then(function(e){return e.qFields},function(e){e.isHandled=true;return[]})}function d(n,i,a,o){var s={qType:0,qWherePredicate:""};o&&o.filterInfo&&o.filterInfo.filterClause&&(s={qType:1,qWherePredicate:o.filterInfo.filterClause});return e.currentApp.getDatabaseTablePreview({qConnectionId:t,qDatabase:n,qOwner:i,qTable:a,qConditions:s}).then(function(e){e.qRowCount&&e.qPreview&&(e.qPreview.sourceRowCount=e.qRowCount);return e.qPreview},function(e){e.isHandled=true;return[]})}var l={getConnectionInfo:a,getDatabases:o,getOwners:s,getTables:c,getFields:r,getPreview:d,selectOptions:{tableModelToEdit:i,showTablePanel:true}};return l}return{createNativeDatabaserProvider:t}}.apply(n,i),void 0!==a&&(e.exports=a))},1490:function(e,n,t){"use strict";var i,a;!(i=[t(2029),t(1488),t(2031)],a=function(e,n,t){return{connectDialog:e,selectDialog:n,connectorMain:t}}.apply(n,i),void 0!==a&&(e.exports=a))},2029:function(e,n,t){"use strict";var i,a;!(i=[t(91),t(2030),t(118),t(117)],a=function(e,n,t,i){return{template:n,controller:["$scope","serverside","input","$timeout",function(n,a,o,s){n.connectionInstance={id:o.instanceId,isEdit:o.editMode,name:"",typeName:"",is32Bit:false,databaseName:"",selectedDatabase:"",selectedDataprovider:"",serverName:"",serverOptions:{},connectionInputOK:false,connectionTestOK:false};n.testResultIcon="";n.resultColorTheme="";n.isLoading=true;n.initializing=false;n.previousServerName="";n.nameChangedAtLeastOnce=false;n.databases=[];n.databasesLoaded=false;n.serverOK=false;n.rawConnectionString="";n.providerCredentialSettings={"Microsoft.ACE.OLEDB.12.0":{integrated:false,specific:true},MSDASQL:{integrated:false,specific:true},"MSDASQL Enumerator":{integrated:false,specific:true},MSOLAP:{integrated:true,specific:true},SQLOLEDB:{integrated:true,specific:true},MSDataShape:{integrated:true,specific:true},SQLNCLI11:{integrated:true,specific:true},"SQLNCLI Enumerator":{integrated:true,specific:true},ADsDSOObject:{integrated:true,specific:true},SQLNCLI:{integrated:true,specific:true},"SQLNCLI11 Enumerator":{integrated:true,specific:true},"SQLOLEDB Enumerator":{integrated:true,specific:true},MSDAOSP:{integrated:false,specific:false},MSIDXS:{integrated:true,specific:false},"OraOLEDB.Oracle":{integrated:false,specific:true},MSDAORA:{integrated:false,specific:true}};n.maxConnectionNameLength=t.MAX_CONNECTION_NAME_LENGTH-a.getUsernameSuffix().length;var c="";function r(){i.global.getOleDbProviders().then(function(e){for(var t=0;t<e.qOleDbProviders.length;t++)e.qOleDbProviders[t].qBit32&&(e.qOleDbProviders[t].qDescription=e.qOleDbProviders[t].qDescription+"(32-bit)");n.datasources=e.qOleDbProviders;if(n.connectionInstance.isEdit){n.initializing=true;a.getConnection(n.connectionInstance.id).then(function(e){n.isLoading=false;n.connectionInstance.name=e.qConnection.qName;n.rawConnectionString=e.qConnection.qConnectionString;g(e.qConnection.qConnectionString);v(e.qConnection.qConnectionString);c=m(e.qConnection.qConnectionString)})}else{n.connectionInstance.serverOptions={security:"specific",username:"",password:""};n.isLoading=false}})}n.getDatabases=function(){n.serverOK=false;n.isLoading=true;if(""===n.serverName){n.databases=[];n.connectionInstance.selectedDatabase=null;n.isLoading=false}else n.connectionInstance.selectedDataprovider&&i.global.getDatabasesFromConnectionString({qConnectionString:f(true)}).then(function(e){n.databasesLoaded=true;n.isLoading=false;if(e){n.databases=e.qDatabases;n.serverOK=true}},function(t){t.code=void 0;t.message=e.get("scripteditor.dataconnectors.connecterror");n.databasesLoaded=false;n.isLoading=false;n.serverOK=false});n.previousServerName=n.connectionInstance.serverName};n.isDatasourceListDisabled=function(){return n.isLoading};n.isSpecificSecurity=function(){return!!n.connectionInstance.serverOptions&&"specific"===n.connectionInstance.serverOptions.security};n.isTestDisabled=function(){return!n.connectionInstance.isEdit&&(n.isLoading||!n.connectionInstance.selectedDataprovider||!n.connectionInstance.name||!n.connectionInstance.serverName||n.connectionInstance.serverName.length<1)};n.isOkDisabled=function(){return n.connectionInstance.isEdit?n.isLoading:n.isLoading||!n.connectionInstance.selectedDataprovider||!n.connectionInstance.name||!t.isValidConnectionName(n.connectionInstance.name)||!n.connectionInstance.serverName||n.connectionInstance.serverName.length<1};n.isLoadDisabled=function(){return""===n.connectionInstance.serverName||n.isLoading||!n.connectionInstance.selectedDataprovider};n.isNameInvalid=function(){return n.connectionInstance.name?!t.isValidConnectionName(n.connectionInstance.name):n.nameChangedAtLeastOnce};n.$watch("connectionInstance.serverOptions.security",function(e,t){e!==t&&n.resetConnectionTest()});n.$watch("connectionInstance.name",function(){n.showCreateConnectionError=false;if(""!==n.connectionInstance.name&&n.isNameInvalid()){n.errorContent=e.get("Common.InvalidCharacters");n.showCreateConnectionError=true}});n.allowNameInput=function(){return n.connectionInstance.isEdit||""===n.connectionInstance.selectedDataprovider};n.hasSecurityOption=function(e){if(n.connectionInstance.selectedDataprovider&&""!==n.connectionInstance.selectedDataprovider){var t=n.providerCredentialSettings[n.connectionInstance.selectedDataprovider.qName];return!t||t[e]}return false};n.$watch("connectionInstance.selectedDataprovider",function(e,t){if(e===t)return;n.connectionInstance.selectedDataprovider=e;n.resetConnectionTest();if(n.connectionInstance.selectedDataprovider){n.databasesLoaded=false;n.databases=[];n.connectionInstance.dataconnectorTypeName=n.connectionInstance.selectedDataprovider.qName;n.is32Bit=n.connectionInstance.selectedDataprovider.qBit32;if(!n.initializing){n.hasSecurityOption("integrated")&&!n.hasSecurityOption("specific")?n.connectionInstance.serverOptions.security="integrated":n.connectionInstance.serverOptions.security="specific";n.rawConnectionString=u()}}n.initializing&&s(function(){n.initializing=false})});n.$watch("connectionInstance.serverName",function(e,t){if(e===t)return;n.connectionInstance.serverName=e;n.resetConnectionTest();n.connectionInstance.isEdit||n.nameChangedAtLeastOnce?!n.initializing&&n.connectionInstance.isEdit&&(n.rawConnectionString=u()):n.connectionInstance.name=n.connectionInstance.serverName.replace(/[\\/:*\t?"'<>|]/g,"-")});n.$watch("connectionInstance.selectedDatabase",function(){n.connectionInstance.selectedDatabase&&(n.connectionInstance.databaseName=n.connectionInstance.selectedDatabase.qName)});n.onNameChanged=function(){n.nameChangedAtLeastOnce=true};n.handleErrors=function(e){n.errorContent=a.getErrorContent(e);n.showCreateConnectionError=true;e.isHandled=true;n.isLoading=false};n.onOKClicked=function(){if(!n.isOkDisabled()){n.isLoading=true;n.resetConnectionTest();if(n.connectionInstance.isEdit){var e=""!==n.connectionInstance.serverOptions.username&&""!==n.connectionInstance.serverOptions.password;a.modifyConnection(n.connectionInstance.id,n.connectionInstance.name,n.rawConnectionString,"OLEDB",e,n.connectionInstance.serverOptions.username,n.connectionInstance.serverOptions.password).then(function(e){n.isLoading=false;e&&n.destroyComponent()},n.handleErrors)}else a.createNewConnectionAPI(n.connectionInstance.name,f(),"OLEDB",n.connectionInstance.serverOptions.username,n.connectionInstance.serverOptions.password).then(function(e){n.isLoading=false;e&&n.destroyComponent()},n.handleErrors)}};function d(){n.isLoading=false;n.connectionTestMessage=e.get("scripteditor.dataconnectors.testconnection.failed");n.testResultIcon="warning-triangle";n.resultColorTheme="test-failed"}n.onTestClicked=function(){n.isLoading=true;n.resetConnectionTest();i.global.isValidConnectionString({qConnectionString:f(true)}).then(function(t){if(t){n.isLoading=false;n.connectionTestMessage=e.get("scripteditor.dataconnectors.testconnection.succeeded");n.testResultIcon="tick";n.resultColorTheme="test-ok"}else d()},function(e){e.isHandled=true;d()})};n.onCancelClicked=function(){n.isLoading||n.destroyComponent()};n.resetConnectionTest=function(){n.connectionTestMessage="";n.testResultIcon="";n.showCreateConnectionError=false};function l(e){if(n.connectionInstance.serverOptions.security||n.connectionInstance.serverOptions.username){var t=n.connectionInstance.serverOptions.username?"'"+n.connectionInstance.serverOptions.username+"'":"";var i=n.connectionInstance.serverOptions.password?"'"+n.connectionInstance.serverOptions.password+"'":"";return"integrated"===n.connectionInstance.serverOptions.security?"Integrated Security=SSPI;":e?"User Id="+t+";Password="+i+";":""}return""}function u(){var e=f(),n;n=e.substring(0,e.length-1)+c+"]";return n}function f(e){var t=n.connectionInstance.selectedDataprovider.qBit32?"CONNECT32":"CONNECT";var i=l(e);var a="Data Source="+n.connectionInstance.serverName+";";var o=""!==n.connectionInstance.databaseName?"Initial Catalog="+n.connectionInstance.databaseName+";":"";var s="OLEDB "+t+" TO [Provider="+n.connectionInstance.dataconnectorTypeName+";"+i+a+o+"]";n.connectionInstance.isEdit&&(s=-1!==n.rawConnectionString.indexOf("Integrated Security=SSPI")?n.rawConnectionString:n.rawConnectionString.slice(0,n.rawConnectionString.lastIndexOf(";"))+";"+i+"]");return s}function g(e){var i=t.getValueFromConnectionString(e,"provider"),a=t.getValueFromConnectionString(e,"data source"),o=-1!==e.toLowerCase().indexOf("oledb connect32");n.connectionInstance.serverName=a;p(i,o)}function p(e,t){for(var i=0;i<n.datasources.length;i++)if(n.datasources[i].qName===e&&(t===n.datasources[i].qBit32||!n.datasources[i].qBit32)){n.connectionInstance.selectedDataprovider=n.datasources[i];return}}function v(e){var i=t.getValueFromConnectionString(e,"integrated security");n.connectionInstance.serverOptions=""!==i?{security:"integrated",username:"",password:""}:{security:"specific",username:"",password:""}}function m(e){var n=t.tokenizeConnectionString(e),i="";n.forEach(function(e){"provider"!==e.key.toLowerCase()&&"data source"!==e.key.toLowerCase()&&"integrated security"!==e.key.toLowerCase()&&(i+=e.key+"="+e.value+";")});return i}r()}]}}.apply(n,i),void 0!==a&&(e.exports=a))},2030:function(e,n){e.exports='<div class="qui-modalbackground oledbconnectdialogcontainer">\n\t<div class="qui-delayedModal oledbconnectdialog" tabindex="-1" qv-global-enter="onOKClicked()" qv-global-escape="onCancelClicked()">\n\t\t<div class="loading-screen" ng-show="isLoading">\n\t\t\t<div class="qv-loader"></div>\n\t\t</div>\n\t\t<header class="dm-header" q-translation="{{connectionInstance.isEdit ? \'scripteditor.dataconnectors.oledbconnect.edittitle\' : \'scripteditor.dataconnectors.oledbconnect.title\'}}"></header>\n\t\t<main class="dm-main">\n\t\t\t<label for="rawConnectionString" q-translation="scripteditor.dataconnectors.connectionstring" ng-hide="!connectionInstance.isEdit" maxlength="1000">Connection string</label>\n\t\t\t<input class="lui-input oledbtextfield" data-size="tiny" name="rawConnectionString" id="rawConnectionString" type="text" ng-hide="!connectionInstance.isEdit" ng-model="rawConnectionString" ng-disabled="isLoading" ng-change="onNameChanged()" maxlength="1000">\n\n\t\t\t<div ng-hide="connectionInstance.isEdit">\n\t\t\t\t<label translate="title" q-translation="scripteditor.dataconnectors.provider">Provider</label>\n\t\t\t\t<lui-select class="datasource-list" x-model="connectionInstance.selectedDataprovider" x-disabled="isLoading" x-options="datasource.qDescription for datasource in datasources" tid="oleDbProvider">\n\t\t\t\t\t<option value="" q-translation="scripteditor.dataconnectors.selectprovider"></option>\n\t\t\t\t</lui-select>\n\t\t\t</div>\n\n\t\t\t<div class="serversection">\n\t\t\t\t<div ng-hide="connectionInstance.isEdit">\n\t\t\t\t\t<label translate="title" q-translation="scripteditor.dataconnectors.servername">Server</label>\n\t\t\t\t\t<input class="lui-input oledbtextfield" data-size="tiny" name="connectionInstance.serverName" type="text" ng-model="connectionInstance.serverName" ng-disabled="isLoading || connectionInstance.selectedDataprovider == \'\'" tid="oleDbServerName">\n\n\t\t\t\t\t<div class="choosesecuritysection">\n\t\t\t\t\t\t<lui-radiobutton tid="integrated-security" x-name="choosesecuritysection" x-value="integrated" x-model="connectionInstance.serverOptions.security" x-disabled="!hasSecurityOption(\'integrated\')">{{ \'scripteditor.dataconnetors.integratedsecurity\' | translate }}</lui-radiobutton>\n\t\t\t\t\t\t<lui-radiobutton tid="specific-security" x-name="choosesecuritysection" x-value="specific" x-model="connectionInstance.serverOptions.security" x-disabled="!hasSecurityOption(\'specific\')">{{ \'scripteditor.dataconnetors.specificsecurity\' | translate }}</lui-radiobutton>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="specificsecuritysection">\n\t\t\t\t\t<label translate="title" q-translation="Common.Username">Username</label>\n\t\t\t\t\t<input class="lui-input oledbtextfield" data-size="tiny" tid="6d9333" name="userName" type="text" ng-model="connectionInstance.serverOptions.username" ng-trim="false" ng-change="resetConnectionTest()" ng-disabled="isLoading || (!connectionInstance.isEdit && !isSpecificSecurity())" maxlength="200">\n\t\t\t\t\t<label translate="title" q-translation="Common.Password">Password</label>\n\t\t\t\t\t<input class="lui-input oledbtextfield" data-size="tiny" tid="6d9332" name="password" type="password" ng-model="connectionInstance.serverOptions.password" ng-trim="false" ng-change="resetConnectionTest()" ng-disabled="isLoading || (!connectionInstance.isEdit && !isSpecificSecurity())" maxlength="200">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<span class="test-result-icon {{resultColorTheme}} lui-icon lui-icon--{{testResultIcon}}"></span><span>{{connectionTestMessage}}</span>\n\t\t\t\t<button class="lui-button to-the-right" ng-click="$event.preventDefault(); onTestClicked()" q-translation="scripteditor.dataconnectors.testconnection" ng-disabled="isTestDisabled() || isLoading" tid="2e6841"></button>\n\t\t\t</div>\n\t\t\t<div class="fullwidth-div">\n\t\t\t\t<label translate="title" ng-hide="connectionInstance.isEdit" q-translation="scripteditor.dataconnectors.database">Database</label>\n\n\t\t\t\t<div ng-hide="connectionInstance.isEdit">\n\t\t\t\t\t<button class="lui-button load-button" ng-click="getDatabases()" ng-disabled="isLoadDisabled()" q-translation="scripteditor.dataconnectors.load" tid="loadDefaultDatabases">Load</button>\n\t\t\t\t\t<lui-select class="database-list" x-model="connectionInstance.selectedDatabase" x-disabled="!databasesLoaded" x-options="database.qName for database in databases" tid="defaultDatabase">\n\t\t\t\t\t\t<option value="" q-translation="scripteditor.dataconnectors.selectdatabase"></option>\n\t\t\t\t\t</lui-select>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<label for="dataconnectorName" q-translation="Common.Name" class="name"></label>\n\t\t\t<input class="lui-input oledbtextfield" data-size="tiny" tid="6e9333" name="dataconnectorName" id="dataconnectorName" type="text" ng-enabled="allowNameInput()" ng-model="connectionInstance.name" ng-disabled="isLoading" invalid="{{isNameInvalid()}}" ng-change="onNameChanged()" maxlength="{{maxConnectionNameLength}}">\n\t\t\t<label ng-style="{visibility: showCreateConnectionError && \'visible\' || \'hidden\'}" class="errorlabel">{{errorContent}}</label>\n\n\t\t</main>\n\t\t<footer class="dm-footer">\n\t\t\t<lui-button x-variant="inverse" ng-click="$event.preventDefault(); onCancelClicked()" ng-disabled="isLoading" q-translation="Common.Cancel" tid="2e6840"></lui-button>\n\t\t\t<lui-button x-variant="inverse" ng-click="$event.preventDefault(); onOKClicked()" ng-disabled="isOkDisabled()" q-translation="{{connectionInstance.isEdit ? \'Common.Save\' : \'Common.Create\'}}" tid="saveOleDbConnection"></lui-button>\n\t\t</footer>\n\t</div>\n</div>\n'},2031:function(e,n,t){"use strict";var i,a;!(i=[t(2032),t(2034),t(91)],a=function(e,n,t){function i(){var i=[{id:"oledb",category:"database",name:t.get("scripteditor.dataconnectors.OLEDB"),initialConnectStep:e}];function a(){return n}var o={entrypoints:i,getInitialSelectStep:a};return o}return{create:i}}.apply(n,i),void 0!==a&&(e.exports=a))},2032:function(e,n,t){"use strict";var i,a;!(i=[t(91),t(2033),t(118),t(117)],a=function(e,n,t,i){return{template:n,scope:{title:"=",serverside:"=",continueWithNewConnection:"=",qvDialogContext:"="},controller:["$scope","serverside","input","$timeout",function(n,a,o,s){n.connectionInstance={id:o.instanceId,isEdit:o.editMode,name:"",typeName:"",is32Bit:false,databaseName:"",selectedDatabase:"",selectedDataprovider:"",serverName:"",serverOptions:{},connectionInputOK:false,connectionTestOK:false};n.qvDialogContext.title=e.get("scripteditor.dataconnectors.oledbconnect.title");n.qvDialogContext.nextDisabled=l;n.qvDialogContext.size="S";n.qvDialogContext.customCss={};n.qvDialogContext.cstmClass={"native-oledb":true};n.testResultIcon="";n.resultColorTheme="";n.isLoading=true;n.initializing=false;n.previousServerName="";n.nameChangedAtLeastOnce=false;n.databases=[];n.databasesLoaded=false;n.serverOK=false;n.rawConnectionString="";n.providerCredentialSettings={"Microsoft.ACE.OLEDB.12.0":{integrated:false,specific:true},MSDASQL:{integrated:false,specific:true},"MSDASQL Enumerator":{integrated:false,specific:true},MSOLAP:{integrated:true,specific:true},SQLOLEDB:{integrated:true,specific:true},MSDataShape:{integrated:true,specific:true},SQLNCLI11:{integrated:true,specific:true},"SQLNCLI Enumerator":{integrated:true,specific:true},ADsDSOObject:{integrated:true,specific:true},SQLNCLI:{integrated:true,specific:true},"SQLNCLI11 Enumerator":{integrated:true,specific:true},"SQLOLEDB Enumerator":{integrated:true,specific:true},MSDAOSP:{integrated:false,specific:false},MSIDXS:{integrated:true,specific:false},"OraOLEDB.Oracle":{integrated:false,specific:true},MSDAORA:{integrated:false,specific:true}};n.maxConnectionNameLength=t.MAX_CONNECTION_NAME_LENGTH-a.getUsernameSuffix().length;var c="";function r(){i.global.getOleDbProviders().then(function(e){for(var t=0;t<e.qOleDbProviders.length;t++)e.qOleDbProviders[t].qBit32&&(e.qOleDbProviders[t].qDescription=e.qOleDbProviders[t].qDescription+"(32-bit)");n.datasources=e.qOleDbProviders;if(n.connectionInstance.isEdit){n.initializing=true;a.getConnection(n.connectionInstance.id).then(function(e){n.isLoading=false;n.connectionInstance.name=e.qConnection.qName;n.rawConnectionString=e.qConnection.qConnectionString;p(e.qConnection.qConnectionString);m(e.qConnection.qConnectionString);c=I(e.qConnection.qConnectionString)})}else{n.connectionInstance.serverOptions={security:"specific",username:"",password:""};n.isLoading=false}})}n.getDatabases=function(){n.serverOK=false;n.isLoading=true;if(""===n.serverName){n.databases=[];n.connectionInstance.selectedDatabase=null;n.isLoading=false}else n.connectionInstance.selectedDataprovider&&i.global.getDatabasesFromConnectionString({qConnectionString:g(true)}).then(function(e){n.databasesLoaded=true;n.isLoading=false;if(e){n.databases=e.qDatabases;n.serverOK=true}},function(t){t.code=void 0;t.message=e.get("scripteditor.dataconnectors.connecterror");n.databasesLoaded=false;n.isLoading=false;n.serverOK=false});n.previousServerName=n.connectionInstance.serverName};n.isDatasourceListDisabled=function(){return n.isLoading};n.isSpecificSecurity=function(){return!!n.connectionInstance.serverOptions&&"specific"===n.connectionInstance.serverOptions.security};n.isTestDisabled=function(){return!n.connectionInstance.isEdit&&(n.isLoading||!n.connectionInstance.selectedDataprovider||!n.connectionInstance.name||!n.connectionInstance.serverName||n.connectionInstance.serverName.length<1)};n.isLoadDisabled=function(){return""===n.connectionInstance.serverName||n.isLoading||!n.connectionInstance.selectedDataprovider};n.isNameInvalid=function(){return n.connectionInstance.name?!t.isValidConnectionName(n.connectionInstance.name):n.nameChangedAtLeastOnce};n.$watch("connectionInstance.name",function(){n.showCreateConnectionError=false;if(""!==n.connectionInstance.name&&n.isNameInvalid()){n.errorContent=e.get("Common.InvalidCharacters");n.showCreateConnectionError=true}});n.allowNameInput=function(){return n.connectionInstance.isEdit||""===n.connectionInstance.selectedDataprovider};n.hasSecurityOption=function(e){if(n.connectionInstance.selectedDataprovider&&""!==n.connectionInstance.selectedDataprovider){var t=n.providerCredentialSettings[n.connectionInstance.selectedDataprovider.qName];return!t||t[e]}return false};n.$watch("connectionInstance.serverOptions.security",function(e,t){e!==t&&n.resetConnectionTest()});n.$watch("connectionInstance.selectedDataprovider",function(e,t){if(e===t)return;n.connectionInstance.selectedDataprovider=e;n.resetConnectionTest();if(n.connectionInstance.selectedDataprovider){n.databasesLoaded=false;n.databases=[];n.connectionInstance.dataconnectorTypeName=n.connectionInstance.selectedDataprovider.qName;n.is32Bit=n.connectionInstance.selectedDataprovider.qBit32;if(!n.initializing){n.hasSecurityOption("integrated")&&!n.hasSecurityOption("specific")?n.connectionInstance.serverOptions.security="integrated":n.connectionInstance.serverOptions.security="specific";n.rawConnectionString=f()}}n.initializing&&s(function(){n.initializing=false})});n.$watch("connectionInstance.serverName",function(e,t){if(e===t)return;n.connectionInstance.serverName=e;n.resetConnectionTest();n.connectionInstance.isEdit||n.nameChangedAtLeastOnce?!n.initializing&&n.connectionInstance.isEdit&&(n.rawConnectionString=f()):n.connectionInstance.name=n.connectionInstance.serverName.replace(/[\\/:*\t?"'<>|]/g,"-")});n.$watch("connectionInstance.selectedDatabase",function(){if(n.connectionInstance.selectedDatabase){n.resetConnectionTest();n.connectionInstance.databaseName=n.connectionInstance.selectedDatabase.qName}});n.$watch("connectionInstance.isEdit",function(e){function t(e,n){return{"max-height":e,"min-height":n||e}}e&&(n.qvDialogContext.customCss=t("400px"))});n.onNameChanged=function(){n.nameChangedAtLeastOnce=true};n.handleErrors=function(e){n.errorContent=a.getErrorContent(e);n.showCreateConnectionError=true;e.isHandled=true;n.isLoading=false};n.qvDialogContext.next=function(){if(!l()){n.isLoading=true;n.resetConnectionTest();if(n.connectionInstance.isEdit){var e=""!==n.connectionInstance.serverOptions.username&&""!==n.connectionInstance.serverOptions.password;a.modifyConnection(n.connectionInstance.id,n.connectionInstance.name,n.rawConnectionString,"OLEDB",e,n.connectionInstance.serverOptions.username,n.connectionInstance.serverOptions.password).then(function(e){n.isLoading=false;e&&n.destroyComponent()},n.handleErrors)}else a.createNewConnectionAPI(n.connectionInstance.name,g(),"OLEDB",n.connectionInstance.serverOptions.username,n.connectionInstance.serverOptions.password).then(function(e){n.isLoading=false;e&&n.continueWithNewConnection({connectionName:n.connectionInstance.name})},n.handleErrors)}};function d(){n.isLoading=false;n.connectionTestMessage=e.get("scripteditor.dataconnectors.testconnection.failed");n.testResultIcon="warning-triangle";n.resultColorTheme="test-failed"}n.onTestClicked=function(){n.resetConnectionTest();n.isLoading=true;i.global.isValidConnectionString({qConnectionString:g(true)}).then(function(t){if(t){n.isLoading=false;n.connectionTestMessage=e.get("scripteditor.dataconnectors.testconnection.succeeded");n.testResultIcon="tick";n.resultColorTheme="test-ok"}else d()},function(e){e.isHandled=true;d()})};n.resetConnectionTest=function(){n.connectionTestMessage="";n.testResultIcon="";n.showCreateConnectionError=false};n.onCancelClicked=function(){n.isLoading||n.destroyComponent()};function l(){return n.connectionInstance.isEdit?n.isLoading:n.isLoading||!n.connectionInstance.selectedDataprovider||!n.connectionInstance.name||!t.isValidConnectionName(n.connectionInstance.name)||!n.connectionInstance.serverName||n.connectionInstance.serverName.length<1}function u(e){if(n.connectionInstance.serverOptions.security||n.connectionInstance.serverOptions.username){var t=n.connectionInstance.serverOptions.username?"'"+n.connectionInstance.serverOptions.username+"'":"";var i=n.connectionInstance.serverOptions.password?"'"+n.connectionInstance.serverOptions.password+"'":"";return"integrated"===n.connectionInstance.serverOptions.security?"Integrated Security=SSPI;":e?"User Id="+t+";Password="+i+";":""}return""}function f(){var e=g(),n;n=e.substring(0,e.length-1)+c+"]";return n}function g(e){var t=n.connectionInstance.selectedDataprovider.qBit32?"CONNECT32":"CONNECT";var i=u(e);var a="Data Source="+n.connectionInstance.serverName+";";var o=""!==n.connectionInstance.databaseName?"Initial Catalog="+n.connectionInstance.databaseName+";":"";var s="OLEDB "+t+" TO [Provider="+n.connectionInstance.dataconnectorTypeName+";"+i+a+o+"]";n.connectionInstance.isEdit&&(s=-1!==n.rawConnectionString.indexOf("Integrated Security=SSPI")?n.rawConnectionString:n.rawConnectionString.slice(0,n.rawConnectionString.lastIndexOf(";"))+";"+i+"]");return s}function p(e){var i=t.getValueFromConnectionString(e,"provider"),a=t.getValueFromConnectionString(e,"data source"),o=-1!==e.toLowerCase().indexOf("oledb connect32");n.connectionInstance.serverName=a;v(i,o)}function v(e,t){for(var i=0;i<n.datasources.length;i++)if(n.datasources[i].qName===e&&(t===n.datasources[i].qBit32||!n.datasources[i].qBit32)){n.connectionInstance.selectedDataprovider=n.datasources[i];return}}function m(e){var i=t.getValueFromConnectionString(e,"integrated security");n.connectionInstance.serverOptions=""!==i?{security:"integrated",username:"",password:""}:{security:"specific",username:"",password:""}}function I(e){var n=t.tokenizeConnectionString(e),i="";n.forEach(function(e){"provider"!==e.key.toLowerCase()&&"data source"!==e.key.toLowerCase()&&"integrated security"!==e.key.toLowerCase()&&(i+=e.key+"="+e.value+";")});return i}r()}]}}.apply(n,i),void 0!==a&&(e.exports=a))},2033:function(e,n){e.exports='<div class="native-oledb-connector-connect">\n\t<div class="loading-screen" ng-show="isLoading">\n\t\t<div class="qv-loader"></div>\n\t</div>\n\t<main class="dm-main">\n\t\t<div class="flex-cont">\n\t\t\t<div ng-show="connectionInstance.isEdit" ng-class="{\'rawStr-edit\': connectionInstance.isEdit}">\n\t\t\t\t<label for="rawConnectionString" q-translation="scripteditor.dataconnectors.connectionstring" maxlength="1000">Connection string</label>\n\t\t\t\t<input class="lui-input oledbtextfield" data-size="tiny" name="rawConnectionString" id="rawConnectionString" type="text" ng-model="rawConnectionString" ng-disabled="isLoading" ng-change="onNameChanged()" maxlength="1000">\n\t\t\t</div>\n\n\t\t\t<div class="con-edit" ng-hide="connectionInstance.isEdit">\n\t\t\t\t<label translate="title" q-translation="scripteditor.dataconnectors.provider">Provider</label>\n\t\t\t\t<lui-select class="datasource-list" x-model="connectionInstance.selectedDataprovider" x-disabled="isLoading" x-options="datasource.qDescription for datasource in datasources" tid="oleDbProvider">\n\t\t\t\t\t<option value="" q-translation="scripteditor.dataconnectors.selectprovider"></option>\n\t\t\t\t</lui-select>\n\t\t\t</div>\n\n\t\t\t<div class="serversection">\n\t\t\t\t<div ng-hide="connectionInstance.isEdit">\n\t\t\t\t\t<label translate="title" q-translation="scripteditor.dataconnectors.servername">Server</label>\n\t\t\t\t\t<input class="lui-input oledbtextfield" data-size="tiny" name="connectionInstance.serverName" type="text" ng-model="connectionInstance.serverName" ng-disabled="isLoading || connectionInstance.selectedDataprovider == \'\'" tid="oleDbServerName">\n\n\t\t\t\t\t<div class="choosesecuritysection">\n\t\t\t\t\t\t<lui-radiobutton tid="integrated-security" x-name="choosesecuritysection" x-value="integrated" x-model="connectionInstance.serverOptions.security" x-disabled="isLoading || !hasSecurityOption(\'integrated\')">{{ \'scripteditor.dataconnetors.integratedsecurity\' | translate }}</lui-radiobutton>\n\t\t\t\t\t\t<lui-radiobutton tid="specific-security" x-name="choosesecuritysection" x-value="specific" x-model="connectionInstance.serverOptions.security" x-disabled="isLoading || !hasSecurityOption(\'specific\')">{{ \'scripteditor.dataconnetors.specificsecurity\' | translate }}</lui-radiobutton>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="specificsecuritysection">\n\t\t\t\t\t<label translate="title" q-translation="Common.Username">Username</label>\n\t\t\t\t\t<input class="lui-input oledbtextfield" data-size="tiny" tid="6d9333" name="userName" type="text" ng-model="connectionInstance.serverOptions.username" ng-trim="false" ng-change="resetConnectionTest()" ng-disabled="isLoading || (!connectionInstance.isEdit && !isSpecificSecurity())" maxlength="200">\n\t\t\t\t\t<label translate="title" q-translation="Common.Password">Password</label>\n\t\t\t\t\t<input class="lui-input oledbtextfield" data-size="tiny" tid="6d9332" name="password" type="password" ng-model="connectionInstance.serverOptions.password" ng-trim="false" ng-change="resetConnectionTest()" ng-disabled="isLoading || (!connectionInstance.isEdit && !isSpecificSecurity())" maxlength="200">\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="test-container">\n\t\t\t\t<span class="test-result-icon {{resultColorTheme}} lui-icon lui-icon--{{testResultIcon}}"></span><span>{{connectionTestMessage}}</span>\n\t\t\t\t<button class="lui-button tst-btn" ng-click="$event.preventDefault(); onTestClicked()" q-translation="scripteditor.dataconnectors.testconnection" ng-disabled="isTestDisabled() || isLoading" tid="2e6841"></button>\n\t\t\t</div>\n\n\t\t\t<div class="db-container">\n\t\t\t\t<label translate="title" ng-hide="connectionInstance.isEdit" q-translation="scripteditor.dataconnectors.database">Database</label>\n\n\t\t\t\t<div ng-hide="connectionInstance.isEdit">\n\t\t\t\t\t<button class="lui-button load-button" ng-click="getDatabases()" ng-disabled="isLoadDisabled()" q-translation="scripteditor.dataconnectors.load" tid="loadDefaultDatabases">Load</button>\n\t\t\t\t\t<lui-select class="database-list" x-model="connectionInstance.selectedDatabase" x-disabled="!databasesLoaded" x-options="database.qName for database in databases" tid="defaultDatabase">\n\t\t\t\t\t\t<option value="" q-translation="scripteditor.dataconnectors.selectdatabase"></option>\n\t\t\t\t\t</lui-select>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="conName" ng-class="{\'error\': showCreateConnectionError}">\n\t\t\t\t<label for="dataconnectorName" q-translation="Common.Name" class="name"></label>\n\t\t\t\t<input class="lui-input oledbtextfield" data-size="tiny" tid="6e9333" name="dataconnectorName" id="dataconnectorName" type="text" ng-enabled="allowNameInput()" ng-model="connectionInstance.name" ng-disabled="isLoading" invalid="{{isNameInvalid()}}" ng-change="onNameChanged()" maxlength="{{maxConnectionNameLength}}">\n\t\t\t\t<label ng-style="{visibility: showCreateConnectionError && \'visible\' || \'hidden\'}" class="errorlabel">{{errorContent}}</label>\n\t\t\t</div>\n\t\t</div>\n\t</main>\n</div>\n'},2034:function(e,n,t){"use strict";var i,a;!(i=[t(2035),t(1489),t(91)],a=function(e,n,t){return{template:e,scope:{qvDialogContext:"=",dataconnectionSelectionEditor:"=",dataconnectorInstance:"=",qvInternals:"=",tableModelToEdit:"="},controller:["$scope",function(e){e.qvDialogContext.size="L";e.qvDialogContext.title=e.tableModelToEdit?t.get("quickdataload.EditSelectionsFor",e.tableModelToEdit.data.tableName):t.get("quickdataload.SelectData");e.provider=n.createNativeDatabaserProvider(e.dataconnectorInstance.id,e.tableModelToEdit)}]}}.apply(n,i),void 0!==a&&(e.exports=a))},2035:function(e,n){e.exports='<div class="native-oledb-connector-select">\n\t<qv-generic-select-dialog data-provider="provider"\n\t\t\t\t\t\t\t  data-dataconnection-selection-editor="dataconnectionSelectionEditor"\n\t\t\t\t\t\t\t  data-qv-dialog-context="qvDialogContext"\n\t\t\t\t\t\t\t  data-qv-internals="qvInternals">\n\t</qv-generic-select-dialog>\n</div>\n'}}]);