/*!
 * sense-client@6.105.4
 * 
 * Copyright(C) 2019 Qlik International AB
 * All Rights Reserved
 * 
 */
(window["qJsonp"]=window["qJsonp"]||[]).push([[51],{1057:function(t,e,i){"use strict";var n,o;!(n=[i(48),i(11),i(1603),i(1604),i(1605),i(1607),i(156),i(1608),i(1609),i(1610),i(1611),i(1612),i(1613),i(1614),i(99),i(89),i(225),i(100),i(142),i(50),i(986),i(91),i(101),i(393),i(90),i(290),i(1615),i(1616),i(1617),i(1619),i(1621),i(1622),i(244),i(1003),i(1265),i(1623),i(1266),i(289)],o=function(t,e,i,n,o,r,s,l,a,c,u,p,h,d,f,v,m,g,y,q,C,x,b,w,D){t.directive("qvPivotTableInclude",["$compile","$animate",function(e,i){return{link:function n(o,r,s){i.enabled(r,false);o.$watch(s.qvPivotTableInclude,function(){var i=o.$eval(s.qvPivotTableInclude);var n=t.getService("$templateCache");var l=n.get(i);r.html(l);e(r.contents())(o)})}}}]);t.directive("onFinishRender",["$timeout",function(t){return{restrict:"A",link:function e(i){true===i.$last&&t(function(){i.$emit("ngRepeatFinished")})}}}]);function P(t,e){t.themeStyle={header:{"font-size":e.getStyle("header","fontSize"),color:e.getStyle("header","color")},content:{"font-size":e.getStyle("content","fontSize"),color:e.getStyle("content","color")}}}function S(t){return true===t.capturedOnDesktop||f.treatAsDesktop()&&false!==t.capturedOnDesktop}function I(t){var e=t.treatAsDesktop;var i;var n=parseInt(t.themeStyle.content["font-size"]);var o=1.23076923;i=e?n?n/13*21-o:21:n?n/13*31-o:31;return i||(e?21:31)}function H(t,e){t.currentPopover.header===e?e.open=false:t.currentPopover.header&&(t.currentPopover.header.open=false);t.currentPopover.header=void 0;t.pivoting.update(t.metaGhostHeaders.dataColumnsInfo.cnt)}function O(t,e,i,n,o){var r=null;i.layout&&i.layout.qStateName&&(r={qStateName:i.layout.qStateName});return t.showField(e,i.backendApi.model.app,{$alignToElement:n,qvaOutsideIgnoreFor:"qv-pt-meta-header-"+i.$id,collision:"flipfit",direction:i.options.direction},r,function(){i.currentPopover.header=void 0;o.on();i.processPaint()})}function M(t,e){e.on();t.processPaint()}function L(t){return b.getValue(t,"layout.qHyperCube.qDimensionInfo.0.qIsOneAndOnlyOne",false)}function G(i,n,o,r,s,C,x,b,G,T){var E=t.getService("$templateCache");E.put("pt-cell-item.ng.html",a);E.put("pt-header-cell-item.ng.html",c);E.put("pt-meta-left.ng.html",u);E.put("pt-meta-top.ng.html",p);E.put("pt-meta-list.ng.html",h);E.put("pt-meta-item.ng.html",d);function A(t,l,a,c){var u,p,h,d,E,A,R,_,W=[],$;var k=g.initializeService("object.pivotTable");$=function e(){P(t,k);t.viewport&&(t.viewport.minRowHeight=I(t))};g.ThemeChanged.bind($);P(t,k);t.currentPopover={header:void 0};t.nonMouseViewportScrolling={scrollbarSize:36,className:"show-non-mouse-scrollbars"};t.grid=i("pivot");t.treatAsDesktop=S(t.layout.snapshotData||{});t.viewport=C(l,I(t),".qv-grid-object-scroll-area",".scroll-content","table",".first-data-cell","th.top:nth-child(2)",t.layout.snapshotData,t.options);u=t.viewport.getVirtualScrollController();p=t.viewport.getSortableListController();h=t.viewport.getMultiSelectController();t.metaGhostHeaders=s({},t.layout,t.viewport.rect);t.pivoting=r(t.backendApi,t.grid,t.metaGhostHeaders,t.layout,t.$id,t.currentPopover,u,h);var F=function t(e,i){if("%"===e.substring(e.length-1,e.length))return parseFloat(e)*i/100;return parseFloat(e)};var V=function t(e){var i=_[e].getBoundingClientRect();var n=_.position();W[e]||(W[e]={});W[e].top=n.top;W[e].left=n.left;W[e].width=i.width;W[e].height=i.height};var N=function t(e,i,n){if(n)return W[i].width;var o=e.metaGhostHeaders.leftColumns[i];return o.reduce(function(t,i){return t+Math.max(0,F(i.style.width,e.viewport.rect.width))},0)};var B=function t(e,i){if(!e.columns[i].definedTopHeight){Object.defineProperties(e.columns[i],{top:{get:function t(){return this._top||0}},height:{get:function t(){return this._height||40}}});e.columns[i].definedTopHeight=true}};var j=function t(e,i){e.explicitColumnWidths||(e.explicitColumnWidths=e.metaGhostHeaders.explicitColumnWidths);e.columns||(e.columns=[]);e.columns.length>i&&e.columns.splice(i,e.columns.length-i);e.explicitColumnWidths.length>i&&e.explicitColumnWidths.splice(i,e.explicitColumnWidths.length-i)};var z=function t(e,i,n,o){e.explicitColumnWidths[n]>0&&(e.explicitColumnWidths[n]=i);e.columns[n]||(e.columns[n]={});e.columns[n].index=n;e.columns[n].width=i;e.columns[n].isLastColumn=o;if(W[n]){e.columns[n]._top=o?0:W[n].top;e.columns[n]._height=o?W[n].top+W[n].height:W[n].height}else{e.columns[n]._top=0;e.columns[n]._height=40}B(e,n)};var Y=function t(e,i){var n,o,r,s=[],l=e.metaGhostHeaders.leftColumns.length;if(i){_=e.viewport.getEmptyMetaCellsOfLastHeaderRow();if(!_||_.length!==l)return;for(n=0;n<l;n++)V(n)}else e.changingColumnIndex>=0&&V(e.changingColumnIndex);j(e,l);for(n=0;n<l;n++){o=N(e,n,i&&_);r=n===l-1;z(e,o,n,r);s[n]=0===n?o:s[n-1]+o}for(n=0;n<l;n++)e.columns[n].left=e.rtl?e.viewport.rect.width-s[n]:s[n];i&&(e.changingColumnIndex=-1)};t.$on("onExplicitColumnStarted",function(e){var i=e.targetScope.column.index,n=0,o,r,s=t.metaGhostHeaders.opts.topTree.minGlyphCnt*t.metaGhostHeaders.opts.glyphWidth;R=t.explicitColumnWidths[i]?t.explicitColumnWidths[i]:t.columns[i].width;o=t.metaGhostHeaders.dataHeaders;for(r=0;r<o.length;r++){o[r].oldWidth=o[r].width;n+=o[r].width}A=R+n-s});t.$on("onExplicitColumnChanging",function(e){if(0===t.layout.qHyperCube.qNoOfLeftDims)return;var i=e.targetScope.column.index,n=t.metaGhostHeaders.leftColumns[i],o=0,r,s,l;t.changingColumnIndex=i;if(e.targetScope.explicitColumnWidth>A){e.targetScope.explicitColumnWidth=A;t.explicitColumnWidths[i]=A}if(1===t.metaGhostHeaders.leftColumns.length&&e.targetScope.explicitColumnWidth<70){e.targetScope.explicitColumnWidth=70;t.explicitColumnWidths[i]=70}if(t.metaGhostHeaders.leftColumns.length>1&&e.targetScope.explicitColumnWidth<40){e.targetScope.explicitColumnWidth=40;t.explicitColumnWidths[i]=40}for(l=0;l<n.length;l++)n[l].isCollapseExpandIcon&&(o+=n[l].width);n[n.length-1].width=t.explicitColumnWidths[i]-o;n[n.length-1].style.width=n[n.length-1].width+"px";r=t.metaGhostHeaders.dataHeaders;s=(t.explicitColumnWidths[i]-R)/r.length;for(l=0;l<r.length;l++){r[l].width=Math.max(r[l].oldWidth-s,r[l].minWidth);r[l].style.width=r[l].width+"px"}Y(t)});t.$on("onExplicitColumnChanged",function(){t.metaGhostHeaders.update(0,n.getLeftTreeDepth(t.layout.qHyperCube.qPivotDataPages[0]),t.explicitColumnWidths);Y(t);t.applyColumnWidthSoftPatch(t.explicitColumnWidths)});t.$on("$destroy",function(){$&&g.ThemeChanged.unbind($);G.cancel(d);G.cancel(E)});t.applyColumnWidthSoftPatch=function(e){var i=t.layout.qHyperCube,n=i.columnWidths?"replace":"add",o=i.qIndentMode?1:0,r=i.columnWidths,s=t.metaGhostHeaders.leftColumns?t.metaGhostHeaders.leftColumns.length:0,l,a;r&&Array.isArray(r[0])||(r=[[],[]]);if(o)r[0]=e;else{l=i.qEffectiveInterColumnSortOrder;for(a=0;a<s;a++)r[1][l[a]]=e[a]}var c=[{qPath:"/qHyperCubeDef/columnWidths",qOp:n.toString(),qValue:JSON.stringify(r)}];t.backendApi.applyPatches(c,true)};t.selections=b(t,t.selectionsApi,t.backendApi,t.grid,t.layout,p);t.virtualScroll=x(t.viewport,t.metaGhostHeaders.dataColumnsInfo,t.layout.qHyperCube.qSize);t.virtualScroll.onGetData(function(e){return t.getData(e,true).then(function(){G.cancel(d);d=G(function(){return t.virtualScroll.setScrollViewport()},100);return d}).catch(function(t){false})});t.getData=function(e,i){var n=v();t.backendApi.getData([e]).then(function(o){t.onUpdateData(o,e,i).then(function(){n.resolve()})}).catch(function(t){false});return n.promise};t.onUpdateData=function(e,i,o){n.updatePivotItems(t,e,[i],o);t.selections.updateSelections();return G(function(){},0,false)};t.onClick=function(t){e(t.target).closest(".cell-content").focus()};t.process=function(e){e&&t.virtualScroll.setPage(e);if(t.options.viewState){e.qLeft=t.options.viewState.page.qLeft;e.qTop=t.options.viewState.page.qTop;return t.getData(e)}return t.getData(t.virtualScroll.page).then(function(){t.virtualScroll.setVirtualSize();G.cancel(E);E=G(function(){Y(t,true)},100);return E}).catch(function(t){false})};t.processPaint=function(){return t.updateMetaInfo().then(function(e){var i=t.layout.qHyperCube.qLastExpandedPos,n=i&&void 0!==t.expandedPosDiffX&&void 0!==t.expandedPosDiffY,o=t.viewport.getVisibleRowCount();var r={qLeft:Math.max(0,n?i.qx-t.expandedPosDiffX:0),qTop:Math.max(0,n?i.qy-t.expandedPosDiffY:0),qWidth:e.qWidth,qHeight:e.qHeight};i&&r.qLeft+r.qWidth>t.layout.qHyperCube.qSize.qcx&&(r.qLeft=Math.max(0,t.layout.qHyperCube.qSize.qcx-e.qWidth));i&&r.qTop+r.qHeight>=t.layout.qHyperCube.qSize.qcy&&(r.qTop=Math.max(0,t.layout.qHyperCube.qSize.qcy-e.qHeight));if(i&&t.collapsed&&r.qTop+o>t.layout.qHyperCube.qSize.qcy){t.viewport.collapsedRowCount=o;r.qTop=Math.max(0,t.layout.qHyperCube.qSize.qcy-o);r.qHeight=o}delete t.expandedPosDiffX;delete t.expandedPosDiffY;delete t.collapsed;return t.process(r)})};t.processResize=function(){return t.updateMetaInfo().then(function(e){var i=t.layout.qHyperCube.qSize,n={qLeft:t.virtualScroll.page.qLeft,qTop:t.virtualScroll.page.qTop,qWidth:e.qWidth,qHeight:e.qHeight};n.qTop+n.qHeight>i.qcy&&(n.qTop=Math.max(0,i.qcy-n.qHeight));n.qLeft+n.qWidth>i.qcx&&(n.qLeft=Math.max(0,i.qcx-n.qWidth));t.$emit("ngRepeatFinished");return t.process(n)})};c.setDirection=function(){t.viewport.direction=t.options.direction;t.rtl="rtl"===t.options.direction;t.processPaint()};c.getSelectionToolbar=function(){var e=[];L(t)||e.push({name:"Tooltip.clearSelection",tid:"selection-toolbar.clear",isIcon:true,buttonClass:"clear",iconClass:"lui-icon lui-icon--clear-selections",action:function t(){this.selectionsApi.clear()},isDisabled:function t(){return!this.selectionsApi.selectionsMade}});return new m(c.$scope.backendApi,c.$scope.selectionsApi,false,false,e,[])};t.updateMetaInfo=function(){return t.viewport.updateRect().then(function(){var e=t.metaGhostHeaders.explicitColumnWidths;t.metaGhostHeaders.update(0,n.getLeftTreeDepth(t.layout.qHyperCube.qPivotDataPages[0]),e);t.pivoting.update(t.metaGhostHeaders.dataColumnsInfo.cnt);Y(t);return{qWidth:Math.max(1,t.metaGhostHeaders.dataColumnsInfo.cnt),qHeight:Math.max(1,t.viewport.rowCount)}})};t.collapseExpand=function(i){var n=e(i.target),o;o=n.scope().cell;if(!o)return;t.expandedPosDiffX=o.dataColIx-t.virtualScroll.page.qLeft;t.expandedPosDiffY=o.dataRowIx-t.virtualScroll.page.qTop;if("lui-icon--plus"===o.collapseExpandClass)o.hasClass("top")?t.backendApi.expandTop(o.dataRowIx,o.dataColIx,false):o.hasClass("left")&&t.backendApi.expandLeft(o.dataRowIx,o.dataColIx,false);else if("lui-icon--minus"===o.collapseExpandClass){t.collapsed=true;o.hasClass("top")?t.backendApi.collapseTop(o.dataRowIx,o.dataColIx,false):o.hasClass("left")&&t.backendApi.collapseLeft(o.dataRowIx,o.dataColIx,false)}};t.showDimension=function(i,n){var r=e(i.target).closest(".qv-pt-meta-button");p.off();if(t.currentPopover.header===n){n.open=false;t.currentPopover.header=void 0;o.close();M(t,p);return}if(t.currentPopover.header){t.currentPopover.header.open=false;t.currentPopover.header=void 0}q.isSmallDevice?O(T,n.fieldName,t,r,p):O(o,n.fieldName,t,r,p).then(function(i){var o;i.closing.then(function(i){if(i&&!e(i.target).closest(".qv-pt-meta-button").length>0){H(t,n);M(t,p)}o=i});i.closed.then(function(){if(!o){H(t,n);M(t,p)}i=null})});n.open=true;t.currentPopover.header=n};function U(e,i,n){t.interactive=e&&i;t.navigatable=e&&n;if(e){if(n){u.on();p.on()}}else if(!e){u.off();p.off()}}c.setInteractionState=function(){var e=t.object.inAnalysisState(),i=false!==t.options.navigation,n=false!==t.options.selections;U(e,n,i)};c.getContextMenu=function(i,n,o){if(o.target){var r=e(o.target).closest(".qv-pt");if(r){var s=o.target.innerText;s&&""!==s&&n.addItem({icon:"lui-icon lui-icon--copy",translation:"contextMenu.copyCellValue",tid:"copy-cell-context-item",select:function t(){w.copyToClipboard(s)}})}}var l=this.$scope.metaGhostHeaders,a=l.leftDimCnt-(l.pseudoInLeftTree?1:0),c=l.topDimCnt-(l.pseudoInTopTree?1:0);if(a>1||c>1)return i.model.getEffectiveProperties().then(function(e){if(e.qHyperCubeDef.qAlwaysFullyExpanded||i.viewDataToggled)return;var o=n.addItem({translation:"Object.PivotTable.ContextMenu.ExpandCollapse",tid:"expand-collapse-group"});o.addItem({icon:"lui-icon lui-icon--plus",translation:"Object.PivotTable.ContextMenu.ExpandAll",tid:"expand-all",select:function e(){t.backendApi.expandTop(0,0,true);t.backendApi.expandLeft(0,0,true)}});o.addItem({icon:"lui-icon lui-icon--minus",translation:"Object.PivotTable.ContextMenu.CollapseAll",tid:"collapse-all",select:function e(){t.backendApi.collapseTop(0,0,true);t.backendApi.collapseLeft(0,0,true)}})})};c.suppressOnPaint=function(t){if(this.$scope.object._forcePaint){this.$scope.object._forcePaint=false;return false}return y.isInSelection(t)};c.onPaint=function(){this.setInteractionState(t.options.interactionState);if(!this.suppressOnPaint(this.$scope.layout)&&void 0===this.$scope.currentPopover.header){p.cancel();y.isModalSelectionModel(this.$scope.object.model)&&this.$scope.selectionsApi.confirm();return t.processPaint()}this.$scope.currentPopover.header&&t.pivoting.update(t.metaGhostHeaders.dataColumnsInfo.cnt);return v.resolve()};c.onResize=function(){return t.processResize()};c.setSnapshotData=function(e){var i=t.virtualScroll.page;return t.backendApi.getData([i]).then(function(i){if(!t.backendApi.isSnapshot){i[0].qArea.qTop=0;i[0].qArea.qLeft=0}e.qHyperCube.qPivotDataPages=i;e.qHyperCube.qSize.qcx=i[0].qArea.qWidth;e.snapshotData.capturedOnDesktop=f.treatAsDesktop();return e}).catch(function(t){false})};c.getPreferredSize=function(){var t=v();var e=this.$scope.$on("ngRepeatFinished",function(){t.resolve({w:l.width(),h:l.find("table").height()+5});e()});return t.promise};c.getViewState=function(){var e=D.extend({},t.virtualScroll.page);return{page:e}}}return{restrict:"E",replace:true,template:l,require:"qvObjectContent",link:A}}t.directive("qvPivotTable",["qvDataGrid","qvGridObjectDataService","qvListboxPopoverService","qvPivotTablePivoting","qvPivotTableMetaGhostHeadersProvider","qvPivotTableViewportProvider","qvPivotTableVirtualScrollProvider","qvPivotTableSelectionsProvider","$timeout","qvListboxPopoverServiceMobile",G]);return{initialProperties:{qHyperCubeDef:{qDimensions:[],qMeasures:[],qSuppressMissing:true,qMode:"P",qShowTotalsAbove:true,qInitialDataFetch:[{qTop:0,qLeft:0,qWidth:50,qHeight:50}],qIndentMode:true,columnWidths:[]}},data:{dimensions:{min:1,max:1e3,description:function t(e,i,n){var o=n&&"rows"===n.type?"Visualizations.Descriptions.Row":"Visualizations.Descriptions.Column";return x.get(o)}},measures:{min:1,max:1e3,description:function t(){return x.get("Visualizations.Descriptions.Values")}}},getCreatePropertyHandler:function t(e){var i=s.mapProperties(this.mappedDefinition.items.data.items.dimensions);var n=s.mapProperties(this.mappedDefinition.items.data.items.measures);return new o({app:e,dimensionDefinition:this.dimensionDefinition,measureDefinition:this.measureDefinition,dimensionProperties:i,measureProperties:n})},support:{cssScaling:true,snapshot:true,export:true,exportData:true,sharing:false,viewData:true},migrate:{properties:function t(e){return C.migrateProperties(e)}},type:"pivot-table",template:"<qv-pivot-table></qv-pivot-table>",BackendApi:i,definition:n,importProperties:r.importProperties,exportProperties:r.exportProperties}}.apply(e,n),void 0!==o&&(t.exports=o))},1058:function(t,e,i){"use strict";var n,o;!(n=[i(125)],o=function(t){function e(t){var e=t.qDimensions;function n(){var i=[];for(var n=0;n<e.length;n++)i.push(n);var o=t.qMeasures.length>=2;o&&i.push(-1);return i}i(e,t.qInterColumnSortOrder)&&(t.qInterColumnSortOrder=n())}function i(t,e){var i={},n=[],o=false,r=-1!==e.indexOf(-1);e.forEach(function(t){i[t]?o=true:i[t]=true});o=r?o||t.length+1!==Object.keys(i).length:o||t.length!==Object.keys(i).length;Object.keys(i).forEach(function(t){"-1"!==t&&n.push(parseInt(t,10))});n=n.sort(function(t,e){return t-e});for(var s=0;s<n.length;++s)o=o||n[s]!==s;return o}function n(t){return t&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1])}function o(i){e(i);var n=i.qDimensions,o=i.qInterColumnSortOrder,r;r=o.filter(function(t){return-1!==t});function s(){for(var e=0;e<r.length;e++)if(-1!==r[e]&&r[e]!==e){var i=r[e];var s=r.indexOf(e);var l=r[s];t.swap(r,e,s);t.swap(n,e,s);t.swap(o,o.indexOf(i),o.indexOf(l))}}s()}function r(t,e){var i=t.qDimensions,n=t.qInterColumnSortOrder,o=[];var r=e.indexOf(-1);e.forEach(function(t){-1!==t&&o.push(i[t])});o.forEach(function(t,e){i[e]=t});n.splice(0,n.length);for(var l=0;l<o.length;l++)n.push(l);r>-1&&n.splice(r,0,-1);s(t,e)}function s(t,e){if(!n(t.columnWidths))return;var i=t.columnWidths[1],o=[];e.forEach(function(t){-1!==t&&o.push(i[t])});o.forEach(function(t,e){i[e]=t})}function l(t,e){var i=t.qMeasures,n=[];e.forEach(function(t){n.push(i[t])});i.splice(0,i.length);n.forEach(function(t){i.push(t)})}function a(t,e,i,n){var o=n.qInterColumnSortOrder.slice();var r=n.qNoOfLeftDims;var s=o.indexOf(t)<=r-1;var l=o.indexOf(t);o.splice(l,1);var a=e.concat(i);var c=a.indexOf(t);var u;var p;var h=e[0]===t&&1===e.length;var d=i[0]===t&&1===i.length;if(h||d)u=r-(s?1:0);else if(c>0){p=a[c-1];u=o.indexOf(p)+1}else{p=a[0];u=Math.max(0,o.indexOf(p)-1)}o.splice(u,0,t);return o}function c(t,e,i,n){var o=i.qEffectiveInterColumnSortOrder;var r=i.qNoOfLeftDims;var s=n.qNoOfLeftDims;var l=o.indexOf(t)<=r-1;var a=-1!==e.indexOf(t);if(a&&!l)return s+1;if(!a&&l)return s-1;return s}return{validatePivotHyperCube:e,fixPivotHypercubeOrders:o,reorderPivotDimensions:r,reorderMeasures:l,isInvalidOrderArray:i,isValidColumnWidths:n,reorderColumnOrderDef:a,getNoLeftDimsDef:c}}.apply(e,n),void 0!==o&&(t.exports=o))},1128:function(t,e,i){"use strict";var n,o;!(n=[i(48),i(11),i(96),i(99)],o=function(t,e,i,n){t.directive("qvSelectionsToggleValue",["$parse",function(t){return{restrict:"A",link:function i(n,o,r){var s=t(r.qvSelectionsToggleValue)(),l=s.selector,a="."+n.$id+"-toggle-value",c=s.itemKey||"cell";o.on("qv-activate"+a,l,function(t){var i=e(t.target).closest(l),o=i.scope()[c];if(!i.length||!o)return;n.$apply(function(){var e={$event:t};e[c]=o;n.$eval(r.qvSelectionsOnToggleValue,e)})});n.$on("$destroy",function(){o.off(a)})}}}]);t.directive("qvSelectionsToggleDimensionValue",["$parse",function(t){return{restrict:"A",link:function i(n,o,r){var s=t(r.qvSelectionsToggleDimensionValue)(),l=s.selector,a="."+n.$id+"-toggle-dimension-value",c=s.itemKey||"cell";o.on("qv-activate"+a,l,function(t){var i=e(t.target).closest(l),o=i.scope()[c];if(n.$eval(r.qvSelectionsExcludeToggleDimensionValue,{$event:t}))return;if(!o||!o.isDimensionValue)return;if(o.locked){n.$eval(r.qvSelectionsSelectWhileLocked);return}n.$apply(function(){var e={$event:t};e[c]=o;n.$eval(r.qvSelectionsOnToggleDimensionValue,e)})});n.$on("$destroy",function(){o.off(a)})}}}]);t.directive("qvSelectionsMultiselect",["$parse",function(t){return{restrict:"A",controller:function t(){},link:function o(r,s,l,a){var c=t(l.qvSelectionsMultiselect)(),u=c.selector,p=c.itemKey||"cell",h=r.$id+"-multiselect",d=r.$id+"-2finger-multiselect",f,v,m,g;function y(){i(s[0]).tap({id:h,options:{preventDefault:false},start:function t(i){m=e(i.target).closest(u)}});i(s[0]).swipe({id:h,options:{radiusThreshold:4,preventDefault:false},start:function t(e){var i,o;if(!n.isMouse(e)||!m.length){this.cancel();return}i=m.scope()[p];if(!i.isDimensionValue){this.cancel();return}if(i.locked){r.$eval(l.qvSelectionsSelectWhileLocked);this.cancel();return}g=i;o={$event:e};o[p]=i;r.$apply(r.$eval(l.qvSelectionsStartMultiselect,o))},update:function t(i){var n=e(i.target).closest(u),o;if(!n.length)return;o=n.scope()[p];r.$apply(r.$eval(l.qvSelectionsUpdateMultiselect,{start:g,current:o,dataColIx:o.dataColIx}))},end:function t(e){r.$apply(r.$eval(l.qvSelectionsEndMultiselect,{$event:e}))}});return function(){i(s[0]).off("*",h)}}function q(){i(s[0]).tap({id:d,options:{touches:2,preventDefault:false},end:function t(i,n){var o=n.pagePoints[0],s=n.pagePoints[1],a,c,h,d,f,v,m;a=o?e(document.elementFromPoint(o.x,o.y)):void 0;c=s?e(document.elementFromPoint(s.x,s.y)):void 0;h=a?a.closest(u).scope():void 0;d=c?c.closest(u).scope():void 0;f=h?h[p]:void 0;v=d?d[p]:void 0;if(!(f&&v&&f.isDimensionValue&&v.isDimensionValue))return;if(f.locked||v.locked){r.$eval(l.qvSelectionsSelectWhileLocked);return}r.$apply(function(){m={offsetLeft:a[0].offsetLeft,width:a[0].clientWidth,$event:i};m[p]=f;r.$eval(l.qvSelectionsStartMultiselect,m);r.$eval(l.qvSelectionsUpdateMultiselect,{start:f,current:v,dataColIx:f.dataColIx});r.$eval(l.qvSelectionsEndMultiselect,{$event:i})})}});return function(){i(s[0]).off("*",d)}}a.on=function(){f||(f=y());v||(v=q())};a.off=function(){if(f){f();f=void 0}if(v){v();v=void 0}};r.$watch("interactive",function(t){if(void 0===t)return;t?a.on():a.off()});r.$on("$destroy",function(){a.off()})}}}])}.apply(e,n),void 0!==o&&(t.exports=o))},1603:function(t,e,i){"use strict";var n,o;!(n=[i(198)],o=function(t){var e;function i(t,e,i){var n,o,r,s=[];for(o=0;o<e.length;o++)for(n=0;n<t.length;n++){r={qType:i,qCol:e[o],qRow:t[n]};s.push(r)}return s}e=t.extend("PivotApi",{init:function t(e){this._super(e,"/qHyperCubeDef",{mode:"P"});this.cacheCube.setMethodName("getHyperCubePivotData")},updateCache:function t(e){if(e&&e.qHyperCube&&"P"===e.qHyperCube.qMode){this.cacheCube.set(e.qHyperCube.qPivotDataPages);this.cacheCube.setCubeSize(e.qHyperCube.qSize)}else this.cacheCube.clear();this.backendStackThrottle.clear()},getData:function t(e){switch(this.model.layout.qHyperCube.qMode){case"P":return this.cacheCube.getData(e);default:throw new Error("you are using a non-supported backend-api")}},getReducedData:function t(e,i,n){n=void 0!==n?n:"D1";return this.model.getHyperCubeReducedData(this.path,e,i,n)},select:function t(e,n,o){switch(this.model.layout.qHyperCube.qMode){case"P":return this.model.selectPivotCells(this.path,i(e,n,o));default:throw new Error("you are using a non-supported backend-api")}},expandTop:function t(e,i,n){return this.model.expandTop(this.path,e,i,n)},expandLeft:function t(e,i,n){return this.model.expandLeft(this.path,e,i,n)},collapseTop:function t(e,i,n){return this.model.collapseTop(this.path,e,i,n)},collapseLeft:function t(e,i,n){return this.model.collapseLeft(this.path,e,i,n)},clearSelections:function t(){return this.model.resetMadeSelections()},hasSelections:function t(){return this.model.layout.qSelectionInfo.qMadeSelections},getSize:function t(){return this.model.layout.qHyperCube.qSize}});return e}.apply(e,n),void 0!==o&&(t.exports=o))},1604:function(t,e,i){"use strict";var n,o;!(n=[i(383),i(101),i(90),i(91),i(160),i(49),i(113)],o=function(t,e,i,n,o,r,s){var l,a,c,u;function p(t,e,i){if(!i.properties.qHyperCubeDef.qIndentMode)return true;var n=i.properties.qHyperCubeDef.qInterColumnSortOrder.indexOf(-1),o=i.properties.qHyperCubeDef.qNoOfLeftDims,r;n>-1&&n<o&&o--;r=i.properties.qHyperCubeDef.qDimensions.indexOf(t);return 0===r||r>=o}function h(t){t.qAttributeExpressions[0]=t.qAttributeExpressions[0]||{};t.qAttributeExpressions[1]=t.qAttributeExpressions[1]||{};t.qAttributeExpressions[0].id=o.IDMAP.CELL_BACKGROUND_COLOR;t.qAttributeExpressions[1].id=o.IDMAP.CELL_FOREGROUND_COLOR}l={uses:"settings",items:{presentation:{type:"items",translation:"properties.presentation",items:{alwaysFullyExpanded:{ref:"qHyperCubeDef.qAlwaysFullyExpanded",type:"boolean",translation:"properties.pivot.fullyExpanded",defaultValue:false},indentMode:{ref:"qHyperCubeDef.qIndentMode",type:"boolean",translation:"properties.pivot.indentMode"}}}}};a={type:"items",translation:"properties.sorting",items:{defaultSorting:{uses:"sorting",items:{dimensions:{showPriority:false,allowMove:false},measures:{included:false}}}}};u={type:"string",component:"expression",ref:"qCalcCondition.qCond",expression:"optional",expressionType:"ValueExpr",translation:"Object.Table.Columns.VisibilityCondition",defaultValue:{qv:""},tid:"visibilityCondition",isExpression:function t(e){return"string"===typeof e&&e.trim().length>0},show:function t(){return r.getFlag("PIVOT_SHOW_HIDE")||s.PIVOT_SHOW_HIDE}};var d={type:"items",component:"pivot-data",translation:"properties.data",addTranslation:"Properties.AddData",items:{dimensions:i.extend(true,{},t.dimensions,{items:{globalGrouping:{type:"boolean",translation:"properties.dimensionLimits.globalGrouping",ref:"qOtherTotalSpec.qGlobalOtherGrouping",defaultValue:false,show:function t(i){return"OTHER_OFF"!==e.getValue(i,"qOtherTotalSpec.qOtherMode")}},totalMode:{type:"string",component:"switch",translation:"properties.showTotals",ref:"qOtherTotalSpec.qTotalMode",defaultValue:"TOTAL_OFF",trueOption:{value:"TOTAL_EXPR",translation:"properties.on"},falseOption:{value:"TOTAL_OFF",translation:"properties.off"},show:p},totalsLabel:{type:"string",component:"expression",expressionType:"StringExpr",ref:"qTotalLabel",translation:"properties.totals.label",defaultValue:function t(){return n.get("Object.Table.Totals")},show:function t(i,n,o){return"TOTAL_OFF"!==e.getValue(i,"qOtherTotalSpec.qTotalMode")&&p(i,n,o)}},visibilityCondition:u}}),measures:i.extend(true,{},t.measures,{items:{visibilityCondition:u,tableColorBgByExpression:{component:"expression",expressionType:"measure",ref:"qAttributeExpressions.0.qExpression",translation:"Object.Table.Measure.BackgroundExpression",defaultValue:"",change:h},tableColorByExpression:{component:"expression",expressionType:"measure",ref:"qAttributeExpressions.1.qExpression",translation:"Object.Table.Measure.ForegroundExpression",defaultValue:"",change:h}}})}};c={type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling",items:{calcCond:{uses:"calcCond"}}}}};return{type:"items",component:"accordion",items:{data:d,sorting:a,addons:c,settings:l}}}.apply(e,n),void 0!==o&&(t.exports=o))},1605:function(t,e,i){"use strict";var n,o;!(n=[i(204),i(89),i(125),i(1058),i(90),i(1606)],o=function(t,e,i,n,o,r){var s=1e3,l=1e3;var a;a=t.extend({addDimension:function t(i,s,l){var a=this.getDimensions(),c=void 0!==s&&s,u=this;i.qDef.cId||(i.qDef.cId=o.generateId());if(a.length<this.maxDimensions())return this.autoSortDimension(i).then(function(){n.fixPivotHypercubeOrders(u.hcProperties);r.rearrange(u,a,i,c,l);return e.resolve(i)})},reinsertDimension:function t(i,n,r){var s=this.getDimensions();i.qDef.cId||(i.qDef.cId=o.generateId());if(s.length<this.maxDimensions())return this.addDimension(i,n,r);if(s.length<l){r=this.hcProperties.qLayoutExclude.qHyperCubeDef.qDimensions.length;this.hcProperties.qLayoutExclude.qHyperCubeDef.qDimensions.splice(r,0,i);return e.resolve(i)}},removeDimension:function t(o){var r=this.getDimensions(),s;var l=this.properties.qHyperCubeDef.qNoOfLeftDims,a=this.hcProperties.qInterColumnSortOrder;var c,u;for(u=0;u<a.length;u++)if(a[u]===o){c=u;break}c+1<=l&&this.properties.qHyperCubeDef.qNoOfLeftDims--;var p=this.properties.qHyperCubeDef.columnWidths?this.properties.qHyperCubeDef.columnWidths[1]:void 0;Array.isArray(p)&&p.length>o&&p.splice(o,1);s=r.splice(o,1)[0];i.indexRemoved(this.hcProperties.qInterColumnSortOrder,o);n.fixPivotHypercubeOrders(this.hcProperties);return e.resolve(s)},addMeasure:function t(i,n,r,l){var a=this.getMeasures(),c=this;i.qDef.cId||(i.qDef.cId=o.generateId());l||delete i.qDef.qNumFormat;if(a.length<this.maxMeasures()){var u=1===a.length;a.push(i);return this.autoSortMeasure(i).then(function(){u&&c.hcProperties.qInterColumnSortOrder.push(-1);return i})}if(a.length<s){this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures.push(i);return e.resolve(i)}},reinsertMeasure:function t(i,n){var r=this.getMeasures();i.qDef.cId||(i.qDef.cId=o.generateId());n=void 0!==n?n:r.length;if(r.length<this.maxMeasures()){r.splice(n,0,i);if(this.hcProperties&&this.hcProperties.qInterColumnSortOrder&&2===r.length){var l=this.hcProperties.qInterColumnSortOrder.indexOf(-1);-1===l&&this.hcProperties.qInterColumnSortOrder.push(-1)}}else if(r.length<s){n=this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures.length;this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures.splice(n,0,i)}return e.resolve(i)},removeMeasure:function t(i){var n=this.getMeasures(),o,r,s;if(i<n.length){o=2===n.length;r=this.hcProperties.qMeasures.splice(i,1)[0];if(o){var l=this.hcProperties.qInterColumnSortOrder;s=l.indexOf(-1);l.splice(s,1);s+1<=this.hcProperties.qNoOfLeftDims&&this.hcProperties.qNoOfLeftDims--}}else r=this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures.splice(i-n.length,1)[0];return e.resolve(r)},getSorting:function t(){throw new Error("don't call this")},changeSorting:function t(){throw new Error("don't call this")},setSorting:function t(){throw new Error("don't call this")}});return a}.apply(e,n),void 0!==o&&(t.exports=o))},1606:function(t,e,i){"use strict";var n,o;!(n=[],o=function(){return{rearrange:t};function t(t,e,i,n,o){var r=t.hcProperties.qNoOfLeftDims,s=e.length,l=t.hcProperties.qInterColumnSortOrder,a=l.indexOf(-1);function c(){l.splice(a,1);l.push(s);l.splice(a+1,0,-1)}if(n||-1!==r&&!Number.isNaN(+r))if(!n&&r>=0){if(a>=r)c();else{-1!==a&&--r;o<=r&&-1!==a?c():l.push(s)}if("number"===typeof o&&o<r){var u=Math.max(o-1,0);e.splice(u,0,i)}else e.splice(r,0,i);t.hcProperties.qNoOfLeftDims++}else{0===s&&(t.hcProperties.qNoOfLeftDims=0);var p="number"===typeof o?o+r:void 0;a>=p?c():l.push(s);"number"===typeof o?p>a&&a>-1?e.splice(p-1,0,i):e.splice(p,0,i):e.push(i)}else{t.hcProperties.qNoOfLeftDims=1;l.unshift(s);e.splice(0,0,i)}}}.apply(e,n),void 0!==o&&(t.exports=o))},1607:function(t,e,i){"use strict";var n,o;!(n=[i(189),i(101),i(160),i(90)],o=function(t,e,i,n){return{importProperties:o,exportProperties:r};function o(i,o,r){var s=t.pivotChart.importProperties.apply(t,[i,o,r]);t.unquarantineObject(s.qProperty,"pivotTableColumnWidths")||e.setValue(s,"qProperty.qHyperCubeDef.columnWidths",o.qHyperCubeDef.columnWidths.concat());var l=n.getValue(s,"qProperty.qHyperCubeDef.qMeasures",[]);l.forEach(a);t.unquarantineConditionalShow(s);return s}function r(e){var i=t.pivotChart.exportProperties.apply(t,[e]);t.quarantineProperty("qHyperCubeDef.columnWidths",i,"pivotTableColumnWidths");t.quarantineConditionalShow(i);var o=n.getValue(i,"properties.qHyperCubeDef.qMeasures",[]);o.forEach(c);return i}function s(t){var e=i.getIndexById(t,i.IDMAP.CELL_BACKGROUND_COLOR);return e>-1?t[e]:0!==i.getIndexById(t,i.IDMAP.CELL_FOREGROUND_COLOR)?t[0]:t[1]}function l(t){var e=i.getIndexById(t,i.IDMAP.CELL_FOREGROUND_COLOR);return e>-1?t[e]:1!==i.getIndexById(t,i.IDMAP.CELL_BACKGROUND_COLOR)?t[1]:t[0]}function a(t){var e=t.qAttributeExpressions;var i=s(e);var n=l(e);e[0]=i;e[1]=n}function c(t){var e=t.qAttributeExpressions;e&&e[0]&&(e[0].id=i.IDMAP.CELL_BACKGROUND_COLOR);e&&e[1]&&(e[1].id=i.IDMAP.CELL_FOREGROUND_COLOR)}}.apply(e,n),void 0!==o&&(t.exports=o))},1608:function(t,e){t.exports='<div class="qv-pt" ng-class="{ \'qv-pt-interactive\': interactive, \'sortable-active\': pivoting.dragPlaceholder, \'qv-rtl-layout\': options.direction === \'rtl\', \'touch-on\': !treatAsDesktop }" aria-hidden="true" ng-click="onClick($event)">\n\t<qv-table-column-width-adjuster\n\t\t\tmin-col-width="scrollApi.settings.column.minColWidth"\n\t\t\tng-if="navigatable && !selectionsApi.active && layout.qHyperCube.qNoOfLeftDims"\n\t\t\tcolumns="columns"\n\t\t\texplicit-column-widths="explicitColumnWidths"\n\t\t\tx-rtl="rtl"\n\t\t\tdir="{{direction}}">\n\t</qv-table-column-width-adjuster>\n\t<qv-scroll-area x-non-mouse-viewport-scrolling="nonMouseViewportScrolling"\n\t\t\t\t\tclass="qv-grid-object-scroll-area"\n\t\t\t\t\tqva-delegated-activate=".qv-pt-expandable#interactive && !selectionsApi.active && collapseExpand($event);"\n\t\t\t\t\tqv-sortable-list="pivoting"\n\t\t\t\t\tx-direction="viewport.direction">\n\t\t<table\tdir="{{viewport.direction}}"\n\t\t\t\tqv-selections-select-while-locked="selectWhileLocked()"\n\t\t\t\tqv-selections-toggle-dimension-value="{ selector: \'.cell\' }"\n\t\t\t\tqv-selections-on-toggle-dimension-value="interactive && selectDimensionValue(cell, $event)"\n\t\t\t\tqv-selections-exclude-toggle-dimension-value="excludeDimensionToggle($event)"\n\t\t\t\tqv-selections-multiselect="{ selector: \'.cell:not(.null-value)\' }"\n\t\t\t\tqv-selections-start-multiselect="interactive && activateSelections(cell)"\n\t\t\t\tqv-selections-update-multiselect="interactive && multiselectDimensionValues(start, current, dataColIx)"\n\t\t\t\tqv-selections-end-multiselect="interactive && multiselect()">\n\t\t\t<colgroup>\n\t\t\t\t<col ng-repeat="cell in metaGhostHeaders.headers" ng-style="cell.style" />\n\t\t\t</colgroup>\n\t\t\t<tbody ng-style="themeStyle.header">\n\t\t\t\t<tr ng-repeat="row in grid.headerRows" tid="header.row"\n\t\t\t\t\tng-class="row.classList" on-finish-render>\n\t\t\t\t\t<th ng-repeat="cell in row.cells"\n\t\t\t\t\t\tng-class="cell.classList"\n\t\t\t\t\t\tclass="cell"\n\t\t\t\t\t\tcolspan="{{cell.colspan}}"\n\t\t\t\t\t\trowspan="{{cell.rowspan}}"\n\t\t\t\t\t\tng-style="cell.style"\n\t\t\t\t\t\tqv-pivot-table-include="cell.templateSrc"\n\t\t\t\t\t\ttitle="{{cell.text}}"\n\t\t\t\t\t\ttid="header.row.cell"></th>\n\t\t\t\t</tr>\n\t\t\t\t<tr ng-repeat="row in grid.rows" tid="data.row" ng-style="themeStyle.content" on-finish-render>\n\t\t\t\t\t<td ng-repeat="cell in row.cells"\n\t\t\t\t\t\tng-class="cell.classList"\n\t\t\t\t\t\tclass="cell"\n\t\t\t\t\t\tcolspan="{{cell.colspan}}"\n\t\t\t\t\t\trowspan="{{cell.rowspan}}"\n\t\t\t\t\t\tng-style="cell.style"\n\t\t\t\t\t\tqv-pivot-table-include="cell.templateSrc"\n\t\t\t\t\t\ttitle="{{cell.text}}"\n\t\t\t\t\t\ttid="data.row.cell"></td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\t</qv-scroll-area>\n</div>\n'},1609:function(t,e){t.exports='<div class="value" ng-class="{ \'qv-rtl-text\': cell.isRtl }" ng-bind="cell.text" dir="{{cell.dir}}"></div>\n'},1610:function(t,e){t.exports='<div class="value" dir="{{cell.dir}}" ng-class="{ \'qv-rtl-text\': cell.isRtl }">\n\t<i class="qv-pt-expandable lui-icon" ng-if="cell.collapseExpandClass" ng-class="cell.collapseExpandClass"></i>\n\t<span ng-bind="cell.text"></span>\n</div>\n'},1611:function(t,e){t.exports='<div class="left-meta-headers list"\n\t tid="meta.rows"\n\t ng-repeat="list in [pivoting.rows]"\n\t qv-pivot-table-include="list.templateSrc">\n</div>'},1612:function(t,e){t.exports='<div class="top-meta-headers list"\n\t tid="meta.columns"\n\t ng-repeat="list in [pivoting.columns]"\n\t qv-pivot-table-include="list.templateSrc">\n</div>'},1613:function(t,e){t.exports='<div class="button-wrapper"\n\t ng-repeat="header in list.items track by header.id"\n\t qv-pivot-table-include="header.templateSrc">\n</div>'},1614:function(t,e){t.exports='<div class="lui-button qv-pt-meta-button"\n\t\ttid="meta.button"\n\t\tng-style="header.style"\n\t\tng-class="{ \'lui-active\': header.open, \'pseudo\': header.isPseudoDim, \'dragging\': header.dragging, \'lui-disabled\': !interactive || selectionsApi.active }"\n\t\tqva-outside-ignore-for="{{header.qvaOutsideIgnoreFor}}"\n\t\tqva-activate="!header.isPseudoDim && !selectionsApi.active && interactive && showDimension($event, header)">\n\t<span ng-if="header.locked" class="lui-icon lui-icon--lock"></span>\n\t<div class="meta-text" dir="{{header.dir}}" title="{{header.title}}">{{header.title}}</div>\n\t<span ng-if="!header.isPseudoDim" class="lui-icon lui-icon--search"></span>\n</div>\n'},1615:function(t,e,i){"use strict";var n,o;!(n=[i(48),i(1263)],o=function(t,e){t.provider("qvDataGrid",function t(){this.$get=[function(){return function t(i){return new e(i)}}]})}.apply(e,n),void 0!==o&&(t.exports=o))},1616:function(t,e,i){"use strict";var n,o;!(n=[i(48),i(90),i(91),i(99),i(1058)],o=function(t,e,i,n,o){var r=8;function s(t,e,i){this.calcApprMaxGlyphCnt=t;this.maxGlyphCnt=i;this.isWidthFlexible=e;this.style={}}function l(t,i,o){var s=10,l={glyphWidth:r,collapseExpandIconGlyphCnt:n.treatAsDesktop()?3:4,columnPaddingGlyphCnt:3,metaHeaderMaxGlyphCnt:(150+s)/r,cellPaddingGlyphCnt:Math.ceil(12/r),buttonPaddingGlyphCnt:Math.ceil(20/r),buttonArrowGlyphCnt:Math.ceil(13/r),buttonMarginOfSafetyGlyphCnt:2,leftTree:{minNonEmptyGlyphCnt:12,emptyGlyphCnt:3,widthFactor:.35},topTree:{wideWidthFactor:.3,growFactor:1.2,minGlyphCnt:8}};this.opts=e.extend(true,l,t);this.layout=i;this.viewportRect=o;this.headers=[];this.maxGlyphs=0;this.availableGlyphs=0;this.leftCellCnt=0;this.dataColumnsInfo={cnt:0,width:0}}l.prototype={_reset:function t(){this.headers.length=0;this.maxGlyphs=0;this.availableGlyphs=0;this.leftCellCnt=0;this.dataColumnsInfo.cnt=0;this.dataColumnsInfo.width=0},_addCollapseExpandHeader:function t(e){var i=new s(this.opts.collapseExpandIconGlyphCnt,false);i.isCollapseExpandIcon=true;e.push(i);this.availableGlyphs-=this.opts.collapseExpandIconGlyphCnt},_addCollapseExpandHeaders:function t(e){for(var i=0;i<this.leftDimCnt-1&&this.leftDimCnt>1&&this.leftDimCnt<=this.sortOrderCnt;++i)this._addCollapseExpandHeader(e)},_getLeftCollapseExpandCnt:function t(e){return this.isIndentMode?this.leftDimCnt-1:e},_addLeftTreeMetaGhostHeader:function t(e,i,n){var o=n>i,r=new s(i,o,n);e.push(r);this.availableGlyphs-=i},_addEmptyLeftTreeMetaGhostHeader:function t(e,i){var n=new s(i||this.opts.leftTree.emptyGlyphCnt,false);e.push(n);this.availableGlyphs-=n.calcApprMaxGlyphCnt},_getDataGhostHeaders:function t(){var e,i=[],n;for(e=0;this.availableGlyphs>0&&this.totDataColCnt>0&&e<this.totDataColCnt;++e){n=this.longestMeasureGlyphCnt;n+=this.opts.columnPaddingGlyphCnt;n/this.longestTopDimGlyphCnt<this.opts.topTree.wideWidthFactor&&(n+=n*this.opts.topTree.growFactor);0===e&&n>this.availableGlyphs&&(n=this.availableGlyphs);if(this.availableGlyphs-n<0){this.availableGlyphs=0;break}this.availableGlyphs-=n;var o=new s(n,true);i.push(o)}return i},_getLeftGhostHeaders:function t(e,i,n){var o=[],r=this.opts.collapseExpandIconGlyphCnt*this._getLeftCollapseExpandCnt(i),s=this.longestLeftDimGlyphCnt,l=Math.min(this.longestLeftDimTitleGlyphCnt,this.opts.metaHeaderMaxGlyphCnt);i>0?this.isIndentMode?this._getLeftGhostHeadersIndent(o,s,l,r,i,n):this._getLeftGhostHeadersNonIndent(o,i,l,r):this._addEmptyLeftTreeMetaGhostHeader(o,e);return o},_isSpaceForDataColumn:function t(e,i){return this.maxGlyphs-e>=i.calcApprMaxGlyphCnt},_getLeftGhostHeadersIndent:function t(e,i,n,o,r,s){var l=i,a,c;this.pseudoInLeftTree&&(l+=this.longestMeasureTitleGlyphCnt);r>0&&l<this.opts.leftTree.minNonEmptyGlyphCnt&&(l=this.opts.leftTree.minNonEmptyGlyphCnt);l<n-o&&(0===s.length||s.length>0&&this._isSpaceForDataColumn(n-o,s[0]))&&(l=n-o);if(l+o>this.availableGlyphs&&s.length>0&&!this._isSpaceForDataColumn(l+o,s[0])){var u=[],p=[];u.push(Math.ceil(l/3));u.push(Math.ceil(this.opts.leftTree.widthFactor*this.maxGlyphs));u.push(this.opts.metaHeaderMaxGlyphCnt);p.push(Math.min.apply(null,u));r>0&&p.push(this.opts.leftTree.minNonEmptyGlyphCnt);p.push(this.availableGlyphs);c=l;a=Math.max.apply(null,p)}else a=l;this._addCollapseExpandHeaders(e);this._addLeftTreeMetaGhostHeader(e,a,c)},_getLeftGhostHeadersNonIndent:function t(e,i,n,o){this._getLeftDimsWidths(i,n,o).forEach(function(t){this._addCollapseExpandHeader(e);this._addLeftTreeMetaGhostHeader(e,t)},this)},_getLeftDimsWidths:function t(e,i,n){var o=[],r=0,s=0,l,a,c,u;for(a=0;a<e;++a){l=this._getDimGlyphCnt(a)+this.opts.cellPaddingGlyphCnt;r+=l;o.push({target:l,adjusted:l})}if(r<i-n){var p=i-n-r,h=o[o.length-1];h.target+=Math.min(p,this.maxGlyphs-r);h.adjusted=h.target;r=o.reduce(function(t,e){return t+e.target},0)}if(r+n>this.availableGlyphs&&r+n>this.maxGlyphs*this.opts.leftTree.widthFactor){r=0;for(a=0;a<e;++a){l=Math.min(this.opts.metaHeaderMaxGlyphCnt-this.opts.collapseExpandIconGlyphCnt,o[a].target>8?o[a].target/2:o[a].target);o[a].adjusted=l;r+=l}}if(r+n>this.availableGlyphs&&r+n>this.maxGlyphs){s=(r+n-this.maxGlyphs)/r;for(a=0;a<e;++a){l=o[a].adjusted;o[a].adjusted=Math.floor(l-l*s)}}else if(r+n<this.availableGlyphs){u=this.availableGlyphs-r-n;c=o.reduce(function(t,e){return t+(e.adjusted<e.target?e.target:0)},0);for(a=0;a<e;++a){l=o[a];l.adjusted<l.target&&(o[a].adjusted+=Math.floor(l.target/c*u))}}return o.map(function(t){return t.adjusted})},_calculateGhostMetaHeadersWidth:function t(e,i){var n=1,o,r,s;i=i||this.headers;i.forEach(function(t){t.minWidth=t.calcApprMaxGlyphCnt*this.opts.glyphWidth;t.widthFactor=t.minWidth/e;n-=t.widthFactor},this);if(n>0){o=n;s=i.filter(function(t){return t.isWidthFlexible&&t.maxGlyphCnt>t.calcApprMaxGlyphCnt});r=s.reduce(function(t,e){return e.maxGlyphCnt-e.calcApprMaxGlyphCnt},0);s.forEach(function(t){var i=t.maxGlyphCnt-t.calcApprMaxGlyphCnt,s=i/r,l=Math.min(i*this.opts.glyphWidth/e,s*o);t.widthFactor+=l;n-=l},this)}if(n>0){s=i.filter(function(t){return true===t.isWidthFlexible});s.forEach(function(t){t.widthFactor+=n/s.length})}i.forEach(function(t){t.width=Math.floor(t.widthFactor*e);t.style.width=t.width+"px"})},calculateColumns:function t(e){var i=0,n=[],o=true;e.forEach(function(t){t.column=i;if(o){n[i]=[];o=false}n[i][n[i].length]=t;if(!t.isCollapseExpandIcon){i++;o=true}});return n},calculateNumColumns:function t(e){return e.reduce(function(t,e){return t+(e.isCollapseExpandIcon?0:1)},0)},_updateLeftHeadersGlyphCnt:function t(e,i){var n,o,r,s,l,a,c,u,p,h,d;n=e.filter(function(t){return!t.isCollapseExpandIcon});o=e.filter(function(t){return t.isCollapseExpandIcon});r=n.reduce(function(t,e){return t+e.calcApprMaxGlyphCnt},0);s=o.reduce(function(t,e){return t+e.calcApprMaxGlyphCnt},0);l=r*this.opts.glyphWidth;a=s*this.opts.glyphWidth;i=Math.max(i,a);c=i-a;u=c/l;p=0;n.forEach(function(t){t.oldCalcApprMaxGlyphCnt=t.calcApprMaxGlyphCnt;t.calcApprMaxGlyphCnt=Math.floor(t.calcApprMaxGlyphCnt*u);t.calcApprMaxGlyphCnt=Math.max(4,t.calcApprMaxGlyphCnt);p+=t.calcApprMaxGlyphCnt});h=Math.floor(c/this.opts.glyphWidth)-p;n.sort(function(t,e){return e.calcApprMaxGlyphCnt-t.calcApprMaxGlyphCnt});for(d=0;d<h;d++)n[d].calcApprMaxGlyphCnt+=1},update:function t(e,i,n){var o,r,s,l,a,c,u=[],p=[],h=[],d=0;n=n||this.explicitColumnWidths;this._reset();this.maxGlyphs=Math.floor(this.viewportRect.width/this.opts.glyphWidth);this.availableGlyphs=this.maxGlyphs;this.availableGlyphs>0&&(u=this._getDataGhostHeaders());o=this._getLeftGhostHeaders(e,i,u);a=this.calculateColumns(o);for(c=0;c<a.length;c++)if(n[c]>0){this._updateLeftHeadersGlyphCnt(a[c],n[c]);p=p.concat(a[c])}else h=h.concat(a[c]);l=u.reduce(function(t,e){return t+e.calcApprMaxGlyphCnt},0);s=o.reduce(function(t,e){return t+e.calcApprMaxGlyphCnt},0);while(u.length>0&&l+s>this.maxGlyphs){r=u.pop();if(0===u.length&&this.maxGlyphs-s>=this.opts.topTree.minGlyphCnt){r.calcApprMaxGlyphCnt=this.maxGlyphs-s;u.push(r);l=r.calcApprMaxGlyphCnt;break}l-=r.calcApprMaxGlyphCnt}this.leftHeaders=o;this.dataHeaders=u;this.leftColumns=a;this.headers=o.concat(u);this.dataColumnsInfo.cnt=u.length;this.leftCellCnt=o.length;if(o.length&&n&&n.length){for(c=0;c<a.length;c++)if(n[c]>0){this._calculateGhostMetaHeadersWidth(n[c],a[c],this.viewportRect.width);d+=a[c].reduce(function(t,e){return t+e.minWidth},0)}this._calculateGhostMetaHeadersWidth(this.viewportRect.width-d,h.concat(u),this.viewportRect.width);o.forEach(function(t){t.oldCalcApprMaxGlyphCnt&&(t.calcApprMaxGlyphCnt=t.oldCalcApprMaxGlyphCnt)})}else this._calculateGhostMetaHeadersWidth(this.viewportRect.width);this.dataColumnsInfo.width=u[0]?u[0].widthFactor*this.viewportRect.width:0},_getDimGlyphCnt:function t(e){if(e===this.pseudoDimIndex)return this.longestMeasureTitleGlyphCnt;return this.layout.qHyperCube.qDimensionInfo[this.sortOrder[e]].qApprMaxGlyphCount},getDimInfo:function t(e,i){i||(i=0);if(e+i===this.pseudoDimIndex)return;return this.layout.qHyperCube.qDimensionInfo[this.sortOrder[e+i]]}};function a(t){var e=!!this.layout.qHyperCube.qAlwaysFullyExpanded;return this.sortOrder.filter(function(e,i){return t?i>=this.leftDimCnt:i<this.leftDimCnt},this).map(function(t,i){var n=0;if(-1===t)return 0;var o=this.layout.qHyperCube.qDimensionInfo[t];if(i+1<this.leftDimCnt){n=o.qApprMaxGlyphCount;e||(n+=this.opts.collapseExpandIconGlyphCnt);n=Math.max(o.othersLabel?o.othersLabel.length:0,n)}else{n=o.qApprMaxGlyphCount;n+=this.opts.columnPaddingGlyphCnt}return n},this).sort(function(t,e){return e-t})[0]||0}function c(t){return this.sortOrder.filter(function(e,i){return t?i>=this.leftDimCnt:i<this.leftDimCnt},this).map(function(t){var e=0;if(-1===t)e=i.get("Common.Measures").length;else{e=this.layout.qHyperCube.qDimensionInfo[t].qFallbackTitle.length+this.opts.buttonArrowGlyphCnt;this.layout.qHyperCube.qDimensionInfo[t].othersLabel&&(e=Math.max(this.layout.qHyperCube.qDimensionInfo[t].othersLabel.length,e))}return e+this.opts.buttonPaddingGlyphCnt+this.opts.buttonMarginOfSafetyGlyphCnt},this).sort(function(t,e){return e-t})[0]||0}Object.defineProperties(l.prototype,{isIndentMode:{get:function t(){return this.layout.qHyperCube.qIndentMode}},pseudoDimIndex:{get:function t(){var e=this.sortOrder.indexOf(-1);return~e?e:this.sortOrderCnt}},longestMeasureGlyphCnt:{get:function t(){return this.layout.qHyperCube.qMeasureInfo.map(function(t){return Math.max(t.qApprMaxGlyphCount,2)}).sort(function(t,e){return e-t})[0]||0}},longestMeasureTitleGlyphCnt:{get:function t(){return this.layout.qHyperCube.qMeasureInfo.map(function(t){return(t.qFallbackTitle||"").length}).sort(function(t,e){return e-t})[0]||0}},longestLeftDimTitleGlyphCnt:{get:function t(){return c.call(this)}},longestLeftDimGlyphCnt:{get:function t(){return a.call(this)}},longestTopDimGlyphCnt:{get:function t(){return a.call(this,true)}},sortOrder:{get:function t(){return this.layout.qHyperCube.qEffectiveInterColumnSortOrder}},sortOrderCnt:{get:function t(){return this.sortOrder.length}},leftDimCnt:{get:function t(){return this.layout.qHyperCube.qNoOfLeftDims>=0?this.layout.qHyperCube.qNoOfLeftDims:this.sortOrderCnt}},topDimCnt:{get:function t(){return this.sortOrderCnt-this.leftDimCnt}},totDataColCnt:{get:function t(){return this.layout.qHyperCube.qSize.qcx}},pseudoInLeftTree:{get:function t(){return this.pseudoDimIndex<this.leftDimCnt}},pseudoInTopTree:{get:function t(){return-1!==this.sortOrder.slice(this.leftDimCnt).indexOf(-1)}},columnWidths:{get:function t(){var e=this.layout.qHyperCube.columnWidths;return o.isValidColumnWidths(e)?[e[0].slice(),e[1].slice()]:[[],[]]}},explicitColumnWidths:{get:function t(){var e=this.columnWidths,i,n,o,r;if(!e||!e.length||1===e.length&&!Array.isArray(e[0])&&e[0]<=0)return[];if(e.length&&!Array.isArray(e[0])&&e[0]>0)i=e;else{if(this.isIndentMode)return e&&Array.isArray(e[0])?e[0]:[];i=e&&Array.isArray(e[1])?e[1]:[]}n=i?i.length:0;o=[];for(r=0;r<n;r++)o[r]=i[this.sortOrder[r]];return o}}});t.provider("qvPivotTableMetaGhostHeadersProvider",function t(){this.$get=[function(){return function t(e,i,n){return new l(e,i,n)}}]})}.apply(e,n),void 0!==o&&(t.exports=o))},1617:function(t,e,i){"use strict";var n,o;!(n=[i(48),i(1618),i(1058)],o=function(t,e,i){function n(){this.$get=[function(){return function t(n,o,r,s,l,a,c,u){return new(e.extend("PivotTableSortableMetaLists",{addPlaceholder:function t(e,i){var n=this._super.apply(this,arguments);n.style.width=i.width;e.dragging=true},allowAutoScroll:function t(){return false},onBegin:function t(){this._super.apply(this,arguments);c.off();u.off();this.toggleCellsWhenSorting(this.grid.headerRows,this.grid.rows,true)},enable:function t(){this._super.apply(this,arguments);c.on();u.on();this.toggleCellsWhenSorting(this.grid.headerRows,this.grid.rows,false)},allowDrag:function t(){var t=this._super.apply(this,arguments);return t&&!(s&&s.qSelectionInfo&&s.qSelectionInfo.qMadeSelections)},onMove:function t(e){this._super.apply(this,arguments);this.patchPivotingProperties(e.dimIx)},onMoveToList:function t(e){var i=this._super.apply(this,arguments);i&&this.patchPivotingProperties(e.dimIx);return i},onEnterList:function t(e){e===this.rows&&e.isEmpty()&&this.metaGhostHeaders.update(2*this.metaGhostHeaders.opts.leftTree.emptyGlyphCnt);this._super.apply(this,arguments);e===this.columns&&this.rows.isEmpty()&&this.metaGhostHeaders.update(this.metaGhostHeaders.opts.leftTree.emptyGlyphCnt)},patchPivotingProperties:function t(e){var o,r,l,a;function c(t){return t.dimIx}o=this.rows.items.map(c);r=this.columns.items.map(c);this.backendApi.model.getEffectiveProperties().then(function(t){i.validatePivotHyperCube(t.qHyperCubeDef);l=i.reorderColumnOrderDef(e,o,r,t.qHyperCubeDef);a=i.getNoLeftDimsDef(e,o,s.qHyperCube,t.qHyperCubeDef);i.reorderPivotDimensions(t.qHyperCubeDef,l);var c=[{qPath:"/qHyperCubeDef/qInterColumnSortOrder",qOp:"replace",qValue:JSON.stringify(t.qHyperCubeDef.qInterColumnSortOrder)},{qPath:"/qHyperCubeDef/qNoOfLeftDims",qOp:"replace",qValue:JSON.stringify(a)},{qPath:"/qHyperCubeDef/qDimensions",qOp:"replace",qValue:JSON.stringify(t.qHyperCubeDef.qDimensions)}];t.qHyperCubeDef.columnWidths&&c.push({qPath:"/qHyperCubeDef/columnWidths",qOp:"replace",qValue:JSON.stringify(t.qHyperCubeDef.columnWidths)});n.applyPatches(c,true)})},toggleCellsWhenSorting:function t(){var e,i;for(e=arguments.length-1;e>=0;--e){if(!Array.isArray(arguments[e])){i=arguments[e];continue}var n,o=arguments[e];var r,s,l;for(n=0;n<o.length;++n){s=o[n].cells.length;for(r=0;r<s;++r){l=o[n].cells[r];l.isMeta?l[i?"addClass":"removeClass"]("drop"):l[i?"addClass":"removeClass"]("locked")}}}}}))({listSelector:".meta",listKey:function t(e){return e.find(".list").scope().list},itemSelector:".button-wrapper",itemDragSelector:".button-wrapper",itemKey:"header",containerSelector:"table"},n,o,r,s,l,a)}}]}t.provider("qvPivotTablePivoting",n)}.apply(e,n),void 0!==o&&(t.exports=o))},1618:function(t,e,i){"use strict";var n,o;!(n=[i(207),i(91),i(159)],o=function(t,e,i){var n;n=t.extend("SortableMetaLists",{init:function t(e,i,n,o,r,s,l){this._super.apply(this,[e]);this.layout=r;this.backendApi=i;this.grid=n;this.metaGhostHeaders=o;this.$id=s;this.currentPopover=l;this.rows=this.createList();this.rows.templateSrc="pt-meta-list.ng.html";this.columns=this.createList();this.columns.templateSrc="pt-meta-list.ng.html"},reset:function t(){this._super.apply(this,arguments)},update:function t(n){var o,r,s,l,a,c,u=e.get("Common.Values");this.reset();for(o=0;o<this.sortOrderCnt;++o){r=this.sortOrder[o];if(o<this.metaGhostHeaders.leftDimCnt)s=this.rows;else{if(n<=0)continue;s=this.columns}if(-1!==r){c=this.layout.qHyperCube.qDimensionInfo[r].qGroupFieldDefs[this.layout.qHyperCube.qDimensionInfo[r].qGroupPos];a=this.layout.qHyperCube.qDimensionInfo[r].qFallbackTitle;l={title:a,id:this.layout.qHyperCube.qDimensionInfo[r].cId,fieldName:c,style:{},qvaOutsideIgnoreFor:"qv-pt-meta-header-"+this.$id,open:this.currentPopover.header&&c===this.currentPopover.header.fieldName,dimIx:r,locked:!!this.layout.qHyperCube.qDimensionInfo[r].qLocked,dir:i.getAutoOrAlternativeDirection(a)}}else{a=u;l={title:u,dimIx:-1,isPseudoDim:true,style:{},locked:false,dir:i.getAutoOrAlternativeDirection(a)}}l.templateSrc="pt-meta-item.ng.html";s.addSortableItem(l)}}});Object.defineProperties(n.prototype,{sortOrder:{get:function t(){return this.layout.qHyperCube.qEffectiveInterColumnSortOrder}},sortOrderCnt:{get:function t(){return this.sortOrder.length}}});return n}.apply(e,n),void 0!==o&&(t.exports=o))},1619:function(t,e,i){"use strict";var n,o;!(n=[i(48),i(1620)],o=function(t,e){function i(t,i,n,o,r,s,l,a,c,u){var p=i.find(o);var h=p.find(r);var d=h.find(s);var f;var v;var m;f={minRowHeight:n,rect:{left:0,top:0,width:0,height:0},scrollRect:{left:0,top:0,width:0,height:0},rowCount:0,direction:u.direction,getVirtualScrollController:function t(){return p.controller("qvScrollArea")},getSortableListController:function t(){return p.controller("qvSortableList")},getMultiSelectController:function t(){return d.controller("qvSelectionsMultiselect")},getEmptyMetaCellsOfLastHeaderRow:function t(){var e=p.find(".last-top-row .header.empty.left-meta.bottom-meta");return e},getFirstDataCell:function t(){var e=p.find(l),i;i={top:0,left:0,width:0};if(e.length){var n=e[0].getBoundingClientRect(),o=e.position();i.top=o.top;i.left=o.left;i.width=n.width}return i},getTopHeaders:function t(){return p.find(a)},getScrollAreaBBox:function t(){return c&&c.object&&!u.freeResize?e.getSnapshotScrollAreaBBox(p,c.object):p[0].getBoundingClientRect()},getScrollAreaPosition:function t(){return p.position()},getScrollContentBBox:function t(){return h[0].getBoundingClientRect()},updateRowCount:function t(e){f.rowCount=Math.ceil(e)},getMaxRowCount:function t(){return Math.ceil(f.scrollRect.height/f.minRowHeight)},getVisibleRowCount:function t(){var e=i[0].querySelector(l),n,o;if(!e)return 0;n=e.parentNode;o=Array.prototype.slice.call(n.parentNode.childNodes);o=o.filter(function(t){return t.nodeType===Node.ELEMENT_NODE});o=o.splice(o.indexOf(n));function r(t,e){var i=t.offsetTop+t.getBoundingClientRect().height,n=e.top+e.height;return i<=n}function s(t,e){var i=e-t;return 1===i?e:Math.floor(t+i/2)}function a(t,e,i){var n=i-e,o=s(e,i),l=r(t[o],f.scrollRect);if(0===n)return l?o:-1;if(1===n)return l?o:a(t,e,e);return l?a(t,o,i):a(t,e,o)}if(0===o.length)return 0;var c=a(o,0,o.length-1)+1;if(c===o.length){var u=o[o.length-1],p=f.scrollRect.top+f.scrollRect.height-(u.offsetTop+u.getBoundingClientRect().height);c+=Math.floor(p/(3*f.minRowHeight))}return c},updateRect:function e(){v=t(function(){var t=f.getScrollAreaBBox(),e=f.getFirstDataCell();f.rect.top=t.top;f.rect.left=t.left;f.rect.width=t.width;f.rect.height=t.height;f.updateRowCount((f.rect.height-e.top)/f.minRowHeight)},false);return v},updateScrollRect:function e(i){m=t(function(){var t=f.getScrollAreaPosition(),e=f.getFirstDataCell();f.scrollRect.top=t.top+e.top;f.scrollRect.height=f.rect.height-e.top;if("rtl"===f.direction){f.scrollRect.left=0;f.scrollRect.width=e.left+e.width}else{f.scrollRect.left=e.left;f.scrollRect.width=f.rect.width-e.left}if(i){f.updateRowCount(f.collapsedRowCount||f.scrollRect.height/f.minRowHeight);delete f.collapsedRowCount}},false);return m},getScrollRect:function t(){return{top:f.scrollRect.top,left:f.scrollRect.left,width:f.scrollRect.width,height:f.scrollRect.height}}};return f}function n(t){return i.bind(null,t)}function o(){this.$get=["$timeout",n]}t.provider("qvPivotTableViewportProvider",o)}.apply(e,n),void 0!==o&&(t.exports=o))},1620:function(t,e,i){"use strict";var n,o;!(n=[],o=function(){function t(t,e){var i=t[0].getBoundingClientRect();return{height:e.size.h,width:e.size.w,top:i.top,left:i.left}}return{getSnapshotScrollAreaBBox:t}}.apply(e,n),void 0!==o&&(t.exports=o))},1621:function(t,e,i){"use strict";var n,o;!(n=[i(48)],o=function(t){function e(t,e,i){var n=t.getVirtualScrollController(),o,r,s={active:false,activeFromStart:false},l={xAxis:0,yAxis:0};r={page:{qLeft:0,qTop:0,qWidth:0,qHeight:0},equalsPage:function t(e){return this.page.qLeft===e.qLeft&&this.page.qTop===e.qTop&&this.page.qWidth===e.qWidth&&this.page.qHeight===e.qHeight},setPage:function t(e){this.page.qLeft=e.qLeft;this.page.qTop=e.qTop;this.page.qWidth=e.qWidth;this.page.qHeight=e.qHeight},onGetData:function t(e){o=e},scroll:function t(e,i,o){var r=n.getScrollAmount(e,i,o);n.scroll(r.deltaX,r.deltaY,false,false)},DELTA_MODE:n.DELTA_MODE,setScrollViewport:function e(){return t.updateScrollRect(false).then(function(){n.setViewport(t.getScrollRect())}).catch(function(t){false})},setVirtualSize:function o(){var l=this;return t.updateScrollRect(true).then(function(){var o,a,c,u,p;s.active=false;s.activeFromStart=false;if(t.scrollRect.top+t.scrollRect.height>=t.rect.height&&r.page.qHeight>=i.qcy){o=t.getVisibleRowCount();if(o<r.page.qHeight){s.active=true;s.activeFromStart=true;t.updateRowCount(o)}}a={vPosY:l.page.qTop*t.minRowHeight,vPosX:l.page.qLeft*e.width};u=r.page.qWidth===i.qcx?t.scrollRect.width:i.qcx*e.width;c={width:u,height:i.qcy*t.minRowHeight};p={width:t.scrollRect.width,height:t.rowCount*t.minRowHeight};n.setVirtualSize(c,p,t.getScrollRect());(a.vPosY>0||a.vPosX>0)&&n.scroll(a.vPosX,a.vPosY)}).catch(function(t){false})},alignToBottom:function e(){var i=false;if(s.active){if(l.yAxis>0){var o=t.getVisibleRowCount();o<t.rowCount&&t.updateRowCount(o)}else{var r=t.getMaxRowCount();t.rowCount>=r&&(s.active=false);i=true}n.setVirtualViewport({width:t.scrollRect.width,height:t.rowCount*t.minRowHeight});i&&n.setVirtualScrollPos(0,-1)}}};function a(e){var n=t.getMaxRowCount();if(s.activeFromStart)return;e.qHeight=Math.min(i.qcy-e.qTop,n);t.updateRowCount(Math.min(e.qHeight,t.rowCount))}function c(i){return{qLeft:e.cnt>0?Math.round(i.vPosX/e.width):0,qTop:Math.round(i.vPosY/t.minRowHeight),qWidth:Math.max(1,e.cnt),qHeight:Math.max(1,t.rowCount)}}function u(t){if(t.qTop>0&&t.qTop+t.qHeight>i.qcy){t.qTop=Math.max(0,i.qcy-t.qHeight);t.qHeight=Math.min(i.qcy,t.qHeight)}if(t.qLeft>0&&t.qLeft+t.qWidth>i.qcx){t.qLeft=Math.max(0,i.qcx-t.qWidth);t.qWidth=Math.min(i.qcx,t.qWidth)}}n.onScroll(function(t,e){var i=n.getVirtualPosition(),p=n.getMaxPosition(),h=c(i);if(s.active&&e<0){a(h);p=n.getMaxPosition()}p.vPosY>0&&i.vPosY===p.vPosY&&(s.active=true);u(h);s.lastTop=h.qTop;l.xAxis=t;l.yAxis=e;if(!r.equalsPage(h)||s.active){r.setPage(h);o(r.page).then(function(){r.alignToBottom()})}});n.getScrollAmount=function(i,o,r){var s=n.getVirtualPosition();var l=n.getMaxPosition();switch(r){case 1:return{deltaX:e.width*i,deltaY:t.minRowHeight*o};case 2:return{deltaX:e.cnt*e.width*i,deltaY:t.minRowHeight*t.rowCount*o};case 10:return{deltaX:0,deltaY:o>0?s.vPosY*o:s.vPosY-l.vPosY};default:return{deltaX:i,deltaY:o}}};return r}function i(){return e}function n(){this.$get=[i]}t.provider("qvPivotTableVirtualScrollProvider",n)}.apply(e,n),void 0!==o&&(t.exports=o))},1622:function(t,e,i){"use strict";var n,o;!(n=[i(48),i(11),i(164),i(101)],o=function(t,e,i,n){function o(t,o,r,s,l,a,c,u){var p=t.$new(),h;function d(e,i){var n,r,s,l=[],a,c,u,h=p.dataValuesArray.length,d;n=e.getRowsByCellType(e.CELL_TYPE_TOP).concat(e.getRowsByCellType(e.CELL_TYPE_LEFT));c=h>0?o.getSiblingCells(e,i):[];r=n.length;for(d=0;d<r;++d)l=l.concat(n[d].cells);a=l.length;for(d=0;d<a;++d){s=l[d];u=-1!==c.indexOf(s);(u&&!s.isDimensionValue||!u&&!s.isMeta)&&t[h?"lockCell":"unlockCell"](e,s)}}function f(){if(!p.active)return;t.updatePivot(a,p,p.currentCell);d(a,p.currentCell)}function v(){u.on();h&&h()}function m(){u.on();h&&h()}function g(){if(!p.active||!p.currentCell)return;o.getSiblingCells(a,p.currentCell).forEach(function(e){t.deselectCell(a,e)});d(a,p.currentCell)}function y(t,e){var i=n.getValue(t,"layout.qHyperCube.qDimensionInfo."+e,{});var o=i.qIsOneAndOnlyOne||false;return o}r.excludeDimensionToggle=function(t){return!s.active&&e(t.target).is(".qv-pt-expandable")};r.selectDimensionValue=function(e,i){var n=s.getKeyAsToggleSelected(i);var o;o=t.isColumnar(a,e)?e.dataColIx:r.metaGhostHeaders.leftDimCnt+e.dataRowIx;var c=r.layout.qHyperCube.qEffectiveInterColumnSortOrder[o];if(y(r,c)||!n){g();t.reset(p)}h=t.selectDimensionValue(r.$id,l,s,p,e,a,n);d(a,p.currentCell)};r.activateSelections=function(e){h=t.activateSelections(r.$id,l,s,p,e)};r.multiselectDimensionValues=function(e,i){var n,c,u,h=o.getSiblingCells(a,e),f=h.length,v,m=t.isColumnar(a,e),g=m?e.dataRowIx:e.dataColIx,y=m?i.dataRowIx:i.dataColIx;if(-1===h.indexOf(i)||!i.isDimensionValue)return;for(n=0;n<f;++n){u=h[n];c=m?u.dataRowIx:u.dataColIx;v=g<=y?c>=g&&c<=y:c>=y&&c<=g;v&&u.isDimensionValue&&u!==i&&t.selectDimensionCells(l,s,p,r.grid,u,false)}t.selectDimensionCells(l,s,p,r.grid,i,false);d(a,p.currentCell)};r.multiselect=function(){p.active&&t.sendSelection(l,s,p,a,p.currentCell)};r.selectWhileLocked=function(){if(p.dataValuesArray.length>0)return;i.showLockedFeedback(c.qHyperCube.qDimensionInfo)};s.watchActivated(function(){u.off()});t.init(s,l,p,v,m,g);return{updateSelections:f}}function r(t,e){return o.bind(null,t,e)}function s(){this.$get=["qvGridObjectSelectionService","qvGridObjectDataService",r]}t.provider("qvPivotTableSelectionsProvider",s)}.apply(e,n),void 0!==o&&(t.exports=o))},1623:function(t,e,i){"use strict";var n,o;!(n=[i(11),i(48),i(1624),i(1625),i(207),i(91),i(249)],o=function(t,e,i,n,o,r){var s={Dimension:"dimension",Measure:"measure",Pseudo:"pseudo"};e.getService("$templateCache").put("pivot-panel-item.ng.html",n);e.directive("qvPivotPanel2",function(){return{restrict:"E",template:i,replace:true,scope:{layout:"=layout",backendApi:"=backendApi"},controller:["$scope","$element",function(e,i){var n=this;e.itemTemplateSrc="pivot-panel-item.ng.html";e.sortableItemLists=o.create({options:{listKey:"list",listSelector:".qv-pivot-panel-column",itemSelector:".sortable",itemDragSelector:".icon-handle",itemKey:"item"},addPlaceholder:function t(){var e=this._super.apply(this,arguments);e.addClass("sortable")},bindAutoScroll:function e(){var n=i.find(".qv-pivot-panel-list ul");n.each(function(){var e=t(this),i=e.scope().list;i.scrollInfo={elem:e[0],clientRect:e[0].getBoundingClientRect(),scrollWidth:e[0].scrollWidth,scrollHeight:e[0].scrollHeight}})},onBegin:function t(){this._super.apply(this,arguments);this.bindAutoScroll()},onEnterList:function t(){this.bindAutoScroll()},onMove:function t(){var e=this._super.apply(this,arguments);e&&n.sortOrderUpdated();return e},onMoveToList:function t(e,i){var o=this._super.apply(this,arguments);if(o){if(i.disabled)return;n.sortOrderUpdated()}return o},onAutoScroll:function t(e,i,n,o){this._super.apply(this,arguments);!i&&n&&(i=this.getList(n));if(!i)return;var r=i.scrollInfo;o(r.elem,r.clientRect,r.scrollWidth,r.scrollHeight)}});e.columns=e.sortableItemLists.createList(1,{title:r.get("Common.Columns"),showMoveHandle:true});e.rows=e.sortableItemLists.createList(1,{title:r.get("Common.Rows"),showMoveHandle:true});e.measures=e.sortableItemLists.createList(2,{title:r.get("Common.Measures")});e.grid={rows:[]};e.grid.rows.push({lists:[e.columns]});e.grid.rows.push({lists:[e.rows,e.measures]});n.sortOrderUpdated=function(){var t=[],i;e.rows.items.forEach(function(e){t.push(e.dimIndex)});i=t.length;e.columns.items.forEach(function(e){t.push(e.dimIndex)});var n=[{qPath:"/qHyperCubeDef/qInterColumnSortOrder",qOp:"replace",qValue:JSON.stringify(t)},{qPath:"/qHyperCubeDef/qNoOfLeftDims",qOp:"replace",qValue:JSON.stringify(i)}];e.backendApi.applyPatches(n,true)};function l(t){var e;e=t.qLibraryId?t.title||"":t.qFallbackTitle||"";return e}function a(){var t=e.layout.qHyperCube.qNoOfLeftDims,i;e.sortableItemLists.reset();i=e.layout.qHyperCube.qEffectiveInterColumnSortOrder.map(function(t){var i;e.$broadcast("pivotPanelUpdated");if(-1===t)return{title:"Measures",cId:"pseudo-dimension",type:s.Pseudo,dimIndex:t,cssClass:["sortable","is-pseudo"]};i=e.layout.qHyperCube.qDimensionInfo[t];return{title:l(i),cId:i.cId,type:s.Dimension,dimIndex:t,cssClass:["sortable"]}});t=t<0?i.length:t;i.splice(0,t).forEach(function(t){var i=e.rows.add(t.title,t.cId,t.cssClass,1);i.dimIndex=t.dimIndex});i.forEach(function(t){var i=e.columns.add(t.title,t.cId,t.cssClass,1);i.dimIndex=t.dimIndex});e.layout.qHyperCube.qMeasureInfo.forEach(function(t){e.measures.add(t.qFallbackTitle||"",t.cId,[],2)})}e.$watchCollection("layout.qHyperCube.qDimensionInfo",a);e.$watchCollection("layout.qHyperCube.qEffectiveInterColumnSortOrder",a);e.$watchCollection("layout.qHyperCube.qMeasureInfo",a);e.$watchCollection("layout.qHyperCube.qNoOfLeftDims",a)}]}})}.apply(e,n),void 0!==o&&(t.exports=o))},1624:function(t,e){t.exports='<div class="qv-pivot-panel"\n\t qv-sortable-list="sortableItemLists">\n\t<div class="qv-pivot-panel-row" ng-repeat="row in grid.rows">\n\t\t<div class="qv-pivot-panel-column" ng-if="$first"></div>\n\t\t<div ng-repeat="list in row.lists" class="qv-pivot-panel-column" ng-class="{\'qv-pivot-panel-disabled\': list.disabled}">\n\t\t\t<h2>{{list.title}}</h2>\n\t\t\t<div class="qv-pivot-panel-list">\n\t\t\t\t<ul>\n\t\t\t\t\t<li ng-repeat="item in list.items track by item.id" class="qv-pivot-panel-item" ng-class="item.classList" ng-include src="itemTemplateSrc"></li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n'},1625:function(t,e){t.exports='<div class="field-wrapper field-token" ng-style="item.style">\n\t<div ng-if="list.showMoveHandle" class="icon-handle"></div>\n\t<div class="field-text">{{item.title}}</div>\n</div>\n'},207:function(t,e,i){"use strict";var n,o;!(n=[i(92),i(90),i(249),i(303)],o=function(t,e,i,n){var o=t.extend("SortableItemList",{init:function t(e,i){this.items=[];this.disabled=false;this.typeFlag=e||1;this.locked=false;Object.keys(i||{}).forEach(function(t){this[t]=i[t]},this)},addSortableItem:function t(e,i){Object.defineProperty(e,"__sortableItem__",{configurable:false,enumerable:true,writable:true,value:{typeFlag:i||1}});this.items.push(e)},moveItem:function t(e,i){this.items.splice(i,0,this.items.splice(e,1)[0])},getIndexByItem:function t(e){return this.items.indexOf(e)},get:function t(e){return this.items.filter(e||function(){return true})},getLockedIndices:function t(){return this.get(function(t){return!!(t.__sortableItem__.typeFlag&n.TYPEFLAG_LOCKED)}).map(function(t){return this.getIndexByItem(t)},this)},reset:function t(){this.items.length=0;this.disabled=false},isEmpty:function t(){return 0===this.items.length},setLocked:function t(e){this.locked=e}});Object.defineProperties(o.prototype,{length:{get:function t(){return this.items.length}}});var r=i.extend("SortableItemLists",{init:function t(){this._super.apply(this,arguments);this.lists=[];this.dragPlaceholder=null},addPlaceholder:function t(i){var o=this.getList(i),r=o?o.items.indexOf(i):-1;this.dragPlaceholder=e.extend(true,{},i);this.dragPlaceholder.id="placeholder";this.dragPlaceholder.__sortableItem__.typeFlag=n.TYPEFLAG_PLACEHOLDER;this.dragPlaceholder.style={opacity:"0.3"};o&&o.items.splice(r,0,this.dragPlaceholder);return this.dragPlaceholder},removePlaceholder:function t(){if(!this.dragPlaceholder)return;var e=this.getList(this.dragPlaceholder),i=e?e.items.indexOf(this.dragPlaceholder):-1;if(-1!==i){e.items.splice(i,1);this.dragPlaceholder=null}},getPlaceholder:function t(){return this.dragPlaceholder},createList:function t(e,i){var n=new o(e,i);this.lists.push(n);return n},reset:function t(){this.lists.forEach(function(t){t.reset()})},getList:function t(e){return this.lists.filter(function(t){return-1!==t.items.indexOf(e)})[0]},disable:function t(e){this.lists.forEach(function(t){t.disabled=!(e.__sortableItem__.typeFlag&t.typeFlag)})},enable:function t(){this.lists.forEach(function(t){t.disabled=false})},getIndexOfItem:function t(e){var i=this.getList(e);var n=i?i.items.indexOf(e):-1;return n},moveItem:function t(e,i){var n=this.getList(e),o=this.getList(i),r,s;if(!n||!o)return;s=o.items.indexOf(i);r=n.items.indexOf(e);n.items.splice(r,1);o.items.splice(s,0,e)},onBegin:function t(e,i){this.addPlaceholder(e,i);this.disable(e)},onEnter:function t(e,i){var o=this.getList(e),r=o.getLockedIndices();if(e===this.dragPlaceholder)return;if(i===n.ENTER_BEFORE||i===n.ENTER_AFTER){var s=this.getList(this.dragPlaceholder),l,a;if(!s||!o)return;l=s.getIndexByItem(this.dragPlaceholder);s.items.splice(l,1);a=o.getIndexByItem(e);a+=i===n.ENTER_AFTER?1:0;o.items.splice(a,0,this.dragPlaceholder)}else this.moveItem(this.dragPlaceholder,e);var c=o.getLockedIndices();r.forEach(function(t,e){o.moveItem(c[e],t)})},onEnterList:function t(e){if(e.disabled||e.locked)return;var i=this.getList(this.dragPlaceholder);if(!i)return;var n=i.getIndexByItem(this.dragPlaceholder);i.items.splice(n,1);e.items.push(this.dragPlaceholder)},onMove:function t(e){if(-1===this.getIndexOfItem(e)){this.onCancel();return false}var i=this.dragPlaceholder;this.moveItem(e,i);this.removePlaceholder();this.enable();return true},onMoveToList:function t(e,i){var n=this.getList(e);if(n&&!(i.disabled||i.locked)){var o=n.items.indexOf(e);if(n===i){this.onMove(e,this.dragPlaceholder);return true}n.items.splice(o,1);i.items.push(e)}this.removePlaceholder();this.enable();return!!n},onCancel:function t(){this.removePlaceholder();this.enable()},allowEnter:function t(e,i){var n=this.getList(e);return void 0!==n&&!n.disabled&&!n.locked&&!!(i.__sortableItem__.typeFlag&n.typeFlag)},allowEnterList:function t(e,i){return!e.disabled&&!e.locked&&!!(i.__sortableItem__.typeFlag&e.typeFlag)}});r.create=function(t){var e=r.extend(t||{});t=new e(t&&t.options);return t};return r}.apply(e,n),void 0!==o&&(t.exports=o))},393:function(t,e,i){"use strict";var n,o;!(n=[i(10),i(48)],o=function(t,e){var i=document.createElement("textarea");i.style.position="absolute";i.style.left="-9999px";i.setAttribute("readonly","");function n(t){i.value=t;document.body.appendChild(i);i.select();i.setSelectionRange(0,i.value.length);document.execCommand("copy");document.body.removeChild(i)}e.service("qvCopy",["$window",function(e){var i=t.element(e.document.body);var n=t.element("<textarea/>");n.css({position:"fixed",opacity:"0"});return function(t){n.val(t);i.append(n);n[0].select();try{var e=document.execCommand("copy");if(!e)throw e}catch(e){window.prompt("Copy to clipboard: Ctrl+C, Enter",t)}n.remove()}}]);e.directive("qvClickCopy",["qvCopy",function(t){return{restrict:"A",link:function e(i,n,o){n.bind("click",function(){t(o.qvClickCopy)})}}}]);return{copyToClipboard:n}}.apply(e,n),void 0!==o&&(t.exports=o))}}]);