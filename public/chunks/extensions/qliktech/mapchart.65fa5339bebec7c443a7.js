/*!
 * sense-client@6.105.4
 * 
 * Copyright(C) 2019 Qlik International AB
 * All Rights Reserved
 * 
 */
(window["qJsonp"]=window["qJsonp"]||[]).push([[50,0,8,13,46],Array(105).concat([function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={Precedents:{PrecedentTypes:{Like:"like",Dislike:"dislike"}},Visualization:{ChartTypes:{Custom:"custom",Kpi:"kpi",Gauge:"gauge",BarChart:"barchart",ValueRange:"ValueRange",Table:"table",Mapping:"Mapping"},CustomVisualizations:{CountFact:"countFact",Ordinal:"Ordinal",NullFacts:"nullFacts",RangeFacts:"rangeFacts",UniValueFrequency:"uniValueFrequency",DTypeFacts:"dTypeFacts",ValueFrequency:"valueFrequency",TemporalFacts:"temporalFacts",MixedTypeValues:"mixedTypeValues"},Actions:{Bucketing:"bucket",Ordinal:"ordinal",SplitValuesDef:"splitValuesDef",SplitValues:"splitValues",SplitEmail:"splitEmail",SplitAddress:"splitAddress",SplitField:"splitField",MapValues:"mapValues",MixedTypeValues:"mixedTypeValues",RenameMapping:"rename",MapNulls:"mapNulls",MappingLimit:99,SplitLimit:9},Size:{Auto:"auto",Small:"small",Medium:"medium",Large:"large"},Layout:{Cellspan:{Small:1,Medium:2,Large:3}},ValueRangeDisplayModes:{Text:"text",RangeLine:"rangeLine"}},Events:{Associations:{ApplyRecommendation:"ApplyRecommendation",ToggleAssociationsRecommendationsPanel:"ToggleAssociationsRecommendationsPanel",UpdateAssociationsRecommendationsToolbarButtonState:"UpdateAssociationsRecommendationsToolbarButtonState"},TablePreview:{UpdateTablePreview:"UpdateTablePreview"},SplitAction:{Reset:"SpitActionReset",Validate:"SpitActionValidate",LoadComplete:"CardLoadComplete"},EditorDetailsPane:{CardsResize:"cardsResize",ResizeChart:"resizeChart",BucketingChange:"bucketingChange",BucketingReset:"bucketingReset",OrderingChange:"orderingChange",FieldCreated:"fieldCreated",MappingCreated:"MappingCreated",MappingReset:"MappingReset",DisableMappingActionButtons:"DisableMappingActionButtons"},PubSub:{ForceReloadComplete:"/datamanager/forcereloadcomplete",StartSpinInvalidation:"/spin/start/invalidation",StopSpinInvalidation:"/spin/stop/invalidation",StartSpin:"/spin/start",StopSpin:"/spin/stop",ConnectionDeleted:"/connection/deleted",ConnectionCreated:"/connection/created",AppDetailsViewChange:"/datamanager/appdetailsviewchange",ExpandSmartSearchSuggestedChart:"expandSmartSearchSuggestedChart",RestoreSearchState:"restoreSearchState"}},KeyCodes:{Enter:13,Esc:27,Up:38,Down:40,Tab:9,SpaceBar:32,Delete:8},AddData:{Folder:"folder",InlineData:"inlinedata"},Tags:{Hidden:"$hidden"},JoinTables:{joinTypes:{join:"Join",innerJoin:"Inner Join",outerJoin:"Outer Join",leftJoin:"Left Join",rightJoin:"Right Join"}},Toolbar:{height:42}};return t}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(135),n(177),n(90)],a=function(t,e,n){var i={getUrlForHub:function e(){return t.buildHubUrl().replace("/noData/true","")},getUrlForSheet:function i(a,s,r){var o=n.getParameterByName("app");s||(s=e.analysis(o).state);if(r)return t.buildUrl(true,"sense","app",o,"sheet",a,"state",s,"overlay",r);return t.buildUrl(true,"sense","app",o,"sheet",a,"state",s)},getUrlForStory:function i(a,s,r){var o=n.getParameterByName("app");"undefined"===typeof s&&(s=e.story(o).state||"editstory");return r?t.buildUrl(true,"sense","app",o,"story",a,"state",s,"slide",r):t.buildUrl(true,"sense","app",o,"story",a,"state",s)},getUrlForOverview:function e(){var i=n.getParameterByName("app");return t.buildUrl(true,"sense","app",i)},getUrlForDataModelViewer:function e(){var i=n.getParameterByName("app");return t.buildUrl(true,"datamodelviewer","app",i)},getUrlForDataLoadEditor:function e(){var i=n.getParameterByName("app");return t.buildUrl(true,"dataloadeditor","app",i)},getUrlForDataManager:function e(){var i=n.getParameterByName("app");return t.buildUrl(true,"sense","app",i,"datamanager","datamanager")},goToHub:function e(){t.setUrl(i.getUrlForHub(),false,false,true)},goToOverview:function e(){t.setUrl(i.getUrlForOverview())},goToDataManager:function e(){t.setUrl(i.getUrlForDataManager())},goToDataModelViewer:function e(){t.setUrl(i.getUrlForDataModelViewer())},goToDataLoadEditor:function e(){t.setUrl(i.getUrlForDataLoadEditor())},goToSheet:function e(n,a,s){t.setUrl(i.getUrlForSheet(n,a,s))},goToStory:function e(n,a,s){t.setUrl(i.getUrlForStory(n,a,s))}};return i}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(11),n(95),n(92),n(89),n(90),n(183),n(396),n(105),n(182)],a=function(t,e,i,a,s,r,o,l,c){var u;var d=i.extend("DataPrepRestService",{init:function t(){},_getAPI:function t(){u||(u=r.getApi("api/dataprepservice/v1","openapi",void 0,void 0,void 0,void 0,c.getServerNodeId()));return u},_handleRestResponse:function t(i,a,s){if(s.body&&s.body.notification&&1005===s.body.notification.data.code){e.publish(l.Events.PubSub.StartSpin,{method:i});return this.executeAfterReload({apiFunc:this[i],initialParams:a}).finally(function(){e.publish(l.Events.PubSub.StopSpin,{method:i})})}s.body.response&&s.body.response.loadModel&&Promise.all([n.e(22),n.e(93)]).then(function(){var t=[n(253)];(function(t){t.updateProperties(s.body.response.loadModel)}).apply(null,t)}).catch(n.oe);return s.body.response},executeAfterReload:function t(e){var n=new a;this.waitForReload(n);return n.promise.then(function(){return e.apiFunc.apply(this,e.initialParams)}.bind(this))},waitForReload:function t(e){this.getProgress().then(function(t){this._checkProgress(t.result)?e.resolve(true):setTimeout(function(){this.waitForReload(e)}.bind(this),1e3)}.bind(this),function(t){e.reject(t)})},_checkProgress:function t(e){var n=false;e.engine&&e.engine.qProgressData&&e.engine.qProgressData.qFinished&&true===e.dps.dataLoad.complete&&true===e.dps.profiling.complete&&(n=true);return n},_getAppName:function t(){return s.getParameterByName("app")},getRestResponseHandler:function t(e,n){return function(){return this[e].bind(this,n)}.bind(this)},getSerializedLoadModel:function t(){var e=this;var n=arguments;return this._getAPI().then(function(t){return t.apis.model.getCurrentLoadModel({appId:e._getAppName()}).then(e._handleRestResponse.bind(e,"getSerializedLoadModel",n))})},_addTables:function t(e){var n=this;var i=arguments;return this._getAPI().then(function(t){return t.apis.table.addTables({appId:n._getAppName(),body:e}).then(n._handleRestResponse.bind(n,"_addTables",i))})},_getDesiredTransforms:function t(){var e=[];e.push("makeGeoPoint");e.push("lookupGeoInfo");return e},isRunning:function t(){return this._getAPI()},getForcedConcatRecommendations:function t(e){var n=this;var i=arguments;return this._getAPI().then(function(t){var a={type:"concatenate",queries:e};return t.apis.table.recommendTableTransformation({appId:n._getAppName(),body:a}).then(n._handleRestResponse.bind(n,"getForcedConcatRecommendations",i))})},getTargetTables:function t(e,n){var i=this;var a=arguments;return this._getAPI().then(function(t){return t.apis.table.getCurrentTables({appId:i._getAppName(),forceReload:e,noData:n}).then(i._handleRestResponse.bind(i,"getTargetTables",a))})},getRecommendations:function t(){var e=this;var n=arguments;return this._getAPI().then(function(t){return t.apis.model.getRecommendations({appId:e._getAppName()}).then(e._handleRestResponse.bind(e,"getRecommendations",n))})},getCurrentClassification:function t(){var e=this;var n=arguments;return this._getAPI().then(function(t){return t.apis.model.getCurrentClassification({appId:e._getAppName()}).then(e._handleRestResponse.bind(e,"getCurrentClassification",n))})},getTableRecommendations:function t(e){var n=this;var i=arguments;return this._getAPI().then(function(t){return t.apis.table.getTableRecommendations({appId:n._getAppName(),tableId:e}).then(n._handleRestResponse.bind(n,"getTableRecommendations",i))})},getTargetTablePreview:function t(e){var n=this;var i=arguments;return this._getAPI().then(function(t){return t.apis.table.getPreviewData({appId:n._getAppName(),tableId:e}).then(n._handleRestResponse.bind(n,"getTargetTablePreview",i))})},getTableFields:function t(e){var n=this;var i=arguments;return this._getAPI().then(function(t){return t.apis.field.getFieldExpressions({appId:n._getAppName(),tableId:e}).then(n._handleRestResponse.bind(n,"getTableFields",i))})},getLoadScript:function t(e){var n=this;var i=arguments;return this._getAPI().then(function(t){return t.apis.model.getCurrentScript({appId:n._getAppName(),useCache:e}).then(n._handleRestResponse.bind(n,"getLoadScript",i))})},invokeWithPolling:function t(n,i,a){i&&e.publish(l.Events.PubSub.StartSpin,{method:a});var s=true;var r=void 0;r=setInterval(function(){s&&this.getProgress().then(function(){})}.bind(this),15e3);var o=function t(){s=false;void 0!==r&&clearInterval(r);r=void 0};return n().then(function(t){o();i&&e.publish(l.Events.PubSub.StopSpin,{method:a});return t},function(t){o();i&&e.publish(l.Events.PubSub.StopSpin);throw t})},invokeWithGlobalSpinnerSupport:function t(n){e.publish(l.Events.PubSub.StartSpinInvalidation);return n().catch(function(){e.publish(l.Events.PubSub.StopSpinInvalidation)})},createConcatenatedQuery:function t(e,n,i){var a=this;var s=arguments;return this.invokeWithGlobalSpinnerSupport(function(){return a._getAPI().then(function(t){var r={type:"forceConcatenate",payload:{name:e,queries:n,mappings:i}};return t.apis.table.applyTransformation({appId:a._getAppName(),body:r}).then(a._handleRestResponse.bind(a,"createConcatenatedQuery",s))})})},createJoinedQuery:function t(e,n,i,a){var s=this;var r=arguments;return this.invokeWithGlobalSpinnerSupport(function(){return s._getAPI().then(function(t){var o={type:"join",payload:{name:e,joinType:n,queries:i,mappings:a}};return t.apis.table.applyTransformation({appId:s._getAppName(),body:o}).then(s._handleRestResponse.bind(s,"createJoinedQuery",r))})})},splitQuery:function t(e,n){var i=this;var a=arguments;return this.invokeWithGlobalSpinnerSupport(function(){return i._getAPI().then(function(t){var s={type:"split",payload:{queries:[e],queryProperties:[{sourceQueries:n}]}};return t.apis.table.applyTransformation({appId:i._getAppName(),body:s}).then(i._handleRestResponse.bind(i,"splitQuery",a))})})},synchronizeScriptedTables:function t(){return this.invokeWithPolling(function(){return this.addTables([],true).then(function(t){return t})}.bind(this),true,"synchronize")},getProgress:function t(){var e=this;var n=arguments;return this._getAPI().then(function(t){var i={appId:e._getAppName()};return t.apis.session.getProgress(i).then(e._handleRestResponse.bind(e,"getProgress",n))})},addTables:function e(n,i){var a={data:[],applyTransformations:this._getDesiredTransforms(),defaults:{},scriptedSources:i};for(var s=0;s<n.length;s++){var r=n[s];var l={tables:[]};l.connectionInfo=t.extend(true,{},r.connectionInfo,{dbInfo:r.dbInfo});a.data.push(l);var c=l.tables;r.tablesAndFields.map(function(t){var e={databaseName:r.databaseName,ownerName:r.ownerName,tableName:t.table.qName,formatSpec:t.table.qFormatSpec,fileFormatSettings:t.table.fileFormatSettings};e.fields=[];t.fields.forEach(function(t){e.fields.push({name:t.qName,selected:true})});c.push(e)})}var u=new o;return u.get().then(function(t){a.defaults.enableQVDCaching=t.enableQVDCaching;return this._addTables(a)}.bind(this))},getVisRecommendations:function t(e,n,i,a,s){var r=this;var o=arguments;return this._getAPI().then(function(t){var l={appId:r._getAppName()};if(e){var c=["fields","libItems","expressions"];c.forEach(function(t){e[t]&&e[t].length&&(l[t]=JSON.stringify(e[t]))});e["table"]&&(l["table"]=e["table"])}i&&(l.bundleOverride=JSON.stringify(i));a&&(l.detailLevel=JSON.stringify([]));s&&(l.options=JSON.stringify(s));var u=t.apis.visualization;var d=n?u.getVisualizationsForLoaded(l):u.getVisualizationsForCurrent(l);return d.then(r._handleRestResponse.bind(r,"getVisRecommendations",o))})},getInsightRecommendations:function t(e,n,i,a,s){var r=this;var o=arguments;i||(i=true);return this._getAPI().then(function(t){var l={appId:r._getAppName()};e&&(l["sp"]=e);n&&(l.bundleOverride=JSON.stringify(n));a&&(l.detailLevel=JSON.stringify([]));s&&(l.options=JSON.stringify(s));var c=t.apis.visualization;var u=i?c.getVisualizationsForLoaded(l):c.getVisualizationsForCurrent(l);return u.then(r._handleRestResponse.bind(r,"getVisRecommendations",o))})},bucketField:function t(e,n,i){var a=this;var s=arguments;return this._getAPI().then(function(t){var r={type:"bucket",bucketing:i};r.bucketing.fieldId=n;var o={appId:a._getAppName(),tableId:e,body:r};return t.apis.table.applyTableTransformation(o).then(a._handleRestResponse.bind(a,"bucketField",s))})},applyOrdinal:function t(e,n,i){var a=this;var s=arguments;return this._getAPI().then(function(t){var r={type:"ordinal",ordinals:i};var o={appId:a._getAppName(),tableId:e,fieldId:n,body:r};return t.apis.field.addFieldTransformation(o).then(a._handleRestResponse.bind(a,"applyOrdinal",s))})},applyFieldMapping:function t(e,n,i){var a=this;var s=arguments;return this._getAPI().then(function(t){var r={type:"mapping",mappings:i};var o={appId:a._getAppName(),tableId:e,fieldId:n,body:r};return t.apis.field.addFieldTransformation(o).then(a._handleRestResponse.bind(a,"applyFieldMapping",s))})},splitField:function t(e,n,i){var a=this;var s=arguments;return this._getAPI().then(function(t){var r={type:"splitField",splitDef:{fieldId:n,splitInfo:i}};var o={appId:a._getAppName(),tableId:e,body:r};return t.apis.table.applyTableTransformation(o).then(a._handleRestResponse.bind(a,"splitField",s))})},adaptVisualization:function t(e,n,i,a,s,r){var o=this;var l=arguments;return this._getAPI().then(function(t){var c={action:e,datasetName:n,analysisType:a,dims:s,msrs:r,visType:i};return t.apis.visualization.createVisRecommendationForCurrent({appId:o._getAppName(),body:c}).then(o._handleRestResponse.bind(o,"adaptVisualization",l))})},adaptMatchRecord:function t(e,n,i){var a=this;var s=arguments;return this._getAPI().then(function(t){var r={action:e,matchRecord:n,analysisType:i,detailLevel:[]};return t.apis.visualization.createVisRecommendationForLoaded({appId:a._getAppName(),body:r}).then(a._handleRestResponse.bind(a,"adaptVisualization",s))})},getExcludedCompareVisualizations:function t(e,n,i){var a=this;var s=arguments;return this._getAPI().then(function(t){var r={appId:a._getAppName(),detailLevel:"complete",analysisTypes:JSON.stringify(["excludedCompare","excludedCompareMsrSelector"]),bundleOverride:JSON.stringify({explore:"grayInsight"})};if(e.length>0)if(i){var o=[];e.forEach(function(t){o.push({libId:t})});r["libItems"]=JSON.stringify(o)}else{var l=[];e.forEach(function(t){l.push({name:t,overrides:{classifications:["measure"],defaultAggregation:"sum"}})});r["fields"]=JSON.stringify(l)}n&&(r.options=JSON.stringify(n));return t.apis.visualization.getVisualizationsForLoaded(r).then(a._handleRestResponse.bind(a,"getVisRecommendations",s))})},adaptAggregationForExcludedCompareVisualization:function t(e){var n=this;var i=arguments;return this._getAPI().then(function(t){var a={action:"update",analysisType:"excludedCompare",matchRecord:e};return t.apis.visualization.createVisRecommendationForLoaded({appId:n._getAppName(),body:a}).then(n._handleRestResponse.bind(n,"adaptVisualization",i))})}});return d}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={};Object.defineProperties(t,{ENTER:{value:13},ESCAPE:{value:27},SPACE:{value:32},TAB:{value:9},BACKSPACE:{value:8},DELETE:{value:46},ALT:{value:18},CTRL:{value:17},SHIFT:{value:16},ARROW_UP:{value:38},ARROW_DOWN:{value:40},ARROW_LEFT:{value:37},ARROW_RIGHT:{value:39},PAGE_DOWN:{value:34},PAGE_UP:{value:33},HOME:{value:36},END:{value:35},F10:{value:121},A:{value:65},F:{value:70}});t.isArrow=function(e){return e===t.ARROW_UP||e===t.ARROW_DOWN||e===t.ARROW_LEFT||e===t.ARROW_RIGHT};return t}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(92),n(90),n(183)],a=function(t,e,n){var i;var a;var s;var r=t.extend("PrecedentsService",{init:function t(){},_getAPI:function t(){i||(i=n.getApi("api/precedent/v1","openapi"));return i},_handleRestResponse:function t(e,n,i){return i.body.response},_getAppName:function t(){return e.getParameterByName("app")},defineDimension:function t(e){var n=this;var i=arguments;var a={};a.targets=[{type:"dimension",dimension:e}];a.source={type:"user"};a.relation={relation:"define"};return this._getAPI().then(function(t){return t.apis.precedents.addPrecedent({appId:n._getAppName()},{requestBody:a,server:t.spec.servers[0].url}).then(n._handleRestResponse.bind(n,"defineDimension",i))})},defineMeasure:function t(e){var n=this;var i=arguments;var a={};a.targets=[{type:"measure",measure:e}];a.source={type:"user"};a.relation={relation:"define"};return this._getAPI().then(function(t){return t.apis.precedents.addPrecedent({appId:n._getAppName()},{requestBody:a,server:t.spec.servers[0].url}).then(n._handleRestResponse.bind(n,"defineMeasure",i))})},dislikeField:function t(e){var n=this;var i=arguments;a=void 0;var s={};s.targets=[{type:"field",field:e}];s.source={type:"user"};s.relation={relation:"dislike"};return this._getAPI().then(function(t){return t.apis.precedents.addPrecedent({appId:n._getAppName()},{requestBody:s,server:t.spec.servers[0].url}).then(n._handleRestResponse.bind(n,"dislikeField",i))})},removeDefinedItem:function t(e){var n=this;var i=arguments;s=void 0;return this._getAPI().then(function(t){return t.apis.precedents.removePrecedent({appId:n._getAppName(),sourceType:"user",relation:"define",targetNodeId:e}).then(n._handleRestResponse.bind(n,"removeDefinedItem",i))})},getLearnedItems:function t(){var e=this;var n=arguments;if(s&&s.pending)return s;var i={};i.targets=[{type:"field"},{type:"libItem"},{type:"dimension"},{type:"measure"}];i.source={type:"user"};i.relations=[{relation:"define"},{relation:"dislike"}];s=this._getAPI().then(function(t){return t.apis.precedents.getRelationships({appId:e._getAppName()},{requestBody:i,server:t.spec.servers[0].url}).then(e._handleRestResponse.bind(e,"getDefinedItems",n))});return s},undislikeItem:function t(e){var n=this;var i=arguments;a=void 0;return this._getAPI().then(function(t){return t.apis.precedents.removePrecedent({appId:n._getAppName(),sourceType:"user",relation:"dislike",targetNodeId:e}).then(n._handleRestResponse.bind(n,"undislikeItem",i))})},getDislikedItems:function t(){var e=this;var n=arguments;if(a)return a;var i={};i.targets=[{type:"field"},{type:"libItem"}];i.source={type:"user"};i.relations=[{relation:"dislike"}];a=this._getAPI().then(function(t){return t.apis.precedents.getRelationships({appId:e._getAppName()},{requestBody:i,server:t.spec.servers[0].url}).then(e._handleRestResponse.bind(e,"getDislikedItems",n))});return a},dislikeLibItem:function t(e){var n=this;var i=arguments;a=void 0;var s={};s.targets=[{type:"libItem",libItem:e}];s.source={type:"user"};s.relation={relation:"dislike"};return this._getAPI().then(function(t){return t.apis.precedents.addPrecedent({appId:n._getAppName()},{requestBody:s,server:t.spec.servers[0].url}).then(n._handleRestResponse.bind(n,"dislikeLibItem",i))})},likeAnalysis:function t(e){var n=this;var i=arguments;var a={};a.targets=[{type:"analysis",analysis:e}];a.source={type:"user"};a.relation={relation:"like"};return this._getAPI().then(function(t){return t.apis.precedents.addPrecedent({appId:n._getAppName()},{requestBody:a,server:t.spec.servers[0].url}).then(n._handleRestResponse.bind(n,"likeAnalysis",i))})},dislikeAnalysis:function t(e){var n=this;var i=arguments;var a={};a.targets=[{type:"analysis",analysis:e}];a.source={type:"user"};a.relation={relation:"dislike"};return this._getAPI().then(function(t){return t.apis.precedents.addPrecedent({appId:n._getAppName()},{requestBody:a,server:t.spec.servers[0].url}).then(n._handleRestResponse.bind(n,"dislikeAnalysis",i))})},undislikeAnalysis:function t(e){var n=this;var i=arguments;return this._getAPI().then(function(t){return t.apis.precedents.removePrecedent({appId:n._getAppName(),sourceType:"user",relation:"dislike",targetNodeId:e.precedents.id}).then(n._handleRestResponse.bind(n,"undislikeAnalysis",i))})},scrapeApp:function t(){var e=this;var n=arguments;a=void 0;return this._getAPI().then(function(t){return t.apis.precedents.scrapeApp({appId:e._getAppName()}).then(e._handleRestResponse.bind(e,"scrapeApp",n))})}});return r}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91)],a=function(t,e){var n=0;var i=6;var a=1;function s(t,e,s,o){var l;if(0===e.length)return;t[s]||(t[s]={});l=t[s];l.string=e;l.isWhitespace=o||e.length<a&&!r(e)||'"'===e;l.colorIx=l.isWhitespace?-1:n;n=l.isWhitespace?n:(n+1)%i}function r(t){return t.match(/[\u3040-\u9FBF]/)||t.match(/[\uFF65-\uFF9F]/)}function o(t,e,n,i){if(e.length<a&&!r(e))return;t.push({string:e,startQuote:n,endQuote:i})}t.service("qvGlobalSearchDataService",function(){this.transformResult=function(t,n){var i=n;t.matches=t.matches||[];t.searchTermGroups=t.searchTermGroups||[];t.searchVisualsGroups=t.searchVisualsGroups||[];for(var a=0;a<i.qSearchGroupArray.length;++a)if("DatasetType"===i.qSearchGroupArray[a].qGroupType){t.searchTermGroups.push(i.qSearchGroupArray[a]);var s=i.qSearchGroupArray[a];-1===t.matches.indexOf(s.qSearchTermsMatched.length)&&t.matches.push(s.qSearchTermsMatched.length)}else t.searchVisualsGroups.push(i.qSearchGroupArray[a]);t.displayResult.data=t.searchTermGroups.length>0;t.displayResult.visuals=t.searchVisualsGroups.length>0;t.searchVisualsGroups.length>0&&(t.existingChartGroupTitle=e.get("GlobalSearch.Existing.ChartsTitle",[t.searchVisualsGroups[0].qItems.length]))};this.showMore=function(t,e){if(!e||!t||1!==t.qSearchGroupArray.length)return;var n=t.qSearchGroupArray[0],i;for(var a=0;a<n.qItems.length;a++)if(n.qItems[a].qIdentifier===e.qIdentifier){i=n.qItems[a].qItemMatches;break}i&&(e.qItemMatches=i)};this.setHeaders=function(t){var e,n=0;for(e=0;e<t.searchTermGroups.length;e++)t.searchTermGroups[e].qTotalNumberOfItems>n&&(n=t.searchTermGroups[e].qTotalNumberOfItems);t.columnCount=n;t.columnWidth=Math.floor(100/n)+"%";t.shadowHeaders=t.shadowHeaders||[];t.shadowHeaders.splice(0,t.shadowHeaders.length-n);for(e=t.shadowHeaders.length;e<n;e++)t.shadowHeaders[e]={}};this.transformSuggest=function(t,e,n){var i,a=0,s,r=[];this.getUnderlinersAndSearchTerms(t.query,r,[]);n=void 0!==n?n:25;n=Math.min(n,e.qSuggestions.length);for(i=0;i<n;++i){s={value:e.qSuggestions[i].qValue,term:e.qSuggestions[i].qTerm};if(t.query===this.getResultingQueryFromSuggestion(r,s))continue;t.suggestions[a]=s;a++}t.suggestions.splice(a,t.suggestions.length-a)};this._whitespaces=[" ","\t","\n","\r","\r\n","　"];this.isWhiteSpaceAt=function(t,e){var n=this._whitespaces;var i=t.charAt(e),a;for(a=0;a<n.length;++a)if(i===n[a])return true;return false};this.getUnderlinersAndSearchTerms=function(t,e,i){var a=0,r=0,l=t.length,c=0,u,d=this._whitespaces,p=this;i.length=0;n=0;function h(t,e){var n,i,a;for(i=0;i<d.length;++i){n=t.indexOf(d[i],e);n>=0&&(!a||n<a)&&(a=n)}return a||-1}function f(t,e){var n;do{n=t.indexOf('"',e);e=n+1}while(n>=0&&e<l&&!p.isWhiteSpaceAt(t,e));return n}function g(){while(r<l&&p.isWhiteSpaceAt(t,r))r++;r>a&&s(e,t.substring(a,r),c++,true);a=r}g();while(a<l){if('"'===t.charAt(a)){s(e,t.substring(a,a+1),c++);r=f(t,++a);u=r>=0?t.substring(a,r):t.substring(a);s(e,u,c++);o(i,u,true,r>0);if(r<0)break;s(e,t.substring(r,r+1),c++);r+=1;a=r;g();continue}r=h(t,a);u=r>=0?t.substring(a,r):t.substring(a);s(e,u,c++);o(i,u,false,false);if(r<0)break;a=r;g()}e.splice(c,e.length-c)};this.getSuggestTerms=function(t,e){var n=this,i,a;function s(t){var e,i,a;t=t.trim();if(0===t.length)return null;e=t.length;i=e-1;a=-1;while(i>-1){if(n.isWhiteSpaceAt(t,i)){a=i+1;break}i--}a=Math.max(a,0);return t.substring(a,e)}a=s(t);i=e.map(function(t){return t.string});a&&2===a.length&&'"'===a.charAt(0)&&i.push(a.charAt(1));return i};this.getUnderlineLengthFromTermIx=function(t,e){var n=0,i,a=0;while(n<t.length){i=t[n];if(!(a<e||i.isWhitespace))break;if(n===t.length-1&&1===i.string.length&&!this.isWhiteSpaceAt(i.string,0)&&'"'!==i.string)break;i.isWhitespace||a++;n++}return n>0?n:0};this.getResultingQueryFromSuggestion=function(t,e){var n,i,a,s,r=this.getUnderlineLengthFromTermIx(t,e.term);n=t.slice(0,r).reduce(function(t,e){return t+e.string},"");i='"'===n.charAt(n.length-1);a=!i&&e.value.indexOf(" ")>=0;s=a||i;return n+(a?'"':"")+e.value+(s?'"':"")};this.getMinQueryLength=function(){return a};this.getMaxColorsNum=function(){return i}})}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(95),n(11),n(10),n(48),n(833),n(839),n(94),n(50),n(202)],a=function(t,e,n,i,a,s,r,o,l){i.service("qvGlobalSelectionsService",["$document","$timeout",function(i,c){var u={},d,p=false,h=null,f=[];function g(t){if(!t)return u[0];return u[m(t)]}function v(t,e){u[m(t)]=e}function m(t){return t&&t.id?t.id.toUpperCase():""}function b(t){function e(){var e=g(t);S(e)}function n(){var e=g(t);S(e);y(e)}return{$container:void 0,$app:t,$selectionCount:false,$showFields:false,getComponent:function t(){return o.isSmallDevice?s:a},setup:function t(){o.ViewChanged.bind(n);r.StateChanged.bind(e)},destroy:function t(){o.ViewChanged.unbind(n);r.StateChanged.unbind(e)}}}function y(t){t.$container=n.element("<div>");i.find("#global-selections-container").length>0?i.find("#global-selections-container").append(t.$container):i.find("body").append(t.$container);t.$container.showComponent(t.getComponent(),["$scope",function(e){e.app=t.$app}]);t.setup()}function S(t){if(t.$container){t.$container.remove();t.$container=void 0}f.forEach(function(t){t()});t.destroy()}function x(t){var e=g(t);if(!e){e=new b(t.enigmaModel);v(t,e)}return e}function q(t){return t&&void 0!==t.$container}function I(){t.publish("/toolbar/setContextItemsVisibility",d.getCaoActive()||d.isSelectActive())}function C(t){var n=l.getCurrentSheetInfo();if(q(t)){l.closeAnalysisOverlay(n.sheetId,n.appId);S(t);e("body").removeClass("qv-global-selections-enabled")}else{l.openAnalysisOverlay(n.sheetId,n.appId,r.States.selections);e("body").addClass("qv-global-selections-enabled");y(t)}I()}d={toggleGlobalSelection:function t(e){C(x(e))},off:function t(){Object.keys(u).forEach(function(t){S(u[t])})},isSelectActive:function t(e){var n=g(e);return!!(void 0!==e&&q(n))},getCaoActive:function t(){return p},setCaoActive:function t(e){c(function(){p=e;I()})},setCsShowCallback:function t(e){h=e},setCsShow:function t(e){h&&h(e)},setSelectionCount:function e(n,i){var a=x(i);a.$selectionCount=n;t.publish("/toolbar/invalidateMobileToolbar",n)},getSelectionCount:function t(e){var n=g(e)||{};return n.$selectionCount},setShowFields:function t(e,n){var i=x(n);i.$showFields=e},getShowFields:function t(e){var n=g(e)||{};return!!n.$showFields},onClose:function t(e){"function"===typeof e&&f.push(e)}};return d}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(10),n(48),n(283),n(90),n(102),n(10)],a=function(t,e,n,i,a){e.service("qvSelectionToolbarService",function(){var e,s,r;function o(t,e){var n=t[0].getBoundingClientRect(),i=e[0].getBoundingClientRect(),a,s,r,o;if(e.is("th, td")){s=e.closest("table")[0].getBoundingClientRect();a=e.prevAll();r=a.length?a.last():e;o=r[0].getBoundingClientRect();if(o.left-s.left===1)return{top:i.top-n.top,left:i.left-1-n.left,width:i.width}}return{top:i.top-n.top,left:i.left-n.left,width:i.width}}e={open:function e(a,l,c){var u=o(a,l),d={top:-44+u.top,width:u.width+(c.offsetWidth||0),left:u.left};c.toolbar=i.extend(true,c.toolbar,{position:d,menuMaxHeight:c.menuMaxHeight});s=t.element("<div>");r=s.showComponent(n,c);s.appendTo(a);this.Opened.emit()},refresh:function t(){r&&r.refresh()},close:function t(){if(r){r.close();this.Closed.emit();r=void 0}s&&s.remove()},confirm:function t(){if(r){r.confirm();r=void 0}this.close()}};a.create(e,"Closed");a.create(e,"Opened");return e})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t="q3TnObj";function e(){var e=JSON.parse(sessionStorage.getItem(t));null===e&&(e=JSON.parse(localStorage.getItem(t))||{});return e}function n(){return e()}function i(n){var i=e();if(!i[n]){i[n]={data:{view:"",scriptTabIndex:0},tab:"",analysis:{sheetId:"",state:""},story:{storyId:"",slideId:"",state:""}};sessionStorage.setItem(t,JSON.stringify(i));localStorage.setItem(t,JSON.stringify(i));return i[n]}return i[n]}function a(n,a,s,r){var o=i(n);var l=e();void 0===s&&(s=l[n].data.scriptTabIndex);r||(o.tab="data");o.data={view:a,scriptTabIndex:s};l[n]=o;localStorage.setItem(t,JSON.stringify(l));sessionStorage.setItem(t,JSON.stringify(l));return l[n]}function s(t){var n=e();if(n[t])return n[t].data;return"not_found"}function r(n,a,s,r){var o=i(s);var l=e();o.tab="analysis";o.analysis={sheetId:n,state:a,overlay:r};l[s]=o;localStorage.setItem(t,JSON.stringify(l));sessionStorage.setItem(t,JSON.stringify(l));return l[s]}function o(t){var n=e();if(n[t])return n[t].analysis;return"not_found"}function l(n,a,s,r){var o=i(r);var l=e();o.tab="story";o.story={slideId:n,storyId:s,state:a};l[r]=o;localStorage.setItem(t,JSON.stringify(l));sessionStorage.setItem(t,JSON.stringify(l));return l[r]}function c(t){var n=e();if(n[t])return n[t].story;return"not_found"}function u(n,a){var s=i(a);var r=e();s.tab=n;r[a]=s;localStorage.setItem(t,JSON.stringify(r));sessionStorage.setItem(t,JSON.stringify(r));return r[a]}function d(t){var n=e();if(n[t])return n[t].tab;return"not_found"}return{isInSession:n,setData:a,data:s,setSheet:r,analysis:o,setStory:l,story:c,setTab:u,tab:d}}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(11),n(127)],a=function(t,e){var n={a:65,alt:18,b:66,backspace:8,c:67,ctrl:17,d:68,del:46,down:40,e:69,end:35,f:70,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,enter:13,esc:27,g:71,h:72,home:36,i:73,insert:45,j:74,k:75,l:76,left:37,m:77,n:78,o:79,p:80,pagedown:34,pageup:33,q:81,r:82,right:39,s:83,shift:16,space:32,t:84,tab:9,u:85,up:38,v:86,w:87,win:224,x:88,y:89,z:90,cmd:91,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,0:48,"*":106},i="qvKeyboardShortcuts",a=false,s;function r(){this.groups=[];this.shortcuts=[];this.timer={id:null};this.isReleased=true;this.currentEvent=void 0}r.prototype.createGroup=function(t,e){var n=this,i,a;for(a=0;a<this.groups.length;a++)if(this.groups[a].name===t){i=this.groups[a];break}if(!i){i={name:t,priority:e,active:false,shortcuts:[]};this.groups.push(i);this.groups.sort(function(t,e){return t.priority-e.priority})}return{registerKeys:function t(e,a,s){n.registerKeys(i,e,a,s)},unregisterKeys:function t(e,n){var a=i.shortcuts;for(var s=0;s<a.length;s++)if(a[s].keyCombo===e&&a[s].callback===n){a.splice(s,1);break}},on:function t(){n.activateGroup(i)},off:function t(){n.deactivateGroup(i)},delete:function t(){n.deactivateGroup(i);n.deleteGroup(i)}}};r.prototype.activateGroup=function(e){var n=this;e.active=true;if(!a){a=true;t(document).on("keydown."+i,function(t){n.handleEvent(t)})}};r.prototype.deactivateGroup=function(e){var n;e.active=false;n=this.groups.reduce(function(t,e){e.active&&t++;return t},0);if(0===n&&a){a=false;t(document).off("keydown."+i)}};r.prototype.deleteGroup=function(t){this.groups=this.groups.filter(function(e){return e!==t})};r.prototype.registerKeys=function(t,e,i,a){var s=e.toLowerCase().split("+"),r={keyCombo:e,ctrlKey:false,shiftKey:false,altKey:false,keyCode:null,name:"",callback:null,allowInAllContexts:!!(a&&"allowInInput"in a)&&a.allowInInput,preventDefault:!(a&&"preventDefault"in a)||a.preventDefault,delay:a&&"delay"in a?a.delay:250};for(var o in n)for(var l=0;l<s.length;l++){r.name=e.toLowerCase();r.callback=i;"ctrl"!==s[l]&&"cmd"!==s[l]||(r.ctrlKey=true);"alt"===s[l]&&(r.altKey=true);"shift"===s[l]&&(r.shiftKey=true);s[l]===o&&17!==n[o]&&16!==n[o]&&91!==n[o]&&18!==n[o]&&(r.keyCode=n[o])}t.shortcuts.push(r)};r.prototype.preventDefault=function(){this.currentEvent&&this.currentEvent.preventDefault()};r.prototype.handleEvent=function(t){var i=this;this.currentEvent=t;function a(e,a,r,o){var l,c;for(var u=0;u<i.groups.length;u++){l=i.groups[u];if(l.active)for(var d=l.shortcuts.length-1;d>=0;d--){c=l.shortcuts[d];if((c.keyCode===n["*"]||c.keyCode===o&&c.ctrlKey===e&&c.shiftKey===a&&c.altKey===r)&&!s(t,c))break}}}function s(t,n){var i=e.isInput(document.activeElement);return!(i&&!n.allowInAllContexts)&&r(t,n)}function r(t,e){e.preventDefault&&t.preventDefault();if("number"!==typeof i.timer.id){e.delay>0&&(i.timer.id=setTimeout(function(){o()},e.delay));if(true===e.callback(e,t)){o();return true}}}function o(){clearTimeout(i.timer.id);delete i.timer.id}t.shiftKey?!t.ctrlKey&&!t.metaKey||t.altKey?t.ctrlKey||t.metaKey||!t.altKey?a(false,true,false,t.which):a(false,true,true,t.which):a(true,true,false,t.which):!t.ctrlKey&&!t.metaKey||t.altKey?t.ctrlKey||t.metaKey||!t.altKey?a(false,false,false,t.which):a(false,false,true,t.which):a(true,false,false,t.which)};s=new r;return s}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[],a=function(){return{MEASURE:"measure",DIMENSION:"dimension",FIELD:"field",PUBSUB_TOPIC:"/cao/light-editing/swap"}}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,function(t,e,n){"use strict";var i,a;!(i=[n(109),n(100),n(100)],a=function(t,e,n){var i={Theme:n,TRANSPARENT_BLACK:"rgba( 0,0,0,0.2 )",TRANSPARENT_WHITE:"rgba( 255,255,255,0.7 )",LIGHT_GREY:"#ccc",DARK_GREY:"#666",BLACK:"#000",WHITE:"#fff",getInverse:function e(n){var i=new t(n);var a=i.getAlpha();return 0===a?this.BLACK:i.isDark()?this.WHITE:this.BLACK},getContrastingGrey:function e(n){var i=new t(n);var r=i.getAlpha();return 0===r?this.DARK_GREY:t.getBestContrast(i,a,s)},getBestContrast:function e(n,i,a){return t.getBestContrast(new t(n),new t(i),new t(a))},getContrastingTransparent:function e(n){var i=new t(n);var a=i.getAlpha();return 0===a||"none"===n?this.TRANSPARENT_BLACK:i.isDark()?this.TRANSPARENT_WHITE:this.TRANSPARENT_BLACK},getStyle:function t(n,i,a){n=n||"";this[n+"StyleService"]||(this[n+"StyleService"]=e.initializeService("object."+n));return this[n+"StyleService"].getStyle(i,a)},getFontSize:function t(n,i,a){n=n||"";this[n+"StyleService"]||(this[n+"StyleService"]=e.initializeService("object."+n));var s=this[n+"StyleService"];return s.scaleFontSize(s.getStyle(i,"fontSize"),a)}};var a=new t(i.LIGHT_GREY);var s=new t(i.DARK_GREY);return i}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90),n(89),n(122),n(177),n(94),n(93),n(49),n(108),n(50)],a=function(t,e,n,i,a,s,r,o,l){function c(){var e=t.getParameterByName("app");var n=t.getParameterByName("sheet");var a=i.analysis(e);var s=a&&a.sheetId?a.sheetId:n;return{appId:e,sheetId:s}}function u(t){if(!o.inClient()||!r.getFlag("SSA_IN_EDIT")||l.isSmallDevice||t)return e.resolve("analysis");return s.getApp().then(function(t){return t.getLayout().then(function(t){var e=t&&t.permissions&&t.permissions.update;var n=e?a.States.edit:a.States.analysis;return a.getAllStateKeys()[n]})}).catch(function(){return e.resolve("analysis")})}function d(n,a){var s=i.analysis(t.getParameterByName("app"));if(o.inClient()&&s&&s.state&&!a)return e.resolve(s.state);return u(n)}function p(t,e,a,s){i.setSheet(t,e,a,s);n.goToSheet(t,e,s)}function h(e){var n=t.getParameterByName("app");var s=i.analysis(n).overlay;return s===a.getAllStateKeys()[e]}function f(){return r.getFlag("SSA_IN_EDIT")||a.state!==a.States.edit}function g(){return h(a.States.insight)}function v(){return h(a.States.selections)}function m(t,e,n){if(o.inClient()){var s=i.analysis(e).state;var r=a.getAllStateKeys()[n];s||u().then(function(n){p(t,n,e,r)});p(t,s,e,r)}}function b(t,e){if(o.inClient()){var n=i.analysis(e).state;n?p(t,n,e,null):u().then(function(n){p(t,n,e,null)})}}return{getCurrentSheetInfo:c,closeAnalysisOverlay:b,openAnalysisOverlay:m,getDefaultSheetViewState:u,getCurrentSheetViewState:d,shouldShowOverlay:f,isInInsightMode:g,isInSelectionsMode:v}}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,function(t,e,n){"use strict";var i,a;!(i=[n(92),n(90),n(249),n(303)],a=function(t,e,n,i){var a=t.extend("SortableItemList",{init:function t(e,n){this.items=[];this.disabled=false;this.typeFlag=e||1;this.locked=false;Object.keys(n||{}).forEach(function(t){this[t]=n[t]},this)},addSortableItem:function t(e,n){Object.defineProperty(e,"__sortableItem__",{configurable:false,enumerable:true,writable:true,value:{typeFlag:n||1}});this.items.push(e)},moveItem:function t(e,n){this.items.splice(n,0,this.items.splice(e,1)[0])},getIndexByItem:function t(e){return this.items.indexOf(e)},get:function t(e){return this.items.filter(e||function(){return true})},getLockedIndices:function t(){return this.get(function(t){return!!(t.__sortableItem__.typeFlag&i.TYPEFLAG_LOCKED)}).map(function(t){return this.getIndexByItem(t)},this)},reset:function t(){this.items.length=0;this.disabled=false},isEmpty:function t(){return 0===this.items.length},setLocked:function t(e){this.locked=e}});Object.defineProperties(a.prototype,{length:{get:function t(){return this.items.length}}});var s=n.extend("SortableItemLists",{init:function t(){this._super.apply(this,arguments);this.lists=[];this.dragPlaceholder=null},addPlaceholder:function t(n){var a=this.getList(n),s=a?a.items.indexOf(n):-1;this.dragPlaceholder=e.extend(true,{},n);this.dragPlaceholder.id="placeholder";this.dragPlaceholder.__sortableItem__.typeFlag=i.TYPEFLAG_PLACEHOLDER;this.dragPlaceholder.style={opacity:"0.3"};a&&a.items.splice(s,0,this.dragPlaceholder);return this.dragPlaceholder},removePlaceholder:function t(){if(!this.dragPlaceholder)return;var e=this.getList(this.dragPlaceholder),n=e?e.items.indexOf(this.dragPlaceholder):-1;if(-1!==n){e.items.splice(n,1);this.dragPlaceholder=null}},getPlaceholder:function t(){return this.dragPlaceholder},createList:function t(e,n){var i=new a(e,n);this.lists.push(i);return i},reset:function t(){this.lists.forEach(function(t){t.reset()})},getList:function t(e){return this.lists.filter(function(t){return-1!==t.items.indexOf(e)})[0]},disable:function t(e){this.lists.forEach(function(t){t.disabled=!(e.__sortableItem__.typeFlag&t.typeFlag)})},enable:function t(){this.lists.forEach(function(t){t.disabled=false})},getIndexOfItem:function t(e){var n=this.getList(e);var i=n?n.items.indexOf(e):-1;return i},moveItem:function t(e,n){var i=this.getList(e),a=this.getList(n),s,r;if(!i||!a)return;r=a.items.indexOf(n);s=i.items.indexOf(e);i.items.splice(s,1);a.items.splice(r,0,e)},onBegin:function t(e,n){this.addPlaceholder(e,n);this.disable(e)},onEnter:function t(e,n){var a=this.getList(e),s=a.getLockedIndices();if(e===this.dragPlaceholder)return;if(n===i.ENTER_BEFORE||n===i.ENTER_AFTER){var r=this.getList(this.dragPlaceholder),o,l;if(!r||!a)return;o=r.getIndexByItem(this.dragPlaceholder);r.items.splice(o,1);l=a.getIndexByItem(e);l+=n===i.ENTER_AFTER?1:0;a.items.splice(l,0,this.dragPlaceholder)}else this.moveItem(this.dragPlaceholder,e);var c=a.getLockedIndices();s.forEach(function(t,e){a.moveItem(c[e],t)})},onEnterList:function t(e){if(e.disabled||e.locked)return;var n=this.getList(this.dragPlaceholder);if(!n)return;var i=n.getIndexByItem(this.dragPlaceholder);n.items.splice(i,1);e.items.push(this.dragPlaceholder)},onMove:function t(e){if(-1===this.getIndexOfItem(e)){this.onCancel();return false}var n=this.dragPlaceholder;this.moveItem(e,n);this.removePlaceholder();this.enable();return true},onMoveToList:function t(e,n){var i=this.getList(e);if(i&&!(n.disabled||n.locked)){var a=i.items.indexOf(e);if(i===n){this.onMove(e,this.dragPlaceholder);return true}i.items.splice(a,1);n.items.push(e)}this.removePlaceholder();this.enable();return!!i},onCancel:function t(){this.removePlaceholder();this.enable()},allowEnter:function t(e,n){var i=this.getList(e);return void 0!==i&&!i.disabled&&!i.locked&&!!(n.__sortableItem__.typeFlag&i.typeFlag)},allowEnterList:function t(e,n){return!e.disabled&&!e.locked&&!!(n.__sortableItem__.typeFlag&e.typeFlag)}});s.create=function(t){var e=s.extend(t||{});t=new e(t&&t.options);return t};return s}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,function(t,e,n){"use strict";var i,a;!(i=[n(11),n(10),n(95),n(48),n(909),n(94),n(140),n(184),n(103),n(168),n(155),n(49),n(89),n(202),n(223),n(176),n(175)],a=function(t,e,n,i,a,s,r,o,l,c,u,d,p,h,f){i.service("qvCaoService",["$document","qvSelectionToolbarService","qvGlobalSelectionsService","qvCaoSelectionService",function(i,g,v,m){var b,y,S;var x=300;var q=new c;var I=new u;var C=false;var w=d.getFlag("CE_PRECEDENTS");var D,M;S=o.createGroup("cao",1);S.registerKeys("ctrl+left",o.preventDefault);S.registerKeys("ctrl+home",o.preventDefault);S.registerKeys("ctrl+right",o.preventDefault);S.registerKeys("ctrl+end",o.preventDefault);S.registerKeys("ctrl+e",o.preventDefault);S.registerKeys("ctrl+c",o.preventDefault);S.registerKeys("ctrl+x",o.preventDefault);S.registerKeys("ctrl+v",o.preventDefault);S.registerKeys("ctrl+z",o.preventDefault);S.registerKeys("ctrl+y",o.preventDefault);S.registerKeys("cmd+shift+z",o.preventDefault);S.registerKeys("del",o.preventDefault);S.registerKeys("ctrl+f",o.preventDefault);S.registerKeys("backspace",o.preventDefault);S.registerKeys("esc",o.preventDefault);S.registerKeys("ctrl+shift+left",P);S.registerKeys("ctrl+shift+right",k);function T(){return{$container:void 0,$containerId:".qv-cao-container",getComponent:function t(){return a},setup:function t(){r.get().then(function(t){s.StateChanged.bind(A);t.enigmaModel.isInModalSelection()&&g.confirm()})},destroy:function t(){s.StateChanged.unbind(A)}}}function A(){(s.isInEditMode()||s.isInAnalysisMode()||s.inObjectView())&&F()}function P(){r.get().then(function(t){f.toggleAssetsPanel(t.id);n.publish("cao/insight/assetsPanelToggled",f.storageObj(t.id).assetsPanel)})}function k(){r.get().then(function(t){f.toggleContextPanel(t.id);n.publish("cao/insight/contextPanelToggled",f.storageObj(t.id).contextPanel)})}function E(n){S.on();y.$container=e.element("<div>");n=n||i;n.find(y.$containerId).append(y.$container);y.$container.showComponent(y.getComponent());y.setup();v.setCaoActive(true);t(".qv-cao").slideDown(x)}function _(){return!(!y||void 0===y.$container)}function F(){S.off();if(!y)return;t(".qv-cao").slideUp(x,function(){if(y.$container){y.$container.remove();y.$container=void 0}y.destroy();y=null;v.setCaoActive(false)})}b={isCaoOpen:_,toggleCao:function t(e){var n=h.getCurrentSheetInfo();m.clearSelection();y||(y=new T);if(_()){F();h.closeAnalysisOverlay(n.sheetId,n.appId);l.trackEvent(l.customEvents.INSIGHTS_CLICKED,{type:"close"});return false}h.openAnalysisOverlay(n.sheetId,n.appId,s.States.insight);E(e);C=false;l.trackEvent(l.customEvents.INSIGHTS_CLICKED,{type:"open"});return true},off:function t(){l.trackEvent(l.customEvents.INSIGHTS_CLICKED,{type:"off"});F()},scrapeApp:function t(){if(w){if(D)return M;D=true;M=q.scrapeApp().then(function(){D=false});return M}return(new p).resolve()},setRefreshIndicatorVisibility:function t(e){C=e},getRefreshIndicatorVisibility:function t(){return C},isInsightsAvailable:function t(){var e=new p;I.isRunning().then(function(){e.resolve(true)},function(){e.resolve(false)});return e.promise}};return b}])}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(48),n(155),n(89),n(94),n(91),n(54),n(154),n(147),n(246),n(363),n(273),n(142),n(93),n(275),n(271)],a=function(t,e,n,i,a,s,r,o,l,c,u,d,p){t.service("qvSelectionInsightsService",["qvCaoSearchService","qvCurrentSelectionsService",function(t,h){var f;var g=new e;var v=new l(a.localeDetected,"","","","numeric");var m={};var b=2e4;var y="$";function S(t){return v.format(t,"#.#A")}function x(t){var e=parseFloat(t.toFixed(3));return new Intl.NumberFormat(a.localeDetected,{style:"percent",maximumSignificantDigits:3,minimumSignificantDigits:1}).format(parseFloat(e))}function q(t){var e="";var n=t.measureAggregation;if("avg"==n){var i=S(t.excludedMeasure.qNumber);e=a.get("SelectionInsights.CardSummaryAvg",[i])}else e=Number.isNaN(+t.excludedMeasurePercentage.toFixed(1))?"NaN":a.get("SelectionInsights.CardSummarySum",[x(t.excludedMeasurePercentage.toFixed(1)/100)]);return e}function I(t){var e=t.counts.excluded+t.counts.included;var n=t.counts.excluded;var i=t.measureBreakdown.excluded.num;return n>1?a.get("SelectionInsights.InsightSummaryExcludedLongMulti",[n,e,"<span class='dimLabelDesc'>"+t.dimension+"</span>","<span>"+i+"</span>","<span>"+t.measure+"</span>","<span>"+(t.measureAggregation[0].toUpperCase()+t.measureAggregation.slice(1))+"</span>"]):a.get("SelectionInsights.InsightSummaryExcludedLongSingle",[n,e,"<span class='dimLabelDesc'>"+t.dimension+"</span>","<span>"+i+"</span>","<span>"+t.measure+"</span>","<span>"+(t.measureAggregation[0].toUpperCase()+t.measureAggregation.slice(1))+"</span>"])}function C(t,e){var i=new n;var s={};var r=true;s.counts={};s.counts.excluded=parseFloat(e.analysis.numExcluded);s.counts.included=parseFloat(e.analysis.distinctCount)-parseFloat(e.analysis.numExcluded);s.counts.summary=a.get("SelectionInsights.CardCountsSummary",[s.counts.excluded,s.counts.excluded+s.counts.included,x(s.counts.excluded/(s.counts.excluded+s.counts.included))]);var o="";var l="";var c="";var u="";for(var d in e.analysis.matchRecord.matches){var p=e.analysis.matchRecord.matches[d];if("dimension"==p.slotRole){c=p.field||p.libIdLabel;u=p.libId}else{o=p.field||p.libIdLabel;l=Array.isArray(p.aggr)?p.aggr[0]:p.aggr}}s.dimension=c;s.measure=o;s.measureAggregation=l;s.dimensionId=u;var h=[];var f=t.evaluateEx(e.analysis.aggrMrsExcluded);h.push(f);var g=t.evaluateEx(e.analysis.aggrMrsTotal);h.push(g);var v=t.evaluateEx(e.analysis.aggrMrsIncluded);h.push(v);var y=t.evaluateEx(e.analysis.aggrMrs);h.push(y);var C=setTimeout(function(){var e=false;h.forEach(function(n){if(-1===n.$$state.status){e=true;t.global.cancelRequest(n.requestId).then(function(){})}});e&&i.reject()},b);n.all(h).then(function(t){var n=t[0];var a=t[1];var o=t[2];var l=t[3];s.excludedMeasurePercentage=n.qNumber/a.qNumber*100;s.includedMeasurePercentage=o.qNumber/a.qNumber*100;s.excludedMeasure=n;s.totalMeasure=a;s.includedMeasure=o;s.summaryString=q(s);s.excludedVis={dimension:e.analysis.dim,measure:e.analysis.aggrMrsExcluded};s.includedVis={dimension:e.analysis.dim,measure:e.analysis.aggrMrsIncluded};s.measureBreakdown={};s.measureBreakdown.excluded={num:S(n.qNumber),percentage:s.excludedMeasurePercentage.toFixed(1)};s.measureBreakdown.included={num:S(o.qNumber),percentage:s.includedMeasurePercentage.toFixed(1)};s.selectedMeasure={total:S(a.qNumber),selected:{num:S(l.qNumber),percentage:l.qNumber/a.qNumber*100,qNum:l.qNumber},excluded:{num:S(a.qNumber-l.qNumber),percentage:(a.qNumber-l.qNumber)/a.qNumber*100,qNum:a.qNumber-l.qNumber}};s.summaryStringLong=I(s);m[s.dimension].insight=s;clearTimeout(C);r=s.excludedMeasurePercentage+s.includedMeasurePercentage<100.01&&s.counts.included>=0&&s.counts.excluded>=0&&s.excludedMeasurePercentage+s.includedMeasurePercentage>99.9;s.show=r;i.resolve({show:r,summary:s.summaryString})}).catch(function(t){i.reject(t)});return i.promise}function w(t){return t.getObject(i.model.id).then(function(t){return t.getLayout().then(function(t){return t.qMeta.title})})}function D(t){var e=void 0;t||(e={scope:["libItems"]});return e}function M(t){b=t.runtimeSettings.suggestedTimeout;var e={};var n=null;if(!s.isEmpty(t.appRecommendations)){var i=t.appRecommendations[0].visualizations;var a=[];i.forEach(function(t){if("excludedCompareMsrSelector"!=t.analysis.analysis){var i=parseFloat(t.analysis.numExcluded)/parseFloat(t.analysis.distinctCount);var s=(parseFloat(t.analysis.distinctCount)-parseFloat(t.analysis.numExcluded))/parseFloat(t.analysis.distinctCount);var r="";var o="";var l="";for(var c in t.analysis.matchRecord.matches){var u=t.analysis.matchRecord.matches[c];if("dimension"==u.slotRole)l=u.field||u.libIdLabel;else{r=u.field||u.libIdLabel;o=u.aggr}}var d=true;(0===i||0===s||"avg"!=o&&"sum"!=o)&&(d=false);a.indexOf(l)>-1&&(d=false);if(d){a.push(l);e[l]={vis:t,measure:r,measureAggregation:o}}else;}else for(var p in t.analysis.matchRecord.matches){var h=t.analysis.matchRecord.matches[p];"measure"==h.slotRole&&(n=h.field||h.libIdLabel)}})}return{insights:e,measure:n}}function T(t,e){var n=D(t);var i=[];var s=false;if(void 0!=e)if(e.masterItem){i.push(e.libId);s=true}else i.push(e.qName);return g.getExcludedCompareVisualizations(i,n,s).then(function(t){if(t.__report.appDataModel.memberSelectionDone)return M(t);throw{error:a.get("SelectionInsights.Unsupported")}})}function A(e){var n=[];return e?r.getList().then(function(t){return t.getLayout()}).then(function(t){var e=t.filter(function(t){return t.qTags&&(-1===t.qTags.indexOf("$date")||-1===t.qTags.indexOf("$timestamp"))&&-1===t.qTags.indexOf("$geopoint")&&(t.qTags.indexOf("$numeric")>-1||t.qTags.indexOf("$integer")>-1)});n=n.concat(e);return P()}).then(function(e){n=n.concat(e);var i=t.sortFields(n);return i}):P().then(function(e){var n=t.sortFields(e);return n})}function P(){return o.getList().then(function(t){return t.getLayout().then(function(t){var e=t.map(function(t){return{qName:t.qData.title,classifications:["measure"],masterItem:true,libId:t.qInfo.qId,libIdLabel:t.qMeta.title}});return e})})}function k(t){if(t&&t.selectionsInStates){var e=[];t.selectionsInStates.forEach(function(t){t.qSelectionObject.qSelections.forEach(function(e){e.stateName=t.stateName});e=e.concat(t.qSelectionObject.qSelections)});var n=e.filter(function(t){return!t.qIsHidden});n.forEach(function(t){t.translation=h.translate(t);t.screenReaderLabel=h.translatedScreenReaderLabel(t);t.name=t.qReadableName||t.qField;t.displayStateName=t.stateName===y?a.get(u.DEFAULT_STATE_TRANSLATION):t.stateName});var i=c.groupSelectionsByField(n);var s=i.filter(function(t){return!t.isSingleState});s.forEach(function(t){t.translation=h.translate(t);t.screenReaderLabel=h.translatedScreenReaderLabel(t)});i=i.sort(d.sortSelections);return i}}function E(t,e){var n={qHyperCubeDef:{qDimensions:[{qDef:{qFieldDefs:[e?t.excludedVis.dimension:t.includedVis.dimension],qFieldLabels:[t.dimension]},qNullSuppression:true}],qMeasures:[{qDef:{qDef:e?t.excludedVis.measure:t.includedVis.measure,qLabel:t.measureAggregation[0].toUpperCase()+t.measureAggregation.slice(1)+"("+t.measure+")",qNumFormat:{qType:"F",qnDec:2,qUseThou:0,qFmt:"#,##0.00",qDec:".",qThou:","}},qSortBy:{qSortByAscii:-1}}],qInterColumnSortOrder:[1,0],qInitialDataFetch:[{qTop:0,qHeight:500,qLeft:0,qWidth:2}],columnOrder:[0,1],columnWidths:[197,230],qSuppressMissing:true,qReductionMode:"N",qMode:"S",qPseudoDimPos:-1,qNoOfLeftDims:-1,qMaxStackedCells:5e3},qInfo:{qId:"",qType:"visualization"},visualization:"table"};return p.getApp().then(function(t){return t.enigmaModel.createSessionObject(n).then(function(t){return t})})}function _(t){if(t&&t.selectionsInStates){var e=c.getAllSelectionsInStates(t);var n=e.filter(function(t){return true===t.qOneAndOnlyOne}).map(function(t,e){return"<strong>"+(e?" ":"")+t.name+"</strong>"});if(n.length>0)return{isOneAndOnlyOne:true,items:n};return false}return false}function F(t){if(t&&t.selectionsInStates){var e=c.getAllSelectionsInStates(t);if(e.filter(function(t){return true===t.qLocked}).length>0)return true;return false}return false}f={getSheet:function t(e){return w(e).then(function(t){return t})},getInsightDimensions:function t(e,n){return T(e,n).then(function(t){m={};m=t.insights;var e=[];for(var n in m){var i={};i.excluded=parseFloat(m[n].vis.analysis.numExcluded);i.included=parseFloat(m[n].vis.analysis.distinctCount)-parseFloat(m[n].vis.analysis.numExcluded);i.summary=a.get("SelectionInsights.CardCountsSummary",[i.excluded,i.excluded+i.included,x(i.excluded/(i.excluded+i.included))]);e.push({dimension:n,counts:i,measure:m[n].measure,measureAggregation:m[n].measureAggregation,show:true})}return{insights:e,measure:t.measure}}).catch(function(t){throw t})},getInsightSummary:function t(e,n){var i=m[e].vis;return C(n,i).then(function(t){return t})},getInsightDetails:function t(e){return m[e].insight},clearInsights:function t(){m={}},getMeasures:function t(e){return A(e).then(function(t){return t})},getLocalizedPercentage:function t(e){return x(e)},getSelectionItems:function t(e){return k(e)},getTableVis:function t(e,n){return E(e,n).then(function(t){return t})},isOneAndOnlyOne:function t(e){return _(e)},isHasLockedSelections:function t(e){return F(e)}};return f}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(89),n(155),n(406),n(367),n(876),n(877),n(880),n(368)],a=function(t,e,n,i,a,s,r,o){t.service("qvCaoChartService",["qvCaoComplexityEstimatorService",function(t){var l;var c;var u=new n;function d(t,e,n){n.title=t;return i.createChart(n,e,false).then(function(t){return{model:t}})}function p(t){if(c)return g(c.app,c.searchPhrase,c.libItems,t);return e.reject({norefresh:true})}function h(t,e,n){var i=[];e.forEach(function(e){i.push(r.generateChartPropertiesForRecommendation(e.visualization,n).then(function(n){e.visualization=new a(e.visualization,t.__report,n);return e}))});return i}function f(n,i){var a=[];var r=3e3;n.runtimeSettings&&n.runtimeSettings.suggestedTimeout&&(r=n.runtimeSettings.suggestedTimeout);n.appRecommendations.forEach(function(e){e.recAnalyses.forEach(function(e){if("fact"===e.analysis.analysis&&1!==e.relevance)return;var n={relevance:e.relevance,suggestedTimeout:r,visualization:e,complexity:t.estimateComplexity(e,i)};a.push(n)})});return e.all(h(n,a,i)).then(function(t){var e=[];n.appCharts&&n.appCharts.forEach(function(t){t.appearsOnSheets.length>0&&e.push({relevance:t.relevance,suggestedTimeout:r,visualization:new s(t.id,t.appearsOnSheets,n.__report,i),complexity:-1})});return{recommendations:t.map(function(t){return new o(t,i)}),chartMatches:e.map(function(t){return new o(t,i)})}})}function g(t,e,n,i){c={app:t,searchPhrase:e,libItems:n};var a={exploreSupplemental:["appInsights"]};var s={};n&&(s={scope:["libItems"]});"boolean"===typeof i&&false===i&&(s.appPrecedents="skip");return u.getInsightRecommendations(e,a,true,[],s).then(function(e){return f(e,t)})}function v(t,e,n){c={app:t,searchPhrase:"",libItems:n};var i={exploreSupplemental:["appInsights"]};var a;n&&(a={scope:["libItems"]});return u.getVisRecommendations(e,true,i,[],a).then(function(e){return f(e,t)})}function m(t,e,n){return d(t,e,n)}function b(t,e){var n=t.matchRecord;var i=t.analysis.analysis;return u.adaptMatchRecord("update",n,i).then(function(n){n[0].analysis={analysis:n[0].analysis,analysisGroup:n[0].analysisGroup,dims:n[0].dims,msrs:n[0].msrs,titleTemplate:n[0].titleTemplate};return r.generateChartPropertiesForRecommendation(n[0],e).then(function(e){return{properties:e,analysis:n[0].analysis,matchRecord:t.matchRecord}})})}l={getInsights:g,getVisualRecommendations:v,refreshInsights:p,buildInsightChart:m,adaptRecommendation:b};return l}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={resizeCharts:function t(e){if("function"===typeof Event)e.dispatchEvent(new Event("resize"));else{var n=e.document.createEvent("UIEvents");n.initUIEvent("resize",true,false,e,0);e.dispatchEvent(n)}}};return t}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t="qCaoStorageObj";function e(){var e=JSON.parse(sessionStorage.getItem(t));null===e&&(e=JSON.parse(localStorage.getItem(t))||{});return e}function n(e){var n=JSON.parse(localStorage.getItem(t))||{};if(!n||!n[e]){n[e]={contextPanel:true,assetsPanel:true};sessionStorage.setItem(t,JSON.stringify(n));localStorage.setItem(t,JSON.stringify(n));return n[e]}return n[e]}var i={storageObj:function t(e){return n(e)},toggleContextPanel:function n(i){var a=e(i);a[i].contextPanel=!a[i].contextPanel;localStorage.setItem(t,JSON.stringify(a));sessionStorage.setItem(t,JSON.stringify(a));return a},toggleAssetsPanel:function n(i){var a=e(i);a[i].assetsPanel=!a[i].assetsPanel;localStorage.setItem(t,JSON.stringify(a));sessionStorage.setItem(t,JSON.stringify(a));return a}};return i}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(89),n(115),n(305),n(124),n(1013),n(95),n(312),n(90),n(91),n(1014),n(272),n(97),n(205),n(386),n(123),n(247),n(100),n(377),n(164),n(103),n(391),n(1020),n(176),n(1021),n(999),n(1024)],a=function(t,e,n,i,a,s,r,o,l,c,u,d,p,h,f,g,v,m,b,y,S,x){var q=new l({type:"invalid",path:"objects.error-handling/invalid-type"});function I(){var t=/\.(qlik-stage|qlikcloud)\.com/;var e=window.location.hostname.match(t)||[];return e.length}var C={INVALID:0,RENDERED:1};e.componentDirective("qvObjectContent",{object:"=",backendApi:"=",ext:"=",options:"=",layout:"=",selectionsApi:"=",tooltipApi:"=",throbberApi:"=",onInit:"="},null,function(t,e,n){e.onInit(t,e,n)});function w(t){t.selectionsApi&&t.selectionsApi.active&&t.selectionsApi.confirm()}function D(t,n){var i;function a(){return!t.options||false!==t.options.isVisible}function s(){w(n)}function r(){if(!a())return;e.$apply(t,function(){n.resize()});n.throbberApi&&n.throbberApi.resize();n.explore.resize()}function l(){i||(i=setTimeout(function(){r();clearTimeout(i);i=null},100))}t.$on("resizeCell",function(){l()});o.subscribe("/ui/object/resize."+t.$id,function(){l()});h.on("start."+t.$id,s);t.$on("$destroy",function(){clearTimeout(i);o.unsubscribe("."+t.$id);h.off("start."+t.$id,s)})}function M(t,e){t.object._forcePaint=true;function n(n){if(!t.model.isCancelled){t.layout=n;e.setLayout(n,t.options)}}function i(t){if(!t)return;e.model&&r(e.model);s(t);e.setModel(t)}function a(){e.setRenderState(C.INVALID)}function s(i){i.Invalidated&&!i.isCancelled&&i.Invalidated.bind(a);e.subscription=t.model.layoutSubscribe(n)}function r(n){n&&n.Invalidated&&n.Invalidated.unbind(a);n&&n.isValidating&&t.options._softCancelOnRemove&&n.markAsCancelled();e.subscription&&e.subscription.dispose()}t.$watch("model",i);t.$on("$destroy",function(){r(t.model)})}function T(t){return parseInt(t)/13+"em"}function A(t,e){if(!e.qInfo)return;var n=b.initializeService("object."+b.getMatch(e.visualization||e.qInfo.qType));t.styles=c.extend(true,t.styles||{},{backgroundColor:{"background-color":n.getStyle("","backgroundColor")},title:{"font-size":T(n.getStyle("title.main","fontSize")),color:n.getStyle("title.main","color")},subTitle:{"font-size":T(n.getStyle("title.subTitle","fontSize")),color:n.getStyle("title.subTitle","color")},footer:{"font-size":T(n.getStyle("title.footer","fontSize")),color:n.getStyle("title.footer","color"),"background-color":n.getStyle("title.footer","backgroundColor")}})}function P(t,n,i,s){var r,o,l,d;var h,f;n.updateTitlePadding=function(e){var n="rtl"===t.options.direction;c.setValue(t,"styles.title.padding-right",n?0:e+"px");c.setValue(t,"styles.title.padding-left",n?e+"px":0);s.contentLoaded().then(function(t){t.view&&t.view.updateTitlePadding&&t.view.updateTitlePadding(e)})};n.setObjectClass=function(e){d||(d=i.find(".qv-object"));if(d[0]){(e||void 0===h)&&(h=d[0].clientWidth);(e||void 0===f)&&(f=d[0].clientHeight)}var s=a.getLayoutMode(h,f);var r=n.type&&n.type.type;var o=[];n._inEditState&&o.push("qv-mode-edit");n.hasValidContent()||o.push("qv-incomplete");n.supportSnapshot()&&o.push("qv-can-take-snapshot");n.selectionsApi&&n.selectionsApi.active&&o.push("qv-selections-active");n.objectSize={w:h,h:f};t.options.layoutMode=s;var l="qv-layout-"+a.getLayoutModeKey(s);o.push(l);t.objectClass="qv-object-"+r;o.push(t.objectClass);n.selectionClass&&o.push(n.selectionClass);t.classList=o;t.wrapperClassList=[];t.object&&t.object.hasFrame&&t.object.showTitles&&!!t.layout.footnote&&t.wrapperClassList.push("has-footnote");t.options.thinHeader=!n.showTitles||""===t.layout.title&&""===t.layout.subtitle&&!n._inEditState};function g(){return!t.options||false!==t.options.isVisible}n.update=function(){if(!this.valid)return;A(t,t.layout);var i=this;r=e.getService("$timeout")(function(){n.backendApi&&n.backendApi.updateCache(t.layout);n.setObjectClass();t.$digest();i.loadContent();var e=n.type===q&&t.options.hardError;s.contentLoaded().then(function(i){if(!i.isDestroyed)try{return i.onPaint(t.layout,{visible:g()}).then(function(i){if(false===i)return;if(e){n.setRenderState(C.INVALID);"function"===typeof t.options.onRendered&&t.options.onRendered.call(null,"INVALID")}else{n.setRenderState(C.RENDERED);"function"===typeof t.options.onRendered&&t.options.onRendered.call(null)}}).catch(function(){n.setRenderState(C.INVALID);"function"===typeof t.options.onRendered&&t.options.onRendered.call(null)})}catch(e){n.setRenderState(C.INVALID);n.error={class:"hard-error",title:u.get("Object.Error"),message:u.get("Object.ErrorMessage.RenderingFailed",n.ext&&n.ext.type)};x.trackEvent(x.customEvents.EXTENSION_PAINT_ERROR,{message:"string"===typeof e?e:e.message,stack:e.stack,extension:n.type?n.type.type:"undefined",isThirdParty:n.type&&n.type.libraryInfo.isThirdParty});s.updateContent(p).then(function(i){i.onPaint(t.layout,{visible:false}).then(function(){n.setRenderState(C.RENDERED);"function"===typeof t.options.onRendered&&t.options.onRendered.call(null,e)})});throw e}})})};n.resize=function(){if(!g())return;n.setRenderState(C.INVALID);n.setObjectClass(true);o=e.getService("$timeout")(function(){s.contentLoaded().then(function(e){e.isDestroyed||e.onResize(t.layout).then(function(){n.setRenderState(C.RENDERED)}).catch(function(t){false})}).catch(function(t){false})})};n.onResize=function(){s.contentLoaded().then(function(e){e.onResize(t.layout).then(function(){n.setRenderState(C.RENDERED)})})};t.$on("$destroy",function(){var t=e.getService("$timeout");t.cancel(r);t.cancel(o);l&&l.reject()})}function k(t,a,s,r){var o=n(),l;s.loaded=o.promise;s.valid=false;s.loadContent=function(){var e={options:t.options,object:s,layout:t.layout,ext:s.ext};var n;n=s.ext.hasError(e)?p:s.ext.showRequirements(e)?d:s.ext;r.updateContent(n)};s.reset=function(){if(!this.valid)return;t.options=c.extend({},t.resetOptions,{isZoomed:t.options.isZoomed,interactionState:t.options.interactionState,direction:t.options.direction,onRendered:t.options.onRendered});o=n();this.loaded=o.promise;this.valid=false};s.validate=function(){if(this.valid)return;if(this.layout&&this.type&&this.ext){this.valid=true;o.resolve()}};s.setExtension=function(e){this.ext=e;t.ext=e;if("invalid"!==e.type){e.mapProperties(this.model);e.mapSoftProperties();this.setBackendApi();if(e.migrate){this.model.migrate={properties:e.migrate.properties||function(t){return t},snapshot:e.migrate.snapshot||function(t){return t}};"function"===typeof e.migrate.snapshot&&y.isSnapshotData(this.model.layout)&&e.migrate.snapshot(this.model.layout)}else this.model.migrate={properties:function t(e){return e},snapshot:function t(e){return e}}}this.validate();this.update();this.ext.model=this.model};s.setBackendApi=function(){var e=t.options.APIType||this.ext.BackendApi;var n=new e(this.model);this.backendApi=n;r.contentLoaded().then(function(t){t.setBackendApi(n)})};s.setType=function(n,i){this.backendApi&&this.backendApi.destroy();this.ext=null;this.backendApi=null;this.hasContent=false;this.type=n;n.load().then(function(o){if(s.type!==n)return;n!==q&&(s.error=null);function l(){s.setExtension(o);E(t,a,s,r);if(i){e.$rootScope.$broadcast("refreshPropertyPanel");e.$rootScope.$broadcast("reloadExploreContent")}}if("function"===typeof o.init){var c=o.init.call(null,a,s.layout);c&&"function"===typeof c.then?c.then(function(){l()},function(e){s.setRenderState(C.INVALID);s.error={class:"hard-error",title:u.get("Object.Invalid.Title"),message:e||u.get("Object.ErrorMessage.RenderingFailed",o.type)};r.updateContent(p).then(function(n){n.onPaint(t.layout,{visible:false}).then(function(){s.setRenderState(C.RENDERED);"function"===typeof t.options.onRendered&&t.options.onRendered.call(null,e)})});l()}):l()}else l()},function(){s.setType(q);I()?s.error={class:"hard-error",title:u.get("Object.Invalid.Title"),message:u.get("Object.ErrorMessage.NotFound.Cloud.Extensions",n.type)}:s.error={class:"hard-error",title:u.get("Object.Invalid.Title"),message:u.get("Object.ErrorMessage.NotFound",n.type)};s.isInvalid=true;s.setObjectClass()})};s.setModel=function(t){this.model=t;if(this.ext){this.ext.model=t;this.setBackendApi()}};s.on=function(){r.contentLoaded().then(function(t){t.view&&t.view.on()})};s.off=function(){r.contentLoaded().then(function(t){t.view&&t.view.off()})};s.isOn=function(){return r.contentLoaded().then(function(t){return t.view?t.view.isOn():null})};s.setInteractionState=function(n){s._interactionState=n;s._inEditState=n===v.EDIT;s._inAnalysisState=n===v.ANALYSIS;t.options.interactionState=n;this._inEditState&&s.viewDataToggled&&s.toggleDataView();r.contentLoaded().then(function(t){n!==v.ANALYSIS&&w(s);t.setInteractionState(n);e.getService("$timeout").cancel(l);l=e.getService("$timeout")(function(){s.setObjectClass()})})};s.getInteractionState=function(){return s._interactionState};s.inAnalysisState=function(){return s._inAnalysisState};s.inEditState=function(){return s._inEditState};s.setFreeResize=function(e){t.options.freeResize=e;r.contentLoaded().then(function(t){t.setFreeResize(e)})};s.setDirection=function(e){if(!e||t.options.direction===e)return;t.options.direction=e;r.contentLoaded().then(function(t){t.setDirection(e);s.update()})};s.setLayout=function(t){this.layout=t;var e=t.visualization||t.qInfo&&t.qInfo.qType;var n=i.getType(e);var a=n;t.extensionMeta&&t.extensionMeta.name&&(a=t.extensionMeta.name);if(t.qError){n=q;this.error={title:"Object.Error",message:"Object.Invalid.Info"}}if(!n){n=q;I()?this.error={title:"Object.Invalid.Title",message:["Object.ErrorMessage.NotFound.Cloud.Extensions",a,e]}:this.error={title:"Object.Invalid.Title",message:["Object.ErrorMessage.NotFound",a,e]}}if(this.ext&&this.ext.hasNewType&&this.ext.hasNewType(this,n,t)||this.type!==n){this.reset();this.setType(n,!!this.type)}this.isInvalid=n===q;this.isLink=!this.isInvalid&&!!t.qExtendsId;this.showTitles=false!==t.showTitles;this.validate();this.update()}}function E(n,i,a){function s(e){var n=t(e.target);if(a.selectionsApi.ignoreOnOutside(n))return;a.selectionsApi.getDockToElement().off(".object");a.selectionsApi.confirm()}a.activateSelections=function(){if("undefined"===typeof a.ext.options.selections)return;a.inAnalysisState()&&a.selectionsApi.activate()};a.selectionsApi&&"function"===typeof a.selectionsApi.destroy&&a.selectionsApi.destroy();function r(){a.backendApi&&a.backendApi.endSelections(true);return null}a.tooltipApi={cancel:function t(){},destroy:function t(){}};a.selectionsApi={destroy:function e(){this._activatedCallbacks=[];this._deactivatedCallbacks=[];t(window).off("onbeforeunload",r)},active:false,selectionsMade:false,_activatedCallbacks:[],_deactivatedCallbacks:[],on:function t(){},off:function t(){},ignoreOnOutside:function t(e){return!!(e.closest(".qv-selection-toolbar").length||e.closest(".selections-data-area-ui").length)},getDockToElement:function t(){return i},getMenuMaxHeight:function t(){return a.selectionsApi.getDockToElement().outerHeight()},getSelectionToolbarWidthOffset:function t(){return 0},refreshToolbar:function t(){e.getService("qvSelectionToolbarService").refresh()},watchActivated:function t(e){this._activatedCallbacks.push(e);return function(){var t=this._activatedCallbacks.indexOf(e);this._activatedCallbacks.splice(t,1)}.bind(this)},activated:function o(l){this.active=true;l||a.backendApi.beginSelections();t(window).on("onbeforeunload",r);if(!n.options.isPopover){this.getDockToElement().on("qv-outside.object",s);e.$apply(n,function(){a.setObjectClass();a.getSelectionToolbar().then(function(t){var s={toolbar:t,selectionsApi:a.selectionsApi,options:n.options,menuMaxHeight:a.selectionsApi.getMenuMaxHeight(),offsetWidth:a.selectionsApi.getSelectionToolbarWidthOffset()};var r=i.parent().closest(".qv-object-wrapper").length?i.parent().closest(".qv-object-wrapper"):i;e.getService("qvSelectionToolbarService").open(r,a.selectionsApi.getDockToElement(),s)})})}this._activatedCallbacks.forEach(function(t){t.call(this)},this)},watchDeactivated:function t(e){this._deactivatedCallbacks.push(e);return function(){var t=this._deactivatedCallbacks.indexOf(e);this._deactivatedCallbacks.splice(t,1)}.bind(this)},deactivated:function i(){t(window).off("onbeforeunload",r);this.active=false;this.selectionsMade=false;a.tooltipApi.cancel();if(!n.options.isPopover){a.selectionsApi.getDockToElement().off(".object");e.$apply(n,function(){a.setObjectClass();e.getService("qvSelectionToolbarService").close()})}this._deactivatedCallbacks.forEach(function(t){t.call(this)},this)},confirm:function t(){a.selectionsApi.deactivateSearch&&a.selectionsApi.deactivateSearch();a.backendApi.endSelections(true);a.tooltipApi.cancel();this.deactivated()},cancel:function t(){a.selectionsApi.deactivateSearch&&a.selectionsApi.deactivateSearch();a.backendApi.endSelections(false);a.tooltipApi.cancel();this.deactivated()},clear:function t(){a.backendApi.clearSelections();a.tooltipApi.cancel();this.selectionsMade=false},toggleKeyboardAccelerators:function t(){},getKeyAsToggleSelected:function t(e){return!(e.metaKey||e.ctrlKey)},search:function t(){},confirmSearch:function t(){},cancelSearch:function t(){},activate:function t(){if(this.active)return;this.activated()},notifyLockedSelections:function t(e){S.showLockedFeedback(e)}};a.selectionsApi.watchDeactivated(function(){n.$emit("childSelectionActive",false)});a.selectionsApi.watchActivated(function(){n.$emit("childSelectionActive",true)})}function _(t,n){var i,a,s;n.throbberApi&&"function"===typeof n.throbberApi.destroy&&n.throbberApi.destroy();function r(i,r){e.getService("$timeout").cancel(a);e.getService("$timeout").cancel(s);if(n.selectionsApi&&n.selectionsApi.active)n.throbberApi.hide();else if(t.model&&void 0===t.model.state)n.throbberApi.show();else if(t.model&&t.model.isCancelled)n.throbberApi.isQueryCanceled=true;else if(i){a=e.getService("$timeout")(function(){t.model&&t.model.isValidating&&n.throbberApi.show()},r);s=e.getService("$timeout")(function(){if(true===n.throbberApi.isVisible){n.throbberApi.isLongRunningQuery=true;n.throbberApi.isQueryCanceled=false}},8e3)}else{n.throbberApi.hide();n.throbberApi.isLongRunningQuery=false}}n.throbberApi={resizeCallbacks:[],isVisible:false,isLongRunningQuery:false,isQueryCanceled:false,initialize:function e(){i=t.$watch("model.isValidating",function(t){r(t,1e3)})},reset:function t(e){r(e,0)},show:function t(){n.throbberApi.isVisible=true;n.throbberApi.isQueryCanceled=false;n.throbberApi.isLongRunningQuery=false},hide:function t(){n.throbberApi.isVisible=false;n.throbberApi.isLongRunningQuery=false;e.getService("$timeout").cancel(a);e.getService("$timeout").cancel(s)},off:function t(){i();e.getService("$timeout").cancel(a);e.getService("$timeout").cancel(s)},destroy:function t(){n.throbberApi.off();n.throbberApi.resizeCallbacks.length=0},resize:function t(){n.throbberApi.resizeCallbacks.forEach(function(t){t()})},watchResize:function t(e){var i=n.throbberApi.resizeCallbacks;i.push(e);return function t(){var n=i.indexOf(e);-1!==n&&i.splice(n,1)}}};n.throbberApi.initialize()}function F(t,e){e.explore={resizeCallbacks:[],resize:function t(){e.explore.resizeCallbacks.forEach(function(t){t()})},watchResize:function t(n){e.explore.resizeCallbacks.push(n)},unwatchResize:function t(n){var i=e.explore.resizeCallbacks.indexOf(n);-1!==i&&e.explore.resizeCallbacks.splice(i,1)},destroy:function t(){e.explore.resizeCallbacks=[]}}}e.directive("qvObject",function(){return{restrict:"E",replace:true,template:r,scope:{options:"=",model:"=",object:"=?",navMenu:"=",snapshot:"=?"},controller:["$scope","qvDefaultViewSelectionService",function(t,e){var i=n();this.updateContent=function(e){var a=t.object;if(a&&a.content!==e){"undefined"!==typeof a.content&&(i=n());a.content=e}return i.promise};this.contentLoaded=function(){return i.promise};t.onInit=function(t,n,a){t instanceof f||(t=new(g.extend(t))(n,a,e));i.resolve(t)}}],link:function i(a,r,o,l){var u={},h;a.object=u;a.options||(a.options={});a.options.zoomEnabled=!!o.zoomObject;a.resetOptions=c.extend({},a.options);Object.defineProperties(u,{hasFrame:{get:function t(){return!a.options.isPopover&&!u.isInvalid}},isReadonly:{get:function t(){return!u||u.isLink||u.isInvalid||a.options.isReadonly}},isInteractive:{get:function t(){return!!u&&a.options.interactionState!==v.STATIC}},hasSoftProperties:{get:function t(){return!!this.ext&&!!this.ext.mappedSoftDefinition}}});u.getCreatePropertyHandler=function(){var t=u.model.app;return u.ext.getCreatePropertyHandler(t)};u.getPropertyPanelContent=function(){return u.loaded.then(function(){var t=u.getCreatePropertyHandler();var e=u.ext.mappedDefinition||u.ext.definition;var n=u.ext.globalChangeListeners;return{definition:e,globalChangeListeners:n,type:u.type,app:u.model.app,backendApi:u.backendApi,handler:t,iconName:u.ext.libraryInfo.icon,titleRef:"title",ext:u.ext}})};u.getSoftPropertyContent=function(){return u.loaded.then(function(){var t=u.ext.mappedSoftDefinition||u.ext.softDefinition;return{definition:t,type:u.type,backendApi:u.backendApi}})};u.setSnapshotData=function(t,e){return l.contentLoaded().then(function(n){return n.setSnapshotData(t,e)})};u.getViewState=function(){return l.contentLoaded().then(function(t){return t.getViewState?t.getViewState():void 0})};u.getPreferredSize=function(){return l.contentLoaded().then(function(t){var e=t.getPreferredSize();return e?e.then(function(t){if(!t)return;var e=r.find("footer"),n=r.find("header"),i=35;return{w:t.w,h:t.h+(e.height()||0)+(n.height()||0)+i+r[0].offsetTop}}):void 0})};u.getSnapshotLayout=function(){return u.loaded.then(function(){return l.contentLoaded().then(function(){return m.prepSnapshotData(u.model.layout,u,true)})})};u.toggleDataView=function(){return l.contentLoaded().then(function(t){if(t.view&&"function"===typeof t.view.toggleDataView){void 0===t.view.toggled&&t.view.initDataView(r[0].parentElement);return t.view.toggleDataView().then(function(e){if(e){u.dataViewObject=t.view.getDataViewObject();u.dataViewObject.setOnBlurHandler(u.blur)}u.viewDataToggled=e})}return n.resolve()})};u.getDropOptions=function(t,e){return u.loaded.then(function(){return l.contentLoaded().then(function(){return u.ext.getDropOptions(u,t,e)})})};u.canReceive=function(t){return!u.ext||!u.ext.canReceive||u.ext.canReceive(t)};u.getContextMenu=function(t,e){return l.contentLoaded().then(function(n){return n.getContextMenu(u,t,e)})};u.getObjectMenu=function(t){return l.contentLoaded().then(function(e){return e.getObjectMenu(u,t)})};u.getSelectionToolbar=function(){return u.loaded.then(function(){return l.contentLoaded().then(function(t){return t.getSelectionToolbar()})})};u.reloadContent=function(){u.ext=t.extend({},u.ext);a.ext=u.ext;u.loadContent();u.update()};u.canShowExploreMenu=function(){var t=this.content===d||this.content===p;return!this.isInvalid&&this.hasSoftProperties&&!t};function f(t,e,n){var i=u&&a.ext&&!(a.model&&!a.model.isValid&&!a.model.isValidating);e||(i=i&&t!==d);n||(i=i&&t!==p);return i}function g(t){var e=a.ext&&a.ext.support[t];if("function"===typeof e)return e.call(null,a.layout);if("boolean"===typeof e)return e;return false}u.supportCssScaling=function(){return f(this.content)&&g("cssScaling")};u.hasValidContent=function(){return f(this.content)};u.supportSnapshot=function(){if(!f(this.content))return false;var t=a.ext&&a.ext.snapshot&&a.ext.snapshot.canTakeSnapshot;if("undefined"===typeof t)return g("snapshot");if("function"===typeof t)return t.call(null,a.layout);if("boolean"===typeof t)return t;return false};u.supportObjectInfo=function(){if(!f(this.content))return false;if(u.isInvalid)return false;return this.layout.showDetails};u.supportExportData=function(){return f(this.content,false,true)&&g("exportData")};u.supportExport=function(){return f(this.content)&&g("export")};u.supportSharing=function(){return f(this.content)&&g("sharing")};u.supportViewData=function(){return f(this.content)&&g("viewData")};u.setRenderState=function(t){if(u&&u.renderState!==t){u.renderState=t;a.$emit("objectRenderStateChange",t)}};u.setOnFocusHandler=function(t){u.focus=t};u.setOnBlurHandler=function(t){u&&(u.blur=t)};u.cancel=function(){u.subscription.cancel();u.throbberApi.hide();u.throbberApi.isQueryCanceled=true;l.contentLoaded().then(function(t){t.view&&t.view.cancel()});"function"===typeof a.options.onCanceled&&a.options.onCanceled.call(null)};u.retry=function(){u.throbberApi.hide();u.throbberApi.reset(true);u.throbberApi.isQueryCanceled=false;a.model.markAsInvalid();a.model.getLayout().then(function(t){a.layout=t;u.setLayout(t)});l.contentLoaded().then(function(t){t.view&&t.view.retry()})};k(a,r,u,l);D(a,u);P(a,u,r,l);F(a,u);u.setRenderState(C.INVALID);function y(){u.update()}u._themeChangeWatcher=y;b.ThemeChanged.bind(u._themeChangeWatcher);s.load(a.options._skipRegisterExtensions).then(function(){M(a,u);_(a,u,l)});u.loaded.then(function(){a.cancelled=a.model.isCancelled});a.$watch("options.interactionState",function(t){var e=Number.isNaN(+t)?1:t;u.setInteractionState(e)});a.$watch("options.direction",function(t){u.setDirection(t)});a.$watch("options",function(t){t&&t.setController&&l.contentLoaded().then(function(){t.setController(u)})});a.$on("childSelectionActive",function(t,e){u&&(u.childInSelection=e);t.preventDefault()});a.titleClicked=function(){this.options._disableSelections||u._inEditState||l.contentLoaded().then(function(t){(t.view&&t.view.selections||t.$scope.interactive)&&u.activateSelections()})};a.cancel=function(){u.cancel()};a.retry=function(){u.retry()};var S=false;a.$on("$destroy",function(){if(S)return;S=true;e.getService("$timeout").cancel(h);b.ThemeChanged.unbind(u._themeChangeWatcher);if(u){w(u);u.selectionsApi&&"function"===typeof u.selectionsApi.destroy&&u.selectionsApi.destroy();if(u.tooltipApi){u.tooltipApi.destroy&&u.tooltipApi.destroy();u.tooltipApi=null}if(u.backendApi){u.backendApi.destroy();u.backendApi=null}u.throbberApi&&u.throbberApi.destroy();u.explore&&u.explore.destroy();u=null;a.object=null}})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(92),n(90),n(405)],a=function(t,e,n){var i,a={3:"k",6:"M",9:"G",12:"T",15:"P",18:"E",21:"Z",24:"Y","-3":"m","-6":"μ","-9":"n","-12":"p","-15":"f","-18":"a","-21":"z","-24":"y"},s=/%$/,r=/^\(r(0[2-9]|[12]\d|3[0-6])\)/i,o=/^\(oct\)/i,l=/^\(dec\)/i,c=/^\(hex\)/i,u=/^\(bin\)/i,d=/^\(rom\)/i,p=/^(\(rom\)|\(bin\)|\(hex\)|\(dec\)|\(oct\)|\(r(0[2-9]|[12]\d|3[0-6])\))/i;function h(t,e,n,i){t=t.toString(e);n[1]===n[1].toUpperCase()&&(t=t.toUpperCase());t.length-t.indexOf(".")>10&&(t=t.slice(0,t.indexOf(".")+11));return t.replace(".",i||".")}function f(t,e,n){var i;if(r.test(e))t=h(t,Number(/\d{2}/.exec(e)[0]),e,n);else if(o.test(e))t=h(t,8,e,n);else if(l.test(e))t=h(t,10,e,n);else if(c.test(e))t=h(t,16,e,n);else if(u.test(e))t=h(t,2,e,n);else if(d.test(e)){i="";if(t<0){i="-";t=-t}t=Math.floor(t);if(0===t)t="0";else if(t<=5e5){t=g(t,e);t=i+t}else t=e+i+t.toExponential(0)}return t}function g(t,e){var n,i="",a=Number(String(t).slice(-3)),s=(t-a)/1e3,r=[0,1,4,5,9,10,40,50,90,100,400,500,900].reverse(),o=["0","I","IV","V","IX","X","XL","L","XC","C","CD","D","CM"].reverse();while(a>0)for(n=0;n<r.length;n++)if(r[n]<=a){i+=o[n];a-=r[n];break}for(n=0;n<s;n++)i="M"+i;e[1]!==e[1].toUpperCase()&&(i=i.toLowerCase());return i}function v(t){if(!t||!t.qNumericalAbbreviation)return a;var e={};var n=t.qNumericalAbbreviation.split(";");n.forEach(function(t){var n=t.split(":");2===n.length&&(e[n[0]]=n[1])});return e}i=t.extend("NumberFormatter",{init:function t(e,n,i,a,s){this.localeInfo=e;this.pattern=n;this.thousandDelimiter=i||",";this.decimalDelimiter=a||".";this.type=s||"numeric";this.abbreviations=v(e);this.prepare()},clone:function t(){var e=new i(this.localeInfo,this.pattern,this.thousandDelimiter,this.decimalDelimiter,this.type);e.subtype=this.subtype;return e},format:function t(e,n,i,a){this.prepare(n,i,a);return this.formatValue(e)},prepare:function t(e,n,i){var a,s;"undefined"===typeof e&&(e=this.pattern);"undefined"===typeof n&&(n=this.thousandDelimiter);"undefined"===typeof i&&(i=this.decimalDelimiter);if(!e){this._prepared={pattern:false};return}this._prepared={positive:{d:i,t:n,abbreviate:false,isFunctional:false,prefix:"",postfix:""},negative:{d:i,t:n,abbreviate:false,isFunctional:false,prefix:"",postfix:""}};a=this._prepared;e=e.split(";");a.positive.pattern=e[0];a.negative.pattern=e[1];p.test(e[0])&&(a.positive.isFunctional=true);e[1]?p.test(e[1])&&(a.negative.isFunctional=true):a.negative=false;s=a.positive.isFunctional&&(!a.negative||a.negative&&a.negative.isFunctional);if(!s){m(a.positive,n,i);a.negative&&m(a.negative,n,i)}},formatValue:function t(e){var i=this._prepared,a,s,r="",o,l,c="",u,d,p,h,g;if(Number.isNaN(+e))return e;if(false===i.pattern)return e.toString();if(e<0&&i.negative){i=i.negative;e=-e}else i=i.positive;u=i.d;d=i.t;if(i.isFunctional)e=f(e,i.pattern,u);else{i.percentage&&(e*=100);if(i.abbreviate){var v=this.abbreviations;var m=Object.keys(v).map(function(t){return parseInt(t)}).sort(function(t,e){return t>e?1:-1});var b;var y=m[0];p=0;s=Number(Number(e).toExponential().split("e")[1]);while(y<=s&&p<m.length){p++;y=m[p]}p>0&&(b=m[p-1]);var S;b&&s>0&&b>0?S=b:(s<0&&b<0||!b)&&(y<0&&y-s<=i.maxPrecision?S=y:b<=s&&!(y>0&&-s<=i.maxPrecision)&&(S=b));if(S){r=v[S];e/=Math.pow(10,S)}}o=Math.abs(e);a=i.temp;h=i.numericPattern;g=h.split(u)[1];"I"===this.type&&(e=Math.round(e));l=e;if(g||"#"!==h.slice(-1)[0])if(o>=1e15||o>0&&o<=1e-14)e=o?o.toExponential(15).replace(/\.?0+(?=e)/,""):"0";else{var x=Number(e.toFixed(Math.min(20,g?g.length:0)).split(".")[0]);var q=h.split(u)[0];q+=u;e=n(q,x)||"0";if(g){var I=Math.max(0,Math.min(14,g.length));var C=g.replace(/#+$/,"").length;var w=Number((o%1).toPrecision(I)).toFixed(I);w=w.slice(2).replace(/0+$/,"");for(p=w.length;p<C;p++)w+="0";w&&(e+=u+w)}else 0===x&&(l=0)}else if(o>=Math.pow(10,a)||o<1||o<1e-4)if(0===e)e="0";else if(o<1e-4||o>=1e20){e=l.toExponential(Math.max(1,Math.min(14,a))-1);e=e.replace(/\.?0+(?=e)/,"");c=""}else{e=e.toPrecision(Math.max(1,Math.min(14,a)));if(e.indexOf(".")>=0){e=e.replace(e.indexOf("e")<0?/0+$/:/\.?0+(?=e)/,"");e=e.replace(".",u)}}else{h+=u;a=Math.max(0,Math.min(20,a-Math.ceil(Math.log(o)/Math.log(10))));for(p=0;p<a;p++)h+="#";e=n(h,e)}e=e.replace(i.numericRegex,function(t){if(t===d)return i.groupTemp;if(t===u)return i.decTemp;return""});l<0&&!/^-/.test(e)&&(e="-"+e)}return i.prefix+e+c+r+i.postfix}});function m(t,e,n){var i,a,r=t.pattern,o,l,c,u,d,p,h;if(r.indexOf("A")>=0){r=r.replace("A","");t.abbreviate=true}h=y(e,n);o=r.match(h);o=o?o[0]:"";l=o?r.substr(0,r.indexOf(o)):r;c=o?r.substring(r.indexOf(o)+o.length):"";o||(o=r?"#":"##########");if(e&&e===n){i=o.split(n);a=i.pop();o=i.join("")+n+a;e=""}u=e;e=/,/.test(n)?"¤":",";u&&(o=o.replace(b(u,"g"),e));d=n;n=".";d&&(o=o.replace(b(d,"g"),n));p=o.match(/#/g);p=p?p.length:0;var f=r.split(d);var g;f[1]&&(g=f[1].match(/#|0/g));t.prefix=l||"";t.postfix=c||"";t.pattern=r;t.maxPrecision=g?g.length:2;t.percentage=s.test(r);t.numericPattern=o||"";t.numericRegex=new RegExp(b(e,null,true)+"|"+b(n,null,true),"g");t.groupTemp=u;t.decTemp=d;t.t=e;t.d=n;t.temp=p}function b(t,n,i){var a=e.escapeRegExp(t);if(i)return a;return new RegExp(a||"",n)}function y(t,n){n&&(n=e.escapeRegExp(n));t&&(t=e.escapeRegExp(t));return new RegExp("(?:[#0]+"+t+")?[#0]+(?:"+n+"[#0]+)?")}window.NumberFormatter=i;i.getStaticFormatter=function(){return{prepare:function t(){},formatValue:function t(e){return e+""}}};return i}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(10),n(48),n(871),n(94),n(102),n(169),n(176)],a=function(t,e,n,i,a){e.service("qvGlobalSearchService",["$document","qvSelectionToolbarService",function(e,s){var r,o={};function l(t){return o[u(t)]}function c(t,e){o[u(t)]=e}function u(t){if(t.id)return t.id.toUpperCase();return t.id}function d(t){return{$container:void 0,$containerId:".qv-global-search-container",$app:t,$lastKnownIndexProgress:void 0,$haveQuery:false,getComponent:function t(){return n},setup:function e(){i.StateChanged.bind(p.bind(null,t));t.isInModalSelection()&&s.confirm()},destroy:function t(){i.StateChanged.unbind(p)}}}function p(t){(i.isInEditMode()||!i.isInAnalysisMode||i.inObjectView())&&g(l(t))}function h(n,i,a){n.$container=t.element("<div>");i=i||e;i.find(n.$containerId).append(n.$container);n.$container.showComponent(n.getComponent(),["$scope",function(t){t.app=n.$app;t.options={objectSearchIsOn:a}}]);n.setup()}function f(t){return!(!t||void 0===t.$container)}function g(t){if(t.$container){t.$container.remove();t.$container=void 0}t.destroy()}function v(t){var e=l(t);if(!e){e=new d(t);c(t,e)}return e}function m(t,e){try{var n=e.qTransientProgressMessage.qMessageParameters[0],i=new Number(n),a=v(t);!Number.isNaN(+i)&&n&&(a.$lastKnownIndexProgress=i);r.IndexProgressUpdate.emit(u(t),i)}catch(t){return}}r={toggleGlobalSearch:function t(e,n,i){var a=v(e);f(a)?g(a):h(a,n,i)},openGlobalSearch:function t(e,n){var i=v(e);if(!f(i)){g(i);h(i,n)}},closeGlobalSearchIfNoQuery:function t(e){var n=l(e);n&&n.$haveQuery||this.off()},off:function t(){Object.keys(o).forEach(function(t){g(o[t])})},isSearchOpen:function t(e){return f(l(e))},setLastKnownIndexProgress:function t(e,n){var i=l(e)||{};i.$lastKnownIndexProgress=n},getLastKnownIndexProgress:function t(e){var n=l(e)||{};return n.$lastKnownIndexProgress},couldEngineBeIndexing:function t(e){var n=l(e)||{},i=n.$lastKnownIndexProgress;return void 0!==i&&i<100},requestIndexProgressUpdate:function t(e){e.global.getProgress(0).then(m.bind(null,e))},setHaveQuery:function t(e,n){var i=v(e);i.$haveQuery=n}};a.mixin(r);r.notification("IndexProgressUpdate");return r}])}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(612)],a=function(t){return{template:t,controller:[function(){}],scope:{item:"=",style:"="}}}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91)],a=function(t,e){t.service("qvCurrentSelectionsService",[function(){function t(t){return t.qStateCounts.qSelected+t.qStateCounts.qSelectedExcluded+t.qStateCounts.qLocked+t.qStateCounts.qLockedExcluded}function n(t){var n=t.states.length;return e.get("CurrentSelections.SelectionsInStates",n)}function i(n){var i=t(n),a=n.qTotal,s;s=a===i&&a>1?e.get("CurrentSelections.All"):i>1&&a>1?e.get("CurrentSelections.Of",[i,a]):n.qSelectedFieldSelectionInfo.map(function(t){return t.qName}).join(", ").toString();return s}return{translate:function t(e){return e.states?n(e):i(e)},translatedScreenReaderLabel:function i(a){var s;if(a.states)s=n(a);else{var r=t(a),o=a.qTotal,l=a.qField,c=a.qSelected;s=o===r&&o>1?e.get("CurrentSelections.AllSelections",[l]):r>1&&o>1?e.get("CurrentSelections.MultipleSelections",[l,r,o]):e.get("CurrentSelections.SingleSelection",[l,c])}return s}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(10),n(96),n(91),n(89),n(390),n(1018),n(205),n(231),n(110),n(461)],a=function(t,e,n,i,a,s,r,o,l,c){function u(t){return t.qErrorCode===l.NxLocalizedErrorCode.LOCERR_CALC_EVAL_CONDITION_FAILED}function d(t){return t.qErrorCode===l.NxLocalizedErrorCode.LOCERR_CALC_NOT_CALCULATED}function p(t,e){var n={holder:null,type:""};var i=e&&t[e]?t[e].qHyperCube:t.qHyperCube;if(i&&i.qError){n.holder=i;n.errorTranslationFunc=o.getHyperCubeError}else if(t.layers&&t.layers.length&&t.layers[0].qHyperCube){t.layers[0].qHyperCube.qError?n.holder=t.layers[0].qHyperCube:t.layers[0].geodata.qHyperCube.qError&&(n.holder=t.layers[0].geodata.qHyperCube);n.errorTranslationFunc=o.getHyperCubeError}else if(t.qListObject&&t.qListObject.qError){n.holder=t.qListObject;n.errorTranslationFunc=o.getListObjectError}else if(t.qListObject.qDimensionInfo&&t.qListObject.qDimensionInfo.qError.qErrorCode){n.holder=t.qListObject.qDimensionInfo;n.errorTranslationFunc=o.getDimensionError}return n}function h(t){var e=t.qError.qErrorCode;switch(e){case l.NxLocalizedErrorCode.LOCERR_CALC_EVAL_CONDITION_FAILED:return c.getLayoutMsg(t)||""}if(t.qError.qContext){var i=[t.qError.qContext];return n.get("ErrorCode."+e,i)}}var f=r.extend({$scope:null,init:function n(i){this.$scope=i;i.hasSoftError=false;i.hasHardError=false;i.showMore=function(n){var s=t.element("<div>").appendTo("body");s.showComponent(a,{alignTo:t.element(n.target),error:i.error,onClose:function t(){s.remove();e.preventGestures()}})}},onPaint:function t(){var e=this.$scope,a;var s=e.object.error;if(!s){var r=e.layout;var o=e.object.ext&&e.object.ext.options?e.object.ext.options.hyperCubePath:"";var l=p(r,o);if(l.holder){a=h(l.holder)||l.errorTranslationFunc(l.holder.qError.qErrorCode);s=u(l.holder.qError)?{class:"soft-error",message:a}:{class:"hard-error",title:n.get("Object.Error"),message:a}}}e.error=s;return i.resolve()}});f.$inject=["$scope"];return{template:s,controller:f,isCalcCondNotCalculatedErr:d}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){return{DEFAULT_STATE_TRANSLATION:"AlternateState.DefaultState",DEFAULT_STATE_NAME:"$"}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(97),n(99),n(854)],a=function(t,e,n){t.directive("qvPager",["$timeout",function(t){return{restrict:"A",priority:0,link:function i(a,s){n.treatAsDesktop()||s.css("overflow-x","auto");a.pagerData=s.find("ul").pager().data("qv-pager");s.addClass("qv-pager");a.nextPage=function(){t(function(){a.pagerData.goToNextPage();a.refreshPager(true)})};a.prevPage=function(){t(function(){a.pagerData.goToPreviousPage();a.refreshPager(true)})};a.goToPage=function(t){a.pagerData.goToPage(t);a.refreshPager(true)};a.refreshPager=function(t){var e="";t||a.pagerData.refresh();s.removeClass("qv-pager-back qv-pager-forward");if(1!==a.pagerData.currentPage){a.showShadow=true;e+="qv-pager-back "}else a.showShadow=false;a.pagerData.currentPage!==a.pagerData.maxPages&&(e+="qv-pager-forward ");s.addClass(e)};function r(){a.refreshPager()}a.$on("refreshPager",r);a.$on("$destroy",function(){e.off("end",r)})}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(54),n(91),n(48),n(89),n(105),n(147),n(154),n(134),n(112),n(233),n(366)],a=function(t,e,n,i,a,s,r,o,l){n.service("qvCaoSearchService",["qvCaoSelectionService",function(n){var c;function u(){c=this;this.fieldList=[];this.queryString=[];this.queryTokens=[];this.caoSearchQueryHandlers=[]}u.prototype.createFieldList=function(){var t=[];return r.getList().then(function(t){return t.getLayout()}).then(function(e){t=t.concat(e);return c.getMasterItems()}).then(function(e){t=t.concat(e);c.fieldList=c.sortFields(t);return c.fieldList})};u.prototype.getFields=function(){return this.fieldList};u.prototype.getSelectedFields=function(t){return this.getFields().filter(function(t){return t.selected}).filter(function(e){var n=t.indexOf(e.qName);return n>-1})};u.prototype.syncFieldsInQueryWithFieldPicker=function(e){var n=this.getSelectedFields(e);this.fieldList=this.fieldList.map(function(e){var i=t.find(n,function(t){return t.caoFieldId===e.caoFieldId});e.selected=!!i;return e})};u.prototype.getMeasureMasterItems=function(){var t=this;return s.getList().then(function(e){return e.getLayout().then(function(e){t.measureMasterItems=e.map(function(t){return{qName:t.qData.title,classifications:["measure"],masterItem:true,libId:t.qInfo.qId,libIdLabel:t.qMeta.title}});return t.measureMasterItems})})};u.prototype.getDimensionMasterItems=function(){var t=this;return o.getList().then(function(e){return e.getLayout().then(function(e){t.dimensionMasterItems=e.map(function(t){return{qName:t.qData.title,classifications:["dimension"],masterItem:true,libId:t.qInfo.qId,libIdLabel:t.qMeta.title}});return t.dimensionMasterItems})})};u.prototype.getMasterItems=function(){var t=[];return i.all({measureItems:this.getMeasureMasterItems(),dimItems:this.getDimensionMasterItems()}).then(function(e){t=e.measureItems.concat(e.dimItems);return t})};u.prototype.sortFields=function(t){t=t.map(function(t){var n="cao_field_"+t.qName;n=n.split(" ").join("_");t.masterItem||(1===t.qSrcTables.length?t.tablesAssociated=t.qSrcTables[0]+" "+e.get("cao.search.field.table"):t.tablesAssociated=e.get("cao.search.field.table.title",t.qSrcTables.length));t.qSrcTables&&(t.tablesTooltip=t.qSrcTables.join(", "));t.name=t.qName;t.caoFieldId=t.masterItem?n+"masterItem_"+t.classifications[0]:n;t.highlight=false;t.classificationIcon=c.getFieldClassificationIcon(t);t.displayNameTokens=[{text:t.qName,matching:false}];if(t.classifications&&t.classifications.length>0){t.masterItemDimension="dimension"===t.classifications[0]&&t.masterItem;t.masterItemMeasures="measure"===t.classifications[0]&&t.masterItem}t.masterItem&&(t.masterItemTitle=t.masterItemDimension?e.get("cao.fieldPicker.masterItem.dimension"):e.get("cao.fieldPicker.masterItem.measure"));return t});return l.localeOrderBy(t,function(t){return t.qName})};u.prototype.getFieldClassificationIcon=function(e){var n;var i=t.find(e.qTags,function(t){return"$date"===t});var a=t.find(e.qTags,function(t){return"$geoname"===t});i?n="lui-icon--calendar":a&&(n="lui-icon--map");return n};u.prototype.indexesOfWordInString=function(t,e){t=t.toLowerCase();e=e.toLowerCase();var n=[];var i=t.indexOf(e);i>-1&&n.push(i);while(i>-1){i=t.indexOf(e,++i);i>-1&&n.push(i)}return n};u.prototype.getQueryTokensBasedOnQuotes=function(t){var e=[];if(t&&t.length>0){var n=t.split(" ");var i=0;var a=null;var s=null;var r=null;var o=false;n.forEach(function(l,u){a='"'===l.charAt(0);s='"'===l.charAt(l.length-1);u<n.length-1&&(r='"'===n[u+1].charAt(0));if(a){i=u;o=true;if(1===n.length&&a){l=l.substr(1);e.push(c.createToken(l,e,t,false));o=false}else if(u===n.length-1&&n.length>1){l=n.slice(i,u+1).join(" ").substr(1);e.push(c.createToken(l,e,t,false));o=false}if(o&&r&&!s){l=n.slice(i,u+1).join(" ").substr(1);e.push(c.createToken(l,e,t,false));o=false}}else if(o&&r&&!s){l=n.slice(i,u+1).join(" ").substr(1);e.push(c.createToken(l,e,t,false));o=false}else if(s){l=n.slice(i,u+1).join(" ");e.push(c.createToken(l,e,t,true));o=false}else if(o&&u===n.length-1){l=n.slice(i,u+1).join(" ").substr(1);e.push(c.createToken(l,e,t,false));o=false}else o||e.push(c.createToken(l,e,t,false))})}this.queryTokens=e;return this.queryTokens};u.prototype.createToken=function(t,e,n,i){var a;var s=t.length;if(e&&e.length>0){var r=e[e.length-1];a=n.indexOf(t,r.indexEnd)}else a=n.indexOf(t);""===t&&(s=1);return{word:i?t.substr(1).slice(0,-1):t,indexStart:""===t?a+1:a,indexEnd:a+s}};u.prototype.addStringToQueryAtIndex=function(t,e,n){var i="";if(e&&e.length>0){var a=e;var s=e.slice(0,n).trim();var r=a.slice(n).trim();i=s+t+r}return i};u.prototype.getCurrentToken=function(t,e){var n={index:null,token:null};var i=this.getQueryTokensBasedOnQuotes(t);i.some(function(t,i){if(e>=t.indexStart&&e<=t.indexEnd){n.index=i;n.token=t;return e>=t.indexStart&&e<=t.indexEnd}});return n};u.prototype.replaceTwoOrMoreSpacesWithOne=function(t){return t.replace(/\s\s+/g," ")};u.prototype.removeFieldFromQuery=function(t,e,n){var i=this.indexesOfWordInString(e,t.qName);if(i.length>1){n=n.filter(function(e){return e.caoFieldId!==t.caoFieldId}).map(function(t){t.indexStartOfFieldInQuery=e.indexOf(t.qName);t.indexEndOfFieldInQuery=e.indexOf(t.qName)+t.qName.length;return t});var a=-1;i.forEach(function(i){n.forEach(function(n){a=i!==n.indexStartOfFieldInQuery?i:e.indexOf(t.qName)})});if(-1===a)e=e.replace(t.qName,"");else{var s=e.split("");s.splice(a,t.qName.length);e=s.join("")}}else e=e.replace(t.qName,"");return e.replace(/^\s+/g,"")};u.prototype.addFieldToQuery=function(t,e,n,i,a){e=e||"";var s=t.qName.match(" ")||t.qName.match(String.fromCharCode(160));var r=s?'"'+t.qName+'"':t.qName;var o=this.getQueryTokensBasedOnQuotes(e);var l=0;var c=a-i>0;if(c){var u=e.split("");u.splice(i,a-i,r);e=u.join("");l=i+r.length+1}else if(""===e){e=r;l=n+r.length+1}else if(o.length>0&&t){var d=this.getCurrentToken(e,n);if(null!==d.index){o[d.index]={word:t.qName};e=o.map(function(t,e){if(e===d.index&&e<o.length-1&&o[e+1].word)return t.word.match(" ")?'"'+t.word+'" ':t.word+" ";return t.word.match(" ")?'"'+t.word+'"':t.word}).join(" ");l=d.token.indexStart+r.length+1}else{var p=" "+r;e=this.addStringToQueryAtIndex(p,e,n);l=n+r.length+1}}e=e.replace(/^\s+/g,"");return{query:e,cursorPosition:l}};u.prototype.searchResultPositionRelativeToQuery=function(t,e){var n=7.5;var i=.7;var a=0;if(t&&t.length>0){var s=t.slice(0,e).split("");var r=s.filter(function(t){return" "!==t});var o=s.filter(function(t){return" "===t});a+=r.length*n;a+=o.length*i}return a};u.prototype.registerForCaoSearchQuery=function(t){this.caoSearchQueryHandlers.push(t)};u.prototype.unRegisterFromCaoSearchQuery=function(){this.caoSearchQueryHandlers=[]};u.prototype.getMatchingFields=function(e,n){var i=[];var a=this.fieldList;var s;e?e=e?e.toLowerCase():"":e&&""!==e||(s=true);i=a.filter(function(t){var i=t.qName.toLowerCase();if(s||i.indexOf(e)>-1)return!n||n&&t.masterItem;return false});i=t.uniq(i).filter(function(t){return l.librarySearchFn(t,e)});return l.localeOrderBy(i,function(t){return t.qName})};u.prototype.clearSelectedFields=function(){this.fieldList.forEach(function(t){t.selected=false});n.clearSelection()};u.prototype.selectField=function(t,e){this.fieldList=this.fieldList.map(function(n){n.caoFieldId===t.caoFieldId&&(n.selected=e);return n})};u.prototype.updateInsights=function(t){this.caoSearchQueryHandlers.forEach(function(e){e&&e({query:t,fields:c.getFields().filter(function(t){return t.selected})})});n.clearSelection()};u.prototype.showIntro=function(t){this.caoSearchQueryHandlers.forEach(function(e){e&&e({showIntro:t})})};u.prototype.matchingField=function(t,e,n){var i=e>0&&e<=n.length-1;var s=e>=-1&&e<n.length-1;switch(t){case a.KeyCodes.Up:i&&e--;break;case a.KeyCodes.Down:s&&e++;break;case a.KeyCodes.Tab:break}return n[e]};return new u}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(907)],a=function(t,e){t.directive("qvProgressBar",["$interval",function(t){return{replace:true,template:e,restrict:"E",scope:{percentDone:"=",onCompleted:"&",options:"="},link:function e(n){var i,a=true;n.display="0%";n.showPercent=0;function s(){if(n.showPercent>=100){t.cancel(i);n.onCompleted();return}if(n.showPercent>=n.percentDone){t.cancel(i);return}r(n.showPercent+1)}n.$watch("percentDone",function(e){if(void 0!==e)if(a){r(e);a=false}else{t.cancel(i);i=t(s,10)}});function r(t){n.showPercent=t;n.display=t+"%"}n.$on("$destroy",function(){t.cancel(i)})}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(968)],a=function(t,e){var n={bindings:{currentSelectionDisabled:"<"},template:e};t.directive("qvCurrentSelectionsItem",function(){return n});return n}.apply(e,i),void 0!==a&&(t.exports=a))},,,function(t,e,n){"use strict";var i,a;!(i=[n(11),n(89),n(48),n(397),n(10)],a=function(t,e,n,i){var a=window.angular,s={"max-height":"90%","max-width":"90%","min-height":"180px",width:"400px"},r,o=false,l=false;n.directive("qvDelayedDialogButton",function(){return{replace:true,restrict:"A",link:function t(e){e.button&&e.button.defaultEscButton&&(r=e);e.closeModal=function(t,n){if(t){t.preventDefault();t.stopPropagation()}e.button&&e.button.callback&&("undefined"===typeof e.button.expression||e.button.expression)&&e.button.callback();(n||e.autoClose||e.button&&!e.button.callback)&&e.destroyModal();return}}}});n.service("$delayedModal",["$compile","$rootScope","$document",function(n,c,u){var d={},p,h,f,g,v=i,m;var b={open:function t(i){var b=new e,y;if(p){h=p;g=f}p=c.$new();f=a.element('<div class="qv-modal-container qui-modalbackground-centered" qva-outside-ignore-for="allOutside" ng-style="containerStyle" ng-class="classes"></div>');p.containerStyle={content:" "};p.classes={};p.modalStyle={};var S;for(S in s)p.modalStyle[S]=s[S];p.wasDisabled=[];p.showDefaultButton=true;o=true;l=false;d=i;p.failed=false;p.autoClose=true;for(S in d)p[S]=d[S];f.html(v).appendTo(u.find("body"));p.html&&f.find("main").append(p.html);y=p.$watch("element",function(){b.resolve();y()});m=n(f)(p);p.destroyModal=this.close.bind(this);p.handleEscButton=function(t){if(t){t.preventDefault();t.stopPropagation()}p.buttons&&r?r&&r.closeModal():p.destroyModal()};p.$broadcast("delayed-modal-opened");p.$watchCollection("[width, height]",function(){p.width&&(p.modalStyle.width=p.width);p.height&&(p.modalStyle.height=p.height)});return b.promise},update:function t(e){if(!o)return;for(var i in e){p[i]=e[i];d[i]=e[i]}if(e.html||e.buttons){f.html(v);f.find("main").html(e.html);u.find("body").find(".qui-delayedModal").replaceWith(f.html());m=n(f)(p)}},close:function t(){if(p&&f){p.$broadcast("delayed-modal-closed");f.remove();p.$destroy();p=h||null;f=g||null;g=null;h=null}o=false;l=false},lock:function e(){l=true;p.wasDisabled.length=0;m.find("button, input, textarea, select").each(function(){var e=t(this);e.prop("disabled")?p.wasDisabled.push(this):e.prop("disabled",true)})},unlock:function e(){l=false;m.find("button, input, textarea, select").each(function(){-1===p.wasDisabled.indexOf(this)&&t(this).prop("disabled",false)});p.wasDisabled.length=0}};Object.defineProperty(b,"isOpened",{get:function t(){return o}});Object.defineProperty(b,"isLocked",{get:function t(){return l}});Object.defineProperty(b,"scope",{get:function t(){return p}});return b}])}.apply(e,i),void 0!==a&&(t.exports=a))},,,function(t,e,n){"use strict";var i,a;function s(t){s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return s(t)}!(i=[n(11),n(48),n(1011),n(1012),n(89),n(90)],a=function(t,e,n,i,a,r){var o,l,c=i.BUTTON_WIDTH,u=i.SEPARATOR_WIDTH,d=i.BORDER_SPACING,p=i.SELECT_DEFAULT_WIDTH,h=i.EXTRA_EDGE_PADDING,f=i.TYPE_BUTTON,g=i.TYPE_SEPARATOR,v=i.TYPE_SELECT;e.componentDirective("qvaIncludeSelectionToolbar",{toolbar:"=",options:"="});l={width:0,items:[],hasItems:function t(){return this.items.length>0},reset:function t(e){this.width=e;this.items.length=0},freeWidth:function t(){var e,n=0;for(e=0;e<this.items.length;e++)n+=this.items[e];return this.width-n}};o={template:n,controller:["$scope",function(n){var i=a(),o=i.promise,m={},b;n.filteredButtons=[];n.currentMenuButtons=[];n.levels=[];n.selectionInfo={show:false,selected:0,total:0};n.lassoEnabled=false;function y(t){if(t.component)return t.component;if("sel-toolbar-icon-separator"===t.buttonClass)return g;return f}function S(t){var e=y(t);switch(e){case f:return c+d;case g:return u+d;case v:return(t.width||p)+d}}function x(t,e,i){var a=0,s,r;l.reset(t-(d+2*h));for(r=e.length-1;r>=0;r--){s=S(e[r]);if(!(s<=l.freeWidth()))break;l.items.push(s)}(n.toolbar.showLock||n.locked)&&(a+=c+d);(i.length>0||e.length>l.items.length)&&(a+=c+d);while(l.hasItems()&&l.freeWidth()<a)l.items.pop();return l.items.length}function q(t,e){t._componentId=e;t.items&&t.items.forEach(function(t){t._componentId=e})}function I(t){t.forEach(function(t){t._componentId&&q(t,t._componentId)});n.currentMenuButtons=t}function C(t){t.forEach(function(t){q(t,t._componentId||r.generateId());m[t._componentId]=t})}function w(){var t=[].concat(n.toolbar.buttons),e=[].concat(n.toolbar.menuButtons),i=x(n.toolbar.style.width,t,e),a,s,r=[];n.filteredButtons=[];var o=[];n.levels=[];var l=t.concat(e).filter(function(t){return t.component});C(l);for(a=0;a<i&&t.length;++a){s=t.pop();s.component?r.push(s):n.filteredButtons.push(s)}n.filteredButtons.reverse();while(t.length){s=t.pop();y(s)!==g&&o.push(s)}while(e.length)o.push(e.shift());I(o);D(r)}this.layoutItems=w;function D(t){t.forEach(function(t){switch(t.component){case v:var e={width:p};var i=r.extend(true,e,t);r.extend(t,i);n.selectComponents=n.selectComponents||[];n.selectComponents.push(t);break;default:throw new Error("Select toolbar component: "+t.component+" was not recognized")}})}this.confirm=function(){n.selectionsApi.confirm()};this.close=function(){n.destroyComponent()};this.refresh=function(){e.$apply(n)};function M(){b=null;var t=n.levels.pop();I(t.items)}function T(t){n.levels.push({items:n.currentMenuButtons});I(t)}function A(t){return m[t]}n.shouldShowBtnMore=function(){return n.currentMenuButtons.length>0};n.shouldDisableSelect=function(t){var e=true===t.isDisabled||"function"===typeof t.isDisabled&&t.isDisabled();return!!e};n.shouldShowSelect=function(t){var e=!n.locked&&(void 0===t.show||"boolean"===typeof t.show&&false!==t.show||"function"===typeof t.show&&t.show(t.value));return!!e};n.buttonAction=function(t,e){t.originalEvent.preventDefault();t.stopPropagation();e.action.call(n.toolbar)};n.buttonIsDisabled=function(t){switch(s(t.isDisabled)){case"function":return!!t.isDisabled.call(n.toolbar);case"boolean":return t.isDisabled;default:return false}};n.isButtonSelected=function(t){var e=t.items;var n=A(t._componentId)||{};var i=!e&&t._componentId&&t.hasOwnProperty("value")&&n.value===t.value;return!!i};n.menuAction=function(e){e.originalEvent.preventDefault();var i="DIV"===e.target.tagName?t(e.target):t(e.target).parents("div");var a=i.scope();var s=i.attr("tid");if(a.button&&a.button.items){b=a;T(a.button.items)}else if("sel-toolbar-menu-back"===s)M();else{b&&M();var r=a.button.action||b&&b.action;if(!r)throw Error("selection-toolbar: menu button has no action function defined");r.call(n.toolbar,a.button);n.toolbar.showMenu=!n.toolbar.showMenu}};n.toggleShowMenu=function(t){t.originalEvent.preventDefault();n.toolbar.showMenu=!n.toolbar.showMenu};n.toggleLasso=function(){n.lassoEnabled=!n.lassoEnabled;n.toolbar.toggleLasso(n.lassoEnabled)};function P(t){n.locked=t;n.toolbar.showMenu=false;o.then(function(){w()})}n.toggleLock=function(e){e.originalEvent.preventDefault();e.stopPropagation();if(t(e.target).closest(".sel-toolbar-list-item-close").length>0)return;if(n.toolbar.backendApi.isLocked()){n.toolbar.selectionsApi.selectionsMade=true;n.toolbar.backendApi.unlock()}else n.toolbar.backendApi.lock()};n.$watch("toolbar.backendApi.isLocked()",function(t){void 0!==t&&P(!!t)});n.$watch("toolbar.position",function(t){if(!t)return;n.toolbar.style=t;i.resolve();P(!!n.toolbar.backendApi.isLocked&&n.toolbar.backendApi.isLocked())});n.$watch("toolbar.menuMaxHeight",function(t){if(!t)return;n.toolbar.menuStyle={maxHeight:t}});n.$watch("options.lassoEnabled",function(t){n.lassoEnabled=t})}]};return o}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(94),n(158),n(334),n(239),n(848),n(849),n(341),n(335),n(427),n(320),n(360),n(361),n(245),n(306),n(508),n(428)],a=function(t,e,n,i,a,s,r,o){var l=e.inClient(),c,u;var d=new o;d.scope="root";if(!l){t.setState(t.States.analysis);t.setView(t.Views.sheet)}if(p()){document.body.classList.add("absolute-position-mashup");document.documentElement.classList.add("absolute-position-mashup")}c=new a(l);u=new r;s.init();function p(){var t=Array.prototype.slice.call(document.querySelectorAll("body > .qvobject, body > .qvplaceholder"));if(0===t.length)return false;return!t.some(function(t){return"absolute"!==t.style.position})}function h(t,e){i.setErrorCallback(t,e);n.setErrorCallback(t,e)}function f(t,e){d.register({scope:"root",name:t,callback:e})}function g(t){d.clear(t)}var v={openApp:i.openApp.bind({_qEvent:d}),currApp:i.currApp,getGlobal:n.get.bind({_qEvent:d}),setOnError:h,on:f,off:g,setLanguage:e.setLanguage,setDeviceType:e.setDeviceType,table:i.table,getAppList:n.getAppList,resize:e.resize,getExtensionList:e.getExtensionList,callRepository:e.callRepository,registerExtension:e.registerExtension,navigation:c,sessionApp:i.sessionApp,sessionAppFromApp:i.sessionAppFromApp,getThemeList:r.getThemeList,theme:u};Object.defineProperty(v,"Promise",{get:function t(){return e.Promise}});return v}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,function(t,e,n){"use strict";var i,a;!(i=[n(10),n(48),n(90),n(89),n(141),n(283),n(1094),n(50),n(1095),n(245)],a=function(t,e,n,i,a,s,r,o,l){e.service("qvListboxPopoverServiceMobile",["$document",function(e){var c=e.find("body"),u,d,p;d={show:function e(a,d,h,f){var g=i(),v={$alignToElement:d.$alignToElement,popupPosition:d.position||"bottom",collision:d.collision||"none",qvaOutsideIgnoreFor:d.qvaOutsideIgnoreFor,getVisualization:function t(){return g.promise},model:a,onPopoverClose:this.onPopoverClose,options:{setController:g.resolve,isPopover:true,showLock:d.showLock,search:d.search||{},smallDevice:o.isSmallDevice,direction:d.direction},selectionToolbarComponent:s};if(p){p.selectionsActivated=function(){};p.selectionsDeactivated=function(){};p.close()}u=t.element("<div>");c.append(u);r.template=l;p=u.showComponent(r,v);p.selectionsActivated=function(){n.isFunction(f)&&f()};p.selectionsDeactivated=function(){n.isFunction(h)&&h();h=null;f=null};return p},showField:function t(e,n,s,r,o,l){return a.createTransientField(n,e,r).then(function(t){return i.resolve(this.show(t,s,o,l))}.bind(this))},showDimension:function t(e,n,i,s,r,o){a.createTransientDimension(n,e,s).then(function(t){this.show(t,i,r,o)}.bind(this))},close:function t(){p&&p.close()},onPopoverClose:function t(){}};return d}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(90),n(89),n(141),n(283),n(364),n(50),n(365),n(245)],a=function(t,e,n,i,a,s,r,o){t.service("qvListboxPopoverService",["luiPopover",function(t){var l;var c;var u={showDelayed:function i(u,d,p,h){var f=n();if(l){c.selectionsActivated=function(){};c.selectionsDeactivated=function(){};l.close()}c={getVisualization:function t(){return f.promise},onPopoverClose:this.onPopoverClose,options:{setController:f.resolve,isPopover:true,showLock:d.showLock,search:d.search||{},smallDevice:r.isSmallDevice,direction:d.direction},selectionToolbarComponent:a,onClose:s};l=t.show({template:o,controller:s.controller,alignTo:d.$alignToElement[0],input:c,closeOnResize:false,dock:"top"});u.then(function(t){c.model=t}).catch(function(t){false});c.selectionsActivated=function(){e.isFunction(h)&&h()};c.selectionsDeactivated=function(){e.isFunction(p)&&p();p=null;h=null};return l},show:function t(e,i,a,s){return this.showDelayed(n.when(e),i,a,s)},showField:function t(e,a,s,r,o,l){return i.createTransientField(a,e,r).then(function(t){return n.resolve(this.show(t,s,o,l))}.bind(this)).catch(function(t){false})},showDimension:function t(e,n,a,s,r,o){i.createTransientDimension(n,e,s).then(function(t){this.show(t,a,r,o)}.bind(this)).catch(function(t){false})},close:function t(){l&&l.close();l=null},onPopoverClose:function t(){},getPopover:function t(){return l},onClosing:function t(){}};return u}])}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={SPARK:1,XSMALL:3,SMALL:7,MEDIUM:15,FULL:31},e=[[550,450,t.FULL],[400,220,t.MEDIUM],[300,150,t.SMALL],[150,75,t.XSMALL],[0,0,t.SPARK]],n=[[450,t.FULL],[220,t.MEDIUM],[150,t.SMALL],[75,t.XSMALL],[0,t.SPARK]],i=[[550,t.FULL],[400,t.MEDIUM],[300,t.SMALL],[150,t.XSMALL],[0,t.SPARK]],a=e.length;function s(n,i){var s;for(s=0;s<a;++s)if(n>=e[s][0]&&i>=e[s][1])return e[s][2];return t.SPARK}function r(e){var i;for(i=0;i<a;++i)if(e>=n[i][0])return n[i][1];return t.SPARK}function o(e){var n;for(n=0;n<a;++n)if(e>=i[n][0])return i[n][1];return t.SPARK}function l(e){var n=Object.keys(t).filter(function(n){return t[n]===e})[0];return n&&n.toLowerCase()||""}return{LayoutMode:t,getLayoutMode:s,getLayoutModeKey:l,getHorizontalLayoutMode:o,getVerticalLayoutMode:r}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;function s(t){s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return s(t)}!(i=[n(10),n(48),n(96),n(850),n(851),n(132),n(106),n(97),n(50),n(94),n(202),n(90),n(114),n(113),n(852),n(853),n(363),n(273),n(142),n(95),n(105),n(89),n(167),n(103),n(290),n(274),n(175),n(855),n(257),n(212),n(392),n(240),n(271),n(289),n(276),n(965),n(277)],a=function(t,e,n,i,a,r,o,l,c,u,d,p,h,f,g,v,m,b,y,S,x,q,I,C){var w=b.DEFAULT_STATE_TRANSLATION;var D=b.DEFAULT_STATE_NAME;e.directive("qvSelectionPager",["qvGlobalSelectionsService","$timeout",function(t,n){var i=e.getService("$templateCache");i.put("current-selections-tooltip-template.ng.html",a);return{restrict:"A",priority:1,link:function e(i){var a=i.$watch(function(){return t.isSelectActive(i.app)},function(t){i.$emit("globalSelectionActive",t);n(function(){i.refreshPager(false)})});function s(){i.refreshPager(false)}l.on("end",s);i.$on("$destroy",function(){a();l.off("end",s)})}}}]);var M={template:i,replace:true,restrict:"E",scope:{app:"=",options:"=",expandSmartSearchSuggestedChart:"=?"},link:function t(n,i){var a=e.getService("$timeout"),s=e.getService("qvGlobalSelectionsService"),l=e.getService("qvExploreSelectionsService"),p=e.getService("qvGlobalSearchService"),h=e.getService("qvCaoService"),b=i.parent(),y,q,I;var M=new v(n,c,s,l,p,h);I=new g(n);n.isCaoActive=d.isInInsightMode();n.isExploreSelectionsActive=false;n.nbrSelection=0;n.haveHiddenSelections=false;n.isSmallDevice=c.isSmallDevice;n.cachedPlaceHolders=[];n.isGlobalSearchIndexing=false;n.progressBarOptions={hideText:true};n.setSearchIndexingDone=function(){n.isGlobalSearchIndexing=false};function T(t,e){if(t!==(n.app.enigmaModel.id||"").toUpperCase())return;var i=new Number(e);if(!n.isGlobalSearchIndexing&&i<100){n.indexPercentDone=i;n.isGlobalSearchIndexing=true;P(500)}else if(n.isGlobalSearchIndexing){n.indexPercentDone=i;i<100&&P(500)}else A()}function A(){a.cancel(q);if(y){p.IndexProgressUpdate.unbind(T);y=false}}function P(t){if(!y){p.IndexProgressUpdate.bind(T);y=true}a.cancel(q);q=a(function(){p.requestIndexProgressUpdate(n.app.enigmaModel)},t||0)}function k(){a(function(){n.isSmallDevice=c.isSmallDevice;if(f["SMARTSEARCH_INDEX_CLOSE"])if(n.isSmallDevice){A();n.setSearchIndexingDone()}else!p.isSearchOpen(n.app.enigmaModel)&&p.couldEngineBeIndexing(n.app.enigmaModel)&&P(0);n.isSmallDevice&&n.isCaoActive&&(n.isCaoActive=false)})}function E(){if(!I)return;u.isInAnalysisMode()?I.on():I.off()}function _(){u.inSheetView()&&c.isSmallDevice&&p.openGlobalSearch(n.app.enigmaModel,b);E();var t=d.isInInsightMode();t?t&&!n.isCaoActive&&(n.isCaoActive=true):n.isCaoActive=false}E();c.ViewChanged.bind(k);n.$watch("isSmallDevice",function(t){true!==t||u.inObjectView()?p.closeGlobalSearchIfNoQuery(n.app.enigmaModel):p.openGlobalSearch(n.app.enigmaModel,b)});u.StateChanged.bind(_);n.mobileIndicatorTop=false;n.mobileIndicatorShow=false;s.setCsShowCallback(function(t){n.mobileIndicatorShow=t});s.onClose(function(){document.activeElement!==i.find('[tid="toggleCaoButton"]')[0]&&document.activeElement!==i.find('[tid="currentSelections.toggleExploreSelection"]')[0]&&i.find('[tid="currentSelections.toggleGlobalSelections"]').focus()});n.$on("globalSelectionActive",function(t,e){n.isGlobalSelectionsActive=e});n.$on("exploreSelectionActive",function(t,e){n.isExploreSelectionsActive=e});function F(t){r.get(t).then(function(t){n.model=t;o(n,"app",O)}).catch(function(t){false});n.$watch(t.isInModalSelection.bind(t),function(t){n.inSelection=t;if(n.inSelection&&n.activeFieldName&&n.activeFieldName.length>0)n.cachedPlaceHolders=n.items.map(function(t){return m.createPlaceHolder({},t.qField,t.qReadableName||t.qField)});else{n.cachedPlaceHolders=[];n.items=n.items.filter(function(t){return!t.isPlaceHolder})}});n.app=t;o(n,"app",O)}var $=[];var N;function O(t){var e=false;var i;if($.length!==t.qStateNames.length||!$.every(function(e,n){return e===t.qStateNames[n]})){i=[w].concat(t.qStateNames);e=true;$=t.qStateNames.concat()}if(n.model&&(!N||e)){i=[D].concat(t.qStateNames);n.model.getProperties().then(function(t){t.selectionsInStates=i.map(function(t){return{stateName:t,qSelectionObjectDef:{qStateName:t}}});n.model.setProperties(t)})}N=n.model}var L=n.$watch("app",function(t){F(t.enigmaModel);L()});n.$watch(function(){return p.isSearchOpen(n.app.enigmaModel)},function(t){n.isGlobalSearchActive=t;if(f["SMARTSEARCH_INDEX_CLOSE"])if(n.isSmallDevice||t){A();n.isGlobalSearchIndexing=false}else if(p.couldEngineBeIndexing(n.app.enigmaModel)){var e=p.getLastKnownIndexProgress(n.app.enigmaModel);n.isGlobalSearchIndexing=true;n.indexPercentDone=e;P(500)}});n.toggleGlobalSelection=function(t){t.preventDefault();M.toggleGlobalSelection(n.app);n.currentSelectionDisabled=false;n.expandSmartSearchSuggestedChart=false;S.publish(x.Events.PubSub.ExpandSmartSearchSuggestedChart,null);C.trackEvent(C.customEvents.GLOBAL_SELECTIONS_CLICKED,{type:"clicked"})};n.toggleGlobalSearch=function(){M.toggleGlobalSearch(b)};n.toggleExploreSelection=function(){M.toggleExploreSelection(b);n.expandSmartSearchSuggestedChart=false;S.publish(x.Events.PubSub.ExpandSmartSearchSuggestedChart,null);n.currentSelectionDisabled=false};n.toggleCao=function(){n.currentSelectionDisabled=false;M.toggleCao(b)};n.$watch("isCaoActive",function(t){false===t&&h.off()});n.$on("$destroy",function(){c.ViewChanged.unbind(k);p.off();h.off();n.isCaoActive=false;s.off();l.off();n.isExploreSelectionsActive=false;u.StateChanged.unbind(_);s.setCsShowCallback(null);a.cancel(q);p.IndexProgressUpdate.unbind(T);I&&I.delete()})},controller:["$scope","$element","$timeout","qvChartTooltipService","qvGlobalSelectionsService","qvCurrentSelectionsService",function(i,a,r,l,d,f){var g,v=false,b,x,C=e.getService("qvListboxPopoverService"),w=e.getService("qvListboxPopoverServiceMobile"),D=e.getService("qvMultiStatePopoverService");i.items=[];i.disable={clear:true,back:true,forward:true};i.brightCurSel=i.options&&"bright"===i.options.variant;i.hideUndoRedo=i.options&&true===i.options.hideUndoRedo;i.hideSelectionsTool=i.options&&true===i.options.hideSelectionsTool;i.hideSearch=i.options&&true===i.options.hideSearch;i.hideClearSelections=i.options&&true===i.options.hideClearSelections;i.currentSelectionDisabled=false;function M(){d.setCsShow(c.isSmallDevice&&i.items.length>0&&u.view!==u.Views.object)}function T(e){i.currentSelectionDisabled=false;i.disable.clear=0===y.getClearableStates(e.selectionsInStates).length;i.disable.back=0===e.qSelectionObject.qBackCount;i.disable.forward=0===e.qSelectionObject.qForwardCount;var n=m.getAllSelectionsInStates(e);i.haveHiddenSelections=n.some(function(t){return t.qIsHidden});var a=n.filter(function(t){return!t.qIsHidden});a.forEach(function(t){t.translation=f.translate(t);t.screenReaderLabel=f.translatedScreenReaderLabel(t);t.name=t.qReadableName||t.qField;t.displayStateName=m.getDisplayStateName(t.stateName);t.currentSelectionDisabled=i.currentSelectionDisabled});i.nbrSelections=a.length;d.setSelectionCount(a.length,i.app);M();var s=m.groupSelectionsByField(a);var o=s.filter(function(t){return!t.isSingleState});o.forEach(function(t){t.translation=f.translate(t);t.screenReaderLabel=f.translatedScreenReaderLabel(t)});s=s.sort(y.sortSelections);if(i.cachedPlaceHolders.length>0&&i.activeFieldName&&i.activeFieldName.length>0){i.cachedPlaceHolders.forEach(function(t){m.createPlaceHolder(t)});a.forEach(function(t){i.cachedPlaceHolders.forEach(function(e,n){t.qField===e.qField&&(i.cachedPlaceHolders[n]=p.extend(true,{},t))})});a=i.cachedPlaceHolders}if(i.multiPopover){var l=m.getIndexByKey(s,"name",i.multiPopover.fieldName);var c=m.getIndexByKey(i.items,"name",i.multiPopover.fieldName);var u=l>-1;if(u){var h=s.splice(l,1)[0];s.splice(c,0,h);var g=m.getAllStatesFromSelections(s,i.multiPopover.fieldName);if(g.length<=1&&i.activeFieldName.length){t.element('.item[data-csid="'+i.activeFieldName+'"]').focus();i.multiPopover.close()}}else i.multiPopover.close()}i.items=s;M();r(function(){i.$broadcast("refreshPager")})}o(i,"model",function(){x&&x.dispose();x=i.model.layoutSubscribe(T)});i.$watch(u.inObjectView,M);i.$watch("isSmallDevice",M);i.clear=function(t,e,n){var a=e?[e]:m.getAllStatesFromSelections(i.items);i.$parent.itemSelected&&(i.$parent.itemSelected=false);n&&n.stopPropagation();var s=a.map(function(e){return i.model.clearField(t,e)});return q.all(s)};i.clearAllFields=function(){return i.model.clearAll()};i.back=function(){return i.model.back()};i.forward=function(){return i.model.forward()};function A(e){var n=t.element(e).next("li");if(t.element(e).parent().find("li").length<=1)return null;return t.element(e).parent().find("li").length>1&&n.length>0?n:null}function P(e){var n=t.element(e).prev("li");if(t.element(e).parent().find("li").length<=1)return null;return n.length>0?n:null}function k(e,n){var a;var s=e.which;s=e.shiftKey&&I.TAB===s?"SHIFT_TAB":s;var o=document.activeElement&&"qv-multi-state-popover-btn-clear"===t.element(document.activeElement).attr("tid");var l=".item-multi-state[data-csid="+i.multiPopover.fieldName+"]";switch(s){case I.ESCAPE:i.multiPopover.close();a=t.element(l);break;case I.DELETE:a=A(e.target)||P(e.target);i.clear(n.qField,n.stateName);break;case I.SPACE:case I.ENTER:r(function(){e.target.click()});break;case I.ARROW_RIGHT:case I.ARROW_DOWN:case I.TAB:if(o)a=t.element('[tid="qv-multi-state-popover"] li.item:first');else{a=A(e.target);if(null===a&&s===I.TAB){i.multiPopover.close();a=t.element(l)}}break;case I.ARROW_LEFT:case I.ARROW_UP:case"SHIFT_TAB":if(o){a=t.element(l);i.multiPopover.close()}else a=P(e.target);break}if(a){a.focus();e.preventDefault()}}i.showPopover=function(e){var n=t.element(e.target).closest(".item"),a=n.scope().item.qField,s=n.scope().item.isPlaceHolder,o={qvaOutsideIgnoreFor:"currentSelectionsItems",$alignToElement:n,showLock:true,direction:h.direction};if(i.isClearSelectionIcon(e.target)){if(i.activeFieldName){c.isSmallDevice?C.close():w.close();i.activeFieldName=""}return}if(!n.hasClass("item-multi-state")&&(a===i.activeFieldName||s)){c.isSmallDevice?C.close():w.close();i.activeFieldName="";return}r(function(){i.closeTooltip()},100);i.activeFieldName=a;var l={listboxPopoverService:C,listboxPopoverServiceMobile:w,$timeout:r};var u=m.getAllStatesFromSelections(i.items,a);if(u.length>1){if(i.multiPopover)return;var d=function t(){return m.getMultiPopoverItems(i.items,a)};i.multiPopover=m.openMultiStatePopover(D,d,n[0],i.brightCurSel,{onClose:function t(){i.multiPopover=null;i.activeFieldName=""},clear:i.clear,click:function e(n){var a=t.element(n.target).closest(".item");var s=a.scope().item.qField;var r=a.scope().item.displayStateName;i.multiPopover.close();i.closeTooltip();i.onCloseFocusSelector='.item[data-csid="'+s+'"]';m.openListboxPopover(m.activatePopover,i,c.isSmallDevice,r,s,o,l)},openTooltip:i.openTooltip,closeTooltip:i.closeTooltip,direction:h.direction,handleKeyDown:k});i.multiPopover.fieldName=a}else m.openListboxPopover(m.activatePopover,i,c.isSmallDevice,u[0],a,o,l)};i.openTooltip=function(t,e){if(i.isClearSelectionIcon(t.target)){i.closeTooltip();return}if(v||n.utils.touch)return;var a=i.multiPopover&&i.multiPopover.fieldName===e.qField;if(e.states&&a)return;i.cancelTooltip();g=r(function(){var n=e.qStateCounts,i="object"===s(n),r=i?" ("+(n.qSelected+n.qSelectedExcluded+n.qLocked+n.qLockedExcluded)+"/"+e.qTotal+")":"";var o=e.states||!a&&"$"===e.stateName?e.translation:[m.getDisplayStateName(e.stateName),": ",e.translation].join("");v=true;l.open({content:[{header:(e.qReadableName||e.qField)+r,rows:[{content:o}]}],position:{x:t.clientX,y:t.clientY},alwaysOnTop:true,direction:"bottom",template:"current-selections-tooltip-template.ng.html"})},500)};i.closeTooltip=function(){v=false;i.cancelTooltip();l.close()};i.cancelTooltip=function(){r.cancel(g)};i.isClearSelectionIcon=function(e){return t.element(e).closest(".remove").is(".remove")};i.handleKeyDown=function(e,n){var s;var r=e.which;r=e.shiftKey&&I.TAB===r?"SHIFT_TAB":r;switch(e.which){case I.DELETE:s=i.items&&i.items.length>1?A(e.target):a.find('[data-tid="current-selections-back"]');i.clear(n.qField);break;case I.ESCAPE:if(i.multiPopover){i.multiPopover.close();s=t.element('.item[data-csid="'+i.multiPopover.fieldName+'"]')}break}if(n.isSingleState)switch(e.which){case I.SPACE:case I.ENTER:case I.ARROW_DOWN:i.showPopover(e);break}else switch(r){case I.SPACE:case I.ENTER:i.multiPopover?i.multiPopover.close():i.showPopover(e);s=t.element('.item[data-csid="'+i.multiPopover.fieldName+'"]');break;case I.ARROW_DOWN:i.multiPopover||i.showPopover(e);s=t.element('.item[data-csid="'+i.multiPopover.fieldName+'"]');break;case I.TAB:if(i.multiPopover){s=t.element('[tid="qv-multi-state-popover-btn-clear"]');e.preventDefault()}break;case"SHIFT_TAB":i.multiPopover&&i.multiPopover.close();break}s&&s.focus()};function E(t,n){i.items.forEach(function(t){if(-1!==n[0].indexOf(t.qField)){n[1]?t.feedbackActive=false:t.feedbackActive=true;e.$apply(i)}})}b=e.$rootScope.$on("locked-feedback",E);var _=function t(){var n=e.getService("qvExploreSelectionsService");n.off();i.isExploreSelectionsActive=false;i.currentSelectionDisabled=false};S.subscribe("selection/insights/close",_);S.subscribe("cao/insights/close",function(){i.isCaoActive=false});S.subscribe("selections/insights/details/close",function(){i.currentSelectionDisabled=false});S.subscribe("selections/insights/details/open",function(){i.currentSelectionDisabled=true});i.$on("$destroy",function(){b();x&&x.dispose();S.unsubscribe("cao/insights/close");S.unsubscribe("selection/insights/close",_);S.unsubscribe("selections/insights/details/close");S.unsubscribe("selections/insights/details/open")})}]};e.directive("qvStageCurrentSelections",function(){return M});return M}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(89),n(139),n(125),n(99),n(130),n(845),n(148),n(161),n(91),n(218)],a=function(t,e,n,i,a,s,r,o,l){var c=100;function u(t,n){if(""===n)return t;return t.filter(function(t){if("undefined"===typeof t.value)return false;return e.string(t.value.toLowerCase()).indexOf(e.string(n.toLowerCase()))>-1})}var d={template:s,controller:["$scope",function(e){e.search={term:""};e.isDirectDiscoveryField=r.isDirectDiscoveryField;e.getDirectDiscoveryTypeTranslationKey=r.getTypeTranslationKey;e.autoFocus=i.treatAsDesktop();e.position||(e.position="right");e.onEscape=function(t){if(""!==e.search.term){t.stopPropagation();e.search.term=""}else e.close()};e.onEnter=function(t){if(""!==e.search.term){t.stopPropagation();e.addFieldDimension({value:e.search.term})}else e.close()};e.getFieldDisplayName=function(t){return""===e.search.term?t.label:o.trimAutoCalendarName(t.value)};var s=null;e.$watch("search.term",function(i){function r(){var t=u(s.fields,i);var a=u(s.dimensions,i);var r=u(s.activeDimensions,i);if(a.length+r.length>c){a=n.limit(a,Math.max(c-r.length,0));t=[]}else t.length+a.length+r.length>c&&(t=n.limit(t,Math.max(c-a.length-r.length,0)));e.fields=t;e.dimensions=a;e.activeDimensions=r}s?r():t.all({fields:a.getSortedFields(e.app),dimensions:a.getSortedDimensions(e.app)}).then(function(t){var n=t.fields.map(function(t){var e=t.isDerived&&""===i?t.qName.substring(t.qName.lastIndexOf(".")+1,t.qName.length):t.qName;return{toolTip:t.qName,label:e,value:t.qName,trimmedValue:t.displayName,qTags:t.qTags,isDerived:t.isDerived,isDateField:t.isDateField,isGeoField:t.isGeoField,activeDimensionIndex:-1}});var a=t.dimensions.map(function(t){return{label:t.qData.title,value:t.qData.title,libraryId:t.qInfo.qId,isDrillDown:"H"===t.qData.grouping,activeDimensionIndex:-1}});var o=[];e.activeDimensions&&e.activeDimensions.length&&e.activeDimensions.forEach(function(t,e){var i={};if(t.qLibraryId){a.forEach(function(e){if(e.libraryId===t.qLibraryId){i.label=e.label;i.value=e.value}});i.libraryId=t.libraryId}else n.forEach(function(e){if(e.value===t.qDef.qFieldDefs[0]){i.label=e.label;i.value=e.value}});i.translatedTitle=l.get("properties.colorBy.currentDimension",e+1);i.activeDimensionIndex=e;o.push(i)});s={fields:n,dimensions:a,activeDimensions:o};r()})})}],scope:{alignTo:"=",app:"=",addFieldDimension:"=",addLibraryDimension:"=",qvaOutsideIgnoreFor:"=",close:"=",position:"=",allowExpressionEditor:"@",selectColorByDimIndex:"="}};return d}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(429),n(224),n(430),n(478),n(479),n(480),n(481),n(482)],a=function(t,e,n,i,a,s,r,o,l,c){function u(t,e){t=t.toLowerCase()||"image";e=e.toLowerCase();var u=e+"-"+t;function d(){var t;switch(u){case"sheet-pdf":case"object-pdf":t=o;break;case"sheet-image":case"object-image":t=r;break;case"story-ppt":t=l;break;case"story-pdf":t=c;break;default:t=r}return t}var p={template:d(),controller:["$scope","$timeout",function(e,r){e.exportType=t;e.states=i.getStates();e.state=e.states.IDLE;var o={CurrentSize:"0",BestFitPreserveAspectRatio:"1",BestFitNoPreserveAspectRatio:"2"};e.print={fitCriteria:o.CurrentSize};if(e.input.object){var l=e.input.object.model.id;var c={id:l,model:e.input.object.model,options:{id:l,isVisible:true,isOnGrid:false,isZoomed:false}};e.obj=c}switch(u){case"sheet-pdf":case"object-pdf":case"story-pdf":e.sizes=a.sizes;e.layouts=a.layouts;e.selectedSize=e.sizes[1];e.print.dpi=200;e.selectedLayout=e.layouts[1];e.minDpi=72;e.maxDpi=300;r(function(){e.onPrintLayout(e.selectedLayout)});break;case"sheet-image":case"object-image":e.availableFormats=["Jpeg","Png"];e.print.width=e.input.currentWidth;e.print.height=e.input.currentHeight;e.print.dpi=e.input.currentDpi;e.print.format="Png";e.imageCustomSize=false;break;case"story-ppt":e.availablePptDpi=[96,150,220];e.print.dpi=e.availablePptDpi[2];e.print.currentWidth=e.input.currentWidth;e.print.currentHeight=e.input.currentHeight;e.print.currentDpi=e.input.currentDpi;e.formats=s.formats;e.selectedFormat=e.formats[3];r(function(){e.onPptFormatChange(e.selectedFormat)});break}var d=n.create(e);e.confirm=d.confirm;e.onImageCustomSize=d.onImageCustomSize;e.onSizeChange=d.onSizeChange;e.onPrintLayout=d.onPrintLayout;e.onPptFormatChange=d.onPptFormatChange}]};return p}function d(){var t=document.createElement("div");t.style.width="1in";var e=document.getElementsByTagName("body")[0];e.appendChild(t);var n=document.defaultView.getComputedStyle(t,null).getPropertyValue("width");e.removeChild(t);var i=n&&Math.round(parseFloat(n));i=i||96;return i>300?300:i}function p(t,n,a,s,r,o){var l="Print."+n+".Title";var c=d();var p=u(n,a);var h=e.getService("luiDialog").show({controller:p.controller,template:p.template,input:{title:l,object:t,sourceType:"object",exportType:n,currentWidth:s,currentHeight:r,currentDpi:c}});h.closed.then(function(){i.cancel();o&&o()});return h}function h(n,a,s){var r="Print."+a+".Title";var o;o="story"===s.toLowerCase()?n&&n.inStoryPlayState()?t("#qv-storytelling .qv-story-slide-active"):t("#qv-storytelling .qv-grid-story"):n.model&&n.model.isCustomSize()?t("#grid"):t(".qvt-sheet > .sheet-grid");var l=Math.round(o.width()||960);var c=Math.round(o.height()||720);var p=d();var h=u(a,s);var f=e.getService("luiDialog").show({controller:h.controller,template:h.template,input:{title:r,object:n,exportType:a,currentWidth:l,currentHeight:c,currentDpi:p}});f.closed.then(function(){i.cancel()})}return{showForObject:p,showForGlobalMenu:h,getScreenDpi:d}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(54),n(89),n(91),n(133),n(975),n(280)],a=function(t,e,i,a,s){t.service("odagNavpointService",["$timeout","$delayedModal","odagNavpointServiceUI",function(t,r,o){var l;var c={};var u={SUCCEEDED:"succeeded",FAILED:"failed",VALIDATING:"validating",QUEUED:"queued",LOADING:"loading",CANCELING:"canceling",CANCELED:"canceled"};var d=[u.SUCCEEDED,u.FAILED,u.CANCELED];function p(t,e){o.updateImageOnItemHeader(e);return t.getLoadedLinkInfo(t).then(function(t){if(t.templateApp){e.templateName=t.templateApp.name;e.templateDescription=t.templateApp.description;if(t.templateApp.thumbnail){"/"===t.templateApp.thumbnail.substr(0,1)&&(t.templateApp.thumbnail=t.templateApp.thumbnail.substr(1));e.templateThumbnail=n.p+t.templateApp.thumbnail}o.updateImageOnItemHeader(e)}else{e.invalid=true;e.templateName=a.get("odag.toolbar.navpoint.popup.noTemplate");e.templateDescription=""}})}function h(t){switch(t.state){case u.SUCCEEDED:var e=a.get("odag.toolbar.navpoint.popup.delete.confirmation",[t.name]);var n=new i;r.open({title:a.get("odag.toolbar.navpoint.popup.delete.confirmation.title"),content:e,buttons:[{name:"Common.Cancel",tid:"odag-applist-modal-cancelBtn",callback:function t(){n.resolve()}},{name:"Common.Delete",tid:"odag-applist-modal-deleteBtn",defaultButton:true,callback:function e(){return s.deleteGenApp(t.parentContext.app,t.requestId).then(function(){n.resolve()})}}]});return n.promise;case u.FAILED:return s.requestAction(t.parentContext.app,t.requestId,s.ODAGRequestActionConst.FAIL_ACK,true,true);case u.VALIDATING:case u.QUEUED:case u.LOADING:case u.CANCELING:var o=true;var l=true;if(t.lastLoadedTime){o=false;l=false}return s.requestAction(t.parentContext.app,t.requestId,s.ODAGRequestActionConst.CANCEL,o,l);case u.CANCELED:return s.requestAction(t.parentContext.app,t.requestId,s.ODAGRequestActionConst.CANCEL_ACK,true,true)}}function f(t,e,n){return t.getLoadedLinkInfo(t).then(function(i){return s.reloadApp(t.model.parent.app,i,e,n,t.actualRowEst)})}function g(t,e){return s.getSelections(t,e)}function v(t,e){return o.getSelectedValuesDisplayString(t,e)}function m(t){return t.getLoadedLinkInfo(t).then(function(e){return s.generateApp(t.model.parent.app,t.model.parent.id,e,t.id,t.actualRowEst)})}function b(t){delete c[t.id]}function y(n,a,r,l){if(!r){l=Date.now();c[n.id]=l}return c[n.id]&&l>=c[n.id]?s.getGeneratedAppsForLink(n.model.parent.app,n.model.parent.id,n.data.odagLinkRefID,n.id).then(function(i){i.forEach(function(t){var i=o.createGeneratedAppWrapper(t,n.model.parent);var s=a.map(function(t){return t.requestId}).indexOf(t.id);if(s>-1){var r=a[s];var l=e.chain(i).keys().every(function(t){return e.has(r,t)&&e.isEqual(i[t],r[t])}).value();l||a.splice(s,1,i)}else a.push(i)});for(var s=a.length-1;s>-1;s--){var r=a[s];i.some(function(t){return t.id===r.requestId})||a.splice(s,1)}a.sort(function(t,e){var n=new Date(t.createdDate);var i=new Date(e.createdDate);return i-n});if(a.some(function(t){return t.loading}))return t(function(){y(n,a,true,l)},3e3);delete c[n.id]}):i.resolve()}function S(t){var e=a.get("Common.None");t.range&&(t.range.lowerBound&&t.range.lowerBound===t.range.upperBound?e=t.range.lowerBound:void 0===t.range.lowerBound||t.range.upperBound?void 0===t.range.upperBound||t.range.lowerBound?void 0!==t.range.lowerBound&&void 0!==t.range.upperBound&&(e="["+t.range.lowerBound+" - "+t.range.upperBound+"]"):e="<="+t.range.upperBound:e=">="+t.range.lowerBound);return e}function x(t,e){var n=true;t.range&&(t.range.lowerBound&&t.range.lowerBound===t.range.upperBound?n=t.range.lowerBound===e.length:void 0===t.range.lowerBound||t.range.upperBound?void 0===t.range.upperBound||t.range.lowerBound?void 0!==t.range.lowerBound&&void 0!==t.range.upperBound&&(n=e.length>=t.range.lowerBound&&e.length<=t.range.upperBound):n=e.length<=t.range.upperBound:n=e.length>=t.range.lowerBound);return n}function q(t,e){e.length=0;t.getLoadedLinkInfo(t).then(function(n){s.getConstraintFieldBindingValues(t.model.parent.app,n.bindings).then(function(t){for(var i=0;i<n.bindings.length;i++){var a=t[i];var s={fieldName:n.bindings[i].selectAppParamName,values:a.fieldValues,hasConstraint:!a.noConstraint,constraint:S(n.bindings[i]),bindingPassesConstraint:x(n.bindings[i],a.fieldValues)};e.push(s)}})})}function I(t,e,n){return s.renameGenApp(t,e,n)}function C(t){var e=t.parentContext.app;return s.clearSelections(e).then(function(){var n=[];for(var a=0;a<t.selectionsState.length;a++){var r=t.selectionsState[a];var o=r.selectionAppParamName;var l=r.values;n.push(s.selectFieldValuesForField(e,o,l))}return i.all(n)})}l={ODAG_STATE:u,ODAG_TERMINAL_STATES:d,updateItemHeader:p,loadGeneratedApps:y,stopLoadGeneratedApps:b,deleteGeneratedApp:h,reloadApp:f,getSelections:g,getSelectedValuesDisplayString:v,generateApp:m,renameGenApp:I,applySelections:C,initializeBindings:q};return l}])}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(95),n(93),n(122),n(94),n(120),n(215),n(301),n(143)],a=function(t,e,n,i,a,s,r,o,l,c){var u=false;var d=false;var p={userId:void 0,userDirectory:void 0};function h(t){var n=e.getService("qvAppViewService");n.blockScrollIntoView=true;n.activeId=t.qInfo.qId;n.lastActiveId=t.qInfo.qId;n=null}function f(t){u=t}var g={update:function t(){return o.getList().then(function(t){return t.getLayout().then(function(t){g.all.approvedStories=t.filter(l.filterApproved).sort(l.sortByRank);g.all.publishedStories=t.filter(l.filterMyPublishedCommunity(p)).sort(l.sortPublishedTime);g.all.privateStories=t.filter(l.filterPrivate).sort(l.sortByRank);g.all.communityStories=t.filter(l.filterCommunity(p)).sort(l.sortCommunity(1));g.all.mashed=[];if(g.current)for(var e=0;e<Object.keys(g.all).length;e++){var i=g.all[Object.keys(g.all)[e]];for(var a=0;a<i.length;a++)g.all.mashed.push(i[a])}n.publish("/data/story-list-layout-changed")})})},all:{mashed:[],approvedStories:[],publishedStories:[],privateStories:[],communityStories:[]},privateStories:[],current:{},currentIndex:function t(){for(var e=0;e<g.all.mashed.length;e++)if(g.current.id===g.all.mashed[e].qInfo.qId)return e;return 0},hasPrevious:function t(){return g.currentIndex()>0},hasNext:function t(){return g.currentIndex()<g.all.mashed.length-1},getPrevious:function t(){if(g.hasPrevious())return g.all.mashed[g.currentIndex()-1];return null},getNext:function t(){if(g.hasNext())return g.all.mashed[g.currentIndex()+1];return null},getFirst:function t(){return g.all.mashed[g.currentIndex()]},getLast:function t(){return g.all.mashed[g.all.mashed.length-1]},navigate:function e(){if(u)return;var n=g.all.mashed.length-g.all.communityStories.length-1;var i=g.current===g.getFirst()?g.getNext():g.currentIndex()<n?g.getNext():g.currentIndex()===n?g.getPrevious():null;var r=s.view===s.Views.story;if(i){if(r){h(i);o.get(i.qInfo.qId).then(function(t){a.goToStory(t.id,Object.keys(s.States)[s.state])})}}else{var l=t(".qv-pop-appview").scope();l&&l.closeView();l=null;r&&a.goToOverview()}},communitySort:function t(e,n){var i=g.all.communitySheets.sort(l.sortCommunity(e));n&&i.reverse();g.all.communitySheets=i}};var v={update:function t(){return r.getList().then(function(t){return t.getLayout().then(function(t){v.all.approvedSheets=t.filter(l.filterApproved).sort(l.sortByRank);v.all.publishedSheets=t.filter(l.filterMyPublishedCommunity(p)).sort(l.sortPublishedTime);v.all.privateSheets=t.filter(l.filterPrivate).sort(l.sortByRank);v.all.communitySheets=t.filter(l.filterCommunity(p)).sort(l.sortCommunity(1));v.all.mashed=[];if(v.current)for(var e=0;e<Object.keys(v.all).length;e++){var i=v.all[Object.keys(v.all)[e]];for(var a=0;a<i.length;a++)v.all.mashed.push(i[a])}n.publish("/data/sheet-list-layout-changed",v.all.mashed)})})},all:{mashed:[],approvedSheets:[],publishedSheets:[],privateSheets:[],communitySheets:[]},privateSheets:[],current:{},getNumberOfSheets:function t(){return v.all.mashed.length},currentIndex:function t(){for(var e=0;e<v.all.mashed.length;e++)if(v.current.id===v.all.mashed[e].qInfo.qId)return e;return 0},hasPrevious:function t(){return v.currentIndex()>0},hasNext:function t(){return v.currentIndex()<v.all.mashed.length-1},getPrevious:function t(){if(v.hasPrevious())return v.all.mashed[v.currentIndex()-1];return null},getNext:function t(){if(v.hasNext())return v.all.mashed[v.currentIndex()+1];return null},getFirst:function t(){return v.all.mashed[0]},getLast:function t(){return v.all.mashed[v.all.mashed.length-1]},getById:function t(e){for(var n=0;n<v.all.mashed.length;n++)if(v.all.mashed[n].qInfo.qId===e)return v.all.mashed[n];return null},navigate:function e(){if(u)return;var n=v.all.mashed.length-v.all.communitySheets.length-1;var i=v.current===v.getFirst()?v.getNext():v.currentIndex()<n?v.getNext():v.currentIndex()===n?v.getPrevious():null;var o=s.view===s.Views.sheet||s.view===s.Views.object||s.view===s.Views.masterObject;if(i){if(o){h(i);r.get(i.qInfo.qId).then(function(t){a.goToSheet(t.id,Object.keys(s.States)[s.state])})}}else{var l=t(".qv-pop-appview").scope();l&&l.closeView();l=null;o&&a.goToOverview()}},navigateToSheet:function t(e){if(e){h(e);r.get(e.qInfo.qId).then(function(t){a.goToSheet(t.id,Object.keys(s.States)[s.state])})}},communitySort:function t(e,n){var i=v.all.communitySheets.sort(l.sortCommunity(e));n&&(i=i.reverse());v.all.communitySheets=i}};function m(){if(d)return Promise.resolve();s.SheetChanged.bind(function(t){v.current=t});s.StoryChanged.bind(function(t){g.current=t});c.onDataReceived.then(function(t){if("NONE"!==t.userDirectory){p.userId=t.userId;p.userDirectory=t.userDirectory}});return i.getApp().then(function(){return Promise.all([v.update(),g.update()]).then(function(){return Promise.all([r.getList(),o.getList()]).then(function(t){var e=t[0];e.Invalidated.bind(v.update);var n=t[1];n.Invalidated.bind(g.update);d=true;return d})})})}var b={isInitialized:function t(){return d},init:m,Sheets:v,Stories:g,suspendNavigation:f};e.service("$navigationService",function(){return b});return b}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(91),n(273),n(90),n(11)],a=function(t,e,n,i){return{activatePopover:a,createPlaceHolder:r,getMultiPopoverItems:o,openMultiStatePopover:l,getAllStatesFromSelections:c,getAllSelectionsInStates:u,groupSelectionsByField:d,openListboxPopover:p,getIndexByKey:h,getDisplayStateName:s};function a(t,e,n,i,a,s){return t.showField(e,i.model.app.enigmaModel,n,{qStateName:s},function(){i.activeFieldName="";a(function(){i.closeTooltip()},100)})}function s(n){return n===e.DEFAULT_STATE_NAME?t.get(e.DEFAULT_STATE_TRANSLATION):n}function r(t,e,n){t.isPlaceHolder=true;t.active=false;t.qLocked=false;t.feedbackActive=false;t.translation="";t.qTotal=0;t.qStateCounts=0;e&&(t.qField=e);n&&(t.name=n);return t}function o(t,e){t=t||[];var n=t.filter(function(t){return t.qField===e})[0];var i=[];n&&n.states&&(i=n.states.map(function(t){t.isSingleState=true;t.displayStateName=s(t.stateName);return t}));return i}function l(t,e,n,i,a){var s=t.show({alignToElement:n,clear:a.clear,click:a.click,onClose:a.onClose,openTooltip:a.openTooltip,closeTooltip:a.closeTooltip,handleKeyDown:a.handleKeyDown,getItems:e,brightCurSel:i});return s}function c(t,e){e=e||null;var i=[];e&&(t=t.filter(function(t){return t.qField===e}));t.forEach(function(t){t.states?t.states.forEach(function(t){i.push(t.stateName)}):i.push(t.stateName)});i=n.getUnique(i);return i}function u(t){var e=[];(t.selectionsInStates||[]).forEach(function(t){t.qSelectionObject.qSelections.forEach(function(e){e.stateName=t.stateName});e=e.concat(t.qSelectionObject.qSelections)});return e}function d(t){var e={};t.forEach(function(t){var n=e[t.qField];n=n||{states:[],qField:t.qField};n.states.push(t);e[t.qField]=n});var n=Object.keys(e).map(function(t){var n=e[t];var i=n.states;if(1===i.length){n=n.states[0];n.isSingleState=true;n.isDefaultState="$"===i[0].stateName}else n.name=i[0].name;return n});return n}function p(t,e,n,a,s,r,o){if(n)return t(o.listboxPopoverServiceMobile,s,r,e,o.$timeout,a).catch(function(t){false});return t(o.listboxPopoverService,s,r,e,o.$timeout,a).then(function(t){var n;t.closing.then(function(t){t&&!i(t.target).closest(".current-selections-item").length>0&&(e.activeFieldName="");n=t}).catch(function(t){false});t.closed.then(function(){if(e.onCloseFocusSelector){i(e.onCloseFocusSelector).focus();e.onCloseFocusSelector=null}else e.activeFieldName&&i('.item[data-csid="'+e.activeFieldName+'"]').focus();t=null;n||(e.activeFieldName="")}).catch(function(t){false});t.opened.catch(function(t){false})}).catch(function(t){false})}function h(t,e,n){if([void 0,null].contains(e)||[void 0,null].contains(n))throw new Error("unaccepted key or val ( key: "+e+", val: "+n+")");var i=t.map(function(t){return t[e]});return i.indexOf(n)}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(89),n(97)],a=function(t,e){var n={template:null,controller:["$scope","$element","$timeout",function(n,i,a){var s=this;n.input.selectionsActivated=function(){};n.input.selectionsDeactivated=function(){};s.close=function(){r()};function r(){a(function(){n.destroyComponent();i.remove()});e.off("start.listbox-popover-error",r)}function o(){return a(function(){return i.find(".toolbar-wrapper").outerWidth()})}var l=n.input.onPopoverClose;var c=null;n.closingDeferred.promise.then(function(t){c&&c();l(t);r()});t.all({object:n.input.getVisualization(),width:o()}).then(function(t){var i=t.object,a=t.width;i.getSelectionToolbar().then(function(t){n.toolbar=t;n.toolbar.showLock=n.input.options.showLock;n.toolbar.position={width:a};i.activateSelections()});i.loaded.then(function(){i.ext.hasError(i)&&e.on("start.listbox-popover-error",r)});i.selectionsApi.watchActivated(function(){n.input.selectionsActivated()});i.selectionsApi.watchDeactivated(function(){n.input.selectionsDeactivated();r()});c=function t(){i.selectionsApi.confirm()}})}]};return n}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<lui-popover\n\t\tclass="qv-listbox-popover"\n\t\tstyle="min-width: 200px;width: 234px;height: 332px"\n\t\ton-close-view="closeView(event)"\n\t\tqva-outside-ignore-for="{{input.qvaOutsideIgnoreFor}}"\n\t\tqva-mouse-wheel-outside="close()">\n\t<lui-popover-body style="height: 332px" class="lui-nopad">\n\t\t<qv-spinner show="!input.model" spinner-height="100px" spinner-width="100px" show-Delay="300" center-in-parent="true"></qv-spinner>\n\t\t<div class="toolbar-wrapper"\n\t\t\t qva-include-selection-toolbar\n\t\t\t component="input.selectionToolbarComponent"\n\t\t\t toolbar="toolbar"\n\t\t\t options="input.options"></div>\n\t\t<div class="listbox-wrapper">\n\t\t\t<qv-object object="object" model="input.model" options="input.options"></qv-object>\n\t\t</div>\n\t</lui-popover-body>\n</lui-popover>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95)],a=function(t,e){t.service("qvCaoSelectionService",[function(){var t={sendSelectedChartChangeEvent:function t(){e.publish("cao/insight/selectedChartChanged",this.selectedChart)},getSelectedChart:function t(){return this.selectedChart},selectChart:function t(e){this.selectedChart=e;this.sendSelectedChartChangeEvent()},clearSelection:function t(){if(this.selectedChart){this.selectedChart=void 0;this.sendSelectedChartChangeEvent()}}};return t}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(89),n(875)],a=function(t,e,n){function i(t,e,n){this.visualization=t;this.searchReport=e;this.options=t.options;this.type="generated";this.analysisPrecedentId=t.matchRecord.analysisPrecedentId;this.appearsOnSheets=[];this.properties=n}i.prototype.getTitle=function(){var t=this.visualization.analysis.titleTemplate;var i=this.visualization.matchRecord.matches;return e.resolve(n.findTitleForChart(t,i))};i.prototype.getMatchDetails=function(){var t=[];if(this.searchReport.search){var e=this.searchReport.search.fieldLibItemFinder.searchHits;this.visualization.matchRecord.matches.forEach(function(n){var i=n.field;n.libId&&(i=n.libId+"- "+n.libIdLabel);var a=e[i];a&&t.push({matchedOn:a.matchingTypes[0],matchedField:n.field||n.libIdLabel})})}return t};i.prototype.getChartType=function(){return e.resolve(this.properties.visualization)};i.prototype.loadChart=function(n){var i=new e;var a=t.getService("qvCaoChartService");var s=this;s.getTitle().then(function(t){a.buildInsightChart(t,n,s.properties).then(function(t){i.resolve(t)})});return i.promise};return i}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(369)],a=function(t,e){t.service("qvCaoComplexityEstimatorService",[function(){var t;var n=[];var i=/aggr|rangeSum|FirstSortedValue/gi;function a(t){t.getFieldList().then(function(t){n=t})}function s(t){var e=n.filter(function(e){return e.qName===t});return e[0]&&e[0].qCardinal?e[0].qCardinal:0}function r(t){var n=e.classify(t);var a=0;var s=false;n.results.forEach(function(t){(-1!=t.content.search(i)||t.remainder&&-1!=t.remainder.content.search(i))&&(s=true);(t.function&&""!=t.function.content||t.isOperator)&&a++});return a*(s?3:1)}function o(t){var e=r(t.expr);var n=s(t.field,t)*e;return n*(e+1)}var l=function t(e){var n=0;e.analysis.dims&&e.analysis.dims.forEach(function(t){n+=o(t)});e.analysis.msrs&&e.analysis.msrs.forEach(function(t){n+=o(t)});return n};t={init:a,estimateComplexity:l};return t}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(54),n(407),n(187),n(178),n(408)],a=function(t,e,n,i,a){var s={};var r={classify:o};return r;function o(n){if(!t.isString(n))throw new Error("Expression-classifier: Expression must be a string");var i=n;if(s[i])return s[i];var r={content:n,count:0,result:{},results:[]};if(""===n){s[i]=r;return r}"="===n.charAt(0)&&(n=n.substr(1));var o=a.stripComments(n);var c=e.tokenize(o);r.count=c.length;c.forEach(function(t,e){var n;if(t.isOperator)r.results.push(t);else{n=l(t.content);r.results.push(n)}0===e&&(r.result=n)});s[i]=r;return r}function l(t){var e={content:t,function:{content:"",isCommon:false},remainder:{content:"",isFunction:false,isCommonFunction:false,isCommaSeparated:false,isFieldlike:false,isString:false,isNumber:false,isQualifier:false,qualified:{qualifier:"",content:"",isFieldlike:false}}};var n=c(t);if(n.hasAggregation){e.function.content=u(t,n);e.function.isCommon=v(e.function.content);e.remainder.content=d(t,n);var i=c(e.remainder.content);e.remainder.isFunction=b(i);e.remainder.isCommonFunction=y(e.remainder.content,i);e.remainder.isQualifier=h(e.remainder.content);e.remainder.isCommaSeparated=m(e.remainder.content);if(e.remainder.isQualifier){var a=f(e.remainder.content),s=g(e.remainder.content,a),r=c(s);e.remainder.qualified={qualifier:a,content:s,isFieldlike:S(r)}}n=i}else e.remainder.content=e.content;e.remainder.isFieldlike=S(n);e.remainder.isString=x(e.remainder.content);e.remainder.isNumber=q(e.remainder.content);return e}function c(t){var e={};e.expression=t;e.hasPrefix="="===t.charAt(0);e.leftSymbolIndex=t.indexOf(n.SYMBOLS.FUNCTION.LEFT);e.hasAggregation=e.leftSymbolIndex>0;e.isRightSymbolLast=t.substring(t.length-1)===n.SYMBOLS.FUNCTION.RIGHT;e.isEncapsulated=e.hasAggregation&&e.isRightSymbolLast;e.hasOperator=p(t);return e}function u(t,e){var n=e.hasPrefix?1:0,i=e.hasPrefix?e.leftSymbolIndex+1:e.leftSymbolIndex;return t.substr(n,i).trim()}function d(t,e){var n=t.substr(e.leftSymbolIndex),i=n.substr(1,n.length-2);return i.trim()}function p(t){var e=n.OPERATORS,i=e.SINGLES,a=e.MULTIPLES,s=e.WORDS;var r=i.some(function(e){return t.indexOf(e)>-1});if(r)return true;var o=a.some(function(e){return t.indexOf(e)>-1});if(o)return true;var l=s.some(function(e){return t.indexOf(" "+e+" ")>-1});return l}function h(t){return n.QUALIFIERS.some(function(e){return 0===t.toLowerCase().indexOf(e)})}function f(t){var e=n.QUALIFIERS.filter(function(e){return 0===t.toLowerCase().indexOf(e)}).shift();return e}function g(t,e){return t.slice(e.length).trim()}function v(t){return n.COMMON_FUNCTIONS.some(function(e){return t.toLowerCase()===e})}function m(t){var e=i.getCharacterIndexes(t,",");return e.some(function(e){return!D(t,e)})}function b(t){return t.isEncapsulated&&!t.isBleedingOperator}function y(t,e){if(!e.isEncapsulated)return false;var n=t.substr(0,e.leftSymbolIndex);return v(n)}function S(t){var e=t.expression;if(x(t.expression))return false;var a=I(e,n.SYMBOLS.FIELD.LEFT),s=C(e,n.SYMBOLS.FIELD.RIGHT),r=i.getCharacterCount(e,n.SYMBOLS.FIELD.LEFT),o=i.getCharacterCount(e,n.SYMBOLS.FIELD.RIGHT);if(a&&s&&1===r&&1===o)return true;return w(t)}function x(t){var e=I(t,n.SYMBOLS.STRING.LEFT),a=C(t,n.SYMBOLS.STRING.RIGHT),s=n.SYMBOLS.STRING.LEFT===n.SYMBOLS.STRING.RIGHT,r=i.getCharacterCount(t,n.SYMBOLS.STRING.LEFT),o;if(s)o=2===r;else{var l=i.getCharacterCount(t,n.SYMBOLS.STRING.RIGHT);o=1===r&&1===l}return e&&a&&o}function q(t){return!Number.isNaN(+t)}function I(t,e){return t.charAt(0)===e}function C(t,e){return t.charAt(t.length-1)===e}function w(t){if(t.hasAggregation)return false;var e=t.expression,i=e.indexOf(" ")>-1;if(i)return false;var a=n.OPERATORS.SINGLES.concat(n.OPERATORS.MULTIPLES).some(function(t){return e.indexOf(t)>-1});return!a}function D(t,e){return Object.keys(n.SYMBOLS).some(function(a){var s=n.SYMBOLS[a];return i.getIsCharacterEncapsulated(t,e,s.LEFT,s.RIGHT)})}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(894),n(169)],a=function(t,e){t.directive("qvGlobalSearchHighlights",function(){return{restrict:"E",template:e,replace:true,scope:{qText:"=",qRanges:"="},link:function e(n){var i=t.getService("qvGlobalSearchDataService").getMaxColorsNum();n.slices=null;n.$watch("qRanges",function(t){if(t){var e=0,s=[],r=t.sort(function(t,e){return t.qCharPos-e.qCharPos});for(var o=0;o<r.length;o++){var l=r[o];l.qCharPos>e&&s.push({qTerm:-1,qSliceText:n.qText.slice(e,l.qCharPos),highlight:false,iStart:e,iEnd:l.qCharPos});e=l.qCharPos+l.qCharCount;var c={qTerm:l.qTerm%i,highlight:true,qSliceText:n.qText.slice(l.qCharPos,e),iStart:l.qCharPos,iEnd:e};a(s,c);o===t.length-1&&e<n.qText.length&&s.push({qTerm:-1,qSliceText:n.qText.slice(e,n.qText.length),highlight:false,iStart:e,iEnd:n.qText.length})}n.slices=s}});function a(t,e){var n=null;for(var i=0;i<t.length;i++)if(t[i].iStart===e.iStart){n=t.splice(i,1,e);break}n||t.push(e)}}}})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(99),n(96)],a=function(t,e,n){t.directive("qvaSmartSearchSwipeHorizontal",["$parse",function(t){var i={up:false,down:false,right:true,left:true};return{restrict:"A",link:function a(s,r,o){var l=t(o.qvaSmartSearchSwipeHorizontal);function c(t,e){if(i[e.swipe.direction]){var a=e.swipe.curDeltaX>0?-1:0===e.swipe.curDeltaX?0:1;l(s,{delta:a});n.preventGestures(this.gestureHandler)}}e.treatAsDesktop()||n(r[0]).swipe({options:{radiusThreshold:50,preventDefault:false,useMomentum:true},start:c});s.$on("$destroy",function(){n(r[0]).off()})}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(2)],a=function(t){var e=function t(){};e.parseQuery=function(e,n){var i={text:e,appId:n};var a={method:"POST",url:"/api/v1/sentences",data:i};return t.request(a).then(function(t){var e=t.data;return e}).catch(function(t){throw t})};e.getQueries=function(e,n){var i="?limit="+e+"&appId="+n;var a={method:"GET",url:"/api/v1/sentences"+i};return t.request(a).then(function(t){var e=t.data.data;return e}).catch(function(t){throw t})};return e}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91)],a=function(t,e){t.service("qvCaoLearningConfidenceService",[function(){var t;var n={HIGH:{value:10,text:"high"},MEDIUM:{value:5,text:"medium"},LOW:{value:2,text:"low"},EMPTY:{value:0,text:"empty"}};function i(t){var e=t.getRelevance();var i=t.getMatchRecord();var a=n.EMPTY;if(t.isModified()){a=n.EMPTY;return a.text}1===e?a=n.HIGH:e>=.5?a=n.HIGH:e>0&&(a=n.HIGH);i.precedentStats&&(i.precedentStats.matchedFields===i.matches.length?a=n.HIGH:i.precedentStats.matchedFields>0&&a.value<n.MEDIUM.value&&(a=n.HIGH));return a.text}function a(t,n,i,a){var s={search:[],learned:[]};var r=t.field||t.libIdLabel;var o="";var l=i.filter(function(t){return t.matchedField===r})[0];var c=!!t.libIdLabel;var u=c?t.libId:null;if(l){switch(l.matchedOn){case"absoluteExactMatchCaseSensitive":o=e.get("cao.search.generated.absoluteExactMatchCaseSensitive");break;case"absoluteExactMatch":o=e.get("cao.search.generated.absoluteExactMatch");break;case"exactMatch":o=e.get("cao.search.generated.exactMatch");break;case"literalMatch":o=e.get("cao.search.generated.literalMatch");break;case"headMatch":o=e.get("cao.search.generated.headMatch");break;case"headSynonymMatch":o=e.get("cao.search.generated.headSynonymMatch");break;case"headStemMatch":o=e.get("cao.search.generated.headStemMatch");break;case"headStemSynonymMatch":o=e.get("cao.search.generated.headStemSynonymMatch");break;case"partialTokenMatch":o=e.get("cao.search.generated.partialTokenMatch");break;case"substrPartialMatch":o=e.get("cao.search.generated.substrPartialMatch");break;case"semanticMatch":o=e.get("cao.search.generated.semanticMatch");break;case"valueMatch":o=e.get("cao.search.generated.valueMatch");break;default:break}if(o){o=o.replace(/\{1\}/g,function(t){return"<b>"+t+"</b>"});var d=e.get(o,[n.search.searchPhrase.text,l.matchedField]);s.search.push({text:d,field:l.matchedField,priority:1,type:t.slotRole,isLibItem:c,libItemId:u,searchMatch:true})}}if(t.appPrecedent&&t.appPrecedent.appPrecedent){var p=false;if(t.appPrecedent.userDefined&&t.appPrecedent.userDefined.isUserDefined&&t.appPrecedent.userDefined.relations.indexOf("define")>-1){p=true;o=t.aggr||"measure"===t.slotRole?e.get("cao.confidence.reason.defined_measure"):e.get("cao.confidence.reason.defined_dimension")}else o=t.aggr||"measure"===t.slotRole?e.get("cao.confidence.reason.learned_measure"):e.get("cao.confidence.reason.learned_dimension");o=o.replace(/\{0\}/g,function(t){return"<b>"+t+"</b>"});s.learned.push({text:e.get(o,r),field:r,priority:1,type:t.slotRole,isLibItem:c,libItemId:u,userMatch:p})}if(0===s.learned.length&&a){o=t.aggr||"measure"===t.slotRole?e.get("cao.confidence.reason.assumed_measure"):e.get("cao.confidence.reason.assumed_dimension");o=o.replace(/\{0\}/g,function(t){return"<b>"+t+"</b>"});s.learned.push({text:e.get(o,r),field:r,priority:0,type:t.slotRole,isLibItem:c,libItemId:u})}return s}t={getReasonForSelectingField:a,determineConfidence:i,confidenceLevels:n};return t}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(936),n(103)],a=function(t,e,n,i){t.nativeComponent("qvCaoRefreshIndicator",{bindings:{},controller:[function(){this.refresh=function(){i.trackEvent(i.customEvents.INSIGHTS_REFRESH_CLICKED);e.publish("cao/insight/refresh")}}],template:n})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(89),n(971)],a=function(t,e,n){var i=null;var a=null;function s(s){var r={id:s.id,type:s.type,canCopy:function t(){return false},canCut:function t(){return false},canRemove:function t(){return true},remove:function t(){s.model.removeObject()},getAllPropertyPanelContent:function r(){if(!i){i=t.getService("$cacheFactory");a=i("pp-navPoint")}return e.all({properties:s.model.getProperties(),layout:s.model.getLayout()}).then(function(t){var e={definition:n,iconClass:"lui-icon lui-icon--sign-post",titleRef:"qMeta.title",properties:t.properties,layout:t.layout,model:s.model,cache:a,type:s.invalid?"invalid":"odagNavPoint"};return e})}};return r}return{createSelectedObjFromNavPoint:s}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(92),n(90),n(188),n(89)],a=function(t,e,n,i){var a;a=t.extend({init:function t(e){this._model=e},setModel:function t(e){this._model=e},saveSoftProperties:function t(a,s){if(!this._model)return i.resolve(false);var r=n.generate(a,s);e.extend(true,a,s);if(r&&r.length){r=r.map(function(t){return{qOp:t.op,qValue:JSON.stringify(t.value),qPath:t.path}});return this._model.applyPatches(r,true).then(function(){return true})}return i.resolve(false)},mergeSoftPatches:function t(){if(!this._model)return i.resolve();var e=this;return i.all({properties:this._model.getProperties(),effective:this._model.getEffectiveProperties()}).then(function(t){if(t.properties.qExtendsId)return;var i=n.generate(t.properties,t.effective);n.apply(t.properties,i);e._model.setProperties(t.properties).then(function(){e._model.clearSoftPatches()})})}});return a}.apply(e,i),void 0!==a&&(t.exports=a))},,,function(t,e,n){"use strict";var i,a;!(i=[n(95),n(92),n(117),n(254),n(89),n(108),n(90),n(91),n(11),n(155),n(105),n(182)],a=function(t,e,n,i,a,s,r,o,l,c,u,d){var p={};var h=e.extend("DataPrepService",{init:function t(e,n){e=e||r.getParameterByName("app");n=n||h.connectOptions;n.route="app/"+encodeURIComponent(e).toLowerCase();n.responseInterceptors=[{onRejected:function t(e,n,i){i.isHandled=true;return a.reject(i)}}];this.session=i.get(null,n);var s=this;this._callbacks=l.Callbacks();this.waitForOpen=new a;this.waitForResume=new a;this.waitForResume.resolve(s);this.restService=new c;document.addEventListener("onAppStateChanged",function(t){if(t.detail&&t.detail.inForegroundNow)s.session.resume(false).then(function(){s.waitForResume.resolve(s)});else if(t.detail&&!t.detail.inForegroundNow){s.session.suspend();s.waitForResume=new a}});function u(t){t=t||{};t.isHandled=true;t.message=o.get("DataPrep.Recommendations.ConnectionLostToDPS");s.waitForOpen.reject(t)}function d(){s.waitForOpen.resolve(s)}function p(t){var e=t.error;if(e){e.isHandled=true;-32e3!==e.code&&(e.dpsError=true)}}this.session.Error.bind(p);this.session.Close.bind(u);this.session.Open.bind(d);s.waitForResume.promise.then(function(){if(n.serverNodeId){var t=[];t.push(n.serverNodeId);s.rpc("setServerNodeId",t)}});this.session.enigmaPromise.then(d).catch(u)},rpc:function e(n,i){var a={method:n,params:i||[]};var s=this;return s.waitForResume.promise.then(function(){return s.session.rpc(a).then(function(e){if(e.result&&e.result.notification&&1005===e.result.notification.data.code){t.publish(u.Events.PubSub.StartSpin,{method:n});var a=i.length&&i.length>1&&i[1].forceReload;true===a&&(i[1].forceReload=false);return s.executeAfterReload(n,i).finally(function(){t.publish(u.Events.PubSub.StopSpin,{method:n})})}return e})})},rpcWithPolling:function e(n,i,a){a&&t.publish(u.Events.PubSub.StartSpin,{method:n});var s=true;var r=void 0;var o=function e(){a&&t.publish(u.Events.PubSub.StopSpin,{method:n})};r=setInterval(function(){s&&this.getProgress().then(function(){})}.bind(this),15e3);var l=function t(){s=false;void 0!==r&&clearInterval(r);r=void 0};return this.rpc(n,i).then(function(t){l();o();return t},function(t){l();o();throw t})},executeAfterReload:function t(e,n){var i=new a;this.waitForReload(i);return i.promise.then(function(){return this.rpc(e,n)}.bind(this))},_checkProgress:function t(e){var n=false;e.engine&&e.engine.qProgressData&&e.engine.qProgressData.qFinished&&true===e.dps.dataLoad.complete&&true===e.dps.profiling.complete&&(n=true);return n},waitForReload:function t(e){this.getProgress().then(function(t){this._checkProgress(t.result)?e.resolve(true):setTimeout(function(){this.waitForReload(e)}.bind(this),1e3)}.bind(this),function(t){e.reject(t)})},augmentOptions:function t(e){e["throwOnReload"]=true;return e},getProgress:function t(){return this.rpc("getProgress",[0])},getModel:function t(e){return this.rpc("getModel",[e||{}])},setModel:function t(e,n){return this.rpc("setModel",[e,n||{}])},initModel:function t(e,n){return this.rpc("initModel",[e,n||{}])},analyzeModel:function t(e,n){return this.rpc("analyzeModel",[e,n||{}])},getTargetTables:function t(e,n){return this.rpc("getTargetTables",[e,this.augmentOptions(n)||{}])},warmUpDPS:function t(e,n){return this.rpc("getTargetTables",[e,this.augmentOptions(n)||{}]).catch(function(t){t.error.dpsHandled=true;console.log("Warming up DPS ignored this error: ");console.log(t);throw t})},getTablePreview:function t(e,n,i){return this.rpc("getTablePreview",[e,n,this.augmentOptions(i)||{}])},getTableFields:function t(e,n,i){return this.rpc("getTableFields",[e,n,this.augmentOptions(i)||{}])},getLoadScript:function t(e,n){return this.rpc("getLoadScript",[e,n||{}])},getClassifications:function t(e){return this.rpc("getClassifications",[e])},getRestService:function t(){return this.restService},getVisRecommendations:function t(e,n){return this.rpc("getVisRecommendations",[e,n])},adaptVisualization:function t(e,n){return this.rpc("adaptVisualization",[e,n])},syncLoadModel:function t(e){return this.rpc("syncLoadModel",[e])},getRecommendations:function t(e,n){return this.rpcWithPolling("getRecommendations",[e,this.augmentOptions(n)||{}],true)},getDataPreview:function t(e){return this.rpc("getDataPreview",[e])},updateSources:function t(e,n,i){return this.rpcWithPolling("updateSources",[e,n,i||{}])}});h.getConnectOptions=function(){if(h.connectOptions){var t=new a;t.resolve(h.connectOptions);return t.promise}return n.global.getConfiguration().then(function(){h.connectOptions={host:r.hostname,isSecure:r.isSecure,prefix:r.basePath,port:r.port,subpath:"dataprepservice",reloadURI:r.reloadURI,serverNodeId:d.getServerNodeId()};return h.connectOptions})};h.isRunning=function(){var t=new c;return t.isRunning()};h.get=function(t,e){return h.getConnectOptions(e).then(function(e){t=t||r.getParameterByName("app");t=g(t);var n=p[t.toLowerCase()]||new h(t,e);p[t.toLowerCase()]=n;return n.waitForOpen.promise})};var f=".qvw";function g(t){if(s.isPersonalModeSync()&&-1!==t.indexOf(f,t.length-f.length))return t.substr(0,t.length-1)+"f";return t}return h}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(91)],a=function(t){function e(t){return"MessageCode."+(t||0)}function n(n){var i=t.get(e(n.qMessageCode),n.qMessageParameters);return i}function i(t){var e="";if(t)for(var i in t){e+=n(t[i]);i<t.length-1&&(e+="\n")}return e}function a(t){t=Math.floor(t);return t>9?""+t:"0"+t}function s(t){var e,n;var i=[];var a=[];for(e in t){n=t[e];!n.qErrorString||!n.qLine||(a[n.qLine]=true)}for(e in t){n=t[e];!n.qErrorString&&a[n.qLine]||i.push(n)}return i}return{translateMessage:n,translateMessageArray:i,formatNum:a,filterOutDuplicates:s}}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(846),n(97)],a=function(t,e){return{template:t,controller:["$scope",function(t){function n(){t.onClose()}t.$on("$destroy",function(){e.off("start",n)});e.on("start",n)}]}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(11),n(96),n(91),n(506),n(390),n(847)],a=function(t,e,n,i,a,s){return{type:"invalid",template:s,definition:{type:"items",items:{}},support:{exportData:false},getContextMenu:function t(){},hasError:function t(){return false},showRequirements:function t(){return false},getCreatePropertyHandler:function t(e){return new i({app:e})},getDropFieldOptions:function t(){},getDropDimensionOptions:function t(){},getDropMeasureOptions:function t(){},controller:["$scope","luiPopover",function(i,s){var r=i.object.error,o=n.get(r.title),l;l=Array.isArray(r.message)?n.get(r.message[0],r.message.slice(1)):n.get(r.message);i.error={title:o,message:l};i.showButton=i.options&&"function"===typeof i.options.removeIt;i.remove=function(t){i.options.removeIt();t.stopPropagation()};i.showMore=function(n){s.show({template:a.template,controller:a.controller,alignTo:t(n.target)[0],input:{error:i.error,onClose:function t(){e.preventGestures()}}})}}]}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(409)],a=function(t,e){t.directive("qvStateCountBar",function(){return{restrict:"E",template:e,replace:true,scope:{stateCounts:"=",options:"="},link:function t(e){e.percents=[];e.$watchCollection("stateCounts",function(){n()});function n(){var t=e.stateCounts,n;if(!t)return;n=a(t);e.percents=s(n)}function i(t){return Object.keys(t).reduce(function(e,n){return e+t[n]},0)}function a(t){var e=i(t),n={};["qSelected","qLocked","qOption","qAlternative"].forEach(function(i){var a=t[i]||0,s=Math.round(a/e*100);a>0&&0===s&&(s=1);n[i]=s});return n}function s(t){var e={},n,i,a=0;for(n in t){e[n]=t[n];(!i||t[n]>t[i])&&(i=n);a+=t[n]}a>100&&(e[i]=t[i]-(a-100));return e}}}})}.apply(e,i),void 0!==a&&(t.exports=a))},,,,function(t,e,n){"use strict";var i,a;!(i=[n(48),n(414)],a=function(t){var e=function t(){this.globalDefaults={enableQVDCaching:true}};e.prototype.get=function(){var e=this;return t.getService("qvDataManagerAppStorageService").get("globalDefaults").then(function(t){return t||e.set().then(function(){return e.globalDefaults})})};e.prototype.set=function(e){return t.getService("qvDataManagerAppStorageService").set("globalDefaults",e||this.globalDefaults)};return e}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="lui-dialog error-dialog" on-close-view="closeView( $event )" qv-escape="handleEscButton( $event )" ng-style="modalStyle" tid="errorDialog">\n\t<div class="lui-dialog__header">\n\t\t<div class="lui-dialog__title" ng-if="title" q-translation="{{title}}"></div>\n\t</div>\n\t<div class="lui-dialog__body dm-main">\n\n\t\t<main ng-if="!html">{{content | translate}}</main>\n\t\t<main ng-if="html" class="qv-appname"></main>\n\n\t</div>\n\n\t<div class="lui-dialog__footer">\n\t\t<lui-button qv-delayed-dialog-button ng-if="!buttons.length && showDefaultButton" ng-click="closeModal( $event, true );" qva-focus="true"\n\t\t\t\t\tq-translation="Common.OK" tid="confirm"></lui-button>\n\t\t<lui-button qv-delayed-dialog-button ng-repeat="button in buttons" qva-focus="button.defaultButton" ng-click="closeModal( $event );" ng-disabled="button.expression === false"\n\t\t\t\t\tq-translation="{{button.name}}" tid="{{button.tid}}"></lui-button>\n\t</div>\n</div>'},,,,,function(t,e,n){"use strict";var i,a;!(i=[n(89),n(139),n(90),n(125),n(99),n(130),n(1016),n(148),n(161),n(91),n(218)],a=function(t,e,n,i,a,s,r,o,l,c){var u=100;function d(t,n){if(""===n)return t;return t.filter(function(t){if("undefined"===typeof t.value)return false;return e.string(t.value.toLowerCase()).indexOf(e.string(n.toLowerCase()))>-1})}var p={template:r,controller:["$scope",function(e){e.search={term:""};e.isDirectDiscoveryField=o.isDirectDiscoveryField;e.getDirectDiscoveryTypeTranslationKey=o.getTypeTranslationKey;e.autoFocus=a.treatAsDesktop();e.position||(e.position="right");e.onEscape=function(t){if(""!==e.search.term){t.stopPropagation();e.search.term=""}else e.close()};e.onEnter=function(t){if(""!==e.search.term){t.stopPropagation();e.addExpressionMeasure({value:e.search.term})}else e.close()};e.showFromField=function(t){e.currentField=t;e.step2=true};e.goBack=function(t){t.preventDefault();e.currentField=null;e.step2=false};e.$watch("currentField",function(t){e.fieldSuggestions=t?["Sum","Count","Avg","Min","Max"].map(function(t){var i=n.escapeField(e.currentField.value);return{aggregation:t,field:i}}):[]});e.addFromField=function(t){var n=t.aggregation+"("+t.field+")";e.addExpressionMeasure({value:n})};e.getFieldDisplayName=function(t){return""===e.search.term?t.label:l.trimAutoCalendarName(t.value)};var r=null;e.$watch("search.term",function(n){function a(){var t=d(r.measures,n);var a=d(r.fields,n);var s=d(r.activeMeasures,n);if(t.length+s.length>u){t=i.limit(t,Math.max(u-s.length,0));a=[]}else t.length+s.length+a.length>u&&(a=i.limit(a,Math.max(u-t.length-s.length,0)));e.fields=a;e.measures=t;e.activeMeasures=s}r?a():t.all({fields:s.getSortedFields(e.app),measures:s.getSortedMeasures(e.app),activeMeasures:e.activeMeasures}).then(function(t){var e=t.fields.map(function(t){var e=t.isDerived&&""===n?t.qName.substring(t.qName.lastIndexOf(".")+1,t.qName.length):t.qName;return{toolTip:t.qName,value:t.qName,trimmedValue:t.displayName,label:e,field:t.qName,qTags:t.qTags,isDerived:t.isDerived,isDateField:t.isDateField,isGeoField:t.isGeoField,activeMeasureIndex:-1}});var i=t.measures.map(function(t){return{value:t.qData.title,label:t.qData.title,libraryId:t.qInfo.qId,activeMeasureIndex:-1}});var s=[];t.activeMeasures&&t.activeMeasures.length&&(s=t.activeMeasures.map(function(t,n){var a={};t.qLibraryId?i.forEach(function(e){if(e.libraryId===t.qLibraryId){a.value=e.value;a.label=e.label}a.libraryId=t.libraryId}):e.forEach(function(e){if(e.value===t.qDef.qDef){a.label=e.label;a.value=e.value}});a.translatedTitle=c.get("properties.colorBy.currentMeasure",n+1);a.activeMeasureIndex=n;return a}));r={fields:e,measures:i,activeMeasures:s};a()})})}],scope:{alignTo:"=",app:"=",addExpressionMeasure:"=",addLibraryMeasure:"=",addActiveMeasure:"=",close:"=",qvaOutsideIgnoreFor:"=",position:"=",allowExpressionEditor:"@"}};return p}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(1017)],a=function(t){var e={create:n};return e;function n(){return new t}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={barchart:{static:"faded_bar.svg",animation:"sweep_bar.json"},boxplot:{static:"faded_box_plot.svg",animation:"sweep_box_plot.json"},combochart:{static:"faded_combo.svg",animation:"sweep_combo.json"},default:{static:"faded_default.svg",animation:"sweep_default.json"},distributionplot:{static:"faded_distribution.svg",animation:"sweep_distribution.json"},filterpane:{static:"faded_filter_pane.svg",animation:"sweep_filter_pane.json"},gauge:{static:"faded_gauge.svg",animation:"sweep_gauge.json"},histogram:{static:"faded_histogram.svg",animation:"sweep_histogram.json"},kpi:{static:"faded_kpi.svg",animation:"sweep_kpi.json"},linechart:{static:"faded_line.svg",animation:"sweep_line.json"},map:{static:"faded_map.svg",animation:"sweep_map.json"},piechart:{static:"faded_pie.svg",animation:"sweep_pie.json"},"pivot-table":{static:"faded_pivot_table.svg",animation:"sweep_pivot_table.json"},scatterplot:{static:"faded_scatter.svg",animation:"sweep_scatter.json"},table:{static:"faded_table.svg",animation:"sweep_table.json"},"text-image":{static:"faded_text_image.svg",animation:"sweep_text_image.json"},treemap:{static:"faded_tree_map.svg",animation:"sweep_tree_map.json"},waterfallchart:{static:"faded_waterfall.svg",animation:"sweep_waterfall.json"}};function e(e){var i=t[e]?t[e].static:t["default"].static;return n.p+"assets/images/charts/"+i}function i(e){var i=t[e]?t[e].animation:t["default"].animation;return n.p+"assets/images/charts/animations/"+i}return{getImageNameFromChartType:e,getLoadingImageAnimationUrlFromChartType:i}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){var i;!(i=function(){return function(t,e){if(!t||isNaN(+e))return e;var e="-"==t.charAt(0)?-e:+e;var n=e<0?e=-e:0;var i=t.match(/[^\d\-\+#]/g);var a=i&&i[i.length-1]||".";var s=i&&i[1]&&i[0]||",";var t=t.split(a);e=e.toFixed(t[1]&&t[1].length);e=+e+"";var r=t[1]&&t[1].lastIndexOf("0");var o=e.split(".");(!o[1]||o[1]&&o[1].length<=r)&&(e=(+e).toFixed(r+1));var l=t[0].split(s);t[0]=l.join("");var c=t[0]&&t[0].indexOf("0");if(c>-1)while(o[0].length<t[0].length-c)o[0]="0"+o[0];else 0==+o[0]&&(o[0]="");e=e.split(".");e[0]=o[0];var u=l[1]&&l[l.length-1].length;if(u){var d=e[0];var p="";var h=d.length%u;for(var f=0,g=d.length;f<g;f++){p+=d.charAt(f);!((f-h+1)%u)&&f<g-u&&(p+=s)}e[0]=p}e[1]=t[1]&&e[1]?a+e[1]:"";return(n?"-":"")+e[0]+e[1]}}.call(e,n,e,t),void 0!==i&&(t.exports=i))},function(t,e,n){"use strict";var i,a;!(i=[n(282),n(89)],a=function(t,e){return{createInitialChart:a,createChart:i,convertChart:s,getPropertyTreeForConvertedChart:r,createConvertedChart:o};function n(t){var e=t.qHyperCubeDef;if(e&&e.qMeasures&&e.qDimensions){var n=e.qDimensions.concat(e.qMeasures);n.forEach(function(t){t.qAttributeExpressions&&t.qAttributeExpressions.forEach(function(t){t.qAttribute=true})})}}function i(t,e,i){var a=l(e,i).bind(e);n(t);return a(t)}function a(e,n,a){c(e,n,a);return t.getInitialProperties(e).then(function(t){return i(t,n,a)})}function s(t,e,n){if(!t)throw new Error("No extension provided");var i=n||t.model;return r(t,e,n).then(function(t){return n.setFullPropertyTree(t).then(function(){return i})})}function r(n,i,a){if(!n)throw new Error("No extension provided");var s=a||n.model;return e.all([t.getExtensionType(i),t.getInitialProperties(i),s.getFullPropertyTree()]).then(function(t){var e=t[0];var i=t[1];var a=t[2];var s;delete a.qProperty.qInfo.qId;if(n.exportProperties&&e.importProperties){var r;"boxplot"===n.type&&(r="boxplotDef");s=e.importProperties(n.exportProperties(a,r),i,e)}else s={qProperty:i,qChildren:[]};return s})}function o(t,e,n,i){c(e,n,i);return(t.model.properties,n,i).then(function(n){return s(t,e,n)})}function l(t,e){return e?t.createObject:t.createSessionObject}function c(t,e,n){if(!e||!t)throw new Error("Invalid inparameters: type or app missing");if(n)throw new Error("Persisted objects not implemented yet")}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(54),n(187)],a=function(t,e){var n=s();var i={tokenize:a};return i;function a(e){if(!t.isString(e))throw new Error("Expression-tokenizer: Expression must be a string");e=e.trim();"="===e.charAt(0)&&(e=e.substr(1));var n=[],i=0,a=r(e);a.forEach(function(t){var a=e.substr(i,t.start-i).trim();a&&n.push({content:a,isOperator:false});n.push({content:t.content,isOperator:true});i=t.end});var s=e.substr(i,e.length);n.push({content:s.trim(),isOperator:false});return n}function s(){var t={};for(var n in e.SYMBOLS)if(e.SYMBOLS.hasOwnProperty(n)){var i=e.SYMBOLS[n];t[i.LEFT]=i.RIGHT}return t}function r(t){var e=[];for(var n=0;n<t.length;n++){var i=t.charAt(n);if(o(i)){n=l(t,i,n);continue}var a=[],s=false,r=c(i);a=u(i);if(a.length){var p=t.substr(n).toLowerCase();for(var h=0;h<a.length;h++){var f=a[h],g=d(p,f);if(g){e.push({content:f,start:n,end:n+f.length});s=true;n+=f.length-1;break}}}!s&&r&&e.push({content:i,start:n,end:n+1})}return e}function o(t){return n.hasOwnProperty(t)}function l(t,i,a){var s=i,r=n[s],o=t.substring(a).split(""),l=0,c=false;for(var u=0;u<o.length;u++){var d=o[u];d===e.SYMBOLS.STRING.LEFT&&(c=!c);if(c)continue;d===s&&l++;d===r&&l--;if(!l)return u+a}return a}function c(t){return e.OPERATORS.SINGLES.indexOf(t.toLowerCase())>-1}function u(t){var n=[];var i=e.OPERATORS.MULTIPLES.concat(e.OPERATORS.WORDS).filter(function(t){return t.length>1}).map(function(t){return t.toLowerCase()});i.forEach(function(e){0===e.indexOf(t.toLowerCase())&&n.push(e)});return n}function d(t,n){var i=0===t.indexOf(n+" "),a=e.OPERATORS.SINGLES.some(function(e){return 0===t.indexOf(n+e)});return i||a}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={stripComments:e};return t;function e(t){if(!t)return"";t=n(t);t=i(t);return t.trim()}function n(t){return t.replace(/\/\/(.*)$/gm,"")}function i(t){return t.replace(/\/\*[^]*?\*\//g,"")}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="qv-state-count-bar" tid="stateCount" qva-direction x-dir-setting="{{options.direction}}">\n\t<div class="state selected" ng-style="{\'width\': percents.qSelected + \'%\'}"></div>\n\t<div class="state locked" ng-style="{\'width\': percents.qLocked + \'%\'}"></div>\n\t<div class="state optional" ng-style="{\'width\':  percents.qOption + \'%\'}"></div>\n\t<div class="state alternative" ng-style="{\'width\':  percents.qAlternative + \'%\'}"></div>\n</div>'},,,,,function(t,e,n){"use strict";var i,a;!(i=[n(48),n(93),n(440)],a=function(t,e){function n(t){return e.getApp().then(function(e){return e.id+"."+t})}function i(t){this.localStorageService=t}i.prototype.get=function(t){var e=this;return n(t).then(function(t){return e.localStorageService.get(t)})};i.prototype.set=function(t,e){var i=this;return n(t).then(function(t){i.localStorageService.set(t,e)})};i.prototype.remove=function(t){var e=this;return n(t).then(function(t){e.localStorageService.remove(t)})};t.service("qvDataManagerAppStorageService",["qvDataManagerLocalStorageService",function(t){return new i(t)}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(93),n(89),n(108),n(50)],a=function(t,e,n,i,a){t.service("qvAppDetailsService",["$q",function(t){var a;return{get:function r(){if(!a){a=t.defer();e.getApp().then(function(t){t.global.allowCreateApp().then(function(e){var r;t.getScriptEx().then(function(t){r=t.qMeta.privileges}).catch(function(t){r=false;t.isHandled=true}).then(function(){n.all([t.getLayout()]).then(function(n){var o=n[0];var l={app:{id:t.id,appTitle:o.qTitle,readOnly:o.qReadOnly,hasData:!!o.qHasData,hasScript:!!o.qHasScript,published:o.published},permissions:{createSheet:!o.qReadOnly&&o.permissions.createSheet,createApp:e,update:o.permissions.update,createBookmark:o.permissions.createBookmark,updateScript:i.isPersonalModeSync()&&!r||r&&-1!==r.indexOf("update")}};a.resolve(new s(l))})})})})}return a.promise}}}]);function s(t){this.model=t;this.events={onModelChanged:[]};var n=this;e.getApp().then(function(t){t.Invalidated.bind(function(){t.getLayout().then(function(t){n.model.app.appTitle=t.qTitle;n.model.app.readOnly=t.qReadOnly;n.model.app.hasData=t.qHasData;n.model.app.published=t.published;n.model.permissions.createSheet=!t.qReadOnly&&t.permissions.createSheet;n.model.permissions.update=t.permissions.update;n.events.onModelChanged.forEach(function(e){e&&e(n.model,t)})}).catch(function(t){var e=11e3;t.code===e&&(t.isHandled=true)})})})}s.prototype.appHasData=function(){return this.model.app.hasData};s.prototype.isDataManagerHidden=function(){return a.isSmallDevice||!this.model.permissions.createSheet||!this.model.permissions.update||!this.model.permissions.createApp||!this.model.permissions.updateScript};s.prototype.isScriptEditorHidden=function(){return a.isSmallDevice||!this.model.permissions.createSheet||!this.model.permissions.update||!this.model.permissions.updateScript};s.prototype.isDataModelViewerHidden=function(){return a.isSmallDevice||!this.model.permissions.createSheet||!this.model.permissions.update};s.prototype.isQDLEnabled=function(){return this.model.permissions.update&&this.model.permissions.updateScript&&!a.isSmallDevice&&this.model.permissions.createApp};s.prototype.bindOnModelChanged=function(t){this.events.onModelChanged.push(t)};s.prototype.unbindOnModelChanged=function(t){var e=this.events.onModelChanged.indexOf(t);e>=0&&this.events.onModelChanged.splice(e,1)}}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(462),n(464),n(467),n(472),n(475)],a=function(){}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";"undefined"===typeof Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{enumerable:false,get:function t(){var e=this.toString().match(/^function( (.*?))?\(/);return e&&e.length>=3?e[2]:"anonymous function"}});Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),n=this,i=function t(){},a=function a(){return n.apply(this instanceof i&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};i.prototype=this.prototype;a.prototype=new i;return a});Array.prototype.contains||Object.defineProperty(Array.prototype,"contains",{enumerable:false,value:function t(e){return-1!==this.indexOf(e)}});"scrollX"in window.constructor.prototype||Object.defineProperties(window.constructor.prototype,{scrollX:{get:function t(){return this.pageXOffset}},scrollY:{get:function t(){return this.pageYOffset}}})},function(t,e,n){"use strict";var i,a;!(i=[n(11),n(224)],a=function(t,e){function n(n){function i(t){n.imageCustomSize=t}function a(t){n.selectedSize=t}function s(t){if(!t||!t.orientation)return;n.selectedLayout=t;n.sizes.forEach(function(e){e.setLabel(t.orientation)})}function r(t){n.export=t;n.print.format=t.format}function o(t){var e=l();if(t.isCustom){n.print.width=Math.round(e.width);n.print.height=Math.round(e.height);return}var i=t.toPixels(e.width);n.print.width=i.w;n.print.height=i.h}function l(){return{width:t("#qv-story-play").is(":visible")?t("#qv-story-play").find(".qv-story-play-slide").first().width():n.input.currentWidth,height:t("#qv-story-play").is(":visible")?t("#qv-story-play").find(".qv-story-play-slide").first().height():n.input.currentHeight,dpi:n.input.currentDpi}}function c(t){if(n.obj&&n.input.object){var i,a,s,r,o;n.print.width<8&&(n.print.width=8);n.print.height<8&&(n.print.height=8);n.print.dpi<n.minDpi&&(n.print.dpi=n.minDpi);n.print.dpi>n.maxDpi&&(n.print.dpi=n.maxDpi);var c=Math.round(n.print.width),p=Math.round(n.print.height);var h=l();o={width:Math.round(h.width),height:Math.round(h.height),dpi:h.dpi};var f=n.imageCustomSize?{width:n.print.width,height:n.print.height,dpi:n.print.dpi}:{width:n.input.currentWidth,height:n.input.currentHeight,dpi:n.input.currentDpi};a={width:Math.round(f.width*(n.input.currentDpi/f.dpi)),height:Math.round(f.height*(n.input.currentDpi/f.dpi))};"image"===t&&(i={imageType:n.print.format,captureSize:f});if("pdf"===t){s=n.selectedSize.toMillimeters();r={right:10,left:10,top:10,bottom:10};i={width:s["portrait"===n.selectedLayout.orientation?"w":"h"],height:s["portrait"===n.selectedLayout.orientation?"h":"w"],dpi:n.print.dpi,fitCriteria:n.print.fitCriteria,margin:r,sourceSize:o}}"ppt"===t&&(i={width:c,height:p,dpi:n.print.dpi,sourceSize:o});n.state=n.states.PENDING;return e.printTree(n.input.object,o,a,i,t).then(function(e){u(e,t)},d)}n.destroyComponent()}function u(t,e){n.printUrl=t.qUrl;n.printFileName=t.fileName;var i=e.charAt(0).toUpperCase()+e.slice(1);n.printUrlTranslationKey="Print."+i+".CompletedLink";n.state=n.states.COMPLETED}function d(t){n.statusCode=t.httpStatusCode;var e=t&&t.status;switch(e){case n.states.CANCELED:case n.states.TIMEOUT:n.state=e;break;default:n.state=n.states.FAILED;break}}return{onImageCustomSize:i,onSizeChange:a,onPrintLayout:s,onFormatChange:r,confirm:c,onPptFormatChange:o}}return{create:n}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(91)],a=function(t){var e="landscape";var n={w:33.1,h:46.8};var i=function t(e,n,i){this.name=e;this.unit=i||"in";this.dimensions=n};i.prototype={toPixels:function t(e){var n,i,a=0;switch(this.unit){case"in":a=e;break;case"pi":a=1;break;case"cm":a=.393701*e;break}n=this.dimensions.w*a;i=this.dimensions.h*a;return{w:Math.round(n),h:Math.round(i)}},toMillimeters:function t(){var e,n,i=0;switch(this.unit){case"in":i=1/.0393701;break;case"cm":i=10;break}e=this.dimensions.w*i;n=this.dimensions.h*i;return{w:Math.floor(e),h:Math.floor(n)}},setLabel:function e(n){var i=this;var a;var s=t.localeDetected&&"en"===t.localeDetected.substring(0,2);var r=s?i.dimensions:i.toMillimeters();var o=r["portrait"===n?"w":"h"],l=r["portrait"===n?"h":"w"];"Print.PaperSize.Letter"===i.name&&(i.name=t.get(i.name));a=s?" ("+o+'" x '+l+'")':" ("+o+" mm x "+l+" mm)";i.label=i.name+a}};function a(t,e){var n,i;if(t<e){n=t;i=e/2}else{n=t/2;i=e}return{w:n>i?i:n,h:i>n?i:n}}var s=[new i("A0",{w:n.w,h:n.h})];for(var r=1;r<8;r++)s.push(new i("A"+r,a(s[r-1].dimensions.w,s[r-1].dimensions.h)));s.push(new i("Print.PaperSize.Letter",{w:8.5,h:11}));for(var o=0;o<3;o++)s.shift();s.forEach(function(t){t.setLabel(e)});var l=[{orientation:"portrait",translationKey:"Print.Portrait"},{orientation:"landscape",translationKey:"Print.Landscape"}];l.forEach(function(e){t.ready.then(function(){e.label=t.get(e.translationKey)})});var c=[{type:"pdf",format:"pdf",label:"PDF"},{type:"image",format:"png",label:"PNG"},{type:"image",format:"jpeg",label:"JPEG"}];return{sizes:s,layouts:l,outputs:c}}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(48),n(54),n(113)],a=function(t,e,n){var i="DataManager";var a=1;var s=2592e6;function r(t){if(!n["DISABLE_DM_LOCAL_STORAGE"]&&c()){var e=new o(localStorage,true);this.storage=e;t(function(){u(e)})}else this.storage=new o({},false)}r.prototype.get=function(t){var e=this.storage.get(l(t));var n=p(e);return n?n.value:void 0};r.prototype.set=function(t,e){var n=(new Date).getTime();var i={created:n,version:a,value:e};var s=d(i);this.storage.set(l(t),s)};r.prototype.remove=function(t){this.storage.remove(l(t))};function o(t,e){this.storage=t;this.supportsLocalStorage=e}o.prototype.get=function(t){var e=this.supportsLocalStorage?this.storage.getItem(t):this.storage[t];return e};o.prototype.set=function(t,e){this.supportsLocalStorage?this.storage.setItem(t,e):this.storage[t]=e};o.prototype.remove=function(t){this.supportsLocalStorage?this.storage.removeItem(t):delete this.storage[t]};o.prototype.keys=function(){var t=[];var e;if(this.supportsLocalStorage)for(var n=0;n<this.storage.length;n++){e=this.storage.key(n);t.push(e)}else for(e in this.storage)t.push(e);return t};function l(t){return i+"."+t}function c(){try{localStorage.setItem(i,i);localStorage.removeItem(i);return true}catch(t){return false}}function u(t){var n=i+".";var a=(new Date).getTime();t.keys().forEach(function(i){if(0===i.lastIndexOf(n,0)){var r=t.get(i);var o=p(r);o&&o.created&&e.isNumber(o.created)&&a-o.created>s&&t.remove(i)}})}function d(t){return JSON.stringify(t)}function p(t){if(!t)return;try{return JSON.parse(t)}catch(t){return}}t.service("qvDataManagerLocalStorageService",["$timeout",function(t){return new r(t)}])}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(115),n(89)],a=function(t,e){var i={width:144,height:96},a=2;function s(t){var e={};e.width=t.width-t.numCols*t.spacing;e.height=t.height-t.numRows*t.spacing;e.columnWidth=e.width/t.numCols;e.rowHeight=e.height/t.numRows;e.cols=t.numCols;e.rows=t.numRows;e.spacing=t.spacing;return e}function r(e,n,i,a){var s=i.colspan/n.cols*n.width+(i.colspan-2)*n.spacing,r=i.rowspan/n.rows*n.height+(i.rowspan-2)*n.spacing,o=n.spacing+n.columnWidth*i.col+n.spacing*i.col,l=n.spacing+n.rowHeight*i.row+n.spacing*i.row,c=t.getIconPath(i.type),u=s>=r?r:s;e.fillStyle="rgb(242, 242, 242)";e.fillRect(o,l,s,r);u=Math.max(8,Math.min(u,24))/16;e.fillStyle=a?"rgba(0, 152, 69,.6)":"rgba(89, 89, 89,0.6)";e.text="center";e.textAlign="center";e.textBaseline="middle";e.save();e.translate(Math.round(o+s/2-8*u),Math.round(l+r/2-8*u));e.scale(u,u);e.fill(new Path2D(c));e.restore()}var o={staticSrc:function t(){return{staticPublishedSheet:function t(){return n.p+"img/core/static/Default-sheet-published.png"},staticUnPublishedSheet:function t(){return n.p+"img/core/static/Default-sheet-unpublished.png"},staticPublishedStory:function t(){return n.p+"img/core/static/Default-story-published.png"},staticUnPublishedStory:function t(){return n.p+"img/core/static/Default-story-unpublished.png"},staticApp:function t(){return n.p+"img/core/static/Default_thumbnail_app.png"},brokenImage:function t(){return n.p+"img/core/static/Ic_BrokenBig@2x.png"}}},dimensions:{original:i,width:i.width-2,height:i.height-2,spacing:2},getSrc:function t(e,n){var i=n?"Sheet":"Story",a=e?"staticPublished":"staticUnPublished";return o.staticSrc()[a+i]()},generateImageForStory:function t(n,i){var a=new e;i.get(n.item.qInfo.qId).then(function(t){t.getLayout().then(function(e){if(e.qChildList&&e.qChildList.qItems.length){n.slide=e.qChildList.qItems.slice().sort(function(t,e){if(t.qData.rank===e.qData.rank)return 0;return t.qData.rank<e.qData.rank?-1:1})[0];n.slide?t.app.getObject(n.slide.qInfo.qId).then(function(t){t.getLayout().then(function(t){t.qChildList.qItems.length>0?a.resolve():a.reject()},a.reject)}):a.reject()}else a.reject()})});return a.promise},paintCanvas:function t(e){var n=document.createElement("canvas"),i,l,c;i=s({width:o.dimensions.width*a,height:o.dimensions.height*a,spacing:o.dimensions.spacing,numRows:e.qData.rows,numCols:e.qData.columns});n.width=o.dimensions.width*a;n.height=o.dimensions.height*a;l=n.getContext("2d");function u(t){t.forEach(function(t){var n=e.qMeta.published;r(l,i,t,n)})}l.clearRect(0,0,n.width,n.height);u(e.qData.cells);c=n.toDataURL();l=null;i=null;n.remove&&n.remove();n=null;return c}};return o}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90)],a=function(t){return{getLayoutMsg:e,getPropCondition:n,setPropCondition:i,getPropMessage:a,setPropMessage:s};function e(t){return t.customErrorMessage&&t.customErrorMessage.calcCond||t.qCalcCondMsg}function n(e,n){return t.getValue(e,n||"qCalcCond.qv")||t.getValue(e,"qCalcCondition.qCond.qv")||""}function i(e,n,i){t.setValue(e,i||"qCalcCond.qv",n);t.setValue(e,"qCalcCondition.qCond.qv",n)}function a(e){var n=t.getValue(e,"customErrorMessage.calcCond");var i=t.getValue(e,"qCalcCondition.qMsg.qv");return n||i||""}function s(e,n){t.setValue(e,"customErrorMessage.calcCond","="!==n[0]?n:"");t.setValue(e,"qCalcCondition.qMsg.qv",n)}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(463)],a=function(t,e){t.component("quiFloat",{transclude:true,template:e,scope:{quiOffset:"=",quiResizeOnChange:"="},controller:["$scope","$element","$timeout",function(t,e,n){function i(){if(!t.quiOffset||!t.reportedSize||!t.reportedWindowSize)t.visible=false;else{t.quiOffset.left+t.reportedSize.width<t.reportedWindowSize.width?t.left=t.quiOffset.left:t.left=t.reportedWindowSize.width-t.reportedSize.width;t.quiOffset.top+t.reportedSize.height<t.reportedWindowSize.height?t.top=t.quiOffset.top:t.top=t.reportedWindowSize.height-t.reportedSize.height;t.visible=true}}function a(){n(function(){t.reportedSize={width:e.outerWidth(),height:e.outerHeight()}})}t.$watch("quiResizeOnChange",a,true);t.$watch("[quiOffset, reportedSize, reportedWindowSize]",i,true)}]})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="qui-float" ng-style="{top:top, left:left}" ng-show="visible" qva-reported-window-size="reportedWindowSize">\n\t<div ng-transclude></div>\n</div>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(465),n(466)],a=function(t,e,n){t.component("quiInputNumber",{template:n,scope:{quiModel:"=",quiDisabled:"=",quiTitle:"@",quiMin:"@",quiMax:"@",quiClass:"@",quiSelectTextOnFocus:"@",quiWithButtons:"@",quiTid:"@"},controller:["$scope","$element",function(t,n){if(t.quiSelectTextOnFocus){t.selected=false;n.click(function(){if(false===t.selected){n.select();t.selected=true}});n.blur(function(){t.selected=false})}t.onChange=function(i){var a=parseInt(i)||0;t.quiModel=e.getNumerical(parseInt(n.find(".lui-input").val())+a,t.quiMin,t.quiMax)}}]})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){function t(t){return Number(String(t).replace(/[^-\d]/g,""))}return{getNumerical:function e(n,i,a){n=t(n);i=Number(i);a=Number(a);if(n<i)return i;if(0!==a&&n>a)return a;return n}}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<span class="qui-input-number lui-input-group">\n\t<button class="lui-input-group__item  lui-input-group__button  lui-button" qva-activate="onChange(-1)" ng-disabled="quiDisabled" ng-if="quiWithButtons">\n\t\t<span class="lui-button__icon">-</span>\n\t</button>\n\t<input type="tel" class="lui-input-group__item  lui-input-group__input  lui-input {{quiClass}}" tid="{{quiTid}}" title="{{quiTitle}}" ng-model="quiModel" ng-model-options="{ updateOn: \'blur\' }" ng-change="onChange()" ng-disabled="quiDisabled"/>\n\t<button class="lui-input-group__item  lui-input-group__button  lui-button" qva-activate="onChange(1)" ng-disabled="quiDisabled" ng-if="quiWithButtons">\n\t\t<span class="lui-button__icon">+</span>\n\t</button>\n</span>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(11),n(119),n(468),n(469),n(470)],a=function(t,e,n,i){var a={TAB:9};function s(t){return t.parents(".popover-container").length?t.parents(".popover-container")[0]:null}function r(e,n,i){return e.which===a.TAB&&e.target!==n.alignTo&&t(e.target).closest(".lui-popover-container")[0]!==i[0]}var o={template:i,scope:{quiModel:"=",shared:"=",close:"="},controller:["$scope","$element","$document",function(t,e,n){t.menuClasses=t.quiModel.menuOptions.content.menuClasses?t.quiModel.menuOptions.content.menuClasses:"qui-textlist";t.quiModel.menuOptions.content.createMenuItems().then(function(e){t.menuItems=e});t.selectMenuItem=function(e,n,i){n&&n.preventDefault&&n.preventDefault();if(!e.disable){t.close&&t.close();e.selected(n,i)}};n.on("keyup.qv-popover",function(n){s(e)&&r(n,t,e)&&t.close&&t.close()});t.$on("$destroy",function(){n.off("keyup.qv-popover")})}]};e.directive("qvPopoverButton",function(){return{template:n,transclude:true,replace:true,restrict:"E",scope:{quiModel:"=",quiPopoverContainer:"=?"},controller:["$scope","$element","luiPopover","qvMobileMenu",function(t,e,n,i){var a;t.shared={pressed:false};t.onClick=function(){if(t.shared.pressed&&a){a.close();return}t.shared.pressed=!t.shared.pressed;var r=t.quiModel.menuOptions||{};a=r.smallview?i.show({controller:o.controller,template:o.template,autoFocus:false,closeOnResize:true,outsideIgnore:t.quiModel.tid,input:{quiModel:t.quiModel,shared:t.shared,close:function t(){a.close()}}}):n.show({controller:o.controller,template:o.template,dock:"bottom",alignTo:e[0],autoFocus:false,closeOnResize:true,outsideIgnore:t.quiModel.tid,container:s(e),input:{quiModel:t.quiModel,shared:t.shared,close:function t(){a.close()}}});a.closed.then(function(){t.shared.pressed=false})};t.$watch("shared.pressed",function(e){t.currentTitle=e&&t.quiModel.tooltipActive?t.quiModel.tooltipActive:t.quiModel.tooltipInactive})}]}})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<button\n\t\ttid="{{quiModel.tid}}"\n\t\tng-disabled="quiModel.isDisabled()"\n\t\tng-class="[quiModel.buttonClass, quiModel.buttonVariant, {\'lui-active\': shared.pressed }]"\n\t\tq-title-translation="{{currentTitle}}"\n\t\tqva-outside-ignore-for="{{quiModel.tid}}"\n\t\tng-click="onClick()">\n\t<span class="{{quiModel.buttonClass}}__icon lui-icon  lui-icon--{{quiModel.icon}}  {{quiModel.menuOptions.smallview ? \'lui-icon--large\' : \'\'}}"></span>\n\t<span class="{{quiModel.buttonClass}}__text" ng-if="quiModel.buttonText">\n\t\t{{quiModel.buttonText}}\n\t</span>\n\t<span ng-if="!quiModel.hideCaret" class="{{quiModel.buttonClass}}__caret  lui-caret"></span>\n</button>\n'},function(t,e){t.exports='<lui-popover ng-style="{ width: quiModel.menuOptions.width }">\n\t<ul ng-class="menuClasses" tid="{{quiModel.menuOptions.content.tid}}">\n\t\t<li class="lui-list__item"\n\t\t\tng-repeat="menuItem in menuItems"\n\t\t\tng-class="{\'open-in-new-tab-always\': menuItem.openInNewTab == \'always\', \'lui-disabled\': menuItem.disable, \'header-item\': menuItem.headerItem, \'last-menu-item\' : menuItem.last}"\n\t\t\tng-hide="menuItem.hide">\n\n\t\t\t<qv-menu-switch tid="{{menuItem.tid}}" x-model="menuItem" callback="selectMenuItem(menuItem, $event)" ng-if="menuItem.showSwitch"/>\n\n\t\t\t<button tid="{{menuItem.tid}}"\n\t\t\t\t class="action-item"\n\t\t\t\t ng-class="[quiModel.buttonClass, quiModel.buttonVariant]"\n\t\t\t\t ng-click="selectMenuItem(menuItem, $event)"\n\t\t\t\t q-title-translation="{{ menuItem.title || menuItem.text}}"\n\t\t\t\t ng-disabled="menuItem.disable"\n\t\t\t\t ng-if="!menuItem.showSwitch">\n\t\t\t\t<span ng-if="menuItem.icon"\tclass="lui-list__aside">\n\t\t\t\t\t<span class="lui-icon  lui-icon--{{menuItem.icon}}" ng-disabled="menuItem.disable"></span>\n\t\t\t\t</span>\n\t\t\t\t<span class="lui-list__text menu-item-text"\n\t\t\t\t\t  q-translation="{{menuItem.text}}"\n\t\t\t\t\t  ng-class="{\'open-in-new-tab-text-optional\': menuItem.openInNewTab == \'optional\', \'open-in-new-tab-always\': menuItem.openInNewTab == \'always\'}" aria-hidden="true">\n\t\t\t\t</span>\n\t\t\t</button>\n\t\t\t<div class="list-divider" ng-if="menuItem.openInNewTab === \'optional\'"></div>\n\t\t\t<button ng-if="menuItem.openInNewTab" class="lui-fade-button"\n\t\t\t\t\tng-class="[quiModel.buttonClass, quiModel.buttonVariant]"\n\t\t\t\t\tq-title-translation="{{ menuItem.title || \'Tooltip.OpenInNewTab\'}}"\n\t\t\t\t\tng-click="selectMenuItem(menuItem, $event, \'true\')"\n\t\t\t\t\tng-disabled="menuItem.disable" tabindex="-1">\n\t\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--new-tab"></span>\n\t\t\t</button>\n\t\t</li>\n\t</ul>\n</lui-popover>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(471)],a=function(t,e){t.directive("qvMenuSwitch",function(){return{template:e,scope:{model:"=",callback:"&"},link:function t(e){e.switchValue=e.model.value;e.$watch("switchValue",function(t,n){void 0!==t&&t!==n&&e.callback()})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="menu-switch-component" tcl="switch" q-title-translation="{{ model.text }}">\n    <span ng-if="model.icon" class="lui-list__aside switch_icon">\n        <span class="lui-icon  lui-icon--{{model.icon}}" ng-disabled="model.disable"></span>\n    </span>\n    <span class="label" ng-disabled="readOnly">\n        <div class="title" q-translation="{{ model.text }}"></div>\n        <div class="value" q-translation="{{ model.label() }}"></div>\n    </span>\n    <lui-switch x-model="switchValue"/>\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(119),n(11),n(473),n(474),n(51),n(97)],a=function(t,e,n,i,a,s){var r={template:i,scope:{quiModel:"=",alignTo:"=",shared:"="},controller:["$scope",function(t){t.shared.destroyComponent=t.destroyComponent;t.menuClasses=t.quiModel.menuOptions.content.menuClasses?t.quiModel.menuOptions.content.menuClasses:"qui-textlist";t.quiModel.menuOptions.content.createMenuItems().then(function(e){t.menuItems=e});t.selectMenuItem=function(e,n,i){n&&n.preventDefault&&n.preventDefault();if(!e.disable){t.onClose&&t.onClose(n);e.selected(n,i)}};t.onClose=function(n){if(!e(n.target).hasClass("qui-popover-button")||t.quiModel.tid!==e(n.target).attr("tid")){t.destroyComponent();t.shared.pressed=false}};t.closeFromContent=function(){t.destroyComponent();t.shared.pressed=false};t.$on("$destroy",function(){s.off("start",t.onClose)});s.on("start",t.onClose)}]};t.directive("quiPopoverButton",function(){return{template:n,transclude:true,replace:true,restrict:"E",scope:{quiModel:"=",quiPopoverContainer:"=?"},controller:["$scope","$element",function(t,e){var n={ENTER:13,SPACE:32};t.shared={};t.shared.pressed=false;t.$watch("shared.pressed",function(e){t.currentTitle=e&&t.quiModel.tooltipActive?t.quiModel.tooltipActive:t.quiModel.tooltipInactive});e.on("keypress",function(e){e.keyCode!==n.ENTER&&e.keyCode!==n.SPACE||t.onClick()});t.onClick=function(){if(t.shared.pressed){if(t.shared.destroyComponent){t.shared.destroyComponent();t.shared.pressed=false}}else{t.shared.pressed=true;a.show(t.quiPopoverContainer||r,{quiModel:t.quiModel,alignTo:e,shared:t.shared})}};t.quiModel&&(t.quiModel.forceClick=t.onClick)}]}})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<button\n\t\ttid="{{quiModel.tid}}"\n\t\tng-disabled="quiModel.isDisabled()"\n\t\tng-class="[quiModel.buttonClass, quiModel.buttonVariant, {\'lui-active\': shared.pressed }]"\n\t\tq-title-translation="{{currentTitle}}"\n\t\tqva-outside-ignore-for="{{quiModel.tid}}"\n\t\tng-click="onClick()">\n\t<span ng-if="!quiModel.hideIcon" class="{{quiModel.buttonClass}}__icon lui-icon  lui-icon--{{quiModel.icon}}  {{quiModel.menuOptions.smallview ? \'lui-icon--large\' : \'\'}}"></span>\n\t<span class="{{quiModel.buttonClass}}__text" ng-if="quiModel.buttonText">\n\t\t{{quiModel.buttonText}}\n\t</span>\n\t<span ng-if="!quiModel.hideCaret" class="{{quiModel.buttonClass}}__caret  lui-caret"></span>\n</button>\n'},function(t,e){t.exports='<immidiate-contextual align-to="alignTo"\n\t\t\t\t\t  smallview="quiModel.menuOptions.smallview"\n\t\t\t\t\t  position="quiModel.menuOptions.position"\n\t\t\t\t\t  width="quiModel.menuOptions.width"\n\t\t\t\t\t  top="quiModel.menuOptions.top"\n\t\t\t\t\t  lui-style="true"\n\t\t\t\t\t  no-padding="true"\n\t\t\t\t\t  hidepointer="quiModel.menuOptions.hidepointer"\n\t\t\t\t\t\tqva-outside-ignore-for="{{quiModel.tid}}"\n\t\t\t\t\t  on-close-view="onClose(event)">\n\t<ul ng-class="menuClasses" tid="{{quiModel.menuOptions.content.tid}}">\n\t\t<li class="lui-list__item" ng-repeat="menuItem in menuItems" ng-disabled="menuItem.disable" qui-click=\'menuItem.fn()\'\n\t\t\tng-class="{\'open-in-new-tab-always\': menuItem.openInNewTab == \'always\'}" ng-hide="menuItem.hide">\n\t\t\t<span ng-if="menuItem.icon" class="lui-list__aside">\n\t\t\t\t<span class="lui-icon  lui-icon--{{menuItem.icon}}"></span>\n\t\t\t</span>\n\t\t\t<span class="lui-list__text menu-item-text"\n\t\t\t\t  tid="{{menuItem.tid}}"\n\t\t\t\t  q-title-translation="{{ menuItem.title || menuItem.text}}"\n\t\t\t\t  ng-class="{\'open-in-new-tab-text-optional\': menuItem.openInNewTab == \'optional\', \'open-in-new-tab-always\': menuItem.openInNewTab == \'always\'}"\n\t\t\t\t  qva-activate="selectMenuItem(menuItem, $event)" q-translation="{{menuItem.text}}" ng-disabled="menuItem.disable">\n\t\t\t</span>\n\t\t\t<div class="list-divider" ng-if="menuItem.openInNewTab === \'optional\'"></div>\n\t\t\t<button ng-if="menuItem.openInNewTab" class="lui-fade-button  open-in-new-tab" ng-class="{\'open-in-new-tab-always\': menuItem.openInNewTab == \'always\'}" q-title-translation="{{ menuItem.title || \'Tooltip.OpenInNewTab\'}}" qva-activate="selectMenuItem(menuItem, $event, \'true\')" ng-disabled="menuItem.disable">\n\t\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--new-tab"></span>\n\t\t\t</button>\n\t\t</li>\n\t</ul>\n</immidiate-contextual>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(49),n(476),n(477)],a=function(t,e,n,i,a){e.component("quiToolbar",{template:"<div class='qui-toolbar' ng-transclude />"});e.component("quiToolbarLeft",{template:"<div class='qui-buttonset-left' ng-transclude />"});e.component("quiToolbarRight",{template:"<div class='qui-buttonset-right' ng-transclude />"});e.component("quiToolbarButtonGroup",{template:"<div class='lui-buttongroup' ng-transclude />"});e.component("quiToolbarButton",{template:i,scope:{quiModel:"="},controller:["$scope",function(e){e.isMouseDown=false;e.onMouseDown=function(){e.isMouseDown=true};e.clientTabNavigation=n.getFlag("CLIENT_TAB_NAVIGATION");e.onButton=function(n){t.support.touch&&n.target.focus();e.quiModel.isToggleButton&&(e.quiModel.pressed=!e.quiModel.pressed);e.quiModel.isOpenedByClick=e.isMouseDown;e.isMouseDown=false;e.quiModel.onButtonClicked(e.quiModel,n)};function i(){var t=[];var n=e.quiModel;n.pressed?n.activeVariant?t.push(n.activeVariant):t.push("lui-active"):n.variant?t.push(n.variant):e.clientTabNavigation||t.push("lui-button--toolbar");e.classList=t}e.$watch("quiModel.pressed",i);e.$watch("quiModel.variant",i);e.$watch("quiModel.activeVariant",i);i()}]});e.component("quiToolbarMobileButton",{template:a,scope:{quiModel:"="},controller:["$scope",function(e){e.onButton=function(n){t.support.touch&&n.target.focus();e.quiModel.isToggleButton&&(e.quiModel.pressed=!e.quiModel.pressed);e.quiModel.onButtonClicked(e.quiModel,n)}}]})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<button\n\t\ttid="{{quiModel.tid}}"\n\t\tng-click="onButton($event)"\n\t\tng-mousedown="onMouseDown()"\n\t\tqva-outside-ignore-for="{{quiModel.name}}"\n\t\tq-title-translation="{{(quiModel.pressed && quiModel.tooltipActive ? quiModel.tooltipActive : quiModel.tooltipInactive)}}"\n\t\tng-disabled="quiModel.isDisabled()"\n\t\tng-hide="quiModel.isHidden()"\n\t\tclass="lui-button"\n\t\ttext-inactive="{{quiModel.textInactive ? quiModel.textInactive : \'\'}}"\n\t\tng-class="classList">\n\t<span\n\t\tqva-outside-ignore-for="{{quiModel.name}}"\n\t\tng-if="quiModel.icon && quiModel.iconToTheLeft"\n\t\tclass="lui-button__icon  lui-icon  lui-icon--{{quiModel.icon}} center"\n\t></span>\n\t<span\n\t\tqva-outside-ignore-for="{{quiModel.name}}"\n\t\tng-if="!quiModel.dynamicText && quiModel.showText()"\n\t\tclass="lui-button__text  item-title"\n\t\tqva-direction\n\t\tx-dir-text="{{(quiModel.pressed && quiModel.textActive ? quiModel.textActive : quiModel.textInactive) | translate}}"\n\t>\n\t\t{{(quiModel.pressed && quiModel.textActive ? quiModel.textActive : quiModel.textInactive) | translate}}\n\t</span>\n\t<span\n\t\tqva-outside-ignore-for="{{quiModel.name}}"\n\t\tng-if="quiModel.icon && !quiModel.iconToTheLeft"\n\t\tclass="lui-button__icon  lui-icon  lui-icon--{{quiModel.icon}} center"\n\t></span>\n\t<span\n\t\tqva-outside-ignore-for="{{quiModel.name}}"\n\t\tng-if="!quiModel.dynamicText && !quiModel.textOnly && quiModel.isDropdownButton"\n\t\tclass="lui-button__caret  lui-caret"\n\t></span>\n\t<span class="lui-button__text" qva-outside-ignore-for="{{quiModel.name}}" ng-if="quiModel.dynamicText">\n\t\t{{ quiModel.dynamicText() }}\n\t</span>\n</button>\n'},function(t,e){t.exports='<button\n\t\ttid="{{quiModel.tid}}"\n\t\tng-click="onButton($event)"\n\t\tqva-outside-ignore-for="{{quiModel.name}}"\n\t\tq-title-translation="{{(quiModel.pressed && quiModel.tooltipActive ? quiModel.tooltipActive : quiModel.tooltipInactive)}}"\n\t\tng-disabled="quiModel.isDisabled()"\n\t\tng-hide="quiModel.isHidden()"\n\t\tclass="lui-fade-button lui-fade-button--large lui-fade-button--inverse"\n\t\tng-class="{ \'lui-active\': quiModel.pressed }">\n\t<span qva-outside-ignore-for="{{quiModel.name}}" ng-if="!quiModel.dynamicText && quiModel.showText()"\n\t\tclass="lui-fade-button__text  item-title"\n\t\tqva-direction\n\t\tx-dir-text="{{(quiModel.pressed && quiModel.textActive ? quiModel.textActive : quiModel.textInactive) | translate}}">\n\t\t{{(quiModel.pressed && quiModel.textActive ? quiModel.textActive : quiModel.textInactive) | translate}}\n\t</span>\n\t<span\n\t\tqva-outside-ignore-for="{{quiModel.name}}"\n\t\tng-if="!quiModel.dynamicText && !quiModel.textOnly"\n\t\tclass="lui-fade-button__icon  lui-icon  lui-icon--large  lui-icon--{{quiModel.icon}}"></span>\n\t<span\n\t\tqva-outside-ignore-for="{{quiModel.name}}"\n\t\tclass="lui-fade-button__text"\n\t\tng-if="quiModel.dynamicText">{{ quiModel.dynamicText() }}</span>\n</button>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(91)],a=function(t){var e=[],n=[{tid:"Print.Ppt.Format.Standard",w:4,h:3},{tid:"Print.Ppt.Format.Widescreen",w:16,h:9},{tid:"Print.Ppt.Format.Widescreen",w:16,h:10},{tid:"Print.Ppt.Format.Custom"}];var i=function t(e,n){this.ratio=e||{};this.isCustom=n||false};i.prototype={toPixels:function t(e){var n=parseInt(e)||960;var i=n/this.ratio.w*this.ratio.h;return{w:Math.round(n),h:Math.round(i)}},setLabel:function e(){var n=this;t.ready.then(function(){var e=t.get(n.ratio.tid);n.label=e;n.ratio.w&&n.ratio.h&&(n.label+=" "+n.ratio.w+":"+n.ratio.h)})}};var a=n.length;for(var s=0;s<a;s++){var r=new i(n[s]);3===s&&(r.isCustom=true);e.push(r)}e.forEach(function(t){t.setLabel("portrait")});return{formats:e}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<lui-dialog id="print-dialog" tcl="print-image-settings">\n\t<lui-dialog-header>\n\t\t<lui-dialog-title q-translation="{{input.title}}"></lui-dialog-title>\n\t</lui-dialog-header>\n\t<lui-dialog-body class="print-dialog">\n\n\t\t<div class="section">\n\t\t\t<div class="lui-buttongroup">\n\t\t\t\t<button class="lui-button" tid="print-current-size" ng-class="{ \'lui-active\': ! imageCustomSize }" q-translation="Print.Image.CurrentSize" ng-click="onImageCustomSize(false)" ng-disabled="state === states.PENDING"></button>\n\t\t\t\t<button class="lui-button" tid="print-custom-size"  ng-class="{ \'lui-active\': imageCustomSize }" q-translation="Common.Custom" ng-click="onImageCustomSize(true)" ng-disabled="state === states.PENDING"></button>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="section" ng-show="! imageCustomSize">\n\t\t\t{{input.currentWidth}} x {{input.currentHeight}} px @ 96 dpi</span>\n\t\t</div>\n\n\t\t<div class="section" ng-show="imageCustomSize">\n\t\t\t<div class="section-title" q-translation="Print.Image.Width"></div>\n\t\t\t<div class="print-image">\n\t\t\t\t<qui-input-number\n\t\t\t\t\t\tqui-tid="print-image-width"\n\t\t\t\t\t\tqui-model="print.width" qui-disabled="state === states.PENDING" qui-min="0" qui-max="2000" qui-with-buttons="true"></qui-input-number>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="section" ng-show="imageCustomSize">\n\t\t\t<div class="section-title" q-translation="Print.Image.Height"></div>\n\t\t\t<div class="print-image">\n\t\t\t\t<qui-input-number\n\t\t\t\t\t\tqui-tid="print-image-height"\n\t\t\t\t\t\tqui-model="print.height" qui-disabled="state === states.PENDING" qui-min="0" qui-max="2000" qui-with-buttons="true"></qui-input-number>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="section" ng-show="imageCustomSize">\n\t\t\t<div class="section-title" q-translation="Print.Image.Dpi"></div>\n\t\t\t<div class="print-image">\n\t\t\t\t<qui-input-number\n\t\t\t\t\t\tqui-tid="print-image-dpi"\n\t\t\t\t\t\tqui-model="print.dpi" qui-disabled="state === states.PENDING" qui-min="0" qui-max="300" qui-with-buttons="true"></qui-input-number>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.Image.Format"></div>\n\t\t\t<div class="print-image">\n\t\t\t\t<div class="component-wrapper">\n\t\t\t\t\t<lui-select\n\t\t\t\t\t\t\tx-model="print.format"\n\t\t\t\t\t\t\tx-options="f as f for f in availableFormats"\n\t\t\t\t\t\t\tx-disabled="state === states.PENDING"\n\t\t\t\t\t\t\ttid="print-image-selected-format"></lui-select>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.PENDING" class="loading-screen">\n\t\t\t<div class="spinner">\n\t\t\t\t<div class="qv-loader"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.COMPLETED">\n\t\t\t<div class="section">\n\t\t\t\t<a ng-if="!usingReportingService" ng-href="{{printUrl}}" target="_blank" q-translation="Print.Image.CompletedLink"></a>\n\t\t\t\t<a ng-if="usingReportingService" ng-href="{{printUrl}}" target="_blank" q-translation="Print.Image.CompletedLink" download="{{printFileName}}"></a>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.TIMEOUT">\n\t\t\t<div class="section">\n\t\t\t\t<p class="dm-p" q-translation="Print.Failed.TimeoutMessage"></p>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.FAILED">\n\t\t\t<div class="section">\n\t\t\t\t<p class="dm-p" q-translation="Print.Failed.GenericMessage"></p>\n\t\t\t</div>\n\t\t</div>\n\t</lui-dialog-body>\n\n\t<lui-dialog-footer>\n\t\t<lui-button ng-click="$event.preventDefault(); close()" name="cancel" q-translation="Common.Cancel" tid="print-cancel"></lui-button>\n\t\t<lui-button ng-click="$event.preventDefault(); confirm(exportType)" name="confirm" autofocus q-translation="Print.Download" ng-disabled="state === states.PENDING" tid="print-export"></lui-button>\n\t</lui-dialog-footer>\n</lui-dialog>\n'},function(t,e){t.exports='<lui-dialog id="print-dialog" tcl="print-pdf-settings">\n\t<lui-dialog-header>\n\t\t<lui-dialog-title q-translation="{{input.title}}"></lui-dialog-title>\n\t</lui-dialog-header>\n\t<lui-dialog-body class="print-dialog">\n\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.PaperSize"></div>\n\t\t\t<div class="component-wrapper">\n\t\t\t\t<lui-select\n\t\t\t\t\t\ttid="print-paper-size"\n\t\t\t\t\t\tx-model="selectedSize"\n\t\t\t\t\t\tx-disabled="state === states.PENDING"\n\t\t\t\t\t\tx-options="size.label for size in sizes"\n\t\t\t\t\t\tx-change="onSizeChange(selectedSize)"\n\t\t\t\t\t\tx-disabled="state === states.PENDING">\n\t\t\t\t</lui-select>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.Image.Dpi"></div>\n\t\t\t<div class="print-image">\n\t\t\t\t<qui-input-number\n\t\t\t\t\t\tqui-tid="print-pdf-dpi"\n\t\t\t\t\t\tqui-model="print.dpi"\n\t\t\t\t\t\tqui-disabled="state === states.PENDING"\n\t\t\t\t\t\tqui-min="{{minDpi}}"\n\t\t\t\t\t\tqui-max="{{maxDpi}}"\n\t\t\t\t\t\tqui-with-buttons="true"></qui-input-number>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.Layout"></div>\n\t\t\t<div class="lui-buttongroup">\n\t\t\t\t<button class="lui-button"\n\t\t\t\t\t\ttid="print-orientation-portrait"\n\t\t\t\t\t\tng-class="{ \'lui-active\': \'portrait\' === selectedLayout.orientation }"\n\t\t\t\t\t\tq-translation="Print.Portrait"\n\t\t\t\t\t\tng-click="onPrintLayout(layouts[0])"\n\t\t\t\t\t\tng-disabled="state === states.PENDING"></button>\n\t\t\t\t<button class="lui-button"\n\t\t\t\t\t\tid="print-orientation-landscape"\n\t\t\t\t\t\tng-class="{ \'lui-active\': \'landscape\' === selectedLayout.orientation }"\n\t\t\t\t\t\tq-translation="Print.Landscape"\n\t\t\t\t\t\tng-click="onPrintLayout(layouts[1])"\n\t\t\t\t\t\tng-disabled="state === states.PENDING"></button>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.Layout.Aspect"></div>\n\t\t\t<lui-radiobutton class="print-dialog-radio-single"\n\t\t\t\t\t\t\t tid="print-aspect-current-size"\n\t\t\t\t\t\t\t x-name="print-aspect"\n\t\t\t\t\t\t\t x-model="print.fitCriteria"\n\t\t\t\t\t\t\t x-value="0"\n\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t x-disabled="state === states.PENDING">{{ \'Print.Layout.CurrentSize\' | translate }}</lui-radiobutton>\n\t\t\t<lui-radiobutton class="print-dialog-radio-single"\n\t\t\t\t\t\t\t tid="print-aspect-fit-page"\n\t\t\t\t\t\t\t x-name="print-aspect"\n\t\t\t\t\t\t\t x-model="print.fitCriteria"\n\t\t\t\t\t\t\t x-value="2"\n\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t x-disabled="state === states.PENDING">{{ \'Print.Layout.BestFitNoPreserveAspectRatio\' | translate }}</lui-radiobutton>\n\t\t</div>\n\t\t<div ng-if="state === states.PENDING" class="loading-screen">\n\t\t\t<div class="spinner">\n\t\t\t\t<div class="qv-loader"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.COMPLETED">\n\t\t\t<div class="section">\n\t\t\t\t<a ng-href="{{printUrl}}" target="_blank" q-translation="Print.Pdf.CompletedLink"></a>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.TIMEOUT">\n\t\t\t<div class="section">\n\t\t\t\t<p class="dm-p" q-translation="Print.Failed.TimeoutMessage"></p>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.FAILED">\n\t\t\t<div class="section">\n\t\t\t\t<p class="dm-p" q-translation="Print.Failed.GenericMessage"></p>\n\t\t\t</div>\n\t\t</div>\n\t</lui-dialog-body>\n\n\t<lui-dialog-footer>\n\t\t<lui-button ng-click="$event.preventDefault(); close()" name="cancel" q-translation="Common.Cancel" tid="print-cancel"></lui-button>\n\t\t<lui-button ng-click="$event.preventDefault(); confirm(exportType)" name="confirm" autofocus q-translation="Print.Download" ng-disabled="state === states.PENDING" tid="print-export"></lui-button>\n\t</lui-dialog-footer>\n</lui-dialog>\n'},function(t,e){t.exports='<lui-dialog id="print-dialog" tcl="print-ppt-settings">\n\t<lui-dialog-header>\n\t\t<lui-dialog-title q-translation="{{input.title}}"></lui-dialog-title>\n\t</lui-dialog-header>\n\t<lui-dialog-body class="print-dialog">\n\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.Ppt.Format"></div>\n\t\t\t<div class="component-wrapper">\n\t\t\t\t<lui-select\n\t\t\t\t\ttid="print-ppt-selected-size"\n\t\t\t\t\tx-model="selectedFormat"\n\t\t\t\t\tx-options="f.label for f in formats"\n\t\t\t\t\tx-change="onPptFormatChange(selectedFormat)">\n\t\t\t\t</lui-select>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="section" ng-show="selectedFormat.isCustom">\n\t\t\t<div class="section-title" q-translation="Print.Image.Width"></div>\n\t\t\t<qui-input-number\n\t\t\t\tqui-tid="print-ppt-width"\n\t\t\t\tqui-model="print.width" qui-min="0" qui-max="4000" qui-with-buttons="true"></qui-input-number>\n\t\t</div>\n\n\n\t\t<div class="section" ng-show="selectedFormat.isCustom">\n\t\t\t<div class="section-title" q-translation="Print.Image.Height"></div>\n\t\t\t<qui-input-number\n\t\t\t\tqui-tid="print-ppt-height"\n\t\t\t\tqui-model="print.height" qui-min="0" qui-max="4000" qui-with-buttons="true"></qui-input-number>\n\t\t</div>\n\n\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.Image.Dpi"></div>\n\t\t\t<div class="print-ppt-dpi">\n\t\t\t\t<div class="component-wrapper">\n\t\t\t\t\t<lui-select\n\t\t\t\t\t\ttid="print-ppt-dpi"\n\t\t\t\t\t\tx-model="print.dpi"\n\t\t\t\t\t\tx-options="d as d for d in availablePptDpi">\n\t\t\t\t\t</lui-select>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="section">\n\t\t\t{{print.width}} x {{print.height}} px @ {{print.dpi}} dpi\n\t\t</div>\n\t\t\x3c!--\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.Ppt.CurrentSlideSize"></div>\n\t\t\t<p>\n\t\t\t{{print.currentWidth}} x {{print.currentHeight}} px @ {{print.currentDpi}} dpi\n\t\t\t</p>\n\t\t</div>\n\t\t--\x3e\n\t\t<div ng-if="state === states.PENDING" class="loading-screen">\n\t\t\t<div class="spinner">\n\t\t\t\t<div class="qv-loader"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.COMPLETED">\n\t\t\t<div class="section">\n\t\t\t\t<a ng-href="{{printUrl}}" target="_blank" q-translation="Print.Ppt.CompletedLink"></a>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.TIMEOUT">\n\t\t\t<div class="section">\n\t\t\t\t<p class="dm-p" q-translation="Print.Failed.TimeoutMessage"></p>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.FAILED">\n\t\t\t<div class="section">\n\t\t\t\t<p class="dm-p" q-translation="Print.Failed.GenericMessage"></p>\n\t\t\t</div>\n\t\t</div>\n\t</lui-dialog-body>\n\n\t<lui-dialog-footer>\n\t\t<lui-button ng-click="$event.preventDefault(); close()" name="cancel" q-translation="Common.Cancel" tid="print-cancel"></lui-button>\n\t\t<lui-button ng-click="$event.preventDefault(); confirm(exportType)" name="confirm" autofocus q-translation="Print.Download" ng-disabled="state === states.PENDING"></lui-button>\n\t</lui-dialog-footer>\n</lui-dialog>\n'},function(t,e){t.exports='<lui-dialog id="print-dialog" tcl="print-pdf-settings">\n\t<lui-dialog-header>\n\t\t<lui-dialog-title q-translation="{{input.title}}"></lui-dialog-title>\n\t</lui-dialog-header>\n\t<lui-dialog-body class="print-dialog">\n\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.PaperSize"></div>\n\t\t\t<div class="component-wrapper">\n\t\t\t\t<lui-select\n\t\t\t\t\t\ttid="print-paper-size"\n\t\t\t\t\t\tx-model="selectedSize"\n\t\t\t\t\t\tx-disabled="state === states.PENDING"\n\t\t\t\t\t\tx-options="size.label for size in sizes"\n\t\t\t\t\t\tx-change="onSizeChange(selectedSize)"\n\t\t\t\t\t\tx-disabled="state === states.PENDING">\n\t\t\t\t</lui-select>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.Image.Dpi"></div>\n\t\t\t<div class="print-image">\n\t\t\t\t<qui-input-number\n\t\t\t\t\t\tqui-tid="print-pdf-dpi"\n\t\t\t\t\t\tqui-model="print.dpi"\n\t\t\t\t\t\tqui-disabled="state === states.PENDING"\n\t\t\t\t\t\tqui-min="0"\n\t\t\t\t\t\tqui-max="300"\n\t\t\t\t\t\tqui-with-buttons="true"></qui-input-number>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.Layout"></div>\n\t\t\t<div class="lui-buttongroup">\n\t\t\t\t<button class="lui-button"\n\t\t\t\t\t\ttid="print-orientation-portrait"\n\t\t\t\t\t\tng-class="{ \'lui-active\': \'portrait\' === selectedLayout.orientation }"\n\t\t\t\t\t\tq-translation="Print.Portrait"\n\t\t\t\t\t\tng-click="onPrintLayout(layouts[0])"\n\t\t\t\t\t\tng-disabled="state === states.PENDING"></button>\n\t\t\t\t<button class="lui-button"\n\t\t\t\t\t\tid="print-orientation-landscape"\n\t\t\t\t\t\tng-class="{ \'lui-active\': \'landscape\' === selectedLayout.orientation }"\n\t\t\t\t\t\tq-translation="Print.Landscape"\n\t\t\t\t\t\tng-click="onPrintLayout(layouts[1])"\n\t\t\t\t\t\tng-disabled="state === states.PENDING"></button>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.Layout.Aspect"></div>\n\t\t\t<lui-radiobutton class="print-dialog-radio-single"\n\t\t\t\t\t\t\t tid="print-aspect-current-size"\n\t\t\t\t\t\t\t x-name="print-aspect"\n\t\t\t\t\t\t\t x-model="print.fitCriteria"\n\t\t\t\t\t\t\t x-value="0"\n\t\t\t\t\t\t\t x-disabled="state === states.PENDING">{{ \'Print.Layout.CurrentSize\' | translate }}</lui-radiobutton>\n\t\t\t<lui-radiobutton class="print-dialog-radio-single"\n\t\t\t\t\t\t\t tid="print-aspect-fit-page"\n\t\t\t\t\t\t\t x-name="print-aspect"\n\t\t\t\t\t\t\t x-model="print.fitCriteria"\n\t\t\t\t\t\t\t x-value="2"\n\t\t\t\t\t\t\t x-disabled="state === states.PENDING">{{ \'Print.Layout.BestFitNoPreserveAspectRatio\' | translate }}</lui-radiobutton>\n\t\t</div>\n\t\t<div ng-if="state === states.PENDING" class="loading-screen">\n\t\t\t<div class="spinner">\n\t\t\t\t<div class="qv-loader"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.COMPLETED">\n\t\t\t<div class="section">\n\t\t\t\t<a ng-href="{{printUrl}}" target="_blank" q-translation="Print.Pdf.CompletedLink"></a>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.TIMEOUT">\n\t\t\t<div class="section">\n\t\t\t\t<p class="dm-p" q-translation="Print.Failed.TimeoutMessage"></p>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.FAILED">\n\t\t\t<div class="section">\n\t\t\t\t<p class="dm-p" q-translation="Print.Failed.GenericMessage"></p>\n\t\t\t</div>\n\t\t</div>\n\t</lui-dialog-body>\n\n\t<lui-dialog-footer>\n\t\t<lui-button ng-click="$event.preventDefault(); close()" name="cancel" q-translation="Common.Cancel" tid="print-cancel"></lui-button>\n\t\t<lui-button ng-click="$event.preventDefault(); confirm(exportType)" name="confirm" autofocus q-translation="Print.Download" ng-disabled="state === states.PENDING" tid="print-export"></lui-button>\n\t</lui-dialog-footer>\n</lui-dialog>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(160),n(101),n(385)],a=function(t,e,n){var i=["scatterplot","map"],a=["map"];return{baseColor:{isSupported:function t(e){return e&&e.length&&-1===i.indexOf(e)},isDimSupported:function t(e){return e&&e.length&&-1!==a.indexOf(e)}},colorBy:{},colorByUpdater:function t(e,n,i,a){this.updateColorDef(e,a,i);this.updateHypercubeAttributes(e,n,i)},updateColorDef:function i(a,s,r){var o=e.getValue(r,"mode");var c=e.getValue(r,"auto");var d=e.getValue(a,s+"qDimensions",[]);var p=e.getValue(a,s+"qMeasures",[]);var h,f,g,v;if(!c&&"byDimension"===o&&d.length){h=e.getValue(r,"byDimDef");h&&u(r,h.label);if(h&&h.activeDimensionIndex>-1){h.activeDimensionIndex=Math.min(h.activeDimensionIndex,d.length-1);f=d[h.activeDimensionIndex];v=n.getColorByDefinition("dimension",false,f);v.activeDimensionIndex=h.activeDimensionIndex;l(r,v)}else if(!h||!h.key){f=d[d.length-1];g=t.getById(f.qAttributeDimensions,t.IDMAP.COLOR_BY_ALTERNATIVE);l(r,n.getColorByDefinition("dimension",!!g,g||f))}}else if(!c&&"byMeasure"===o&&d.length){h=e.getValue(r,"byMeasureDef");h&&u(r,h.label);if((!h||!h.key)&&p.length){var m=p[0];f=d[d.length-1];g=t.getById(f.qAttributeExpressions,t.IDMAP.COLOR_BY_ALTERNATIVE);l(r,n.getColorByDefinition("measure",!!g,g||m))}}else"byMultiple"===o&&p.length<2&&e.setValue(r,"mode","primary")},updateHypercubeAttributes:function t(n,i,a){var r=e.getValue(a,"mode");var o=e.getValue(a,"auto");var l=e.getValue(n,i+"qDimensions",[]);var u=e.getValue(n,i+"qMeasures",[]);var d=e.getValue(n,i+"qLayoutExclude.qHyperCubeDef.qDimensions",[]);!o&&"byDimension"===r&&l.length?c(a,true,l,d,u,e.getValue(a,"byDimDef.label")):!o&&"byMeasure"===r&&l.length?c(a,false,l,d,u,e.getValue(a,"byMeasureDef.label")):s(l,d)},setColorByPropertyDef:l,resolveColorByPropertyDef:c,clearColorByItem:s};function s(e,n){e.forEach(function(e){r(e,t.IDMAP.COLOR_BY_ALTERNATIVE,"qAttributeDimensions");r(e,t.IDMAP.COLOR_BY_ALTERNATIVE,"qAttributeExpressions")});n.forEach(function(e){r(e,t.IDMAP.COLOR_BY_ALTERNATIVE,"qAttributeDimensions");r(e,t.IDMAP.COLOR_BY_ALTERNATIVE,"qAttributeExpressions")})}function r(e,n,i){if(e[i]){var a=t.getIndexById(e[i],n);a>=0&&e[i].splice(a,1)}else e[i]=[]}function o(t){return t.split(" ").length>1&&"="!==t[0]&&"["!==t[0]?"["+t+"]":t}function l(t,e,n,i){var a=n?"expression":e.type,s=t.mode,r=e.label||e.name||"";u(t,r);switch(a){case"field":s="byDimension";t.byDimDef={label:e.label||o(e.name),key:o(e.name),type:"expression",activeDimensionIndex:e.activeDimensionIndex};break;case"expression":s="byMeasure";t.byMeasureDef={label:n||e.label||e.name,key:n||e.name,type:"expression"};break;case"dimension":s="byDimension";t.byDimDef={label:e.name,key:e.id,type:"libraryItem",activeDimensionIndex:e.activeDimensionIndex};break;case"measure":s="byMeasure";t.byMeasureDef={label:e.name,key:e.id,type:"libraryItem"};break}if(!i){t.auto=false;t.mode=s}}function c(n,i,a,r,o,l){s(a,r);var c=a[a.length-1];if(c){var u=i?e.getValue(n,"byDimDef"):e.getValue(n,"byMeasureDef");if(u){var d=t.create(t.IDMAP.COLOR_BY_ALTERNATIVE);switch(u.type){case"expression":d.label=l||u.label;i?d.qDef=u.key:d.qExpression=u.key;break;case"libraryItem":if(!i){var p=-1;o.forEach(function(t,e){u.key===t.qLibraryId&&(p=e)});d.matchMeasure=p}d.qLibraryId=u.key;d.colorMapRef=u.key;break}if(i){d.qSortBy={qSortByAscii:1};c.qAttributeDimensions.push(d)}else c.qAttributeExpressions.push(d)}}}function u(t,e){if(!e)return;var n="="===e.charAt(0);t.altLabel=n?{qStringExpression:{qExpr:e.substr(1)}}:e}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(138),n(485),n(105),n(91)],a=function(t,e,n,i,a){t.directive("circleChart",function(){return{scope:{model:"="},restrict:"E",replace:true,template:n,controller:["$scope","$element","$timeout",function(t,n,s){var r=n.find(".circular-bar");t.radius=50;t.arcValue="M50 0 A 50 50, 0, 0, 1, 0 0, L 50 50 z";function o(){if(p()){var e=r.height();var n=r.width();if(e<n){t.radius=e/2;t.svgPos={height:e,width:e,top:0,left:n/2-e/2}}else{t.radius=n/2;t.svgPos={height:n,width:n,top:e/2-n/2,left:0}}}d()}function l(t,e,n,i){var a=(i-90)*Math.PI/180;return{x:t+n*Math.cos(a),y:e+n*Math.sin(a)}}function c(t,e,n,i,a){var s=l(t,e,n,a);var r=l(t,e,n,i);var o=a-i<=180?"0":"1";var c=["M",s.x,s.y,"A",n,n,0,o,0,r.x,r.y].join(" ");return c}function u(t){return 3.6*t}function d(){var n=0;if(t.model.chartValue)n=t.model.chartValue;else if(t.model.numerator&&t.model.denominator){n=0===t.model.denominator?0:t.model.numerator/t.model.denominator;n*=100}if(n>0&&n<1){var i=e.format.number(0,{style:"percent"});t.chartPercentageValue=a.get("CircleChart.ChartPercentageValue.LessThanOne",i)}else t.chartPercentageValue=e.format.number(Math.round(n)/100,{style:"percent"});var s=t.radius;var r=8;var o=0;if(t.model.chartValueSubText){r=-3;o=17}t.percentagePos={x:s,y:s+r};t.subtextPos={x:s,y:s+o};var l=100===n?99.99:n,d=l;d||(d=0);t.arcValue=c(s,s,s-5,0,u(d))}function p(){return r.height()>0||r.width()>0}t.$on(i.Events.EditorDetailsPane.ResizeChart,function(){o()});t.$watch("model",function(){d()});p()?o():s(function(){o()})}]}})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="ds-visualization-circle-chart">\n\t<div class="chart-heading">{{ model.header }}</div>\n\n\t<div class="circular-bar">\n\t\t<svg version="1.1" xmlns="http://www.w3.org/2000/svg" ng-style="svgPos">\n\t\t\t<g class="arcs">\n\t\t\t\t<circle ng-attr-cx="{{radius}}" ng-attr-cy="{{radius}}" ng-attr-r="{{radius}}" class="outer-circle" />\n\t\t\t\t <path ng-attr-d="{{arcValue}}" class="outer-arc" tid="circle-chart-arc1" /> \n\t\t\t\t<circle ng-attr-cx="{{radius}}" ng-attr-cy="{{radius}}" ng-attr-r="{{radius - 10}}" class="inner-circle"  />\n\t\t\t</g>\n\t\t\t<text ng-attr-x="{{percentagePos.x}}" ng-attr-y="{{percentagePos.y}}" class="percentage-label">{{ chartPercentageValue }}</text>\n\t\t\t<text ng-attr-x="{{subtextPos.x}}" ng-attr-y="{{subtextPos.y}}" class="percentage-subtext-label">{{ model.chartValueSubText }}</text>\n\t\t</svg>\n\t</div>\n\n\t<div class="chart-footer">{{ model.footer }}</div>\n</div>\n\n'},,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(238),n(90)],a=function(t){var e=t.extend({getDimensions:function t(){return[]},getMeasures:function t(){return[]}});return e}.apply(e,i),void 0!==a&&(t.exports=a))},,function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(91),n(94),n(969),n(207),n(99),n(97),n(133),n(236),n(509),n(192),n(287),n(510),n(274)],a=function(t,e,n,i,a,s,r,o,l,c,u,d){function p(t){return{odagLinkItem:function e(n){var a=n.item.getDropOption();var s={insertBeforeItem:t,title:a.args.init.linkRef.name,odagLinkRefID:a.args.init.linkRef.id};var r=i.model;l.addODAGNavPoint(r,s)}}}function h(e,n){function i(t,e,n){var i=p(e);var a={targetRect:n,drawRect:n,drop:i,dropShadePercentage:10};t.registerDropRect(a)}var a;var s={accept:{odagLinkItem:function t(){return true}},end:function t(){n.removeClass(a);e.dragging=false},start:function s(r){e.dragging=true;var o;try{o=n[0].getBoundingClientRect()}catch(t){return}var l={left:o.left+2,right:o.right-2,top:o.top+2,bottom:o.bottom-2};a="odagLinkItem"===r.info.type?"dragging library-dragging":"dragging";n.addClass(a);var c=n.find(".dropArea");for(var u=0;u<c.length;u++){var d=t(c[u]);var p=d[0].getBoundingClientRect();var h={left:p.left+2,right:p.right-2,top:p.top+2,bottom:p.bottom-2};var f=null;var g=e.odagNavPoints;u<g.items.length&&(f=g.items[u]);i(r,f,h)}var v=n.find(".odag-nav-point-cell:last");var m={left:0,right:0,top:0,bottom:0};var b=l.left;if(v.length){m=v[0].getBoundingClientRect();b=m.right}var y={left:b,top:l.top,right:l.right,bottom:l.bottom};i(r,null,y)}};c.registerDropTarget(s);e.$on("$destroy",function(){c.unregisterDropTarget(s)})}var f={template:a,restrict:"E",scope:{model:"=",inEditMode:"=",standAlone:"="},link:function t(e,n){h(e,n)},controller:["$scope","$timeout","$element","qvSheetService",function(t,e,a,c){t.sortableNavPoints=null;var p=t.standAlone?null:c;t.odagToolbarService=new u(p);t.dragging=false;t.waterMarkText="";var h=null;l.isODAGAvailable(t.model.app).then(function(e){e&&d.getList().then(function(e){e.layout&&e.layout.qAppObjectList&&e.layout.qAppObjectList.qItems.length>0&&l.getODAGLinks(t.model.app)})});t.sortableNavPoints=s.create({options:{direction:"horizontal",listKey:"list",listSelector:".list",itemKey:"item",itemSelector:".drag-odag-navpoint",itemDragSelector:".drag-odag-navpoint",gesture:{name:"swipe",options:{radiusThreshold:r.treatAsDesktop()?4:0,preventDefault:false}}},allowDrag:function e(){var e=this._super.apply(this,arguments);return e&&t.inEditMode},addPlaceholder:function t(){this._super.apply(this,arguments)},onBegin:function t(e){this._super.apply(this,arguments);h=e;h.classList=["reordering"];var n=a.find(".list");n.css("height",n.innerHeight())},removePlaceholder:function t(){this._super.apply(this,arguments);var e=a.find(".list");e.css("height","");h.classList=""},onMove:function e(){this._super.apply(this,arguments);var n=t.odagNavPoints.get().map(function(t){return t.data});var a=i.model;l.reorderNavPoints(a,n)}});t.odagNavPoints=t.sortableNavPoints.createList(1,{tid:"odagNavPoints"});t.$watchCollection("odagToolbarService.getOdagNavPoints()",function(n){t.odagNavPoints.reset();for(var i=0;i<n.length;i++)t.odagNavPoints.addSortableItem(n[i]);e(function(){t.$broadcast("refreshPager")})});t.$watch("model.sheetId",function(e){t.odagToolbarService.sheetChanged(e)});t.$watch("dragging",function(e){t.waterMarkText=e?n.get("odag.toolbar.help.dragging"):n.get("odag.toolbar.help.watermark")});t.odagToolbarService.init(t.model.app,t.model.openAppCallback).then(function(){t.waterMarkText=n.get("odag.toolbar.help.watermark")});o.on("end",function(){t.refreshPager(false)});t.$on("$destroy",function(){t.odagToolbarService.destroy()})}]};e.directive("qvOdagToolbar",function(){return f});return f}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(89),n(49),n(970),n(131),n(120),n(375),n(133),n(192),n(219)],a=function(t,e,n,i,a,s,r,o,l){function c(t){this.qvSheetService=t;this.currentApp=null;this.currentSheet=null;this.odagNavPoints=null;this.appLinkModelList=null;this.openAppCallback=null}c.prototype.init=function(t,e){var n=this;this.odagNavPoints=[];this.currentApp=t;this.openAppCallback=e;return o.getList(t).then(function(t){n.appLinkModelList=t;return t.getLayout().then(function(){n.updateNavPoints();t.Invalidated.bind(n.updateNavPoints.bind(n))})})};c.prototype.sheetChanged=function(t){var e=this;this.currentSheet&&this.currentSheet.Invalidated.unbind(this.updateNavPoints);t&&a.get(t,this.currentApp).then(function(t){e.currentSheet=t;if(e.currentSheet){e.updateNavPoints();e.currentSheet.Invalidated.bind(e.updateNavPoints.bind(e))}})};c.prototype.getODAGLinkInfo=function(n){var i=new t;if(n._cachedLinkProps)i.resolve(n._cachedLinkProps);else if(n.data.odagLinkRefID)l.getList(n.model.parent.app).then(function(t){if(t.filter(function(t){return t.properties.data.id===n.data.odagLinkRefID}).length>0)r.loadODAGLink(n.model.parent.app,n.data.odagLinkRefID).then(function(t){var a=e.getFlag("ODAG_SAAS_ENABLED")?t:t.objectDef;if(!t||"decommissioned"!==a){n.invalid=false;n.maxNumberOfApps=a.properties.genAppLimit[0].limit;n.maxRowExpressionCount=a.properties.rowEstRange[0].highBound;n._cachedLinkProps=a;return i.resolve(a)}n.invalid=true;i.resolve(null)},function t(){n.invalid=true;i.resolve(null)});else{n.invalid=true;i.resolve(null)}});else{n.invalid=true;i.resolve(null)}return i.promise};c.prototype.createODAGNavPointsList=function(e){var a=i.selectedObject?i.selectedObject:null;var o=null;var l=this;if(void 0!==e){this.odagNavPoints.splice(0,this.odagNavPoints.length);e.forEach(function(e){var c={id:e.info.id,type:"ODAGNavPoint",object:{isInvalid:true},data:e,openAppCallback:l.openAppCallback,model:null,maxRowExpressionCount:null,maxNumberOfApps:null,_cachedLinkProps:null,invalid:false,initialized:null};var u={parent:l.currentSheet,properties:e};c.model=new n(u);c.getLoadedLinkInfo=l.getODAGLinkInfo;c.getCurrentCountSessionObjectForLink=function(){return this.getLoadedLinkInfo(c).then(function(e){return e?r.getOrCreateSessionObjectsForLink(l.currentApp,e).then(function(t){return t}):t.resolve(null)})};l.odagNavPoints.push(c);if(a&&a.id===e.info.id&&!r.addingNewNavPointID[l.currentSheet.id]){o=c;i.setSelectedObject(s.createSelectedObjFromNavPoint(c))}});if(r.addingNewNavPointID[this.currentSheet.id]){var c=this.odagNavPoints.filter(function(t){return t.data.info.id===r.addingNewNavPointID[l.currentSheet.id]});if(c.length){i.setSelectedObject(s.createSelectedObjFromNavPoint(c[0]));o=c[0]}r.addingNewNavPointID[this.currentSheet.id]=null}this.qvSheetService&&a&&"ODAGNavPoint"===a.type&&!o&&this.qvSheetService.setSheetAsSelectedObj()}};c.prototype.updateNavPoints=function(){var t=this;if(this.currentApp&&this.currentSheet)return r.clearCachedSessionObjects(this.currentApp).then(function(){t.currentSheet.getNavPoints().then(function(e){t.createODAGNavPointsList(e)})})};c.prototype.hasODAGNavPoints=function(){return this.odagNavPoints.length>0};c.prototype.destroy=function(){this.odagNavPoints=[];this.appLinkModelList.Invalidated.unbind(this.updateNavPoints);this.currentSheet.Invalidated.unbind(this.updateNavPoints)};c.prototype.getOdagNavPoints=function(){return this.odagNavPoints};return c}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(89),n(131),n(135),n(972),n(97),n(973),n(90),n(375),n(274),n(980)],a=function(t,e,n,i,a,s,r,o,l){var c={template:a,restrict:"E",replace:true,scope:{inEditMode:"=",inMobileMode:"=",item:"="},controller:["$scope","$timeout","$element","luiPopover",function(t,a,c,u){t.popover=null;t.stageState=n;t.$watch("stageState.selectedObject",function(e){t.selObject=e});var d=null;t.rowCountPercentage=0;function p(){if(t.popover){t.popover.close();return}var e={item:t.item};if(e.item.openAppCallback){var n=e.item.openAppCallback;e.item.openAppCallback=function(e,i){t.popover.close();n(e,i)}}var i=r;var a={input:e,dock:"top",alignTo:c[0],closeOnResize:true};i=o.extend(true,a,i);t.popover=u.show(i);t.popover.closed.then(function(){t.popover=null})}function h(){t.popover&&t.popover.close();return}function f(){var n=new e;if(d){var s=t.item;d.getLayout().then(function(e){s.actualRowEst=e.MaxRowCountExpression;i.isSuffixInUse("noData")&&(s.actualRowEst="NaN");var n=s.maxRowExpressionCount;var r=100*Math.min(n/s.actualRowEst,1);if(r>=100)if(100!==t.rowCountPercentage){t.rowCountPercentage=99;a(function(){t.rowCountPercentage=100;s.rowCountPercentage=100;s.rowCountPercentageNumber=100},300)}else s.rowCountPercentage=100;else{s.rowCountPercentage=r;t.rowCountPercentage=r}"number"===typeof s.rowCountPercentage&&Number.isNaN(+s.rowCountPercentage)?s.rowCountPercentageNumber=-1:s.rowCountPercentageNumber=s.rowCountPercentage}).finally(function(){n.resolve()})}else n.reject();return n.promise}function g(){t.item.getCurrentCountSessionObjectForLink().then(function(e){d=e;d&&d.Invalidated.bind(f);f().finally(function(){t.item.initialized.resolve()})})}t.$watchCollection("item",function(t,n){if(null!==n&&null===t.initialized){t.initialized=new e;g()}});s.on("end",h);t.onODAGNavPointClicked=function(e){if(t.inMobileMode)return;t.inEditMode?n.setSelectedObject(l.createSelectedObjFromNavPoint(e)):t.item.invalid||p(e)};t.deleteInvalidNavPoint=function(t,e){e.model.removeObject()};a(function(){t.$broadcast("refreshPager")});t.$on("$destroy",function(){d&&d.Invalidated.unbind(f)})}]};t.directive("qvOdagToolbarNavpoint",function(){return c});return c}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(246),n(326)],a=function(t,e){var n,i={AUTO:"U",INTEGER:"I",NUMBER:"R",FIXED_TO:"F",MONEY:"M",DATE:"D",TIME:"T",DATE_TIME:"TS",INTERVAL:"IV"};n=t.extend("QFormatter",{init:function n(a,s,r,o,l){var c=a||{};this.localeInfo=c;this.pattern=s||"";this.decimalDelimiter="string"===typeof o?o:"string"===typeof c.qDecimalSep?c.qDecimalSep:".";this.thousandDelimiter="string"===typeof r?r:"string"===typeof c.qThousandSep&&this.decimalDelimiter!==c.qThousandSep?c.qThousandSep:"";this.type=l||i.AUTO;l===i.AUTO&&(this.pattern="#"+this.decimalDelimiter+"##A");this._numberFormatter=new t(a);this._dateFormatter=new e(a);this.prepare()},clone:function t(){return new n(this.localeInfo,this.pattern,this.thousandDelimiter,this.decimalDelimiter,this.type)},prepare:function t(e,n,a){e||(e=this.pattern);if(!e)switch(this.type){case i.INTEGER:e="##############";break;case i.NUMBER:e=Array(this.localeInfo.qnDec||11).join("#");break;case i.FIXED_TO:e="#"+this.localeInfo.qDecimalSep||false;break;case i.MONEY:e=this.localeInfo.qMoneyFmt;a||(a=this.localeInfo.qMoneyDecimalSep||".");n||a===this.localeInfo.qMoneyThousandSep||(n=this.localeInfo.qMoneyThousandSep);break;case i.DATE:e=this.localeInfo.qDateFmt||"YYYY-MM-DD";break;case i.DATE_TIME:e=this.localeInfo.qTimestampFmt||"YYYY-MM-DD hh:mm:ss";break;case i.TIME:case i.INTERVAL:e=this.localeInfo.qTimeFmt||"hh:mm:ss";break;default:e="##########";break}this._numberFormatter.pattern=this.pattern;this._dateFormatter.pattern=this.pattern;this._numberFormatter.thousandDelimiter=this.thousandDelimiter;this._numberFormatter.decimalDelimiter=this.decimalDelimiter;this._numberFormatter.type=this.type;this._numberFormatter.prepare(e,n,a);this._prepared={pattern:e,t:n,d:a}},formatValue:function t(e,n){var a,s=this._prepared;if("NaN"===e||"number"===typeof e&&Number.isNaN(+e))return"-";if(Number.isNaN(+e)||"number"!==typeof e)return e+"";switch(this.type){case i.DATE:case i.TIME:case i.DATE_TIME:a=new Date(1899,11,30+Math.floor(e),0,0,86400*(e-Math.floor(e)));if(Number.isNaN(+a.getTime()))return this._numberFormatter.format(e,"0",s.t,s.d);return this._dateFormatter.format(a,n||s.pattern);case i.INTERVAL:return this._dateFormatter.format(e,s.pattern);default:return this._numberFormatter.formatValue(e)}},format:function t(e,n,i,a){if("NaN"===e||"number"===typeof e&&Number.isNaN(+e))return"-";if(Number.isNaN(+e)||"number"!==typeof e)return e+"";this.prepare(n,i,a);return this.formatValue(e)},createPatternFromRange:function t(e,n,i){var a="",s,r=Number(Number(e).toExponential().split("e")[1]),o=Number(Number(n).toExponential().split("e")[1]),l=Math.min(Math.abs(r),Math.abs(o)),c=Math.abs(n-e),u,d=Number(Number(c/50).toExponential().split("e")[1]),p;p=Math.abs(d);if(0===c)return"0"+this.decimalDelimiter+"##"+(i?"A":"");if(d>=0)p=i?Math.max(2,l-d):0;else{u=(i?l-l%3:0)*(o<0?1:-1);p-=u}this.thousandDelimiter?a+="#"+this.thousandDelimiter+"##0":a+="0";if(p){a+=this.decimalDelimiter;for(s=0;s<p;s++)a+="#"}return a+(i?"A":"")}});n.getSignificantIntegers=function(t){return a(t)};n.getSignificantDecimals=function(t){return s(t)};function a(t){if(Number.isNaN(+t)||!Number.isFinite(+t))return 1;var e=Number(t).toExponential(),n=e.split("e"),i=1;"+"===n[1][0]&&(i+=Number(n[1]));return i}function s(t){if(Number.isNaN(+t)||!Number.isFinite(+t))return 0;var e=Number(t).toExponential(),n=e.split("e"),i=0,a;if("-"===n[1][0]){i=Math.abs(Number(n[1]));n=n[0].split(".");n[1]&&(i+=n[1].length)}else{a=Number(n[1]);n=n[0].split(".");i=n[1]?n[1].length-a:0}return i}return n}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(91),n(92),n(89),n(1464),n(1465),n(1467),n(1468),n(1227),n(1469),n(1470),n(1297),n(160),n(252),n(100),n(195),n(1471),n(90),n(130)],a=function(t,e,n,i,a,s,r,o,l,c,u,d,p,h,f,g,v,m){var b,y="auto",S="qualitative",x="primary",q="expression",I="measure",C="auto",w="primary",D="dimension",M="measure",T="expression",A="dim_master",P="meas_master",k="error",E="first",_="last",F=-3,$=-2;var N=f.baseColor;function O(t){var e=-Number.MAX_VALUE,n=Number.MAX_VALUE,i=true;t.forEach(function(t){if(!Number.isNaN(+t.elemValue)){e=Math.max(t.elemValue,e);n=Math.min(t.elemValue,n);i=false}});return{min:i?0:n,max:i?10:e}}function L(t){if(!t||!t.length)return 0;t=t.filter(function(t){return"N"===t.qType});if(1===t.length&&"V"!==t[0].qSubNodes[0].qType)return 1+L(t[0].qSubNodes);return 0}function R(t,e,n,i){var a=t.auto;var s=t.dimensionID;if(!a&&u.isByNthDimension(t))return t.byDimDef.activeDimensionIndex;var r=0,o=Array.isArray(e),l=o?e.length:1,c;if(s&&!a)for(r;r<l;++r){c=o?e[r].cId:e.cId;if(c===s)return r}var d=i.qStackedDataPages&&i.qStackedDataPages.length&&i.qStackedDataPages[0].qData&&i.qStackedDataPages[0].qData.length?i.qStackedDataPages[0].qData[0].qSubNodes:null;return n===E?L(d):l-1}function H(t,e,n,i,a){if(e===D)return t||n.qDimensionInfo.length>1||a&&n.qSize.qcy>i.qArea.qHeight;if(e===M)return"K"===n.qMode||n.qSize.qcy>i.qMatrix.length;return false}function G(t,e,n){var i=0;if(0===n){while(t&&t.parent)t=t.parent;return t}while(e){if(t.getDimensions().length-1===n)return t;if(t.getDimensions().length-1-i===n)return e;e=e.parent;i++}}function j(t,e,n){n=Array.isArray(n)?n:[n];var i=t.qHyperCube.qMeasureInfo,a=-1!==n.indexOf(F)||-1!==n.indexOf($);return!a&&N.isSupported(t.visualization)&&!!g.getBaseColor(i[e])}function V(t,e){e=Array.isArray(e)?e:[e];var n=-1!==e.indexOf(F)||-1!==e.indexOf($),i=t.qHyperCube.qDimensionInfo.filter(function(t){return!!g.getBaseColor(t)}).length>0;return!n&&i}function z(t){return g.getBaseColor(t.filter(function(t){return!!g.getBaseColor(t)})[0])}function B(){return{dimIndex:0,wrangled:[],valid:false,legendMode:{}}}function U(t,e){if(!e.enigmaModel||!t.colorMapRef)return n.when(t.qFallbackTitle);return e.enigmaModel.getMeasureList().then(function(e){var n=m.findLibraryMeasure(t.colorMapRef,e);return n.qData.labelExpression?n.qData.labelExpression:n.qData.title})}function K(t,e){if(!e.enigmaModel||!t.colorMapRef)return n.when(t.qFallbackTitle);return e.enigmaModel.getDimensionList().then(function(e){var n=m.findLibraryDimension(t.colorMapRef,e);return n.qData.labelExpression?n.qData.labelExpression:n.qData.title})}function W(t){return t.qFallbackTitle&&"="===t.qFallbackTitle.charAt(0)?t.qFallbackTitle.substr(1):t.qFallbackTitle}b=e.extend({init:function t(e,n){e=e||{};this._app=n;this._autoMode=e.autoMode||C;this._multiDimScheme=e.multiDimScheme||_;this._qualitativeMap=new s(null,e);this._sequentialMap=new a(null,e,n);this._legendDataProvider=new i;this._legendDataProvider.setColorMap(this);this._specialColorMap=new l;this._dimValsMap=new c(n);this._enableAltMode=true;this._colorDataInfo=B();this._title="DEBUG"},getColor:function t(e,n,i,a){var s=this._specialColorMap.getColor(e,a);if(s)return s;if(this._colorDataInfo.internalMode===D&&this._colorDataInfo.useDimColVal)return p.retriveColor(this._dimValsMap.getColor(a));if(this._colorDataInfo.internalMode===k)return this._qualitativeMap.getColor($);if(this._colorMode===I||this._colorMode===q)return this._sequentialMap.getColor(e,a,i,n);if(this._colorDataInfo.internalMode===P&&j(this._data,i,e))return p.retriveColor(h.resolveColor(g.getBaseColor(this._data.qHyperCube.qMeasureInfo[i])));if(this._colorDataInfo.internalMode===A&&V(this._data,e))return p.retriveColor(h.resolveColor(z(this._data.qHyperCube.qDimensionInfo)));return this._qualitativeMap.getColor(e,a,i,n)},getColorScale:function t(){return this._qualitativeMap},getColorFromPreScaledValue:function t(e,n){if(this._colorMode===I||this._colorMode===q)return this._sequentialMap.getColorFromPreScaledValue(e);var i=this._specialColorMap.getColor(e);if(i)return i;if(this._colorDataInfo.internalMode===D&&this._colorDataInfo.useDimColVal)return p.retriveColor(this._dimValsMap.getColorFromPreScaledValue(e,n));return this._qualitativeMap.getColorFromPreScaledValue(e)},getTooltipContent:function e(n,i){var a=null,s,o,l,c,u;if(this._colorDataInfo.valid){if(this._colorMode===q){s=this._sequentialMap.getExpressionValue(void 0===i?n.row:i);o=s;if(void 0!==s){this._sequentialMap.getValueFormatter&&(l=this._sequentialMap.getValueFormatter())&&(s=l.formatValue(s));a={label:this.getLegendTitle(),template:r.createLegendTemplate(s,this._sequentialMap.getColor(n.id,void 0===i?n.row:i,0,s)),num:o}}}if(this._colorDataInfo.altMode){var d=true;if("dimension"===this._colorDataInfo.internalMode){var p=n._attrDims[this._colorDataInfo.attrIndex];if(!p)return;if(n.id===F){u=n.id===F?t.get("properties.dimensionLimits.others"):p.label?p.label:"";c=this.getColorFromPreScaledValue(F)}else if(p.value===$){u=p.value===$?"-":p.label?p.label:"";c=this.getColorFromPreScaledValue($)}else{u=p.label?p.label:"";c=this.getColorFromPreScaledValue(p.value);d=!c.isInvalid()}}else if("measure"===this._colorDataInfo.internalMode){s=void 0!==i?this._colorDataInfo.wrangled[i].elemValue:n.values[this._colorDataInfo.legendMode.rangeSelectionIndex];o=s;d=void 0!==s;u=this._sequentialMap.getGenericFormatter&&(l=this._sequentialMap.getGenericFormatter())?l.formatValue(s):s;c=this.getColorFromPreScaledValue(s)}d&&(a={label:this.getLegendTitle(),value:u+"",num:o,template:r.createLegendTemplate(u,c)})}else if("dimension"===this._colorDataInfo.internalMode){var h=n.getDimensions();var f=h[h.length-this._colorDataInfo.dimIndex-1];if(!f)return;u=f;var g=G(n,n,this._colorDataInfo.dimIndex);c=this.getColorFromPreScaledValue(g.id);c.isInvalid()||(a={label:this.getLegendTitle(),template:r.createLegendTemplate(u,c)})}}return a},getColorMapping:function t(){return this._legendDataProvider.getColorMapping()},generateScaleBasedMapping:function t(){return this._sequentialMap.generateScaleBasedMapping()},getSelectionIndices:function t(){return this.getDimensionIndex()},getLegendTitle:function t(){return this._colorMode===I||this._colorMode===q?this._sequentialMap.getLegendTitle():this._qualitativeMap.getLegendTitle()},getDimensionIndex:function t(){return this._colorMode===I?[0]:[this._qualitativeMap.getDimensionIndex()]},setData:function t(e,i){if(this.released)return n.reject();var a=this;var s=[];this._colorMode=S;this._data=e;this._colorDataInfo=B();var r=B();var l=n.resolve();var c;var p;var f;var m;var b;if(e.color){c=e.color;var E=e.qHyperCube;var _="";if(!E)return n.resolve().then(Y);_=e.qInfo&&e.qInfo.qType?e.qInfo.qType:i;r.internalMode=g.determineInternalMode(c.auto?C:c.mode||C,this._autoMode,E,c.useBaseColors,_);r.useDimColVal=c.useDimColVal||c.auto&&r.internalMode===D;r.useMeasureGradient=c.useMeasureGradient||c.auto&&r.internalMode===M;m=this._data.qHyperCube.qDimensionInfo.length-1;var F=this._data.qHyperCube.qDataPages[0]||this._data.qHyperCube.qStackedDataPages[0]||{qArea:{qHeight:0},qMatrix:[]};b=e.qHyperCube.qDimensionInfo[m];var N=e.qHyperCube.qMeasureInfo[0];var L=m;var G=m;p=-1;var j;if(r.internalMode===D){p=d.getIndexById(b.qAttrDimInfo,d.IDMAP.COLOR_BY_ALTERNATIVE);f=-1!==p?b.qAttrDimInfo[p]:null;j="qAttrDims";if(u.useFallback(f,c)){p=-1;f=null}}else if(r.internalMode===M){p=d.getIndexById(b.qAttrExprInfo,d.IDMAP.COLOR_BY_ALTERNATIVE);f=-1!==p?b.qAttrExprInfo[p]:null;j="qAttrExps"}r.altMode=this._enableAltMode&&!!f&&m>=0&&p>=-1;var V=!r.altMode&&r.internalMode===M&&!N;r.valid=(r.altMode&&f&&!f.qError||!r.altMode&&!!b)&&!V;if(!r.valid){r.internalMode=k;r.allNaN=true;return n.resolve().then(Y)}r.dimIndex=m;r.attrIndex=p;r.hasOthers=!!e.qHyperCube.qHasOtherValues;r.othersLabels=e.qHyperCube.qDimensionInfo.map(function(t){return t.othersLabel});r.activeDimensionIndex=v.getValue(e,"color.byDimDef.activeDimensionIndex");r.persistentColors=H(c.persistent,r.internalMode,E,F,r.altMode);r.top=F.qArea.qTop;r.attrInfo=f;if(r.altMode)if(r.internalMode===M){r.minMax={min:f.qMin||0,max:f.qMax||10};r.matchingDataMeasure=f.matchMeasure;r.dimSize=false===c.autoMinMax?b.qCardinal:e.qHyperCube.qSize.qcy;e.color.byMeasureDef&&"libraryItem"===e.color.byMeasureDef.type?l=l.then(function(){return U(f,a._app).then(function(t){r.legendTitle=t})}):e.color.altLabel?r.legendTitle=e.color.altLabel:r.legendTitle=W(f)}else if(r.internalMode===D){r.dimSize=r.persistentColors?f.qCardinal:f.qSize.qcy;e.color.byDimDef&&"libraryItem"===e.color.byDimDef.type?l=l.then(function(){return K(f,a._app).then(function(t){r.legendTitle=t})}):e.color.altLabel?r.legendTitle=e.color.altLabel:r.legendTitle=W(f)}else r.legendTitle=f.label||f.qFallbackTitle;else if(r.internalMode===M){L=m+1;r.minMax=Number.isNaN(+N.qMin)||Number.isNaN(+N.qMax)?null:{min:N.qMin||0,max:N.qMax||10};r.legendTitle=N.qFallbackTitle;r.dimSize=false===c.autoMinMax?b.qCardinal:e.qHyperCube.qSize.qcy}else if(r.internalMode===D){m=R(c,E.qDimensionInfo,this._multiDimScheme,E);L=m;r.dimIndex=m;b=e.qHyperCube.qDimensionInfo[m];r.legendTitle=b.qFallbackTitle;r.dimSize=r.persistentColors?b.qCardinal:e.qHyperCube.qSize.qcy}else r.internalMode===T&&(r.dimSize=false===c.autoMinMax?b.qCardinal:e.qHyperCube.qSize.qcy);if(r.internalMode===M||r.internalMode===D){r.wrangled=o.wrangleData(e.qHyperCube,p,L,!(!r.altMode||!r.valid)&&j,r.internalMode===D,G);r.allNaN=r.altMode&&0===r.wrangled.filter(function(t){return r.internalMode===D?t.elemValue!==$&&!Number.isNaN(+t.elemValue):!Number.isNaN(+t.elemValue)}).length}r.internalMode!==M||r.persistentColors||(r.minMax=O(r.wrangled));if(e.color.auto)this._colorMode=y;else switch(r.internalMode){case M:this._colorMode=I;break;case T:this._colorMode=q;break;case w:this._colorMode=x;break}r.dimensionScheme=e.color.dimensionScheme;r.internalMode!==P&&r.internalMode!==A||(r.dimensionScheme=h.dataPalettes[0].propertyValue);var z;l.then(function(){if(a._colorMode===I||a._colorMode===q)s.push(n.resolve(a._sequentialMap.setData(e,r,a._snapshotChartData)).then(function(){z=a._sequentialMap.getLegendMode();Q(z)}));else{a._qualitativeMap.setData(e,r);z=a._qualitativeMap.getLegendMode();Q(z)}})}function Q(t){var n;n=r.internalMode===P&&1===a._data.qHyperCube.qMeasureInfo.length||r.internalMode===A&&1===a._data.qHyperCube.qDimensionInfo.length?w:t[2];r.legendMode={discrete:"scale"!==t[0],boxType:t[1],colorMode:n,selectionEnabled:!t[3],altMode:r.altMode,rangeSelectionIndex:r.altMode?a._data.qHyperCube.qMeasureInfo.length:0};if(r.altMode&&r.internalMode===D&&r.valid&&"dimension"===r.legendMode.colorMode){r.legendPath="/qHyperCubeDef/qDimensions/"+m+"/qAttributeDimensions/"+p;r.legendPages=[{qTop:0,qLeft:0,qWidth:2,qHeight:3e3}];r.altLocked=f.qLocked}a._legendDataProvider.setData(e)}function Y(){a._colorDataInfo=r;return a._colorDataInfo}return l.then(function(){if(r.internalMode===D&&r.useDimColVal)return a._dimValsMap.setData(c,r,b,a._snapshotChartData).then(function(t){a._specialColorMap.setProperties(r,t);t?r.persistentColors=true:r.useDimColVal=false;return Y()});a._specialColorMap.setProperties(r);return n.all(s).then(Y)})},hasAttributeDimension:function t(){return this._colorDataInfo.altMode&&!!this._colorDataInfo.legendPath},getAttributeDimensionInfo:function t(){return this.hasAttributeDimension()?[this._colorDataInfo.attrInfo]:[]},getColorDataInfo:function t(){return this._colorDataInfo},setAltModeEnabled:function t(e){this._enableAltMode=e},setMeasureFormatters:function t(e){this._measureFormatters=e;this._sequentialMap&&this._sequentialMap.setMeasureFormatters(e)},setGenericFormatter:function t(e){this._sequentialMap&&this._sequentialMap.setGenericFormatter(e)},getValueFormatter:function t(){return this._sequentialMap.getValueFormatter()},setDimensionTree:function t(e){this._dimensionTree=e;this._legendDataProvider&&this._legendDataProvider.setDimensionTree(e)},getLegendDataProvider:function t(){return this._legendDataProvider},setSnapshotChartData:function t(e){this._snapshotChartData=e},getSnapshotChartData:function t(){var e=[];var n=this._dimValsMap.getDimValsData();n&&e.push({key:"dimValsData",data:n});var i=this._sequentialMap&&this._sequentialMap._measureGradient?this._sequentialMap._measureGradient:null;i&&e.push({key:"measureGradient",data:i});return e},release:function t(){this._qualitativeMap.release&&this._qualitativeMap.release();this._sequentialMap.release&&this._sequentialMap.release();this._legendDataProvider.release&&this._legendDataProvider.release();this._dimensionTree=null;this._legendDataProvider=null;this._sequentialMap=null;this._qualitativeMap=null;this.released=true}});Object.defineProperties(b.prototype,{mode:{get:function t(){return this._colorMode}}});Object.defineProperties(b,{AUTO:{value:y,writable:false},PRIMARY:{value:x,writable:false},MEASURE:{value:I,writable:false},EXPRESSION:{value:q,writable:false},QUALITATIVE:{value:S,writable:false},DIMENSION:{value:D,writable:false}});Object.defineProperties(b.prototype,{AUTO:{value:y,writable:false},PRIMARY:{value:x,writable:false},MEASURE:{value:I,writable:false},EXPRESSION:{value:q,writable:false},QUALITATIVE:{value:S,writable:false},DIMENSION:{value:D,writable:false}});return b}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){t.exports='<lui-tooltip ng-style="style">\n\t{{item}}\n</lui-tooltip>'},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(834),n(99),n(112),n(92),n(144),n(89),n(97),n(148),n(124),n(96),n(142),n(49),n(157),n(95),n(93),n(108),n(155),n(176),n(835),n(837),n(175)],a=function(t,e,n,i,a,s,r,o,l,c,u,d,p,h,f,g,v,m,b){var y=".globalSelections",S=s.extend({init:function e(n,a){var s=this;var r=m.inClient();this.$scope=n;this.callbacks=[];this.ignoreUpdates=false;this.hasLoaded=false;n.dimensions=[];n.dimensionsFields=[];n.selectedFields=[];n.fields=[];n.dimAvailable=false;n.showFields=a.getShowFields(n.app);n.showFieldsCheckbox=true;n.filter="";n.autoFocus=i.treatAsDesktop();n.selectionToolbarOpen=false;n.showNoMatches=false;n.disableSelectionInsights=false;n.selInsightsEnabled=h.getFlag("SELECTION_INSIGHTS")&&r;function l(){var t=new o;c.isRunning().then(function(){t.resolve(true)},function(){t.resolve(false)});return t.promise}var c;if(r){c=new b;var u=localStorage.getItem("qv-global-selections-settings");v.getApp().then(function(t){l().then(function(e){f.load(t).then(function(){!f.isVariableDefined("DISABLE_SELECTION_INSIGHTS")&&e||(n.disableSelectionInsights=true);u&&!JSON.parse(u).open?n.showInsights=false:n.showInsights=true})})})}n.handleEscape=function(t){if(n.filter&&n.filter.length>0){n.filter="";t.stopImmediatePropagation();t.preventDefault()}else a.off()};function d(){localStorage.setItem("qv-global-selections-settings",JSON.stringify({open:n.showInsights}))}n.showInsightsPanel=function(){n.showInsights=true;d();g.publish("selection/insights/show")};var p=function t(){n.showInsights=false;d();localStorage.setItem("qv-global-selections-settings",JSON.stringify({open:n.showInsights}))};g.subscribe("selection/insights/close",p);n.$on("$destroy",function(){g.unsubscribe("selection/insights/close",p)});o.all({fields:this.getFields(),select:this.bindCurrentSelections(),dim:this.getLibraryDimensions(),reg:this.registerExtensions()}).then(function(){s.hasLoaded=true;n.showFieldsCheckbox=n.fields.length>0;n.dimAvailable=n.dimensions.length>0;if(!n.dimAvailable&&n.showFieldsCheckbox){n.showFields=true;a.setShowFields(n.showFields,n.app)}n.$watch("filter",function(){s.filterShown(s,s.$scope)});n.$watch("showFields",function(){a.setShowFields(n.showFields,n.app);s.filterShown(s,s.$scope)});t(".qv-gs-section .qv-gs-header")[1].style.display="none";t(".qv-gs-section .qv-gs-header")[1].offsetHeight;t(".qv-gs-section .qv-gs-header")[1].style.display="block"})},registerExtensions:function t(){var e=new o;u.load().then(function(){e.resolve()});return e.promise},getFields:function t(){var e=this.$scope;return e.app.getFieldList().then(function(t){e.fields=r.expand(t).map(function(t){return{title:t.qName,qField:t.qName,qTags:t.qTags}})})},_updateCurrentSelectionFields:function t(e){var n=this,i=this.$scope;i.selectedFields=e.qSelectionObject.qSelections.filter(function(t){return!t.qIsHidden}).sort(p.sortSelections).map(function(t){return{title:t.qReadableName||t.qField,qField:t.qField,enableBadge:true}});n.hasLoaded&&n.filterShown(n,i)},handleCurrentSelectionFields:function t(){var e=this;this.$scope.currentSelectionsModel.getLayout().then(function(t){e._updateCurrentSelectionFields(t)})},bindCurrentSelections:function t(){var e=this.$scope,n=this;return n.$scope.app.getCurrentSelectionObject().then(function(t){e.currentSelectionsModel=t;n.subscription=t.layoutSubscribe(function(t){if(e.app.isInModalSelection())return;n._updateCurrentSelectionFields(t)})})},getLibraryDimensions:function t(){var e=this.isCalculatedField,n=this.$scope;return n.app.getDimensionList().then(function(t){n.dimensions=t.filter(function(t){return t.qData.info.length>0&&!t.qData.info.some(e)&&"H"!==t.qData.grouping}).map(function(t){return{title:t.qData.labelExpression||t.qData.title,fieldName:t.qData.info[0].qName,qId:t.qInfo.qId}})})},isCalculatedField:function t(e){return"="===e.qName[0]},filterShown:function t(n,i){var s="",r=[];i.dimensionsFields=i.dimensions.filter(function(t){return!i.selectedFields.some(function(e){return t.fieldName===e.qField})});if(i.showFields){r=i.fields.filter(function(t){return!i.selectedFields.some(function(e){return e.qField===t.qField})});r=c.removeMeasureAndDetailsFields(r);i.dimensionsFields=i.dimensionsFields.concat(r.filter(function(t){return!i.dimensions.some(function(e){return t.qField===e.fieldName})}))}if(i.filter.length>0){s=i.filter.toLowerCase();r=i.dimensionsFields.filter(function(t){return-1!==t.title.toLowerCase().indexOf(s)});i.dimensionsFields=r}a.localeOrderBy(i.dimensionsFields,function(t){return t.title});i.showNoMatches=0===i.dimensionsFields.length&&!this.ignoreUpdates&&i.filter.length>0;e.$apply(i,function(){n.notifyCallbacks(n)})},addCallback:function t(e,n){this.callbacks.push({type:e,fn:n})},notifyCallbacks:function t(e){if(!e.hasLoaded)return;if(e.ignoreUpdates)return;e.callbacks.forEach(function(t){"fields"!==t.type&&"dimensions"!==t.type||t.fn()})},setIgnoreUpdates:function t(e){this.ignoreUpdates=e}});S.$inject=["$scope","qvGlobalSelectionsService"];e.directive("qvGlobalSelections",["$document","qvSelectionToolbarService","$timeout",function(e,i,a){return{restrict:"E",template:n,controller:S,require:["qvGlobalSelections"],scope:{app:"="},replace:true,link:function n(s,r,o,c){s.toolbar=!!e.find(".qui-toolbar,.qs-toolbar")[0];var u=c[0],f=function t(){u.ignoreUpdates=false},g=function t(){s.selectionToolbarOpen=false;a(function(){u.handleCurrentSelectionFields()})},v=function t(){s.selectionToolbarOpen=true};i.Closed.bind(g);i.Opened.bind(v);e.on("keyup"+y,function(t){27===t.which?u.ignoreUpdates=false:13===t.which&&(u.ignoreUpdates=false)});h.getFlag("ALT_STATE_ONE")&&p.getSelectionStates(s.app).then(function(t){t.splice("$",1);s.hasStatesOtherThanDefault=t.length>0});d(e[0].body).tap({id:y,options:{preventDefault:false},start:function e(n){var i=t(n.target).closest(".qv-gs-badge").length>0,a=t(n.target).closest(".qv-gs-listbox").length>0,s=t(n.target).closest(".qv-selection-toolbar").length>0;u.ignoreUpdates=a&&!i&&!s}});l.on("start",f);s.$on("$destroy",function(){u.callbacks=[];i.Closed.unbind(g);i.Opened.unbind(v);d(e[0].body).off("*",y);e.off(y);l.off("start",f);u.subscription&&u.subscription.dispose()});s.onEnter=function(t){t.stopPropagation();t.target.blur()}}}}]);return'<qv-global-selections app="app"></qv-global-selections>'}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="qv-global-selections" ng-class="{\'toolbar\': toolbar, \'selection-toolbar-open\': selectionToolbarOpen, \'insights-active\': showInsights && selInsightsEnabled }">\n\t<div class="qv-gs-sections">\n\t<section class="qv-gs-section qv-gs-top" tid="globalSelections.topSection" ng-class="{\'qv-gs-section-margin\' : showInsights && !disableSelectionInsights}">\n\t\t<header class="qv-gs-header">\n\t\t\t<h2 ng-if="!hasStatesOtherThanDefault" q-translation="GlobalSelections.CurrentSelections"></h2>\n\t\t\t<h2 ng-if="hasStatesOtherThanDefault" q-translation="GlobalSelections.CurrentSelections.Default"></h2>\n\t\t\t<div class="show-insights-btn" ng-show="selInsightsEnabled && !showInsights && !disableSelectionInsights">\n\t\t\t\t<button tid="explore-selections-button" class="lui-button show-insights--button" ng-click="showInsightsPanel()">\n\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--lightbulb"></span><span class="lui-button__text"  q-translation="ExploreSelections.ExploreSelectionsBtn"></span>\n\t\t\t\t</button></div>\n\t\t</header>\n\t\t<div class="qv-gs-no-selections" ng-if="selectedFields.length == 0">\n\t\t\t<div class="qv-gs-no-selections-content">\n\t\t\t\t<div class="qv-qs-no-selections-image"></div>\n\t\t\t\t<div class="qv-qs-no-selections-title" q-translation="GlobalSelections.NoSelections"></div>\n\t\t\t\t<div class="qv-qs-no-selections-body" q-translation="GlobalSelections.NoSelectionsBody"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div qv-global-select-section="{ itemSize: 220, itemSpacing: 20, type: \'fields\' }" all-items="selectedFields" app="app"></div>\n\t</section>\n\n\t<section class="qv-gs-section" tid="globalSelections.bottomSection" ng-class="{\'qv-gs-section-margin\' : showInsights && !disableSelectionInsights}">\n\t\t<header class="qv-gs-header">\n\t\t\t<h2 q-translation="GlobalSelections.AppDimensions"></h2>\n\t\t\t<lui-checkbox class="global-show-fields-checkbox" x-model="showFields" title="{{\'GlobalSelections.ShowFields\'|translate}}" tid="globalSelections.showFields">{{\'GlobalSelections.ShowFields\'|translate}}</lui-checkbox>\n\t\t\t<lui-search  class="qv-gs-searchfield" placeholder="{{showFields ? \'GlobalSelections.FilterDimensionsAndFields\' : \'GlobalSelections.FilterDimensions\'}}" query="filter" maxlength="255"\n\t\t\t\t\t\t\t tid="globalSelections.searchField" on-escape="handleEscape($event)" auto-focus="autoFocus" on-enter="onEnter($event)"></lui-search>\n\t\t</header>\n\n\t\t<div class="qv-gs-info" ng-if="!dimAvailable && !showFields">\n\t\t\t<h2 q-translation="GlobalSelections.DimensionsWarning"></h2>\n\t\t</div>\n\t\t<div class="qv-gs-info" ng-if="showNoMatches">\n\t\t\t<h2 q-translation="GlobalSelections.NoMatchesForSearch"></h2>\n\t\t</div>\n\t\t<div qv-global-select-section="{ itemSize: 220, itemSpacing: 20, type: \'dimensions\'}" all-items="dimensionsFields" filter="filter" app="app"></div>\n\n\t</section>\n\t</div>\n\n\t<div tid="selection-insights-container" class="qv-insights-container" ng-if="selInsightsEnabled && showInsights && !disableSelectionInsights">\n\t\t<qv-selection-insights show-fields="showFields"></qv-selection-insights>\n\t</div>\n</div>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(836),n(92),n(141),n(153),n(97),n(89),n(206),n(179),n(270),n(11),n(90),n(104),n(251),n(114),n(99),n(176),n(244)],a=function(t,e,n,i,a,s,r,o,l,c,u,d,p,h,f,g){function v(t,e){while(t.length>e)t.pop()}var m=c.extend({init:function t(){this.resetColumnIndex();this._super.apply(this,arguments)},resetColumnIndex:function t(){this.columnIndex=0},setList:function t(e){this.list=e;this.scrollApi.setTotalRows(this.list.length);this.setItems(this.columnIndex,this.scrollApi.settings.blockSize);this.scrollApi.updateLoadingButtons()},onInitialNativeScroll:function t(){return r.resolve()},onGotoNextBlock:function t(){var e=this._super.apply(this,arguments).then(function(){this.columnIndex=this.getFirstElementIndex()}.bind(this));return e},onGotoPreviousBlock:function t(){var e=this._super.apply(this,arguments).then(function(){this.columnIndex=this.getFirstElementIndex()}.bind(this));return e}}),b=l.extend({resetNativeScroll:function t(){this.$scrollArea.scrollLeft(0)},alignToFirstRow:function t(){var e=this.getFirstRow(),n=e.children(".qv-object-wrapper").attr("id"),i=260;return function(){var t=u(this.$scrollArea.find("#"+n)),e;if(t.length>0){e=t.offset().left-i;this.$scrollArea.scrollLeft(e)}}.bind(this)},alignToLastRow:function t(){var e=this.getLastRow(),n=e.children(".qv-object-wrapper").attr("id"),i=250;return function(){var t=u(this.$scrollArea.find("#"+n)),e;if(t.length>0){this.$scrollArea.scrollLeft(0);e=t.parent().position().left-this.getScrollAreaBoundingBox().width+t[0].getBoundingClientRect().width+i;this.$scrollArea.scrollLeft(e)}}.bind(this)},getBoundingBox:function t(){var e=this._super.apply(this,arguments);return new p(e.top,e.left,e.height,e.width)}}),y=n.extend({size:{width:0,height:0},itemSize:0,itemSpacing:0,$element:void 0,init:function t(e,n,i){this.$scope=e;this.$timeout=n;this.selectionToolbarService=i;this.$scope.items=[];this.$scope.options={direction:f.direction}},initialize:function t(e,n,i){this.setSize(n);this.setItemSize(i.itemSize);this.setItemSpacing(i.itemSpacing);this.setElement(e.find(".qv-gs-scroll-area"));this.setItems();this.initialized=true},updateVisible:function t(){var e=this.offsetX-(this.$scope.scrollApi.loadPrevious?1:0),n=this.visibleItemsCount;this.$scope.items.forEach(function(t,i){var a=i>=e&&i<e+n;!t.visible&&a&&(t.options={isPopOver:false,highlightTitle:true,direction:f.direction});a&&!t.model&&this.getModel(t).then(function(t,e){t.model=e}.bind(null,t));t.visible=a},this)},getModel:function t(e){var n=this.getInitProps(e.title),a;e.qField?a=i.createTransientField(this.$scope.app,e.qField,n):e.qId&&(a=i.createTransientDimension(this.$scope.app,e.qId,n));return a},onScroll:function t(){this.qvGlobalSelectionsCtrl.setIgnoreUpdates(false);this.selectionToolbarService.confirm();this.updateHighlights();this.$timeout.cancel(this.scrollTimeout);this.scrollTimeout=this.$timeout(function(){this.updateVisible();this.updateHighlights()}.bind(this),100)},onResize:function t(e){this.setSize(e);this.updateVisible()},updateHighlights:function t(){this.$scope.items.forEach(function(t){t.options.highlightQuery=this.$scope.filter},this)},setItems:function t(){var e,n,i,a=this.$scope,s=this.totalItemsCount;a.items.length!==s&&v(a.items,s);for(e=0;e<s;e++){n=a.items[e]||{};i=a.scrollApi.items[e];i.enableBadge&&(n.enableBadge=i.enableBadge);n.model||(n.options={isPopOver:false,highlightTitle:true,direction:f.direction});if(i.qField){delete n.qId;if(!n.model||n.qField!==i.qField){if(n.visible){a.items[e]=d.extend(true,{},n);n=a.items[e];delete n.$$hashKey;delete n.options.search}n.title=i.title;n.qField=i.qField;n.id=h.sha256(n.qField);delete n.model}}else if(i.qId){delete n.qField;if(!n.model||n.qId!==i.qId){if(n.visible){a.items[e]=d.extend(true,{},n);n=a.items[e];delete n.$$hashKey;delete n.options.search}n.title=i.title;n.qId=i.qId;n.id=h.sha256(n.qId);delete n.model}}a.items[e]||(a.items[e]=n)}this.updateVisible()},getInitProps:function t(e){var n={title:e,qListObjectDef:{qDef:{}}};a.autoSortDimension(n.qListObjectDef);return n},getWidthOf:function t(e){return this.totalItemSize*e-this.itemSpacing},setItemSize:function t(e){this.itemSize=e||220},setItemSpacing:function t(e){this.itemSpacing=e||20},setSize:function t(e){this.size=e},setElement:function t(e){this.$element=e;this.$element.on("scroll",this.onScroll.bind(this))}});Object.defineProperties(y.prototype,{vPosX:{get:function t(){return this.$element.scrollLeft()}},totalItemSize:{get:function t(){return this.itemSize+this.itemSpacing}},visibleItemsCount:{get:function t(){var e=Math.ceil(((this.vPosX+(this.previousBtnVisible?240:0))%this.totalItemSize+this.size.width)/this.totalItemSize);return Math.min(e,this.totalItemsCount+(this.previousBtnVisible?1:0))}},totalItemsCount:{get:function t(){return(this.$scope.scrollApi.items||[]).length}},offsetX:{get:function t(){return Math.floor(this.vPosX/this.totalItemSize)}},previousBtnVisible:{get:function t(){return!!this.$scope.scrollApi.loadPrevious}}});y.$inject=["$scope","$timeout","qvSelectionToolbarService"];t.directive("qvGlobalSelectSection",["$parse","$timeout",function(t,n){return{controller:y,require:["qvGlobalSelectSection","^qvGlobalSelections"],template:e,replace:true,scope:{allItems:"=",filter:"=",app:"="},link:function e(i,a,r,l){var c=l[0],u=l[1],d=t(r.qvGlobalSelectSection)(),p={},h=a.find(".qv-gs-scroll-area"),f=h.controller("qvScrollArea"),v=a.find(".qv-scroll-loader").controller("qvScrollLoader"),y={blockSize:24,minRowHeight:240,maxRowHeight:240,keepItemsCount:4,virtualScrollEnabled:false},S=new o(n,y),x=new m(S),q=new b(a,h,".qv-gs-listbox",".qv-gs-listbox:first",".qv-gs-listbox:last"),I=null,C=function t(){p.width=a.innerWidth();p.height=a.innerHeight();c.onResize(p)};i.scrollApi=S;c.qvGlobalSelectionsCtrl=u;S.initialize(q,x,f,v).then(function(){S.activate();S.updateViewport();i.$watch("filter",function(){x.resetColumnIndex();S.resetNativeScroll()});i.$watch("allItems",function(t){if(!t)return;x.setList(t);I&&I();I=i.$watch("scrollApi.items",function(){var e=!g.treatAsDesktop();if(u.ignoreUpdates&&!e)return;if(0===S.items.length&&i.allItems.length>0){S.resetNativeScroll();x.resetColumnIndex();x.setList(t)}c.initialized&&c.setItems()})})}).catch(function(t){false});n(function(){p.width=a.innerWidth();p.height=a.innerHeight();c.initialize(a,p,d)});s.on("end",C);i.$on("$destroy",function(){s.off("end",C);S.destroy()});u.addCallback(d.type,function(){c.$timeout(function(){c.setItems();c.$timeout(function(){c.updateHighlights()})})})}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="qv-gs-scroll-container">\n\t<qv-scroll-area class="qv-gs-scroll-area">\n\t\t<div ng-if="scrollApi.loadPrevious" class="qv-gs-scroll-btn qv-gs-scroll-btn-previous" tid="globalSelections.loadPrevious">\n\t\t\t<qv-scroll-load-button tag="div" class="qv-listbox-load-buttons" on-load="scrollApi.gotoPreviousBlock()" text="Object.Listbox.LoadPrevious" previous="true"></qv-scroll-load-button>\n\t\t</div>\n\t\t<div ng-repeat="item in items" class="qv-gs-listbox">\n\t\t\t<qv-object ng-if="item.visible" model="item.model" options="item.options" object="item.object" class="qv-object-listbox" id="{{item.id}}"></qv-object>\n\t\t\t<div ng-if="!item.visible" class="qv-object qv-object-listbox qv-gs-placeholder" id="{{item.id}}">\n\t\t\t\t<h1 class="qv-object-title" qva-direction x-dir-text="{{item.title}}">\n\t\t\t\t\t<span class="qv-object-title-text" qva-direction x-dir-text="{{item.title}}">{{item.title}}</span>\n\t\t\t\t</h1>\n\t\t\t\t<div class="progress">\n\t\t\t\t\t<qv-rain></qv-rain>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<p ng-if="item.qField" q-title-translation="Common.Field" tid="globalSelections.fieldIndicator" class="qv-gs-field-indicator" qva-direction>\n\t\t\t\t<span class="lui-icon  lui-icon--field"></span>\n\t\t\t</p>\n\t\t\t<qv-gs-badge></qv-gs-badge>\n\t\t</div>\n\t\t<div ng-if="scrollApi.loadNext" class="qv-gs-scroll-btn" tid="globalSelections.loadNext">\n\t\t\t<qv-scroll-load-button tag="div" class="qv-listbox-load-buttons" on-load="scrollApi.gotoNextBlock()" text="Object.Listbox.LoadMore"></qv-scroll-load-button>\n\t\t</div>\n\t</qv-scroll-area>\n\t<qv-scroll-loader tag="li" class="qv-scroll-row-loader"></qv-scroll-loader>\n</div>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(838),n(288)],a=function(t,e,n){function i(e,n){var i=n[2];t.$apply(t.$rootScope,function(){e.item.showBadge=(void 0===n[0]||false===n[0])&&false===n[1]&&!i})}t.directive("qvGsBadge",function(){return{restrict:"E",template:e,replace:true,link:function t(e){if(e.item.enableBadge){e.item.object||(e.item.object={});e.$watchCollection("[item.model.layout.qListObject.qDimensionInfo.qLocked, item.object.selectionsApi.active, item.object.model.layout.qListObject.qDimensionInfo.qIsOneAndOnlyOne]",function(t){i(e,t)});e.badgeClick=function(t){var e=new n(t.model);return e.beginSelections().then(function(){return e.clearSelections().then(function(){return e.endSelections(true)})})}}}}})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="qv-gs-badge" ng-if="item.showBadge" q-title-translation="Tooltip.clearSelection" tid="globalSelections.badge" ng-click="badgeClick(item)">\n\t<span class="lui-icon lui-icon--remove"></span>\n</div>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(840),n(132),n(134),n(154),n(112),n(89),n(93),n(106),n(141),n(148),n(184),n(142),n(95),n(105),n(49),n(175),n(841),n(843),n(271),n(240),n(289)],a=function(t,e,n,i,a,s,r,o,l,c,u,d,p,h,f,g){function v(e,n){var i="",a=[];e.selectables=n.dimensions.filter(function(t){return!e.selectedFields.some(function(e){return t.qField===e.qField})});if(true===e.filter.showFields){a=n.fields.filter(function(t){return!e.selectedFields.some(function(e){return e.qField===t.qField})});a=u.removeMeasureAndDetailsFields(a);e.selectables=e.selectables.concat(a.filter(function(t){return!n.dimensions.some(function(e){return t.qField===e.qField})}))}if(e.filter.filter.length>0){i=e.filter.filter.toLowerCase();a=e.selectables.filter(function(t){return-1!==t.title.toLowerCase().indexOf(i)});e.selectables=a}s.localeOrderBy(e.selectables,function(t){return t.title});t.$apply(e)}function m(t){return t.every(function(t){return t.qLocked})}function b(e,i){var a=new r,s=t.getService("qvCurrentSelectionsService");n.get().then(function(t){e.currentSelectionsModel=t;l(e,"currentSelectionsModel",function(t){e.disable={clear:0===t.qSelectionObject.qSelections.length||m(t.qSelectionObject.qSelections),back:0===t.qSelectionObject.qBackCount,forward:0===t.qSelectionObject.qForwardCount};e.selectedFields=t.qSelectionObject.qSelections.filter(function(t){return!t.qIsHidden}).sort(p.sortSelections);e.selectedFields.forEach(function(t){t.translation=s.translate(t)});i.hasLoaded&&v(e,i)});a.resolve()});return a.promise}function y(t){var e=function t(e){return"="===e.qName[0]},n=new r;i.getList().then(function(i){i.getLayout().then(function(i){t.dimensions=i.filter(function(t){return t.qData.info.length>0&&!t.qData.info.some(e)&&"H"!==t.qData.grouping}).map(function(t){return{title:t.qData.title,qField:t.qData.info[0].qName,qId:t.qInfo.qId}});n.resolve()})});return n.promise}function S(t){var e=new r;a.getList().then(function(t){return t.getLayout()}).then(function(n){t.fields=n.map(function(t){return{title:t.qName,qField:t.qName,qTags:t.qTags,isField:true}});e.resolve()});return e.promise}var x=["$scope","qvGlobalSelectionsService",function(e,n){var i={hasLoaded:false,dimensions:[],fields:[]};e.filter={};o.getApp().then(function(a){e.app=a;e.selectedFields=[];e.filter.filter="";e.filter.showFields=n.getShowFields(a);e.filter.onEnter=function(t){t.stopPropagation();t.target.blur()};e.selectables=[];e.enableMenu=true;e.disable={clear:false,back:false,forward:false};t.getService("qvChartTooltipService").close();r.all({selectionsDfd:b(e,i),dimensionsDfd:y(i),fieldsDfd:S(i)}).then(function(){i.hasLoaded=true;e.enableMenu=i.fields.length>0;if(i.dimensions.length<=0&&e.enableMenu){e.filter.showFields=true;n.setShowFields(e.filter.showFields,a)}e.$watch("filter",function(){v(e,i)},true)})})}];t.directive("qvMobileSelections",["qvGlobalSelectionsService","qvListboxPopoverServiceMobile",function(t,n){return{restrict:"E",template:e,controller:x,replace:true,require:["qvMobileSelections"],scope:{},link:function e(i,a){var s,l=function t(){a.find(".qv-ms-scroll-area").animate({scrollTop:0})},u=d.createGroup("mobile-selections",0);u.registerKeys("enter",function(){});u.on();document.activeElement&&document.activeElement.blur();g.getFlag("ALT_STATE_ONE")&&o.getApp().then(function(t){p.getSelectionStates(t).then(function(t){t.splice("$",1);i.hasStatesOtherThanDefault=t.length>0})});i.close=function(e){e.preventDefault();t.toggleGlobalSelection(i.app);h.publish(f.Events.PubSub.RestoreSearchState)};i.selectionsBack=function(){i.disable.back||i.currentSelectionsModel.back()};i.selectionsForward=function(){i.disable.forward||i.currentSelectionsModel.forward()};i.selectionsClear=function(){i.disable.clear||i.currentSelectionsModel.clearAll()};i.toggleTooltip=i.filter.showFields?"GlobalSelections.HideFields":"GlobalSelections.ShowFields";i.toggleMenu=function(){i.filter.showFields=!i.filter.showFields;i.toggleTooltip=i.filter.showFields?"GlobalSelections.HideFields":"GlobalSelections.ShowFields";o.getApp().then(function(e){t.setShowFields(i.filter.showFields,e)})};i.$on("showListbox",function(t,e){var u={title:e.qReadableName||e.title,qListObjectDef:{qDef:{}}},d=-1!==i.selectedFields.indexOf(e),p=function t(){i.currentSelectionsModel.getLayout().then(function(t){var n;if(!d){n=t.qSelectionObject.qSelections.some(function(t){return e.qField===t.qField});if(n){s.resolve();return}}s.reject()})},h=function t(e){s&&s.reject();s=new r;s.promise.then(l);a.children(".qv-ms-searchbox").find("input").blur();n.show(e,{showLock:true},p)};o.getApp().then(function(t){e.qField?c.createTransientField(t,e.qField,u).then(h):c.createTransientDimension(t,e.qId,u).then(h)})});i.$on("$destroy",function(){s&&s.reject();u.delete()})}}}]);return"<qv-mobile-selections></qv-mobile-selections>"}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="qv-mobile-selections" tid="{{\'mobileSelections.showFields.\' + filter.showFields}}">\n\t<div class="qv-ms-toolbar">\n\t\t<p ng-click="selectionsBack()" ng-class="{\'qv-ms-button-disabled\' : disable.back, \'qv-ms-button-enabled\': !disable.back}" class="lui-icon lui-icon--selections-back qv-ms-toolbar-buttons" tid="mobileSelections.back" q-title-translation="Tooltip.NavigateBack"></p>\n\t\t<p ng-click="selectionsForward()" ng-class="{\'qv-ms-button-disabled\' : disable.forward, \'qv-ms-button-enabled\': !disable.forward}" class="qv-ms-toolbar-buttons lui-icon lui-icon--selections-forward" tid="mobileSelections.forward" q-title-translation="Tooltip.NavigateForward"></p>\n\t\t<p ng-click="selectionsClear()" ng-class="{\'qv-ms-button-disabled\' : disable.clear, \'qv-ms-button-enabled\': !disable.clear}" class="qv-ms-toolbar-buttons lui-icon lui-icon--clear-selections" tid="mobileSelections.clear" q-title-translation="Tooltip.ClearSelections"></p>\n\t\t<p ng-click="toggleMenu()" ng-class="{\'qv-ms-button-disabled\' : !enableMenu, \'qv-ms-button-enabled\': enableMenu, \'qv-ms-button-menu-active\': filter.showFields }" class="qv-ms-toolbar-buttons lui-icon\tlui-icon--settings" id="mobileSelectionsToggle" tid="mobileSelections.toggleFields" q-title-translation="{{toggleTooltip}}"></p>\n\n\t\t<qui-toolbarbutton ng-click="close($event)" name="close" class="qv-ms-toolbar-close" tid="mobileSelections.close">\n\t\t\t<span q-translation="Common.Close" class="qv-ms-toolbar-close-text"></span>\n\t\t</qui-toolbarbutton>\n\t</div>\n\t<header class="qv-ms-header">\n\t\t<h2 ng-if="!hasStatesOtherThanDefault" q-translation="GlobalSelections.CurrentSelections"></h2>\n\t\t<h2 ng-if="hasStatesOtherThanDefault" q-translation="GlobalSelections.CurrentSelections.Default"></h2>\n\t</header>\n\t<lui-search x-variant="inverse" class="qv-ms-searchbox" placeholder="{{filter.showFields ? \'GlobalSelections.FilterDimensionsAndFields\' : \'GlobalSelections.FilterDimensions\'}}" query="filter.filter" maxlength="255"\n\t\ton-enter="filter.onEnter($event)" tid="mobileSelections.searchfield">\n\t</lui-search>\n\t<div class="qv-ms-scroll-area">\n\t\t<qv-ms-selected ng-repeat="item in selectedFields"></qv-ms-selected>\n\t\t<div class="qv-ms-selectable" ng-if="filter.filter.length && (!selectables || selectables.length === 0)">\n\t\t\t<span q-translation="GlobalSelections.NoMatchesForSearch"></span>\n\t\t</div>\n\t\t<qv-ms-selectable ng-repeat="item in selectables"></qv-ms-selectable>\n\t</div>\n</div>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(842)],a=function(t,e){t.directive("qvMsSelectable",["$timeout",function(t){return{restrict:"E",replace:true,template:e,link:function e(n){n.showSelectable=function(){n.item.flash=true;t(function(){n.$emit("showListbox",n.item);n.item.flash=false},20)}}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div ng-click="showSelectable()" ng-class="{\'qv-ms-touch-flash\' : item.flash}" class="qv-ms-selectable" tid="mobileSelections.selectable">\n\t<span ng-if="item.isField" class="lui-icon  lui-icon--field"></span>\n\t<div class="qv-ms-highlight">\n\t\t<span qve-highlight text="{{item.title}}" query="filter.filter"></span>\n\t</div>\n</div>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(844)],a=function(t,e){t.directive("qvMsSelected",function(){return{restrict:"E",replace:true,template:e,link:function t(e){e.showSelected=function(){e.$emit("showListbox",e.item)};e.clear=function(t){e.currentSelectionsModel.clearField(t)}}}})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="qv-ms-selected" tid="mobileSelections.selected">\n\t<div class="qv-ms-selected-icon">\n\t\t<a ng-show="!item.qLocked && !item.qOneAndOnlyOne" ng-click="clear(item.qField)">\n\t\t\t<i class="lui-icon  lui-icon--remove"></i>\n\t\t</a>\n\t\t<a ng-show="item.qLocked" ng-click="showSelected(item.qField)">\n\t\t\t<i class="lui-icon lui-icon--lock"></i>\n\t\t</a>\n\t</div>\n\t<div ng-click="showSelected(item.qField)" class="qv-ms-selected-info" ng-class="{ \'no-icon\': item.qOneAndOnlyOne }">\n\t\t<h1 class="qv-object-title">{{item.qReadableName || item.qField}}</h1>\n\t\t<span>{{item.translation}}</span>\n\t\t<qv-state-count-bar state-counts="item.qStateCounts"></qv-state-count-bar>\n\t</div>\n</div>\n'},function(t,e){t.exports='<lui-popover style="min-width: 200px;width: 230px;" align-to="alignTo" position="position" collision="\'flipfit\'" on-close-view="closeAddPopover(event)" qva-outside-ignore-for="{{qvaOutsideIgnoreFor}}">\n\t<object-add-typeahead>\n\t\t<lui-popover-header>\n\t\t\t<div class="lui-input-group">\n\t\t\t\t<input class="lui-input  lui-input-group__item  lui-input-group__input" type="text" name="new-dimension" autocomplete="off" ng-model="search.term" tid="add-dimension-input" qva-focus="autoFocus"\n\t\t\t\t\t   object-add-typeahead-input on-escape="onEscape($event)" on-enter="onEnter($event)" maxlength="255"/>\n\t\t\t\t<button ng-if="allowExpressionEditor !== false" class="lui-button  lui-input-group__item  lui-input-group__button" qva-activate="close()"\n\t\t\t\t\t\tpp-expression-editor="search.term" pp-expression-editor-on-apply="addFieldDimension({value:value})" expression-type="dimension"\n\t\t\t\t\t\tq-title-translation="Tooltip.OpenExpressionEditor" tid="fx-button">\n\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--expression  edit-expression"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</lui-popover-header>\n\t\t<div class="object-add-popover-content" object-add-typeahead-menu>\n\t\t\t<ul class="lui-list">\n\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="dimension in activeDimensions" tid="dimension-item"\n\t\t\t\t\tobject-add-typeahead-item="dimension" on-select="addActiveDimension(dimension)">\n\t\t\t\t\t<span qve-highlight text="{{dimension.translatedTitle}}" title="{{dimension.translatedTitle}}" query="search.term" class="lui-list__text lui-list__text--ellipsis"></span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t<div class="object-add-popover-list-header" ng-if="dimensions.length" q-translation="Common.Dimensions"></div>\n\t\t\t<ul class="lui-list">\n\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="dimension in dimensions" tid="dimension-item"\n\t\t\t\t\tobject-add-typeahead-item="dimension" on-select="addLibraryDimension(dimension)">\n\t\t\t\t\t<span ng-if="dimension.isDrillDown" class="lui-icon lui-icon--drill-down lui-list__aside" q-title-translation="Tooltip.dimensions.drilldown"></span>\n\t\t\t\t\t<span qve-highlight text="{{dimension.label}}" title="{{dimension.label}}" query="search.term" class="lui-list__text lui-list__text--ellipsis"></span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t<div class="object-add-popover-list-header" ng-if="fields.length" q-translation="Common.Fields"></div>\n\t\t\t<ul class="lui-list">\n\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="field in fields" tid="field-item"\n\t\t\t\t\tobject-add-typeahead-item="field" on-select="addFieldDimension(field)"\n\t\t\t\t\tng-class="{\'derived-field\': (field.isDerived && search.term === \'\')}">\n\t\t\t\t\t<i ng-if="isDirectDiscoveryField( field )" class="lui-icon  lui-icon--direct-discovery  lui-list__aside" q-title-translation="{{ getDirectDiscoveryTypeTranslationKey( field.qTags ) }}"></i>\n\t\t\t\t\t<span ng-if="field.isDateField" class="lui-icon lui-list__aside  lui-icon--calendar"></span>\n\t\t\t\t\t<span ng-if="field.isGeoField" class="lui-icon lui-list__aside  lui-icon--map"></span>\n\t\t\t\t\t<span qve-highlight text="{{getFieldDisplayName(field)}}" title="{{field.toolTip}}" query="search.term" class="lui-list__text lui-list__text--ellipsis"></span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t<div class="object-add-popover-nohits" ng-if="!dimensions.length && !fields.length" q-translation="Toolbox.Search.Nohits"></div>\n\t\t</div>\n\t</object-add-typeahead>\n</lui-popover>\n'},function(t,e){t.exports='<lui-popover style="width: 200px" on-close-view="onClose(event)">\n\t<div class="object-error-popup">\n\t\t\x3c!--<div class="object-error-title" q-translation="{{error.title}}"></div>--\x3e\n\t\t<div class="object-error-message">{{error.message}}</div>\n\t</div>\n</lui-popover>'},function(t,e){t.exports='<div class="object-error hard-error" tid="object.Error">\n\t<div class="object-error-content">\n\t\t<div class="object-error-title">\n\t\t\t<span>{{error.title}}</span>\n\t\t\t<i class="object-error-more lui-icon lui-icon--info lui-icon--large" ng-click="showMore($event)"></i>\n\t\t</div>\n\t\t<div ng-if="error.message" class="object-error-message">{{error.message}}</div>\n\t\t<button ng-if="showButton" class="lui-button object-error-remove" ng-click="remove($event)" q-translation="Common.Delete"></button>\n\t</div>\n</div>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(94),n(122),n(362)],a=function(t,e,n){var i;function a(){i||(i=t.getService("$navigationService"));return i}function s(){return a().Sheets.all.mashed}function r(){return a().Stories.all.mashed}function o(t){var n=e.model.id;var i=-1;t.forEach(function(t,e){t.qInfo.qId===n&&(i=e)});return i}function l(t,e){var n;e.forEach(function(e){e.qInfo.qId===t&&(n=e)});return n}function c(t,e){var n;e.forEach(function(e){e.qInfo.qId===t&&(n=e)});return n}function u(t){n.goToSheet(t,Object.keys(e.States)[e.state]);return{success:true,sheetId:t}}function d(t){n.goToStory(t,Object.keys(e.States)[e.States.play]);return{success:true,storyId:t}}function p(t,e,n){this.inClient=t;Object.defineProperties(this,{ANALYSIS:{get:function t(){return"analysis"}},EDIT:{get:function t(){return"edit"}},SNAPSHOT:{get:function t(){return"snapshot"}},sheets:{get:function n(){return t?s(this):e||[]}},stories:{get:function e(){return t?r(this):n||[]}}})}p.prototype.gotoSheet=function(t){var e=l(t,this.sheets);if(e)return u(t);return{success:false,error:"NOSUCHSHEET",errorMsg:"No such sheet"}};p.prototype.nextSheet=function(){if((e.view===e.Views.sheet||e.view===e.Views.object)&&e.model){var t=o(this.sheets)+1;var n=this.sheets[t===this.sheets.length?0:t].qInfo.qId;return u(n)}return{success:false,error:"NOCURRENTSHEET",errorMsg:"No current sheet"}};p.prototype.prevSheet=function(){if((e.view===e.Views.sheet||e.view===e.Views.object)&&e.model){var t=o(this.sheets)-1;var n=this.sheets[t<0?this.sheets.length-1:t].qInfo.qId;return u(n)}return{success:false,error:"NOCURRENTSHEET",errorMsg:"No current sheet"}};p.prototype.getCurrentSheetId=function(){if(e.view===e.Views.sheet&&e.model)return{success:true,sheetId:e.model.id};return{success:false,error:"NOCURRENTSHEET",errorMsg:"No current sheet"}};p.prototype.getMode=function(){return Object.keys(e.States)[e.state]};p.prototype.setMode=function(t){if(!this.isModeAllowed(t))return{success:false,error:"MODENOTALLOWED",errorMsg:"Mode not allowed"};e.setState(e.States[t]);return{success:true,mode:t}};p.prototype.isModeAllowed=function(t){switch(t){case this.ANALYSIS:return true;case this.EDIT:return this.inClient&&e.model.layout&&e.model.layout.permissions&&e.model.layout.permissions.update;case this.SNAPSHOT:return this.inClient}return false};p.prototype.gotoStory=function(t){var e=c(t,this.stories);if(e)return d(t);return{success:false,error:"NOSUCHSTORY",errorMsg:"No such story"}};return p}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(239)],a=function(t){function e(){this._options=null;this._appid=null;this._type=null;this._cols=null;return window.Reflect?window.Reflect.construct(HTMLElement,[],this.constructor):null}e.prototype=Object.create(HTMLElement.prototype);e.prototype.constructor=e;Object.setPrototypeOf(e,HTMLElement);e.prototype.connectedCallback=function(){i(this)};Object.defineProperty(e.prototype,"options",{get:function t(){return this._options},set:function t(e){this.setAttribute("options",e)}});e.observedAttributes=["options","appid","config"];e.prototype.attributeChangedCallback=function(t,e,s){if("options"===t&&this.vis){var r=JSON.parse(s);this.vis.setOptions(r)}else{a(this);"appid"!==t&&"config"!==t||n(this);i(this)}};e.prototype.disconnectedCallback=function(){a(this)};e.init=function(){window.customElements&&window.customElements.define&&customElements.define("qlik-visual",e)};return e;function n(e){var n=e.getAttribute("appid");if(n){var i=JSON.parse(e.getAttribute("config"));e.app=t.openApp(n,i)}else e.app=t.currApp()}function i(t){var e=t.getAttribute("visid"),i=JSON.parse(t.getAttribute("options"));t.app||n(t);if(t.app&&e)t.app.visualization.get(e).then(function(e){t.vis=e;i&&e.setOptions(i);e.show(t)});else if(t.app){var a=JSON.parse(t.getAttribute("cols")),s=t.getAttribute("type")||"barchart";t.app.visualization.create(s,a,i).then(function(e){t.vis=e;e.show(t)})}}function a(t){if(t.vis){t.vis.close();delete t.vis}}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="qv-panel-subtoolbar qv-panel-current-selections" ng-class="{smallDevice: isSmallDevice, bright: brightCurSel, \'expand-smart-search-suggested-chart\': expandSmartSearchSuggestedChart}">\n\t<div ng-if="!isSmallDevice">\n\t\t<div class="qv-selections-pager" ng-class="{\'client-tab-navigation--bright\' : clientTabNavigation }">\n\t\t\t<div class="buttons borderbox border-bottom border-right" aria-hidden="true">\n\n\t\t\t\t<div tid="toggleGlobalSearchButton" tabindex="0" class="qv-subtoolbar-button toggle-button borderbox" ng-hide="hideSearch" ng-class="{active: isGlobalSearchActive, indexing: isGlobalSearchIndexing}" ng-click="toggleGlobalSearch()" q-title-translation="{{isGlobalSearchActive ? \'Tooltip.CloseGlobalSearch\' : \'Tooltip.GlobalSearch\'}}">\n\t\t\t\t\t<i class="lui-icon lui-icon--selection-search icon"></i>\n\t\t\t\t\t<div class="label" q-translation="GlobalSearch.Preparing" q-title-translation="GlobalSearch.Preparing.Tooltip"></div>\n\t\t\t\t\t<qv-progress-bar ng-if="isGlobalSearchIndexing" percent-done="indexPercentDone" on-completed="setSearchIndexingDone()" options="progressBarOptions"></qv-progress-bar>\n\t\t\t\t</div>\n\n\t\t\t\t<button class="qv-subtoolbar-button borderbox" ng-hide="hideUndoRedo" ng-click="back()" ng-disabled="disable.back" q-title-translation="Tooltip.NavigateBack" data-tid="current-selections-back">\n\t\t\t\t\t<i class="lui-icon lui-icon--selections-back"></i>\n\t\t\t\t</button>\n\n\t\t\t\t<button class="qv-subtoolbar-button borderbox" ng-hide="hideUndoRedo" ng-click="forward()" ng-disabled="disable.forward" q-title-translation="Tooltip.NavigateForward" data-tid="current-selections-forward">\n\t\t\t\t\t<i class="lui-icon lui-icon--selections-forward"></i>\n\t\t\t\t</button>\n\n\t\t\t\t<button id="clearselections" class="qv-subtoolbar-button borderbox" ng-disabled="disable.clear" ng-hide="hideClearSelections" ng-click="clearAllFields()" q-title-translation="Tooltip.ClearSelections" data-tid="current-selections-clear">\n\t\t\t\t\t<i class="lui-icon lui-icon--clear-selections"></i>\n\t\t\t\t</button>\n\n\t\t\t</div>\n\t\t\t<div class="selections-shadow" ng-if="showShadow"></div>\n\t\t\t<div class="wrap borderbox" style="height: 100%;" qv-pager qv-selection-pager>\n\t\t\t\t<ul class="list" ng-show="!isGlobalSelectionsActive || (items.length > 0 && currentSelectionDisabled) || (items.length > 0 && !isGlobalSelectionsActive)" qva-delegated-activate=".item#showPopover($event)" qva-outside-ignore-for="currentSelectionsItems">\n\t\t\t\t\t<li class="item" ng-class="{\'item-multi-state\': !item.isSingleState, \'multi-active\': multiPopoverFieldName && multiPopoverFieldName === item.qField, \'selection-insights-disabled\': currentSelectionDisabled}" ng-repeat="item in items track by item.qField" data-csid="{{item.qField}}" tabindex="0"\n\t\t\t\t\t ng-keydown="handleKeyDown($event, item)" aria-label="{{item.screenReaderLabel}}">\n\t\t\t\t\t\t<qv-current-selections-item ng-if="item.isSingleState" item="item" current-selection-disabled="currentSelectionDisabled"></qv-current-selections-item>\n\t\t\t\t\t\t<div ng-if="!item.isSingleState" class="current-selections-item" ng-mousemove="openTooltip($event, item)" ng-mouseleave="closeTooltip()">\n\t\t\t\t\t\t\t<div class="item-component label">\n\t\t\t\t\t\t\t\t<span ng-class="{ \'lui-icon lui-icon--lock\': item.qLocked }"></span><span class="name">{{item.name}}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="item-component count" title="">\n\t\t\t\t\t\t\t\t<span class="field-states-indicator">{{ item.states.length }}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="item-component caret">\n\t\t\t\t\t\t\t\t<span class="lui-icon lui-icon--arrow-down"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-if="currentSelectionDisabled" class="current-selections-disabled"></div>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\n\t\t\t\t<div ng-if="!items.length && !haveHiddenSelections" class="empty-text no-selection borderbox" q-translation="CurrentSelections.NoSelections"></div>\n\t\t\t\t<div ng-if="!items.length && haveHiddenSelections" class="empty-text no-selection borderbox" q-translation="CurrentSelections.OnlyHiddenSelections"></div>\n\t\t\t\t<a class="qv-pager-nav qv-pager-previous" ng-class="{inverted: brightCurSel}" ng-click="prevPage()" q-title-translation="Tooltip.Previous"><i class="lui-icon lui-icon--arrow-left"></i></a>\n\t\t\t\t<a class="qv-pager-nav qv-pager-next" ng-class="{inverted: brightCurSel}" ng-click="nextPage()" q-title-translation="Tooltip.Next"><i class="lui-icon lui-icon--arrow-right"></i></a>\n\t\t\t</div>\n\t\t\t<div class="buttons-end borderbox border-left">\n\t\t\t\t<div aria-hidden="true" class="qv-subtoolbar-button qv-explore-selections-btn toggle-button borderbox" tabindex="0" ng-class="{active: isGlobalSelectionsActive}" ng-hide="hideSelectionsTool" ng-click="toggleGlobalSelection($event)" q-title-translation="{{isGlobalSelectionsActive ? \'Tooltip.CloseGlobalSelector\' : \'Tooltip.GlobalSelector\'}}"\n\t\t\t\t tid="currentSelections.toggleGlobalSelections">\n\t\t\t\t\t<i class="lui-icon lui-icon--global-selector icon"></i>\n\t\t\t\t\t<span id="explore-selections-label" q-translation="CurrentSelections.ExploreSelectionsBtn"></span>\n\t\t\t\t</div>\n\n\t\t\t\t<div aria-labelledby="insights-label" tid="toggleCaoButton" id="toggle-insights" tabindex="0" class="qv-subtoolbar-button toggle-button borderbox qv-insight-toggle-button" ng-if="options && options.enableCao" ng-class="{active: isCaoActive, bright: brightCurSel}" ng-click="toggleCao()"\n\t\t\t\t q-title-translation="{{isCaoActive ? \'cao.CloseCognitiveAssociativeOverlay\' : \'cao.CognitiveAssociativeOverlay\'}}">\n\t\t\t\t\t<i class="lui-icon lui-icon--analyze icon" aria-hidden="true"></i>\n\t\t\t\t\t<span id="insights-label" q-translation="cao.CognitiveAssociativeOverlayToggleButton"></span>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\n\t\t</div>\n\t</div>\n\t<div ng-if="isSmallDevice && mobileIndicatorShow && !inSelection " ng-click="toggleGlobalSelection($event)" ng-class="{\'expand-smart-search-suggested-chart\': expandSmartSearchSuggestedChart}" class="qv-current-selections-mobile-wrapper" tid="currentSelections.toggleMobileSelections"\n\t q-title-translation="GlobalSelections.CurrentSelections">\n\t\t<div class="qv-current-selections-mobile-background">\n\t\t\t<p class="qv-current-selections-mobile-nbr" ng-class="{selections: nbrSelections > 0}">{{nbrSelections}}</p>\n\t\t</div>\n\t</div>\n</div>'},function(t,e){t.exports='<div qva-direction x-dir-setting={{options.direction}}" class="qv-tooltip qvt-generic-tooltip" ng-class="{\'above\':alwaysOnTop}">\n\t<div ng-repeat="item in content">\n\t\t<div qva-direction x-dir-text="{{item.header}}" x-dir-setting="{{options.direction}}" class="qv-tp-header">\n\t\t\t<strong>{{item.header}}</strong>\n\t\t</div>\n\t\t<table>\n\t\t\t<tr ng-repeat="row in item.rows" class="qv-tp-row">\n\t\t\t\t<td class=\'qv-tp-item\'>\n\t\t\t\t\t<div qva-direction x-dir-text="{{row.content}}" class="qv-tp-rowContent fade-out">{{row.content}}</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t</div>\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(184)],a=function(t,e,n){function i(i){var a={preventDefault:false,allowInInput:false};function s(){n.preventDefault();e.$rootScope.$apply()}function r(){i.inSelection&&t(document).trigger("qv-press");i.forward();s()}function o(){i.inSelection&&t(document).trigger("qv-press");i.back();s()}this.keyboardShortcutsGroup=n.createGroup("current-selection-"+i.app.id,1);this.keyboardShortcutsGroup.registerKeys("ctrl+shift+y",r,a);this.keyboardShortcutsGroup.registerKeys("ctrl+shift+z",o,a);this.keyboardShortcutsGroup.on();this.on=function(){if(!this._isOn){this.keyboardShortcutsGroup.on();this._isOn=true}};this.off=function(){if(this._isOn){this.keyboardShortcutsGroup.off();this._isOn=false}};this.delete=function(){this.keyboardShortcutsGroup.delete()}}return i}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(92)],a=function(t){var e=t.extend("CurrentSelectionsViewHelper",{init:function t(e,n,i,a,s,r){this.scope=e;this.responsiveState=n;this.globalSelectionService=i;this.exploreSelectionsService=a;this.globalSearchService=s;this.caoService=r},toggleGlobalSelection:function t(e){this.globalSelectionService.toggleGlobalSelection(e);this.responsiveState.isSmallDevice||this.globalSearchService.off();this.scope.isCaoActive=false;this.exploreSelectionsService.off();this.scope.isExploreSelectionsActive=false},toggleExploreSelection:function t(e){this.globalSelectionService.off();this.scope.isExploreSelectionsActive=this.exploreSelectionsService.toggleExploreSelection(e);this.globalSearchService.off();this.scope.isCaoActive=false},toggleGlobalSearch:function t(e){this.globalSearchService.toggleGlobalSearch(this.scope.app.enigmaModel,e,this.scope.options.objectSearch);this.scope.isCaoActive=false;this.globalSelectionService.off();this.exploreSelectionsService.off();this.scope.isExploreSelectionsActive=false},toggleCao:function t(e){this.scope.isCaoActive=this.caoService.toggleCao(e);this.globalSearchService.off();this.globalSelectionService.off();this.exploreSelectionsService.off();this.scope.isExploreSelectionsActive=false}});return e}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(11),n(242)],a=function(t){t.widget("qv.pager",{options:{itemSelector:">li",orientation:"horizontal",pageSize:"auto",startPage:1,animationDuration:300},_create:function e(){var n=this.options;t.extend(this,{positionProperty:"horizontal"===n.orientation?"left":"top",sizeProperty:"horizontal"===n.orientation?"outerWidth":"outerHeight"});this.refresh();this.goToPage(n.startPage)},isItemInsidePage:function e(n){var i=t(n),a=i.position()[this.positionProperty]+i[this.sizeProperty](),s=Math.abs(parseFloat(i.parent().css("margin-"+this.positionProperty))),r=s+this.containerSize;return a>s&&a<r},calculatePageSize:function t(){return Math.floor(this.containerSize/this.calculateItemSize())},calculateItemSize:function t(){return this.element.find(this.options.itemSelector).eq(0)[this.sizeProperty]()},refresh:function t(){var e=this.currentPage||1;this.containerSize=this.element.parent()[this.sizeProperty]();this.pageSize="auto"===this.options.pageSize?this.calculatePageSize():this.options.pageSize;this.itemSize=this.calculateItemSize();this.maxPages=Math.ceil(this.element.find(this.options.itemSelector).length/this.pageSize||1);this.currentPage=Math.min(e,this.maxPages);this.goToPage(this.currentPage)},goToPage:function t(e){this.currentPage=Math.min(Math.max(1,e),this.maxPages);var n=(this.currentPage-1)*this.itemSize*this.pageSize,i={};i[this.positionProperty]=-n+"px";this.element.stop(true).animate(i,this.options.animationDuration)},goToPreviousPage:function t(){this.goToPage(this.currentPage-1)},goToNextPage:function t(){this.goToPage(this.currentPage+1)},goToPageContaining:function t(e){var n=Math.ceil(this.element.find(e).index()+1/this.pageSize);this.goToPage(n)},_destroy:function t(){this.element.off(this.eventNamespace)}});return t}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(11),n(10),n(48),n(856),n(94),n(140),n(103),n(168),n(155),n(49),n(89),n(176)],a=function(t,e,n,i,a,s){n.service("qvExploreSelectionsService",["$document","qvSelectionToolbarService",function(n,r){var o,l;var c=300;function u(){return{$container:void 0,$containerId:".qv-explore-selections-container",getComponent:function t(){return i},setup:function t(){s.get().then(function(t){a.StateChanged.bind(d.bind(null,d));t.enigmaModel.isInModalSelection()&&r.confirm()})},destroy:function t(){a.StateChanged.unbind(d)}}}function d(){(a.isInEditMode()||!a.isInAnalysisMode||a.inObjectView())&&f()}function p(i){a.setState(a.States.analysis);l.$container=e.element("<div>");i=i||n;i.find(l.$containerId).append(l.$container);l.$container.showComponent(l.getComponent());l.setup();t(".qv-explore-selections").slideDown(c)}function h(){return!(!l||void 0===l.$container)}function f(){if(!l)return;t(".qv-explore-selections").slideUp(c,function(){if(l.$container){l.$container.remove();l.$container=void 0}l.destroy()})}o={toggleExploreSelection:function t(e){l||(l=new u);if(h()){f();return false}p(e);return true},off:function t(){f()}};return o}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(857),n(858)],a=function(t,e){var n=["$scope",function(t){t.showFullModel=false;t.$on("$destroy",function(){})}];t.directive("qvExploreSelectionsComponent",function(){return{restrict:"E",template:e,controller:n,scope:true,replace:true,link:function t(e){e.target=null}}});return"<qv-explore-selections-component></qv-explore-selections-component>"}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="qv-explore-selections overlay" id="qv-explore-selections-overlay" style="display:none;">\n\t<qv-selection-insights full="showFullModel"></qv-selection-insights>\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(284),n(859),n(860),n(93),n(234),n(95),n(91),n(106),n(103),n(220),n(861),n(863),n(867)],a=function(t,e,n,i,a,s,r,o,l,c){var u={NO_SELECTIONS:0,GENERATE_INSIGHTS:1,INSIGHTS_FOUND:2,NO_INSIGHTS:3,UNSUPPORTED:4};var d={restrict:"E",bindings:{showFields:"<"},template:n,controller:["$scope","$timeout","qvSelectionInsightsService",function(n,d,p){var h=this;var f=null;this.showLoading=true;this.insights=[];this.activeCard=1e3;this.showInsightDetails=false;this.selectedInsight=null;this.hasSelection=false;this.measure="";this.newMeasureChosen=false;this.newSelection=false;this.isRefreshing=false;this.app=null;this.layout=null;this.selectionInsightsState=u.NO_SELECTIONS;this.states=u;this.measureError=false;this.loadingCards=false;this.cardIsInsight=true;this.selectionContribution="";this.isOneAndOnlyOneField=null;this.showing={table:false,excluded:false};this.$onInit=function(){g().then(function(t){if(t)a.getApp().then(function(t){h.app=t;t.enigmaModel.getCurrentSelectionObject().then(function(t){n.currentSelModel=t;l(n,"currentSelModel",function(){v()})});b(t);c.trackEvent(c.customEvents.EXPLORE_SELECTIONS_OPENED,{type:"clicked"})});else{m();h.showLoading=false}})};function g(){return p.getInsightDimensions(h.showFields).then(function(){return true}).catch(function(){return false})}this.generateInsights=function(){h.showLoading=true;h.newMeasureChosen=false;h.newSelection=false;y();c.trackEvent(c.customEvents.ASSOCIATIVE_INSIGHTS_GENERATED,{type:"clicked"})};function v(){if(h.selectionInsightsState!=u.UNSUPPORTED){h.hasSelection=n.currentSelModel.layout.qSelectionObject.qSelections.length>0;h.showLoading=false;h.isOneAndOnlyOneField=p.isOneAndOnlyOne(n.currentSelModel.layout);if(h.isOneAndOnlyOneField.isOneAndOnlyOne){h.selectionInsightsState=u.UNSUPPORTED;h.errorMsg=o.get("ExploreSelections.SingleSelectField",[h.isOneAndOnlyOneField.items])}else h.hasSelection||(h.selectionInsightsState=u.NO_SELECTIONS);h.hasSelection&&h.selectionInsightsState===u.NO_SELECTIONS&&(h.selectionInsightsState=u.GENERATE_INSIGHTS);h.layout=n.currentSelModel.layout;r.publish("selection/insights/current-selection",n.currentSelModel.layout)}}this.$onChanges=function(t){void 0===t.showFields||t.showFields.isFirstChange()||h.selectionInsightsState===u.NO_INSIGHTS&&(h.selectionInsightsState=u.GENERATE_INSIGHTS)};function m(){h.selectionInsightsState=u.UNSUPPORTED;h.errorMsg=o.get("ExploreSelections.NoSelectionInsights")}function b(t){return t.getCurrentSelectionObject().then(function(t){t.layoutSubscribe(function(){if(h.selectionInsightsState!=u.UNSUPPORTED){h.showInsightDetails=false;if(!h.newMeasureChosen){h.isRefreshing=true;r.publish("selection/insights/selection/changed")}if(h.selectionInsightsState!==u.NO_SELECTIONS&&h.selectionInsightsState!==u.NO_INSIGHTS){h.newSelection=true;h.newMeasureChosen=false}else h.selectionInsightsState===u.NO_INSIGHTS&&(h.selectionInsightsState=u.GENERATE_INSIGHTS)}c.trackEvent(c.customEvents.NEW_SELECTION_MADE,{type:"clicked"})})})}function y(){h.insights=[];return p.getInsightDimensions(h.showFields).then(function(t){r.publish("selection/insights/refreshed");h.showLoading=false;h.selectionInsightsState=u.INSIGHTS_FOUND;if(0!==t.insights.length){h.measure=t.insights[0].measure;h.loadingCards=true;S(t.insights)}else{r.publish("selection/insights/updated");t.measure?h.measure=t.measure:h.selectionInsightsState=u.NO_INSIGHTS}h.isRefreshing=false}).catch(function(){h.showLoading=false;m()})}function S(e){var n=t.getService("$q");function i(t){var a=e[t];if(!a)return n.resolve(true);return p.getInsightSummary(a.dimension,h.app).then(function(t){h.measureError="NaN"==t.summary;a.summaryNaN=h.measureError;a.summaryString=t.summary;if(t.show){h.insights.push(a);r.publish("selection/insight/draw",{insight:a,index:h.insights.length-1})}}).catch(function(){a.summaryError=true;h.insights.push(a)}).then(function(){t+=1;if(t<e.length)return i(t);h.loadingCards=false;r.publish("selection/insights/updated");return true})}return i(0)}this.openCardSummaryDialog=function(){f=t.getService("luiDialog").show({template:i,input:{title:"SelectionInsights.SummarySelection.HelpTitle",html:i,closeDialog:function t(){f.close();f=null}}})};this.backToSelections=function(){h.showInsightDetails=false;h.newMeasureChosen=false;r.publish("selections/insights/details/close")};this.closeInsights=function(){h.showInsightDetails=false;h.newMeasureChosen=false;p.clearInsights();r.publish("selection/insights/close")};this.openCard=function(t){r.publish("selections/insights/details/close");if(t>=0)h.newMeasureChosen||h.isRefreshing||h.insights[t].summaryNaN||!h.insights[t].show||d(function(){if(h.activeCard==t)h.closeCard();else{r.publish("selections/insights/details/open");h.activeCard=t;t=t>0?t:0;var n=p.getInsightDetails(h.insights[t].dimension,h.app);n.isMeasureNegative=n.includedMeasure.qNumber<0||n.excludedMeasure.qNumber<0;h.showInsightDetails=true;h.cardIsInsight=true;h.insights[t]=n;h.selectedInsight=h.insights[t];p.getTableVis(h.selectedInsight,h.showing.excluded).then(function(t){h.selectedInsight.table=t});n.isMeasureNegative?r.publish("selection/insights/details/negative",h.selectedInsight):r.publish("selection/insights/details/updated",{measure:h.selectedInsight.measure,aggr:h.selectedInsight.measureAggregation,dimension:h.selectedInsight.dimension,contribution:h.selectedInsight.selectedMeasure.selected.percentage.toFixed(1)});var i=e.openApp(h.app.qDocId);i.visualization.create("listbox",[h.selectedInsight.dimension],{showTitles:true,title:h.selectedInsight.dimension}).then(function(t){h.listbox=t.model.enigmaModel;x()})}});else if(!h.newMeasureChosen&&!h.isRefreshing)if(h.activeCard==t&&h.showInsightDetails)h.closeCard();else{h.activeCard=t;var n=p.getInsightDetails(h.insights[0].dimension,h.app);h.showInsightDetails=true;h.cardIsInsight=false;n.isSelectionNegative=n.selectedMeasure.selected.percentage<0||n.selectedMeasure.excluded.percentage<0;h.insights[0]=n;h.selectedInsight=h.insights[0];r.publish("selection/insights/current/open",{insight:h.selectedInsight});r.publish("selections/insights/details/open")}c.trackEvent(c.customEvents.ASSOCIATIVE_INSIGHTS_CARD_CLICKED,{type:"clicked"})};this.closeCard=function(){h.showInsightDetails=!h.showInsightDetails;h.cardIsInsight=true;h.activeCard=null};r.subscribe("selection/insights/details/close",function(){h.showInsightDetails=false});r.subscribe("selection/insights/new",function(t){h.isRefreshing=false;h.insights=[];h.activeCard=1e3;if(0===t.insights.length){h.measureError=false;r.publish("selection/insights/updated")}else{h.loadingCards=true;S(t.insights)}t.measure&&(h.measure=t.measure);h.showInsightDetails=false});r.subscribe("selection/insights/error",m);function x(){s.selectAll(".gwBar g").remove();var t=s.select(".gwBar svg");var e=t.append("g");var n=h.selectedInsight.counts.excluded/(h.selectedInsight.counts.excluded+h.selectedInsight.counts.included)*100/100*427;var i=h.selectedInsight.counts.included/(h.selectedInsight.counts.excluded+h.selectedInsight.counts.included)*100/100*427;e.append("rect").style("fill","#A9A9A9").attr("width",35).attr("height",Math.ceil(n)).attr("y",Math.ceil(i)).attr("x",0);e.append("rect").style("fill","white").attr("width",35).attr("height",Math.ceil(i)).attr("y",0).attr("x",0);var a=[];a.push([{x:35,y:Math.ceil(i)+Math.ceil(n)/2},{x:65,y:322}]);a.push([{x:65,y:322},{x:95,y:322}]);a.push([{x:35,y:Math.ceil(i)/2},{x:65,y:107}]);a.push([{x:65,y:107},{x:95,y:107}]);var r=s.svg.line().x(function(t){return t.x}).y(function(t){return t.y});var o=t.append("g").attr("class","lines");o.selectAll("path").data(a).enter().append("path").attr({d:r,"stroke-dasharray":"790 790","stroke-dashoffset":0}).style("stroke",function(t,e){return e>1?"white":"#A9A9A9"}).style("stroke-width","2").attr("opacity",1)}this.$onDestroy=function(){r.unsubscribe("selection/insights/show");r.unsubscribe("selection/insights/new");r.unsubscribe("selection/insights/error")}}]};t.nativeComponent("qvSelectionInsights",d)}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="qv-selections-insights-container">\n\t\x3c!-- Insights found --\x3e\n\t<div class="qv-selections-insights-header">\n\t\t<h2\n\t\t\tq-translation="SelectionInsights.AssociativeInsights"\n\t\t\tclass="qv-selections-insights-title"\n\t\t></h2>\n\t\t<span\n\t\t\tclass="lui-icon lui-icon--help lui-icon--small"\n\t\t\tng-click="$ctrl.openCardSummaryDialog()"\n\t\t></span>\n\t\t<div class="qv-insight-summary-close">\n\t\t\t<span\n\t\t\t\tclass="lui-icon lui-icon--close"\n\t\t\t\tng-click="$ctrl.closeInsights()"\n\t\t\t></span>\n\t\t</div>\n\t\t<qv-selection-insights-summary\n\t\t\tng-if="!$ctrl.showLoading && $ctrl.selectionInsightsState === $ctrl.states.INSIGHTS_FOUND"\n\t\t\tstates="$ctrl.states"\n\t\t\tselection-insights-state="$ctrl.selectionInsightsState"\n\t\t\tnew-measure-chosen="$ctrl.newMeasureChosen"\n\t\t\tnew-selection="$ctrl.newSelection"\n\t\t\tmeasure="$ctrl.measure"\n\t\t\tshow-loading="$ctrl.showLoading"\n\t\t\thas-selection="$ctrl.hasSelection"\n\t\t\tshow-fields="$ctrl.showFields"\n\t\t\tmeasure-error="$ctrl.measureError"\n\t\t\tselected-insight="$ctrl.selectedInsight"\n\t\t></qv-selection-insights-summary>\n\t</div>\n\t<qv-selection-insights-card-container\n\t\tng-show="!$ctrl.showLoading && $ctrl.selectionInsightsState === $ctrl.states.INSIGHTS_FOUND"\n\t\tnew-measure-chosen="$ctrl.newMeasureChosen"\n\t\tnew-selection="$ctrl.newSelection"\n\t\tmeasure="$ctrl.measure"\n\t\tshow-loading="$ctrl.showLoading"\n\t\tinsights="$ctrl.insights"\n\t\topen-card="$ctrl.openCard"\n\t\tactive-card="$ctrl.activeCard"\n\t\tclass="qv-selection-insights-card-container"\n\t\tshow-fields="$ctrl.showFields"\n\t\tloading-cards="$ctrl.loadingCards"\n\t\tcard-is-insight="$ctrl.cardIsInsight"\n\t></qv-selection-insights-card-container>\n\t\x3c!-- LOADING --\x3e\n\t<div class="qv-selections-insights-loading" ng-if="$ctrl.showLoading">\n\t\t<div class="spinner-container">\n\t\t\t<qv-spinner\n\t\t\t\tshow="$ctrl.showLoading"\n\t\t\t\tcenter-in-parent="true"\n\t\t\t></qv-spinner>\n\t\t</div>\n\t\t<div\n\t\t\tclass="loading-message"\n\t\t\tq-translation="SelectionInsights.Loading"\n\t\t></div>\n\t</div>\n\n\t\x3c!-- No selection has been made --\x3e\n\t<div\n\t\tclass="qv-selections-no-insights"\n\t\tng-if="!$ctrl.showLoading && $ctrl.selectionInsightsState === $ctrl.states.NO_SELECTIONS"\n\t>\n\t\t<div class="no-insights-icon"></div>\n\t\t<p\n\t\t\tclass="qv-selections-insights--p"\n\t\t\tq-translation="ExploreSelections.NoInsights"\n\t\t></p>\n\t</div>\n\n\t\x3c!-- AI is not supported for this app --\x3e\n\t<div\n\t\tclass="qv-selections-no-insights"\n\t\tng-if="!$ctrl.showLoading && $ctrl.selectionInsightsState === $ctrl.states.UNSUPPORTED"\n\t>\n\t\t<div class="no-insights-icon"></div>\n\t\t<p class="qv-selections-insights--p" ng-bind-html="$ctrl.errorMsg"></p>\n\t</div>\n\n\t\x3c!--\n\t\tUser opened the selection insights panel for the first time after making selections\n\t--\x3e\n\t<div\n\t\tclass="qv-selections-generate-insights qv-selections-no-insights"\n\t\tng-if="!$ctrl.showLoading && $ctrl.selectionInsightsState === $ctrl.states.GENERATE_INSIGHTS"\n\t>\n\t\t<div class="no-insights-icon"></div>\n\t\t<p\n\t\t\tq-translation="ExploreSelections.GenerateInsights"\n\t\t\tclass="qv-selections-insights--p"\n\t\t></p>\n\t\t<button\n\t\t\ttid="explore-selections-generate-insight-button"\n\t\t\tclass="lui-button lui-button--success"\n\t\t\tq-translation="ExploreSelections.GenerateInsights.Button"\n\t\t\tng-click="$ctrl.generateInsights()"\n\t\t></button>\n\t</div>\n\n\t\x3c!-- User has made a selection but no insights were found --\x3e\n\t<div\n\t\tclass="qv-selections-no-insights"\n\t\tng-if="!$ctrl.showLoading && $ctrl.selectionInsightsState === $ctrl.states.NO_INSIGHTS"\n\t>\n\t\t<div class="no-insights-icon"></div>\n\t\t<p\n\t\t\tclass="qv-selections-insights--p"\n\t\t\tq-translation="ExploreSelections.NoInsightsWithSelection.Paragraph1"\n\t\t></p>\n\t\t\x3c!--\n\t\t\tIf show fields checkbox is unchecked, we tell them to check it since they got no master item insights\n\t\t--\x3e\n\t\t<div\n\t\t\tng-if="!$ctrl.showFields"\n\t\t\tclass="select-fields"\n\t\t\tq-translation="ExploreSelections.NoInsightsWithSelection.Paragraph3"\n\t\t></div>\n\t</div>\n\n\t\x3c!-- Insights details --\x3e\n\t<qv-selection-insights-details\n\t\tng-show="$ctrl.selectionInsightsState === $ctrl.states.INSIGHTS_FOUND"\n\t\tshow-insight-details="$ctrl.showInsightDetails"\n\t\tselected-insight="$ctrl.selectedInsight"\n\t\tlistbox="$ctrl.listbox"\n\t\tcard-is-insight="$ctrl.cardIsInsight"\n\t\tback-to-selections="$ctrl.backToSelections()"\n\t\tlayout="$ctrl.layout"\n\t\tshowing="$ctrl.showing"\n\t></qv-selection-insights-details>\n</div>\n'},function(t,e){t.exports='<lui-dialog class="selection-insights-dialog" x-variant="{{::variant}}">\n\t<lui-dialog-header>\n\t\t<lui-dialog-title\n\t\t\tq-translation="SelectionInsights.SummarySelection.HelpTitle"\n\t\t></lui-dialog-title>\n\t</lui-dialog-header>\n\t<lui-dialog-body class="q-modal-loading">\n\t\t<p q-translation="SelectionInsights.SummarySelection.HelpText"></p>\n\t</lui-dialog-body>\n\t<lui-dialog-footer>\n\t\t<button\n\t\t\tclass="lui-button close-button"\n\t\t\tng-click="closeDialog();"\n\t\t\tq-translation="Common.Close"\n\t\t\ttid="selection-insights-dialog-help-button"\n\t\t></button>\n\t</lui-dialog-footer>\n</lui-dialog>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(862),n(234),n(95),n(220)],a=function(t,e,n,i){t.nativeComponent("qvSelectionInsightsCardContainer",{bindings:{showLoading:"<",insights:"=",openCard:"<",activeCard:"<",newMeasureChosen:"=",newSelection:"=",showFields:"<",loadingCards:"<",measure:"<",selectedInsight:"=",cardIsInsight:"<"},controller:["$timeout","qvSelectionInsightsService",function(t,e){var a=this;this.showLoading=true;this.insights=[];this.refreshActive=false;this.isRefreshing=false;this.hasInsights=true;this.itemString="";this.selectionContribution="";this.$onInit=function(){n.selectAll(".insight-bar-container svg").remove()};function s(){if(a.insights.length>0){var t=e.getInsightDetails(a.insights[0].dimension,a.app).selectedMeasure.selected.percentage/100;a.selectionContribution=a.getLocalizedPercentage(t)}}i.subscribe("selection/insights/updated",function(){t(function(){a.hasInsights=a.insights.length>0;s()})});i.subscribe("selection/insight/draw",function(e){t(function(){n.select("#insightCard"+e.index+" .insight-bar-container svg").remove();o(e.insight,e.index)})});i.subscribe("selection/insights/refresh",function(){a.isRefreshing=true});i.subscribe("selection/insights/refreshed",function(){a.isRefreshing=false;a.refreshActive=false});i.subscribe("selection/insights/new",function(){a.isRefreshing=false;a.refreshActive=false});i.subscribe("selection/insights/measure/cancel",function(){a.refreshActive=false});i.subscribe("selection/insights/fields/change",function(){a.refreshActive=true});i.subscribe("selection/insights/selection/changed",function(){a.refreshActive=true});i.subscribe("selection/insights/current-selection",function(t){r(e.getSelectionItems(t))});function r(t){if(t){a.itemString="";t.forEach(function(e,n){t.length-1===n?a.itemString+=e.name:a.itemString+=e.name+", "})}}this.getLocalizedPercentage=function(t){return e.getLocalizedPercentage(t)};this.getMeasurePercentage=function(t){var e=t.counts.excluded+t.counts.included;var n=t.counts.excluded<t.counts.included?t.counts.excluded:t.counts.included;var i=n/e*100;var s=Math.round(10*i)/100;s=a.getLocalizedPercentage(s/10);return s};function o(t,e){var i=n.select("#insightCard"+e+" .insight-bar-container").append("svg").attr("width",44).attr("height",125);var a=i.append("g");var s=t.counts.excluded/(t.counts.excluded+t.counts.included)*100/100*124;var r=t.counts.included/(t.counts.excluded+t.counts.included)*100/100*124;a.append("rect").style("fill","#A9A9A9").attr("width",12).attr("height",Math.ceil(s)).attr("y",Math.ceil(r)).attr("x",0);a.append("rect").style("fill","white").style("stroke-width",1).style("stroke","#E6E6E6").attr("width",12).attr("height",Math.ceil(r)).attr("y",0).attr("x",0);var o=[];var l=Math.ceil(r)+Math.ceil(s)/2;o.push([{x:12,y:l},{x:28,y:38}]);var c=n.svg.line().x(function(t){return t.x}).y(function(t){return t.y});var u=i.append("g").attr("class","lines");u.selectAll("path").data(o).enter().append("path").attr({d:c,"stroke-dasharray":"790 790","stroke-dashoffset":0}).style("stroke",function(t,e){return e>1?"white":"#A9A9A9"}).style("stroke-width","1").attr("opacity",1)}this.$onDestroy=function(){i.unsubscribe("selection/insights/updated");i.unsubscribe("selection/insights/fields/change");i.unsubscribe("selection/insights/measure/cancel");i.unsubscribe("selection/insights/selection/changed");i.unsubscribe("selection/insights/refresh");i.unsubscribe("selection/insights/new");i.unsubscribe("selection/insights/refreshed");i.unsubscribe("selection/insight/draw");i.unsubscribe("selection/insights/current-selection")}}],template:e})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div tid="selection-insights-card-container" class="qv-selections-insights-cards-container" ng-show="!$ctrl.isRefreshing && $ctrl.hasInsights">\n\t<div ng-show="!$ctrl.showLoading" class="qv-selections-empty-cards">\n\t\t<div tid="current-selections-card" class="card selection-insights-card selection-insights-card--current-selection" ng-class="{\'active\': $ctrl.activeCard === -1 && !$ctrl.cardIsInsight}" ng-click="$ctrl.openCard(-1)" tabindex="0"> \n\t\t\t<div tid="no-longer-valid-overlay" class="no-longer-valid-overlay" ng-if="$ctrl.refreshActive">\n\t\t\t\t<div class="gray-overlay"></div>\n\t\t\t\t<span class="no-longer-valid-text" q-translation="SelectionInsights.Refresh.NoLongerValid"></span>\n\t\t\t</div>\n\t\t\t<div class="insight-card-content selection-insights-card--current-selection-content">\n\t\t\t\t<div class="insight-card-body">\n\t\t\t\t\t<div class="insight-dimension-title">\n\t\t\t\t\t\t<div class="insight-dimension-name" title="{{$ctrl.itemString}}">{{$ctrl.itemString}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="insight-card-body-your-selections" q-translation="SelectionInsights.CardSummaryYourSelections" q-title-translation="SelectionInsights.CardSummaryYourSelections"></div>\n\t\t\t\t\t<div class="insight-card-body-account" q-translation="SelectionInsights.CardSummaryAccountFor"></div>\n\t\t\t\t\t<div class="insight-measure-title">\n\t\t\t\t\t\t<div class="insight-current-selection-value" ng-show="$ctrl.selectionContribution">\n\t\t\t\t\t\t\t{{ $ctrl.selectionContribution }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="insight-measure-name" title="">\n\t\t\t\t\t\t\t{{ $ctrl.measure }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="selection-insights--other-fields" q-translation="SelectionInsights.FoundOtherFields"></div>\n\t\t<div tid="selection-insights-card" ng-repeat="insight in $ctrl.insights track by $index" id="insightCard{{ $index }}" class="card selection-insights-card insight-card" ng-class="{\'active\': $ctrl.activeCard === $index && $ctrl.cardIsInsight, \'disabled\': $ctrl.refreshActive || !insight.show, \'inactive\': insight.summaryNaN }"\n\t\t ng-click="$ctrl.openCard($index)" tabindex="0">\n\t\t\t<div tid="no-longer-valid-overlay" class="no-longer-valid-overlay" ng-if="$ctrl.refreshActive">\n\t\t\t\t<div class="gray-overlay"></div>\n\t\t\t\t<span class="no-longer-valid-text" q-translation="SelectionInsights.Refresh.NoLongerValid"></span>\n\t\t\t</div>\n\t\t\t<div class="insight-bar-container"></div>\n\t\t\t<div class="insight-card-content">\n\t\t\t\t<div class="insight-card-body">\n\t\t\t\t\t<div class="insight-dimension-title">\n\t\t\t\t\t\t<div class="insight-dimension-name" title="{{ insight.dimension }}">\n\t\t\t\t\t\t\t{{ insight.dimension }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div tid="insight-counts-summary" class="insight-card-body-your-selections" title="{{insight.counts.summary}}">{{insight.counts.summary}}</div>\n\t\t\t\t\t<div class="insight-card-body-account" q-translation="SelectionInsights.CardSummaryAccountFor"></div>\n\t\t\t\t\t<div class="insight-measure-title" ng-if="!insight.summaryError && !insight.summaryNaN && insight.show">\n\t\t\t\t\t\t<div class="insight-measure-value">\n\t\t\t\t\t\t\t{{ insight.summaryString }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="insight-measure-name" title="{{ insight.measure }}">\n\t\t\t\t\t\t\t{{ insight.measure }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="insight-measure-title" ng-if="insight.summaryError">\n\t\t\t\t\t\t<span class="timeout-error" q-translation="SelectionInsights.ErrorTimeout"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="insight-measure-title" ng-if="!insight.show && !insight.summaryNaN && !insight.summaryError">\n\t\t\t\t\t\t<span tid="selection-insight-error-calculation" class="timeout-error" q-translation="SelectionInsights.ErrorCalculations"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="insight-measure-title" ng-if="insight.summaryNaN">\n\t\t\t\t\t\t<span class="invalid-error" q-translation="SelectionInsights.InvalidMeasure"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div ng-if="$ctrl.showLoading" class="qv-selections-empty-cards">\n\t\t\t\t<div class="empty card"></div>\n\t\t\t\t<div class="empty card"></div>\n\t\t\t\t<div class="empty card"></div>\n\t\t\t\t<div class="empty card"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div id="cardLoading" class="card loading-card selection-insights-card inactive" ng-if="$ctrl.loadingCards">\n\t\t\t<div class="insight-bar-container">\n\t\t\t\t<div class="loading-line bar"></div>\n\t\t\t</div>\n\t\t\t<div class="insight-card-content">\n\t\t\t\t<div class="insight-card-body">\n\t\t\t\t\t<div class="loading-line title"></div>\n\t\t\t\t\t<div class="loading-line count"></div>\n\t\t\t\t\t<div class="loading-line contribution"></div>\n\t\t\t\t\t<div class="measure-container">\n\t\t\t\t\t\t<div class="loading-line percent"></div>\n\t\t\t\t\t\t<div class="loading-line measure"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n\n\x3c!-- LOADING --\x3e\n<div class="qv-selections-insights-loading" ng-if="$ctrl.isRefreshing">\n\t<div class="spinner-container">\n\t\t<qv-spinner show="$ctrl.isRefreshing" center-in-parent="true"></qv-spinner>\n\t</div>\n\t<div class="loading-message" q-translation="SelectionInsights.Loading"></div>\n</div>\n\n\x3c!-- NO INSIGHTS FOUND --\x3e\n<div class="qv-selections-no-insights" ng-show="!$ctrl.isRefreshing && !$ctrl.hasInsights">\n\t<div class="no-insights-icon"></div>\n\t<p class="qv-selections-insights--p" q-translation="ExploreSelections.NoInsightsWithSelection.Paragraph1"></p>\n\t<div ng-if="!$ctrl.showFields" class="select-fields" q-translation="ExploreSelections.NoInsightsWithSelection.Paragraph3"></div>\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(864),n(284),n(95),n(91),n(234),n(103),n(93),n(865),n(220)],a=function(t,e,n,i,a,s,r,o){t.nativeComponent("qvSelectionInsightsDetails",{bindings:{showInsightDetails:"<",selectedInsight:"<",listbox:"<",layout:"<",cardIsInsight:"<",backToSelections:"&",showing:"="},controller:["$timeout","qvSelectionInsightsService",function(t,e){var l=this;this.detailsTitle="";this.measure="";this.selectionHelp="";this.refreshActive=false;this.selectionInsightsMeasureBarTitle="";this.hasLockedSelections=false;this.selectionsBarTotal="";this.options={isReadonly:true,isPopover:false,selections:false,showSearch:true};this.showExcludedValues=false;this.celloptions={selections:false};l.selectionInsightsMeasureBarTitle=function(){if(l.selectedInsight&&l.selectedInsight.measureAggregation)return a.get("SelectionInsights.MeasureBarTitle",[l.selectedInsight.measureAggregation[0].toUpperCase()+l.selectedInsight.measureAggregation.slice(1),l.selectedInsight.measure])};l.selectionsBarTotal=function(){if(l.selectedInsight&&l.selectedInsight.selectedMeasure.total)return a.get("SelectionInsights.SelectionsBarTotal",[l.selectedInsight.selectedMeasure.total])};l.countBarTotal=function(){if(l.selectedInsight&&l.selectedInsight.counts.excluded&&l.selectedInsight.counts.included)return a.get("SelectionInsights.CountBarTotal",[l.selectedInsight.counts.excluded+l.selectedInsight.counts.included])};i.subscribe("selection/insights/details/negative",function(t){l.showExcludedValues=false;l.measure=t.measure;l.detailsTitle=a.get("SelectionInsights.DimensionContributionsTitle",["<strong>"+t.dimension+"</strong>","<strong>"+t.measure+"</strong>"]);l.selectionHelp=a.get("SelectionInsights.SelectionHelp","<strong>"+t.dimension+"</strong>");c(t)});i.subscribe("selection/insights/details/updated",function(t){l.showExcludedValues=false;l.measure=t.measure;l.hasLockedSelections=e.isHasLockedSelections(l.layout);l.detailsTitle=a.get("SelectionInsights.DimensionContributionsTitle",["<strong>"+t.dimension+"</strong>","<strong>"+t.measure+"</strong>"]);l.selectionHelp=a.get(l.hasLockedSelections?"SelectionInsights.SelectionHelpWithLockedSelections":"SelectionInsights.SelectionHelp","<strong>"+t.dimension+"</strong>");d()});i.subscribe("selection/insights/measure/cancel",function(){l.refreshActive=false});i.subscribe("selection/insights/fields/change",function(){l.refreshActive=true});i.subscribe("selection/insights/updated",function(){l.refreshActive=false});function c(t){s.selectAll(".bars-container svg").remove();var e=[{name:"excluded",value:t.counts.excluded,label:t.counts.excluded},{name:"included",value:t.counts.included,label:t.counts.included}];u(e,"value");var n=[{name:"excluded",value:t.excludedMeasure.qNumber,label:t.measureBreakdown.excluded.num},{name:"included",value:t.includedMeasure.qNumber,label:t.measureBreakdown.included.num}];u(n,"measure")}function u(t,e){var n=431;var i=120;var a=10;var r="";var o=45;var l=30;r="value"==e?" .val-dist":" .measure-dist";var c=s.select(".negative-chart"+r).append("svg").attr("width",i+o).attr("height",n+o);var u=c.append("g").attr("transform","translate("+a/2+",1)");var d=s.scale.ordinal().rangeRoundBands([0,i]);var p=s.scale.linear().range([n,0]);d.domain(t.map(function(t){return t.name}));"value"==e?p.domain([0,s.max(t,function(t){return t.value})]):p.domain(s.extent(t,function(t){return t.value}));var h=u.append("defs");h.append("filter").attr("id","blur").append("feGaussianBlur").attr("stdDeviation",5);if("value"==e){u.selectAll("bar").data(t).enter().append("rect").style("fill","rgba(0,0,0,0.1)").attr("x",function(t){return d(t.name)}).attr("width",d.rangeBand()).attr("y",function(t){return p(t.value)}).attr("height",function(t){return n-p(t.value)}).attr("filter","url(#blur)").attr("rx",3).attr("ry",3);u.selectAll("bar").data(t).enter().append("rect").style("fill",function(t){return"value"==e?"excluded"==t.name?"#A7A7A7":"#FFFFFF":"excluded"==t.name?"blue":"#FFFFFF"}).style("stroke",function(t){return"excluded"==t.name?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.27)"}).attr("x",function(t){return d(t.name)}).attr("width",d.rangeBand()).attr("y",function(t){return t.value>0?p(t.value):p(0)}).attr("height",function(t){return"value"==e?n-p(t.value):Math.abs(p(t.value)-p(0))}).attr("rx",3).attr("ry",3);u.selectAll("bar").data(t).enter().append("rect").style("fill",function(t){return"excluded"==t.name?"#A7A7A7":"#FFFFFF"}).attr("x",function(t){return d(t.name)}).attr("width",d.rangeBand()).attr("y",n-3).attr("height",3);var f=c.append("g").attr("class","barLabels").attr("transform","translate("+a/2+",0)");t.forEach(function(t,e){u.append("line").style("stroke","excluded"==t.name?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.27)").attr("x1",d(t.name)).attr("y1",n).attr("x2",d(t.name)).attr("y2",n-3);e>0&&u.append("line").style("stroke","excluded"==t.name?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.27)").attr("x1",d(t.name)+60).attr("y1",n).attr("x2",d(t.name)+60).attr("y2",n-3);var i=f.append("g");i.append("rect").attr("x",function(){return d(t.name)}).attr("width",d.rangeBand()).attr("height",2).attr("y",function(){return p(t.value)}).attr("opacity",0);i.append("text").attr("x",d(t.name)+l).attr("y",function(){return n-p(t.value)>n-l?p(t.value)+30:p(t.value)-10}).attr("text-anchor","middle").attr("class","grouped-bar-value-label").text(t.label).attr("fill",function(){var e="#404040";"excluded"==t.name&&n-p(t.value)>n-l&&(e="white");return e})})}else{h.append("pattern").attr("id","diagonalStripes").attr("patternUnits","userSpaceOnUse").attr("width",8).attr("height",8).attr("patternTransform","rotate(45)").append("rect").attr("width","2").attr("height","8").attr("fill","#4842b5");u.selectAll("bar").data(t).enter().append("rect").style("fill","rgba(0,0,0,0.1)").attr("x",function(t){return d(t.name)}).attr("width",d.rangeBand()).attr("y",function(t){return t.value>0?p(t.value):p(0)}).attr("height",function(t){return Math.abs(p(t.value)-p(0))}).attr("filter","url(#blur)").attr("rx",3).attr("ry",3);u.selectAll("bar").data(t).enter().append("rect").style("fill",function(t){return"excluded"==t.name?"#655DC6":"#FFFFFF"}).style("stroke",function(t){return"excluded"==t.name?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.27)"}).attr("x",function(t){return d(t.name)}).attr("width",d.rangeBand()).attr("y",function(t){return t.value>0?p(t.value):p(0)+1}).attr("height",function(t){return Math.abs(p(t.value)-p(0))}).attr("rx",3).attr("ry",3);u.selectAll("bar").data(t).enter().append("rect").style("fill",function(t){return"excluded"==t.name?"#655DC6":"#FFFFFF"}).attr("x",function(t){return d(t.name)}).attr("width",d.rangeBand()).attr("y",function(t){return t.value>0?p(t.value)-3:p(0)+1}).attr("height",2);var g=c.append("g").attr("class","barLabels").attr("transform","translate("+a/2+",0)");t.forEach(function(t,e){u.append("line").style("stroke","excluded"==t.name?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.27)").attr("x1",d(t.name)).attr("y1",function(){return t.value>0?p(t.value):p(0)}).attr("x2",d(t.name)).attr("y2",function(){return t.value>0?p(t.value)-3:p(0)+3});e>0&&u.append("line").style("stroke","excluded"==t.name?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.27)").attr("x1",d(t.name)+60).attr("y1",function(){return t.value>0?p(t.value):p(0)}).attr("x2",d(t.name)+60).attr("y2",function(){return t.value>0?p(t.value)-3:p(0)+3});"excluded"==t.name&&u.append("rect").attr("x",function(){return d(t.name)}).attr("width",d.rangeBand()).attr("y",function(){return t.value>0?p(t.value):p(0)}).attr("height",function(){return Math.abs(p(t.value)-p(0))}).attr("stroke","#504A9E").attr("rx",3).attr("ry",3).attr("fill","url(#diagonalStripes)");var n=g.append("g");n.append("rect").attr("x",function(){return d(t.name)}).attr("width",d.rangeBand()).attr("height",2).attr("y",function(){return t.value>0?p(t.value):p(0)}).attr("opacity",0);n.append("text").attr("x",d(t.name)+l).attr("y",function(){return t.value>0?p(t.value)+20:Math.abs(p(t.value)-p(0))<l?Math.abs(p(t.value)-p(0))+p(0)+20:Math.abs(p(t.value)-p(0))+p(0)-10}).attr("text-anchor","middle").attr("class","grouped-bar-label").text(t.label).attr("fill",function(){var e="#404040";"excluded"==t.name&&(e=Math.abs(p(t.value)-p(0))<l?"#655DC6":"#FFFFFF");return e})})}c.append("g").attr("class","x axis").append("line").attr("y1",p(0)).attr("y2",p(0)).attr("x2",i+a).attr("stroke","#404040").attr("stroke-width","3");var v=c.append("text").attr("x",i+2*a).attr("y",p(0)-28).attr("text-anchor","left").style("font-size","22px").attr("fill","#B3B3B3");v.append("tspan").attr("dx",0).attr("dy",4).text("+");v.append("tspan").attr("dx",-13).attr("dy",30).attr("fill","#404040").text("0");v.append("tspan").attr("dx",-10).attr("dy",30).text("-")}function d(){t(function(){var t=431;var e=213;s.selectAll(".connectors svg").remove();var n=s.select(".connectors .svg-container").append("svg").attr("width",e).attr("height",t);n.append("linearGradient").attr("id","area-gradient").attr("x1",0).attr("y1",0).attr("x2",5).attr("y2",0).selectAll("stop").data([{offset:"0%",color:"#A7A7A7"},{offset:"20%",color:"white"}]).enter().append("stop").attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color});var i=l.getPercentage("excluded")/100*t;var a=l.selectedInsight.measureBreakdown.excluded.percentage/100*t;var r=[{x:0,y:t-i},{x:e,y:t-a}];var o=[{x:0,y:i},{x:e,y:a}];var c=s.scale.linear().domain([0,s.max(o,function(t){return t.x})]).range([0,e]);var u=s.scale.linear().domain([0,t]).range([t,0]);var d=s.svg.area().x(function(t){return c(t.x)}).y0(t).y1(function(t){return u(t.y)});var p=s.svg.line().x(function(t){return t.x}).y(function(t){return t.y});var h=[];h.push(r);var f=n.append("g").attr("class","lines");f.selectAll("path").data(h).enter().append("path").attr({d:p,"stroke-dasharray":"3, 3","stroke-dashoffset":0}).style("stroke","#BEBEBE").style("stroke-width","1").attr("opacity",1);n.append("path").datum(o).attr("class","area").attr("d",d)})}this.getLocalizedPercentage=function(t){return e.getLocalizedPercentage(t)};this.getPercentageLocalized=function(t){if(l.selectedInsight){var e=l.selectedInsight.counts.excluded+l.selectedInsight.counts.included;return l.getLocalizedPercentage(l.selectedInsight.counts[t]/e)}return 0};this.getPercentage=function(t){if(l.selectedInsight){var e=l.selectedInsight.counts.excluded+l.selectedInsight.counts.included;return l.selectedInsight.counts[t]/e*100}return 0};this.showTable=function(t){l.showing={table:t,excluded:true};e.getTableVis(l.selectedInsight,true).then(function(t){l.selectedInsight.table=t})};this.toggleShowTableExcluded=function(t){l.showing={table:true,excluded:t};e.getTableVis(l.selectedInsight,t).then(function(t){l.selectedInsight.table=t})};this.selectExcluded=function(){var t=l.selectedInsight.dimension;var e=this.selectedInsight.dimensionId;l.showing={table:false,excluded:false};var a=l.layout.qSelectionObject.qSelections;if(void 0!==e)return o.getApp().then(function(t){t.getDimension(e).then(function(e){e.getDimension().then(function(e){var i=e.qFieldDefs[0].replace("=","");t.getField(i).then(function(t){return t.selectExcluded().then(function(){a.length>0&&a.forEach(function(t){n.currApp().field(t.qField).clear()})})})})})});n.currApp().field(t).selectExcluded().then(function(){a.length>0&&a.forEach(function(t){n.currApp().field(t.qField).clear()})});i.publish("selection/insights/close");r.trackEvent(r.customEvents.SELECT_POSSIBLE_CLICKED,{type:"clicked"})};this.selectPossible=function(){var t=l.selectedInsight.dimension;var e=this.selectedInsight.dimensionId;l.showing={table:false,excluded:false};var a=l.layout.qSelectionObject.qSelections;if(void 0!==e)return o.getApp().then(function(t){t.getDimension(e).then(function(e){e.getDimension().then(function(e){var i=e.qFieldDefs[0].replace("=","");t.getField(i).then(function(t){return t.selectPossible().then(function(){a.length>0&&a.forEach(function(t){n.currApp().field(t.qField).clear()})})})})})});n.currApp().field(t).selectPossible().then(function(){a.length>0&&a.forEach(function(t){n.currApp().field(t.qField).clear()})});i.publish("selection/insights/close");r.trackEvent(r.customEvents.SELECT_POSSIBLE_CLICKED,{type:"clicked"})};this.isLabelContained=function(t){var e=427;var n=55;var i=t/100*e;return n<i};this.isLabelSmall=function(t){var e=427;var n=65;var i=t/100*e;return n<i};this.getNegativeMeasureText=function(){return a.get("SelectionInsights.MeasureNegative",[l.selectedInsight.measureAggregation[0].toUpperCase()+l.selectedInsight.measureAggregation.slice(1),l.selectedInsight.measure,l.selectedInsight.dimension])};this.getNegativeMeasurePossible=function(){return a.get("SelectionInsights.MeasureNegativePossible",[l.selectedInsight.measureAggregation[0].toUpperCase()+l.selectedInsight.measureAggregation.slice(1),l.selectedInsight.measure,l.selectedInsight.dimension,"<span>"+l.selectedInsight.measureBreakdown.included.num+"</span>"])};this.getNegativeMeasureExcluded=function(){return a.get("SelectionInsights.MeasureNegativeExcluded",[l.selectedInsight.measureAggregation[0].toUpperCase()+l.selectedInsight.measureAggregation.slice(1),l.selectedInsight.measure,l.selectedInsight.dimension,"<span>"+l.selectedInsight.measureBreakdown.excluded.num+"</span>"])};this.$onDestroy=function(){i.unsubscribe("selection/insights/details/updated");i.unsubscribe("selection/insights/measure/cancel");i.unsubscribe("selection/insights/updated");i.unsubscribe("selection/insights/fields/change");i.unsubscribe("selection/insights/details/negative")}}],template:e})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="qv-selections-insights-details" ng-show="$ctrl.showInsightDetails">\n\t<div class="main-details-wrapper" ng-class="{\'disabled\': $ctrl.refreshActive}">\n\t\t<div ng-if="$ctrl.refreshActive" class="gray-overlay"></div>\n\t\t<div class="current-selections-container" ng-show="!$ctrl.cardIsInsight">\n\t\t\t<div class="current-selections-container-inner">\n\t\t\t\t<qv-selection-insights-current selected-insight="$ctrl.selectedInsight" back-to-selections="$ctrl.backToSelections()"></qv-selection-insights-current>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="details-container" ng-show="$ctrl.cardIsInsight">\n\t\t\t<div class="details-container-inner">\n\t\t\t\t<div class="closeBtn">\n\t\t\t\t\t<button tid="back-to-selection-button" class="lui-button" ng-click="$ctrl.backToSelections()" q-translation="SelectionInsights.BackToSelections">\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div class="details-body">\n\t\t\t\t\t<div class="title details-title">\n\t\t\t\t\t\t<span tid="insight-details-title" ng-bind-html="$ctrl.detailsTitle"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div tid="insight-details-summary" class="detail-summary" ng-bind-html="$ctrl.selectedInsight.summaryStringLong"></div>\n\t\t\t\t\t<div class="qv-titles-and-bars">\n\t\t\t\t\t\t<div class="bars-titles">\n\t\t\t\t\t\t\t<div class="title-container longer" q-title-translation="{{ $ctrl.selectedInsight.dimension }}">\n\t\t\t\t\t\t\t\t<div tid="insights-with-selection-title" class="title-longer">\n\t\t\t\t\t\t\t\t\t{{ $ctrl.selectedInsight.dimension }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div tid="insight-with-selections-bar-total" class="bar-total" q-translation="SelectionInsights.CountBarTotal, {{$ctrl.selectedInsight.counts.excluded + $ctrl.selectedInsight.counts.included}}" title="{{$ctrl.countBarTotal()}}"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="title-container">\n\t\t\t\t\t\t\t\t<div tid="insights-without-selection-title" class="title-longer" q-translation="SelectionInsights.MeasureBarTitle, {{$ctrl.selectedInsight.measureAggregation[0].toUpperCase() + $ctrl.selectedInsight.measureAggregation.slice(1)}}, {{$ctrl.selectedInsight.measure}}"\n\t\t\t\t\t\t\t\t\ttitle="{{$ctrl.selectionInsightsMeasureBarTitle()}}"></div>\n\t\t\t\t\t\t\t\t<div tid="insight-without-selections-bar-total" class="bar-total" q-translation="SelectionInsights.SelectionsBarTotal, {{$ctrl.selectedInsight.selectedMeasure.total}}" title="{{$ctrl.selectionsBarTotal()}}"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="bars-container negative-chart" ng-show="$ctrl.selectedInsight.isMeasureNegative && !$ctrl.showing.table">\n\t\t\t\t\t\t\t<div class="val-dist">\n\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="legend-dist">\n\t\t\t\t\t\t\t\t<div class="possible-legend">\n\t\t\t\t\t\t\t\t\t<div class="square">\n\t\t\t\t\t\t\t\t\t\t<div class="white-square"></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="legend-label" tid="possible-chart-legend" q-translation="SelectionInsights.Possible" q-title-translation="{{SelectionInsights.Possible}}"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="excluded-legend">\n\t\t\t\t\t\t\t\t\t<div class="square">\n\t\t\t\t\t\t\t\t\t\t<div class="gray-square"></div>\n\t\t\t\t\t\t\t\t\t\t<div class="purple-square"></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="legend-label" tid="excluded-chart-legend" q-translation="SelectionInsights.Excluded" q-title-translation="{{SelectionInsights.Excluded}}"></div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="measure-dist">\n\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="bars-container" ng-show="!$ctrl.selectedInsight.isMeasureNegative && !$ctrl.showing.table">\n\t\t\t\t\t\t\t<div class="value-bar" ng-class="{\'negative\': $ctrl.selectedInsight.isMeasureNegative}">\n\t\t\t\t\t\t\t\t<div tid="insight-with-selections-included-bar" class="bar included" ng-style="{height: ($ctrl.getPercentage(\'included\') /100) * 427 + \'px\'}">\n\t\t\t\t\t\t\t\t\t<div tid="insight-with-selections-included-measure-value" class="label" ng-style="{top: ($ctrl.getPercentage(\'included\')/100) * 427 + 5 + \'px\'}"\n\t\t\t\t\t\t\t\t\t\tng-class="{\'overlay-top\': !$ctrl.isLabelContained($ctrl.getPercentage(\'included\')), \'small\': !$ctrl.isLabelSmall($ctrl.getPercentage(\'included\'))}">\n\t\t\t\t\t\t\t\t\t\t{{ $ctrl.selectedInsight.counts.included }}\n\t\t\t\t\t\t\t\t\t\t<div tid="insight-with-selections-included-measure-percentage" class="percentage">\n\t\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\t$ctrl.getPercentageLocalized(\n\t\t\t\t\t\t\t\t\t\t\t"included"\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div tid="insight-with-selections-excluded-bar" class="bar excluded" ng-style="{height: ($ctrl.getPercentage(\'excluded\') / 100) * 427 + \'px\'}">\n\t\t\t\t\t\t\t\t\t<div tid="insight-with-selections-excluded-measure-value" class="label" ng-style="{bottom: ($ctrl.getPercentage(\'excluded\')/100) * 427 + 5 + \'px\'}"\n\t\t\t\t\t\t\t\t\t\tng-class="{\'overlay-bottom\': !$ctrl.isLabelContained($ctrl.getPercentage(\'excluded\')), \'small\': !$ctrl.isLabelSmall($ctrl.getPercentage(\'excluded\'))}">\n\t\t\t\t\t\t\t\t\t\t{{ $ctrl.selectedInsight.counts.excluded }}\n\t\t\t\t\t\t\t\t\t\t<div tid="insight-with-selections-excluded-measure-percentage" class="percentage">\n\t\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\t$ctrl.getPercentageLocalized(\n\t\t\t\t\t\t\t\t\t\t\t"excluded"\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="connectors" ng-if="!$ctrl.selectedInsight.isMeasureNegative">\n\t\t\t\t\t\t\t\t<div class="svg-container">\n\t\t\t\t\t\t\t\t\t<svg width="215" height="429"></svg>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="possible-label" q-translation="SelectionInsights.PossibleValues"></div>\n\t\t\t\t\t\t\t\t<div class="excluded-label" q-translation="SelectionInsights.ExcludedValues"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="measure-bar excluded-insight" ng-if="!$ctrl.selectedInsight.isMeasureNegative">\n\t\t\t\t\t\t\t\t<div tid="insight-without-selections-included-bar" class="bar included" ng-style="{height: ($ctrl.selectedInsight.measureBreakdown.included.percentage/100) * 427 + \'px\'}">\n\t\t\t\t\t\t\t\t\t<div tid="insight-without-selections-included-measure-value" class="label" ng-style="{top: ($ctrl.selectedInsight.measureBreakdown.included.percentage/100) * 427 + 5 + \'px\'}"\n\t\t\t\t\t\t\t\t\t\tng-class="{\'overlay-top\': !$ctrl.isLabelContained($ctrl.selectedInsight.measureBreakdown.included.percentage), \'small\': !$ctrl.isLabelSmall($ctrl.selectedInsight.measureBreakdown.included.percentage)}">\n\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t$ctrl.selectedInsight.measureBreakdown\n\t\t\t\t\t\t\t\t\t\t.included.num\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t<div tid="insight-without-selections-included-measure-percentage" class="percentage">\n\t\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\t$ctrl.getLocalizedPercentage(\n\t\t\t\t\t\t\t\t\t\t\t$ctrl.selectedInsight\n\t\t\t\t\t\t\t\t\t\t\t.measureBreakdown.included\n\t\t\t\t\t\t\t\t\t\t\t.percentage / 100\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div tid="insight-without-selections-excluded-bar" class="bar excluded" ng-style="{height: ($ctrl.selectedInsight.measureBreakdown.excluded.percentage/100) * 427 + \'px\'}">\n\t\t\t\t\t\t\t\t\t<div tid="insight-without-selections-excluded-measure-value" class="label" ng-style="{bottom: ($ctrl.selectedInsight.measureBreakdown.excluded.percentage/100) * 427 + 5 + \'px\'}"\n\t\t\t\t\t\t\t\t\t\tng-class="{\'overlay-bottom\': !$ctrl.isLabelContained($ctrl.selectedInsight.measureBreakdown.excluded.percentage), \'small\': !$ctrl.isLabelSmall($ctrl.selectedInsight.measureBreakdown.excluded.percentage)}">\n\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t$ctrl.selectedInsight.measureBreakdown\n\t\t\t\t\t\t\t\t\t\t.excluded.num\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t<div tid="insight-without-selections-excluded-measure-percentage" class="percentage">\n\t\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\t$ctrl.getLocalizedPercentage(\n\t\t\t\t\t\t\t\t\t\t\t$ctrl.selectedInsight\n\t\t\t\t\t\t\t\t\t\t\t.measureBreakdown.excluded\n\t\t\t\t\t\t\t\t\t\t\t.percentage / 100\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="bars-container" style="display: block" ng-show="$ctrl.showing.table">\n\t\t\t\t\t\t\t<div class="table-container" ng-class="{\'possible\': !$ctrl.showing.excluded}">\n\t\t\t\t\t\t\t\t<qv-object tabindex="-1" class="cell-content" model="$ctrl.selectedInsight.table" options="$ctrl.celloptions"></qv-object>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="toggle-values" ng-class="{\'show-table\': !$ctrl.showing.table}">\n\t\t\t\t\t\t\t<button tid="show-table-button" ng-if="!$ctrl.showing.table" class="lui-button show-table--button" ng-click="$ctrl.showTable(true)">\n\t\t\t\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--table"></span><span class="lui-button__text" q-translation="SelectionInsights.ShowValues"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button tid="show-table-button" ng-if="!$ctrl.showing.excluded && $ctrl.showing.table" class="lui-button show-vis--button" ng-click="$ctrl.toggleShowTableExcluded(true)">\n\t\t\t\t\t\t\t\t<span class="lui-button__text" q-translation="SelectionInsights.ViewExcluded"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button tid="show-table-button" ng-if="$ctrl.showing.excluded && $ctrl.showing.table" class="lui-button show-vis--button" ng-click="$ctrl.toggleShowTableExcluded(false)">\n\t\t\t\t\t\t\t\t<span class="lui-button__text" q-translation="SelectionInsights.ViewPossible"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button tid="show-table-button" ng-if="$ctrl.showing.table" class="lui-button show-vis--button" ng-click="$ctrl.showTable(false)">\n\t\t\t\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--back"></span><span class="lui-button__text" q-translation="SelectionInsights.ShowVisualization"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="insight-summary-footer">\n\t\t\t\t<div class="help-text" ng-bind-html="$ctrl.selectionHelp"></div>\n\t\t\t\t<div class="btns" ng-if="!$ctrl.hasLockedSelections">\n\t\t\t\t\t<button tid="select-possible-button" class="lui-button selection-btn" ng-click="$ctrl.selectPossible()" q-translation="Selections.Possible"></button>\n\t\t\t\t\t<button tid="select-excluded-button" class="lui-button selection-btn" ng-click="$ctrl.selectExcluded()" q-translation="Selections.Excluded"></button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'},function(t,e,n){"use strict";var i,a;function s(t){s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return s(t)}!(i=[n(48),n(96),n(866),n(91),n(95),n(234),n(220)],a=function(t,e,n,i,a,r){t.nativeComponent("qvSelectionInsightsCurrent",{bindings:{selectedInsight:"<",backToSelections:"&"},controller:["$scope","qvSelectionInsightsService","qvChartTooltipService","$timeout",function(t,n,o,l){var c=this,u,d=false;this.items=[];this.app=null;this.model=null;this.selectionsTitle="";this.measure="";this.selectionsCaption="";this.selectionsBarTotal="";a.subscribe("selection/insights/current-selection",function(t){c.items=n.getSelectionItems(t)});a.subscribe("selection/insights/current/open",function(t){var e={measure:t.insight.measure,aggr:t.insight.measureAggregation,dimension:t.insight.dimension,contribution:t.insight.selectedMeasure.selected.percentage.toFixed(1)};var n=t.insight.isSelectionNegative?t.insight.selectedMeasure.selected.num:t.insight.selectedMeasure.selected.percentage.toFixed(1)+"%";c.measure=e.measure;c.selectionsTitle=i.get("SelectionInsights.SelectionsContributionsTitle","<strong>"+e.measure.substring(0,40)+"</strong>");c.selectionsCaption=i.get("SelectionInsights.SelectionContributionCaption",["<span>"+e.measure.substring(0,40)+"</span>","<span>"+n+"</span>","<span>"+(e.aggr[0].toUpperCase()+e.aggr.slice(1))+"</span>"]);r.selectAll(".negative-chart.select-measure-dist svg").remove();if(t.insight.isSelectionNegative){var a=[{name:"selected",value:t.insight.selectedMeasure.selected.qNum,label:t.insight.selectedMeasure.selected.num},{name:"excluded",value:t.insight.selectedMeasure.excluded.qNum,label:t.insight.selectedMeasure.excluded.num}];p(a)}});function p(t){var e=431;var n=120;var i=10;var a=".negative-chart.select-measure-dist";var s=45;var o=30;var l=r.select(".negative-chart"+a).append("svg").attr("width",n+s).attr("height",e+s);var c=l.append("g").attr("transform","translate("+i/2+",1)");var u=r.scale.ordinal().rangeRoundBands([0,n]);var d=r.scale.linear().range([e,0]);u.domain(t.map(function(t){return t.name}));d.domain(r.extent(t,function(t){return t.value}));var p=c.append("defs");p.append("filter").attr("id","blur").append("feGaussianBlur").attr("stdDeviation",5);p.append("pattern").attr("id","diagonalStripes").attr("patternUnits","userSpaceOnUse").attr("width",8).attr("height",8).attr("patternTransform","rotate(45)").append("rect").attr("width","2").attr("height","8").attr("fill","#4dc753");c.selectAll("bar").data(t).enter().append("rect").style("fill","rgba(0,0,0,0.1)").attr("x",function(t){return u(t.name)}).attr("width",u.rangeBand()).attr("y",function(t){return t.value>0?d(t.value):d(0)}).attr("height",function(t){return Math.abs(d(t.value)-d(0))}).attr("filter","url(#blur)").attr("rx",3).attr("ry",3);c.selectAll("bar").data(t).enter().append("rect").style("fill",function(t){return"selected"==t.name?"#6cd475":"#D8D8D8"}).style("stroke",function(t){return"selected"==t.name?"#37B342":"#959595"}).attr("x",function(t){return u(t.name)}).attr("width",u.rangeBand()).attr("y",function(t){return t.value>0?d(t.value):d(0)+1}).attr("height",function(t){return Math.abs(d(t.value)-d(0))}).attr("rx",3).attr("ry",3);c.selectAll("bar").data(t).enter().append("rect").style("fill",function(t){return"selected"==t.name?"#6cd475":"#D8D8D8"}).attr("x",function(t){return u(t.name)}).attr("width",u.rangeBand()).attr("y",function(t){return t.value>0?d(t.value)-3:d(0)+1}).attr("height",2);var h=l.append("g").attr("class","barLabels").attr("transform","translate("+i/2+",0)");t.forEach(function(t,e){c.append("line").style("stroke","selected"==t.name?"#37B342":"#959595").attr("x1",u(t.name)).attr("y1",function(){return t.value>0?d(t.value):d(0)}).attr("x2",u(t.name)).attr("y2",function(){return t.value>0?d(t.value)-3:d(0)+3});e>0&&c.append("line").style("stroke","selected"==t.name?"#37B342":"#959595").attr("x1",u(t.name)+60).attr("y1",function(){return t.value>0?d(t.value):d(0)}).attr("x2",u(t.name)+60).attr("y2",function(){return t.value>0?d(t.value)-3:d(0)+3});"selected"==t.name&&c.append("rect").attr("x",function(){return u(t.name)}).attr("width",u.rangeBand()).attr("y",function(){return t.value>0?d(t.value):d(0)}).attr("height",function(){return Math.abs(d(t.value)-d(0))}).attr("stroke","#504A9E").attr("stroke-width","0").attr("rx",3).attr("ry",3).attr("fill","url(#diagonalStripes)");var n=h.append("g");n.append("rect").attr("x",function(){return u(t.name)}).attr("width",u.rangeBand()).attr("height",2).attr("y",function(){return t.value>0?d(t.value):d(0)}).attr("opacity",0);n.append("text").attr("x",u(t.name)+o).attr("y",function(){return t.value>0?d(t.value)+20:Math.abs(d(t.value)-d(0))<o?Math.abs(d(t.value)-d(0))+d(0)+20:Math.abs(d(t.value)-d(0))+d(0)-10}).attr("text-anchor","middle").attr("class","grouped-bar-label").text(t.label).attr("fill",function(){var e="#414141";"selected"==t.name&&(e=Math.abs(d(t.value)-d(0))<o?"#2F9938":"#FFFFFF");return e})});l.append("g").attr("class","x axis").append("line").attr("y1",d(0)).attr("y2",d(0)).attr("x2",n+i).attr("stroke","#404040").attr("stroke-width","3");var f=l.append("text").attr("x",n+2*i).attr("y",d(0)-28).attr("text-anchor","left").style("font-size","22px").attr("fill","#B3B3B3");f.append("tspan").attr("dx",0).attr("dy",4).text("+");f.append("tspan").attr("dx",-13).attr("dy",30).attr("fill","#404040").text("0");f.append("tspan").attr("dx",-10).attr("dy",30).text("-")}c.selectionsBarTotal=function(){if(c.selectedInsight&&c.selectedInsight.selectedMeasure.total)return i.get("SelectionInsights.SelectionsBarTotal",[c.selectedInsight.selectedMeasure.total])};this.getLocalizedPercentage=function(t){return n.getLocalizedPercentage(t)};this.getSeparatorPos=function(){if(void 0!==c.items&&null!==c.selectedInsight&&void 0!==c.selectedInsight){var t=56;var e=427;if(c.selectedInsight.isSelectionNegative){var n=c.selectedInsight.selectedMeasure.selected.qNum;var i=c.selectedInsight.selectedMeasure.excluded.qNum;var a=0;e=431;var s=55;a=n<0?e-Math.abs(n)/2/((Math.abs(n)+i)/e):n/2/((Math.abs(i)+n)/e);return a+s}var r=38;var o=10;var l=(c.items.length*r+(c.items.length-1)*o)/2;var u=c.selectedInsight.selectedMeasure.selected.percentage/100*e/2;return t+Math.min(l,u)}};this.isLabelContained=function(t){var e=427;var n=55;var i=t/100*e;return n<i};this.getLabelFontSize=function(t){var e=427;var n=65;var i=t/100*e;return n<i?"24px":"36px"};this.getNegativeMeasureText=function(){return i.get("SelectionInsights.SelectionNegative",[c.selectedInsight.measureAggregation[0].toUpperCase()+c.selectedInsight.measureAggregation.slice(1),c.selectedInsight.measure])};function h(t){var e=t.qStateCounts;var n="";"object"===s(e)&&(n=" ("+(e.qSelected+e.qSelectedExcluded+e.qLocked+e.qLockedExcluded)+"/"+t.qTotal+")");return n}t.openTooltip=function(n,i){if(d||e.utils.touch)return;t.cancelTooltip();u=l(function(){d=true;var t=i.translation;var e=h(i);o.open({content:[{header:(i.qReadableName||i.qField)+e,rows:[{content:t}]}],position:{x:n.clientX,y:n.clientY},alwaysOnTop:true,direction:"bottom",template:"current-selections-tooltip-template.ng.html"})},500)};t.closeTooltip=function(){d=false;t.cancelTooltip();o.close()};t.cancelTooltip=function(){l.cancel(u)};this.getNegativeMeasurePossible=function(){return i.get("SelectionInsights.SelectionNegativePossible",[c.selectedInsight.measureAggregation[0].toUpperCase()+c.selectedInsight.measureAggregation.slice(1),c.selectedInsight.measure,"<span>"+c.selectedInsight.measureBreakdown.included.num+"</span>"])};this.getNegativeMeasureExcluded=function(){return i.get("SelectionInsights.SelectionNegativeExcluded",[c.selectedInsight.measureAggregation[0].toUpperCase()+c.selectedInsight.measureAggregation.slice(1),c.selectedInsight.measure,"<span>"+c.selectedInsight.measureBreakdown.excluded.num+"</span>"])};this.isLabelSmall=function(t){var e=427;var n=65;var i=t/100*e;return n<i};this.getVerticalHeight=function(){if(void 0!==c.items&&null!==c.selectedInsight&&void 0!==c.selectedInsight)return c.selectedInsight.isSelectionNegative?431:40*c.items.length+11*(c.items.length-1)};this.$onDestroy=function(){a.unsubscribe("selection/insights/current-selection");a.unsubscribe("selection/insights/current/open")}}],template:n})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="closeBtn">\n\t<button tid="back-to-selection-button" class="lui-button" ng-click="$ctrl.backToSelections()" q-translation="SelectionInsights.BackToSelections"></button>\n</div>\n<div class="details-body">\n\t<div class="title current-selection-title">\n\t\t<span tid="selection-details-title" ng-bind-html="$ctrl.selectionsTitle"></span>\n\t</div>\n\t<div class="current-selection-caption">\n\t\t<div tid="selections-caption" ng-bind-html="$ctrl.selectionsCaption"></div>\n\t</div>\n\t<div class="current-selection-details">\n\t\t<div class="field-list">\n\t\t\t<div tid="selections-fields-title" class="fields-title" q-translation="SelectionInsights.YourSelections" q-title-translation="{{ SelectionInsights.YourSelections }}"></div>\n\t\t\t<div class="fields-items">\n\t\t\t\t<ul class="list" ng-show="$ctrl.items.length > 0">\n\t\t\t\t\t<li class="item" tid="selection-insight-details-user-selections" ng-class="{\'item-multi-state\': !item.isSingleState, \'multi-active\': multiPopoverFieldName && multiPopoverFieldName === item.qField}" ng-repeat="item in $ctrl.items track by item.qField" data-csid="{{ item.qField }}" tabindex="0"\n\t\t\t\t\t ng-keydown="handleKeyDown($event, item)" aria-label="{{ item.screenReaderLabel }}">\n\t\t\t\t\t\t<qv-current-selections-item ng-if="item.isSingleState" item="item"></qv-current-selections-item>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="separator" ng-class="{\'negative\': $ctrl.selectedInsight.isSelectionNegative}">\n\t\t\t<div class="legend-dist" ng-if="$ctrl.selectedInsight.isSelectionNegative">\n\t\t\t\t<div class="selected-legend">\n\t\t\t\t\t<div class="square">\n\t\t\t\t\t\t<div class="green-square"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="legend-label" tid="selected-chart-legend" q-translation="SelectionInsights.Selected" q-title-translation="{{ SelectionInsights.Selected }}"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="excluded-legend">\n\t\t\t\t\t<div class="square">\n\t\t\t\t\t\t<div class="gray-square"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="legend-label" tid="excluded-chart-legend" q-translation="SelectionInsights.Excluded" q-title-translation="{{ SelectionInsights.Excluded }}"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="vertical" ng-style="{height: $ctrl.getVerticalHeight() + \'px\'}"></div>\n\t\t\t<div class="horizontal" ng-style="{\'margin-top\': $ctrl.getSeparatorPos() + \'px\'}"></div>\n\t\t</div>\n\t\t<div class="chart">\n\t\t\t<div tid="selections-bar-title" class="bar-title" q-translation="SelectionInsights.SelectionsBarTitle, {{\n\t\t\t\t\t$ctrl.measure\n\t\t\t\t}}" q-translation-title="SelectionInsights.SelectionsBarTitle, {{\n\t\t\t\t\t$ctrl.measure\n\t\t\t\t}}"></div>\n\t\t\t<div tid="selections-bar-total" class="bar-total" title="{{ $ctrl.selectionsBarTotal() }}">\n\t\t\t\t{{ $ctrl.selectionsBarTotal() }}\n\t\t\t</div>\n\t\t\t<div class="bar selected" ng-if="!$ctrl.selectedInsight.isSelectionNegative" ng-style="{height: ($ctrl.selectedInsight.selectedMeasure.selected.percentage/100) * 427 + \'px\'}">\n\t\t\t\t<div tid="selected-measure-number" class="label" ng-style="{top: ($ctrl.selectedInsight.selectedMeasure.selected.percentage/100) * 427 + 5 + \'px\'}" ng-class="{\'overlay-top\': !$ctrl.isLabelContained($ctrl.selectedInsight.selectedMeasure.selected.percentage), \'small\': !$ctrl.isLabelSmall($ctrl.selectedInsight.selectedMeasure.selected.percentage)}">\n\t\t\t\t\t{{ $ctrl.selectedInsight.selectedMeasure.selected.num }}\n\t\t\t\t\t<div tid="selected-measure-percentage" class="percentage">\n\t\t\t\t\t\t{{\n\t\t\t\t\t\t$ctrl.getLocalizedPercentage(\n\t\t\t\t\t\t$ctrl.selectedInsight.selectedMeasure.selected\n\t\t\t\t\t\t.percentage / 100\n\t\t\t\t\t\t)\n\t\t\t\t\t\t}}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="bar excluded" ng-if="!$ctrl.selectedInsight.isSelectionNegative" ng-style="{height: ($ctrl.selectedInsight.selectedMeasure.excluded.percentage/100) * 427 + \'px\'}">\n\t\t\t\t<div tid="excluded-measure-number" class="label" ng-style="{bottom: ($ctrl.selectedInsight.selectedMeasure.excluded.percentage/100) * 427 + 5 + \'px\'}" ng-class="{\'overlay-bottom\': !$ctrl.isLabelContained($ctrl.selectedInsight.selectedMeasure.excluded.percentage), \'small\': !$ctrl.isLabelSmall($ctrl.selectedInsight.selectedMeasure.excluded.percentage)}">\n\t\t\t\t\t{{ $ctrl.selectedInsight.selectedMeasure.excluded.num }}\n\t\t\t\t\t<div tid="excluded-measure-percentage" class="percentage">\n\t\t\t\t\t\t{{\n\t\t\t\t\t\t$ctrl.getLocalizedPercentage(\n\t\t\t\t\t\t$ctrl.selectedInsight.selectedMeasure.excluded\n\t\t\t\t\t\t.percentage / 100\n\t\t\t\t\t\t)\n\t\t\t\t\t\t}}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="negative-chart select-measure-dist" ng-show="$ctrl.selectedInsight.isSelectionNegative"></div>\n\t\t</div>\n\t</div>\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(868),n(95),n(869),n(147),n(106),n(103),n(870)],a=function(t,e,n,i,a,s,r){t.nativeComponent("qvSelectionInsightsSummary",{bindings:{showLoading:"<",hasSelection:"<",measure:"=",newMeasureChosen:"=",newSelection:"=",showFields:"<",selectionInsightsState:"=",states:"=",measureError:"="},controller:["$scope","$timeout","luiPopover","qvSelectionInsightsService","qvSelectionInsightsSearchService",function(t,e,o,l,c){var u=this;this.showLoading=true;var d=[];this.fieldList=[];this.showFieldsChanged=false;this.currentMeasure=u.measure;function p(){e(function(){var t=document.getElementsByClassName("ai-change-field-input");t[0].focus()},100)}this.showChangeField=function(t){var e=["$scope",function(t){function e(e){var n=t.highlight;var i=c.getMatchingFields(e,n);t.measures=i.filter(function(t){return!t.masterItemMeasures});t.masterMeasures=i.filter(function(t){return t.masterItemMeasures})}function n(n){t.highlight=n;e(u.fieldList)}t.filterFields=n;t.onSelectMeasure=b;t.navigate=y;e(u.fieldList)}];h(i,e,t.currentTarget,"bottom",f)};function h(t,e,n,i,a){var s={template:t,controller:e,dock:i,alignTo:n,showArrow:true,autoFocus:false};var r=o.show(s);d.push(r);r.closed.then(function(){"function"===typeof a&&a()});p()}function f(){d.forEach(function(t,e){t.close();d.splice(e,1)})}function g(){l.getMeasures(u.showFields).then(function(t){u.fieldList=t})}function v(){a.getList().then(function(e){t.masterMeasuresListModel=e});s(t,"masterMeasuresListModel",function(){g()})}v();this.refreshInsights=function(){n.publish("selection/insights/refresh");u.newMeasureChosen=false;u.newSelection=false;u.showFieldsChanged&&m();return l.getInsightDimensions(u.showFields,u.selectedMeasure).then(function(t){n.publish("selection/insights/new",t);u.currentMeasure=u.measure}).catch(function(t){n.publish("selection/insights/error",t.error)})};this.$onChanges=function(t){if(void 0!==t.showFields&&!t.showFields.isFirstChange()){u.showFieldsChanged=true;u.newMeasureChosen=false;n.publish("selection/insights/fields/change")}};function m(){l.getMeasures(u.showFields).then(function(t){u.showFieldsChanged=false;u.fieldList=t})}n.subscribe("selection/insights/show",function(){u.showFieldsChanged&&m()});function b(t){u.newMeasureChosen=true;u.newSelection=false;u.measureError=false;u.selectedMeasure=t;u.measure=t.qName;f();r.trackEvent(r.customEvents.NEW_MEASURE_CHOSEN,{type:"clicked"});u.refreshInsights()}function y(t){b(t)}}],template:e})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="qv-selections-insights-cards-summary" ng-class="{\'empty\': $ctrl.showLoading}">\n\t<div ng-if="!$ctrl.showLoading">\n\t\t<div class="summary-text" ng-if="!$ctrl.newMeasureChosen && !$ctrl.newSelection && !$ctrl.showFieldsChanged">\n\t\t\t<span q-translation="SelectionInsights.SummarySelection"> </span>\n\t\t</div>\n\t\t<div class="measure-select">\n\t\t\t<div class="refresh-insights-new-selection" ng-if="!$ctrl.newMeasureChosen && ($ctrl.newSelection || $ctrl.showFieldsChanged) ">\n\t\t\t\t<p class="refresh-insights-paragraph" q-translation="SelectionInsights.Refresh.NewSelection"></p>\n\t\t\t\t<div class="refresh-insights--button-group">\n\t\t\t\t\t<button class="lui-button  lui-button--success refresh-insights--button onlyOne" q-translation="SelectionInsights.Refresh" ng-click="$ctrl.refreshInsights()"></button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<h2 q-translation="Common.Measure"></h2>\n\t\t\t<p q-translation="SelectionInsights.CalculatedOn"></p>\n\t\t\t<button tid="ai-measure-picker" class="ai-measure-picker lui-button" id="ai-measure-picker" ng-click="$ctrl.showChangeField($event)" tabindex="0" ng-disabled="$ctrl.showFieldsChanged || $ctrl.newSelection">\n\t\t\t\t<span class="ai-measure-picker-text">{{ $ctrl.measure }}</span><span class="lui-icon lui-button__icon small lui-icon--small" ng-class="{\'lui-icon--arrow-down\' : !match.expanded, \'lui-icon--arrow-up\': match.expanded}"></span>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="measure-error" ng-if="$ctrl.measureError" q-translation="SelectionInsights.ErrorNaN"></div>\n\t</div>\n</div>\n<div class="hr-div">\n\t<hr class="qv-selection-insights-hr" ng-if="$ctrl.selectionInsightsState === $ctrl.states.INSIGHTS_FOUND" />\n</div>'},function(t,e){t.exports='<lui-popover class="ai-change-field-popover ai-popover">\n\t<object-add-typeahead>\n\t\t<lui-popover-header>\n\t\t\t<div class="lui-input-group">\n\t\t\t\t<input class="lui-input lui-input-group__input ai-change-field-input" type="text" autocomplete="off" ng-model="search.term" qva-focus="autoFocus" ng-change="filterFields(search.term)" maxlength="255" object-add-typeahead-input />\n\t\t\t</div>\n\t\t</lui-popover-header>\n\t\t<div class="lui-popover__body lui-nopad popover-body" object-add-typeahead-menu>\n\t\t\t<ul class="lui-list">\n\t\t\t\t<div ng-if="masterMeasures.length > 0" class="object-add-popover-list-header" q-translation="Common.MasterMeasures"></div>\n\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="field in masterMeasures" ng-click="onSelectMeasure(field)" on-select="navigate(field)" object-add-typeahead-item="field">\n\t\t\t\t\t<span class="lui-list__text" qve-highlight text="{{ field.qName }}" query="highlight"></span>\n\t\t\t\t</li>\n\n\t\t\t\t<div ng-if="measures.length > 0" class="object-add-popover-list-header" q-translation="Common.Measures"></div>\n\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="field in measures" ng-click="onSelectMeasure(field)" on-select="navigate(field)" object-add-typeahead-item="field">\n\t\t\t\t\t<span class="lui-list__text" qve-highlight text="{{ field.qName }}" query="highlight"></span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\n\t\t\t<div class="no-hits" ng-if="fieldList.length === 0">\n\t\t\t\t<span><i q-translation="Toolbox.Search.Nohits" /></span>\n\t\t\t</div>\n\t\t</div>\n\t</object-add-typeahead>\n</lui-popover>'},function(t,e,n){"use strict";var i,a;!(i=[n(54),n(48),n(112)],a=function(t,e,n){e.service("qvSelectionInsightsSearchService",[function(){var e;function i(e,i){var a=[];var s;i?i=i?i.toLowerCase():"":i&&""!==i||(s=true);if(s)return e;a=t.uniq(e).filter(function(t){return n.librarySearchFn(t,i)});return n.localeOrderBy(a,function(t){return t.qName})}e={getMatchingFields:function t(e,n){return i(e,n)}};return e}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(872),n(873),n(306)],a=function(t,e,n){t.directive("qvGlobalSearch",function(){return{restrict:"E",template:e,controller:["$scope","$document","$element","$window",n],require:["qvGlobalSearch"],scope:true,replace:true,link:function t(){}}});return"<qv-global-search></qv-global-search>"}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div>\n\t<div class="qv-global-search" ng-class="{ \'overlay\': displaySuggestions || displayResult.data || displayResult.visuals }" ng-style="{paddingTop: toolbarHeight}" qva-outside="onOutsideSearch($event)" tid="globalSearch">\n\t\t<div class="zoomed-chart" ng-class="{\'animate-expand \': animateZoomedChart, \'animate-shrink\': !animateZoomedChart}">\n\t\t\t<div class="close-btn" ng-if="zoomedChart" tid="smartsearch-zoomed-chart">\n\t\t\t\t<button class="lui-fade-button" ng-click="minimizeExpandedChart()" tid="smartSearchExitZoomedChart">\n\t\t\t\t\t<span class="lui-fade-button__icon  lui-icon lui-icon--close lui-icon--large"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div class="chart" ng-if="zoomedChart">\n\t\t\t\t<qv-object tid="smartsearch-zoomed-chart-object" model="zoomedChart.model" options="zoomedChart.options"></qv-object>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<qv-global-search-input class="qv-global-search-input"></qv-global-search-input>\n\t\t<div class="qv-global-search-line" ng-if="!showMobileIndexProgressBar"></div>\n\t\t<qv-mobile-index-progress ng-if="isSmallDevice && query.length === 0 && isIndexClosedFeature"></qv-mobile-index-progress>\n\t\t<qv-global-search-history ng-if="isSearchHistoryFeature && searchInputFocused && query.length === 0"></qv-global-search-history>\n\t\t<div class="qv-global-search-dimmer" ng-if="query.length > 0 || forceShowDimmer" ng-style="dimmerStyles">\n\t\t\t<qv-global-search-result tid="globalSearch.ResultList"></qv-global-search-result>\n\t\t\t<div ng-show="scrollShow && !activity.show" class="scroll-affordance scroll-vertical"></div>\n\t\t</div>\n\t</div>\n\t<div class="qv-global-search-glass" ng-if="query.length > 0" qva-activate="close();"></div>\n</div>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(113),n(108),n(97),n(106),n(143),n(874),n(110),n(227),n(50),n(128),n(99),n(881),n(882),n(883),n(884),n(885),n(49),n(89),n(91),n(95),n(105),n(222),n(887),n(890),n(901),n(903),n(905),n(908),n(169),n(175)],a=function(t,e,n,i,a,s,r,o,l,c,u,d,p,h,f,g,v,m,b,y,S,x,q,I){function C(t,e,n,i){var a={qOffset:e,qCount:n,qGroupOptions:[],qGroupItemOptions:[]};if(t===f.data){a.qGroupOptions.push({qGroupType:"DatasetType",qOffset:0,qCount:-1});a.qGroupItemOptions.push({qGroupItemType:"Field",qOffset:0,qCount:i})}else if(t===f.visuals){a.qGroupOptions.push({qGroupType:"GenericObjectsType",qOffset:0,qCount:30});a.qGroupItemOptions.push({qGroupItemType:"GenericObject",qOffset:0,qCount:i})}return a}function w(t){var e={qContext:"CurrentSelections"};t&&(e.qCharEncoding="Utf16");return e}function D(t,e){t.dimmerStyles["max-height"]=e;t.dimmerStyles["height"]=e}function M(t){t.isSmallDeviceLandscape=u.orientation===u.Orientation.landscape&&u.isSmallDevice}function T(T,A,P,k){var E=e.getService("qvGlobalSearchDataService"),_=e.getService("$timeout"),F=e.getService("qvGlobalSelectionsService"),$=e.getService("qvGlobalSearchService"),N,O={search:{idCounter:0,requestState:h.idle,searchTerms:""},searchVisuals:{idCounter:0,requestState:h.idle,searchTerms:""},result:{requestState:h.idle},suggest:{idCounter:0,requestState:h.idle,suggestTerms:""}},L=function t(){_(function(){T.isSmallDevice=u.isSmallDevice;T.isSmallDevice&&(T.forceShowDimmer=false);M(T);j=G();H()})},R=function t(){T.isSmallDeviceLandscape=u.orientation===u.Orientation.landscape&&u.isSmallDevice;M(T);j=G();H()},H=function t(){D(T,A.find("body").height()-j)},G=function t(){return P.offset().top+P[0].offsetTop+P.find(".qv-global-search-input").outerHeight()},j=G(),V=P.parent().parent(),z=this;T.inClient=i.inClient();T.zoomedChart=false;T.focusState=new g(new v(g,this,T),g.Input);N=new o(P,T,this);T.forceShowDimmer=false;T.isSmallDevice=u.isSmallDevice;T.isSmallDeviceLandscape=u.orientation===u.Orientation.landscape&&u.isSmallDevice;T.showMobileIndexProgressBar=false;T.isObjectsFeature=n["SMARTSEARCH_OBJECTS"]&&T.inClient&&(T.isSmallDevice||T.options&&T.options.objectSearchIsOn);T.isSearchHistoryFeature=n["SEARCH_HISTORY"];T.isIndexClosedFeature=n["SMARTSEARCH_INDEX_CLOSE"];T.suggestedChartExpanded=null;x.subscribe(q.Events.PubSub.ExpandSmartSearchSuggestedChart,function(t){T.zoomedChart=t;T.animateZoomedChart=Boolean(t);T.suggestedChartExpanded=Boolean(t);t&&T.isSmallDevice&&I.resizeCharts(k)});x.subscribe(q.Events.PubSub.RestoreSearchState,function(){if(T.suggestedChartExpanded){T.query=T.suggestedChartExpanded;z.setQueryFromHistory()}});T.minimizeExpandedChart=function(){T.suggestedChartExpanded=null;x.publish(q.Events.PubSub.ExpandSmartSearchSuggestedChart,null)};if(T.isSearchHistoryFeature){r.userId?T.userID=r.userId:T.userID="DESKTOP";T.searchInputFocused=false;T.activeHistoryIx=-1;T.historyPermission=false;T.searchHistory=m.initHistory(T)}u.ViewChanged.bind(L);u.OrientationChanged.bind(R);a.on("end",H);T.input="input goes here";T.result="result goes here";T.isSelectActiveInSmallDevice=false;T.$on("$destroy",function(){P.off("qv-outside");N.delete();u.ViewChanged.unbind(L);u.OrientationChanged.unbind(R);a.off("end",H);x.unsubscribe(q.Events.PubSub.ExpandSmartSearchSuggestedChart);x.unsubscribe(q.Events.PubSub.RestoreSearchState)});T.$on("updateForceShowDimmer",function(t,e){T.forceShowDimmer=e});T.$watch("throbber.show",function(t){t&&T.focusState.reset()});T.app.getCurrentSelectionObject().then(function(t){T.modelSelections=t});s(T,"modelSelections",function(t){var e=t.qSelectionObject.qSelections,n;n=e.reduce(function(t,e){return t+(true===e.qLocked)?1:0},0);T.currentSelections=e.length>0;T.allSelectionsLocked=e.length===n;T.isObjectsFeature&&z.searchVisuals(T.searchTerms);z.search(T.searchTerms)});T.$watch("app.isModal()",function(t){t&&_(function(){$.toggleGlobalSearch(T.app)})});T.$watch(F.isSelectActive.bind(null,T.app),function(t){T.isSelectActiveInSmallDevice=t&&T.isSmallDevice});T.$watch("query",function(t){$.setHaveQuery(T.app,!!t)});if(T.isIndexClosedFeature&&!T.isSmallDevice&&$.couldEngineBeIndexing(T.app)){T.forceShowDimmer=true;_(function(){T.$broadcast("toggleActivityIndicator",true)})}T.underlines=[];T.query="";T.searchTerms=[];T.searchTermGroups=[];T.matches=[];T.displayResult={data:false,visuals:false};T.activity={show:false};T.throbber={show:false};T.indexProgress={enabled:false,show:false,visible:false};T.indexDone={show:false,visible:false};T.activeSelectIx=-1;T.showMeMoreFocus=false;T.forcePartials=false;T.allSelectionsLocked=false;T.dimmerStyles={};T.error={show:false,message:"",description:""};T.paging={lastRowIx:0,totalRows:0};T.searchOutsideSelections=function(){z.searchOutsideSelections()};T.onShowMoreHits=function(t,e,n){t.stopPropagation();if(e.disableShowMore)return;D(T,P.find(".qv-global-search-dimmer").height());e.disableShowMore=true;e.mobileExpand=true;var i=C(f.data,n,1,e.qItemMatches.length+15);z.callSearch(T.searchTerms,i).then(function(t){E.showMore(t,e)}).finally(function(){e.disableShowMore=false})};T.getSearchTermGroup=function(t){return T.searchTermGroups.filter(function(e){return e.qSearchTermsMatched.length===t})};T.close=function(){z.closeSearch()};P.on("qv-outside",B);function B(e){var n=t(e.target);if(1===n.closest(".qv-selections-pager").length||1===n.closest(".transparent-overlay-scroll").length)return;z.closeSearch()}T.suggestions=[];T.displaySuggestions=false;T.activeSuggestionIx=-1;T.ignoreQueryChange=false;T.onOutsideSearch=function(){T.isSearchHistoryFeature&&z.showHistory(false)};T.onSuggestSelect=function(t,e){var n,i,a=[];if(!e){t=void 0!==t?t:T.activeSuggestionIx;e=T.suggestions[t]}E.getUnderlinersAndSearchTerms(T.query,a,[]);n=E.getResultingQueryFromSuggestion(a,e);if(n.length>255){N.off();c.showDialog({message:"ErrorDialog.SearchStringTooLong"});i=T.$on("errorHandlerClosed",function(){N.on();i()})}else{T.query=n+" ";T.ignoreQueryChange=false}z.hideSuggestions();T.$broadcast("focusInput");T.getInsightsCharts(e.value)};T.haveUnlockedSelections=function(){return T.currentSelections&&!T.allSelectionsLocked};T.getInsightsCharts=function(t){if(b.getFlag("CAO_MOBILE")){var n=e.getService("qvCaoChartService");if(T.query){T.unableTofetchInsightCharts=false;T.fetchingInsightChartsPending=true;n.getInsights(T.app,t).then(function(t){var e=[].concat(t.recommendations).concat(t.chartMatches);var n=e.map(function(t){return t.visualization.loadChart(T.app)});y.all(n).then(function(t){e=e.map(function(e,n){e=Object.assign({},e,{itemIndex:n,load:true,qItemType:"GenericObject",qTotalNumberOfMatches:0,qIdentifier:t[n].model.id,qItemMatches:[],qTermsMatched:[],qSearchTermsMatched:[]});return e});if(e.length>0){T.suggestedChartGroupTitle=S.get("GlobalSearch.Insight.ChartsTitle",[e.length]);T.insightVisualsGroups=[{qGroupType:"GenericObjectsType",qid:0,qItems:e,insightCharts:true,qSearchTermsMatched:[0],qTotalNumberOfItems:e.length}]}T.fetchingInsightChartsPending=false})},function(){T.unableTofetchInsightCharts=true;T.insightVisualsGroups=[];T.fetchingInsightChartsPending=false})}else T.insightCharts=[]}};this.hideSuggestions=function(){if(T.displaySuggestions){T.displaySuggestions=false;this.resetSuggestions()}};this.hideSoftKeyboard=function(){T.$broadcast("blurInput")};this.showNoResultsMessage=function(){return false};this.searchOutsideSelections=function(){T.outsideSelection=true;T.modelSelections.clearAll();T.$broadcast("focusInput")};this.setShowPartialMatches=function(){T.forcePartials=!T.forcePartials;p.treatAsDesktop()&&T.$broadcast("focusInput")};T.isPartials=function(){return T.searchTermGroups.length&&T.searchTerms.length>T.searchTermGroups[0].qSearchTermsMatched.length};this.resetSuggestions=function(){T.activeSuggestionIx=-1;T.activeSelectIx=-1};this.showSuggestions=function(){T.displaySuggestions=true;T.activeSuggestionIx=-1;T.activeSelectIx=-1};this.showError=function(t){T.displayResult={data:false,visuals:false};T.error.show=true;T.error.translation="ErrorCode."+t.code;t.isHandled=true};this.toogleSuggestions=function(t){t?this.showSuggestions():this.hideSuggestions()};this.emptyResult=function(){T.insightVisualsGroups=[];T.displayResult={data:false,visuals:false};T.activeSelectIx=-1;T.error.show=false;O.search.requestState=h.idle;O.searchVisuals.requestState=h.idle;O.suggest.requestState=h.idle;T.searchTerms=[];T.searchTermGroups=[];T.searchVisualsGroups=[];T.matches=[];T.outsideSelection=false;T.$broadcast("toggleActivityIndicator",false);T.forcePartials=false;T.focusState.reset();this.hideSuggestions();V.removeClass("queryon")};this.moveActiveResult=function(t){T.showMeMoreFocus=false;if(0===t)return;if(t>0){T.activeSelectIx=Math.min(T.activeSelectIx+1,T.searchTermGroups.length);T.activeSelectIx=Math.min(T.activeSelectIx,T.paging.totalRows-1);T.activeSelectIx===T.searchTermGroups.length&&(T.showMeMoreFocus=true)}else t<0&&(T.activeSelectIx=Math.max(T.activeSelectIx-1,0))};this.searchVisuals=function(t){if(!T.isObjectsFeature)return;D(T,A.find("body").height()-j);if(0===t.length)return;O.searchVisuals.idCounter=O.searchVisuals.idCounter+1;var e=O.searchVisuals.idCounter,n=this,i={qAttributes:["qProperty"],qCharEncoding:"Utf16"},a=C(f.visuals,0,-1,20);O.searchVisuals.requestState=h.pending;O.searchVisuals.searchTerms=t;function s(t){T.searchVisualsGroups=[];if(e===O.searchVisuals.idCounter&&O.searchVisuals.requestState===h.pending){O.searchVisuals.requestState=h.idle;O.searchVisuals.searchTerms="";E.transformResult(T,t)}}function r(t){if(t.code===l.NxLocalizedErrorCode.LOCERR_SEARCH_TIMEOUT){n.emptyResult();n.showError(t)}if(t.code===l.NxLocalizedErrorCode.LOCERR_GENERIC_ABORTED)return;O.searchVisuals.requestState=h.idle;O.searchVisuals.searchTerms="";T.displayResult.visuals=false}T.app[f.visuals](i,t,a).then(s,r)};this.search=function(t){D(T,A.find("body").height()-j);T.focusState.reset();if(0===t.length)return;V.addClass("queryon");O.search.idCounter=O.search.idCounter+1;var e=O.search.idCounter,n=this,i=C(f.data,0,5,5);O.search.requestState=h.pending;O.search.searchTerms=t;T.$broadcast("toggleActivityIndicator",true);T.$broadcast("resultScrollToTop");function a(n){T.searchTermGroups=[];T.matches=[];if(e===O.search.idCounter&&O.search.requestState===h.pending){O.search.requestState=h.idle;O.search.searchTerms="";T.searchTerms=t;T.$broadcast("toggleActivityIndicator",false,true);T.$broadcast("resultScrollToTop");E.transformResult(T,n);T.activeSelectIx=-1;T.paging.lastRowIx=T.searchTermGroups.length;T.paging.totalRows=n.qTotalNumberOfGroups}}function s(t){if(t.code===l.NxLocalizedErrorCode.LOCERR_SEARCH_TIMEOUT){n.emptyResult();n.showError(t)}if(t.code===l.NxLocalizedErrorCode.LOCERR_GENERIC_ABORTED)return;O.search.requestState=h.idle;O.search.searchTerms="";T.displayResult.data=false}T.error.show=false;this.callSearch(t,i).then(a,s)};this.loadNextPage=function(){D(T,P.find(".qv-global-search-dimmer").height());var t=C(f.data,T.paging.lastRowIx,5,5),e=this;if(O.result.requestState!==h.idle)return;O.result.requestState=h.pending;T.showMeMoreFocus=false;T.$broadcast("toggleActivityIndicator",true);function n(t){O.result.requestState=h.idle;T.$broadcast("toggleActivityIndicator",false,true);E.transformResult(T,t);T.paging.lastRowIx=T.searchTermGroups.length}function i(){if(i.code===l.NxLocalizedErrorCode.LOCERR_SEARCH_TIMEOUT){e.emptyResult();e.showError(i)}if(i.code===l.NxLocalizedErrorCode.LOCERR_GENERIC_ABORTED)return;O.search.requestState=h.idle;O.search.searchTerms="";T.displayResult.data=false}this.callSearch(T.searchTerms,t).then(n,i)};this.callSearch=function(t,e){return T.app[f.data](w(true),t,e)};this.closeSearch=function(){if(T.isSmallDevice){z.emptyResult();T.query="";T.$broadcast("blurInput")}else $.toggleGlobalSearch(T.app)};this.suggest=function(t){if(0===t.length)return;var e=this;O.suggest.idCounter=O.suggest.idCounter+1;var n=O.suggest.idCounter;O.suggest.requestState=h.pending;O.suggest.suggestTerms=t;function i(t){if(b.getFlag("CAO_MOBILE")){var i=t.qFieldNames.map(function(t){return{qValue:t,qTerm:0}});t.qSuggestions=t.qSuggestions.concat(i)}O.suggest.suggestTerms="";if(E.isWhiteSpaceAt(T.query,T.query.length-1)||'"'===T.query.charAt(T.query.length-1))return;if(n===O.suggest.idCounter&&O.suggest.requestState===h.pending){E.transformSuggest(T,t,10);e.toogleSuggestions(T.suggestions.length>0);T.$broadcast("suggestShow",true,true)}O.suggest.requestState=h.idle}function a(t){t.code===l.NxLocalizedErrorCode.LOCERR_SEARCH_TIMEOUT&&(t.isHandled=true);if(t.code===l.NxLocalizedErrorCode.LOCERR_GENERIC_ABORTED)return;O.suggest.requestState=h.idle;O.suggest.suggestTerms=""}T.app.searchSuggest({},t).then(i,a)};this.select=function(t,e){T.$broadcast("blurInput");if(0===t.length||0===T.searchTermGroups.length)return;if(e<0){e=0;T.activeSelectIx=0}var n=[],i=[];E.getUnderlinersAndSearchTerms(T.query,n,i);var a=i;T.app.selectAssociations(w(),t,e).then(function(){T.isSearchHistoryFeature&&T.historyPermission&&m.createEntryInHistory(T,a)});this.emptyResult();T.query="";p.treatAsDesktop()&&!T.isSearchHistoryFeature&&T.$broadcast("focusInput")};this.setTestSearchTermGroups=function(t){T.searchTermGroups=t};this.onNavigateToSheet=function(t){var e=[],n=[];E.getUnderlinersAndSearchTerms(T.query,e,n);T.isSearchHistoryFeature&&T.historyPermission&&""!=T.query&&m.createEntryInHistory(T,n);if(p.treatAsDesktop()){z.emptyResult();T.query="";T.isSearchHistoryFeature?T.$broadcast("blurInput"):T.$broadcast("focusInput")}else _(function(){z.emptyResult();T.query=""},200);d.highlightedCell(t)};this.showMoreHitsForVisual=function(t){var e={qOffset:0,qCount:1,qGroupOptions:[{qGroupType:"GenericObjectsType",qOffset:t.itemIndex,qCount:1}],qGroupItemOptions:[{qGroupItemType:"GenericObject",qOffset:0,qCount:t.qItemMatches.length+15}]};return T.app[f.visuals]({qAttributes:["qProperty"]},T.searchTerms,e).then(function(e){E.showMore(e,t);return t})};this.showHistory=function(t){T.searchInputFocused=t};this.setQueryFromHistory=function(t){T.ignoreQueryChange=false;t>=0&&(T.query=T.searchHistory[t]);this.showHistory(false);T.$broadcast("focusInput");b.getFlag("CAO_MOBILE")&&T.query&&T.getInsightsCharts(T.query)};this.clearHistory=function(){m.clearSearchHistory(T);this.showHistory(false)};this.removeHistory=function(t){m.removeSingleHistory(T,t)}}return T}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(184),n(49),n(221)],a=function(t,e,n){function i(i,a,s){var r,o,l=i.find("input")[0],c=t.getService("$document");r={preventDefault:false,allowInInput:true,delay:0};o={preventDefault:false,allowInInput:true,delay:75};a.focusState.ActiveStateChanged.bind(u);function u(){a.activeSelectIx=a.focusState.activeStateName===a.focusState.Results?0:-1;a.activeHistoryIx=a.focusState.activeStateName===a.focusState.History?0:-1;a.activeSuggestionIx=a.focusState.activeStateName===a.focusState.Suggestions?0:-1;a.activeVisualIx=a.focusState.activeStateName===a.focusState.Visuals?0:-1;a.$broadcast(a.focusState.activeStateName===a.focusState.Visuals?"visualsGroupFocus":"visualsGroupBlur")}function d(){return"INPUT"===c[0].activeElement.tagName}function p(){e.preventDefault();t.$rootScope.$apply()}function h(t){var e,n,i;if(document.selection&&document.selection.createRange){e=document.selection.createRange();n=e.getBookmark();i=n.charCodeAt(2)-2}else t.setSelectionRange&&(i=t.selectionStart);return i===t.value.length}function f(){d()?a.focusState.activeStateName===a.focusState.Suggestions?s.hideSuggestions():a.query?a.query="":a.close():a.close();p()}function g(){if(a.focusState.activeStateName===a.focusState.Suggestions){a.activeSuggestionIx=a.activeSuggestionIx>0?a.activeSuggestionIx-1:a.suggestions.length-1;p()}else if(a.focusState.activeStateName===a.focusState.Visuals){a.$broadcast("visualsGroupMoveActiveVisual",-1);p()}}function v(){if(a.focusState.activeStateName===a.focusState.Suggestions){a.activeSuggestionIx=(a.activeSuggestionIx+1)%a.suggestions.length;p()}else if(a.focusState.activeStateName===a.focusState.Visuals){a.$broadcast("visualsGroupMoveActiveVisual",1);p()}}function m(){var t=a.focusState.activeStateName;a.focusState.previous();if(t===a.focusState.activeStateName)switch(a.focusState.activeStateName){case a.focusState.History:a.activeHistoryIx=Math.max(-1,a.activeHistoryIx-1);break;case a.focusState.Results:s.moveActiveResult(-1);break}p()}function b(){var t=a.focusState.activeStateName;a.focusState.next();if(t===a.focusState.activeStateName)switch(a.focusState.activeStateName){case a.focusState.History:a.activeHistoryIx=Math.min(a.activeHistoryIx+1,a.searchHistory.length-1);break;case a.focusState.Results:s.moveActiveResult(1);break}p()}function y(t){switch(a.focusState.activeStateName){case a.focusState.History:s.setQueryFromHistory(a.activeHistoryIx);break;case a.focusState.Input:a.isPartials()?s.setShowPartialMatches():a.displaySuggestions?S(t,true):a.displayResult.data?n.getFlag("CAO_MOBILE")||s.select(a.searchTerms,0):s.showNoResultsMessage()&&a.haveUnlockedSelections()&&s.searchOutsideSelections();break;case a.focusState.Suggestions:S(t,true);break;case a.focusState.Visuals:a.$broadcast("selectActiveVisualItem");break;case a.focusState.Partials:s.setShowPartialMatches();break;case a.focusState.Results:a.showMeMoreFocus?s.loadNextPage():s.select(a.searchTerms,a.activeSelectIx);break;case a.focusState.StartNewSearch:s.searchOutsideSelections();break}n.getFlag("CAO_MOBILE")&&a.query&&a.getInsightsCharts(a.query);p()}function S(t,e){if(a.displaySuggestions&&(e||h(l))){a.activeSuggestionIx=-1===a.activeSuggestionIx?0:a.activeSuggestionIx;a.onSuggestSelect()}p()}function x(){s.closeSearch();p()}this.keyboardShortcutsGroup=e.createGroup("global-search-"+a.app.id,1);this.keyboardShortcutsGroup.registerKeys("esc",f,r);this.keyboardShortcutsGroup.registerKeys("left",g,o);this.keyboardShortcutsGroup.registerKeys("right",v,o);this.keyboardShortcutsGroup.registerKeys("up",m,o);this.keyboardShortcutsGroup.registerKeys("down",b,o);this.keyboardShortcutsGroup.registerKeys("enter",y,r);this.keyboardShortcutsGroup.registerKeys("tab",S,r);this.keyboardShortcutsGroup.registerKeys("ctrl+f",x,r);this.keyboardShortcutsGroup.on();this.on=function(){this.keyboardShortcutsGroup.on()};this.off=function(){this.keyboardShortcutsGroup.off()};this.delete=function(){this.keyboardShortcutsGroup.delete();a.focusState.ActiveStateChanged.unbind(u)}}return i}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(91)],a=function(t){function e(t){return t.libId?t.libIdLabel?t.libIdLabel:"Unknown master item":t.aggr?t.aggr+"("+t.field+")":t.field}function n(n,i){var a=i.filter(function(t){return void 0!==t}).length;var s=n&&n.filter(function(t){return Object.keys(t.msgParams).length===a});var r=null;s&&s.forEach(function(t){if(t.msgParams){var e=t.msgParams;var n=Object.keys(e);var a=true;n.forEach(function(t){var e=i.some(function(e){return e.slot&&e.slot===t});e||(a=false)});a&&(r=t)}});if(!r)return"";var o=[void 0,void 0,void 0,void 0,void 0];Object.keys(r.msgParams).forEach(function(t){var n=i.filter(function(e){return e.slot===t})[0];var a=e(n);o[r.msgParams[t]]=a});return t.get(r.msgId,o)}return{findTitleForChart:n}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(89)],a=function(t){function e(t,e,n,i){this.chartId=t;this.searchReport=n;this.app=i;this.type="found";this.analysisPrecedentId="found";this.appearsOnSheets=e}e.prototype.getTitle=function(){var e=new t;this.app.getObject(this.chartId).then(function(t){t.getLayout().then(function(t){e.resolve(t.title)})});return e.promise};e.prototype.getMatchDetails=function(){var t=[];var e=this.chartId;if(this.searchReport.search){var n=this.searchReport.search["chartFinder-Title"].searchHits;Object.keys(n).forEach(function(i){if(i.includes(e)){var a=n[i].matchingTypes;a.forEach(function(e){t.push({matchedOn:n[i].title,matchedField:e})})}})}return t};e.prototype.getChartType=function(){var e=new t;this.app.getObject(this.chartId).then(function(t){t.getLayout().then(function(t){e.resolve(t.visualization)})});return e.promise};e.prototype.loadChart=function(e){var n=new t;e.getObject(this.chartId).then(function(t){t.getProperties().then(function(e){n.resolve({model:t,options:{interactionState:0,showTitles:false},properties:e})})});return n.promise};return e}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(54),n(1097),n(1098),n(1114),n(1116),n(1119),n(878),n(199)],a=function(t,e,n,i,a,s,r,o){return{generateAlternativeChartProperties:c,generateDefaultChartProperties:u,generateChartPropertiesForRecommendation:d};function l(i,o,l,c){return a.createDataCollection(l,i).then(function(l){var u=a.adaptDataCollectionForRecommendations(l,o.qHyperCube);return e.getChartRecommendations(u).then(function(a){var u=[];var d=!t.isArray(a);d&&(a=[]);var p=a.some(function(t){return"list"===t.analysis.analysis});if(!p){var h=e.getFallbackRecommendation(l);a.push(h)}a.forEach(function(e){var a=s.merge(o.qHyperCube,i.qHyperCubeDef,l,e);var r=n.findChartsByAnalysis(e,a);n.createChartDataProperties(e,r).forEach(function(e){var n=t.findWhere(u,{type:e.type});if(n){if(e.score&&(!n.score||e.score>n.score)){var i=u.indexOf(n);u[i]=e}}else u.push(e)})});if(c){var f=r.getSupportedChartTypes().slice().filter(function(t){var e=true;for(var n=0;n<u.length;n++)if(u[n].type===t){e=false;break}return e});var g=s.merge(o.qHyperCube,i.qHyperCubeDef,l,a[0]);var v=n.findPossibleCharts(f,g);n.createChartDataProperties(a[0],v).forEach(function(t){u.push(t)})}return{recommendations:a,allChartDataProperties:u}})})}function c(t,e,n,a){return l(t,e,n,a).then(function(e){if(o.CRE_CHARTS){var a={recommendations:e.recommendations,allChartDataProperties:e.allChartDataProperties};console.log(a)}e.allChartDataProperties.length>1&&e.allChartDataProperties.sort(function(t,e){return e.score-t.score});return e.allChartDataProperties.map(function(e){return i.generateProperties(e,t,n)})})}function u(t,e,n,a){return l(t,e,n,a).then(function(e){var a=e.allChartDataProperties;a.length>1&&a.sort(function(t,e){return e.score-t.score});var s=a[0];t&&t.preferredChart&&a.forEach(function(e,n){e.type===t.preferredChart&&(s=a[n])});return i.generateProperties(s,t,n).then(function(t){if(o.CRE_CHARTS){var n={recommendations:e.recommendations,allChartDataProperties:a,bestChartDataProperties:s,chartProperties:t};console.log(n)}return t})})}function d(e,a){var r=[];var l=[e];var c=l.some(function(t){return"list"===t.analysis.analysis});if(!c){var u={analysis:{analysis:"list",dims:e.analysis.dims,msrs:e.analysis.msrs}};l.push(u)}l.forEach(function(e){var i=s.collectFromRecommendation(e);var a=n.findChartsByAnalysis(e,i);n.createChartDataProperties(e,a).forEach(function(e){var n=t.findWhere(r,{type:e.type});if(n){if(e.score&&(!n.score||e.score>n.score)){var i=r.indexOf(n);r[i]=e}}else r.push(e)})});r.length>1&&r.sort(function(t,e){return e.score-t.score});var d=r[0];return i.generateProperties(d,void 0,a).then(function(t){if(o.CRE_CHARTS){var e={recommendations:l,allChartDataProperties:r,bestChartDataProperties:d,chartProperties:t};console.log(e)}return t})}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(54),n(1099),n(1100),n(1101),n(1102),n(1103),n(1104),n(1105),n(1106),n(1107),n(1108),n(1109),n(1110),n(1111),n(1112)],a=function(t,e,n,i,a,s,r,o,l,c,u,d,p,h,f){function g(t){v[t.type]=t}var v={};g(n);g(i);g(s);g(r);g(o);g(l);g(c);g(u);g(d);g(p);g(h);g(a);g(e);g(f);function m(){var e=t.keys(v);if(y)return t.filter(e,function(t){return y.indexOf(t)>=0});return e}function b(t){return v[t]}var y=void 0;function S(t){y=t}return{getSupportedChartTypes:m,getChartDataDefinition:b,restrictSupportedChartTypes:S}}.apply(e,i),void 0!==a&&(t.exports=a))},,function(t,e,n){"use strict";var i,a;!(i=[n(48),n(92),n(404),n(128),n(89),n(367),n(49),n(114),n(123),n(196)],a=function(t,e,n,i,a,s,r,o,l,c){var u=e.extend("CaoChartUiModel",{init:function e(n,i){this.app=i;this.zoomed=false;this.ObjectPlacementService=t.getService("qvObjectPlacementService");this.CaoChartService=t.getService("qvCaoChartService");this.$timeout=t.getService("$timeout");this.chart=n;this.object={};this.zoomedObject={};this.options={};this.zoomedOptions={};this.state="READY";this.modified=false;this.chartTypeImageUrl=void 0;this.chartType=void 0;this.rendered=false;this.renderedCount=0;this.insightFeedback=r.getFlag("CE_PRECEDENTS");this.interaction=true},updateState:function t(e){this.state=e},isHidden:function t(){if(this.isFound())return false;return this.insightFeedback&&this.chart.visualization.visualization.analysis.precedents&&this.chart.visualization.visualization.analysis.precedents.disliked||this.chart.invalidFromLearning},isRendered:function t(){return this.rendered},isFound:function t(){return"found"===this.chart.visualization.type},isGenerated:function t(){return"generated"===this.chart.visualization.type},isModified:function t(){return this.modified},setState:function t(e){this.state=e},setModified:function t(e){this.modified=e},setType:function t(e){this.chart.visualization.type=e},refreshChartType:function t(){var e=this;e.chart.visualization.getChartType().then(function(t){e.chartType=t;e.chartTypeImageUrl=n.getImageNameFromChartType(t)})},getTitle:function t(){return this.chart.visualization.getTitle().then(function(t){return t})},getComplexity:function t(){return this.chart.complexity},getRelevance:function t(){return this.chart.relevance},getMatchRecord:function t(){return this.chart.visualization.visualization.matchRecord},getState:function t(){return this.state},getModel:function t(){return this.chart.model},getObject:function t(){return this.zoomed?this.zoomedObject:this.object},getAnalysisPrecedentId:function t(){return this.chart.visualization.analysisPrecedentId},getMatchDetails:function t(){return this.chart.visualization.getMatchDetails()},getSheetsThisChartAppearsOn:function t(){return this.chart.visualization.appearsOnSheets},getMatches:function t(){return this.chart.visualization.visualization.matchRecord.matches},getFields:function t(){return this.getMatches().filter(function(t){return!t.slotRole})},getMeasures:function t(){return this.getMatches().filter(function(t){return t.slotRole===c.MEASURE})},getDimensions:function t(){return this.getMatches().filter(function(t){return t.slotRole===c.DIMENSION})},getChartType:function t(){return this.chart.visualization.visualization.analysis.analysis},getSearchReport:function t(){return this.chart.visualization.searchReport},getAnalysis:function t(){return this.chart.visualization.visualization.analysis},isObjectInvalid:function t(){return this.zoomed?this.zoomedObject.invalid:this.object.invalid},isViewDataToggled:function t(){return this.zoomed?this.zoomedObject.viewDataToggled:this.object.viewDataToggled},isDataViewSupported:function t(){return this.zoomed?this.zoomedObject.supportViewData&&this.zoomedObject.supportViewData():this.object.supportViewData&&this.object.supportViewData()},toggleDataView:function t(){if(this.zoomed)return this.zoomedObject.toggleDataView();return this.object.toggleDataView()},activateSelectionWatch:function t(e){this.object.selectionsApi.watchActivated(e)},deactivateSelectionWatch:function t(e){this.object.selectionsApi.watchDeactivated(e)},adaptChart:function t(e){var n=this;return this.CaoChartService.adaptRecommendation(n.chart.visualization.visualization,n.app).then(function(t){n.chart.visualization=new s({analysis:t.analysis,matchRecord:t.matchRecord},n.chart.visualization.searchReport,t.properties);delete n.rendered;n.isViewDataToggled()?n.toggleDataView().then(function(){n.shouldRedraw=true}):n.shouldRedraw=true;n.recalculateConfidence=e})},addToNewSheet:function t(){var e=this;return e.chart.model.getProperties().then(function(t){return e.ObjectPlacementService.addToNewSheet(t).then(function(t){e.setType("found");e.chart.visualization.appearsOnSheets.push(t.id);return t})})},addToSheet:function t(e){var n=this;return n.chart.model.getProperties().then(function(t){return n.ObjectPlacementService.addObjectToSheet(t,e,i.getModel()).then(function(t){n.setType("found");n.chart.visualization.appearsOnSheets.push(t.id);return t})})},setChartInteraction:function t(e){if(this.zoomed&&this.zoomedObject&&this.interaction!==e){this.interaction=e;e?this.zoomedObject.on():this.zoomedObject.off()}},setChartInteractionState:function t(e){this.options.interactionState=e},destroyChart:function t(){var e=this;if(e.zoomed){e.zoomed=false;return}if("LOADING"===e.state||"LOADED"===e.state){if(!e.rendered&&e.object&&e.object.subscription){e.rendered=false;e.object.cancel()}e.isGenerated()&&e.chart.model&&e.chart.model.id&&!e.zoomed?e.app.destroySessionObject(e.chart.model.id).then(function(){e.rendered=false;e.state="READY"}):e.state="READY"}},initializeOptions:function t(){this.options={};this.zoomedOptions={};this.options.isReadonly=false;this.options.isPopover=false;this.options.selectionsDisabled=true;this.options.interactionState=l.STATIC;this.options.direction=o.direction;this.zoomedOptions.isReadonly=false;this.zoomedOptions.isPopover=false;this.zoomedOptions.selectionsDisabled=false;this.zoomedOptions.interactionState=l.ANALYSIS;this.zoomedOptions.direction=o.direction},loadChart:function t(e){var n=this;var i=new a;var s;if(n.rendered){n.setState("LOADED");e();i.resolve()}else{n.initializeOptions();var r=n.chart.model?n.app.destroySessionObject(n.chart.model.id):a.when({});r.then(function(){n.chart.visualization.loadChart(n.app).then(function(t){n.object&&n.object.type&&(n.object.type=null);n.zoomedObject&&n.zoomedObject.type&&(n.zoomedObject.type=null);n.chart.model=t.model;n.state="LOADED";function a(){s&&n.$timeout.cancel(s)}var r=function t(){if(n.zoomed){n.renderedCount++;if(n.renderedCount<2)return}n.renderedCount=0;n.rendered=true;e&&e();n.state="LOADED";a();i.resolve()};n.options.onRendered=r;n.zoomedOptions.onRendered=r;var o=function t(){a();i.resolve()};n.options.onCanceled=o;n.zoomedOptions.onCanceled=o;s=n.$timeout(function(){if(!n.allowLongLoad&&!n.rendered&&n.object&&n.object.subscription){n.object.subscription.cancel();n.zoomedObject&&n.zoomedObject.subscription&&n.zoomedObject.subscription.cancel();n.state="MANUAL_LOAD";i.resolve()}},n.chart.suggestedTimeout)},function(){i.resolve()})})}return i.promise}});return u}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={};Object.defineProperties(t,{idle:{value:0},pending:{value:1}});return t}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={};Object.defineProperties(t,{data:{value:"searchResults"},visuals:{value:"searchObjects"},indexProgress:{value:"GetProgress"}});return t}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(102)],a=function(t){function e(n,i){var a=n[i];if(!(this instanceof e))throw new Error("FocusState needs to be called with the new keyword");if(!a)throw new Error("Invalid initialStateName provided");t.mixin(this);this.notification("ActiveStateChanged");Object.defineProperties(this,{initialState:{value:a},activeState:{configurable:true,value:a},activeStateName:{configurable:true,value:a.name}})}e.prototype.next=function(){var t=this.activeState;if(t.onBeforeNext&&!t.onBeforeNext())return;var e=t.next();while(e){if(!e.onBeforeEnter||e.onBeforeEnter()){n(this,e);return}e=e.next()}};e.prototype.previous=function(){var t=this.activeState;if(t.onBeforePrevious&&!t.onBeforePrevious())return;var e=t.previous();while(e){if(!e.onBeforeEnter||e.onBeforeEnter()){n(this,e);return}e=e.previous()}};e.prototype.reset=function(){n(this,this.initialState)};i(e,"Input");i(e,"Suggestions");i(e,"History");i(e,"Partials");i(e,"Visuals");i(e,"SuggestedCharts");i(e,"Results");i(e,"StartNewSearch");function n(t,e){Object.defineProperties(t,{activeState:{value:e},activeStateName:{value:e.name}});t.ActiveStateChanged.emit()}function i(t,e){var n={value:e};Object.defineProperty(t,e,n);Object.defineProperty(t.prototype,e,n)}return e}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){function t(t,i,a){var s={};n(s,t.Input,{previous:function t(){return false},onBeforeNext:function t(){return!a.throbber.show},next:e.bind(s,t.Suggestions)});n(s,t.Suggestions,{onBeforeEnter:function t(){return!!a.displaySuggestions},previous:e.bind(s,t.Input),next:e.bind(s,t.History)});n(s,t.History,{onBeforeEnter:function t(){return a.isSearchHistoryFeature&&a.searchInputFocused&&0===a.query.length},onBeforeNext:function t(){return false},onBeforePrevious:function t(){return 0===a.activeHistoryIx},previous:e.bind(s,t.Suggestions),next:e.bind(s,t.Visuals)});n(s,t.Visuals,{onBeforeEnter:function t(){return a.isObjectsFeature&&a.displayResult.visuals&&!a.isSmallDeviceLandscape},previous:e.bind(s,t.History),next:e.bind(s,t.Partials)});n(s,t.Partials,{onBeforeEnter:function t(){return!!a.displayResult.data&&a.isPartials()},previous:e.bind(s,t.Visuals),next:e.bind(s,t.Results)});n(s,t.Results,{onBeforeEnter:function t(){return!!a.displayResult.data&&(!a.isPartials()||a.forcePartials)},onBeforeNext:function t(){return false},onBeforePrevious:function t(){return 0===a.activeSelectIx},previous:e.bind(s,t.Partials),next:e.bind(s,t.StartNewSearch)});n(s,t.StartNewSearch,{onBeforeEnter:function t(){return i.showNoResultsMessage()&&a.haveUnlockedSelections()},previous:e.bind(s,t.Results),next:function t(){return false}});return s}function e(t){var e=this[t];if(!e)throw new Error("Invalid stateName provided");return e}function n(t,e,n){if(t[e])throw new Error("State with name '"+e+"' already exists");n.name=e;t[e]=n}return t}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(54),n(886)],a=function(t,e){function n(t){return t.app.id+"."+t.userID+".smartSearch.history"}function i(t){t.storage=o(t);if("NONE"==t.storage)return;var e=n(t);if(t.storage.contains(e)){var i=f(t.storage.get(e));return i}}function a(t,e){var i=n(t),a=[],s=[];if(t.storage.contains(i)){a=t.storage.get(i);s=l(e);var r=c(s,a);var o=f(r);t.storage.set(i,r);t.searchHistory=o}else{s=l(e);a.unshift(s);t.storage.set(i,a);var u=f(a);t.searchHistory=u}}function s(t){var e=n(t);if(t.storage.contains(e)){t.searchHistory=[];t.storage.remove(e)}}function r(t,e){var i=n(t);if(t.storage.contains(i)){var a=t.storage.get(i);a.splice(e,1);t.storage.set(i,a);var s=f(a);t.searchHistory=s}}function o(t){if("DESKTOP"==t.userID){t.historyPermission=true;return e}if(t.userID&&"anonymous"!=t.userID.substring(0,9)){t.historyPermission=true;return e}t.historyPermission=false;return"NONE"}function l(t){return t.map(function(t){return t.startQuote&&t.endQuote?t.string='"'+t.string+'"':t.string})}function c(t,e){var n=d(e);var i=p(t);var a=h(n,i);var s=[];if(a>=0){e.splice(a,1);e.unshift(t);s=u(e)}else{e.unshift(t);s=u(e)}return s}function u(t){t.length>4&&(t.length=4);return t}function d(t){function e(t){return t.toLowerCase()}return t.map(function(t){return t.map(e)})}function p(t){return t.map(function(t){return t.toLowerCase()})}function h(e,n){for(var i=0;i<e.length;i++)if(t.isEqual(e[i],n))return i}function f(t){return t.map(function(t){return t.join(" ")})}return{initHistory:i,createEntryInHistory:a,clearSearchHistory:s,removeSingleHistory:r,getStoragePath:n}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(54),n(118)],a=function(t,e){var n="sessionstorageservice";function i(e){if(!t.isString(e))throw new Error('The key "'+e+'" is not a String.');return n+"."+e}function a(e,n,a){var s=(new Date).getTime(),r,o;if(!t.isString(e))throw new Error('The key "'+e+'" is not a String.');if(!t.isObject(n))throw new Error('The value "'+n+'" for the key "'+e+'" is not valid object.');if(a){if(!t.isNumber(a))throw new Error('The time to live value "'+a+'" is not numeric.');a+=s}o={timeToLive:a,value:n};r=JSON.stringify(o);sessionStorage[i(e)]=r}function s(e){if(!t.isString(e))throw new Error('The key "'+e+'" is not a String.');var n=t.isEmpty(sessionStorage[i(e)]);return!n}function r(e,n){if(!t.isString(e))throw new Error('The key "'+e+'" is not a String.');if(!s(e)){if(void 0!==n)return n;throw new Error('There is no data set for the key "'+e+'". Please use contains() first to verify you should actually do a get().')}var i=o(e);return i.value}function o(t){var e=JSON.parse(sessionStorage[i(t)]);return e}function l(e){if(!t.isString(e))throw new Error('The key "'+e+'" is not a String.');if(!s(e))throw new Error('There is no data set for the key "'+e+'". Please use contains() first to verify you should actually do a get().');delete sessionStorage[i(e)]}function c(){var i,a,s;for(i in sessionStorage)if(e.startsWith(i,n)){i=i.substring(n.length+1);a=o(i);s=(new Date).getTime();t.isNumber(a.timeToLive&&s>a.timeToLive)&&l(i)}}return{set:a,get:r,contains:s,clean:c,remove:l}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(91),n(90),n(888),n(889),n(139),n(96),n(99),n(169)],a=function(t,e,n,i,a,s,r,o,l){var c=null;function u(t,e){var n;if(t.length!==e.length)return false;for(n=0;n<t.length;++n)if(t[n]!==e[n])return false;return true}e.directive("qvGlobalSearchInput",["$timeout","qvGlobalSearchDataService",function(s,r){return{restrict:"E",replace:true,template:a,require:"^qvGlobalSearch",link:function a(d,p,h,f){var g=p.find("input"),v=[],m=e.getService("$document");g.on("keydown",function(){d.ignoreQueryChange=false});d.$watch("isSelectActiveInSmallDevice",function(t){d.autoFocus=!i.isIos()&&!i.isAndroid()&&!t});d.placeholder=n.get("GlobalSearch.SearchData");function b(e){if(d.isInputFocused){if(1===t(e.target).closest(".qv-global-search-suggest").length||1===t(e.target).closest(".qv-search-last-history").length)return;e.preventDefault();e.stopPropagation();o.preventGestures(this.gestureHandler);d.$apply(function(){f.hideSuggestions();f.hideSoftKeyboard()})}}d.isObjectsFeature&&!l.treatAsDesktop()&&p.on("qv-outside",b);d.$watch("query",function(t){var e=[],n,i;s.cancel(c);f.showHistory(d.isSearchHistoryFeature&&d.isInputFocused&&0===d.query.length);d.ignoreQueryChange||f.resetSuggestions();if(!t||0===t.length){f.emptyResult();d.underlines.length=0;v=[];return}r.getUnderlinersAndSearchTerms(t,d.underlines,e);if(d.ignoreQueryChange){d.ignoreQueryChange=false;return}c=s(function(){if(r.isWhiteSpaceAt(t,t.length-1)||'"'===t.charAt(t.length-1))f.hideSuggestions();else{i=r.getSuggestTerms(t,e);f.suggest(i)}n=e.map(function(t){return t.string});if(e.length>0&&!u(n,v)){f.searchVisuals(n);f.search(n)}else t.length<r.getMinQueryLength()&&f.emptyResult();v=n;c=null},200)});d.$watch("isInputFocused",function(t){d.isSmallDevice&&(t?m.find("body").animate({scrollTop:p.offset().top},100):d.isObjectsFeature&&o.utils.touch&&f.hideSuggestions());d.isSearchHistoryFeature&&t&&0===d.query.length&&f.showHistory(true)});d.$on("focusInput",function(){g.focus()});d.$on("blurInput",function(){g.blur()});d.$on("$destroy",function(){g.off()})}}}]);e.directive("qvGlobalSearchInputHint",["qvGlobalSearchDataService",function(t){return{restrict:"E",replace:true,template:s,require:"^qvGlobalSearch",link:function e(n){function i(){var e=n.suggestions[-1===n.activeSuggestionIx?0:n.activeSuggestionIx],i=[],a=[],s,o,l,c,u;t.getUnderlinersAndSearchTerms(n.query,i,a);s=t.getSuggestTerms(n.query,a);if(!n.displaySuggestions||n.suggestions.length<=0||0===s.length)return;o=t.getUnderlineLengthFromTermIx(i,e.term);c=i.slice(o).reduce(function(t,e){return t+(e.isWhitespace?" ":e.string)},"");l=r.string(c).length;c=r.string(e.value).slice(0,l);u=r.string(e.value).slice(l);n.ignoreQueryChange=true;n.hintString=u}n.$watch("activeSuggestionIx",function(){i()});n.$watchCollection("suggestions",function(){i()});n.$watch("displaySuggestions",function(){i()})}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="qv-search-input" ng-class="{\'focus\': isInputFocused}">\n\t<div class="search-field-area">\n\t\t<lui-search class="search-field" query="query" auto-focus="autoFocus" autocomplete="\'off\'" is-focused="isInputFocused" tid="globalSearch.searchField" placeholder="{{placeholder}}" />\n\t</div>\n\t<div class="search-underlines">\n\t\t<span ng-repeat="underline in underlines" class="underline" ng-class="underline.isWhitespace ? \'term-space\' : \'term\' + underline.colorIx">{{underline.string}}</span><qv-global-search-input-hint></qv-global-search-input-hint>\n\t</div>\n</div>\n'},function(t,e){t.exports='<span ng-show="displaySuggestions" class="search-suggest" tid="globalSearch.suggestionString">{{hintString}}</span>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(891),n(892),n(893),n(96),n(99),n(49),n(370),n(895)],a=function(t,e,n,i,a,s,r){var o={INITIAL:0,VISUALS_DOCKED:1,DATA_DOCKED:2};t.directive("qvGlobalSearchResult",["$timeout",function(t){return{restrict:"E",template:e,replace:true,require:["^qvGlobalSearch","qvGlobalSearchResult"],controller:function t(){this.getElement=function(){};this.setDockState=function(){}},link:function e(n,i,l,c){var u=c[0],d=c[1],p,h,f=function e(){var a=this,r=0;s.treatAsDesktop()&&!h&&(h=i.find(".qv-smartsearch-visuals-group"));t(function(){if(h&&h.length){r=h[0].offsetTop+h[0].offsetHeight-33;n.fixedbar=a.scrollTop>r}n.scrollShow=a.scrollHeight-a.scrollTop>a.clientHeight})},g=!s.treatAsDesktop()&&n.isObjectsFeature?i.find(".data-container"):i;n.dockState=o.INITIAL;n.caoMobile=r.getFlag("CAO_MOBILE");n.emptyMessageEnabled=false;n.fixedbar=false;n.classes={"qv-global-search-result-throbber-open":n.activity.show,"with-objects":n.isObjectsFeature&&!n.isSmallDeviceLandscape};n.$watch("isObjectsFeature && !isSmallDeviceLandscape",function(t){n.classes["with-objects"]=t});n.$watch("activity.show",function(t){n.classes["qv-global-search-result-throbber-open"]=t});n.$watch(function(){return n.showNoResultsMessage()},function(t){n.classes["noresults"]=t});n.select=function e(i,s){if(a.utils.touch){n.activeResultIx=s;t(function(){u.select(n.searchTerms,i.qId)},100)}else u.select(n.searchTerms,i.qId)};n.loadNextPage=function t(){u.loadNextPage()};d.getElement=function(){return i};d.setDockState=function(e){t(function(){n.dockState=e;n.classes["visuals-docked"]=e===o.VISUALS_DOCKED;n.classes["data-docked"]=e===o.DATA_DOCKED})};n.setShowPartialMatches=function(){u.setShowPartialMatches()};n.showNoResultsMessage=function(){var t;t=n.caoMobile?n.emptyMessageEnabled&&n.searchTerms.length>0&&!n.displayResult.data&&!n.error.show&&!n.activity.show&&0===n.insightVisualsGroups.length&&!n.fetchingInsightChartsPending||n.error.show:n.emptyMessageEnabled&&n.searchTerms.length>0&&!n.displayResult.data&&!n.error.show&&!n.activity.show||n.error.show;return t};u.showNoResultsMessage=function(){return n.showNoResultsMessage()};n.resetDockState=function(){n.dockState=o.INITIAL;s.treatAsDesktop()&&g.animate({scrollTop:0},300,"swing")};p=n.$watch(function(){return g[0]&&g[0].scrollHeight?g[0].scrollHeight:0},function(t){t&&(n.scrollShow=t>g[0].clientHeight)});g.on("scroll",f);n.$on("resultScrollToTop",function(){i[0].scrollTop=0});n.$on("$destroy",function(){p();g.off("scroll",f)})}}}]);t.directive("qvScrollToActive",function(){return{restrict:"A",require:"^qvGlobalSearchResult",link:function t(e,n,i,a){i.$observe("qvScrollToActive",function(t){t=t+""==="true";n.toggleClass("active",t);if(t){var e=a.getElement(),i=n.position();i.top<0?e[0].scrollTop=n[0].offsetTop:i.top+n.height()>e.height()&&n[0].scrollIntoView(false)}})}}});t.directive("qvGlobalSearchResultMsg",function(){return{restrict:"E",template:n,replace:true,require:["^qvGlobalSearch","^qvGlobalSearchResult"],link:function t(e){e.capUnderlineMaxNumber=6}}});t.directive("qvGlobalSearchNoResults",function(){return{restrict:"E",template:i,replace:true,require:["^qvGlobalSearch","^qvGlobalSearchResult"],link:function t(){}}})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="qv-global-search-result" ng-class="classes" >\n\n\t<qv-global-search-suggest ng-if="displaySuggestions" class="qv-global-search-suggest" qv-scroll-to-active="{{activeSelectIx === -1 && focusState.activeStateName === focusState.Suggestions}}"></qv-global-search-suggest>\n\n\t<h3 ng-if="isObjectsFeature && ( displayResult.data || showNoResultsMessage() ) && matches.length > 0" class="title-section title-selections" >\n\t\t<span q-translation="GlobalSearch.Selections"></span>\n\t\t<i ng-click="resetDockState();" class="lui-icon lui-icon--arrow-up"></i>\n\t</h3>\n\n\t<qv-global-search-no-results class="search-no-results-message" ng-show="showNoResultsMessage()" ></qv-global-search-no-results>\n\n\t<div ng-if="(outsideSelection || currentSelections) && (!isPartials() || forcePartials)" class="qv-global-search-result-title strong" >\n\t\t<span ng-if="outsideSelection && !currentSelections" tid="globalSearch.matchesWholeDataset" q-translation="GlobalSearch.MatchesWholeDataset"></span>\n\t\t<span ng-if="currentSelections" tid="globalSearch.addToYourSelections" q-translation="GlobalSearch.AddToYourSelections"></span>\n\t</div>\n\n\t<div ng-repeat="m in matches" class="data-matches-group" ng-if="(!isPartials() || forcePartials)">\n\n\t\t<div ng-if="m !== searchTerms.length" class="caption-flex" q-translation="GlobalSearch.MatchedSearchTerms,{{m}}"></div>\n\n\t\t<div class="content-flex" ng-init="parentIndex = $index" ng-class="{ \'touch-off\':!isSmallDevice }" ng-repeat="row in getSearchTermGroup(m)" qv-scroll-to-active="{{( row.qId === activeSelectIx) && focusState.activeStateName === focusState.Results }}" tid="globalSearch.resultGroup" >\n\n\t\t\t<div class="cell" ng-repeat="item in row.qItems" tid="globalSearch.resultField" ng-class="{ \'maxcell\': !$last && !$first, \'maxcellfirst\': ($first && row.qTotalNumberOfItems > 1) }" >\n\t\t\t\t<div class="group-hits" ng-click="select( row, $parentIndex )" ng-class="{ \'shown\': (item.qTotalNumberOfMatches-item.qItemMatches.length) > 0  }">\n\t\t\t\t\t<span class="field-name" tid="globalSearch.resultField.Name">{{item.qIdentifier}}</span>\n\t\t\t\t\t<span ng-repeat="hit in item.qItemMatches" tid="globalSearch.resultField.Hit">\n\t\t\t\t\t\t<qv-global-search-highlights q-text="hit.qText" q-ranges="hit.qRanges"></qv-global-search-highlights >\n\t\t\t\t\t\t<span>{{$last ? \'\' : \', \'}}</span>\n\t\t\t\t\t</span>\n\t\t\t\t\t<div tid="globalSearch.resultField.MoreHits" ng-if="item.qTotalNumberOfMatches-item.qItemMatches.length > 0" ng-click="onShowMoreHits($event, item, row.qId)" class="more-hits"><span class="more-text" q-translation="GlobalSearch.MoreResults,{{(item.qTotalNumberOfMatches-item.qItemMatches.length)}}"></span></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="more-hits-area-mobile" ng-if="item.qTotalNumberOfMatches-item.qItemMatches.length > 0" tid="globalSearch.resultField.MoreHitsMobile" ng-click="onShowMoreHits($event, item, row.qId)">\n\t\t\t\t\t<button class="lui-button lui-button--rounded">\n\t\t\t\t\t\t<span class="lui-button__icon lui-icon lui-icon--more"></span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div ng-hide="matches.length === 0" qv-scroll-to-active="{{showMeMoreFocus}}" class="show-me-more"><button ng-if="paging.totalRows > paging.lastRowIx && (!isPartials() || forcePartials)" tid="globalSearch.showmemore" ng-click="loadNextPage($event)" class="lui-button" q-translation="GlobalSearch.ShowMeMore" ng-class="{\'lui-active\': showMeMoreFocus }"></button></div>\n\n\t<h3 class="title-section title-navigation" ng-if="displayResult.visuals && !isSmallDeviceLandscape" qv-scroll-to-active="{{focusState.activeStateName === focusState.Visuals}}">\n\t\t<span ng-if="!caoMobile" q-translation="GlobalSearch.Navigations"></span>\n\t\t<span ng-if="caoMobile">{{existingChartGroupTitle}}</span>\n\t\t<i ng-click="resetDockState();" class="lui-icon lui-icon--arrow-down"></i>\n\t</h3>\n\n\t<h3 class="title-section title-landscape" ng-if="displayResult.visuals && isSmallDeviceLandscape">\n\t\t<span class="lui-icon lui-icon--object"></span>\n\t\t<span q-translation="GlobalSearch.RotateForVisuals"></span>\n  </h3>\n  \n\t<qv-smartsearch-visuals-group tid="smartsearch-visuals-group" items="searchVisualsGroups" app="app" search-terms="searchTerms" options="{\'preload\': false}" ng-if="displayResult.visuals " ng-hide="isSmallDeviceLandscape"></qv-smartsearch-visuals-group>\n\n\t<h3 class="title-section title-navigation"\n\t\tng-if="insightVisualsGroups.length > 0 && caoMobile && !isSmallDeviceLandscape"\n\t\tqv-scroll-to-active="{{focusState.activeStateName === focusState.SuggestedCharts}}">\n\t\t<span tid="global.search.suggested.charts.title">{{suggestedChartGroupTitle}}</span>\n\t\t<i ng-click="resetDockState();" class="lui-icon lui-icon--arrow-down"></i>\n  </h3>\n  \n  <div class="insight-charts-unavailable" ng-if="unableTofetchInsightCharts === true" q-translation="GlobalSearch.SuggestedChartsUnavailable"></div>\n\t\n\t<div ng-if="isPartials()" qv-scroll-to-active="{{ focusState.activeStateName === focusState.Partials }}" class="qv-global-search-result-message search-partials-message">\n\t\t<qv-global-search-result-msg></qv-global-search-result-msg>\n\t\t<div>\n\t\t\t<button class="lui-button" ng-click="setShowPartialMatches($event)" tid="globalSearch.showPartialMatches" q-translation="{{ !forcePartials?\'GlobalSearch.ShowPartialMatches\' : \'GlobalSearch.HidePartialMatches\' }}"\n\t\t\t ng-class="{ \'lui-active\': focusState.activeStateName === focusState.Partials }"></button>\n\t\t</div>\n\t</div>\n\n\t<qv-smartsearch-visuals-group tid="smartsearch-visuals-group" items="insightVisualsGroups" app="app" search-terms="searchTerms" options="{\'preload\': false}" ng-if="insightVisualsGroups.length > 0 && caoMobile" ng-hide="isSmallDeviceLandscape"></qv-smartsearch-visuals-group>\n\n\t<div class="fixed-bar" ng-show="fixedbar">\n\t\t<span ng-click="resetDockState();" class="lui-fade-button">\n\t\t\t<span class="lui-fade-button__icon lui-icon lui-icon--arrow-down"></span>\n\t\t</span>\n\t</div>\n\n\t<qv-global-search-throbber></qv-global-search-throbber>\n</div>\n'},function(t,e){t.exports='<div class="qv-global-search-result-message-inline">\n    <span ng-if="currentSelections" q-translation="GlobalSearch.NoMatchesWithinCurrentSelection"></span>\n    <span ng-if="!currentSelections" q-translation="GlobalSearch.NoMatchesForYourTerms"></span>\n</div>'},function(t,e){t.exports='<div>\n    <div class="qv-global-search-result-groups" ng-if="!error.show">\n\n        <div class="qv-global-search-result-message" >            \n            <qv-global-search-result-msg></qv-global-search-result-msg>\n\n            <div ng-if="haveUnlockedSelections()">\n                <button class="lui-button qv-gs-new-search-button" qva-activate="searchOutsideSelections($event)" tid="globalSearch.newSearchJustFor"\n\t\t\t\t\t\tq-translation="GlobalSearch.ClearSelectionAndSearchAgain" q-title-translation="GlobalSearch.ClearSelectionAndSearchAgain"\n\t\t\t\t\t\tng-class="{ \'lui-active\': focusState.activeStateName === focusState.StartNewSearch }"></button>\n            </div>\n        </div>\n    </div>      \n\n    <div class="qv-global-search-result-error" ng-if="error.show">\n        <span q-translation="{{error.translation}}"></span>\n    </div>\n</div>'},function(t,e){t.exports="<span ng-repeat=\"slice in slices track by $index\" ng-class=\"slice.highlight ? 'highlighted' + slice.qTerm : ''\">{{slice.qSliceText}}</span>"},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(896),n(50),n(97),n(897),n(899),n(371)],a=function(t,e,n,i){var a={MAX_MOBILE_VISUALS:10,PAGE_VISUALS:3,PAGE_VISUALS_PORTRAIT:2,PADDING_PAGES:15};t.directive("qvSmartsearchVisualsGroup",["$timeout",function(t){return{restrict:"E",template:e,replace:true,scope:{items:"=",searchTerms:"=",options:"=",app:"="},controller:function t(){this.loadPage=function(){};this.preparePages=function(){}},link:function e(s,r,o,l){var c=0;s.pageIndex=0;s.activeVisualIx=-1;s.pages=[];s.objects=null;var u=r.find(".visuals-wrapper"),d=false,p=n.isSmallDevice?400:600,h=function t(){p=n.isSmallDevice?400:600;u[0].scrollLeft=s.pageIndex*(u[0].offsetWidth+a.PADDING_PAGES)},f=function t(){l.preparePages(s.items[0].qItems)};n.OrientationChanged.bind(f);n.ViewChanged.bind(f);s.setPageIndex=function(t){s.pageIndex=t;for(var e=0;e<s.pages.length;e++)s.pages[e].forEach(function(n){s.options.preload?n.load=e===t||e===t+1||e===t-1:n.load=e===t})};i.on("update",h);s.goToPage=function(t){l.loadPage(t)};s.onSwipePage=function(t){l.loadPage(s.pageIndex+t)};s.$watch("items",function(t){t&&t.length&&l.preparePages(t[0].qItems)});s.$on("visualsGroupMoveActiveVisual",function(t,e){if(d)return;var n=s.pages.reduce(function(t,e){return t+e.length},0),i,a;i=s.activeVisualIx>0||e>0?(s.activeVisualIx+e)%n:n-1;a=Math.floor(i/c);a!==s.pageIndex&&l.loadPage(a);s.activeVisualIx=i});s.$on("visualsGroupBlur",function(){s.activeVisualIx=-1});s.$on("visualsGroupFocus",function(){s.activeVisualIx=0;0!==s.pageIndex&&l.loadPage(0)});s.$on("$destroy",function(){i.off("update",h);n.OrientationChanged.unbind(f);n.ViewChanged.unbind(f)});l.loadPage=function(e){if(!d&&e>=0&&e<s.pages.length){d=true;u.animate({scrollLeft:e*(u[0].offsetWidth+a.PADDING_PAGES)},p,"swing",function(){d=false;t(function(){s.setPageIndex(e)})})}};l.preparePages=function(t){if(t){g();var e,i=0,r=[];n.orientation===n.Orientation.landscape?e=n.isSmallDevice?1:a.PAGE_VISUALS:n.orientation===n.Orientation.portrait&&(e=n.isSmallDevice?1:a.PAGE_VISUALS_PORTRAIT);c=e;for(var o=0;o<t.length;o++){if(n.isSmallDevice&&r.length>=a.MAX_MOBILE_VISUALS&&r[i].length>=e)break;if(r[i]){if(r[i].length>=e){i++;r.push([])}}else r.push([]);t[o].itemIndex=o;t[o].load=s.options.preload?0===i||1===i:0===i;r[i].push(t[o])}s.pages=r}};function g(){s.pages=[];u.scrollLeft(0);s.pageIndex=0}}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="qv-smartsearch-visuals-group" qva-smart-search-swipe-horizontal="onSwipePage(delta)" >\n\t<div class="nav-visual-arrow left" qva-activate="goToPage( pageIndex - 1 );" ng-show="pageIndex > 0">\n\t\t<span class="lui-fade-button">\n\t\t\t<span class="lui-fade-button__icon  lui-icon lui-icon--arrow-left"></span>\n\t\t</span>\n\t</div>\n\t<div class="visuals-wrapper" >\n\t\t<div class="page" tid="swipeable-chart-page-container" ng-repeat="p in pages" ng-class="{ \'first\': $first, \'last\': $last }">\n\t\t\t<div class="content" >\n\t\t\t\t<qv-smartsearch-visual-preview\n\t\t\t\t\tng-repeat="visualItem in p"\n\t\t\t\t\tapp="app"\n\t\t\t\t\tactive-visual-ix="activeVisualIx"\n\t\t\t\t\tvisual-object="visualItem"\n\t\t\t\t\tsearch-terms="searchTerms"\n\t\t\t\t\tng-class="{ \'first\': $first && !$last, \'last\': $last, \'active\': focusState.activeStateName === focusState.Suggestions && activeVisualIx === visualItem.itemIndex }">\n\t\t\t\t</qv-smartsearch-visual-preview>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="nav-visual-arrow right" qva-activate="goToPage( pageIndex + 1 );" ng-show="pageIndex < (pages.length - 1)">\n\t\t<span class="lui-fade-button">\n\t\t\t<span class="lui-fade-button__icon  lui-icon lui-icon--arrow-right"></span>\n\t\t</span>\n\t</div>\n\n\t<qv-global-search-more-indicator pages="pages" active-page-ix="pageIndex" on-page-change="goToPage(index);"></qv-global-search-more-indicator>\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(54),n(95),n(105),n(898),n(89),n(114),n(123),n(370),n(169),n(267)],a=function(t,e,n,i,a,s,r,o){t.directive("qvSmartsearchVisualPreview",["$timeout",function(l){var c={TITLE:0,SUBTITLE:1,FOOTNOTE:2,DIMENSION:3,MEASURE:4,ALTERNATIVE_DIMENSION:5,ALTERNATIVE_MEASURE:6,TYPE:7,VALUE:8};function u(t,e){return e.getObject(t.qIdentifier).then(function(t){return{model:t,options:{isReadonly:true,isPopover:false,selectionsDisabled:true,interactionState:o.STATIC,components:{miniChart:{show:false},scrollArea:{showFlag:0}},direction:r.direction}}})}function d(t){var e=t.split("/");e=e.map(function(t){return parseInt(t)}).filter(function(t){return!Number.isNaN(+t)});return e.length?e[0]:-1}function p(t,e){t.id=-1;if(-1!==e.indexOf("qDimensions")||-1!==e.indexOf("qListObjectDef/qDef")){t.id=d(e);t.type=-1===e.indexOf("qLayoutExclude")?c.DIMENSION:c.ALTERNATIVE_DIMENSION;t.isLabel=-1!==e.indexOf("qFieldLabels")}else if(-1!==e.indexOf("qMeasures")){t.id=d(e);t.type=-1===e.indexOf("qLayoutExclude")?c.MEASURE:c.ALTERNATIVE_MEASURE;t.isLabel=-1!==e.indexOf("qLabel")}else{-1!==e.indexOf("subtitle")?t.type=c.SUBTITLE:-1!==e.indexOf("title")?t.type=c.TITLE:-1!==e.indexOf("footnote")?t.type=c.FOOTNOTE:-1!==e.indexOf("type")?t.type=c.TYPE:t.type=c.VALUE;t.isLabel=-1===e.indexOf("qExpr")}t.trans=h(t.type)}function h(t){var e="---";switch(t){case c.TITLE:e="Common.Title";break;case c.DIMENSION:e="Common.Dimensions";break;case c.MEASURE:e="Common.Measures";break;case c.ALTERNATIVE_DIMENSION:e="properties.alternative.dimensions";break;case c.ALTERNATIVE_MEASURE:e="properties.alternative.measures";break;case c.SUBTITLE:e="properties.subtitle";break;case c.FOOTNOTE:e="properties.footnote";break;case c.TYPE:e="properties.type";break;case c.VALUE:e="properties.dataPoints.labelmode.value";break}return e}return{restrict:"E",template:a,replace:true,require:["^qvGlobalSearch"],scope:{visualObject:"=",searchTerms:"=",activeVisualIx:"=",app:"="},link:function a(c,d,h,f){var g=t.getService("$navigationService").Sheets,v=t.getService("qvGlobalSearchDataService").getMaxColorsNum(),m=f[0],b;c.viz=null;c.termsMatched=null;c.extra=false;c.matches=null;c.loadManually=function(t){t.stopPropagation();c.viz.object.retry();c.isManualLoad=false};function y(){c.loadTimer=l(function(){if(c.viz.object){c.viz.object.cancel();c.isManualLoad=true}},c.visualObject.suggestedTimeout);c.viz.options.onRendered=function(){c.loadTimer&&l.cancel(c.loadTimer)}}c.$watch("visualObject.load",function(t){if(true===t){x();if(b)c.viz=b;else{u(c.visualObject,c.app).then(function(t){b=t;c.viz=t;c.viz.object={};c.visualObject.suggestedTimeout&&y()});q(c.visualObject.qItemMatches)}}else c.viz=null});c.$watch("searchTerms",function(t){t&&c.visualObject&&x()});c.$on("selectActiveVisualItem",function(){c.activeVisualIx===c.visualObject.itemIndex&&S()});c.$on("$destroy",function(){b=null});c.showMoreHits=function(t){t.stopPropagation();m.showMoreHitsForVisual(c.visualObject).then(function(t){q(t.qItemMatches)})};function S(t){var e=function t(e){e=e.filter(function(t){return t});return e.length?e[0]:null};C().then(function(a){var s=e(a);if(s){g.navigateToSheet(s.sheet);m.onNavigateToSheet(s.cell.name)}else if(t){var l={isReadonly:true,isPopover:false,selectionsDisabled:true,interactionState:o.ANALYSIS,components:{miniChart:{show:true},scrollArea:{showFlag:1}},direction:r.direction};n.publish(i.Events.PubSub.ExpandSmartSearchSuggestedChart,Object.assign({},t,{options:l}))}})}function x(){c.termsMatched=c.visualObject.qSearchTermsMatched.map(function(t){return{string:c.searchTerms[t],pos:t%v}})}function q(t){c.hitsDisplayed=t.length;var n,i,a;t.forEach(function(t){t.qAttributes&&t.qAttributes.length&&p(t,t.qAttributes[0][1])});n=c.visualObject.qItemMatches.filter(function(e){if(e.isLabel)return true;var n=t.filter(function(t){return t.isLabel&&e.type===t.type&&e.id===t.id&&e!==t});var i=e.qRanges.every(function(t){return n.some(function(e){return e.qRanges.some(function(e){return t.qTerm===e.qTerm})})});return!i});i=e.groupBy(n,function(t){return t.type});a=Object.keys(i).map(function(t){return i[t]});c.matches?a.forEach(function(t,e){if(t.length>c.matches[e].length){var n=c.matches[e].length;for(var i=n;i<t.length;i++)c.matches[e].push(t[i])}}):c.matches=a}function I(t,e,n){var i={sheet:t,cell:e};return e.name===c.visualObject.qIdentifier?s.resolve(i):"filterpane"===e.type?n.getObject(e.name).then(function(t){return t.getLayout().then(function(t){if(t.qChildList&&t.qChildList.qItems.length){var e=t.qChildList.qItems.filter(function(t){return t.qInfo.qId===c.visualObject.qIdentifier});return e.length?i:null}return null})}):s.resolve(null)}function C(){var t,e=[];for(var n=0;n<g.all.mashed.length;n++){t=g.all.mashed[n];for(var i=0;i<t.qData.cells.length;i++)e.push(I(t,t.qData.cells[i],c.app))}return s.all(e)}c.showExtraInfo=function(t){c.extra=!c.extra&&c.matches.length;t.stopPropagation()};c.navigateToSheet=function(t,e){if(!c.isManualLoad){t.stopPropagation();S(e)}}}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="visual-item">\n\t<div class="object" qva-activate="navigateToSheet($event, viz)" >\n\t\t<qv-object ng-if="viz && visualObject.load" model="viz.model" options="viz.options" object="viz.object"></qv-object>\n\t\t<div class="transparent-overlay"></div>\n\t\t<div ng-hide="visualObject.load" class="qv-animate progress">\n\t\t\t<div class="progress-loader"></div>\n\t\t</div>\n\t\t<div class="cao-mobile-manual-loader" ng-click="$event.stopPropagation()" ng-if="isManualLoad">\n\t\t\t<ul>\n\t\t\t\t<li class="cao-mobile-loader-text" q-translation="cao.card.complex">\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<lui-button ng-click="loadManually($event)" q-translation="cao.card.complex.load"></lui-button>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n\t<div class="visual-data" qva-activate="showExtraInfo($event);">\n\t\t<div ng-if="visualObject.load" class="keywords">\n\t\t\t<div class="terms">\n\t\t\t\t<span ng-repeat="t in termsMatched"><span ng-if="!$first">&nbsp;</span><span class="highlighted{{t.pos}}">{{t.string}}</span></span>\n\t\t\t</div>\n\t\t\t<div class="lui-fade-button" ng-if="matches.length" tid="swipeableChartPageInfoButton">\n\t\t\t\t<span class="lui-fade-button__icon lui-icon lui-icon--info"></span>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="extra-info" ng-if="visualObject.load" ng-class="{ \'show\': extra }">\n\t\t\t<div ng-if="matches.length" ng-repeat="hits in matches" class="hits">\n\t\t\t\t<div ng-repeat="hit in hits" class="match-hit">\n\t\t\t\t\t<span ng-if="$first"><b q-translation="{{hit.trans}}"></b>: </span><qv-global-search-highlights q-text="hit.qText" q-ranges="hit.qRanges" class="highlights"></qv-global-search-highlights><span ng-if="!$last">,&nbsp;</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="more-hits" qva-activate="showMoreHits($event)" ng-if="$last && (visualObject.qTotalNumberOfMatches-hitsDisplayed) > 0" q-translation="GlobalSearch.MoreResults,{{(visualObject.qTotalNumberOfMatches-hitsDisplayed)}}"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(99),n(900)],a=function(t,e,n){t.directive("qvGlobalSearchMoreIndicator",function(){return{replace:true,template:n,restrict:"E",scope:{pages:"=",activePageIx:"=",onPageChange:"&"},link:function t(n){n.touchOn=!e.treatAsDesktop();n.pressedPageIx=void 0;n.onPageClick=function(t){n.pressedPageIx=t;n.onPageChange({index:t})};n.$watch("activePageIx",function(){n.pressedPageIx=void 0})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="qv-gs-more-indicator" ng-class="{ \'touch-on\': touchOn }">\n\t<div class="hit-area"  qva-activate="onPageClick($index);" ng-repeat="p in pages">\n\t\t<span tid="swipeableChartPageClickDot" class="dot" ng-class="{ \'active\': $index === activePageIx, \'pressed\': $index === pressedPageIx }"></span>\n\t</div>\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(902)],a=function(t,e){t.directive("qvGlobalSearchSuggest",[function(){return{restrict:"E",template:e,replace:true,require:["^qvGlobalSearch"],link:function t(){}}}]);t.directive("qvScrollToActiveSuggestion",function(){return{restrict:"A",link:function t(e,n,i){i.$observe("qvScrollToActiveSuggestion",function(t){t=t+""==="true";if(t){var e=n.position(),i=n.parent(),a=n[0].clientWidth>i[0].clientWidth,s=e.left+n[0].clientWidth-i[0].clientWidth;n[0].scrollIntoView(a);e.left<=i[0].offsetLeft?i.scrollLeft(n[0].offsetLeft-i[0].offsetLeft):s>0&&!a&&(i[0].scrollLeft=i[0].scrollLeft+s)}})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="qv-search-suggest-wrapper" tid="globalSearch.suggestions">\n\t<span class="hidden">{{query}}</span>\n    <div ng-show="isSmallDevice" ng-if="!isObjectsFeature" class="dym" q-translation="GlobalSearch.DidYouMean"></div>\n\t<ul class="suggest-popup">\n\t\t<li ng-repeat="suggest in suggestions track by $index" qv-scroll-to-active-suggestion="{{$index === activeSuggestionIx && focusState.activeStateName === focusState.Suggestions}}" ng-class="{active: $index === activeSuggestionIx && focusState.activeStateName === focusState.Suggestions }" qva-activate="onSuggestSelect(null, suggest)" tid="globalSearch.suggestion" bold-suggest=\'{{suggest.value}}\'>\n\t\t\t{{suggest.value}}\n\t\t</li>\n\t</ul>\n</div>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(904),n(169)],a=function(t,e){t.directive("qvGlobalSearchHistory",["$timeout",function(n){return{restrict:"E",template:e,replace:true,require:["^qvGlobalSearch"],link:function e(i,a,s,r){var o=r[0],l=a.find(".history-popup")[0];i.colorsLimit=t.getService("qvGlobalSearchDataService").getMaxColorsNum();i.$watch("searchInputFocused",function(t){t&&n(function(){l.scrollTop=0})});i.onSearchHistorySelect=function(t){o.setQueryFromHistory(t)};i.clearSearchHistory=function(){o.clearHistory()};i.removeSelectedHistory=function(t){o.removeHistory(t)}}}}]);t.directive("qvScrollToActiveHistory",function(){return{restrict:"A",link:function t(e,n,i){i.$observe("qvScrollToActiveHistory",function(t){t=t+""==="true";n.toggleClass("active",t);t&&n[0].scrollIntoView(false)})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="qv-search-last-history" tid="globalSearch.searchHistory">\n\t<div class="history-header" ng-show="searchHistory.length">\n\t\t<div class="title"  q-translation="GlobalSearch.RecentSearches"></div>\n\t\t<div class="clear-all-button" q-translation="GlobalSearch.ClearAll" qva-activate="clearSearchHistory($index)"></div>\n\t</div>\n\t<ul class="history-popup" ng-show="searchHistory.length">\n\t\t<li ng-repeat="items in searchHistory track by $index" qva-delegated-activate=".history-query#onSearchHistorySelect($index); .lui-icon--close#removeSelectedHistory($index);" tid="globalSearch.searchHistoryItem" ng-class="{active: $index === activeHistoryIx && focusState.activeStateName === focusState.History}" qv-scroll-to-active-history="{{$index === activeHistoryIx && focusState.activeStateName === focusState.History}}">\n\t\t\t<div class="history-query">{{searchHistory[$index]}}</div>\n\t\t\t<div class="lui-icon lui-icon--close" q-title-translation="Common.Delete" title="Delete"></div>\n\t\t</li>\n\t</ul>\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(906),n(163),n(89),n(50),n(97),n(276),n(257),n(371)],a=function(t,e,i,a,s,r){var o={};Object.defineProperties(o,{THROBBER:{value:1e3},INDEX_PROGRESS:{value:5e3},NEXT_INDEX_PROGRESS:{value:500},HIDE_INDEX_DONE:{value:1e3}});t.directive("qvGlobalSearchThrobber",["$timeout","$window","$animate",function(l,c,u){return{replace:true,template:e,restrict:"E",link:function e(d,p){var h=t.getService("qvGlobalSearchService"),f,g,v,m,b=p.find(".qv-gs-index-progress .qv-gs-index-group"),y,S;d.asyncHideActivity=false;d.percentDone=void 0;d.imgSrc=n.p+"img/core/static/smart-search.png";d.pages=[{},{}];d.activePageIx=0;y=function t(){l(function(){b[0].scrollLeft=d.activePageIx*b[0].offsetWidth})};s.OrientationChanged.bind(y);r.on("update",y);d.goToPage=function(t){b.animate({scrollLeft:t*b[0].offsetWidth},400,"swing",function(){l(function(){d.activePageIx=t})})};d.onSwipePage=function(t){if(d.isSmallDevice){var e=t>0?1:0;e!==d.activePageIx&&d.goToPage(e)}};d.openHelp=function(){c.open(i.path+"SmartSearch_Intro")};d.$on("$destroy",function(){l.cancel(f);l.cancel(g);l.cancel(v);l.cancel(m);r.off("update",y);s.OrientationChanged.unbind(y);h.IndexProgressUpdate.unbind(E);u.off("removeClass",p[0])});function x(t){var e=a(),n=p.find(t)[0];u.on("removeClass",n,function(t,i){if("close"===i){u.off(n);e.resolve()}});return e.promise}function q(){d.throbber.show=false;d.indexProgress.enabled=false;d.indexProgress.show=false;d.indexProgress.visible=false;d.indexDone.show=false;d.indexDone.visible=false}function I(){if(void 0!==d.percentDone&&d.percentDone<100)return true;return h.couldEngineBeIndexing(d.app)}function C(t){if(!S){h.IndexProgressUpdate.bind(E);S=true}l.cancel(m);m=l(function(){h.requestIndexProgressUpdate(d.app)},t||0)}d.showIndexDone=function(){x(".qv-gs-index-done").then(function(){d.indexProgress.show=false;d.indexProgress.visible=false;d.indexDone.visible=true;d.percentDone=void 0;l.cancel(v);v=l(w,o.HIDE_INDEX_DONE)});d.indexDone.show=true};function w(){d.indexDone.visible=false;d.indexDone.show=false;l.cancel(f);d.$emit("updateForceShowDimmer",false);d.asyncHideActivity?P():f=l(A,o.THROBBER)}function D(t){x(".qv-gs-index-progress").then(function(){d.indexProgress.visible=true;d.isSmallDevice||d.$emit("updateForceShowDimmer",true)});d.percentDone=t;d.indexProgress.show=true;d.activity.show=true;d.throbber.show=false;t<100?C(o.NEXT_INDEX_PROGRESS):T()}function M(t){d.percentDone=t;t<100?C(o.NEXT_INDEX_PROGRESS):T()}function T(){l.cancel(m);if(S){h.IndexProgressUpdate.unbind(E);S=false}}function A(){d.activity.show=true;d.throbber.show=true;d.emptyMessageEnabled=false}function P(){l.cancel(f);l.cancel(g);l.cancel(v);l.cancel(m);T();d.activity.show=false;d.throbber.show=false;d.indexProgress.enabled=false;d.indexProgress.show=false;d.indexProgress.visible=false;d.emptyMessageEnabled=d.searchTerms.length>0}function k(){d.indexProgress.enabled=true;C()}function E(t,e){if(t!==(d.app.id||"").toUpperCase())return;var n=new Number(e);if(Number.isNaN(+n)||!e){d.indexProgress.enabled=true;C(o.INDEX_PROGRESS);return}if(!d.indexProgress.show&&n<100)D(n);else if(d.indexProgress.show)M(n);else{l.cancel(f);f=l(A,o.THROBBER)}}function _(t,e,n){if(e){d.asyncHideActivity=false;if(d.activity.show)return;q();l.cancel(f);l.cancel(g);if(I())k();else{f=l(A,o.THROBBER);g=l(k,o.INDEX_PROGRESS)}}else{var i=d.percentDone&&d.percentDone<100;if(i&&n){h.setLastKnownIndexProgress(d.app,100);T();d.percentDone=100;d.asyncHideActivity=true}else if(i&&!n){if(!d.isSmallDevice)return;P()}else if(100==d.percentDone){h.setLastKnownIndexProgress(d.app,100);T();d.asyncHideActivity=true}else P()}}d.$on("toggleActivityIndicator",_)}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div ng-show="activity.show" class="qv-qs-throbber-container qv-animate ng-hide">\n\n\t<div class="qv-gs-throbber-dimmer"></div>\n\n\t<div ng-show="throbber.show" class="qv-gs-throbber ng-hide"></div>\n\n\t<div ng-show="indexProgress.show" class="qv-gs-index qv-gs-index-progress qv-animate ng-hide">\n\n\t\t<div class="qv-gs-index-group" qva-smart-search-swipe-horizontal="onSwipePage(delta)">\n\t\t\t<div class="qv-gs-index-section">\n\t\t\t\t<div class="qv-gs-index-content qv-gs-index-content-shrink">\n\t\t\t\t\t<span class="qv-gs-index-header" q-translation="GlobalSearch.PreparingSmartSearch"></span>\n\n\t\t\t\t\t<qv-progress-bar percent-done="percentDone" on-completed="showIndexDone()"></qv-progress-bar>\n\n\t\t\t\t\t<span class="qv-gs-index-text" q-translation="GlobalSearch.NextTimeFaster"></span>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="qv-gs-index-section">\n\t\t\t\t<div class="qv-gs-index-content qv-gs-index-content-shrink">\n\t\t\t\t\t<div class="qv-gs-index-help" qva-activate="openHelp()">\n\t\t\t\t\t\t<span class="qv-gs-index-header" q-translation="GlobalSearch.LearnHowToUse"></span>\n\t\t\t\t\t\t<img ng-src="{{imgSrc}}" class="qv-gs-index-image" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<qv-global-search-more-indicator pages="pages" active-page-ix="activePageIx" on-page-change="goToPage(index);"></qv-global-search-more-indicator>\n\n\t</div>\n\n\t<div ng-show="indexDone.show" class="qv-gs-index qv-gs-index-done qv-animate ng-hide">\n\t\t<div class="qv-gs-index-section qv-gs-index-section-single">\n\t\t\t<div class="qv-gs-index-content qv-gs-index-shrink">\n\t\t\t\t<span class="qv-gs-index-icon lui-icon lui-icon--tick" aria-hidden="true"></span>\n\t\t\t\t<span class="qv-gs-index-text-big" q-translation="GlobalSearch.Done"></span>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n</div>'},function(t,e){t.exports='<div class="qv-progress-bar">\n\t<div class="progress-bar-bg">\n\t\t<div class="progress-bar-fg" ng-style="{ width: display }"></div>\n\t</div>\n\n\t<div class="progress-text" ng-bind="display" ng-hide="options.hideText"></div>\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(276),n(257)],a=function(t){t.directive("qvMobileIndexProgress",["$timeout",function(e){return{replace:true,template:'<div class="qv-mobile-index-progress"><qv-progress-bar ng-if="showMobileIndexProgressBar" percent-done="indexPercentDone" on-completed="hideMobileIndexProgressWhenDone()" options="progressBarOptions"></qv-progress-bar></div>',restrict:"E",link:function n(i){var a=t.getService("qvGlobalSearchService"),s,r;i.progressBarOptions={hideText:true};a.couldEngineBeIndexing(i.app)&&c(0);i.$on("$destroy",function(){e.cancel(r);a.IndexProgressUpdate.unbind(o)});i.hideMobileIndexProgressWhenDone=function(){i.showMobileIndexProgressBar=false};function o(t,e){if(t!==(i.app.id||"").toUpperCase())return;if(!i.showMobileIndexProgressBar&&e<100){i.indexPercentDone=e;i.showMobileIndexProgressBar=true;c(500)}else if(i.showMobileIndexProgressBar){i.indexPercentDone=e;e<100&&c(500)}else l()}function l(){e.cancel(r);if(s){a.IndexProgressUpdate.unbind(o);s=false}}function c(t){if(!s){a.IndexProgressUpdate.bind(o);s=true}e.cancel(r);r=e(function(){a.requestIndexProgressUpdate(i.app)},t||0)}}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(54),n(95),n(186),n(93),n(910),n(124),n(120),n(113),n(49),n(91),n(89),n(103),n(229),n(222),n(99),n(134),n(147),n(154),n(106),n(168),n(114),n(105),n(223),n(372),n(911),n(912),n(937),n(939),n(941),n(374),n(212),n(221),n(275),n(945),n(366),n(946),n(267),n(415),n(233),n(368),n(947),n(963)],a=function(t,e,n,i,a,s,r,o,l,c,u,d,p,h,f,g,v,m,b,y,S,x,q,I,C,w,D){var M=["$scope","$element","$window","$timeout","$q","qvCaoService","qvCaoSearchService","qvCaoChartService","qvAppDetailsService","qvCaoRenderService","qvCaoComplexityEstimatorService","qvCaoSelectionService",function(r,l,M,T,A,P,k,E,_,F,$,N){var O=this;var L=new x;var R=A.defer();var H=A.defer();var G=false;var j=0;O.zoomDeferred=null;O.lightEdits=[];r.loadedCount=0;r.query="";r.charts=[];r.chartMatches=[];r.renderableCharts=[];r.fieldList=[];r.debug=c.CAO_DEBUG;r.syncFieldPicker=u.getFlag("CAO_FIELD_PICKER_SYNC");r.insightFeedback=u.getFlag("CE_PRECEDENTS");r.caoTweakEnabled=u.getFlag("CAO_TWEAK");r.nluEnabled=u.getFlag("NLU_INSIGHTS");r.nluQueryInfoVisible=false;r.nluRawResponse=null;r.learningPerformed=false;r.contextPanelVisible=false;r.assetsPanelVisible=true;r.showHidden=false;r.showFieldPicker=true;r.limitedAccess=null;r.scrollContainer=l.find(".qv-cao-scroll-content")[0];r.mouseUp=function(){r.focusBorder=true};r.resultLabel=d.get("cao.search.title",[0,0,0,0]);r.introHeader=r.nluEnabled?d.get("cao.search.intro.nlu.header"):d.get("cao.search.intro.header");r.introDescriptionSearch=d.get("cao.search.intro.description.search");r.introDescriptionNoFields=d.get("cao.search.intro.description.nofields");r.introDescriptionGenerateInsights=d.get("cao.search.intro.description.generateInsights");r.introButton=d.get("cao.search.intro.button");r.goToSheetButton=d.get("cao.search.gotosheet.button");r.cellStatusElem=l.find("#sr-cell-status-label");r.direction=q.direction;r.appPrecedents={enabled:true};r.state="INIT";r.gridScreenReader=d.get("Cao.Accessibility.Object.Description");r.onGridFocus=function(){r.gridScreenReader=G?"":d.get("Cao.Accessibility.Object.Description")};r.onGridBlur=function(){T(function(){G=!!document.activeElement&&document.activeElement.classList.contains("cao-insight-container");r.gridScreenReader=""},1)};o.load();m.getList().then(function(t){r.masterDimensionsListModel=t});S(r,"masterDimensionsListModel",function(){V()});b.getList().then(function(t){r.masterMeasuresListModel=t});S(r,"masterMeasuresListModel",function(){V()});y.getList().then(function(t){r.fieldsListModel=t});S(r,"fieldsListModel",function(){V()});r.updateDirection=function(t){r.direction!==t&&(r.direction=t)};r.closeAndGoToSheet=function(){P.toggleCao();i.publish("cao/insights/close")};q.DirectionChanged.bind(r.updateDirection);s.getApp().then(function(i){H.resolve();r.app=i;r.contextPanelVisible=C.storageObj(i.id).contextPanel;r.assetsPanelVisible=C.storageObj(i.id).assetsPanel;_.get().then(function(t){r.limitedAccess=Boolean(t.model.app.published||!t.model.permissions.update)}).then(function(){p.all({appFieldList:i.getFieldList(),classificationsResult:e.getService("classificationService").getClassification(),appScrape:P.scrapeApp()}).then(function(e){var s=e.classificationsResult?new f(e.classificationsResult):void 0;a.addClassificationDataToFields(e.appFieldList,s);R.resolve();$.init(i);r.state="INTRO";v.treatAsDesktop()&&T(function(){t("#cao-search-input").focus()});k.getMasterItems().then(function(t){r.limitedAccess&&0===t.length&&(r.state="NO_FIELDS")});r.fieldList=e.fieldList;k.clearSelectedFields();k.registerForCaoSearchQuery(n.debounce(z,300));V()},function(){R.reject();B()})});r.app.getLayout().then(function(t){r.permissions=t.permissions})},function(){H.reject();B()});function V(){k.createFieldList().then(function(t){r.fieldList=t})}function z(t){P.setRefreshIndicatorVisibility(false);if("NO_FIELDS"===r.state)return;if(t.showIntro){r.state="INTRO";r.$apply(function(){r.query="";r.charts=[];r.chartMatches=[];r.selectedFieldNames=[]});return}r.query=t.query?t.query:"";r.loadGraphs(t.query);r.selectedFieldNames=t.selectedFields?t.selectedFields:[]}r.refreshCharts=function(){if("INTRO"===r.state){P.setRefreshIndicatorVisibility(false);return}i.publish("cao/insight/refreshPerformed");r.state="LOADING";P.setRefreshIndicatorVisibility(false);r.clearChartSelection();T(function(){F.clearRenderQueue();r.charts=[];r.chartMatches=[]}).then(function(){E.refreshInsights(r.appPrecedents.enabled).then(function(t){r.state="LOADED";r.loadedCount++;r.charts=t.recommendations;r.chartMatches=t.chartMatches;r.learningPerformed=false}).catch(B)})};r.$watch("appPrecedents.enabled",function(t,e){t!=e&&r.refreshCharts()});r.clearInsightResults=function(){i.publish("cao/insights/clear")};r.isClearResultsVisible=function(){return r.caoTweakEnabled&&(r.charts&&r.charts.length>0||r.chartMatches&&r.chartMatches.length>0)};r.setItemAccFocusVisibility=function(){this.itemAccFocus=true};r.removeItemAccFocusVisibility=function(){this.itemAccFocus=false};r.toggleFieldPicker=function(){r.showFieldPicker=!r.showFieldPicker;h.trackEvent(h.customEvents.INSIGHTS_FIELD_PICKER,{type:r.showFieldPicker?"open":"close"});T(r.resizeCharts)};r.resizeCharts=function(){g.resizeCharts(M)};function B(t){j--;t&&(t.norefresh||t.notFound)?t.notFound&&(r.state="NOT_FOUND"):r.state="ERROR";r.learningPerformed=false}r.loadGraphs=function(t){F.clearRenderQueue();P.setRefreshIndicatorVisibility(false);"LOADED"===r.state&&r.$apply(function(){r.charts=[];r.chartMatches=[]});r.state="LOADING";r.showHidden=false;var e=new Date;H.promise.then(function(){R.promise.then(function(){j++;var n;n=r.nluEnabled&&t&&t.length?w.parseQuery(t,r.app.id).then(function(t){r.nluRawResponse=t;i.publish("cao/nlu/new_queries",t);var e=D.buildDataCollection(t);return E.getVisualRecommendations(r.app,e,r.limitedAccess)}):E.getInsights(r.app,t,r.limitedAccess,r.appPrecedents.enabled);n.then(function(t){j--;if(j>0)return;r.state="LOADED";r.loadedCount++;r.charts=t.recommendations;r.chartMatches=t.chartMatches;var n=new Date;var i=(n-e)/1e3;h.trackEvent(h.customEvents.INSIGHTS_SEARCH,{query:r.query,queryTime:i})},B)},B)},B)};r.selectField=function(t){if(r.syncFieldPicker){r.fieldToAdd=t.selected?null:t;r.fieldToRemove=t.selected?t:null}else{r.fieldToAdd=null;T(function(){r.fieldToAdd=t})}i.publish("cao/insight/contextPanelToggled",!!r.insightFeedback&&C.storageObj(r.app.id).contextPanel);r.clearChartSelection()};r.updateFieldPicker=function(){T(function(){r.fieldList=[];r.fieldList=k.getFields()})};r.zoomChart=function(t){O.zoomDeferred=A.defer();r.zoomOpen=true;t.zoomed=true;T(function(){l.find(".qv-cao-zoomed-anmiation-container").addClass("animate-expand");T(function(){r.zoomedChart=t},400)});return O.zoomDeferred.promise};r.exitZoom=function(){T(function(){l.find(".qv-cao-zoomed-anmiation-container").addClass("animate-shrink");r.zoomedChart=void 0;T(function(){r.zoomOpen=false;O.zoomDeferred.resolve()},400)});return O.zoomDeferred.promise};r.sendFeedback=function(t,e){var n=t.getAnalysis();if(e===I.Precedents.PrecedentTypes.Dislike)return n.precedents&&n.precedents.disliked?L.undislikeAnalysis(n).then(function(){delete n.precedents;return false}):L.dislikeAnalysis(n).then(function(t){n.precedents={id:t.nodes[0].id,disliked:true};return true});if(e===I.Precedents.PrecedentTypes.Like)return L.likeAnalysis(n).then(function(t){n.precedents={id:t.nodes[0].id,liked:true};return true})};function U(e){t(e.currentTarget).blur()}r.showHiddenCharts=function(){r.showHidden=!r.showHidden;r.showHidden&&T(function(){var e=t(".qv-cao-section-hidden")[0];e&&e.scrollIntoView&&e.scrollIntoView({behavior:"smooth",block:"start"})})};r.showFoundInsights=function(t){13===t.which?r.chartsToShow={charts:r.chartMatches,activeTab:"found"}:"click"===t.type&&(r.chartsToShow={charts:r.chartMatches,activeTab:"found"});U(t)};r.showGeneratedInsights=function(t){13===t.which?r.chartsToShow={charts:r.renderableCharts,activeTab:"generated"}:"click"===t.type&&(r.chartsToShow={charts:r.renderableCharts,activeTab:"generated"});U(t)};r.isRefreshIndicatorVisible=function(){return P.getRefreshIndicatorVisibility()};r.isCaoInsightContextPanelVisible=function(){return r.caoTweakEnabled&&r.contextPanelVisible&&"ERROR"!==r.state};r.clearChartSelection=function(){N.clearSelection()};r.isChartSelected=function(){var t=N.getSelectedChart();return t&&r.zoomedChart&&r.zoomedChart===t};r.toggleNluQueryInfo=function(){r.nluQueryInfoVisible=!r.nluQueryInfoVisible};function K(t){r.contextPanelVisible=t}function W(t){r.assetsPanelVisible=t}function Q(t){r.learningPerformed=t}i.subscribe("cao/insight/refresh",r.refreshCharts);i.subscribe("cao/insight/contextPanelToggled",K);i.subscribe("cao/insight/assetsPanelToggled",W);i.subscribe("cao/insight/learningPerformed",Q);r.$watchGroup(["charts","chartMatches"],function(){0===r.charts.length&&"LOADED"===r.state&&B({notFound:true});r.renderableCharts=r.charts.filter(function(t){return!r.insightFeedback||!t.isHidden()});r.chartsToShow={charts:r.renderableCharts,activeTab:"generated"};r.hiddenCharts=r.charts.filter(function(t){return t.isHidden()});r.numberOfGeneratedInsights=d.get("cao.search.info.title.generated.plural",r.renderableCharts.length.toString());r.numberOfFoundInsights=d.get("cao.search.info.title.found.plural",r.chartMatches.length.toString());function t(){var t=[];if(r.charts.length+r.chartMatches.length===0)return null;r.charts.length+r.chartMatches.length>0&&t.push(d.get("cao.search.titleResults",[r.charts.length+r.chartMatches.length]));r.renderableCharts.length>0&&t.push(d.get("cao.search.titleGenerated",[r.renderableCharts.length]));r.hiddenCharts.length>0&&t.push(d.get("cao.search.titleHidden",[r.hiddenCharts.length]));switch(t.length){case 3:return d.get("cao.search.titleLength3",t);case 2:return d.get("cao.search.titleLength2",t);default:break}}r.resultLabel=t()});r.$on("$destroy",function(){k.unRegisterFromCaoSearchQuery(z);F.clearRenderQueue();i.unsubscribe("cao/insight/refresh");i.unsubscribe("cao/insight/contextPanelToggled");i.unsubscribe("cao/insight/assetsPanelToggled");i.unsubscribe("cao/insight/learningPerformed");q.DirectionChanged.unbind(r.updateDirection)})}];e.directive("qvCaoComponent",function(){return{restrict:"E",template:r,controller:M,scope:true,replace:true,link:function t(e){l.getList().then(function(t){t.getLayout().then(function(t){e.sheets=t})});e.target=null}}});return"<qv-cao-component></qv-cao-component>"}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="qv-cao overlay" id="qv-cao-overlay" style="display:none;" ng-keyup="setItemAccFocusVisibility()" ng-mouseup="removeItemAccFocusVisibility()">\n\t<div class="qv-cao-zoomed-chart" ng-if="zoomOpen" ng-class="{\'cao-tweak-width\' : caoTweakEnabled && isChartSelected() && contextPanelVisible}">\n\t\t<div class="qv-cao-zoomed-anmiation-container" ng-if="zoomOpen">\n\t\t\t<qv-cao-insight class="qv-cao-section-result-item qv-cao-section-result-item-zoomed" ng-class="{\'cao-insight-focus\': itemAccFocus}"\n\t\t\t\tng-if="zoomedChart"\n\t\t\t\tchart="zoomedChart"\n\t\t\t\tapp="::app"\n\t\t\t\tdebug="::debug"\n\t\t\t\tsheets="::sheets"\n\t\t\t\tinteractive="::true"\n\t\t\t\talways-show-header="true"\n\t\t\t\theader-icon="lui-icon--arrow-left"\n\t\t\t\theader-action="exitZoom"\n\t\t\t\tpermissions="permissions"\n\t\t\t\tng-keyup="mouseUp"\n\t\t\t\tsend-feedback="sendFeedback(chart, type)"\n\t\t\t\tdirection="direction"\n\t\t\t\tis-cao-context-panel-visible="contextPanelVisible"\n\t\t\t>\n\t\t\t</qv-cao-insight>\n\t\t</div>\n\t</div>\n\n\t<div ng-if="assetsPanelVisible" class="qv-cao-field-picker" ng-class="{ \'hide-field-picker\' : !showFieldPicker, \'field-picker-panel-container\': caoTweakEnabled }" tid="cao-assets-panel">\n\t\t<qv-cao-field-picker\n\t\t\tinsights-loaded="state !== \'INIT\'"\n\t\t\tis-limited ="limitedAccess"\n\t\t\tclass ="field-picker"\n\t\t\ttoggle-field-picker="toggleFieldPicker"\n\t\t\tshow-field-picker="showFieldPicker"\n\t\t\titems="fieldList"\n\t\t\tselect-field="selectField">\n\t\t</qv-cao-field-picker>\n\t</div>\n\n\t<div class="qv-cao-search" ng-class="{ \'hide-field-picker\' : !showFieldPicker, \'search-container-with-context-panel\': caoTweakEnabled, \'search-container-nlu\': nluEnabled }">\n\t\t<div class="qv-cao-insights-header" ng-if="nluEnabled && (state === \'INTRO\' || state === \'INIT\')">\n\t\t\t<h1 q-translation="cao.CognitiveAssociativeOverlay"></h1>\n\t\t\t<button class=\'lui-button\' tid="go-to-sheet-intro-btn" ng-click="closeAndGoToSheet()">\n\t\t\t\t{{ goToSheetButton }}\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="qv-cao-nlu-intro" ng-if="nluEnabled && (state === \'INTRO\' || state === \'INIT\')">\n\t\t\t<div class="qv-cao-intro-image"></div>\n\t\t\t<h1>{{ introHeader }}</h1>\n\t\t</div>\n\t\t<qv-cao-search field-to-remove="fieldToRemove"\n\t\t\t\t\tfield-to-add="fieldToAdd"\n\t\t\t\t\tupdate-field-picker="updateFieldPicker"\n\t\t\t\t\tclear-field-picker="clearFieldPicker"\n\t\t\t\t\tis-limited ="limitedAccess"\n\t\t\t\t\tdirection="direction"\n\t\t\t\t\tdata-disabled="state === \'INIT\'"\n\t\t\t\t\tnlu-query-info-button-visible="state === \'LOADED\'"\n\t\t\t\t\tnlu-query-info-visible="nluQueryInfoVisible"\n\t\t\t\t\ttoggle-nlu-query-info="toggleNluQueryInfo">\n\t\t</qv-cao-search>\n\t\t<div class="qv-cao-search-info" ng-if="nluEnabled && nluQueryInfoVisible">\n\t\t\t<div class="qv-cao-search-info-debug" ng-if="debug">\n\t\t\t\t<h2>Debug Information</h2>\n\t\t\t\t<p class="qv-cao-search-info-response-text">{{ nluRawResponse | json : spacing }}</p>\n\t\t\t</div>\n\t\t</div>\n\t\t<p ng-if="nluEnabled && (state === \'INTRO\' || state === \'INIT\')" class="qv-cao-nlu-intro-suggestion-text" q-translation="cao.search.nlu.suggestedQuestionsText"></p>\n\n\t\t<div class="qv-cao-search-line" ng-if="!nluEnabled || (state !== \'INTRO\' && state !== \'INIT\')"></div>\n\n\t\t<div class="qv-cao-scroll-content">\n\t\t\t<div class="qv-cao-scroll-area">\n\n\t\t\t\t<div class="qv-cao-intro" ng-if="state === \'INTRO\' || state === \'INIT\'">\n\t\t\t\t\t<div class="qv-cao-intro-content">\n\t\t\t\t\t\t<div class="qv-cao-intro-image"></div>\n\t\t\t\t\t\t<h1>{{ introHeader }}</h1>\n\t\t\t\t\t\t<p>{{ introDescriptionSearch }}</p>\n\t\t\t\t\t\t<p ng-if="state === \'INTRO\'">{{ introDescriptionGenerateInsights }}</p>\n\t\t\t\t\t\t<div class="btns">\n\t\t\t\t\t\t\t<button class=\'lui-button lui-button--large\' tid="go-to-sheet-intro-btn" ng-click="closeAndGoToSheet()" ng-if="state === \'INTRO\' ">\n\t\t\t\t\t\t\t\t{{ goToSheetButton }}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button class=\'lui-button lui-button--success lui-button--large\' tid="generate-insights-intro-btn" ng-click="loadGraphs()" ng-if="state === \'INTRO\' ">\n\t\t\t\t\t\t\t\t{{ introButton }}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-if="state === \'INIT\'">\n\t\t\t\t\t\t\t<div class="loader">\n\t\t\t\t\t\t\t\t<qv-spinner show="state === \'INIT\'" show-delay="300" center-in-parent="true"></qv-spinner>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<p q-translation="cao.loading"></p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="qv-cao-intro" ng-if="state === \'NO_FIELDS\'">\n\t\t\t\t\t<div class="qv-cao-intro-content">\n\t\t\t\t\t\t<div class="qv-cao-intro-image"></div>\n\t\t\t\t\t\t<h1>{{ introHeader }}</h1>\n\t\t\t\t\t\t<p>{{ introDescriptionNoFields }}</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="qv-cao-intro" ng-if="state === \'ERROR\'">\n\t\t\t\t\t<div class="qv-cao-intro-content">\n\t\t\t\t\t\t<h1 q-translation="cao.error.header"></h1>\n\t\t\t\t\t\t<p q-translation="cao.error.description"></p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="qv-cao-intro" ng-if="state === \'NOT_FOUND\'">\n\t\t\t\t\t<div class="qv-cao-intro-content">\n\t\t\t\t\t\t<h1 q-translation="cao.error.header"></h1>\n\t\t\t\t\t\t<p q-translation="cao.error.description.notfound"></p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="qv-cao-section qv-cao-section-insights">\n\t\t\t\t\t<div class="qv-cao-loading" ng-if="state === \'LOADING\'">\n\t\t\t\t\t\t<div class="spinner-container">\n\t\t\t\t\t\t\t<qv-spinner show="state === \'LOADING\'" show-delay="300" center-in-parent="true"></qv-spinner>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="qv-cao-section-header"\n\t\t\t\t\t\tng-if="state === \'LOADED\'">\n\t\t\t\t\t\t<p class="qv-cao-section-header-text" ng-if="chartMatches.length === 0">{{resultLabel}}</p>\n\t\t\t\t\t\t<span style="display:none;" ng-show="state === \'LOADED\'" tid="cao-last-loaded-query" test-attribute="{{query}}" test-loaded-count="{{loadedCount}}">\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<ul class="lui-tabset qv-cao-section-header-text" ng-if="chartMatches.length > 0">\n\t\t\t\t\t\t\t<li class="lui-tab cao-tab qv-cao-section-header-tab1" ng-class="{\'lui-active\' : chartsToShow.activeTab === \'generated\'}" tabindex="0" ng-click="showGeneratedInsights($event)" ng-keypress="showGeneratedInsights($event)">\n\t\t\t\t\t\t\t  <span class="lui-tab__text qv-cao-section-header-tab1-text">{{numberOfGeneratedInsights}}</span>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li class="lui-tab cao-tab qv-cao-section-header-tab2" ng-class="{\'lui-active\' : chartsToShow.activeTab === \'found\'}" tabindex="0" ng-click="showFoundInsights($event)" ng-keypress="showFoundInsights($event)">\n\t\t\t\t\t\t\t  <span class="lui-tab__text qv-cao-section-header-tab2-text">{{numberOfFoundInsights}}</span>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<div class="results-action-container" ng-class="{\'results-action-container--tabset\': chartMatches.length > 0}">\n\t\t\t\t\t\t\t<button class="lui-button clear-insights-btn" ng-if="isClearResultsVisible()" tid="clear-insights-btn" ng-click="clearInsightResults()" q-translation="cao.insights.clear"></button>\n\t\t\t\t\t\t\t<button class="lui-button lui-button--success refresh-insights-btn" ng-if="caoTweakEnabled && learningPerformed" tid="refresh-insights-btn" ng-click="refreshCharts()" q-translation="cao.insight.results.refreshButton"></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="qv-cao-section-results" ng-if="state === \'LOADED\'">\n\t\t\t\t\t\t<qv-cao-insight class="qv-cao-section-result-item" ng-class-odd="\'qv-cao-section-result-item-odd\'" ng-focus="onGridFocus()" ng-blur="onGridBlur()" ng-repeat="chart in chartsToShow.charts | orderBy : \'-chart.relevance\'" ng-class="{\'cao-insight-focus\': itemAccFocus}"\n\t\t\t\t\t\t\tgrid-screen-reader="gridScreenReader"\n\t\t\t\t\t\t\tindex="$index"\n\t\t\t\t\t\t\tchart="chart"\n\t\t\t\t\t\t\tapp="::app"\n\t\t\t\t\t\t\tsheets="::sheets"\n\t\t\t\t\t\t\tdebug="::debug"\n\t\t\t\t\t\t\tinteractive="::false"\n\t\t\t\t\t\t\tdirection="direction"\n\t\t\t\t\t\t\tscroll-container="scrollContainer"\n\t\t\t\t\t\t\theader-action="zoomChart"\n\t\t\t\t\t\t\theader-icon="lui-icon--expand"\n\t\t\t\t\t\t\tpermissions="permissions"\n\t\t\t\t\t\t\tsend-feedback="sendFeedback(chart, type)"\n\t\t\t\t\t\t\ton-insight-focus="onGridFocus()"\n\t\t\t\t\t\t\ton-insight-blur="onGridBlur()">\n\t\t\t\t\t\t</qv-cao-insight>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="qv-cao-section-footer" ng-if="state === \'LOADED\' && insightFeedback && hiddenCharts.length > 0 && chartsToShow.activeTab !== \'found\' && !caoTweakEnabled">\n\t\t\t\t\t\t<span q-translation="cao.card.section.hidden,{{hiddenCharts.length}}"></span>\n\t\t\t\t\t\t<a class="lui-fade-button show-more-button" ng-click="showHiddenCharts()">\n\t\t\t\t\t\t\t(<span q-translation="{{ showHidden ? \'cao.card.section.hidden.hide\' : \'cao.card.section.hidden.show\' }}"></span>)\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="qv-cao-section-results qv-cao-section-hidden" ng-if="state === \'LOADED\' && showHidden && chartsToShow.activeTab !== \'found\' && !caoTweakEnabled">\n\t\t\t\t\t\t<qv-cao-insight class="qv-cao-section-result-item" ng-class-odd="\'qv-cao-section-result-item-odd\'" ng-focus="onGridFocus()" ng-blur="onGridBlur()" ng-repeat="chart in hiddenCharts | orderBy : \'-chart.relevance\'" ng-class="{\'cao-insight-focus\': itemAccFocus}"\n\t\t\t\t\t\t\tgrid-screen-reader="gridScreenReader"\n\t\t\t\t\t\t\tindex="$index + renderableCharts.length"\n\t\t\t\t\t\t\tchart="chart"\n\t\t\t\t\t\t\tapp="::app"\n\t\t\t\t\t\t\tsheets="::sheets"\n\t\t\t\t\t\t\tdebug="::debug"\n\t\t\t\t\t\t\tinteractive="::false"\n\t\t\t\t\t\t\tdirection="direction"\n\t\t\t\t\t\t\tscroll-container="scrollContainer"\n\t\t\t\t\t\t\theader-action="zoomChart"\n\t\t\t\t\t\t\theader-icon="lui-icon--expand"\n\t\t\t\t\t\t\tpermissions="permissions"\n\t\t\t\t\t\t\tsend-feedback="sendFeedback(chart, type)"\n\t\t\t\t\t\t\ton-insight-focus="onGridFocus()"\n\t\t\t\t\t\t\ton-insight-blur="onGridBlur()">\n\t\t\t\t\t\t</qv-cao-insight>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="qv-cao-footer" ng-if="nluEnabled && (state === \'INTRO\' || state === \'INIT\')">\n\t\t\t<p>{{ introDescriptionGenerateInsights }}</p>\n\t\t\t<button class=\'lui-button lui-button--success\' tid="generate-insights-intro-btn" ng-click="loadGraphs()">\n\t\t\t\t{{ introButton }}\n\t\t\t</button>\n\t\t</div>\n\t\t<qv-cao-refresh-indicator ng-if="isRefreshIndicatorVisible()" />\n\t</div>\n\n\t<qv-cao-insights-context-panel ng-if="isCaoInsightContextPanelVisible()" app="app" hidden-charts="hiddenCharts" class="context-panel cao-height" tid="cao-context-panel" state="state" insight-feedback="insightFeedback" precedents-enabled="appPrecedents.enabled"></qv-cao-insights-context-panel>\n\t<qv-cao-insights-bottom-panel ng-if="caoTweakEnabled" app="app" insight-feedback="insightFeedback"></qv-cao-insights-bottom-panel>\n</div>\n'},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t=function t(){};function e(t){if(t){var e=t.filter(function(t){return t.type.startsWith("master_")});var n=t.filter(function(t){return t.type.startsWith("field")});if(e.length)return e[0];if(n.length)return n[0]}}function n(t,e,n){var i=null;if(e.type.startsWith("master_")){i={libId:e.libId};t.libItems.push(i)}else if("field"===e.type){i={name:e.name};t.fields.push(i)}i&&n&&(i.cond=n)}t.buildDataCollection=function(t){var i={fields:[],libItems:[]};if(t.entities){t.entities.filter(function(t){return"model_element"==t.type}).forEach(function(t){var a=e(t.model_elements);null!=a&&n(i,a)});t.entities.filter(function(t){return"data_value"==t.type&&"filter-category"==t.role}).forEach(function(t){if(t.data_values&&t.data_values.length){var e=t.data_values[0];n(i,e.owner,["==",e.value])}})}if(t.intent){var a=t.intent.name.split("-")[1];a&&(i.analysisTypes=[a])}return i};return t}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(54),n(122),n(94),n(322),n(91),n(90),n(128),n(49),n(103),n(97),n(222),n(105),n(95),n(123),n(223),n(913),n(914),n(915),n(916),n(917),n(918),n(919),n(920),n(934),n(374)],a=function(t,e,n,i,a,s,r,o,l,c,u,d,p,h,f,g,v,m,b,y,S,x,q){var I=["$scope","qvCaoService","qvAccessibilityGridService","$element","$timeout","qvContextMenu","$exportDialog","luiPopover","$window","qvCaoSelectionService",function(e,m,I,C,w,D,M,T,A,P){var k=this;var E=null;var _=[];var F;this.id=o.generateId();this.activeSheet=l.getModel();this.viewDataToggled=false;this.chartLoaded=false;this.contextMenuStatus={open:false};this.lightEditing=c.getFlag("INSIGHT_LIGHT_EDITING");this.generatedChartScreenReaderLabel=r.get("generated.insight.card.screen.reader");this.insightFeedback=c.getFlag("CE_PRECEDENTS");this.insightLearning=c.getFlag("CE_PRECEDENTS");this.caoTweakEnabled=c.getFlag("CAO_TWEAK");this.popupOpen=false;this.shouldFadeToast=false;this.onResize=function(){if(k.row>=0&&k.col>=0){var t=k.row;var e=k.col;k.setRowAndColumn();var n=t!==k.row;n=n||e!==k.col;n&&I.updateItem(k.id,"CaoInsight",k.row,k.col)}};this.resetFocusOnMouseup=function(){k.isFocused=false};this.setFocusOnInsight=function(t){w(function(){k.isFocused=t})};this.setRowAndColumn=function(){var t=3;A.innerWidth<=1024?t=1:A.innerWidth<=1920&&(t=2);k.row=Math.floor(k.index/t);k.col=k.index%t;k.hideConfidenceText=C[0].clientWidth<390};var $=C.find("#sr-cell-status-label");e.accCallback=function(t,e){var n=t===this.col&&e===this.row;k.tabIndex=n?0:-1;n||k.onInsightBlur();w(function(){k.isFocused=!!n})};this.getChartAddMenuItems=function(t){var e=k.chart.isFound();if(e&&!k.isHidden()){var n=k.chart.getSheetsThisChartAppearsOn()[0];t.addItem({translation:k.getSheetName(n),icon:"goto",tid:"cao-external-link",select:function t(){k.gotoSheet(n)}})}var i=[];k.sheets.forEach(function(t){t.permissions&&t.permissions.update&&i.push({translation:t.qMeta.title,tid:"cao-add-to-sheet",icon:"sheet",select:function n(){e&&(k.isCopyMenuItemSelected=true);k.addChartToSheet(t.qInfo.qId)}})});if(k.permissions&&k.permissions.createSheet&&!k.isHidden()){i.push({translation:"cao.search.add.createNewSheet",tid:"cao-add-to-new-sheet",icon:"plus",select:function t(){k.addToNewSheet()}});if(i.length>0){var a=t.addItem({translation:e?"cao.resultitem.contextMenu.copyItem":"cao.resultitem.contextMenu.addItem",icon:e?"copy":"plus",tid:"cao-add"});i.forEach(function(t){a.addItem(t)})}}};this.getChartMenuItems=function(t){var e={translation:"contextMenu.export",tid:"export",icon:"export",select:function t(){k.exportData()}};k.chart.isDataViewSupported()&&k.interactive&&!k.isHidden()&&t.addItem({translation:k.chart.isViewDataToggled()?"contextMenu.viewSource":"contextMenu.viewData",tid:"toggle-flip-to-table",icon:k.chart.isViewDataToggled()?"back":"table",select:function t(){k.flipToTable()}});if(k.chart.isViewDataToggled())k.enableShare&&k.chart.getObject().supportExportData()&&t.addItem(e);else if(!k.isHidden()){k.insightLearning?k.insightLearning&&k.chart.isModified()&&!k.interactive&&!k.caoTweakEnabled&&t.addItem({translation:"cao.insight.inlinerefresh.indicator.action",tid:"cao-learn",icon:"lightbulb",select:function t(){k.refreshAndLearn()}}):t.addItem({translation:"cao.resultitem.info",tid:"cao-open-info",icon:"info",select:function t(){k.openInfo()}});this.getChartAddMenuItems(t);if(k.enableShare&&(k.chart.getObject().supportExport()||k.chart.getObject().supportExportData())){var n=t.addItem({translation:"contextMenu.exportGroup",tid:"cao-share",icon:"export"});if(k.chart.getObject().supportExport()){n.addItem({translation:"contextMenu.export.chart.image",tid:"cao-print-object-image",select:function t(){k.exportToImage()}});n.addItem({translation:"contextMenu.export.chart.pdf",tid:"cao-print-object-pdf",select:function t(){k.exportToPdf()}})}k.enableShare&&k.chart.getObject().supportExportData()&&n.addItem({translation:"contextMenu.export",tid:"export",select:function t(){k.exportData()}})}k.caoTweakEnabled&&k.chart.isGenerated()&&t.addItem({translation:k.isSelected()?"cao.resultitem.finishEditInsightProperties":"cao.resultitem.editInsightProperties",tid:"cao-editInsightProperties",icon:k.isSelected()?"tick":"edit",select:function t(){k.editInsightProperties()}})}k.isHidden()||t.addItem({translation:k.interactive?"cao.resultitem.collapse":"cao.resultitem.expand",tid:"cao-expandCollapseChart",icon:k.interactive?"collapse":"expand",select:function t(){k.headerAction(k.chart)}});this.insightFeedback&&k.chart.isGenerated()&&t.addItem({translation:this.getFeedbackText(),tid:"cao-hideSuggestedChart",icon:"view",select:function t(){k.sendUserFeedback()}})};this.setChartBlurHandler=function(){this.chart.getObject().setOnBlurHandler(function(){I.setFocus("CaoInsight",k);k.isFocused=true})};this.editorKeyDownHandler=function(t){switch(t.which){case 27:k.headerAction(k.chart).then(function(){k.tabIndex=0;k.isFocused=true});$.text(r.get("Accessibility.Object.CloseFullScreenMode"))}};this.keyDownHandler=function(t){switch(t.which){case I.RIGHT_KEY:case I.LEFT_KEY:case I.UP_KEY:case I.DOWN_KEY:this.contextMenuStatus.open&&D.close();if(0===k.tabIndex){t.stopPropagation();t.preventDefault();this.interactive||I.key(t,"CaoInsight")}break;case 9:if(!k.caoTweakEnabled){t.shiftKey&&D.close();k.onInsightBlur();k.isFocused=!k.isFocused}break;case 13:case 32:D.close();t.stopImmediatePropagation();t.stopPropagation();t.preventDefault();if(!k.chart.isObjectInvalid()&&!k.isHidden()){if(t.shiftKey){k.isFocused=false;k.headerAction(k.chart).then(function(){k.tabIndex=0;k.isFocused=true});$.text(r.get("Accessibility.Object.FullScreenMode"))}else if(k.viewDataSupported()&&k.interactive)k.chart.toggleDataView().then(function(){k.chart.isViewDataToggled()&&$.text(r.get("Accessibility.Object.ViewDataMode"))});else if(k.chart.isViewDataToggled()&&"function"===typeof this.chart.getObject().dataViewObject.focus){k.isFocused=false;this.chart.getObject().dataViewObject.focus()}else if("function"===typeof this.chart.getObject().focus){k.isFocused=false;this.chart.getObject().focus()}else $.text(r.get("Accessibility.Object.CannotViewData"));$.text("")}break;case 27:if(this.contextMenuStatus.open)D.close();else if(this.chart.isViewDataToggled())this.chart.toggleDataView().then(function(){k.chart.isViewDataToggled()||$.text(r.get("Accessibility.Object.ViewChartMode"))});else if(this.interactive){k.headerAction(k.chart).then(function(){k.tabIndex=0;k.isFocused=true});$.text(r.get("Accessibility.Object.CloseFullScreenMode"))}k.isFocused=true;break;case 121:if(t.shiftKey&&!this.contextMenuStatus.open){var n=C.offset();t.pageY=n.top+C.height()/2;t.pageX=n.left+C.width()/2;e.$broadcast("cao.openContextMenu",{event:t,closeFn:function t(){k.isFocused=true},element:C.find(".result-item-graph-container")})}break}};this.onBlur=function(){this.isFocused=false;this.onInsightBlur()};this.$onInit=function(){if(this.interactive){this.tabIndex=0;this.isFocused=true}this.initializeState();this.setRowAndColumn();if(this.interactive)this.tabIndex=0;else{E=I.addItem(this.id,e.accCallback,"CaoInsight",this.col,this.row);this.tabIndex=E?0:-1}d.on("end",this.onResize)};this.$onChanges=function(){this.permissions&&(this.enableShare=this.permissions.exportData)};this.$doCheck=function(){k.caoTweakEnabled&&(k.isSelected()?k.chart.setChartInteractionState(g.STATIC):k.chart.setChartInteractionState(g.ANALYSIS))};this.$onDestroy=function(){k.interactive||I.removeItem("CaoInsight",k.id);t(".qv-cao-scroll-content").unbind("scroll",k.closePopups);d.off("end",this.onResize);f.unsubscribe("cao/insights/adapt_chart");k.shouldFadeToastTimer&&w.cancel(k.shouldFadeToastTimer)};this.isSelected=function(){var t=P.getSelectedChart();return t&&k.chart&&k.chart===t};this.onChartLoaded=function(){this.chartLoaded=true;if(k.caoTweakEnabled){k.chart.activateSelectionWatch(function(){k.chart.isInSelectionState=true});k.chart.deactivateSelectionWatch(function(){k.chart.isInSelectionState=false})}};this.initializeState=function(){t(".qv-cao-scroll-content").bind("scroll",k.closePopups);this.chartLoaded="LOADED"===this.chart.getState();this.chart.refreshChartType();this.matchDetails=this.chart.getMatchDetails()};this.chartClick=function(){!k.chartLoaded||k.headerActionInProgress||k.interactive||k.contextMenuStatus.open||k.isHidden()||k.caoTweakEnabled?k.closePopups():k.headerAction(k.chart)};this.editInsightProperties=function(e){if(e){e.preventDefault();e.stopPropagation();k.caoTweakEnabled&&w(function(){t("button.cao-edit-field-header-title.lui-button").first().focus()})}if(this.caoTweakEnabled&&this.chartLoaded&&!this.headerActionInProgress){k.closePopups();if(this.isSelected()){P.clearSelection();v.storageObj(k.app.id).contextPanel||f.publish("cao/insight/contextPanelToggled",false);f.publish("cao/insight/editInsightProperties",false)}else{k.isCaoContextPanelVisible||f.publish("cao/insight/contextPanelToggled",true);f.publish("cao/insight/editInsightProperties",true);P.selectChart(k.chart)}}};this.sendUserFeedback=function(){k.chart.setModified(false);k.feedbackInProgress=true;k.isHidden()||u.trackEvent(u.customEvents.INSIGHTS_HIDE_CHART_CLICKED,{chart:k.chart.getAnalysisPrecedentId()});k.sendFeedback({chart:k.chart,type:h.Precedents.PrecedentTypes.Dislike}).then(function(){k.interactive&&k.headerAction(k.chart)}).finally(function(){k.feedbackInProgress=false})};this.adaptChart=function(t){if(k.chart===t){k.chart.getTitle().then(function(t){k.dataMode&&(k.dataMode=false);k.title=t});k.shouldFadeToast=false;k.shouldFadeToastTimer=w(function(){k.shouldFadeToast=true},5e3)}};f.subscribe("cao/insights/adapt_chart",k.adaptChart);this.refreshAndLearn=function(){k.feedbackInProgress=true;k.sendFeedback({chart:k.chart,type:h.Precedents.PrecedentTypes.Like}).then(function(){k.interactive&&k.headerAction(k.chart)}).finally(function(){u.trackEvent(u.customEvents.INSIGHTS_LEARN_CLICKED);k.feedbackInProgress=false;k.chart.setModified(false)})};this.isHidden=function(){return k.chart.isHidden()};this.getFeedbackText=function(){return k.chart.isHidden()?"cao.card.unhide":"cao.card.hide"};this.addChartToSheet=function(t){k.isChartAdded=true;k.chart.addToSheet(t).then(function(t){O(t)})};this.addToNewSheet=function(){k.chart.addToNewSheet().then(function(t){O(t)})};this.exportToPdf=function(){k.setFocusOnInsight(false);u.trackEvent(u.customEvents.INSIGHTS_EXPORT,{type:"PDF",chart:k.chart.getAnalysisPrecedentId()});var t=s.showForObject(k.chart.getObject(),"Pdf","object",640,480);t.closed.then(function(){k.setFocusOnInsight(true)});k.closePopups()};this.exportToImage=function(){k.setFocusOnInsight(false);u.trackEvent(u.customEvents.INSIGHTS_EXPORT,{type:"IMAGE",chart:k.chart.getAnalysisPrecedentId()});var t=s.showForObject(k.chart.getObject(),"Image","object",640,480);t.closed.then(function(){k.setFocusOnInsight(true)});k.closePopups()};this.exportData=function(){k.setFocusOnInsight(false);u.trackEvent(u.customEvents.INSIGHTS_EXPORT,{type:"DATA",chart:k.chart.getAnalysisPrecedentId()});var t=M.show(k.chart.getModel());t.closed.then(function(){k.setFocusOnInsight(true)});k.closePopups()};this.navigateToSheet=function(t){k.closePopups();m.toggleCao();i.goToSheet(t,Object.keys(a.States)[a.state])};this.gotoSheet=function(){if(1===k.chart.getSheetsThisChartAppearsOn().length)k.navigateToSheet(k.chart.getSheetsThisChartAppearsOn()[0]);else{var t=["$scope",function(t){t.appearsOnSheets=k.chart.getSheetsThisChartAppearsOn();t.getSheetName=k.getSheetName;t.gotoSheet=k.navigateToSheet}];N(q,t,C.find(".gotoSheet")[0],"top")}};this.confidenceClosed=function(){k.headerActionInProgress=false};this.confidenceOpened=function(){k.headerActionInProgress=true};this.closeConfidenceRegistration=function(t){F=t};this.closePopups=n.throttle(function(){F&&F();_.forEach(function(t,e){w(function(){t.close();_.splice(e,1)})});k.headerActionInProgress=false},200,{trailing:false});this.openAddPopover=function(){var t=["$scope",function(t){t.sheets=k.sheets;t.addChartToSheet=k.addChartToSheet;t.addToNewSheet=k.addToNewSheet;t.permissions=k.permissions}];N(b,t,C.find(".add-to-button")[0],"bottom")};this.openDebugInformation=function(){var t=["$scope",function(t){t.debugInformation=k.chart.getSearchReport();t.visualization=k.chart.chart.visualization;t.complexity=k.chart.chart.complexity}];N(y,t,C.find(".debug-information")[0],"bottom")};this.openShare=function(){if(k.popupOpen)k.popupOpen=false;else{k.popupOpen=true;var t=["$scope",function(t){if(!k.chart.isViewDataToggled()&&k.chart.getObject().supportExport()){t.exportToPdf=k.exportToPdf;t.exportToImage=k.exportToImage}k.chart.getObject().supportExportData()&&(t.exportData=k.exportData)}];N(S,t,C.find(".share")[0],"bottom")}};this.openInfo=function(){var t=function t(){w(function(){k.isFocused=true})};w(function(){k.isFocused=false});var e=["$scope",function(t){t.type=k.chart.chart.visualization.type;t.title=k.chart.isGenerated()?"cao.search.info.title.generated":"cao.search.info.title.found";t.matches=[];k.matchDetails&&k.matchDetails.forEach(function(e){var n="";var i="";if(k.chart.isGenerated()){switch(e.matchedOn){case"exactMatch":n=r.get("cao.search.generated.exactMatch");break;case"literalMatch":n=r.get("cao.search.generated.literalMatch");break;case"headMatch":n=r.get("cao.search.generated.headMatch");break;case"headSynonymMatch":n=r.get("cao.search.generated.headSynonymMatch");break;case"headStemMatch":n=r.get("cao.search.generated.headStemMatch");break;case"headStemSynonymMatch":n=r.get("cao.search.generated.headStemSynonymMatch");break;case"partialTokenMatch":n=r.get("cao.search.generated.partialTokenMatch");break;case"substrPartialMatch":n=r.get("cao.search.generated.substrPartialMatch");break;case"semanticMatch":n=r.get("cao.search.generated.semanticMatch");break;case"valueMatch":n=r.get("cao.search.generated.valueMatch");break;default:break}n=n.replace(/\{1\}/g,function(t){return"<b>"+t+"</b>"});i=r.get(n,[k.chart.getSearchReport().search.searchPhrase.text,e.matchedField]);t.matches.push(i)}else if(k.chart.isFound()){switch(e.matchedField){case"titleMatch":n=r.get("cao.search.titleMatch");break;case"subTitleMatch":n=r.get("cao.search.subTitleMatch");break;case"footnoteMatch":n=r.get("cao.search.footnoteMatch");break;case"basedOnMatch":n=r.get("cao.search.basedOnMatch");break;default:break}n=n.replace(/\{1\}/g,function(t){return"<b>"+t+"</b>"});i=r.get(n,[k.chart.getSearchReport().search.searchPhrase.text,e.matchedOn]);t.matches.push(i)}});t.formattedSheetLinks=[];var e=r.get("cao.search.info.found.match");e=e.replace(/\{0\}/g,function(t){return"<b>"+t+"</b>"});k.chart.getSheetsThisChartAppearsOn().forEach(function(n){var i=k.getSheetName(n);var a=r.get(e,[i]);t.formattedSheetLinks.push({label:a,sheetId:n})});t.gotoSheet=k.navigateToSheet}];N(x,e,C.find(".info")[0],"bottom",t)};this.getSheetName=function(t){var e=k.sheets.filter(function(e){return e.qInfo.qId===t})[0];if(e)return e.qMeta.title};function N(t,e,n,i,a){var s={template:t,controller:e,dock:i,closeOnResize:true,alignTo:n};var r=T.show(s);_.push(r);r.closed.then(function(){k.headerActionInProgress=false;k.popupOpen=false;"function"===typeof a&&a()});k.headerActionInProgress=true}function O(t){m.scrapeApp();u.trackEvent(u.customEvents.INSIGHTS_ADD_CHART,{chart:k.chart.getAnalysisPrecedentId()});k.closePopups();w(function(){C.find(".result-item-buttons").addClass("animate")});w(function(){k.addedToSheet=true;k.chart.getSheetsThisChartAppearsOn().indexOf(t.id)>-1&&(k.isCopyMenuItemSelected?k.addOrCopySuccessText="cao.insight.copiedToSheet":k.addOrCopySuccessText="cao.search.addedToSheet");p.resizeCharts(A);w(function(){C.find(".result-item-added").addClass("animate")})},500);w(function(){C.find(".goto-sheet").addClass("animate")},2500);w(function(){k.addedToSheet=false;C.find(".goto-sheet").removeClass("animate");C.find(".result-item-added").removeClass("animate");C.find(".result-item-buttons").removeClass("animate")},4e3)}this.flipToTable=function(){var t=k.chart.isDataViewSupported()&&k.interactive;if(t){u.trackEvent(u.customEvents.INSIGHTS_FLIP_TO_TABLE);k.chart.toggleDataView();k.dataMode=!k.dataMode}};this.viewDataSupported=function(){return k.chart.isDataViewSupported()};e.$watch(function(){return t(".qv-contextmenu").length},function(){if(0===t(".qv-contextmenu").length)w(function(){k.chart.setChartInteraction(true);k.contextMenuStatus={open:0!==t(".qv-contextmenu").length}},300);else{k.chart.setChartInteraction(false);k.contextMenuStatus={open:true}}});e.$watch(function(){return k.chart.shouldRedraw},function(){k.chart.getTitle().then(function(t){k.dataMode&&(k.dataMode=false);k.title=t})})}];var C={transclude:true,template:m,bindings:{chart:"<",app:"<",headerAction:"<",headerIcon:"@",interactive:"<",direction:"<",sheets:"<",alwaysShowHeader:"<",scrollContainer:"<",debug:"<",permissions:"<",index:"<",gridScreenReader:"=",onInsightBlur:"&",onInsightFocus:"&",sendFeedback:"&",isCaoContextPanelVisible:"<"},controller:I};return e.nativeComponent("qvCaoInsight",C)}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="cao-insight">\n\t<div class="cao-insight-in-selection-overlay" ng-if="$ctrl.chart.isInSelectionState && $ctrl.caoTweakEnabled"></div>\n\t<div class="cao-insight-container" ng-class="{\'zoom\': $ctrl.interactive, \'hidden\': $ctrl.isHidden(), \'generated\': $ctrl.chart.isGenerated(), \'lightedit\': $ctrl.lightEditing && !$ctrl.caoTweakEnabled, \'selected\': $ctrl.isSelected()}" tabindex="{{$ctrl.tabIndex}}"\n\t\tng-keydown="$ctrl.keyDownHandler($event)" focus-when="$ctrl.isFocused" ng-focus="$ctrl.onInsightFocus()" dir="{{$ctrl.direction}}" test-chart-loaded="{{$ctrl.chartLoaded}}">\n\t\t<div class="hidden-screen-reader-label" aria-label="{{$ctrl.gridScreenReader}}"></div>\n\t\t<label class="hidden-screen-reader-label" id="sr-cell-status-label" aria-live="assertive"></label>\n\t\t<div class="result-item-title-bar" dir="{{$ctrl.direction}}" ng-class="{ \'interactive\': $ctrl.interactive}">\n\t\t\t<div class="result-item-title" title="{{ $ctrl.title }}" qva-direction x-dir-setting="{{$ctrl.direction}}" x-dir-text="{{$ctrl.title}}" ng-click="$ctrl.editInsightProperties($event)" tid="insight-chart-edit-button">\n\t\t\t\t<span>{{ $ctrl.title }}</span>\n\t\t\t</div>\n\t\t\t<div class="result-item-title-icons" ng-class="{ \'active\': $ctrl.headerActionInProgress || $ctrl.interactive || $ctrl.isSelected() }" q-title-translation="cao.resultitem.info">\n\t\t\t\t<button ng-click="$ctrl.openInfo()" ng-keyup="$event.keyCode == 13 ? $ctrl.openInfo() : null" class="insight-chart-info-button result-item-title-icon" ng-show="!$ctrl.insightLearning && $ctrl.chartLoaded && !$ctrl.isHidden()">\n\t\t\t\t\t<span class="info lui-icon lui-icon--info"></span>\n\t\t\t\t</button>\n\t\t\t\t<button ng-if="$ctrl.caoTweakEnabled && !$ctrl.isSelected() && $ctrl.chart.isGenerated()" class="result-item-title-icon" ng-click="$ctrl.editInsightProperties($event)" ng-keyup="$event.keyCode == 13 ? $ctrl.editInsightProperties($event) : null"\n\t\t\t\t\tq-title-translation="cao.resultitem.editInsightProperties" tid="insight-chart-edit-properties-button" ng-show="$ctrl.chartLoaded && !$ctrl.isHidden()">\n\t\t\t\t\t<span class="lui-icon--edit lui-icon"></span>\n\t\t\t\t</button>\n\t\t\t\t<button ng-if="$ctrl.caoTweakEnabled && $ctrl.isSelected()" class="result-item-title-icon" ng-click="$ctrl.editInsightProperties($event)" ng-keyup="$event.keyCode == 13 ? $ctrl.editInsightProperties($event) : null" q-title-translation="cao.resultitem.finishEditInsightProperties"\n\t\t\t\t\ttid="insight-chart-finish-edit-properties-button" ng-show="$ctrl.chartLoaded">\n\t\t\t\t\t<span class="lui-icon--tick lui-icon result-item-title-icon-checkmark"></span>\n\t\t\t\t</button>\n\t\t\t\t<button ng-click="$ctrl.openShare()" ng-keyup="$event.keyCode == 13 ? $ctrl.openShare() : null" class="result-item-title-icon" ng-if="$ctrl.enableShare" q-title-translation="contextMenu.exportGroup" tid="insight-chart-export-button" ng-show="$ctrl.chartLoaded && !$ctrl.isHidden()">\n\t\t\t\t\t<span class="share lui-icon lui-icon--export"></span>\n\t\t\t\t</button>\n\t\t\t\t<button ng-click="$ctrl.openDebugInformation()" ng-keyup="$event.keyCode == 13 ? $ctrl.openDebugInformation() : null" class="result-item-title-icon" ng-if="$ctrl.debug">\n\t\t\t\t\t<span class="debug-information lui-icon lui-icon--cogwheel"></span>\n\t\t\t\t</button>\n\t\t\t\t<button tabindex="0" ng-if="!$ctrl.interactive" class="result-item-title-icon" ng-click="$ctrl.headerAction($ctrl.chart)" ng-keyup="$event.keyCode == 13 ? $ctrl.headerAction($ctrl.chart) : null" q-title-translation="cao.resultitem.expand" tid="insight-chart-expand-button"\n\t\t\t\t\tng-show="$ctrl.chartLoaded && !$ctrl.isHidden()">\n\t\t\t\t\t<span class="qv-cao-item-expand-icon lui-icon" ng-class="$ctrl.headerIcon"></span>\n\t\t\t\t</button>\n\t\t\t\t<button ng-if="$ctrl.interactive" class="result-item-title-icon" ng-click="$ctrl.headerAction($ctrl.chart)" ng-keyup="$event.keyCode == 13 ? $ctrl.headerAction($ctrl.chart) : null" q-title-translation="cao.resultitem.collapse" tid="zoomed-chart-shrink-button">\n\t\t\t\t\t<span class="lui-icon--remove lui-icon"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="chart-container">\n\t\t\t<div class="insight">\n\t\t\t\t<qv-cao-insight-chart set-blur-handler="$ctrl.setChartBlurHandler()" get-chart-menu-items="$ctrl.getChartMenuItems(menu)" ng-click="$ctrl.chartClick(id)" class="result-item-graph" chart="$ctrl.chart" app="::$ctrl.app" on-chart-loaded="$ctrl.onChartLoaded()"\n\t\t\t\t\tinteractive="$ctrl.interactive" scroll-container="$ctrl.scrollContainer" object="$ctrl.object" ng-class="{\'clickable\': !$ctrl.contextMenuStatus.open}" context-menu-status="$ctrl.contextMenuStatus" index="$ctrl.index" />\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="result-item-footer" dir="{{$ctrl.direction}}">\n\t\t\t<div ng-if="$ctrl.chart.isGenerated()" aria-hidden="true" class="result-item-buttons" ng-show="!$ctrl.addedToSheet">\n\t\t\t\t<div class="footer-left" ng-if="!$ctrl.interactive">\n\t\t\t\t\t<cao-confidence ng-if="!$ctrl.caoTweakEnabled" class="result-item-title-icon" data-chart="$ctrl.chart" button-id="confidence_{{$parent.$parent.$parent.$parent.$index}}" ng-show="$ctrl.insightLearning" close-notification="$ctrl.closeConfidenceRegistration(handler)"\n\t\t\t\t\t\topened="$ctrl.confidenceOpened()" closed="$ctrl.confidenceClosed()" hide-text="$ctrl.hideConfidenceText"></cao-confidence>\n\t\t\t\t\t<span class="title generated-insight-title" ng-show="!$ctrl.insightLearning" q-translation="cao.search.card.generated" aria-label="{{$ctrl.generatedChartScreenReaderLabel}}"></span>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="footer-right">\n\t\t\t\t\t<div class="feedback-button-container" ng-if="$ctrl.insightFeedback && !$ctrl.caoTweakEnabled" qva-direction x-dir-setting="{{$ctrl.direction}}">\n\t\t\t\t\t\t<lui-button tid="insight-feedback-button" ng-click="$ctrl.sendUserFeedback()" ng-disabled="!$ctrl.chartLoaded || $ctrl.feedbackInProgress" tabindex="-1" q-translation="{{$ctrl.getFeedbackText()}}"\n\t\t\t\t\t\t\tng-class="{\'btn-state-unhide\': $ctrl.chart.isHidden(), \'btn-state-hide\': !$ctrl.chart.isHidden()}">\n\t\t\t\t\t\t</lui-button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="lui-buttongroup" tid="cao-add-to-sheet-button" ng-if="$ctrl.activeSheet.layout.permissions.update && $ctrl.permissions.createSheet">\n\t\t\t\t\t\t<lui-button ng-click="$ctrl.addChartToSheet()" tabindex="-1" ng-disabled="!$ctrl.chartLoaded || $ctrl.isChartAdded" q-translation="cao.search.addToSheet">\n\t\t\t\t\t\t</lui-button>\n\t\t\t\t\t\t<lui-button class="add-to-button" tabindex="-1" q-title-translation="cao.search.addToSheetOptions" ng-disabled="!$ctrl.chartLoaded" ng-click="$ctrl.openAddPopover()">\n\t\t\t\t\t\t\t<span class="lui-overlay-button__caret lui-caret"></span>\n\t\t\t\t\t\t</lui-button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="lui-buttongroup" ng-if="!$ctrl.activeSheet.layout.permissions.update && $ctrl.permissions.createSheet">\n\t\t\t\t\t\t<lui-button class="add-to-button" tabindex="-1" q-title-translation="cao.search.addToSheetOptions" ng-disabled="!$ctrl.chartLoaded" ng-click="$ctrl.openAddPopover()">\n\t\t\t\t\t\t\t<span q-translation="cao.search.addToSheet"></span>\n\t\t\t\t\t\t\t<span class="lui-overlay-button__caret lui-caret"></span>\n\t\t\t\t\t\t</lui-button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div ng-if="$ctrl.chart.isFound()" ng-class="{ \'itemAdded\': $ctrl.addedToSheet }" class="result-item-added result-item-buttons">\n\t\t\t\t<span>\n\t\t\t\t\t<div class="goto-sheet" ng-show="$ctrl.addedToSheet">\n\t\t\t\t\t\t<span class="tick-highlight" qva-direction x-dir-setting="{{$ctrl.direction}}">\n\t\t\t\t\t\t\t<span class="lui-icon lui-icon--tick"></span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span q-translation="{{$ctrl.addOrCopySuccessText}}"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</span>\n\t\t\t\t<a ng-click="$ctrl.gotoSheet($ctrl.chart.getSheetsThisChartAppearsOn()[0])" q-title-translation="Storytelling.Sheet.GoToSheet">\n\t\t\t\t\t<span ng-if="$ctrl.chart.getSheetsThisChartAppearsOn().length === 1" x-dir-text="{{ $ctrl.getSheetName($ctrl.chart.getSheetsThisChartAppearsOn()[0]) }}" qva-direction x-dir-setting="{{$ctrl.direction}}">\n\t\t\t\t\t\t{{ $ctrl.getSheetName($ctrl.chart.getSheetsThisChartAppearsOn()[0]) }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span ng-if="$ctrl.chart.getSheetsThisChartAppearsOn().length > 1" q-translation="cao.search.multipleSources">\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class="gotoSheet lui-icon lui-icon--goto" qva-direction x-dir-setting="{{$ctrl.direction}}"></span>\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="editor cao-chart-light-editing" ng-if="$ctrl.lightEditing && $ctrl.interactive && $ctrl.chart.isGenerated() && !$ctrl.caoTweakEnabled" ng-keydown="$ctrl.editorKeyDownHandler($event)">\n\t\t\x3c!-- TODO: move to directive --\x3e\n\t\t<div class=\'qv-panel-properties\' style="overflow: auto;">\n\t\t\t<qv-cao-insight-editor chart="$ctrl.chart" app="$ctrl.app" />\n\t\t</div>\n\t</div>\n\t<div class="cao-chart-refresh-indicator-container" ng-class="{\'visible\': $ctrl.insightLearning && $ctrl.chart.isModified() && !$ctrl.interactive && !$ctrl.shouldFadeToast, \'fade\': $ctrl.shouldFadeToast}" ng-if="$ctrl.insightLearning && $ctrl.chart.isModified() && !$ctrl.interactive" ng-click="$ctrl.adaptChart($ctrl.chart)">\n\t\t<div class="cao-chart-refresh-indicator-content">\n\t\t\t<div class="cao-chart-refresh-top">\n\t\t\t\t<span class="lui-icon lui-icon--close" ng-click="$ctrl.chart.setModified(false)"></span>\n\t\t\t</div>\n\t\t\t<div class="cao-chart-text" ng-class="{\'cao-chart-text-no-refresh\': $ctrl.caoTweakEnabled}">\n\t\t\t\t<div q-translation="cao.insight.inlinerefresh.indicator.body.lineone" />\n\t\t\t\t<div q-translation="cao.insight.inlinerefresh.indicator.body.linetwo" />\n\t\t\t</div>\n\t\t\t<div class="cao-chart-refresh-indicator-action-container">\n\t\t\t\t<div class="cao-chart-refresh-action">\n\t\t\t\t\t<a class="cao-chart-refresh" ng-click="$ctrl.refreshAndLearn()" q-translation="cao.insight.inlinerefresh.indicator.action" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'},function(t,e){t.exports='<lui-popover class="cao-add-popover">\n\t<div class="lui-popover__body lui-nopad popover-body">\n\t\t<ul class="lui-list">\n\t\t\t<li class="lui-list__item lui-list__action" ng-click="addChartToSheet(sheet.qInfo.qId)" ng-repeat="sheet in sheets"\n\t\t\t ng-if="sheet.permissions.update">\n\t\t\t\t<span class="lui-list__aside lui-icon lui-icon--sheet"></span>\n\t\t\t\t<span class="lui-list__text">{{ sheet.qMeta.title }}</span>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item lui-list__action" ng-click="addToNewSheet()">\n\t\t\t\t<span class="lui-list__aside lui-icon lui-icon--plus"></span>\n\t\t\t\t<span class="lui-list__text" q-translation="cao.search.add.createNewSheet"></span>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</lui-popover>'},function(t,e){t.exports='<lui-popover class="cao-debug-popover">\n\t<lui-popover-body>\n\t\t<div>\n\t\t\t<b>Debug Information</b>\n\t\t\t<pre>{{ debugInformation | json : spacing }}</pre>\n\t\t\t<b ng-if="visualization.type === \'generated\'">Visualization</b>\n\t\t\t<pre ng-if="visualization.type === \'generated\'">{{ visualization | json : spacing }}</pre>\n\t\t\t<b ng-if="visualization.type === \'generated\'">Complexity</b>\n\t\t\t<pre ng-if="visualization.type === \'generated\'">Estimate: {{ complexity }}</pre>\n\n\t\t\t<b ng-if="visualization.type === \'found\'">Chart</b>\n\t\t\t<pre ng-if="visualization.type === \'found\'">\n{\n  chartId: {{ visualization.chartId }},\n  appearsOnSheets: {{ visualization.appearsOnSheets | json : spacing }}}\n\t\t\t</pre>\n\t\t</div>\n\t</lui-popover-body>\n</lui-popover>\n'},function(t,e){t.exports='<lui-popover class="cao-share-popover">\n\t<div class="lui-popover__body lui-nopad popover-body">\n\t\t<ul class="lui-list">\n\t\t\t<li class="lui-list__item lui-list__action" ng-if="exportToImage" ng-click="exportToImage()" tid="share-popover-export-image">\n\t\t\t\t<a class="lui-list__text" q-translation="contextMenu.export.chart.image"></a>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item lui-list__action" ng-if="exportToPdf" ng-click="exportToPdf()" tid="share-popover-export-pdf">\n\t\t\t\t<a class="lui-list__text" q-translation="contextMenu.export.chart.pdf"></a>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item lui-list__action" ng-if="exportData" ng-click="exportData()" tid="share-popover-export-data">\n\t\t\t\t<a class="lui-list__text" q-translation="contextMenu.export"></a>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</lui-popover>'},function(t,e){t.exports='<lui-popover class="cao-info-popover">\n    <lui-popover-body>\n        <div>\n            <ul>\n                <li class="cao-popover-title" q-translation="{{ title }}"></li>\n                <li ng-repeat="match in matches" ng-bind-html="match"></li>\n                <li ng-if="matches.length === 0 && type === \'generated\'" q-translation="cao.search.info.body.generated"></li>\n                <li ng-repeat="sheet in formattedSheetLinks">\n                    <a class="gotoSheet" ng-click="gotoSheet(sheet.sheetId)">\n                        <span ng-bind-html="sheet.label"></span>\n                        &nbsp; <span class="lui-icon lui-icon--goto"></span>\n                    </a>\n                </li>\n            </ul>\n        </div>\n    </lui-popover-body>\n</lui-popover>\n'},function(t,e){t.exports='<lui-popover class="cao-goto-sheet-popover">\n    <div class="lui-popover__body lui-nopad popover-body">\n        <ul class="lui-list">\n            <li class="lui-list__item lui-list__action" ng-repeat="sheet in appearsOnSheets track by $index" ng-click="gotoSheet(sheet)">\n                <span class="lui-list__aside lui-icon lui-icon--goto"></span>\n                <span class="lui-list__text">{{ getSheetName(sheet) }}</span>\n            </li>\n        </ul>\n    </div>\n</lui-popover>'},function(t,e,n){"use strict";var i,a;!(i=[n(48)],a=function(t){var e={restrict:"A",scope:{focusWhen:"="},controller:["$scope","$element",function(t,e){t.$watch("focusWhen",function(t){t?e.focus():false===t&&e.blur()})}]};t.directive("focusWhen",function(){return e})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(91),n(103),n(49),n(196),n(187),n(178),n(921),n(922),n(923),n(924),n(925),n(926),n(927),n(930),n(218),n(932),n(221)],a=function(t,e,n,i,a,s,r,o,l,c,u,d){var p=["qvCaoSearchService","qvCaoService","qvCaoChartService","qvAppDetailsService","luiPopover",function(t,l,p,h,f){var g=this;var v=[];var m;this.insightLearning=a.getFlag("CE_PRECEDENTS");this.caoTweakEnabled=a.getFlag("CAO_TWEAK");this.$onInit=function(){h.get().then(function(t){m=t.model.app.published||!t.model.permissions.update});e.subscribe(s.PUBSUB_TOPIC,x)};this.$onDestroy=function(){e.unsubscribe(s.PUBSUB_TOPIC)};function b(t){g.chart.setModified(g.chart.isModified()||!t&&g.chart.getMatches().filter(function(t){return t.isDirty}).length>0);g.chart.adaptChart(g.chart.isModified()).then(function(){y()});e.publish("cao/insights/adapt_chart",g.chart)}function y(){v.forEach(function(t,e){t.popup.close();v.splice(e,1)})}function S(t){v.forEach(function(e,n){t===e.id&&v.splice(n,1)})}function x(t){var e=g.chart.getMatches();var n=t.slotA;var a=t.slotB;var s,r;e.forEach(function(t,e){t.slot===n?s=e:t.slot===a&&(r=e)});var o=e[r];e[r]=e[s];e[s]=o;e[r].slot=a;e[s].slot=n;i.trackEvent(i.customEvents.INSIGHTS_LIGHT_EDITING_DRAG_AND_DROP,{chart:g.chart.getAnalysisPrecedentId()});b(true)}this.toggleMatchDetails=function(t){t.expanded=!t.expanded};this.getFields=function(){return g.chart.getMatches().filter(function(t){return!t.slotRole})};this.getMeasures=function(){return g.chart.getMatches().filter(function(t){return t.slotRole===s.MEASURE})};this.getDimensions=function(){return g.chart.getMatches().filter(function(t){return t.slotRole===s.DIMENSION})};this.getDimensionCount=function(){return g.getDimensions().length};this.getMeasureCount=function(){return g.getMeasures().length};this.getFieldCount=function(){return g.getFields().length};this.hasMeasures=function(){return g.chart.getMatches().filter(function(t){return t.slotRole===s.MEASURE}).length>0};this.hasDimensions=function(){return g.chart.getMatches().filter(function(t){return t.slotRole===s.DIMENSION}).length>0};this.applyLearning=function(){p.refreshInsights().then(function(t){var n=t.recommendations.filter(function(t){return t.chart.visualization.visualization.analysis.analysis===g.chart.chart.visualization.visualization.analysis.analysis})[0];if(n){g.chart.chart.visualization=n.chart.visualization;delete g.chart.rendered;g.chart.shouldRedraw=true;g.chart.recalculateConfidence=true}else g.chart.invalidFromLearning=true;l.setRefreshIndicatorVisibility(true);e.publish("cao/insight/learning_applied")})};this.changeAggr=function(t,e){g.chart.getMatches().forEach(function(n){if(n.slot===t.slot){n.isDirty=true;n.aggr=e}});i.trackEvent(i.customEvents.INSIGHTS_LIGHT_EDITING_AGGREGATION_CHANGE,{chart:g.chart.getAnalysisPrecedentId()});b()};this.changeField=function(t,e){g.lastAggr=t.aggr||g.lastAggr;g.chart.getMatches().forEach(function(n){if(n.slot===t.slot){n.isDirty=true;g.caoTweakEnabled&&g.toggleMatchDetails(n);if(e.libId){n.libId=e.libId;n.libIdLabel=e.libIdLabel;delete n.field;delete n.aggr}else{n.field=e.name;n.slotRole!==s.MEASURE||n.aggr||(n.aggr=g.lastAggr);delete n.libId;delete n.libIdLabel}}});i.trackEvent(i.customEvents.INSIGHTS_LIGHT_EDITING_FIELD_CHANGE,{chart:g.chart.getAnalysisPrecedentId()});b()};this.showChangeAggr=function(t,e){var n=["$scope",function(t){t.field=e;t.change=g.changeAggr;t.wrappedAggregations=r.COMMON_FUNCTIONS.map(function(t){return{text:o.getFormattedAggregation(t),action:function n(){g.changeAggr(e,o.getFormattedAggregation(t))}}})}];q(c,n,t.currentTarget,"bottom","cao-changeAggregation_"+e.slot)};this.canChangeAggregation=function(t){if(!t.restrictions)return true;var e=t.restrictions.filter(function(t){return"aggregation"===t.name})[0];return!e};this.showChangeField=function(e,n,i){var a=["$scope",function(e){var a=[];var r=[];var o=[];var l=n.restrictions?n.restrictions.filter(function(t){return"candidates"==t.name})[0]:void 0;function c(t){if(!l)return true;return l.types.indexOf(t)>-1}function u(t){a=c("eField")?t.filter(function(t){return!t.masterItem}):[];r=c("eDimLib")?t.filter(function(t){return t.masterItem&&t.classifications.filter(function(t){return t===s.DIMENSION}).length>0}):[];o=c("eMsrLib")?t.filter(function(t){return t.masterItem&&t.classifications.filter(function(t){return t===s.MEASURE}).length>0}):[];e.field=n;e.fields=a;if(i===s.DIMENSION){e.dimensions=r;e.measures=[]}else if(i===s.MEASURE){e.measures=o;e.dimensions=[]}else{e.dimensions=r;e.measures=o}}function d(n){var i=t.getMatchingFields(n,m);e.highlight=n;u(i)}var p=t.getMatchingFields(void 0,m);u(p);e.change=g.changeField;e.filterFields=d}];q(u,a,e.currentTarget,"bottom","cao-changeField_"+n.slot);g.caoTweakEnabled&&g.toggleMatchDetails(n)};this.showAnalysisInfo=function(t){var e=["$scope",function(t){var e=g.chart.chart.visualization.visualization.analysis.analysis;var i=n.get("cao.insight.analysis."+e);t.analysisTitle=n.get("cao.insight.analysis.popover.title",[i]);t.analysisDescription=n.get("cao.insight.analysis."+e+".description")}];q(d,e,t.currentTarget,"left","cao_analysisPopover")};function q(t,e,n,i,a){if(v.filter(function(t){return t.id===a})[0]){y();return}y();var s={template:t,controller:e,dock:i,alignTo:n,closeOnResize:true,outsideIgnore:a};var r=f.show(s);r.closing.then(function(){S(a)});r.closed.then(function(){n.focus()});v.push({id:a,popup:r})}}];var h={transclude:true,template:l,bindings:{chart:"=",app:"="},controller:p};return t.nativeComponent("qvCaoInsightEditor",h)}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="title" q-translation="cao.card.title.editor.title" ng-if="!$ctrl.caoTweakEnabled" />\n<div class="cao-editor-field-list">\n    <div class="header">\n        <span q-translation="cao.editor.title" />\n        <a ng-click="$ctrl.showAnalysisInfo($event)" id="cao_analysisPopover" qva-outside-ignore-for="cao_analysisPopover">\n            <span class="lui-icon lui-icon--help" />\n        </a>\n    </div>\n    <div class="analysis-type">\n        <span tid="analyis-type-string" q-translation="{{\'cao.insight.analysis.\' + $ctrl.chart.getChartType()}}" />\n    </div>\n\n    \x3c!--- GENERIC FIELDS --\x3e\n    <div class="header" ng-if="!$ctrl.hasDimensions() && !$ctrl.hasMeasures()">\n        <span q-translation="cao.fieldPicker.tab.fields">\n    </div>\n    <div class="cao-edit-field qv-pp-sortable" qv-cao-field-drop-zone data-slot="{{match.slot}}" data-slot-role="{{match.slotRole}}"\n        ng-repeat="match in $ctrl.getFields()">\n        <div class="cao-edit-field-header" ng-class="{\'draggable\': $ctrl.fieldCount > 1}" qv-cao-field-draggable\n            data-slot="{{match.slot}}" data-slot-role="{{match.slotRole}}">\n            \x3c!-- Header title --\x3e\n            <button class="cao-edit-field-header-title lui-button" ng-click="$ctrl.showChangeField($event, match)" qva-outside-ignore-for="{{\'cao-changeField_\' + match.slot}}">\n                <span ng-if="match.field" ng-class="{\'cao-edit-field-span\' : $ctrl.caoTweakEnabled}">\n                    {{ match.field }}\n                </span>\n                <span ng-if="match.libIdLabel" ng-class="{\'cao-edit-field-span\' : $ctrl.caoTweakEnabled}">\n                    {{ match.libIdLabel }}\n\t\t\t\t</span>\n\t\t\t\t<div class="cao-field-caret-container" ng-if="$ctrl.insightLearning && $ctrl.caoTweakEnabled">\n\t\t\t\t\t<span class="lui-icon lui-button__icon cao-edit-expander-span" ng-class="{\'lui-icon--arrow-right\' : !match.expanded, \'lui-icon--arrow-down\': match.expanded}"></span>\n\t\t\t\t</div>\n            </button>\n            \x3c!-- Header icons --\x3e\n            <button class="lui-button cao-edit-expander" ng-if="!$ctrl.caoTweakEnabled" ng-show="$ctrl.insightLearning" ng-click="$ctrl.toggleMatchDetails( match )">\n                <span class="lui-icon lui-button__icon" ng-class="{\'lui-icon--arrow-right\' : !match.expanded, \'lui-icon--arrow-down\': match.expanded}"></span>\n            </button>\n            <i class="lui-icon lui-icon--draggable cao-edit-field-draggable cao-edit-sortable-handle" ng-if="$ctrl.getFieldCount() > 1"\n                q-title-translation="Common.Move"></i>\n        </div>\n\n        <qv-cao-field-details ng-if="$ctrl.insightLearning && !$ctrl.caoTweakEnabled" class="cao-edit-field-details" data-match="match"\n            data-apply-callback="$ctrl.applyLearning" field-id="details_field_{{$index}}" chart="$ctrl.chart" ng-show="match.expanded" />\n    </div>\n\n\n    \x3c!--- DIMENSIONS--\x3e\n    <div class="header" ng-if="$ctrl.hasDimensions()">\n        <span q-translation="cao.fieldPicker.tab.dimensions">\n    </div>\n    <div class="cao-edit-field qv-pp-sortable" qv-cao-field-drop-zone data-slot="{{match.slot}}" data-slot-role="{{match.slotRole}}"\n        ng-repeat="match in $ctrl.getDimensions()">\n        <div class="cao-edit-field-header" ng-class="{\'draggable\': $ctrl.dimensionCount > 1}" qv-cao-field-draggable\n            data-slot="{{match.slot}}" data-slot-role="{{match.slotRole}}">\n            \x3c!-- Header title --\x3e\n            <button class="cao-edit-field-header-title lui-button" ng-click="$ctrl.showChangeField($event, match, \'dimension\')" qva-outside-ignore-for="{{\'cao-changeField_\' + match.slot}}">\n                <span ng-if="match.field" ng-class="{\'cao-edit-field-span\' : $ctrl.caoTweakEnabled}">\n                    {{ match.field }}\n                </span>\n                <span ng-if="match.libIdLabel" ng-class="{\'cao-edit-field-span\' : $ctrl.caoTweakEnabled}">\n                    {{ match.libIdLabel }}\n\t\t\t\t</span>\n\t\t\t\t<div class="cao-field-caret-container" ng-if="$ctrl.insightLearning && $ctrl.caoTweakEnabled">\n\t\t\t\t\t<span class="lui-icon lui-button__icon cao-edit-expander-span" ng-class="{\'lui-icon--arrow-right\' : !match.expanded, \'lui-icon--arrow-down\': match.expanded}"></span>\n\t\t\t\t</div>\n            </button>\n            \x3c!-- Header icons --\x3e\n            <button class="lui-button cao-edit-expander" ng-if="!$ctrl.caoTweakEnabled" ng-show="$ctrl.insightLearning" ng-click="$ctrl.toggleMatchDetails( match )">\n                <span class="lui-icon lui-button__icon" ng-class="{\'lui-icon--arrow-right\' : !match.expanded, \'lui-icon--arrow-down\': match.expanded}"></span>\n            </button>\n            <i class="lui-icon lui-icon--draggable cao-edit-field-draggable cao-edit-sortable-handle" ng-if="$ctrl.getDimensionCount() > 1"\n                q-title-translation="Common.Move"></i>\n        </div>\n\n        <qv-cao-field-details ng-if="$ctrl.insightLearning && !$ctrl.caoTweakEnabled" class="cao-edit-field-details" data-match="match"\n            data-apply-callback="$ctrl.applyLearning" field-id="details_dimension_{{$index}}" chart="$ctrl.chart"\n            ng-show="match.expanded" />\n    </div>\n\n    \x3c!--- MEASURES --\x3e\n    <div class="header cao-msrs-header" ng-if="$ctrl.hasMeasures()">\n        <span q-translation="cao.fieldPicker.tab.measures">\n    </div>\n    <div class="cao-edit-field qv-pp-sortable" qv-cao-field-drop-zone data-slot="{{match.slot}}" data-slot-role="{{match.slotRole}}"\n        ng-repeat="match in $ctrl.chart.getMatches()" ng-if="match.slotRole === \'measure\'">\n        <div class="cao-edit-field-header" ng-class="{\'draggable\': $ctrl.measureCount > 1}" qv-cao-field-draggable\n            data-slot="{{match.slot}}" data-slot-role="{{match.slotRole}}">\n            \x3c!-- Change aggregation dropdown --\x3e\n            <button ng-if="match.aggr" class="lui-button cao-edit-field-header-aggregation" ng-click="$ctrl.showChangeAggr($event, match)"\n                ng-disabled="!$ctrl.canChangeAggregation( match )" qva-outside-ignore-for="{{\'cao-changeAggregation_\' + match.slot}}" >\n                {{ match.aggr.charAt(0).toUpperCase() + match.aggr.substring(1) }}\n            </button>\n            \x3c!-- Header content --\x3e\n\n            \x3c!-- Header title --\x3e\n            <button class="cao-edit-field-header-title lui-button" ng-click="$ctrl.showChangeField($event, match, \'measure\')" qva-outside-ignore-for="{{\'cao-changeField_\' + match.slot}}">\n                <span ng-if="match.field" ng-class="{\'cao-edit-field-span\' : $ctrl.caoTweakEnabled}">\n                    {{ match.field }}\n                </span>\n                <span ng-if="match.libIdLabel" ng-class="{\'cao-edit-field-span\' : $ctrl.caoTweakEnabled}">\n                    {{ match.libIdLabel }}\n\t\t\t\t</span>\n\t\t\t\t<div class="cao-field-caret-container" ng-if="$ctrl.insightLearning && $ctrl.caoTweakEnabled">\n\t\t\t\t\t<span class="lui-icon lui-button__icon cao-edit-expander-span" ng-class="{\'lui-icon--arrow-right\' : !match.expanded, \'lui-icon--arrow-down\': match.expanded}"></span>\n\t\t\t\t</div>\n            </button>\n            \x3c!-- Header icons --\x3e\n            <button class="lui-button cao-edit-expander" ng-if="!$ctrl.caoTweakEnabled" ng-show="$ctrl.insightLearning" ng-click="$ctrl.toggleMatchDetails( match )">\n                <span class="lui-icon lui-button__icon" ng-class="{\'lui-icon--arrow-right\' : !match.expanded, \'lui-icon--arrow-down\': match.expanded}"></span>\n            </button>\n            <i class="lui-icon lui-icon--draggable cao-edit-field-draggable cao-edit-sortable-handle" ng-if="$ctrl.getMeasureCount() > 1"\n                q-title-translation="Common.Move"></i>\n\n        </div>\n        <qv-cao-field-details ng-if="$ctrl.insightLearning && !$ctrl.caoTweakEnabled" class="cao-edit-field-details" data-match="match"\n            data-apply-callback="$ctrl.applyLearning" field-id="details_measure_{{$index}}" chart="$ctrl.chart" ng-show="match.expanded" />\n    </div>\n</div>'},function(t,e){t.exports='<lui-popover class="cao-change-aggr-popover cao-popover">\n    <div class="lui-popover__body lui-nopad popover-body">\n            <qv-action-list items="wrappedAggregations"></qv-action-list>\n    </div>\n</lui-popover>\n\n'},function(t,e){t.exports='<lui-popover class="cao-change-field-popover cao-popover">\n    <object-add-typeahead>\n        <lui-popover-header>\n            <div class="lui-input-group">\n                <input class="lui-input lui-input-group__input" type="text" autocomplete="off"\n                    ng-model="search.term" qva-focus="autoFocus" ng-change="filterFields(search.term)" maxlength="255"\n                    object-add-typeahead-input />\n            </div>\n        </lui-popover-header>\n        <div class="lui-popover__body lui-nopad popover-body" object-add-typeahead-menu>\n\n            <ul class="lui-list">\n                <div ng-if="dimensions.length > 0" class="object-add-popover-list-header" q-translation="Common.Dimensions"></div>\n\n                <li class="lui-list__item lui-list__action" ng-repeat="d in dimensions" on-select="change(field, d)"\n                    object-add-typeahead-item="d">\n                    <span class="lui-list__text" qve-highlight text="{{ d.libIdLabel }}" query="highlight"></span>\n                </li>\n\n                <div ng-if="measures.length > 0" class="object-add-popover-list-header" q-translation="Common.Measures"></div>\n\n                <li class="lui-list__item lui-list__action" ng-repeat="m in measures" on-select="change(field, m)"\n                    object-add-typeahead-item="m">\n                    <span class="lui-list__text" qve-highlight text="{{ m.libIdLabel }}" query="highlight"></span>\n                </li>\n\n                <div ng-if="fields.length > 0" class="object-add-popover-list-header" q-translation="Common.Fields"></div>\n\n                <li class="lui-list__item lui-list__action" ng-repeat="f in fields" on-select="change(field, f)"\n                    object-add-typeahead-item="f">\n                    <span class="lui-list__text" qve-highlight text="{{ f.displayNameTokens[0].text }}" query="highlight"></span>\n                </li>\n            </ul>\n            <div class="no-hits" ng-if="(fields.length === 0) && (measures.length === 0) && (dimensions.length == 0)">\n                <span><i q-translation="Toolbox.Search.Nohits" /></span>\n            </div>\n        </div>\n\n    </object-add-typeahead>\n</lui-popover>'},function(t,e){t.exports='<lui-popover class="cao-popover cao-analysis-info-popover">\n    <lui-popover-body>\n        <div class="popover-body cao-analysis-info-popover-body">\n            <div class="analysis-header">\n                {{analysisTitle}}\n            </div>\n            {{analysisDescription}}\n        </div>\n    </lui-popover-body>\n</lui-popover>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(196)],a=function(t,e,n){t.directive("qvCaoFieldDropZone",function(){return{restrict:"A",replace:true,scope:{},link:function t(i,a){function s(t,e){return e===t}a.droppable({accept:function t(e){var n=e[0].getAttribute("data-slot");var i=e[0].getAttribute("data-slot-role");var r=a[0].getAttribute("data-slot");var o=a[0].getAttribute("data-slot-role");if(n===r)return false;if(s(o,i)&&s(i,o))return true;return false},drop:function t(i,s){var r=s.draggable[0].getAttribute("data-slot");var o=a[0].getAttribute("data-slot");e.publish(n.PUBSUB_TOPIC,{slotA:r,slotB:o})}})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48)],a=function(t){t.directive("qvCaoFieldDraggable",function(){return{restrict:"A",replace:true,link:function t(e,n){n.draggable({revert:"invalid",axis:"y",handle:".cao-edit-sortable-handle",helper:"clone",revertDuration:250,zIndex:1e3})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(928),n(929),n(373)],a=function(t,e,n){t.nativeComponent("qvCaoFieldDetails",{bindings:{match:"<",chart:"<",applyCallback:"<",fieldId:"@"},controller:["qvCaoLearningConfidenceService","luiPopover",function(t,e){var i;var a;this.$onInit=function(){this.showExpression=!this.match.libId;this.searchReport=this.chart.getSearchReport();this.matchDetails=this.chart.getMatchDetails()};this.getDisplayExpressionForMatch=function(t){return t.libId?t.libIdLabel:t.aggr?t.aggr+"("+t.field+")":t.field};this.showFieldInfo=function(s){if(i&&a){a.close();return}var r={reasons:t.getReasonForSelectingField(this.match,this.searchReport,this.matchDetails,true)};var o={template:n,input:r,controller:[function(){}],dock:"bottom",alignTo:s.currentTarget,closeOnResize:true,outsideIgnore:this.fieldId+"_why"};i=true;a=e.show(o);a.closed.then(function(){i=false})}}],template:e})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="cao-field-details-recommended" ng-hide="$ctrl.match.isDirty">\n    <span q-translation="cao.insight.editor.details.recommendation.why"/>\n    <a tid="{{$ctrl.fieldId}}_why" id="{{$ctrl.fieldId}}_why" ng-click="$ctrl.showFieldInfo($event)" qva-outside-ignore-for="{{$ctrl.fieldId}}_why">\n        <span class="lui-icon lui-icon--help"/>\n    </a>\n</div>\n<div class="cao-field-details-learn">\n    <cao-help-learn data-match="$ctrl.match" data-apply-callback="$ctrl.applyCallback" button-id="{{$ctrl.fieldId}}" chart="$ctrl.chart"></cao-help-learn>\n</div>\n'},function(t,e){t.exports='<lui-popover x-arrow="arrow">\n        <div class="cao-confidence-body">\n            <div class="cao-confidence-body-heading" q-translation="cao.confidence.heading"></div>\n            <ul class="cao-confidence-reason-list">\n                <li class="cao-confidence-reason-item" ng-repeat="reason in input.reasons.learned">\n                    <span class="lui-icon  lui-icon--tick lui-text-success" aria-hidden="true" ng-hide="reason.priority === 0"></span>\n                    <div class="cao-confidence-reason-item__text" ng-bind-html="reason.text"></div>\n                </li>\n                <li class="cao-confidence-reason-item" ng-repeat="reason in input.reasons.search">\n                        <span class="lui-icon  lui-icon--tick lui-text-success" aria-hidden="true" ng-hide="reason.priority === 0"></span>\n                        <div class="cao-confidence-reason-item__text" ng-bind-html="reason.text"></div>\n                    </li>\n            </ul>\n        </div>\n</lui-popover>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91),n(103),n(196),n(931),n(168)],a=function(t,e,n,i,a,s){t.nativeComponent("caoHelpLearn",{bindings:{applyCallback:"<",match:"<",chart:"<",buttonId:"@"},controller:["$element","luiPopover",function(t,r){var o=this;var l;var c=false;var u=false;o.learningOptions=[];var d=new s;var p=void 0;var h=void 0;var f=void 0;o.$onChange=function(){p=void 0;h=void 0;f=void 0};o.$doCheck=function(){if(o.match.field!==p||o.match.libId!==h||o.match.aggr!==f){p=o.match.field;h=o.match.libId;f=o.match.aggr;if(!u){this.searchReport=this.chart.getSearchReport();this.chartType=this.chart.getChartType();u=true}d.getDislikedItems().then(function(t){t&&t.length>0&&(o.dislikedFields=t[0].nodes);o.updateLearningOptions()})}};var g=function t(e){if(o.dislikedFields&&o.dislikedFields.length>0)return o.dislikedFields.filter(function(t){return t.field?t.field.name===e:t.libItem.libId===e})[0]};o.updateLearningOptions=function(){o.learningOptions=[];if(!o.match)return;var t=g(o.match.field||o.match.libId);if(t){o.learningOptions.push({text:e.get("cao.helpuslearn.useagain"),icon:"plus",action:function e(){d.undislikeItem(t.id).then(function(){l.close();o.applyCallback()});n.trackEvent(n.customEvents.INSIGHTS_PROPOSE_FIELD_AGAIN_CLICKED)}});return}o.match.libId||o.match.isDirty||(o.match.slotRole===i.MEASURE?o.learningOptions.push({text:e.get("cao.helpuslearn.not_a_measure"),icon:"unapprove",action:function t(){d.defineDimension({expr:"["+o.match.field+"]"}).then(function(){l.close();o.applyCallback()});n.trackEvent(n.customEvents.INSIGHTS_NOT_A_MEASURE_CLICKED)}}):o.match.slotRole===i.DIMENSION&&o.learningOptions.push({text:e.get("cao.helpuslearn.not_a_dimension"),icon:"unapprove",action:function t(){d.defineMeasure({expr:"unknown(["+o.match.field+"])"}).then(function(){l.close();o.applyCallback()});n.trackEvent(n.customEvents.INSIGHTS_NOT_A_DIMENSION_CLICKED)}}));o.learningOptions.push({text:e.get("cao.helpuslearn.neveruse"),icon:"minus",action:function t(){if(o.match.field){n.trackEvent(n.customEvents.INSIGHTS_NEVER_PROPOSE_FIELD_CLICKED);d.dislikeField({name:o.match.field}).then(function(){l.close();o.applyCallback()})}else if(o.match.libId){n.trackEvent(n.customEvents.INSIGHTS_NEVER_PROPOSE_LIB_CLICKED);d.dislikeLibItem({name:o.match.libId}).then(function(){l.close();o.applyCallback()})}}});o.isDisabled=0===o.learningOptions.length||o.chart.invalidFromLearning};this.displayHelpUsLearn=function(){if(c&&l){l.close();return}var e={template:a,input:o,controller:[function(){}],dock:"bottom",alignTo:t[0],closeOnResize:true,outsideIgnore:o.buttonId};c=true;l=r.show(e);n.trackEvent(n.customEvents.INSIGHTS_HELP_US_LEARN_CLICKED,{chart:o.chart.getAnalysisPrecedentId()});l.closed.then(function(){document.getElementById(o.buttonId).focus();c=false})}}],template:['<button class="lui-button" ng-click="$ctrl.displayHelpUsLearn()" ng-disabled="$ctrl.isDisabled"  tid="{{$ctrl.buttonId}}" id="{{$ctrl.buttonId}}" qva-outside-ignore-for="{{$ctrl.buttonId}}">','<span class="lui-button__icon  lui-icon  lui-icon--lightbulb" ></span><span class="lui-button__text" q-translation="cao.fieldPicker.helpuslearn.button"></span>',"</button>"].join("")})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<lui-popover x-arrow="arrow">\n    <div class="cao-help-learn-body">\n        <qv-action-list items="input.learningOptions"></qv-action-list>\n    </div>\n</lui-popover>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(933),n(167)],a=function(t,e,n){t.nativeComponent("qvActionList",{bindings:{items:"<"},controller:["$element","$timeout",function(t,e){var i=this;i.selectedIndex=-1;var a;this.$postLink=function(){a=t.find(".lui-list");a.on("keydown",r)};this.$onDestroy=function(){a.off("keydown",r)};this.selectItem=function(t){t.action()};function s(t){e(function(){i.selectedIndex=t})}function r(t){if(t.keyCode===n.ARROW_DOWN){t.preventDefault();i.selectedIndex<i.items.length-1?s(i.selectedIndex+1):s(0)}else if(t.keyCode===n.ARROW_UP){t.preventDefault();0===i.selectedIndex?s(i.items.length-1):s(i.selectedIndex-1)}else if(t.keyCode===n.ENTER||t.keyCode===n.TAB){t.preventDefault();e(function(){i.selectItem(i.items[i.selectedIndex])},0)}}}],template:e})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='\n    <ul class="lui-list" qva-focus="true" tabindex="0">\n        <li ng-repeat="item in $ctrl.items" class="lui-list__item lui-list__action" ng-class="{ \'lui-disabled\': item.disabled, \'lui-active\': $index === $ctrl.selectedIndex }"\n            ng-click="item.disabled || $ctrl.selectItem(item)">\n            <span class="lui-list__aside  lui-icon lui-icon--{{item.icon}}" ng-if="item.icon"></span>\n            <span class="lui-list__text" tid="{{item.tid}}" q-translation="{{item.text}}"></span>\n        </li>\n    </ul>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91),n(103),n(935),n(373)],a=function(t,e,n,i){t.nativeComponent("caoConfidence",{bindings:{buttonId:"@",chart:"<",hideText:"<",closeNotification:"&",opened:"&",closed:"&"},controller:["luiPopover","qvCaoLearningConfidenceService",function(t,a){var s=this;var r;var o=false;s.$onInit=function(){l();s.closeNotification({handler:function t(){if(r){r.close();o=false}}})};s.$doCheck=function(){if(s.chart.recalculateConfidence){s.chart.recalculateConfidence=false;l()}};function l(){s.confidenceReasons={learned:[],search:[]};s.confidence=a.determineConfidence(s.chart);s.confidenceTitle=e.get("cao.confidence.title_"+s.confidence);if("empty"===s.confidence)s.emptyConfidence=true;else{var t=s.chart.getMatchDetails();s.chart.getMatches().forEach(function(e){var n=a.getReasonForSelectingField(e,s.chart.getSearchReport(),t,false);s.confidenceReasons.learned=s.confidenceReasons.learned.concat(n.learned);s.confidenceReasons.search=s.confidenceReasons.search.concat(n.search)})}}s.displayConfidenceInfo=function(){var e=this;if(e.emptyConfidence)return;if(o&&r){r.close();return}var a={template:i,input:this,controller:[function(){}],dock:"bottom",alignTo:document.getElementById(e.buttonId),closeOnResize:true,outsideIgnore:this.buttonId};o=true;r=t.show(a);r.opened.then(function(){if(e.opened){n.trackEvent(n.customEvents.INSIGHTS_CONFIDENCE_INDICATOR_CLICKED,{chart:e.chart.getAnalysisPrecedentId()});e.opened()}});r.closed.then(function(){e.closed&&e.closed();o=false})}}],template:['<span class="cao-confidence-container" q-title-translation="cao.confidence.title" aria-label="{{$ctrl.confidenceTitle}}"  >','<span class="cao-confidence-{{$ctrl.confidence}}-icon" ng-class="{\'no-reasons\': $ctrl.emptyConfidence}" ng-click="$ctrl.displayConfidenceInfo()" tid="{{$ctrl.buttonId}}" id="{{$ctrl.buttonId}}" qva-outside-ignore-for="{{$ctrl.buttonId}}"></span>',"</span>"].join("")})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<lui-popover x-arrow="arrow">\n    <div class="cao-confidence-body">\n        \x3c!-- <div class="cao-confidence-body-heading" q-translation="cao.confidence.heading"></div> --\x3e\n        <div class="cao-confidence-empty" ng-show="input.emptyConfidence" q-translation="cao.confidence.emptyconfidence"></div>\n\n        <div class="cao-confidence-body-heading-small" q-translation="cao.confidence.learnedbycognitive.title" ng-show="input.confidenceReasons.learned.length > 0"></div>\n        <ul class="cao-confidence-reason-list" ng-hide="input.emptyConfidence">\n            <li class="cao-confidence-reason-item" ng-repeat="reason in input.confidenceReasons.learned">\n                <span class="lui-icon  lui-icon--tick lui-text-success" aria-hidden="true"></span>\n                <div class="cao-confidence-reason-item__text" ng-bind-html="reason.field"></div>\n            </li>\n        </ul>\n\n        <div class="cao-confidence-body-heading-small" q-translation="cao.confidence.relevanttoserach.title" ng-show="input.confidenceReasons.search.length > 0"></div>\n        <ul class="cao-confidence-reason-list" ng-hide="input.emptyConfidence">\n            <li class="cao-confidence-reason-item" ng-repeat="reason in input.confidenceReasons.search">\n                <span class="lui-icon  lui-icon--tick lui-text-success" aria-hidden="true"></span>\n                <div class="cao-confidence-reason-item__text" ng-bind-html="reason.field"></div>\n            </li>\n        </ul>\n\n    </div>\n</lui-popover>'},function(t,e){t.exports='<div class="cao-refresh-indicator-container">\n    <div class="cao-refresh-indicator-content">\n        <div q-translation="cao.insight.refresh.indicator.body" />\n        <div class="cao-refresh-action">\n            <a class="cao-refresh" ng-click="$ctrl.refresh()" q-translation="cao.insight.refresh.indicator.action" />\n        </div>\n    </div>\n</div>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(10),n(11),n(48),n(54),n(938),n(49),n(111)],a=function(t,e,n,i,a,s){var r={transclude:true,template:a,bindings:{chart:"=",app:"<",interactive:"<",scrollContainer:"<",getChartMenuItems:"&",setBlurHandler:"&",onChartLoaded:"&",contextMenuStatus:"=",index:"<"},controller:["$element","$document","$window","$timeout","$scope","qvCaoRenderService",function(a,r,o,l,c,u){var d=this;d.isLoadingCardImageFlag=s.getFlag("LOADING_CARD_IMAGES");d.caoTweakEnabled=s.getFlag("CAO_TWEAK");function p(){return d.interactive?-99:d.chart.getComplexity()?d.chart.getComplexity():d.index}this.$onInit=function(){this.hasBlurHandler=false;this.isDestroyed=false;this.scrollHander=i.debounce(this.renderChartIfInView,300);this.initializeState()};this.$doCheck=function(){if((this.interactive||this.caoTweakEnabled)&&this.chart.shouldRedraw){delete this.chart.shouldRedraw;d.chart.refreshChartType();d.chart.setState("LOADING");u.enqueueForRender(d.loadChart,p(d.chart.chart.visualization))}if(!this.hasBlurHandler&&this.chart.getObject().setOnBlurHandler){this.setBlurHandler();this.hasBlurHandler=true}};this.$postLink=function(){l(function(){if("READY"===d.chart.getState()&&d.isInView()&&!d.isDestroyed){d.chart.setState("LOADING");u.enqueueForRender(d.loadChart,p(d.chart.chart.visualization))}})};this.$onDestroy=function(){this.isDestroyed=true;u.dequeueRender(d.loadChart);t.element(this.scrollContainer).unbind("scroll",d.scrollHander);t.element(o).unbind("resize",d.renderChartIfInView);this.chart.destroyChart()};this.renderChartIfInView=function(){if(!d.isDestroyed&&d.isInView()&&"READY"===d.chart.getState()){d.chart.setState("LOADING");u.enqueueForRender(d.loadChart,p(d.chart.chart.visualization))}};this.isInView=function(){var t=a[0].getBoundingClientRect();var e=!o.innerHeight||r[0].documentElement.clientHeight;var n=t.top<=e;return n};this.loadManually=function(t){t.stopPropagation();d.chart.setState("LOADING");d.chart.allowLongLoad=true;u.enqueueForRender(d.loadChart,p(d.chart.chart.visualization))};this.loadChart=function(){return d.chart.loadChart(d.onChartLoaded)};this.openContextMenu=function(t,i,a,s){if(!this.contextMenuStatus.open&&this.chart.rendered){var r=n.getService("qvContextMenu").menu();r.onOpen=function(){e(".qv-contextmenu lui-popover").css("max-height",400)};d.getChartMenuItems({menu:r});var o=n.getService("qvContextMenu");o.showInline(r,{position:{x:i.pageX,y:i.pageY},onCloseFn:a},s||i.currentTarget)}};c.$on("cao.openContextMenu",function(t,e){d.openContextMenu(null,e.event,e.closeFn,e.element)});this.initializeState=function(){if(this.scrollContainer){t.element(this.scrollContainer).bind("scroll",this.scrollHander);t.element(o).bind("resize",d.renderChartIfInView)}}}]};n.nativeComponent("qvCaoInsightChart",r)}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="result-item-graph-container" ng-if="!$ctrl.interactive" qva-context-menu="$ctrl.openContextMenu( item, $event, $ctrl.onCloseContextMenu)"\n    qva-radial-context-menu="$ctrl.openContextMenu( item, $event, $ctrl.onCloseContextMenu)">\n    <qv-object ng-if="$ctrl.chart.getState() === \'LOADED\'" model="$ctrl.chart.chart.model" options="$ctrl.chart.options"\n        object="$ctrl.chart.object" />\n</div>\n\n<div class="result-item-graph-container" ng-if="$ctrl.interactive" qva-context-menu="$ctrl.openContextMenu( item, $event, $ctrl.onCloseContextMenu)"\n    qva-radial-context-menu="$ctrl.openContextMenu( item, $event, $ctrl.onCloseContextMenu)">\n    <qv-object ng-if="$ctrl.chart.getState() === \'LOADED\'" model="$ctrl.chart.chart.model" options="$ctrl.chart.zoomedOptions"\n        object="$ctrl.chart.zoomedObject" />\n</div>\n\n<div class="spinner-container" ng-if="($ctrl.chart.getState() === \'LOADING\' && !$ctrl.isLoadingCardImageFlag)">\n    <qv-spinner show="!$ctrl.chartLoaded && !$ctrl.isLoadingCardImageFlag" show-delay="100" center-in-parent="true"></qv-spinner>\n</div>\n<div class="image-container" ng-if="$ctrl.chart.getState() === \'LOADING\' && $ctrl.isLoadingCardImageFlag">\n    <img ng-src="{{$ctrl.chart.chartTypeImageUrl}}" class="loader-image" />\n</div>\n\n<div class="cao-manual-loader" ng-click="$event.stopPropagation()" ng-if="$ctrl.chart.getState() === \'MANUAL_LOAD\'">\n    <ul>\n        <li class="cao-loader-text" q-translation="cao.card.complex">\n        </li>\n        <li>\n            <lui-button ng-click="$ctrl.loadManually($event)" q-translation="cao.card.complex.load"></lui-button>\n        </li>\n    </ul>\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(95),n(940),n(105),n(49),n(159),n(91),n(372),n(93),n(103),n(275),n(212)],a=function(t,e,n,i,a,s,r,o,l,c,u){var d={template:i,bindings:{query:"<",disabled:"<",matchingFields:"<",matchingFieldIndex:"<",fieldToRemove:"<",fieldToAdd:"<",updateFieldPicker:"<",isLimited:"<",direction:"<",nluQueryInfoButtonVisible:"<",nluQueryInfoVisible:"<",toggleNluQueryInfo:"<"},controller:["$timeout","qvCaoSearchService","qvCaoService",function(e,i,d){var p=this;this.selectedSuggestion=null;this.nluEnabled=s.getFlag("NLU_INSIGHTS");this.nluQueries=[];this.NLU_QUERIES_LIMIT=10;this.waitingForAppId=false;this.$onInit=function(){this.initializeState()};this.searchInputPlaceHolder=this.nluEnabled?o.get("cao.search.input.nlu.placeHolder")+r.lrm:o.get("cao.search.input.placeHolder")+r.lrm;this.clearSerchButtonIconScreenReader=o.get("clear.serch.button.icon.screen.reader");this.caoSearchInputSearchScreenReader=o.get("cao.search.input.search.reader");this.caoSearchInputScreenReader=o.get("cao.search.input.screen.reader");this.$onChanges=function(t){this.syncFieldPicker=s.getFlag("CAO_FIELD_PICKER_SYNC");this.syncFieldPicker?t.fieldToAdd&&t.fieldToAdd.currentValue?this.toggleFieldPickerField(this.fieldToAdd):t.fieldToRemove&&t.fieldToRemove.currentValue&&this.toggleFieldPickerField(this.fieldToRemove):t.fieldToAdd&&t.fieldToAdd.currentValue&&this.fieldToAdd&&this.addFieldToQuery(this.fieldToAdd,true)};this.$onDestroy=function(){t("#qv-cao-search-container").off("click",p.caoSearchContainerOnclickHandler);t("#cao-search-input").off("click",p.caoSearchInputOnClickHandler);t(window).off("resize",p.searchSuggestionBoxOnResizeHandler);n.unsubscribe("cao/insights/clear");p.nluEnabled&&n.unsubscribe("cao/nlu/new_queries")};this.caoSearchContainerOnclickHandler=function(t){t.stopPropagation()};this.caoSearchInputOnClickHandler=function(t){t.stopPropagation();p.updateCursorPositionState(t)};this.searchSuggestionBoxOnResizeHandler=function(){p.isMatchingFieldPopupVisible&&e(function(){p.updateMatchingFields();p.showMatchingFieldPopup()},300)};this.toggleCao=function(){d.toggleCao()};this.initializeState=function(){this.queryTokens=[];this.cursorPosition=0;t("#qv-cao-search-container").click(p.caoSearchContainerOnclickHandler);t("#cao-search-input").click(p.caoSearchInputOnClickHandler);t(window).on("resize",p.searchSuggestionBoxOnResizeHandler);if(this.nluEnabled){n.subscribe("cao/nlu/new_queries",p.newNluQuery);c.getApp().then(function(t){p.appId=t.id;p.getNluQueries().then(function(){p.waitingForAppId&&e(function(){p.showSearchHistoryPopup()})})})}};this.handleSearchInputBlur=function(){p.matchingField=null;p.hideMatchingFields();p.hideSearchHistoryPopup()};this.updateCursorPositionState=function(t){p.updateCurrentCursorPositionState(t);if(p.query){var n=i.getCurrentToken(p.query,p.cursorPosition).token;p.cursorPosition<p.query.length+1&&n&&n.word?p.showFields(t):p.hideMatchingFields()}else p.nluEnabled&&(p.nluQueries.length||p.appId?p.nluQueries.length&&e(function(){p.positionSearchResultPopup();p.showSearchHistoryPopup()}):p.waitingForAppId=true)};this.showMatchingFieldPopup=function(){this.isMatchingFieldPopupVisible||(this.isMatchingFieldPopupVisible=true)};this.showSearchHistoryPopup=function(){this.isSearchHistoryPopupVisible||(this.isSearchHistoryPopupVisible=true)};this.hideSearchHistoryPopup=function(){this.isSearchHistoryPopupVisible=false};this.setMatchingFieldIndex=function(t){this.matchingFieldIndex=t};this.toggleFieldPickerField=function(t){if(t&&t.selected){this.removeFieldFromQuery(t);this.syncFieldPicker&&i.selectField(t,false)}else if(t&&!t.selected){this.addFieldToQuery(t);this.fieldToAdd=this.syncFieldPicker?this.fieldToAdd:"";this.syncFieldPicker&&i.selectField(t,true)}this.query&&0!==this.query.trim().length?this.updateInsights(this.query):this.clearQuery()};this.updateInsights=function(t){if(t){i.updateInsights(t.trim());this.trimSpacesOnQuery();this.hideMatchingFields();u.trackEvent(u.customEvents.INSIGHTS_TYPED_QUERY,{query:t})}};this.defaultCursorPosition=function(){return this.query?this.query.length+1:0};this.trimSpacesOnQuery=function(){this.query=this.query.trim();this.query+=" "};this.addFieldToQuery=function(e,n,a){a&&a.preventDefault();var s=t("#cao-search-input")[0];var r=this.cursorPosition?this.cursorPosition:this.defaultCursorPosition();var o=i.addFieldToQuery(e,this.query,r,s.selectionStart,s.selectionEnd);this.cursorPosition=o.cursorPosition;this.query=o.query;this.updateMatchingFields();this.positionCursorAtIndex(this.cursorPosition);this.syncFieldsInQueryWithFieldPicker();this.trimSpacesOnQuery();n&&this.updateInsights(this.query)};this.usePreviousQuery=function(t){p.query=t};this.keydown=function(t,e){switch(t.which){case 38:case 40:e&&(this.selectedSuggestion=e.caoFieldId);break;default:this.selectedSuggestion=null}};this.removeFieldFromQuery=function(t){var e=i.getSelectedFields(this.query);var n=this.cursorPosition?this.cursorPosition:this.defaultCursorPosition();this.query=i.removeFieldFromQuery(t,this.query,e);this.positionCursorAtIndex(n);this.syncFieldsInQueryWithFieldPicker()};this.hideMatchingFields=function(){e(function(){p.isMatchingFieldPopupVisible=false;p.navigatingThroughMatchingFields=false;p.matchingFields=[]})};this.clearQuery=function(){p.query="";p.hideMatchingFields();i.clearSelectedFields();p.syncFieldsInQueryWithFieldPicker();i.showIntro(true)};this.showFields=function(t){t&&this.updateCurrentCursorPositionState(t);this.matchingFields=i.getFields();this.clearHighlightedFields();this.updateMatchingFields();this.showMatchingFieldPopup()};this.positionCursorAtIndex=function(n){this.query&&this.query.length>0&&e(function(){var e=document.getElementById("cao-search-input");var i=n;t("#cao-search-input").focus();e.setSelectionRange(i,i)})};this.updateCurrentCursorPositionState=function(t){this.cursorPosition=t.target.selectionStart};this.scrollFieldIntoView=function(t){if(t&&t.caoFieldId){var e=document.getElementById(t.caoFieldId);e&&e.scrollIntoView&&e.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}};this.updateMatchingFields=function(){e(function(){var t=p.cursorPosition?p.cursorPosition:0;var e=i.getCurrentToken(p.query,t);p.currentToken=e;p.setMatchingFieldIndex(-1);if(null!==e.index&&e.token.word){if(e.token){p.matchingFields=i.getMatchingFields(e.token.word,p.isLimited);p.highlightField(p.matchingFieldIndex)}}else p.hideMatchingFields();p.positionSearchResultPopup()})};this.getNluQueries=function(){return l.getQueries(p.NLU_QUERIES_LIMIT,p.appId).then(function(t){p.nluQueries=t})};this.newNluQuery=function(t){p.nluQueries.push(t)};this.positionSearchResultPopup=function(){var e;if(this.query&&this.query.length>0){var n=this.cursorPosition?this.cursorPosition:0;var a=t("#cao-search-input");var s=t("#qv-cao-search-input-container");if(a.position()&&a.position().left){e=a.position().left;p.nluEnabled&&s&&s.position()&&(e+=s.position().left);var r=i.getCurrentToken(this.query,n);r.token&&(n=r.token.indexStart);e+=i.searchResultPositionRelativeToQuery(this.query,n)}}this.searchResultContainerLeft=e+"px"};this.highlightField=function(t){this.clearHighlightedFields();this.matchingFields.length>0&&t>=0&&(this.matchingFields[t].highlight=true)};this.clearHighlightedFields=function(){this.matchingFields=this.matchingFields.map(function(t){t.highlight=false;return t})};this.syncFieldsInQueryWithFieldPicker=function(){if(this.syncFieldPicker){i.syncFieldsInQueryWithFieldPicker(this.query);this.updateFieldPicker()}};this.getMatchingFields=function(t){this.triggerKeyboardBehaviours(t);if(this.query&&this.query.length>0){p.hideSearchHistoryPopup();var e=this.query.replace(/\s{2,}/g," ");var n="keyup"===t.type&&t.which===a.KeyCodes.Enter&&!this.navigatingThroughMatchingFields;if(!this.navigatingThroughMatchingFields){this.updateMatchingFields();t.which!==a.KeyCodes.Enter&&this.showMatchingFieldPopup()}t.which!==a.KeyCodes.Enter&&t.which!==a.KeyCodes.Tab||(this.isMatchingFieldPopupVisible=false);n&&this.updateInsights(e)}};this.navigateMatchingFields=function(t){this.triggerKeyboardBehaviours(t);this.navigatingThroughMatchingFields=t&&t.which===a.KeyCodes.Down||t.which===a.KeyCodes.Up;var e=t&&"keydown"===t.type&&t.keyCode;var n=e&&this.matchingFields&&this.matchingFields.length>0;if(n){this.matchingField=i.matchingField(t.keyCode,this.matchingFieldIndex,this.matchingFields);this.setMatchingFieldIndex(this.matchingFields.indexOf(this.matchingField));this.scrollFieldIntoView(this.matchingField);if(this.matchingFieldIndex>=0){var s=e&&t.keyCode===a.KeyCodes.Tab&&this.matchingField;var r=e&&t.keyCode===a.KeyCodes.Enter&&this.matchingField;if(s){this.addFieldToQuery(this.matchingField);this.hideMatchingFields()}if(r){this.addFieldToQuery(this.matchingField);this.updateInsights(this.query)}this.navigatingThroughMatchingFields&&this.highlightField(this.matchingFieldIndex)}switch(t.which){case 38:case 40:this.matchingField&&(this.selectedSuggestion=this.matchingField.caoFieldId);break}}t&&t.which===a.KeyCodes.Enter&&!this.query&&this.clearQuery()};n.subscribe("cao/insights/clear",p.clearQuery);this.triggerKeyboardBehaviours=function(t){this.updateCurrentCursorPositionState(t);this.syncFieldsInQueryWithFieldPicker();t.which!==a.KeyCodes.Down&&t.which!==a.KeyCodes.Up&&t.which!==a.KeyCodes.Enter||t.preventDefault();e(function(){t.which===a.KeyCodes.Delete&&p.updateMatchingFields();if(t.which===a.KeyCodes.Esc){p.matchingField=null;p.hideMatchingFields()}})}}]};e.nativeComponent("qvCaoSearch",d)}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div id="qv-cao-search-container" class="qv-cao-search-container">\n\t<div class="qv-cao-search-input" ng-class="{\'focus\': $ctrl.isInputFocused, \'qv-cao-search-input--nlu\': $ctrl.nluEnabled}" id="qv-cao-search-input-container">\n\t\t<div class="search-cao-field-area">\n\t\t\t<div class="lui-search search-field" qva-direction x-dir-setting="{{$ctrl.direction}}">\n\t\t\t\t<span class="lui-search__search-icon"></span>\n\t\t\t\t<input class="lui-search__input"\n\t\t\t\t\t   ng-model="$ctrl.query"\n\t\t\t\t\t   auto-focus="autoFocus"\n\t\t\t\t\t   aria-autocomplete="list"\n\t\t\t\t\t   autocomplete="off"\n\t\t\t\t\t   ng-disabled="$ctrl.disabled"\n\t\t\t\t\t   type="text"\n\t\t\t\t\t   is-focused="isInputFocused"\n\t\t\t\t\t   placeholder="{{$ctrl.searchInputPlaceHolder}}"\n\t\t\t\t\t   ng-keydown="$ctrl.navigateMatchingFields($event)"\n\t\t\t\t\t   ng-keyup="$ctrl.getMatchingFields($event)"\n\t\t\t\t\t   tid="caoSearch.searchField"\n\t\t\t\t\t   tabindex="0"\n             role="combobox"\n\t\t\t\t\t   aria-label="{{$ctrl.caoSearchInputSearchScreenReader}}"\n\t\t\t\t\t   aria-activedescendant="{{$ctrl.selectedSuggestion}}"\n\t\t\t\t\t   aria-owns="cao_search_suggestions cao_search_history"\n\t\t\t\t\t   id="cao-search-input"\n\t\t\t\t\t   ng-blur="$ctrl.handleSearchInputBlur()"\n        />\n\t\t\t\t<button aria-label="{{$ctrl.clearSerchButtonIconScreenReader}}" class="lui-icon  lui-icon--remove" tid="cao-search-clear-btn" ng-if="$ctrl.query" q-title-translation="cao.search.clear.tooltip" ng-click="$ctrl.clearQuery()"></button>\n\t\t\t</div>\n\t\t</div>\n\t\t<button class="qv-cao-search-info-button" ng-class="{ \'qv-cao-search-info-button--active\': $ctrl.nluQueryInfoVisible }" ng-if="$ctrl.nluEnabled && $ctrl.nluQueryInfoButtonVisible" ng-click="$ctrl.toggleNluQueryInfo()">\n\t\t\t<i class="lui-icon lui-icon--info"></i>\n\t\t</button>\n\t</div>\n\t<div id="cao_search_suggestions" class="qv-cao-search-suggestions" ng-if="$ctrl.isMatchingFieldPopupVisible"\n\t\t ng-style="{ \'left\': $ctrl.searchResultContainerLeft }">\n\t\t<ul class="lui-list">\n\t\t\t<li class="lui-list__item fields"\n\t\t\t\ttid="caoSearchSuggestionField"\n\t\t\t\tng-class="{\'highlight\': field.highlight}"\n\t\t\t\tng-repeat="field in $ctrl.matchingFields"\n\t\t\t\tng-mousedown="$ctrl.addFieldToQuery(field, true, $event)"\n\t\t\t\tid="{{field.caoFieldId}}"\n\t\t\t\taria-labelledby="{{field.caoFieldId+\'Name\' + \' \' + field.caoFieldId+\'Origin\'}}"\n\t\t\t\t>\n\t\t\t\t<span aria-hidden="true" class="lui-list__text" q-title-translation={{field.qName}} tid="caoSearchSuggestionFieldName" >\n\t\t\t\t\t<span aria-hidden="true" qve-highlight text="{{ field.qName }}" query="$ctrl.currentToken.token.word" ></span>\n\t\t\t\t</span>\n\t\t\t\t<span aria-hidden="true" ng-if="!field.masterItem" class="lui-list__aside field-name" q-title-translation={{field.tablesTooltip}}>{{field.tablesAssociated}}</span></span>\n\t\t\t\t<span aria-hidden="true" ng-if="field.masterItem" class="lui-list__aside field-name">{{field.masterItemTitle}}</span></span>\n\t\t\t\t<p id="{{field.caoFieldId+\'Name\'}}" class="sr-only" >{{ field.qName }}</p>\n\t\t\t\t<p id="{{field.caoFieldId+\'Origin\'}}" class="sr-only" ng-if="!field.masterItem" class="lui-list__aside field-name" q-title-translation={{field.tablesTooltip}}>{{field.tablesAssociated}}</p>\n\t\t\t\t<p id="{{field.caoFieldId+\'Origin\'}}" class="sr-only" ng-if="field.masterItem" class="lui-list__aside field-name">{{field.masterItemTitle}}</p>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n\t<div id="cao_search_history" class="qv-cao-search-history qv-cao-search-suggestions" ng-if="$ctrl.isSearchHistoryPopupVisible"\n\t\tng-style="{ \'left\': $ctrl.searchResultContainerLeft }">\n\t\t<ul class="lui-list">\n\t\t\t<li class="lui-list__item fields"\n\t\t\t\ttid="caoSearchHistoryField"\n\t\t\t\tng-repeat="query in $ctrl.nluQueries"\n\t\t\t\tng-mousedown="$ctrl.usePreviousQuery(query.text)"\n\t\t\t\tid="{{query.id}}"\n\t\t\t\taria-labelledby="{{query.id}}"\n\t\t\t\t>\n\t\t\t\t<span aria-hidden="true" class="lui-list__text" q-title-translation={{query.text}} tid="caoSearchHistoryFieldName">\n\t\t\t\t\t<span aria-hidden="true" qve-highlight text="{{ query.text }}"></span>\n\t\t\t\t</span>\n\t\t\t\t<p id="{{query.id}}" class="sr-only" >{{ query.text }}</p>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</div>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91),n(103),n(95),n(942),n(168),n(49),n(943),n(944)],a=function(t,e,n,i,a,s,r){var o={template:a,bindings:{isLimited:"<",insightsLoaded:"<",items:"<",activeTab:"<",selectField:"<",showFieldPicker:"<",toggleFieldPicker:"&"},controller:["qvCaoService",function(t){var a=this;var o=new s;this.activeTab=null;this.fieldPickerTabDimensions=e.get("cao.fieldPicker.tab.dimensions");this.fieldPickerTabMeasures=e.get("cao.fieldPicker.tab.measures");this.fieldPickerTabFields=e.get("cao.fieldPicker.fields.title");this.fieldPickerTabFieldsScreenReader=e.get("cao.fieldPicker.fields.title");this.fieldPickerTabMasterItemsScreenReader=e.get("cao.fieldPicker.masterItems.title");this.insightLearning=r.getFlag("CE_PRECEDENTS");this.caoTweakEnabled=r.getFlag("CAO_TWEAK");this.useAgainString=e.get("cao.helpuslearn.useagain");this.dislikedFields=[];this.$onInit=function(){this.init()};this.$onDestroy=function(){i.unsubscribe("cao/insight/learning_applied")};this.$onChanges=function(t){if(t.items&&t.items.currentValue){this.items=t.items.currentValue;this.masterItemDimensions=[];this.masterItemMeasures=[];this.fields=[];this.items.forEach(function(t){t.masterItemDimension?a.masterItemDimensions.push(t):t.masterItemMeasures?a.masterItemMeasures.push(t):a.fields.push(t)})}t.isLimited&&t.isLimited.currentValue&&t.isLimited!==t.isLimited.currentValue?this.init():t.isLimited&&false===t.isLimited.currentValue&&this.init();l()};var l=function t(){if(a.insightLearning){if(a.items&&0!==a.items.length)return o.getDislikedItems().then(function(t){t&&t.length>0&&(a.dislikedFields=t[0].nodes)});a.dislikedFields=[]}else a.dislikedFields=[]};this.isDislikedField=function(t){return a.dislikedFields.filter(function(e){return e.field&&e.field.name===t.qName})[0]};this.isDislikedMasterItem=function(t){return a.dislikedFields.filter(function(e){return e.libItem&&e.libItem.libId===t.libId})[0]};this.useFieldAgain=function(e){n.trackEvent(n.customEvents.INSIGHTS_PROPOSE_FIELD_AGAIN_CLICKED);o.undislikeItem(e.id).then(function(){t.setRefreshIndicatorVisibility(true);i.publish("cao/insight/learning_applied")})};this.init=function(){true===this.isLimited?this.setActiveTab("masterItems"):false===this.isLimited&&this.setActiveTab("fields");i.subscribe("cao/insight/learning_applied",l)};this.setActiveTab=function(t){if("fields"===t)if("fields"!==this.activeTab){this.activeTab="fields";this.title=e.get("cao.fieldPicker.fields.title");this.showFieldPicker||this.toggleFieldPicker()}else this.toggleFieldPicker();else if("masterItems"===t)if("masterItems"!==this.activeTab){this.activeTab="masterItems";this.title=e.get("cao.fieldPicker.masterItems.title");this.setMasterItemsSection("measures");this.showFieldPicker||this.toggleFieldPicker()}else this.toggleFieldPicker()};this.setMasterItemsSection=function(t){"measures"===t?this.activeMasterItemSection="measures":"dimensions"===t&&"dimensions"===this.activeMasterItemSection?this.activeMasterItemSection="measures":"dimensions"===t&&"dimensions"!==this.activeMasterItemSection&&(this.activeMasterItemSection="dimensions")}}]};t.nativeComponent("qvCaoFieldPicker",o)}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="field-picker">\n\t<div class="tabs">\n\t\t<div qva-cao-acc-field-items x-items-type="fieldPickerCategories">\n\t\t\t<div tid="caoFieldPickerFieldTabButton" class="tab" cao-acc-field-item="{\'type\': \'fieldPickerCategories\', \'index\': 0}"\n\t\t\t ng-class="{\'hide-tab\': $ctrl.activeTab === null, \'selected\': $ctrl.activeTab === \'fields\', \'cao-acc-focus\': $ctrl.itemAccFocus}"\n\t\t\t ng-show="!$ctrl.isLimited" aria-label="{{$ctrl.fieldPickerTabFieldsScreenReader}}" ng-click="$ctrl.setActiveTab(\'fields\')"\n\t\t\t q-title-translation="cao.fieldPicker.fields.title">\n\t\t\t\t<span class="lui-icon  lui-icon--database"></span>\n\t\t\t</div>\n\t\t</div>\n\t\t<div qva-cao-acc-field-items x-items-type="fieldPickerCategories">\n\t\t\t<div tid="caoFieldPickerMasterItemsTabButton" class="tab" cao-acc-field-item="{\'type\': \'fieldPickerCategories\', \'index\': 1}"\n\t\t\t ng-class="{\'hide-tab\': $ctrl.activeTab === null, \'selected\': $ctrl.activeTab === \'masterItems\', \'cao-acc-focus\': $ctrl.itemAccFocus}"\n\t\t\t ng-click="$ctrl.setActiveTab(\'masterItems\')" aria-label="{{$ctrl.fieldPickerTabMasterItemsScreenReader}}"\n\t\t\t q-title-translation="cao.fieldPicker.masterItems.title">\n\t\t\t\t<span class="lui-icon  lui-icon--link"></span>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class="tab-content" tid="caoFieldPickerContentContainer">\n\t\t<qv-spinner class="spinner" show="!$ctrl.items" show-delay="500" center-in-parent="true"></qv-spinner>\n\n\t\t<div ng-if="$ctrl.activeTab === \'fields\' && !$ctrl.isLimited && $ctrl.insightsLoaded" class="fields">\n\t\t\t<button class="field-item-header" ng-class="{\'selected\': true}" tabindex="0" tid="caoFieldPickerFieldSectionButton"\n\t\t\t\taria-labelledby="{{caoFieldPickerFieldText}}">\n\t\t\t\t   <span ng-class="{\'cao-acc-focus\': $ctrl.itemAccFocus}" tid="caoFieldPickerFieldText" class="group-name">\n\t\t\t\t\t   {{$ctrl.fieldPickerTabFields}}</span>\n\t\t\t  </button>\n\t\t\t<div class="no-items" ng-if="$ctrl.showFieldPicker && !$ctrl.fields.length" q-translation="cao.fieldPicker.noItems"></div>\n\t\t\t<ul class="lui-list" ng-if="$ctrl.fields.length" qva-cao-acc-field-items x-items-type="fieldItem">\n\t\t\t\t<div ng-repeat="field in $ctrl.fields" class="field-container">\n\t\t\t\t\t<li class="lui-list__item field" tid="caoFieldPickerField" cao-acc-field-item="{\'type\': \'fieldItem\', \'index\': $index}"\n\t\t\t\t\t ng-click="$ctrl.selectField(field)" aria-label="{{field.qName}}" q-title-translation={{field.qName}} ng-class="{\'selected\': field.selected, \'cao-acc-focus\': $ctrl.itemAccFocus, \'disliked\': $ctrl.isDislikedField(field)}">\n\t\t\t\t\t\t<span class="lui-list__aside  lui-icon {{field.classificationIcon}}" ng-if="field.classificationIcon"></span>\n\t\t\t\t\t\t<span class="lui-list__text">{{field.qName}}</span>\n\t\t\t\t\t</li>\n\t\t\t\t\t<div class="field-picker-propose" ng-if="!$ctrl.caoTweakEnabled && $ctrl.isDislikedField(field)" ng-click="$event.stopPropagation(); $ctrl.useFieldAgain($ctrl.isDislikedField(field))"\n\t\t\t\t\t lui-title-tooltip title="{{$ctrl.useAgainString}}" x-dock="top" x-close-on-click="true">\n\t\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--plus"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</ul>\n\t\t</div>\n\n\t\t<div ng-if="$ctrl.activeTab === \'masterItems\' && $ctrl.insightsLoaded" class="master-items" tid="caoFieldPickerMasterItemsContainer">\n\t\t\t<div class="dimensions" ng-class="{\'selected\': $ctrl.activeMasterItemSection === \'dimensions\'}">\n\t\t\t\t<button class="master-item-header" ng-class="{\'selected\': $ctrl.activeMasterItemSection === \'dimensions\'}" ng-keyup="$ctrl.itemAccFocus=true"\n\t\t\t\t ng-mouseup="$ctrl.itemAccFocus=false" tabindex="0" aria-controls="cao-field-picker-dimensions-fields" tid="caoFieldPickerMasterItemsDimensionSectionButton"\n\t\t\t\t ng-click="$ctrl.setMasterItemsSection(\'dimensions\')" aria-labelledby="{{caoFieldPickerMasterItemDimensionText}}">\n\t\t\t\t\t<span ng-class="{\'cao-acc-focus\': $ctrl.itemAccFocus}" tid="caoFieldPickerMasterItemDimensionText" class="group-name">\n\t\t\t\t\t\t{{$ctrl.fieldPickerTabDimensions}}</span>\n\t\t\t\t</button>\n\t\t\t\t<div class="no-items" ng-if="$ctrl.showFieldPicker && !$ctrl.masterItemDimensions.length && $ctrl.activeMasterItemSection === \'dimensions\'"\n\t\t\t\t q-translation="cao.fieldPicker.noItems"></div>\n\t\t\t\t<ul id="cao-field-picker-dimensions-fields" class="lui-list master-item-fields" qva-cao-acc-field-items\n\t\t\t\t x-items-type="masterItemDimension" aria-expanded="$ctrl.activeMasterItemSection === \'dimensions\'">\n\t\t\t\t\t<div ng-repeat="field in $ctrl.masterItemDimensions" class="field-container">\n\t\t\t\t\t\t<li class="lui-list__item field" tid="caoFieldPickerMasterItemDimension" cao-acc-field-item="{\'type\': \'masterItemDimension\', \'index\': $index}"\n\t\t\t\t\t\t aria-label="{{field.qName}}" ng-click="$ctrl.selectField(field)"\n\t\t\t\t\t\t q-title-translation={{field.qName}} ng-class="{\'selected\': field.selected, \'cao-acc-focus\': $ctrl.itemAccFocus, \'disliked\': $ctrl.isDislikedMasterItem(field) }">\n\t\t\t\t\t\t\t<span class="lui-list__text caoFieldPickerMasterItemDimensionText">{{field.qName}}</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<div class="field-picker-propose" ng-if="!$ctrl.caoTweakEnabled && $ctrl.isDislikedMasterItem(field)" ng-click="$event.stopPropagation(); $ctrl.useFieldAgain($ctrl.isDislikedMasterItem(field))"\n\t\t\t\t\t\t lui-title-tooltip title="{{$ctrl.useAgainString}}" x-dock="top" x-close-on-click="true">\n\t\t\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--plus"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</ul>\n\t\t\t</div>\n\n\t\t\t<div class="measures">\n\t\t\t\t<button class="master-item-header measures" ng-class="{\'selected\': $ctrl.activeMasterItemSection === \'measures\'}"\n\t\t\t\t ng-keyup="$ctrl.itemAccFocus=true" ng-mouseup="$ctrl.itemAccFocus=false" tabindex="0" aria-controls="cao-field-picker-measures-fields"\n\t\t\t\t tid="caoFieldPickerMasterItemsMeasureSectionButton" ng-click="$ctrl.setMasterItemsSection(\'measures\')"\n\t\t\t\t aria-labelledby="{{caoFieldPickerMasterItemMeasuresText}}">\n\t\t\t\t\t<span ng-class="{\'cao-acc-focus\': $ctrl.itemAccFocus}" tid="caoFieldPickerMasterItemMeasuresText" class="group-name">{{$ctrl.fieldPickerTabMeasures}}</span>\n\t\t\t\t</button>\n\t\t\t\t<div class="no-items" ng-if="$ctrl.showFieldPicker && $ctrl.showFieldPicker && !$ctrl.masterItemMeasures.length && $ctrl.activeMasterItemSection === \'measures\'"\n\t\t\t\t q-translation="cao.fieldPicker.noItems"></div>\n\t\t\t\t<ul id="cao-field-picker-measures-fields" class="lui-list master-item-fields" qva-cao-acc-field-items x-items-type="masterItemMeasure"\n\t\t\t\t aria-expanded="$ctrl.activeMasterItemSection === \'measures\'">\n\t\t\t\t\t<div ng-repeat="field in $ctrl.masterItemMeasures" class="field-container">\n\t\t\t\t\t\t<li class="lui-list__item field" tid="caoFieldPickerMasterItemMeasure" cao-acc-field-item="{\'type\': \'masterItemMeasure\', \'index\': $index}"\n\t\t\t\t\t\t ng-click="$ctrl.selectField(field)" q-title-translation={{field.qName}}\n\t\t\t\t\t\t aria-label="{{field.qName}}" ng-class="{\'selected\': field.selected, \'cao-acc-focus\': $ctrl.itemAccFocus, \'disliked\': $ctrl.isDislikedMasterItem(field) }">\n\t\t\t\t\t\t\t<span class="lui-list__text">{{field.qName}}</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<div class="field-picker-propose" ng-if="!$ctrl.caoTweakEnabled && $ctrl.isDislikedMasterItem(field)" ng-click="$event.stopPropagation(); $ctrl.useFieldAgain($ctrl.isDislikedMasterItem(field))"\n\t\t\t\t\t\t lui-title-tooltip title="{{$ctrl.useAgainString}}" x-dock="top" x-close-on-click="true">\n\t\t\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--plus"></span>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t</div>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(48)],a=function(t){t.directive("qvaCaoAccFieldItems",["qvAccessibilityGridService",function(t){return{restrict:"A",link:function e(n,i,a){n.$on("$destroy",function(){var e=a["itemsType"];t.removeAllItems(e)})}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48)],a=function(t){t.directive("caoAccFieldItem",["$timeout","qvAccessibilityGridService",function(t,e){return{restrict:"A",scope:{caoAccFieldItem:"="},link:function n(i,a){var s=function e(n,i){var s=n===this.col&&i===this.row;t(function(){a.attr("tabindex",s?0:-1);if(s){a.focus();a.addClass("cao-acc-focus")}else a.removeClass("cao-acc-focus")})};var r=e.addItem(i.caoAccFieldItem.index,s,i.caoAccFieldItem.type,0,i.caoAccFieldItem.index);r&&a.attr("tabindex",0);var o=function t(e){switch(e.which){case 9:case 16:"0"===a.attr("tabindex")&&a.addClass("cao-acc-focus");break}};var l=function n(s){switch(s.which){case e.RIGHT_KEY:case e.LEFT_KEY:case e.UP_KEY:case e.DOWN_KEY:s.stopPropagation();s.preventDefault();t(function(){"0"===a.attr("tabindex")&&e.key(s,i.caoAccFieldItem.type)});break}};a.on("mouseup",function(){a.removeClass("cao-acc-focus")});a.on("keyup",o);a.on("keydown",l)}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48)],a=function(t){t.service("qvCaoRenderService",[function(){var t;var e=[];var n=false;function i(){e.sort(function(t,e){return t.priority>e.priority});var t=e[0];t.renderFunction().finally(function(){n=false;e.shift();e.length>0&&i()})}var a=function t(a,s){e.push({renderFunction:a,priority:s});if(!n){n=true;i()}};var s=function t(n){e=e.filter(function(t){return t.renderFunction!==n})};var r=function t(){e=[];n=false};t={enqueueForRender:a,dequeueRender:s,clearRenderQueue:r};return t}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(103),n(168),n(221),n(212)],a=function(t,e,n){t.service("qvCaoLearningService",[function(){var t;var i=new n;function a(t){e.trackEvent(e.customEvents.INSIGHTS_NOT_A_MEASURE_CLICKED);return i.defineDimension({expr:"["+t+"]"})}function s(t){e.trackEvent(e.customEvents.INSIGHTS_NOT_A_DIMENSION_CLICKED);return i.defineMeasure({expr:"["+t+"]"})}function r(t){return i.dislikeLibItem({name:t})}function o(t){return i.dislikeField({name:t})}function l(t){var n=t.getAnalysis();return i.dislikeAnalysis(n).then(function(i){n.precedents={id:i.nodes[0].id,disliked:true};e.trackEvent(e.customEvents.INSIGHTS_HIDE_CHART_CLICKED,{chart:t.getAnalysisPrecedentId()})})}function c(t){var e=t.getAnalysis();return i.undislikeAnalysis(e).then(function(){delete e.precedents})}function u(t,e){return t.filter(function(t){return t.field?t.field.name===e:t.libItem.name===e})[0]}function d(t){return i.getDislikedItems().then(function(n){var a=n[0].nodes;e.trackEvent(e.customEvents.INSIGHTS_PROPOSE_FIELD_AGAIN_CLICKED);var s=u(a,t);return i.undislikeItem(s.id)})}function p(t){return i.dislikeAnalysis(t).then(function(e){t.precedents={id:e.nodes[0].id,disliked:true};return true})}function h(t){return i.undislikeAnalysis(t).then(function(){delete t.precedents;return false})}function f(){return i.getLearnedItems()}function g(){return i.getDislikedItems()}function v(t){return i.removeDefinedItem(t)}function m(t){return i.undislikeItem(t)}t={applyDimensionLearning:a,applyMeasureLearning:s,dislikeLibItem:r,dislikeField:o,hideChart:l,unHideChart:c,unDislikeItem:d,dislikeAnalysis:p,unDislikeAnalysis:h,getDislikedItems:g,getLearnedItems:f,removeDefinedItem:v,unDislikeField:m};return t}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(91),n(113),n(948),n(949),n(950),n(952),n(954),n(956),n(961)],a=function(t,e,n,i,a,s){var r=["$scope","$timeout","qvCaoSelectionService","qvCaoLearningConfidenceService","qvCaoLearningService",function(a,r,o,l,c){var u=this;var d=null;u.hiddenCharts=[];u.fieldRules=[];u.initState=true;u.isCustomPreferences=true;a.customPreferencesToggleOn=i.CAO_DEBUG;a.customPreferencesToggle={value:true};a.$watch("customPreferencesToggle.value",function(t){u.isCustomPreferences=t;u.precedentsEnabled=t});function p(t){var e=[];var n=u.chart.getSearchReport();var i=u.chart.getMatchDetails();t&&t.forEach(function(t){var a=l.getReasonForSelectingField(t,n,i,true);e=e.concat(a.learned);e=e.concat(a.search)});return e}this.handleHiddenCharts=function(t){if(t){var e=t.getAnalysis();return e.precedents&&e.precedents.disliked?c.unDislikeAnalysis(e):c.dislikeAnalysis(e)}};this.noLearningFound=function(){return!u.isFieldRulesSet()};this.isFieldRulesSet=function(){return u.fieldRules&&u.fieldRules.length>0};this.isFieldRulesEnabled=function(){return u.isFieldRulesSet()&&u.isCustomPreferences};this.viewHiddenCharts=function(){e.publish("cao/insight/open_hidden_charts_panel",u.hiddenCharts)};this.refreshPerformed=function(){u.populateFieldRules()};function h(t){return t.replace(/\{0\}/g,function(t){return"<b>"+t+"</b>"})}function f(t){var e=t.nodes;var i=[];e&&e.length>0&&e.forEach(function(t){var e;e=t&&t.libItem&&t.libItem.name?t.libItem.name:t.field.name;var a=h(n.get("cao.insight.contextPanel.customPreferences.dislikedField"));i.push({label:n.get(a,[e]),field:t,valid:true})});return i}function g(t){var e=t.nodes;var i=[];e&&e.length>0&&e.forEach(function(t){var e=h(n.get("cao.insight.contextPanel.customPreferences.definedItems"));i.push({label:n.get(e,[t[t.type].field,t.type]),field:t,valid:true})});return i}var v=5e3;this.updateListTimer=function(){r.cancel(u.cancelStartTimer);this.cancelStartTimer=r(function(){u.populateFieldRules()},v)};this.populateFieldRules=function(){c.getLearnedItems().then(function(t){var e=[];function n(t){return"define"===t.relation}function i(t){return"dislike"===t.relation}var a=t.filter(i)[0];var s=t.filter(n)[0];a&&(e=e.concat(f(a)));s&&(e=e.concat(g(s)));u.fieldRules=e})};this.removeFieldPreference=function(t){if(t.type)return c.removeDefinedItem(t.id);return c.unDislikeField(t.id)};this.reApplyDefinedField=function(t){if("dimension"===t.type)return c.applyDimensionLearning(t.dimension.field);return c.applyMeasureLearning(t.measure.field)};this.reApplyFieldPreference=function(t){if(t.type)return u.reApplyDefinedField(t);if(t.field)return c.dislikeField(t.field.name);if(t.libId)return c.dislikeLibItem(t.libId.name)};this.openGlobalModeSummaryDialog=function(){d=t.getService("luiDialog").show({template:s,input:{title:"cao.insight.contextPanel.HelpTitle",html:s,closeDialog:function t(){d.close();d=null}}})};this.isHiddenCharts=function(){return u.hiddenCharts&&"INTRO"!==u.state&&"INIT"!==u.state};function m(){return{type:"hide",isHiddenChartLearningOption:true,text:n.get("cao.insight.contextPanel.details.hideChart"),subText:n.get("cao.insight.contextPanel.details.hideChart.subtext"),chart:u.chart}}this.getDetailsForSelectedChart=function(){if(this.chart){var t=[];t=t.concat(p(this.chart.getFields()));t=t.concat(p(this.chart.getMeasures()));t=t.concat(p(this.chart.getDimensions()));t.push(m());u.detailsForChart=t}};this.hiddenChartsTitle=function(){return n.get("cao.insight.contextPanel.hiddenCharts",[u.hiddenCharts.length])};this.updateChart=function(t){u.chart=t;u.initState=true;u.hiddenCharts=[];u.chart?u.getDetailsForSelectedChart():u.populateFieldRules()};u.updateChart(o.getSelectedChart());function b(){u.getDetailsForSelectedChart()}this.openDetailsOption=function(t){u.currentDetailsOption&&u.currentDetailsOption===t?u.currentDetailsOption=null:u.currentDetailsOption=t};e.subscribe("cao/insight/selectedChartChanged",this.updateChart);e.subscribe("cao/insight/light_editing",b);e.subscribe("cao/insight/refreshPerformed",u.refreshPerformed);this.$onDestroy=function(){e.unsubscribe("cao/insight/selectedChartChanged");e.unsubscribe("cao/insight/light_editing");e.unsubscribe("cao/insight/refreshPerformed",u.refreshPerformed);u.cancelStartTimer&&r.cancel(u.cancelStartTimer)}}];var o={transclude:true,template:a,bindings:{app:"<",hiddenCharts:"<",state:"<",insightFeedback:"<",precedentsEnabled:"="},controller:r};return t.nativeComponent("qvCaoInsightsContextPanel",o)}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="cao-insights-context-panel editor">\n\t<div class="cao-insight-context-panel-header">\n\t\t<div class="title" q-translation="{{ $ctrl.chart ? \'cao.insight.contextPanel.header\' : \'cao.insight.contextPanel.global.header\' }}"></div>\n\t\t<span ng-if="!$ctrl.chart" class="lui-icon lui-icon--help lui-icon--small help-icon" ng-click="$ctrl.openGlobalModeSummaryDialog()"></span>\n\t</div>\n\t\n\t<div class="context-panel-content">\n\t\n\t\t<div ng-if="!$ctrl.chart" class="global-mode">\n\t\t\t<div ng-if="$ctrl.isHiddenCharts()" class="hidden-charts">\n\t\t\t\t<button class="hidden-charts-button" ng-click="$ctrl.viewHiddenCharts()">\n\t\t\t\t\t<span class="lui-list__aside">\n\t\t\t\t\t\t<span class="lui-icon hidden-chart-icon"></span>\t\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class="lui-list__aside text-wrapper">\n\t\t\t\t\t\t<span class="lui-list__text title" tid="cao-hidden-charts-title">{{$ctrl.hiddenChartsTitle()}}</span>\t\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class="lui-list__aside ng-scope">\n\t\t\t\t\t\t<span class="lui-icon lui-icon--small lui-icon--arrow-right icon-arrow"></span>\n\t\t\t\t\t</span>\n\t\t\t\t</button>\n\t\t\t\t<qv-cao-hidden-charts-panel on-panel-hide-action="$ctrl.handleHiddenCharts(chart)" hidden-charts="$ctrl.hiddenCharts" hidden-charts-title="$ctrl.hiddenChartsTitle()" />\n\t\t\t</div>\n\t\t\t<div ng-if="$ctrl.noLearningFound()" class="global-mode-no-learning-applied">\n\t\t\t\t<div class="no-learning-icon" />\n\t\t\t\t<p q-translation="cao.insight.contextPanel.noLearningApplied" class="no-learning-text"></p>\n\t\t\t</div>\n\t\t\t<div ng-if="$ctrl.isFieldRulesSet()" class="custom-preferences">\n\t\t\t\t<span class="lui-list__aside">\n\t\t\t\t\t<span class="lui-icon lui-icon--approve"></span>\n\t\t\t\t</span>\n\n\t\t\t\t<div class="spacing">\n\t\t\t\t\t<div class="preferences-header-title">\n\t\t\t\t\t\t<div class="title" q-translation="cao.insight.contextPanel.customPreferences.title"></div>\n\t\t\t\t\t\t<div class="sub-title" ng-if="customPreferencesToggleOn" q-translation="{{ $ctrl.isCustomPreferences ? \'properties.on\' : \'properties.off\' }}"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="switch-toggle" ng-if="customPreferencesToggleOn">\n\t\t\t\t\t\t<lui-switch x-model="customPreferencesToggle.value" tid="cao-custom-preferences-switch" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div ng-if="$ctrl.isFieldRulesEnabled()">\n\t\t\t\t<qv-cao-field-preferences ng-repeat="fieldRule in $ctrl.fieldRules" delete-rule="$ctrl.removeFieldPreference(fieldPref)" re-apply-rule="$ctrl.reApplyFieldPreference(fieldPref)" field-rule="fieldRule" update-list="$ctrl.updateListTimer()" />\n\t\t\t</div>\n\t\t</div>\n\t\t\n\t\t<div ng-if="$ctrl.chart" class="chart-mode">\n\t\t\t<div class=\'qv-panel-properties\' style="overflow: auto;">\n\t\t\t\t<qv-cao-insight-editor ng-if="$ctrl.chart" chart="$ctrl.chart" app="$ctrl.app" />\n\t\t\t</div>\n\n\t\t\t<div class="cao-accordion-panel">\n\t\t\t\t<cao-accordion-control label="cao.insight.contextPanel.details">\n\t\t\t\t\t<qv-cao-details-option ng-repeat="detail in $ctrl.detailsForChart" detail="detail" open-learning-options="$ctrl.openDetailsOption" is-learning-option-open="detail === $ctrl.currentDetailsOption" insight-feedback="$ctrl.insightFeedback"></qv-cao-details-option>\n\t\t\t\t</cao-accordion-control>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'},function(t,e){t.exports='<lui-dialog class="selection-insights-dialog" x-variant="{{::variant}}">\n\t<lui-dialog-header>\n\t\t<lui-dialog-title\n\t\t\tq-translation="cao.insight.contextPanel.HelpTitle"\n\t\t></lui-dialog-title>\n\t</lui-dialog-header>\n\t<lui-dialog-body class="q-modal-loading">\n\t\t<p q-translation="cao.insight.contextPanel.HelpText"></p>\n\t</lui-dialog-body>\n\t<lui-dialog-footer>\n\t\t<button\n\t\t\tclass="lui-button close-button"\n\t\t\tng-click="closeDialog();"\n\t\t\tq-translation="Common.Close"\n\t\t\ttid="selection-insights-dialog-help-button"\n\t\t></button>\n\t</lui-dialog-footer>\n</lui-dialog>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(951)],a=function(t,e){var n=[function(){var t=this;t.expanded=true;this.toggleExpanded=function(){t.expanded=!t.expanded}}];var i={transclude:true,template:e,bindings:{label:"@"},controller:n};return t.nativeComponent("caoAccordionControl",i)}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div ng-click="$ctrl.toggleExpanded()"  class="cao-accordion-control" ng-class="{ \'expanded\': $ctrl.expanded }">\n\t<span class="cao-accordion-control-label" q-title-translation="{{$ctrl.label}}" q-translation="{{$ctrl.label}}" />\n\t<span class="cao-accordion-expander lui-icon lui-icon--small lui-icon--arrow-right" ng-class="{ \'expanded\': $ctrl.expanded }"></span>\n</div>\n<div ng-show="$ctrl.expanded">\n\t<ng-transclude></ng-transclude>\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(953)],a=function(t,e,n){var i=["$element","$timeout",function(e,n){this.$onChanges=function(i){i.isLearningOptionOpen&&i.isLearningOptionOpen.currentValue&&n(function(){var n=t(".context-panel-content");if(n.length){var i=e.offset().top-n.offset().top;var a=e.find(".cao-details-option").height();n.scrollTop(i+a)}})}}];var a={transclude:true,template:n,bindings:{detail:"<",openLearningOptions:"<",isLearningOptionOpen:"<",insightFeedback:"<"},controller:i};return e.nativeComponent("qvCaoDetailsOption",a)}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="cao-details-option" ng-if="(!$ctrl.detail.searchMatch && $ctrl.insightFeedback) || $ctrl.detail.searchMatch">\n\t<button class="details-option-button" ng-class="{\'cao-learning-option-open\': $ctrl.isLearningOptionOpen}" ng-click="$ctrl.openLearningOptions($ctrl.detail)" ng-if="!$ctrl.detail.searchMatch && $ctrl.insightFeedback">\n\t\t<div class="detail-icon">\n\t\t\t<span class="lui-list__aside">\n\t\t\t\t<span class="lui-icon {{ !$ctrl.detail.userMatch ? \'lui-icon--analyze\' : \'lui-icon--approve\' }}"></span>\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="label-title" ng-bind-html="$ctrl.detail.text"></div>\n\t\t<div class="learning-options-toggle">\n\t\t\t<span class="lui-list__aside">\n\t\t\t\t<span class="lui-icon lui-icon--small lui-icon--more more-option" ng-class="{\'panelNotOpened\' : !$ctrl.isLearningOptionOpen}"></span>\n\t\t\t</span>\n\t\t</div>\n\t</button>\n\t<div class="details-option-item no-hover" ng-if="$ctrl.detail.searchMatch">\n\t\t<div class="detail-icon">\n\t\t\t<span class="lui-list__aside">\n\t\t\t\t<span class="lui-icon {{ !$ctrl.detail.userMatch ? \'lui-icon--analyze\' : \'lui-icon--approve\' }}"></span>\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="label-title" ng-bind-html="$ctrl.detail.text"></div>\n\t</div>\n\t<div ng-show="$ctrl.isLearningOptionOpen">\n\t\t<qv-cao-learning-option detail="$ctrl.detail" />\n\t</div>\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(196),n(955)],a=function(t,e,n,i){var a=["qvCaoLearningService",function(t){var i=this;i.learningPerformed=false;var a="field";var s="propose";var r="hide";this.getOppositeLearningOptionActionText=function(){if(i.detail&&i.detail.type)return i.detail.type===n.MEASURE?"cao.insight.contextPanel.details.learningOption.dimension":"cao.insight.contextPanel.details.learningOption.measure";return null};function o(){return i.detail.type===n.MEASURE&&!i.learningPerformed||i.detail.type===n.DIMENSION&&i.learningPerformed?t.applyDimensionLearning(i.detail.field):t.applyMeasureLearning(i.detail.field)}function l(){return i.detail.isLibItem?t.dislikeLibItem(i.detail.libItemId):t.dislikeField(i.detail.field)}function c(t){i.learningPerformed=t;e.publish("cao/insight/learningPerformed",!!t)}this.applyLearning=function(){o().then(function(t){t&&t.nodes[0]&&(i.learningQuad=t.nodes[0].id);c(a)})};this.hideChart=function(){t.hideChart(i.detail.chart).then(function(){c(r)})};this.handleNeverPropose=function(){l().then(function(){c(s)})};this.removeFieldPreference=function(e){if(e.type)return t.removeDefinedItem(e.id);return t.unDislikeField(e.id)};this.revertLearningAction=function(){if(i.detail.type&&i.detail.field&&i.learningQuad&&i.learningPerformed==a){t.removeDefinedItem(i.learningQuad);c()}else i.learningPerformed==s?t.unDislikeItem(i.detail.field).then(function(){c()}):t.unHideChart(i.detail.chart).then(function(){c()})}}];var s={template:i,bindings:{detail:"<"},controller:a};return t.nativeComponent("qvCaoLearningOption",s)}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="cao-learning-option">\n\t<p q-translation="cao.insight.contextPanel.details.learning" />\n\n\t<div ng-if="!$ctrl.detail.isHiddenChartLearningOption && !$ctrl.learningPerformed">\n\t\t<button class="lui-button learning-button" ng-click="$ctrl.applyLearning()" \n\t\t\tq-translation="{{$ctrl.getOppositeLearningOptionActionText()}}" ng-if="$ctrl.getOppositeLearningOptionActionText() && !$ctrl.detail.isLibItem"/>\n\t\t<button class="lui-button learning-button" ng-click="$ctrl.handleNeverPropose()" \n\t\t\tq-translation="cao.insight.contextPanel.details.learningOption.neverPropose" />\n\t</div>\n\n\t<div ng-if="$ctrl.detail.isHiddenChartLearningOption && !$ctrl.learningPerformed">\n\t\t<button class="lui-button learning-button" ng-click="$ctrl.hideChart()" \n\t\t\tq-translation="cao.insight.contextPanel.details.learningOption.hidechart" tid="hide-chart-button" />\n\t\t<p class="hide-subtext" q-translation="{{$ctrl.detail.subText}}" />\n\t</div>\n\n\t<div ng-if="$ctrl.learningPerformed">\n\t\t<button class="lui-button learning-button undo" ng-click="$ctrl.revertLearningAction()" \n\t\t\tq-translation="cao.insight.contextPanel.details.learningOption.undo" />\n\t</div>\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(957),n(958)],a=function(t,e,n){var i=[function(){var t=this;this.openPanel=function(){t.isPanelOpened=true};this.closePanel=function(){t.isPanelOpened=false};this.handleHiddenChart=function(n){e.publish("cao/insight/learningPerformed",!!n);return t.onPanelHideAction({chart:n})};e.subscribe("cao/insight/open_hidden_charts_panel",this.openPanel);this.$onDestroy=function(){e.unsubscribe("cao/insight/open_hidden_charts_panel")}}];var a={template:n,controller:i,bindings:{onPanelHideAction:"&",hiddenCharts:"<",hiddenChartsTitle:"<"}};return t.nativeComponent("qvCaoHiddenChartsPanel",a)}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="hidden-charts-panel" ng-class="{ \'open-panel\': $ctrl.isPanelOpened }">\n\t\t<div class="header" ng-click="$ctrl.closePanel()">\n\t\t\t<div class="header-wrapper">\n\t\t\t\t<div class="back-navigation">\n\t\t\t\t\t<span class="lui-icon back-icon  lui-icon--previous  lui-icon--small" />\n\t\t\t\t</div>\n\t\t\t\t<div class="text-wrapper">\n\t\t\t\t\t<div class="navigation-title" q-translation="cao.insight.hiddenCharts.panel.goBackTitle"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\n\t\t<div class="hidden-charts-content">\n\t\t\t<div class="spacing title">{{$ctrl.hiddenChartsTitle}}</div>\n\t\t\t<div class="spacing sub-title" q-translation="cao.insight.hiddenCharts.panel.subTitle" ng-if="$ctrl.hiddenCharts.length > 0"></div>\n\t\t\t<div class="spacing sub-title" q-translation="cao.insight.hiddenCharts.panel.subTitleNoHiddenCharts" ng-if="$ctrl.hiddenCharts.length === 0"></div>\n\t\t\t<qv-cao-hidden-charts-view chart="chart" index="$index" ng-repeat="chart in $ctrl.hiddenCharts | orderBy : \'-chart.relevance\'"\n\t\t\t\ton-hide-action="$ctrl.handleHiddenChart(chart)"></cao-hidden-charts-view>\n\t\t</div>\n\t</div>\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91),n(959),n(264),n(960)],a=function(t,e,n,i,a){var s=["$element","qvCaoRenderService","luiTooltip","luiPopover",function(t,n,s,r){var o=this;var l=[];o.popupOpen=false;o.actionIcon="view";var c=null;var u={template:i.template,controller:i.controller,input:{item:"",style:{width:"150px"}},alignTo:t.find(".hide-action-button")[0],dock:"left"};var d=500;function p(t){var e=[];t&&t.length>0&&(e=t.map(function(t){return t.field||t.libIdLabel}));return e}this.toTitleCase=function(t){if(t)return t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})};this.setFields=function(){if(o.chart){var t=[];var e=[];var n=[];t=t.concat(p(o.chart.getDimensions()));e=e.concat(p(o.chart.getMeasures()));n=n.concat(p(o.chart.getFields()));o.dimensions=t.toString();o.measures=e.toString();o.fields=n.toString()}};function h(){return o.chart.getComplexity()?o.chart.getComplexity():o.index}this.loadChart=function(){return o.chart.loadChart()};function f(t,e,n,i,a){var s={template:t,controller:e,dock:i,closeOnResize:true,alignTo:n};var c=r.show(s);l.push(c);c.closed.then(function(){o.popupOpen=false;"function"===typeof a&&a()})}this.openChartInfoPopover=function(){if(o.popupOpen){o.popupOpen=false;l=[]}else{o.popupOpen=true;var e=["$scope",function(t){t.dimensions=o.dimensions;t.measures=o.measures;t.fields=o.fields}];f(a,e,t.find(".open-chart-info-popover")[0],"bottom")}};this.$onChanges=function(){if(o.chart){n.enqueueForRender(o.loadChart,h());o.chart.refreshChartType();o.setFields()}};this.$onDestroy=function(){o.chart&&this.chart.destroyChart()};this.openTooltip=function(){setTimeout(function(){var t=o.chart.isHidden()?"cao.insight.hiddenCharts.view.unhide":"cao.insight.hiddenCharts.view.hide";u.input.item=e.get(t);c=s.show(u)},d)};this.closeTooltip=function(){setTimeout(function(){c&&c.close()},d)};this.handleHideChartAction=function(){o.closeTooltip();o.onHideAction({chart:o.chart})}}];var r={template:n,bindings:{chart:"<",index:"<",onHideAction:"&"},controller:s};return t.nativeComponent("qvCaoHiddenChartsView",r)}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="hidden-charts-view" ng-class="{ \'hidden\': !$ctrl.chart.isHidden() }">\n\t\t<div class="title-container spacing">\n\t\t\t<div class="header-title">\n\t\t\t\t<div class="title">\n\t\t\t\t\t{{ $ctrl.toTitleCase($ctrl.chart.chartType) }}\n\t\t\t\t</div>\n\t\t\t\t<div class="open-chart-info-popover" ng-click="$ctrl.openChartInfoPopover()"><span class="lui-icon lui-icon--info" /></div>\n\t\t\t</div>\n\t\t\t<div class="cao-hide-action" >\n\t\t\t\t<span class="lui-list__aside action-button-container">\n\t\t\t\t\t<span \n\t\t\t\t\t\tclass="hide-action-button" \n\t\t\t\t\t\tng-class="$ctrl.chart.isHidden() ? \'icon--view\': \'lui-icon lui-icon--back\'"\n\t\t\t\t\t\tng-click="$ctrl.handleHideChartAction()" \n\t\t\t\t\t\tng-mouseover="$ctrl.openTooltip()" \n\t\t\t\t\t\tng-mouseleave="$ctrl.closeTooltip()"\n\t\t\t\t\t/>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t\n\t\t<div class="spacing content-view">\n\t\t\t<div class="wrapper">\n\t\t\t\t<div class="image-container" ng-if="$ctrl.chart && $ctrl.chart.getState() === \'LOADING\'">\n\t\t\t\t\t<img ng-src="{{$ctrl.chart.chartTypeImageUrl}}" class="loader-image" />\n\t\t\t\t</div>\n\t\t\t\t<qv-object ng-if="$ctrl.chart && $ctrl.chart.getState() === \'LOADED\'" model="$ctrl.chart.chart.model" options="$ctrl.chart.options" object="$ctrl.chart.object" />\n\t\t\t</div>\n\t\t</div>\n</div>'},function(t,e){t.exports='<lui-popover class="cao-hidden-charts-popover">\n\t<div class="cao-hidden-charts-popover-body">\n\t\t<ul class="lui-list cao-hidden-charts-popover-list">\n\t\t\t<li class="lui-list__item cao-hidden-charts-popover-list__item" ng-if="dimensions">\n\t\t\t\t<div>\n\t\t\t\t\t<strong q-translation="Common.Dimensions"></strong>:<span>&nbsp;{{ dimensions }}</span>\n\t\t\t\t</div>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item cao-hidden-charts-popover-list__item" ng-if="measures">\n\t\t\t\t<div>\n\t\t\t\t\t<strong q-translation="Common.Measures"></strong>:<span>&nbsp;{{ measures }}</span>\n\t\t\t\t</div>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item cao-hidden-charts-popover-list__item" ng-if="fields">\n\t\t\t\t<div>\n\t\t\t\t\t<strong q-translation="Common.Fields"></strong>:<span>&nbsp;{{ fields }}</span>\n\t\t\t\t</div>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</lui-popover>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(91),n(962),n(264)],a=function(t,e,n,i,a){var s=["luiTooltip","$element",function(t,i){var s=this;var r=null;var o={template:a.template,controller:a.controller,input:{item:"",style:{width:"150px"}},alignTo:i.find(".field-rule-action-button")[0],dock:"left"};this.toggleFieldRule=function(){s.fieldRule.valid=!s.fieldRule.valid;e.publish("cao/insight/learningPerformed",true)};this.handleFieldRuleAction=function(){s.closeTooltip();s.fieldRule.valid?s.deleteRule({fieldPref:s.fieldRule.field}).then(function(){s.toggleFieldRule();s.updateList()}):s.reApplyRule({fieldPref:s.fieldRule.field}).then(function(){s.toggleFieldRule()})};this.openTooltip=function(){var e=s.fieldRule.valid?"cao.insight.contextPanel.customPreferences.remove":"cao.insight.contextPanel.customPreferences.restore";o.input.item=n.get(e);r=t.show(o)};this.closeTooltip=function(){r&&r.close()}}];var r={template:i,bindings:{fieldRule:"<",deleteRule:"&",reApplyRule:"&",updateList:"&"},controller:s};return t.nativeComponent("qvCaoFieldPreferences",r)}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="cao-field-preferences" ng-class="{ \'hidden\': !$ctrl.fieldRule.valid }">\t\n\t<div class="label-title" ng-bind-html="$ctrl.fieldRule.label" />\n\t<div class="field-rule-action-container" >\n\t\t<span class="lui-list__aside action-button-container">\n\t\t\t<span \n\t\t\t\tclass="lui-icon field-rule-action-button" \n\t\t\t\tng-class="$ctrl.fieldRule.valid ? \'lui-icon--bin\': \'lui-icon--back\'"\n\t\t\t\tng-click="$ctrl.handleFieldRuleAction()" \n\t\t\t\tng-mouseover="$ctrl.openTooltip()" \n\t\t\t\tng-mouseleave="$ctrl.closeTooltip()"\n\t\t\t/>\n\t\t</span>\n\t</div>\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(10),n(95),n(964),n(223),n(222)],a=function(t,e,n,i,a,s){var r=["$window",function(t){var i=this;i.app=null;i.isToggleContextDisabled=false;this.$onInit=function(){e.element(t).bind("resize",i.autoHidePanels);i.autoHidePanels()};this.$onChanges=function(t){i.app=t.app.currentValue;i.isContextPanelVisible=a.storageObj(i.app.id).contextPanel;i.isAssetsPanelVisible=a.storageObj(i.app.id).assetsPanel};this.autoHidePanels=function(n){var a="string"!==typeof n;var s=e.element(t).innerWidth();s<1200&&(i.isContextPanelVisible&&i.isAssetsPanelVisible&&a?i.toggleContextPanel():i.isAssetsPanelVisible&&i.isContextPanelVisible&&"assets"===n?i.toggleContextPanel():i.isAssetsPanelVisible&&i.isContextPanelVisible&&"context"===n&&i.toggleAssetsPanel())};this.getContextPanelToggleButtonTitle=function(){return i.isContextPanelVisible?"cao.insight.hideContextPanel":"cao.insight.showContextPanel"};this.getHideAssetsButtonTitle=function(){return i.isAssetsPanelVisible?"cao.insight.hideAssetsPanel":"cao.insight.showAssetsPanel"};this.contextPanelToggled=function(){i.autoHidePanels("context");s.resizeCharts(t)};this.toggleContextPanel=function(){if(!i.isToggleContextDisabled){i.isContextPanelVisible=!i.isContextPanelVisible;a.toggleContextPanel(i.app.id);n.publish("cao/insight/contextPanelToggled",i.isContextPanelVisible)}};this.disableToggleContext=function(t){i.isToggleContextDisabled=t};this.assetsPanelToggled=function(e){i.isAssetsPanelVisible=e;i.autoHidePanels("assets");s.resizeCharts(t)};this.toggleAssetsPanel=function(){i.isAssetsPanelVisible=!i.isAssetsPanelVisible;a.toggleAssetsPanel(i.app.id);n.publish("cao/insight/assetsPanelToggled",i.isAssetsPanelVisible)};n.subscribe("cao/insight/contextPanelToggled",this.contextPanelToggled);n.subscribe("cao/insight/assetsPanelToggled",this.assetsPanelToggled);n.subscribe("cao/insight/editInsightProperties",i.disableToggleContext);this.$onDestroy=function(){n.unsubscribe("cao/insight/contextPanelToggled");n.unsubscribe("cao/insight/assetsPanelToggled");n.unsubscribe("cao/insight/editInsightProperties")}}];var o={transclude:true,template:i,bindings:{app:"<",insightFeedback:"<"},controller:r};return t.nativeComponent("qvCaoInsightsBottomPanel",o)}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='\n<div class="cao-insights-bottom-panel">\n\t<div class="hide-assets-panel-container">\n\t\t<button class="bottom-panel-button" ng-class="{ \'lui-active\': $ctrl.isAssetsPanelVisible }" q-title-translation="{{$ctrl.getHideAssetsButtonTitle()}}" tid="bottom-panel-button-left"\n\t\t\tng-click="$ctrl.toggleAssetsPanel()" tabindex="0">\n\t\t\t<span class="lui-icon lui-icon--toggle-left" />\n\t\t\t<span class="label" q-translation="{{$ctrl.getHideAssetsButtonTitle()}}" />\n\t\t</button>\n\t</div>\n\t<div class="hide-insight-properties-container" ng-if="$ctrl.insightFeedback">\n\t\t<button class="bottom-panel-button" ng-class="{ \'lui-active\': $ctrl.isContextPanelVisible, \'disabled\': $ctrl.isToggleContextDisabled }" q-title-translation="{{$ctrl.getContextPanelToggleButtonTitle()}}" tid="bottom-panel-button-right" \n\t\t\tng-click="$ctrl.toggleContextPanel()" tabindex="0" ng-attr-tabindex="{{$ctrl.isToggleContextDisabled ? \'-1\' : \'0\'}}">\n\t\t\t<span class="label" q-translation="{{$ctrl.getContextPanelToggleButtonTitle()}}" />\n\t\t\t<span class="lui-icon lui-icon--toggle-right" />\n\t\t</button>\n\t</div>\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(966),n(48),n(90),n(967),n(11),n(167),n(277)],a=function(t,e,n,i,a,s){e.service("qvMultiStatePopoverService",["luiPopover",function(e){var r;function o(t,e){var n=t.which;n=t.shiftKey&&s.TAB===n?"SHIFT_TAB":n;switch(n){case s.ARROW_LEFT:case s.ARROW_UP:case"SHIFT_TAB":case s.ESCAPE:a(e).focus();t.preventDefault();break}}return{show:function a(s){var l={handleBtnKeyDown:o,getItems:function t(){return[]},autoFocus:false};s=n.extend(true,{},l,s);r=e.show({template:t,controller:i.controller,alignTo:s.alignToElement,autoFocus:s.autoFocus,input:{title:s.title,getItems:s.getItems,clear:s.clear,click:s.click,onClose:s.onClose,brightCurSel:s.brightCurSel,openTooltip:s.openTooltip,closeTooltip:s.closeTooltip,handleKeyDown:s.handleKeyDown,handleBtnKeyDown:s.handleBtnKeyDown,handlePopoverKeyDown:s.handlePopoverKeyDown,alignToElement:s.alignToElement},closeOnResize:true,dock:"top"});return r},close:function t(){r&&r.close();r=null}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<lui-popover class="lui-popover qv-multi-state-popover" ng-class="{ bright: input.brightCurSel }" tid="qv-multi-state-popover">\n\t<lui-popover-header class="lui-popover__header">\n\t\t<div class="lui-popover__title">\n\t\t\t<span ng-if="input.title && input.title.length">{{ input.title }}</span>\n\t\t\t<div class="btn-clearall">\n\t\t\t\t<lui-button \n\t\t\t\t\ttid="qv-multi-state-popover-btn-clear"\n\t\t\t\t\tclass="clear-all-btn lui-button--block"\n\t\t\t\t\tng-keydown="handleBtnKeyDown($event, input.alignToElement)" \n\t\t\t\t\tng-click="input.clear(input.getItems()[0].qField, null, $event)" \n\t\t\t\t\tng-disabled="allItemsNonClearable( input.getItems() )" \n\t\t\t\t\tq-title-translation="AlternateState.Popover.ClearAllStates">\n\t\t\t\t\t<span class="lui-button__text" q-translation="AlternateState.Popover.ClearAllStates"></span>\n\t\t\t\t</lui-button>\n\t\t\t</div>\n\t\t</div>\n\t</lui-popover-header>\t\n\t<lui-popover-body class="lui-popover__body">\n\t\t<ul class="lui-list" qva-direction x-dir-setting="{{input.direction}}">\n\t\t\t<li class="item" ng-repeat="item in input.getItems()" ng-click="input.click($event)" ng-mousemove="input.openTooltip($event, item)" ng-mouseleave="input.closeTooltip()"\n\t\t\t\ttabindex="0" ng-keydown="handleKeyDown($event, item)" aria-label="{{item.screenReaderLabel}}" ng-class="{ \'item-locked\' : item.qLocked }">\n\t\t\t\t<div class="item-container">\n\t\t\t\t\t<div ng-if="item.qLocked" class="icon-lock">\n\t\t\t\t\t\t<span class="lui-icon lui-icon--lock">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="item-component text-container" qva-direction x-dir-text="{{item.displayStateName}}">\n\t\t\t\t\t\t<div class="text">{{ item.displayStateName }}</div>\n\t\t\t\t\t\t<div class="values">{{ item.translation }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div ng-if="!( item.qLocked || item.qOneAndOnlyOne )" class="item-component remove" ng-click="input.clear(item.qField, item.stateName, $event)" q-title-translation="CurrentSelections.Remove">\n\t\t\t\t\t\t<span class="lui-icon lui-icon--remove"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<qv-state-count-bar ng-if="!item.isPlaceHolder && item.isSingleState" state-counts="item.qStateCounts"></qv-state-count-bar>\n\t\t\t</li>\n\t\t</ul>\n\t</lui-popover-body>\n</lui-popover>'},function(t,e,n){"use strict";var i,a;!(i=[n(277)],a=function(){var t={template:null,controller:["$scope","$element","$timeout",function(t,e,n){this.close=function(){i()};function i(){n(function(){t.destroyComponent();e.remove()})}t.closingDeferred.promise.then(function(e){t.input.onClose(e);i()});t.allItemsNonClearable=function(t){return!t.some(function(t){var e=!(t.qLocked||t.qOneAndOnlyOne);return e})}}]};return t}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="current-selections-item" data-tid="current-selections-item"\n\tng-mousemove="openTooltip($event, item)" ng-mouseleave="closeTooltip()" \n\tng-class="{\n\t\t\'active\' : item.qField === activeFieldName,\n\t\t\'dim\' : $parent.itemSelected && !item.active,\n\t\t\'item-locked\' : item.qLocked,\n\t\t\'locked-feedback item-animate-in\' : item.feedbackActive && item.qLocked,\n\t\t\'item-animate-out\' : (!item.feedbackActive && item.qLocked) || (!item.feedbackActive && item.qOneAndOnlyOne),\n\t\t\'single-select-feedback item-animate-in\' : item.feedbackActive && item.qOneAndOnlyOne,\n\t\t\'single-icon\': item.qOneAndOnlyOne || item.qLocked\n\t}">\n\t<div ng-class="{locked:item.qLocked}" class="text">\n\t\t<div class="text-wrap">\n\t\t\t<span ng-class="{ \'lui-icon lui-icon--lock\': item.qLocked }"></span>\n\t\t\t<span class="name" tid="selection-name">{{item.name}}</span>\n\t\t</div>\n\t\t<span class="values">\n\t\t\t<span ng-if="!item.isDefaultState">{{item.displayStateName}}:</span>\n\t\t\t<span tid="current-selection-item-text">{{item.translation}}</span>\n\t\t</span>\n\t</div>\n\t<div class="options" title=" "> \x3c!-- The empty title attribute is neeeded for screen reader not to read anchor title: \'clear selections\' --\x3e\n\t\t<div ng-if="!item.isDefaultState" class="item-component count" title="">\n\t\t\t<span class="field-states-indicator"></span>\n\t\t</div>\n\t\t<a ng-if="!currentSelectionDisabled && (!item.qLocked && !item.isPlaceHolder && !item.qOneAndOnlyOne)" ng-click="clear(item.qField, item.stateName)" class="remove" q-title-translation="CurrentSelections.Remove">\n\t\t\t<span class="lui-clear-all lui-icon lui-icon--remove"></span>\n\t\t</a>\n\t</div>\n\n\t<qv-state-count-bar ng-if="!item.isPlaceHolder && item.isSingleState" state-counts="item.qStateCounts"></qv-state-count-bar>\n</div>'},function(t,e){t.exports='<div class="qv-odag-bar" ng-class="{\'inEditMode\': inEditMode, \'inAnalysisMode\': !inEditMode, \'standAlone\': standAlone }">\n\t<div class="leftOdag" qv-pager qv-sortable-list="sortableNavPoints"> \n\t\t<div ng-if="odagNavPoints.items.length === 0" class="drag-help" ng-class="{\'inEditMode\': inEditMode}">{{waterMarkText}}</div>\n\t\t<ul class="list">\n\t\t\t<li ng-repeat="item in odagNavPoints.items track by item.id" class="odag-nav-point" ng-class="item.classList">\n\t\t\t\t<div class="nav-point-container" ng-class="{\'invalid\': item.invalid }">\n\t\t\t\t\t<div ng-if="inEditMode" class="dropArea"></div>\n\t\t\t\t\t<qv-odag-toolbar-navpoint item="item" in-edit-mode="inEditMode"></qv-odag-toolbar-navpoint>\n\t\t\t\t</div>\n\t\t\t</li> \n\t\t</ul>\n\t\t<a class="qv-pager-nav qv-pager-previous" ng-click="prevPage()" q-title-translation="Tooltip.Previous"><i class="lui-icon lui-icon--arrow-left"></i></a>\n\t\t<a class="qv-pager-nav qv-pager-next" ng-click="nextPage()" q-title-translation="Tooltip.Next"><i class="lui-icon lui-icon--arrow-right"></i></a>\t\t\n\t</div>\n </div>\t\n'},function(t,e,n){"use strict";var i,a;!(i=[n(89),n(92),n(54),n(102),n(219),n(90)],a=function(t,e,n,i,a,s){var r=e.extend("ODAGNavPoint",{properties:null,parent:null,init:function t(e){i.mixin(this);this.notification("Invalidated");this.parent=e.parent;this.properties={qInfo:{qType:"odagNavPoint"}};this.properties=s.extend(this.properties,e.properties);var a=this;this._sheetInvalidated=function(){a.parent.getProperties().then(function(t){for(var e=0;e<t.navPoints.length;e++){var i=t.navPoints[e];if(i.info.id===a.properties.info.id){if(!n.isEqual(i,n.omit(a.properties,["qInfo"]))){a.properties=s.extend(a.properties,i);a.Invalidated.emit()}break}}})};this.parent.Invalidated.bind(this._sheetInvalidated)},getLayout:function t(){var e=this;this.properties.odagLinkName=null;return a.getList(this.parent.app).then(function(t){if(t.filter(function(t){return t.properties.data.id===e.properties.odagLinkRefID}).length>0)return a.get(e.properties.odagLinkRefID,e.parent.app).then(function(t){e.properties.odagLinkName=t.properties.data.name;return e.properties});e.properties.odagLinkName="";return e.properties})},getProperties:function e(){return t.resolve(this.properties)},getEffectiveProperties:function e(){return t.resolve(this.properties)},clearSoftPatches:function t(){return},removeObject:function t(){this.parent.removeNavPoint(this.properties.info.id)},setProperties:function t(e){var n=this;this.properties=s.extend(this.properties,e);return this.parent.getProperties().then(function(t){for(var e=0;e<t.navPoints.length;e++){var i=t.navPoints[e];if(i.info.id===n.properties.info.id){var a=s.extend({},n.properties);delete a["qInfo"];t.navPoints[e]=a;break}}return n.parent.setProperties(t)})},destroy:function t(){this.parent.Invalidated.unbind(this._sheetInvalidated)}});return r}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={type:"items",component:"accordion",items:{navPointProps:{type:"items",translation:"properties.odagNavProperties",items:{general:{type:"items",grouped:true,items:{title:{type:"string",ref:"title",translation:"Common.Name",minlength:1,readOnly:function t(e,n,i){var a=i.layout;return a&&(a.permissions&&!a.permissions.update||a.qMeta&&a.qMeta.sourceObject&&a.qMeta.sourceObject.length>0)},rollbackInvalid:true}}},odagLinkInfo:{type:"items",items:{odagLinkName:{type:"string",ref:"odagLinkName",translation:"properties.odag.link.name",minlength:1,readOnly:function t(){return true},rollbackInvalid:true}}}}}}};return t}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="drag-odag-navpoint">\n\t<div class="odag-nav-point-cell" ng-class="{\'active\': item.id === selObject.id, \'popoverOpen\': popover, \'invalid\': item.invalid }" ng-style="item.style" ng-click="onODAGNavPointClicked(item)">\n\t\t<qv-progress-circle ng-if="!inEditMode && !item.invalid" class=" odag-progress-circle" percentage="rowCountPercentage"></qv-progress-circle>\n\t\t<div class="cell-name" ng-if="inEditMode || !item.invalid" title="{{item.data.title}}">{{item.data.title}}</div>\n\t\t<div class="cell-name" ng-if="!inEditMode && item.invalid " q-title-translation="odag.toolbar.navpoint.invalid" q-translation="odag.toolbar.navpoint.invalid"></div>\n\t\t<div ng-if="!inEditMode && !item.invalid" class="arrow lui-icon lui-icon--triangle-bottom"></div>\n\t\t<button ng-if="inEditMode && item.invalid" class="lui-fade-button delete-invalid-navpoint" ng-click="deleteInvalidNavPoint($event, item)">\n\t\t\t<span class="lui-fade-button__icon  lui-icon lui-icon--bin"></span>\n\t\t</button>\n\t</div>\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91),n(49),n(135),n(295),n(138),n(974),n(323),n(976),n(484)],a=function(t,e,i,a,s,r,o){var l={template:o,controller:["$scope","$element","$timeout","odagNavpointService",function(o,l,c,u){var d;var p=t.getService("qvLoader");o.odagNavpointService=u;o.loadingContent={value:true};o.showInfoPopup=false;o.generatedApps=[];o.bindings=[];o.expandedItem={item:null};o.generateAppInProgress=false;o.bindingsPass=true;o.maxGeneratedAppLimitReached=false;o.dismissedMaxGenAppMsg=false;o.dismissMaxGenAppMsgClicked=function(){o.dismissedMaxGenAppMsg=true};o.isGenerateBtnDisabled=function(){o.bindingsPass=o.bindings.filter(function(t){return false===t.bindingPassesConstraint}).length>0;return o.header.invalid||o.maxGeneratedAppLimitReached||o.bindingsPass||!o.item.rowCountPercentage||100!==o.item.rowCountPercentage||a.isSuffixInUse("noData")||o.generateAppInProgress};o.canApplySelectionsForReload=function(){o.bindingsFailed=o.bindings.filter(function(t){return false===t.bindingPassesConstraint}).length>0;return!(o.header.invalid||o.bindingsFailed||!o.item.rowCountPercentage||100!==o.item.rowCountPercentage||a.isSuffixInUse("noData")||o.generateAppInProgress)};o.infoHeader=e.get("odag.toolbar.navpoint.popup.info.header");o.circleModel={chartValue:o.item.rowCountPercentage?o.item.rowCountPercentage:0};o.$watchCollection("item.rowCountPercentageNumber",function(t){o.item.rowCountPercentage=-1===t?NaN:t;o.circleModel.chartValue=o.item.rowCountPercentage?o.item.rowCountPercentage:0});o.header={invalid:false,templateThumbnail:n.p+"img/core/static/Default_thumbnail_app.png",templateName:e.get("Common.Loading"),templateDescription:e.get("Common.Loading")};function h(){return u.updateItemHeader(o.item,o.header)}o.setSelectionState=function(){var t=o.expandedItem.item;i.getFlag("ODAG_SAAS_ENABLED")&&t&&u.getSelections(t.parentContext.app,t.requestId).then(function(t){o.expandedItemSelectionState=u.getSelectedValuesDisplayString(t,{value:false})})};o.loadGeneratedApps=function(){u.loadGeneratedApps(o.item,o.generatedApps).then(function(){o.loadingContent.value=false;o.expandedItem.item&&(o.generatedApps.some(function(t){return o.expandedItem.item.requestId===t.requestId})?o.setSelectionState():o.expandedItem.item=null);o.maxGeneratedAppLimitReached=o.generatedApps.length>=o.item.maxNumberOfApps;g()})};u.initializeBindings(o.item,o.bindings);f().then(function(){o.item.initialized.promise.then(function(){o.actualRowEstFormatted="NaN"===o.item.actualRowEst?e.get("odag.toolbar.navpoint.popup.invalid"):r.format.number(o.item.actualRowEst,{});o.maxRowExpressionCountFormatted=r.format.number(o.item.maxRowExpressionCount,{});h().finally(function(){o.loadGeneratedApps()})})});function f(){d=c(function(){p.close(true).then(function(){p.show({template:s,hugeLoader:false,mediumLoader:true,appendTo:l.find(".odag-popup-body")[0]})})},0,false);return d}function g(){c.cancel(d);d=null;p.close()}o.onApplySelections=function(){u.initializeBindings(o.item,o.bindings)};o.onNavPointInfoClicked=function(t){t.preventDefault();t.stopPropagation();o.showInfoPopup=!o.showInfoPopup};o.deleteGenAppClicked=function(t,e){t.preventDefault();t.stopPropagation();o.showInfoPopup&&(o.showInfoPopup=!o.showInfoPopup);if(e.deleteIcon&&!e.actionInProgress){e.actionInProgress=true;u.deleteGeneratedApp(e).then(function(){o.loadGeneratedApps();o.expandedItem.item&&e.requestId===o.expandedItem.item.requestId&&(o.expandedItem.item=null);e.actionInProgress=false}).catch(function(t){e.actionInProgress=false;throw t})}};o.reloadApp=function(t,e){o.generateAppInProgress=true;u.reloadApp(o.item,t.requestId,e).then(function(){2===e&&(o.expandedItem.item=null);o.loadGeneratedApps();o.generateAppInProgress=false}).catch(function(t){o.generateAppInProgress=false;throw t})};o.onGenerateAppClicked=function(){o.generateAppInProgress=true;o.showInfoPopup=false;u.generateApp(o.item).then(function(){o.generateAppInProgress=false;o.loadGeneratedApps()}).catch(function(t){o.generateAppInProgress=false;throw t})};o.$on("$destroy",function(){u.stopLoadGeneratedApps(o.item);g()})}]};return l}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<lui-popover id="odag-toolbar-navpoint-popover" ng-class="expandedItem.item? \' request-expanded\' : \'\'" class="odag-toolbar-navpoint-popover"\n x-arrow="arrow">\n\t<lui-popover-header ng-class="{\'invalid\': header.invalid}">\n\t\t<img qva-prevent-drag ng-src="{{ header.imgSrc }}" class="app-thumbnail-img" />\n\t\t<div class="title-description-container">\n\t\t\t<lui-popover-title title="{{header.templateName}}">{{header.templateName}}</lui-popover-title>\n\t\t\t<lui-popover-title ng-if="!header.invalid" class="desciption" title="{{header.templateDescription}}">{{header.templateDescription}}</lui-popover-title>\n\t\t</div>\n\t</lui-popover-header>\n\n\t<lui-popover-body class="odag-popup-body" qva-outside-ignore-for="odag-request-menu">\n\t\t<odag-app-list2 class="odag-app-list-container" applist="generatedApps" reload-app="reloadApp" load-generated-apps="loadGeneratedApps" set-selection-state="setSelectionState"\n\t\t generate-app-in-progress="generateAppInProgress" expanded-item="expandedItem" is-header-invalid="header.invalid" is-generate-btn-disabled="isGenerateBtnDisabled"\n\t\t can-apply-selections-for-reload="canApplySelectionsForReload" expanded-item-selection-state="expandedItemSelectionState"\n\t\t loading="loadingContent.value" delete-clicked="deleteGenAppClicked" on-apply-selections-callback="onApplySelections" open-app-callback="item.openAppCallback"></odag-app-list2>\n\t\t<div ng-if="maxGeneratedAppLimitReached && !dismissedMaxGenAppMsg && !expandedItem.item" class="odag-max-app-limit-reached">\n\t\t\t<div class="max-app-text" q-translation="odag.toolbar.napvoint.popup.maxAppLimitReached"></div>\n\t\t\t<button class="lui-fade-button close-button" q-title-translation="Common.Close" ng-click="dismissMaxGenAppMsgClicked()">\n\t\t\t\t<span class="lui-button__icon  lui-icon lui-icon--small  lui-icon--close"></span>\n\t\t\t</button>\n\t\t</div>\n\t</lui-popover-body>\n\t<div ng-if="showInfoPopup" class="infoPopup">\n\t\t<div class="info-constraints-header">{{infoHeader}}</div>\n\t\t<div class="info-row-count-container">\n\t\t\t<div class="info-section" q-translation="odag.toolbar.navpoint.popup.info.row.count.header"></div>\n\t\t\t<div class="info-row-count-content">\n\t\t\t\t<div class="info-row-count-progress-circle">\n\t\t\t\t\t<circle-chart model=\'circleModel\'></circle-chart>\n\t\t\t\t</div>\n\t\t\t\t<div class="info-row-count-current">\n\t\t\t\t\t<div class="info-row-count-header" q-translation="odag.toolbar.navpoint.popup.info.row.count.current.header"></div>\n\t\t\t\t\t<div class="">{{actualRowEstFormatted}}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="info-row-count-constraint">\n\t\t\t\t\t<div class="info-row-count-header" q-translation="odag.toolbar.navpoint.popup.info.row.count.constraint.header"></div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t< {{maxRowExpressionCountFormatted}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="info-section" q-translation="odag.toolbar.navpoint.popup.info.field.header"></div>\n\t\t\t<div class="info-field-header">\n\t\t\t\t<div class="info-field" q-translation="odag.toolbar.navpoint.popup.info.field.table.header"></div>\n\t\t\t\t<div class="info-value" q-translation="odag.toolbar.navpoint.popup.info.current.table.header"></div>\n\t\t\t\t<div class="info-constraint" q-translation="odag.toolbar.navpoint.popup.info.constraint.table.header"></div>\n\t\t\t</div>\n\t\t\t<div class="info-field-values">\n\t\t\t\t<div ng-repeat="binding in bindings | orderBy: \'-hasConstraint\' " class="info-field-row" ng-if="bindings.length">\n\t\t\t\t\t<div class="info-field-data">{{binding.fieldName}}</div>\n\t\t\t\t\t\n\t\t\t\t\t<div class="info-value-data">\n\t\t\t\t\t\t<div class="info-field-checkmark" ng-if="binding.bindingPassesConstraint">\n\t\t\t\t\t\t\t<span class="lui-icon  lui-icon--tick" aria-hidden="true"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="info-field-warning" ng-if="!binding.bindingPassesConstraint">\n\t\t\t\t\t\t\t<span class="lui-icon  lui-icon--warning-triangle" aria-hidden="true"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-if="binding.hasConstraint">{{binding.values.length}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<div class="info-constraint-data">{{binding.constraint}}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<lui-popover-footer>\n\t\t<lui-button ng-if="!expandedItem.item" class="info-button" ng-class="{\'lui-button--danger\': bindingsPass, \'lui-active\': showInfoPopup}"\n\t\t x-variant="fade" ng-click="onNavPointInfoClicked($event)">\n\t\t\t<span class="lui-icon  lui-button__icon lui-icon--info"></span>\n\t\t</lui-button>\n\t\t<lui-button ng-if="!expandedItem.item" tid="odag-toolbar-navpoint-popover_generate_app_button" ng-disabled="isGenerateBtnDisabled()"\n\t\t ng-click="onGenerateAppClicked()" q-translation="odag.toolbar.navpoint.popup.generate.app"></lui-button>\n\t</lui-popover-footer>\n</lui-popover>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(380),n(138),n(460),n(91),n(49)],a=function(t,e,n,i,a,s){t.service("odagNavpointServiceUI",["$timeout",function(t){var r;function o(t,e){e.value=true;for(var n=0;n<t.length;n++){var i="";var s=t[n];if(s.selectedSize>1e4){e.value=false;i=a.get("odag.toolbar.navpoint.popup.request.tab.xNumSelectedValues",s.selectedSize);s.valuesDisplayString=i}else{var r=0;for(;r<s.values.length&&r<5;r++){r>0&&(i+=", ");i+=s.values[r].strValue}5===r&&s.values.length>5&&(i+=a.get("odag.toolbar.navpoint.popup.request.tab.moreSelectedValues",[s.values.length-5+""]));s.valuesDisplayString=i}}return t}function l(t,i){var r=new Date(t.modifiedDate);var l=s.getFlag("ODAG_SAAS_ENABLED");function c(t){var e="";if(Intl&&Intl.DateTimeFormat){var i={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"};e=Intl.DateTimeFormat(n.locale.get(),i).format(t)}else e=n.format.date(t,{datetime:"medium"});return e}var u=c(r);var d=null;if(t.loadState&&t.loadState.finishedAt&&"pending"!==t.loadState.status){var p=new Date(t.loadState.finishedAt);d=c(p)}var h="";var f=false;var g="";var v="lui-icon--bin";var m=a.get("odag.toolbar.navpoint.popup.tooltip.delete");var b=[];var y=[];var S=[];g=t.generatedAppOrigName?t.generatedAppOrigName:"";t.generatedApp&&t.generatedApp.name&&(g=t.generatedApp.name);t.validation&&t.validation.contents&&t.validation.contents.forEach(function(t){b.push({id:b.length,message:t});y.push({id:y.length,message:t})});if(!l&&t.loadState&&t.loadState.messages&&t.loadState.messages.progressData){t.loadState.messages.progressData.persistentProgressMessages&&t.loadState.messages.progressData.persistentProgressMessages.forEach(function(t){y.push({id:y.length,message:e.translateMessage(t)})});t.loadState.messages.progressData.transientProgressMessage&&y.push({id:y.length,message:e.translateMessage(t.loadState.messages.progressData.transientProgressMessage)});t.loadState.messages.progressData.errorData&&t.loadState.messages.progressData.errorData.forEach(function(t){S.push({id:S.length,message:t.qErrorString})})}l&&S.push({id:y.length,message:t.errorMessage});switch(t.state){case"validating":case"queued":case"loading":case"canceling":f=true;h="";g=g||a.get("odag.toolbar.navpoint.popup.status.generating");v="lui-icon--remove";m=a.get("odag.toolbar.navpoint.popup.tooltip.cancel");if("canceling"==t.state){v="";u=a.get("odag.toolbar.navpoint.popup.status.canceling");d=u;m=""}break;case"failed":h="warning";g=g||a.get("odag.toolbar.navpoint.popup.status.failed");v="lui-icon--remove";m=a.get("odag.toolbar.navpoint.popup.tooltip.remove");break;case"canceled":h="";v="lui-icon--remove";m=a.get("odag.toolbar.navpoint.popup.tooltip.remove");break;case"succeeded":h="";g=t.generatedApp?t.generatedApp.name:"";v="lui-icon--bin";m=a.get("odag.toolbar.navpoint.popup.tooltip.delete");break}var x={value:false};t.selectionState&&o(t.selectionState,x);var q={name:g,createdDate:t.createdDate,requestId:t.id,owner:t.owner,lastLoadedTime:d,generatedAppId:t.generatedApp?t.generatedApp.id:null,published:!!t.generatedApp&&t.generatedApp.published,publishToStreamName:t.publishToStreamName?t.publishToStreamName:a.get("odag.toolbar.navpoint.popup.request.tab.info.notPublished"),targetSheet:t.targetSheet,timestamp:u,status:h,state:t.state,loading:f,parentContext:i,deleteIcon:v,deleteIconTooltip:m,actionInProgress:false,statusMessageArray:y,selectionsState:t.selectionState,canApplySelections:x.value,progressErrors:S};return q}function c(e){var n=new Image;var a=e.templateThumbnail;if(a){n.src=a;n.onerror=function(){e.imgSrc=i.staticSrc().staticApp()};n.onload=function(){t(function(){e.imgSrc=a})}}}r={createGeneratedAppWrapper:l,updateImageOnItemHeader:c,getSelectedValuesDisplayString:o};return r}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(11),n(91),n(49),n(13),n(316),n(977),n(978),n(979),n(323)],a=function(t,e,n,i,a,s,r,o,l){t.nativeComponent("odagAppList2",{bindings:{applist:"<",loading:"<",deleteClicked:"<",isGenerateBtnDisabled:"<",canApplySelectionsForReload:"<",isHeaderInvalid:"<",loadGeneratedApps:"<",setSelectionState:"<",expandedItemSelectionState:"<",onApplySelectionsCallback:"<",openAppCallback:"<",reloadApp:"<",generateAppInProgress:"=",expandedItem:"=",variant:"@"},controller:["$element","$timeout","luiPopover","odagNavpointService",function(t,l,c,u){var d=this;d.helpTextNoGeneratedApps=n.get("odag.toolbar.navpoint.popup.noApps");d.selectedTab="info";d.moreMenuPopup=null;d.moreMenuPopupItem=null;d.reloadMenuPopup=null;d.inputName="";d.appNameValid=true;d.applyInProgress=false;d.isOdagSaas=i.getFlag("ODAG_SAAS_ENABLED");d.openAppClicked=function(t,n,i){n.preventDefault();n.stopPropagation();if(t.openAppCallback&&e.isFunction(t.openAppCallback))t.openAppCallback(i.generatedAppId,i.targetSheet?i.targetSheet:null);else if(i.generatedAppId&&u.ODAG_TERMINAL_STATES.indexOf(i.state)>-1){var s;s=i.targetSheet?a.rootPath+"sense/app/"+i.generatedAppId+"/sheet/"+i.targetSheet:a.rootPath+"sense/app/"+i.generatedAppId;window.open(s)}};d.renameGenApp=function(t,e){u.renameGenApp(d.expandedItem.item.parentContext.app,t,e).then(function(){d.loadGeneratedApps()})};d.applySelectionsClicked=function(t){d.applyInProgress=true;u.applySelections(t).then(function(){d.onApplySelectionsCallback&&d.onApplySelectionsCallback();d.applyInProgress=false})};d.$doCheck=function(){var t=this;if(this.applist&&this.expandedItem.item){var e=this.applist.filter(function(e){return e.requestId===t.expandedItem.item.requestId})[0];if(e){this.expandedItem.item=e;if(this.expandedItemSelectionState&&this.isOdagSaas){this.expandedItem.item.selectionsState=this.expandedItemSelectionState;this.expandedItem.item.canApplySelections=true}}else this.expandedItem.item=null}d.expandedItem&&d.expandedItem.item&&d.requestInProgress(this.expandedItem.item)&&d.applist.some(function(t){if(t.requestId===d.expandedItem.item.requestId&&t.name===d.expandedItem.item.name&&d.inputName!==t.name){d.inputName=t.name;return true}return false})};d.moreMenuClicked=function(t,e){t.preventDefault();t.stopPropagation();if(d.moreMenuPopup)d.moreMenuPopup.close();else{d.moreMenuPopupItem=e;d.moreMenuPopup=c.show({template:r,alignTo:t.target,variant:null,controller:["$scope",function(t){t.canOpenApp=function(){return e.generatedAppId&&u.ODAG_TERMINAL_STATES.indexOf(e.state)>-1};t.openApp=function(n){if(t.canOpenApp()){d.moreMenuPopup.close();d.openAppClicked(d,n,e)}};t.canReloadApp=function(){return d.canReloadApp(e)};t.reloadApp=function(n){n.preventDefault();n.stopPropagation();if(t.canReloadApp()){d.moreMenuPopup.close();return d.reloadApp(e)}};t.deleteApp=function(t){t.preventDefault();t.stopPropagation();d.moreMenuPopup.close();d.deleteClicked(t,e)}}],closeOnResize:true,closeOnEscape:true});d.moreMenuPopup.closed.then(function(){d.moreMenuPopup=null;d.moreMenuPopupItem=null})}};d.onOutsideClick=function(){d.expandedItem.item=null};d.rowClicked=function(t){d.moreMenuPopup&&d.moreMenuPopup.close();d.reloadMenuPopup&&d.reloadMenuPopup.close();d.expandedItem.item=t;if(d.expandedItem.item){d.inputName=d.expandedItem.item.name;d.setSelectionState()}};d.reloadClicked=function(t,e){t.preventDefault();t.stopPropagation();d.reloadApp(e)};d.requestInProgress=function(t){var e=false;switch(t.state){case u.ODAG_STATE.VALIDATING:case u.ODAG_STATE.QUEUED:case u.ODAG_STATE.LOADING:case u.ODAG_STATE.CANCELING:e=true;break}return e};d.canReloadApp=function(t){var e=true;e=t&&!d.isHeaderInvalid&&!d.generateAppInProgress&&!d.requestInProgress(t);return e};d.validateAppName=function(){var t=true;d.inputName&&s.allowedChars(d.inputName)||(t=false);d.appNameValid=t};d.statusClicked=function(t,e){t.preventDefault();t.stopPropagation();d.moreMenuPopup&&d.moreMenuPopup.close();d.reloadMenuPopup&&d.reloadMenuPopup.close();if(d.expandedItem.item===e)d.expandedItem.item=null;else{d.selectedTab="status";d.expandedItem.item=e;d.scrollIfNecessary()}};d.selectTab=function(t){d.selectedTab=t;d.scrollIfNecessary()};d.inputKeyEnter=function(t){var e=t.target;e.blur()};d.onBlurGenAppName=function(){if(d.appNameValid)d.renameGenApp(d.expandedItem.item.requestId,d.inputName);else{d.inputName=d.expandedItem.item.name;d.validateAppName()}};d.scrollIfNecessary=function(){"status"===d.selectedTab&&l(function(){var n=e(t.find(".tab-contents"));n.scrollTop(n[0].scrollHeight)})};d.onReloadMenuClicked=function(t,e){t.preventDefault();t.stopPropagation();if(d.reloadMenuPopup)d.reloadMenuPopup.close();else{d.reloadMenuPopup=c.show({template:o,alignTo:t.target,variant:null,controller:["$scope",function(t){t.canReloadApp=function(){return d.canReloadApp(e)};t.reloadApp=function(n){n.preventDefault();n.stopPropagation();if(t.canReloadApp()){d.reloadMenuPopup.close();return d.reloadApp(e)}};t.canApplySelectionsReloadApp=function(){return d.canApplySelectionsForReload()};t.canCopyApplySelectionsReloadApp=function(){return!d.isGenerateBtnDisabled()};t.applySelectionsReloadApp=function(n){n.preventDefault();n.stopPropagation();if(t.canApplySelectionsReloadApp()){d.reloadMenuPopup.close();d.reloadApp(e,1)}};t.copyApplySelectionsReloadApp=function(n){n.preventDefault();n.stopPropagation();if(t.canApplySelectionsReloadApp()){d.reloadMenuPopup.close();d.reloadApp(e,2)}}}],closeOnResize:true,closeOnEscape:true});d.reloadMenuPopup.closed.then(function(){d.reloadMenuPopup=null})}}}],template:l})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<lui-popover x-variant="{{::variant}}" x-arrow="arrow" qva-outside-ignore-for="allOutside">\n\t<lui-popover-body class="lui-nopad">\n\t\t<ul class="lui-list odag-request-menu" tid="odag-request-menu">\n\t\t\t<li class="lui-list__item" style="cursor: pointer" ng-disabled="!canOpenApp()" ng-click="openApp( $event )" tid="openAppFromMenu">\n\t\t\t\t<span class="lui-list__text lui-list__action"\n\t\t\t\t\tq-translation="odag.toolbar.navpoint.popup.request.menu.openApp">\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item" style="cursor: pointer" ng-disabled="!canReloadApp()" ng-click="reloadApp( $event )" tid="reloadFromRequestMenu">\n\t\t\t\t<span class="lui-list__text lui-list__action"\n\t\t\t\t\tq-translation="odag.toolbar.navpoint.popup.request.reload">\n\t\t\t\t</span>\n\t\t\t</li>\t\t\t\n\t\t\t<li class="lui-list__item" style="cursor: pointer" ng-click="deleteApp( $event )" tid="deleteAppFromMenu">\n\t\t\t\t<span class="lui-list__text lui-list__action"\n\t\t\t\t\tq-translation="odag.toolbar.navpoint.popup.request.menu.deleteApp">\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t</ul>\n\t</lui-popover-body>\n</lui-popover>'},function(t,e){t.exports='<lui-popover x-variant="{{::variant}}" x-arrow="arrow" qva-outside-ignore-for="allOutside">\n\t<lui-popover-body class="lui-nopad">\n\t\t<ul class="lui-list odag-request-menu" tid="odag-request-reload-menu">\n\t\t\t<li class="lui-list__item" style="cursor: pointer" ng-disabled="!canReloadApp()" ng-click="reloadApp( $event )" tid="reloadFromMenu">\n\t\t\t\t<span class="lui-list__text lui-list__action"\n\t\t\t\t\tq-translation="odag.toolbar.navpoint.popup.request.reload">\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item" style="cursor: pointer" ng-disabled="!canApplySelectionsReloadApp()" ng-click="applySelectionsReloadApp( $event )" tid="applySelectionsReloadFromMenu">\n\t\t\t\t<span class="lui-list__text lui-list__action"\n\t\t\t\t\tq-translation="odag.toolbar.navpoint.popup.request.applySelections.reload">\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item" style="cursor: pointer" ng-disabled="!canCopyApplySelectionsReloadApp()" ng-click="copyApplySelectionsReloadApp( $event )" tid="copyApplySelectionsReloadFromMenu">\n\t\t\t\t<span class="lui-list__text lui-list__action"\n\t\t\t\t\tq-translation="odag.toolbar.navpoint.popup.request.copyAndApplySelections.reload">\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t</ul>\n\t</lui-popover-body>\n</lui-popover>'},function(t,e){t.exports='<div class="odag-app-list2" ng-class="$ctrl.variant">\n\t<div ng-if="$ctrl.applist.length === 0 && !$ctrl.loading" class="description">{{$ctrl.helpTextNoGeneratedApps}}</div>\n\t<ul ng-if="$ctrl.applist.length && !$ctrl.loading && !$ctrl.expandedItem.item" class="generated-apps-list">\n\t\t<li ng-repeat="genAppitem in $ctrl.applist" class="list-item" ng-click="$ctrl.rowClicked(genAppitem)">\n\t\t\t<div class="generated-app-item request-header">\n\t\t\t\t<div class="request-first">\n\t\t\t\t\t<div class="expander lui-icon lui-icon--triangle-right"></div>\n\t\t\t\t\t<div class="request-name-timestamp-area">\n\t\t\t\t\t\t<div class="request-first-top-line">\t\t\t\t\t\t\n\t\t\t\t\t\t\t<div class="name" title="{{genAppitem.name}}" ng-class="{\'generating\': genAppitem.state === \'validating\' || genAppitem.state === \'queued\' || genAppitem.state === \'loading\' || genAppitem.state === \'canceling\'}">{{genAppitem.name}}</div>\n\t\t\t\t\t\t</div>\t\n\t\t\t\t\t\t<div class="request-first-bottom-line timestamp">{{genAppitem.lastLoadedTime ? genAppitem.lastLoadedTime : genAppitem.timestamp }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="request-second">\n\t\t\t\t\t<button class="status-button lui-fade-button" qva-outside-ignore-for="allOutside" ng-click="$ctrl.statusClicked($event, genAppitem)">\n\t\t\t\t\t\t<span ng-hide="genAppitem.loading" class="lui-fade-button__icon lui-icon lui-icon--{{genAppitem.status}}"></span>\n\t\t\t\t\t\t<div ng-if="genAppitem.loading" class="genAppLoading qv-loader"></div>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button ng-if="genAppitem.state === \'validating\' || genAppitem.state === \'queued\' || genAppitem.state === \'loading\'" class="lui-fade-button" title={{genAppitem.deleteIconTooltip}} ng-click="$ctrl.deleteClicked($event, genAppitem)">\n\t\t\t\t\t  <span class="lui-fade-button__icon  lui-icon lui-icon--remove"></span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button ng-if="!$ctrl.requestInProgress( genAppitem )" class="lui-fade-button" q-title-translation="odag.toolbar.navpoint.popup.request.moreMenu.tooltip" ng-click="$ctrl.moreMenuClicked($event, genAppitem)" ng-class="{\'lui-active\': $ctrl.moreMenuPopupItem === genAppitem}">\n\t\t\t\t\t  <span class="lui-fade-button__icon  lui-icon lui-icon--more"></span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button ng-if="!$ctrl.requestInProgress( genAppitem )" ng-disabled="!(genAppitem.state === \'succeeded\' || genAppitem.state === \'failed\' || genAppitem.state === \'canceled\') || !genAppitem.generatedAppId" class="lui-fade-button" q-title-translation="{{ $ctrl.openAppCallback ? \'odag.toolbar.navpoint.popup.request.openApp.generic.tooltip\' : \'odag.toolbar.navpoint.popup.request.openApp.tooltip\'}}" ng-click="$ctrl.openAppClicked($ctrl, $event, genAppitem)">\n\t\t\t\t\t  <span class="lui-fade-button__icon  lui-icon lui-icon--new-tab"></span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\t\t\t\n\t\t</li>\n\t</ul>\n\t<div ng-if="$ctrl.expandedItem.item" class="gen-item-expand" qva-outside="$ctrl.onOutsideClick( $event )">\n\t\t<div class="details-container">\n\t\t\t<div class="request-header" ng-click="$ctrl.rowClicked(null)">\n\t\t\t\t<div class="request-first">\n\t\t\t\t\t<div class="expander lui-icon lui-icon--triangle-bottom" tid="odag-applist-expand"></div>\n\t\t\t\t\t<div class="request-name-timestamp-area">\n\t\t\t\t\t\t<div class="request-first-top-line">\n\t\t\t\t\t\t\t<div class="name" title="{{$ctrl.expandedItem.item.name}}" ng-class="{\'generating\': $ctrl.expandedItem.item.state === \'validating\' || $ctrl.expandedItem.item.state === \'queued\' || $ctrl.expandedItem.item.state === \'loading\' || $ctrl.expandedItem.item.state === \'canceling\'}">{{$ctrl.expandedItem.item.name}}</div>\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="request-first-bottom-line timestamp" >{{$ctrl.expandedItem.item.lastLoadedTime ? $ctrl.expandedItem.item.lastLoadedTime : $ctrl.expandedItem.item.timestamp }}</div>\n\t\t\t\t\t</div>\t\t\t\t\n\t\t\t\t</div>\n\t\t\t\t<div class="request-second">\n\t\t\t\t\t<button class="status-button lui-fade-button" qva-outside-ignore-for="allOutside" ng-click="$ctrl.statusClicked($event, $ctrl.expandedItem.item)">\n\t\t\t\t\t\t<span ng-if="!$ctrl.expandedItem.item.loading" class="lui-fade-button__icon lui-icon lui-icon--{{$ctrl.expandedItem.item.status}}"></span>\n\t\t\t\t\t\t<div ng-if="$ctrl.expandedItem.item.loading" class="genAppLoading qv-loader"></div>\n\t\t\t\t\t</button>\t\t\t\t\t\t\t\t\n\t\t\t\t\t<button ng-if="$ctrl.expandedItem.item.state === \'validating\' || $ctrl.expandedItem.item.state === \'queued\' || $ctrl.expandedItem.item.state === \'loading\'" class="lui-fade-button" title={{$ctrl.expandedItem.item.deleteIconTooltip}} ng-click="$ctrl.deleteClicked($event, $ctrl.expandedItem.item)">\n\t\t\t\t\t  <span class="lui-fade-button__icon  lui-icon lui-icon--remove"></span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button ng-if="$ctrl.expandedItem.item.state === \'succeeded\' || $ctrl.expandedItem.item.state === \'failed\' || $ctrl.expandedItem.item.state === \'canceled\'" class="lui-fade-button" q-title-translation="{{ $ctrl.openAppCallback ? \'odag.toolbar.navpoint.popup.request.openApp.generic.tooltip\' : \'odag.toolbar.navpoint.popup.request.openApp.tooltip\'}}" ng-disabled="!($ctrl.expandedItem.item.state === \'succeeded\' || $ctrl.expandedItem.item.state === \'failed\' || $ctrl.expandedItem.item.state === \'canceled\') || !$ctrl.expandedItem.item.generatedAppId" ng-click="$ctrl.openAppClicked($ctrl, $event, $ctrl.expandedItem.item)">\n\t\t\t\t\t  <span class="lui-fade-button__icon  lui-icon lui-icon--new-tab"></span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\t\n\t\t\t</div>\n\t\t\t<div class="generateAppInput">\n\t\t\t\t<input class="lui-input" ng-disabled="$ctrl.generateAppInProgress || !$ctrl.expandedItem.item.generatedAppId || $ctrl.expandedItem.item.state === \'queued\' || $ctrl.expandedItem.item.state === \'loading\' || $ctrl.expandedItem.item.state === \'validating\' || $ctrl.expandedItem.item.state === \'canceling\'" ng-model="$ctrl.inputName" type="text" name="name" maxlength="255" ng-blur="$ctrl.onBlurGenAppName()" ng-change="$ctrl.validateAppName()" qv-enter="$ctrl.inputKeyEnter($event)" ng-class="{ \'lui-invalid\': !$ctrl.appNameValid }"/>\n\t\t\t</div>\n\t\t\t<div class="action-button-section">\n\t\t\t\t<div class="lui-buttongroup reload-button">\n\t\t\t\t\t<lui-button ng-disabled="!$ctrl.canReloadApp( $ctrl.expandedItem.item )" ng-click="$ctrl.reloadClicked($event, $ctrl.expandedItem.item)" q-translation="odag.toolbar.navpoint.popup.request.reload"></lui-button>\n\t\t\t\t\t<lui-button ng-disabled="!$ctrl.canReloadApp( $ctrl.expandedItem.item ) " class= "reload-drop" tid="odag-reload-dropdown"\n ng-click="$ctrl.onReloadMenuClicked( $event, $ctrl.expandedItem.item )">\n\t\t\t\t\t\t<span class="lui-icon lui-caret"></span>\t\t\t\t\t\t\n\t\t\t\t\t</lui-button>\n\t\t\t\t</div>\n\t\t\t\t<lui-button ng-disabled="$ctrl.expandedItem.item.state !== \'succeeded\' && $ctrl.expandedItem.item.state !== \'failed\' && $ctrl.expandedItem.item.state !== \'canceled\' " tid="odag-applist-delete-app" class="delete-button" ng-click="$ctrl.deleteClicked($event, $ctrl.expandedItem.item)" ><span class="lui-icon  lui-button__icon lui-icon--bin"></span></lui-button>\n\t\t\t</div>\n\n\t\t\t<div class="tab-section">\n\t\t\t\t<div class="tab-header">\n\t\t\t\t\t<ul class="lui-tabset lui-tabset--fill">\n\t\t\t\t\t\t<li class="lui-tab" tabindex="0" ng-class="{\'lui-active\': $ctrl.selectedTab === \'info\' }" ng-click="$ctrl.selectTab(\'info\')">\n\t\t\t\t\t\t\t<span class="lui-tab__text tab-label" q-translation="odag.toolbar.navpoint.popup.request.tab.info"></span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class="lui-tab" tabindex="0" ng-class="{\'lui-active\': $ctrl.selectedTab === \'selections\' }" ng-click="$ctrl.selectTab(\'selections\')">\n\t\t\t\t\t\t\t<span class="lui-tab__text tab-label" q-translation="odag.toolbar.navpoint.popup.request.tab.selections"></span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class="lui-tab" tabindex="0" ng-class="{\'lui-active\': $ctrl.selectedTab === \'status\' }" ng-click="$ctrl.selectTab(\'status\')">\n\t\t\t\t\t\t\t<span class="lui-tab__text tab-label" q-translation="odag.toolbar.navpoint.popup.request.tab.status"></span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t\t<div class="tab-contents">\n\t\t\t\t\t<div class="tab-content selection-tab" ng-if="$ctrl.selectedTab === \'selections\'">\n\t\t\t\t\t\t<div class="info-section selection-tab-top">\n\t\t\t\t\t\t\t<div class="info-text" q-translation="odag.toolbar.navpoint.popup.request.tab.selections.helpText"></div>\n\t\t\t\t\t\t\t<div class="apply-selections-button">\n\t\t\t\t\t\t\t\t<lui-button ng-disabled="($ctrl.expandedItem.item.state !== \'succeeded\' && $ctrl.expandedItem.item.state !== \'failed\' && $ctrl.expandedItem.item.state !== \'canceled\') || $ctrl.applyInProgress" ng-if="$ctrl.expandedItem.item.canApplySelections" ng-click="$ctrl.applySelectionsClicked($ctrl.expandedItem.item)" q-translation="Common.Apply"></lui-button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="selections-field-header">\n\t\t\t\t\t\t\t<div class="selections-field" q-translation="odag.toolbar.navpoint.popup.request.tab.selections.field"></div>\n\t\t\t\t\t\t\t<div class="selections-value" q-translation="odag.toolbar.navpoint.popup.request.tab.selections.values"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="selections-field-values">\n\t\t\t\t\t\t\t<div ng-if="$ctrl.expandedItem.item.selectionsState && $ctrl.expandedItem.item.selectionsState.length" ng-repeat="selection in $ctrl.expandedItem.item.selectionsState" class="selections-field-row">\n\t\t\t\t\t\t\t\t<div class="selections-field-data">{{selection.selectionAppParamName}}</div>\n\t\t\t\t\t\t\t\t<div class="selections-value-data">{{selection.valuesDisplayString}}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div ng-if="!$ctrl.expandedItem.item.selectionsState" q-translation="odag.toolbar.navpoint.popup.request.tab.noSelectedValues"> </div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="selections-no-selections" ng-if="$ctrl.expandedItem.item.selectionsState && $ctrl.expandedItem.item.selectionsState.length === 0" q-translation="odag.toolbar.navpoint.popup.request.tab.selections.noselections" >\n\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="tab-content" ng-if="$ctrl.selectedTab === \'info\'">\n\t\t\t\t\t\t<div class="info-section">\n\t\t\t\t\t\t\t<div class="info-section-label" q-translation="odag.toolbar.navpoint.popup.request.tab.info.status"></div>\n\t\t\t\t\t\t\t<div class="info-section-value" q-translation="odag.toolbar.navpoint.popup.request.tab.status.{{$ctrl.expandedItem.item.state}}"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="info-section">\n\t\t\t\t\t\t\t<div class="info-section-label" q-translation="odag.toolbar.navpoint.popup.request.tab.info.appOwner"></div>\n\t\t\t\t\t\t\t<div ng-if="!$ctrl.isOdagSaas" class="info-section-value">{{$ctrl.expandedItem.item.owner.userDirectory}}\\{{$ctrl.expandedItem.item.owner.userId}} ({{$ctrl.expandedItem.item.owner.name}})</div>\n\t\t\t\t\t\t\t<div ng-if="$ctrl.isOdagSaas" class="info-section-value">({{$ctrl.expandedItem.item.owner.name}})</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="info-section" ng-if="!$ctrl.isOdagSaas">\n\t\t\t\t\t\t\t<div class="info-section-label" q-translation="odag.toolbar.navpoint.popup.request.tab.info.publishToStream"></div>\n\t\t\t\t\t\t\t<div class="info-section-value"> {{$ctrl.expandedItem.item.publishToStreamName}} </div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="tab-content odag-request-status-content" ng-if="$ctrl.selectedTab === \'status\'">\n\t\t\t\t\t\t<div class="info-section">\n\t\t\t\t\t\t\t<div class="info-section-label" q-translation="odag.toolbar.navpoint.popup.request.tab.info.lastCompletedRun"></div>\n\t\t\t\t\t\t\t<div class="info-section-value">{{$ctrl.expandedItem.item.lastLoadedTime ? $ctrl.expandedItem.item.lastLoadedTime : \'Common.None\' | translate }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-repeat="message in $ctrl.expandedItem.item.statusMessageArray" class="info-field-row" ng-if="$ctrl.expandedItem.item.statusMessageArray.length" ng-bind="message.message"></div>\n\t\t\t\t\t\t<div ng-repeat="error in $ctrl.expandedItem.item.progressErrors" class="info-field-row info-field-row-error" ng-if="$ctrl.expandedItem.item.progressErrors.length" ng-bind="error.message"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(981)],a=function(t,e){t.directive("qvProgressCircle",function(){return{scope:{percentage:"="},restrict:"E",template:e,link:function t(e,n){function i(){var t=e.percentage;var i=n.find(".progress-circle-svg .bar");var a=i.attr("r");var s=Math.PI*(2*a);if(Number.isNaN(+t)){t=100;i.css({strokeDashoffset:s,fill:"#CCCCCC"})}else{t<0&&(t=0);t>100&&(t=100);var r=(100-t)/100*s;i.css({strokeDashoffset:r});100===e.percentage?i.css({fill:"#61a729"}):i.css({fill:"transparent"})}}e.$watch("percentage",i)},controller:["$scope",function(t){t.$on("$destroy",function(){})}]}})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="progress-circle-container" ng-class="{\'full\': percentage === 100}">\n\t<svg class="progress-circle-svg" viewPort="0 0 0 0">\n\t\t<circle class="baseCircle" r="6" cx="8px" cy="8px" fill="transparent" stroke-dasharray="37.699" stroke-dashoffset="0"></circle>\n\t\t<circle class="whiteBar" r="6" cx="8px" cy="8px" fill="transparent" stroke-dasharray="37.699" stroke-dashoffset="0"></circle>\n\t\t<circle class="bar" r="6" cx="8px" cy="8px" fill="transparent" stroke-dasharray="37.699" stroke-dashoffset="0"></circle>\n\t</svg>\n</div>\n'},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){return{canModifyHardProperties:t};function t(t,e,n){var i=t.Views&&t.Views.sheet;if(n.qHasSoftPatches||n.qExtendsId)return false;if(n.qInfo&&"masterobject"===n.qInfo.qType&&n.permissions)return n.permissions.update;if(t.view===i)return t.model&&t.model.layout.permissions.update;return e.app&&e.app.layout.permissions.update}}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(48),n(11),n(1e3),n(1023),n(91),n(49),n(404)],a=function(t,e,n,i,a,s,r){t.directive("qvRain",[function(){return{replace:true,template:i,restrict:"E",scope:{show:"=",model:"=",resize:"=?",messageObj:"=?"},link:function t(i,o){var l;i.objectSRloading=a.get("Accessibility.object.Loading");i.rainStyle={};i.isLoadingCardImageFlag=s.getFlag("LOADING_CARD_IMAGES");i.animation=null;function c(){var t=o[0].getBoundingClientRect(),e=Math.min(t.width,t.height);e*=.3;i.rainStyle.height=e+"px";i.rainStyle.width=e+"px";i.rainStyle.top=(t.height-e)/2;i.rainStyle.left=(t.width-e)/2}function u(t){var a={container:o.find(".rain-image-container")[0],renderer:"svg",loop:true,autoplay:true};n().then(function(n){e.getJSON(t,function(t){a.animationData=t;i.animation=n.loadAnimation(a);i.animation.play()})})}function d(){if(i.animation){i.animation.stop();i.animation.destroy();i.animation=null}}i.$watch("show",function(t){if(void 0===t)return;t&&c()});i.$watch("model",function(t){if(i.isLoadingCardImageFlag){var e=t?t.genericType:"";t&&t.layout&&t.layout.qUndoExclude&&t.layout.qUndoExclude.generated&&(e=t.layout.qUndoExclude.generated.visualization);u(r.getLoadingImageAnimationUrlFromChartType(e))}});i.resize&&(l=i.resize(c));c();i.$on("$destroy",function(){l&&l();i.isLoadingCardImageFlag&&d()})}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var i=function t(){return n.e(73).then(n.t.bind(null,1271,7)).then(function(t){return t})};e.default=i;t.exports=e.default},,,,,,,,,,,function(t,e){t.exports='<div qva-direction class="qv-selection-toolbar qvt-selection-toolbar"\n\t ng-style="toolbar.style"\n\t ng-class="{ \'sel-toolbar-card\': !options.isPopover, \'sel-toolbar-popover\': options.isPopover, \'sel-toolbar-click-to-unlock-bg\': locked, \'sel-toolbar-menu-item\': locked }"\n\t ng-click="locked && toggleLock($event);">\n    <div class="sel-toolbar-list-wrapper">\n\t\t<table class="sel-toolbar-list">\n            <tr>\n                <td ng-if="toolbar.showLock || locked" class="sel-toolbar-list-item sel-toolbar-list-item-lockunlock">\n                    <button tid="selection-toolbar.lock"\n                            class="sel-toolbar-btn sel-toolbar-icon"\n                            q-title-translation="{{locked ? \'SelectionToolbar.ClickToUnlock\' : \'SelectionToolbar.ClickToLock\'}}"\n                            ng-disabled="locked ? false : !toolbar.backendApi.hasSelections()"\n                            ng-click="!locked && toggleLock($event);">\n                        <span class="lui-icon sel-toolbar-span-icon" ng-class="!locked ? \'lui-icon--unlock\':\'lui-icon--lock sel-toolbar-menu-span-icon\'"></span>\n                    </button>\n                </td>\n\t\t\t\t<td class="sel-toolbar-list-item" ng-class="{ \'sel-toolbar-list-item-hide-more\': !shouldShowBtnMore() }">\n\t\t\t\t\t<button tid="selection-toolbar.toggleShowMenu"\n\t\t\t\t\t\t\t\t\tclass="sel-toolbar-btn sel-toolbar-icon sel-toolbar-icon-toggle"\n\t\t\t\t\t\t\t\t\tng-class="{ \'menu-active\': toolbar.showMenu }"\n\t\t\t\t\t\t\t\t\tq-title-translation="{{toolbar.showMenu ? \'Tooltip.CloseSelectionMenu\' : \'Tooltip.SelectionMenu\'}}"\n\t\t\t\t\t\t\t\t\tng-click="toggleShowMenu($event)">\n\t\t\t\t\t\t<span class="lui-icon  lui-icon--more"></span>\n\t\t\t\t\t</button>\n\t\t\t\t</td>\n                <td ng-show="locked" class="sel-toolbar-list-item-locked">\n                    <p class="sel-toolbar-menu-text" q-translation="SelectionToolbar.ClickToUnlock"></p>\n                </td>\n                <td ng-show="locked && options.smallDevice" ng-click="toolbar.selectionsApi.confirm()" class="sel-toolbar-list-item-close">\n                    <qui-toolbarbutton>\n                        <span class="sel-toolbar-menu-text sel-toolbar-btn-close-text" q-translation="Common.Close"></span>\n                    </qui-toolbarbutton>\n\t\t\t\t</td>\n\t\t\t\t<td ng-repeat="select in selectComponents" class="sel-toolbar-list-item-optionslist">\n\t\t\t\t\t<select ng-show="shouldShowSelect(select)" ng-disabled="shouldDisableSelect(select)" tid="select.tid" q-title-translation="{{select.name}}" ng-style="{width: select.width}" class="lui-select" ng-model="select.value" ng-change="select.action(select)">\n\t\t\t\t\t\t<option ng-if="select.noSelectOption" value="{{select.noSelectOption.value || \'\'}}">{{select.noSelectOption.label || select.noSelectOption.value || ""}}</option>\n\t\t\t\t\t\t<option ng-repeat="option in select.options" value="{{option.value}}">{{option.label || option.value}}</option>\n\t\t\t\t\t</select>\n\t\t\t\t</td>\n                <td ng-show="!locked" ng-repeat="button in filteredButtons" class="sel-toolbar-list-item" ng-class="button.clazz">\n                    <button tid="{{button.tid}}"\n                            ng-click="buttonAction($event, button)"\n                            q-title-translation="{{button.name}}"\n                            ng-disabled="buttonIsDisabled(button)"\n                            class="sel-toolbar-btn"\n                            ng-class="[button.buttonClass, button.isIcon ? \'sel-toolbar-icon\' : \'\', button.isActive(this) ? \'menu-active\' : \'\']">\n                        <span class="sel-toolbar-span-icon lui-icon" ng-class="button.iconClass"></span>\n                    </button>\n                </td>\n            </tr>\n        </table>\n\n\t</div>\n\t\n\t\x3c!-- Menu container (drop-down) --\x3e\n\t<div ng-if="toolbar.showMenu" class="sel-toolbar-menu" ng-style="toolbar.menuStyle"\n\t\t qva-delegated-activate="div:not(.disabled)#menuAction($event);">\n\n\t\t \x3c!-- Menu "go back"-button for sub-levels --\x3e\n\t\t <div ng-if="levels.length > 0" class="sel-toolbar-menu-item back-item" tid="sel-toolbar-menu-back">\n\t\t\t<table class="sel-toolbar-menu-table">\n\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span class="sel-toolbar-menu-span-icon lui-icon lui-icon--triangle-left" ng-class="button.iconClass"></span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<p class="sel-toolbar-menu-text" q-translation="Back"></p>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</div>\n\n\t\t\x3c!-- Menu buttons --\x3e\n\t\t<div ng-repeat="button in currentMenuButtons" class="sel-toolbar-menu-item"\n\t\t\t tid="{{button.tid}}"\n\t\t\t q-title-translation="{{button.name}}"\n\t\t\t ng-class="{\'disabled\': buttonIsDisabled(button), \'selected\': isButtonSelected( button ) }">\n\t\t\t<table class="sel-toolbar-menu-table" ng-class="{ \'selection-toolbar-menu-table-align-center\': !filteredButtons.length }">\n\t\t\t\t<tr>\n\n\t\t\t\t\t\x3c!-- Button icon --\x3e\n\t\t\t\t\t<td ng-if="button.iconClass">\n\t\t\t\t\t\t<span class="sel-toolbar-menu-span-icon lui-icon" ng-class="button.iconClass"></span>\n\t\t\t\t\t</td>\n\n\t\t\t\t\t\x3c!-- Button label --\x3e\n\t\t\t\t\t<td ng-if="filteredButtons.length || ( button.name && !button.iconClass )" ng-class="{\'menu-text-with-right-icon\': button.items}">\n\t\t\t\t\t\t<p class="sel-toolbar-menu-text" ng-class="{\'menu-text-without-left-icon\': !button.iconClass}" q-translation="{{button.name}}"></p>\n\t\t\t\t\t</td>\n\n\t\t\t\t\t\x3c!-- "Click to see more"-icon --\x3e\n\t\t\t\t\t<td ng-if="button.items">\n\t\t\t\t\t\t<span class="sel-toolbar-menu-span-icon next-icon lui-list__aside lui-icon lui-icon--triangle-right"></span>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</div>\n\t</div>\n</div>\n'},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={BUTTON_WIDTH:44,SEPARATOR_WIDTH:1,BORDER_SPACING:8,SELECT_DEFAULT_WIDTH:200,EXTRA_EDGE_PADDING:2,TYPE_BUTTON:"button",TYPE_SEPARATOR:"separator",TYPE_SELECT:"select"};Object.freeze(t);return t}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div class="qv-object-wrapper" ng-class="wrapperClassList" x-ms-format-detection="none">\n\n\t<article class="qv-object qvt-visualization" ng-class="classList" tid="{{objectClass}}">\n\t\t<div class="qv-inner-object" ng-style="styles.backgroundColor">\n\t\t\t<qv-rain ng-if="object.throbberApi.isVisible" show="object.throbberApi.isVisible" resize="object.throbberApi.watchResize" model="object.model"></qv-rain>\n\t\t\t<div class="retry-overlay" ng-if="object.throbberApi.isQueryCanceled">\n\t\t\t\t<ul class="cancelled-list">\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="retry-text" q-translation="Object.Cancelled"></div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<button class="retry-button lui-button" qva-activate="retry()" q-translation="Dialog.Button.Retry" tid="retry-calculations"></button>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t\t<div class="cancel-overlay" ng-if="object.throbberApi.isLongRunningQuery && !object.throbberApi.isQueryCanceled">\n\t\t\t\t<button class="cancel-button lui-button" ng-if="!object.throbberApi.isQueryCanceled" qva-activate="cancel()"\n\t\t\t\t\t\tq-translation="Common.Cancel" tid="cancel-calculations"></button>\n\t\t\t</div>\n\n\t\t\t<label class="hidden-screen-reader-label" q-translation="{{object.type.libraryInfo.isThirdParty ? object.type.libraryInfo.name : object.type.libraryInfo.translationKey}}"></label>\n\t\t\t<label ng-if="!layout.title" class="hidden-screen-reader-label" q-translation="Accessibility.Object.NoTitle"></label>\n\t\t\t<header qva-direction x-dir-setting="{{options.direction}}" ng-show="object.hasFrame" class="qv-object-header" ng-class="{\'thin\' : !object.showTitles || ( layout.title === \'\' && layout.subtitle === \'\' && !object._inEditState )}">\n\t\t\t\t<h1 ng-show="object.showTitles" qva-direction x-dir-setting="{{options.direction}}" ng-attr-title="{{layout.title}}" class="qv-object-title qvt-visualization-title" qva-activate="titleClicked();" ng-style="styles.title">\n\t\t\t\t\t<a ng-if="options.showSearch && object.isInteractive && !object.backendApi.isLocked() && !object._inEditState" q-title-translation="Common.Search" class="qv-object-search lui-icon lui-icon--search"\n\t\t\t\t\t   qva-activate="options.showSearch && options.search.toggle()"></a>\n\t\t\t\t\t<a ng-if="options.showSearch && object.isInteractive && object.backendApi.isLocked()" class="qv-object-locked lui-icon lui-icon--lock"\n\t\t\t\t\t   qva-activate="titleClicked()"></a>\n\t\t\t\t\t<span ng-if="options.showSearch && object.backendApi.isDrillDown()" class="lui-icon lui-icon--drill-down" q-title-translation="Tooltip.dimensions.drilldown"></span>\n\t\t\t\t\t<div ng-if="options.highlightTitle && (!object._inEditState || object._inEditState && object.isReadonly)" qve-highlight text="{{layout.title}}" query="options.highlightQuery" class="qv-object-title-text" qva-direction x-dir-setting="{{options.direction}}" x-dir-text="{{layout.title}}"></div>\n\t\t\t\t\t<div ng-if="!options.highlightTitle && (!object._inEditState || object._inEditState && object.isReadonly)" class="qv-object-title-text" qva-direction x-dir-setting="{{options.direction}}" x-dir-text="{{layout.title}}">{{layout.title}}</div>\n\t\t\t\t\t<div ng-if="options.showDisclaimerStar && !!layout.title && !object._inEditState" class="disclaimer qv-object-title-text">*</div>\n\t\t\t\t\t<div ng-if="object._inEditState && !object.isReadonly" qv-inline-title-edit x-dir-setting="{{options.direction}}" x-model="model" x-property-path="title" x-layout-path="title"\n\t\t\t\t\t\t x-empty-translation="Object.AddTitle" class="qv-object-title-edit" qva-direction x-dir-setting="{{options.direction}}"></div>\n\t\t\t\t</h1>\n\n\t\t\t\t<h2 ng-if="!!layout.subtitle && object.showTitles" ng-style="styles.subTitle" qva-direction x-dir-setting="{{options.direction}}" x-dir-text="{{layout.subtitle}}" ng-attr-title="{{layout.subtitle}}" ng-show="!!layout.subtitle" class="qv-object-subtitle qvt-visualization-subtitle">{{layout.subtitle}}</h2>\n\t\t\t</header>\n\n\t\t\t<div class="qv-object-content-container">\n\t\t\t\t<div class="qv-object-content" qv-object-content component="object.content" options="options" object="object" backend-api="object.backendApi" layout="layout"\n\t\t\t\t\t ext="object.ext" selections-api="object.selectionsApi" tooltip-api="object.tooltipApi" throbber-api="object.throbberApi" on-init="onInit">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="qv-footer-wrapper" ng-show="object.hasFrame && object.showTitles && !!layout.footnote" ng-style="styles.footer">\n\t\t\t<footer qva-direction x-dir-setting="{{options.direction}}" x-dir-text="{{layout.footnote}}" ng-attr-title="{{layout.footnote}}" ng-if="object.hasFrame && object.showTitles && !!layout.footnote" class="qv-object-footnote qvt-visualization-footnote">{{layout.footnote}}</footer>\n\t\t</div>\n\n\t</article>\n</div>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(11),n(1015),n(94),n(89),n(205),n(97),n(321),n(402),n(403),n(1019),n(108)],a=function(t,e,n,i,a,s,r,o,l,c,u){var d=null;var p=a.extend({$scope:null,init:function e(i,a){this.$scope=i;this.$scope.hyperCubePath=i.object.ext.options.hyperCubePath;this.titleRetriever=l.create();function p(){n.model?i.showAdd=c.updateShowAdd(u.inClient(),n.isInEditMode(),i.object.isReadonly):i.showAdd=false}n.StateChanged.bind(p);i.$on("$destroy",function(){n.StateChanged.unbind(p)});p();i.removeDimension=function(t){i.object.model.getProperties().then(function(e){var n=i.object.getCreatePropertyHandler();n.setProperties(e);n.removeDimension(t).then(function(){i.object.model.setProperties(e)})})};i.removeMeasure=function(t){i.object.model.getProperties().then(function(e){var n=i.object.getCreatePropertyHandler();n.setProperties(e);n.removeMeasure(t).then(function(){i.object.model.setProperties(e)})})};function h(t){return i.object.ext.addFieldDimension(t,i.object).then(function(){b()})}function f(t){return i.object.ext.addLibraryDimension(t,i.object).then(function(){b()})}function g(t){return i.object.ext.addLibraryMeasure(t,i.object).then(function(){b()})}function v(t){return i.object.ext.addExpressionMeasure(t,i.object).then(function(){b()})}var m;i.showAddDimension=function(e,n){if(d&&d===n){m&&m.close();m=null;d=null;return}var s=i.ext.addDimensionPopoverComponent||r;var o;m=a.show({template:s.template,controller:s.controller,input:{app:i.object.model.app,closeAddPopover:b,addFieldDimension:h,addLibraryDimension:f},alignTo:e.target,closeOnEscape:true,outsideIgnore:".add-button",dock:"right"});m.closing.then(function(e){o=e;e&&!t(e.target).hasClass("add-button")&&(d=null)});m.closed.then(function(){m=null;n.active=false;o||(d=null)});n.active=true;d=n};i.showAddMeasure=function(e,n){if(d&&d===n){m&&m.close();m=null;d=null;return}var s=i.ext.addMeasurePopoverComponent||o;var r;m=a.show({template:s.template,controller:s.controller,input:{app:i.object.model.app,closeAddPopover:b,addLibraryMeasure:g,addExpressionMeasure:v},alignTo:e.target,closeOnEscape:true,dock:"right",outsideIgnore:'[tid="add-measure"]'});m.closing.then(function(e){r=e;e&&!t(e.target).hasClass("add-button")&&(d=null)});m.closed.then(function(){m=null;n.active=false;r||(d=null)});n.active=true;d=n};function b(e){if(m){m.close();m=null}d&&(d.active=false);e&&!t(e.target).hasClass("add-button")&&(d=null)}s.on("start",b);i.$on("$destroy",function(){s.off("start",b);b()})},onPaint:h});p.$inject=["$scope","luiPopover"];return{template:e,controller:p};function h(t){var e=this.$scope;var a=this;return this.$scope.object.model.getEffectiveProperties().then(function(s){var r;var o=a.titleRetriever;e.showAdd=c.updateShowAdd(u.inClient(),n.isInEditMode(),e.object.isReadonly);c.updateMinMax(e,t);e.iconName=e.object.ext.libraryInfo.icon;if(e.type!==e.object.type.type){r=e.object.getCreatePropertyHandler();a.propertyHandler=r;e.canRemoveDim=!!r.removeDimension;e.type=e.object.type.type;e.addDimensionLabel=r.getAddDimensionLabel()}else r=a.propertyHandler;r.setLayout(t);r.setProperties(s);o.resetTitles();var l=r.getDimensions().map(function(t){var e=t.qDef.cId;var n=r.getDimensionLayout(e);var i=n.qError&&n.qError.qErrorCode;return{invalid:!!i,title:o.getDimensionTitle(n,t,true)}});return i.all(r.getMeasures().map(function(t,e){var n=t.qDef.cId;var i=r.getMeasureLayout(n);i||(i=r.getMeasureLayouts()[e]);var a=i.qError&&i.qError.qErrorCode;return o.getMeasureTitle(i,t,true,r.app).then(function(t){return{invalid:!!a,title:t}})})).then(function(t){e.finishedDimensions=l;e.finishedMeasures=t;var n=!l.length&&e.maxDimensions>0;var i=!t.length&&e.maxMeasures>0;e.unfinishedDimensions=c.getArray(Math.max(0,e.minDimensions-l.length,n?1:0));e.unfinishedMeasures=c.getArray(Math.max(0,e.minMeasures-t.length,i?1:0));e.show=true})})}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div qv-requirements class="requirements-wrapper" ng-show="show" ng-class="{\'incomplete\': !showAdd}">\n\t<div class="requirements">\n\t\t<h2 class="header">\n\t\t\t<i class="object-icon  lui-icon  lui-icon--{{iconName}}"></i>\n\t\t</h2>\n\t<p class="incomplete-text" ng-if="!showAdd" q-translation="Visualization.Requirements.IncompleteVisualization"></p>\n\t\t\x3c!-- finished dimensions --\x3e\n\t\t<ul ng-if="showAdd && finishedDimensions.length">\n\t\t\t<li ng-repeat="dimension in finishedDimensions" class="item" ng-class="{ finished: !dimension.invalid, invalid: dimension.invalid }"\n\t\t\t\ttid="{{ dimension.invalid ? \'invalid-dimension\' : \'added-dimension\'}}">\n\t\t\t\t<span class="text" ng-class="{ \'no-icon\': !canRemoveDim }" title="{{dimension.title}}">{{dimension.title}}</span>\n\t\t\t\t<i ng-if="canRemoveDim" class="lui-icon lui-icon--remove" qva-activate="removeDimension($index)" q-title-translation="Common.Delete"></i>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t\x3c!-- unfinished dimensions --\x3e\n\t\t<ul ng-if="showAdd && unfinishedDimensions.length">\n\t\t\t<li ng-repeat="d in unfinishedDimensions" class="item missing" tid="missing-dimension">\n\t\t\t\t<button class="add-button lui-button"  ng-class="{ \'lui-active\': d.active }" ng-click="showAddDimension($event,d)"\n\t\t\t\t\t\t\ttid="add-dimension">{{addDimensionLabel}}</button>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t\x3c!-- finished measures --\x3e\n\t\t<ul ng-if="showAdd && finishedMeasures.length">\n\t\t\t<li ng-repeat="measure in finishedMeasures" class="item" ng-class="{ finished: !measure.invalid, invalid: measure.invalid }"\n\t\t\t\ttid="{{ measure.invalid ? \'invalid-measure\' : \'added-measure\'}}">\n\t\t\t\t<span class="text" title="{{measure.title}}">{{measure.title}}</span>\n\t\t\t\t<i class="lui-icon lui-icon--remove" qva-activate="removeMeasure($index)" q-title-translation="Common.Delete"></i>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t\x3c!-- unfinished measures --\x3e\n\t\t<ul ng-if="showAdd && unfinishedMeasures.length">\n\t\t\t<li ng-repeat="m in unfinishedMeasures" class="item missing" tid="missing-measure">\n\t\t\t<button class="add-button lui-button"  ng-class="{ \'lui-active\': m.active }" ng-click="showAddMeasure($event,m)"\n\t\t\t\t\tq-translation="Visualization.Requirements.AddMeasure" tid="add-measure"></button>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</div>\n'},function(t,e){t.exports='<lui-popover class="add-popover-wrapper" style="min-width: 200px;width: 230px;" align-to="alignTo" position="position" collision="\'flipfit\'" on-close-view="closeAddPopover(event)" qva-outside-ignore-for="{{qvaOutsideIgnoreFor}}">\n\t<div ng-show="!step2">\n\t\t<object-add-typeahead>\n\t\t\t<lui-popover-header>\n\t\t\t\t\t<div class="lui-input-group">\n\t\t\t\t\t\t<input class="lui-input  lui-input-group__item  lui-input-group__input" type="text" name="new-measure" autocomplete="off" ng-model="search.term" tid="add-measure-input" qva-focus="autoFocus"\n\t\t\t\t\t\t\t   maxlength="255" object-add-typeahead-input on-escape="onEscape($event)" on-enter="onEnter($event)"/>\n\n\t\t\t\t\t\t<button ng-if="allowExpressionEditor !== false" class="lui-button  lui-input-group__item  lui-input-group__button" qva-activate="close()"\n\t\t\t\t\t\t\t\tpp-expression-editor="search.term" pp-expression-editor-on-apply="addExpressionMeasure({value:value})" expression-type="measure"\n\t\t\t\t\t\t\t\tq-title-translation="Tooltip.OpenExpressionEditor" tid="fx-button">\n\t\t\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--expression  edit-expression"></span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t</lui-popover-header>\n\t\t\t<div class="object-add-popover-content" object-add-typeahead-menu>\n\t\t\t\t<ul class="lui-list">\n\t\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="measure in activeMeasures" tid="measure-item"\n\t\t\t\t\t\tobject-add-typeahead-item="measure" on-select="addActiveMeasure(measure)">\n\t\t\t\t\t\t<span qve-highlight text="{{measure.translatedTitle}}" title="{{measure.translatedTitle}}" query="search.term" class="lui-list__text lui-list__text--ellipsis"></span>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t\t<div class="object-add-popover-list-header" ng-if="measures.length"  q-translation="Common.Measures"></div>\n\t\t\t\t<ul class="lui-list">\n\t\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="measure in measures" tid="measure-item"\n\t\t\t\t\t\tobject-add-typeahead-item="measure" on-select="addLibraryMeasure(measure)">\n\t\t\t\t\t\t<span qve-highlight text="{{measure.value}}" title="{{measure.value}}" query="search.term" class="lui-list__text lui-list__text--ellipsis"></span>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t\t<div class="object-add-popover-list-header" ng-if="fields.length" q-translation="Visualization.Requirements.FromField"></div>\n\t\t\t\t<ul class="lui-list">\n\t\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="field in fields" tid="field-item"\n\t\t\t\t\t\tobject-add-typeahead-item="field" on-select="showFromField(field)"\n\t\t\t\t\t\tng-class="{\'derived-field\': (field.isDerived && search.term === \'\')}"\t>\n\t\t\t\t\t\t<i ng-if="isDirectDiscoveryField( field )" class="lui-icon  lui-icon--direct-discovery  lui-list__aside" q-title-translation="{{ getDirectDiscoveryTypeTranslationKey( field.qTags ) }}"></i>\n\t\t\t\t\t\t<span ng-if="field.isGeoField" class="lui-icon lui-icon--map lui-list__aside"></span>\n\t\t\t\t\t\t<span ng-if="field.isDateField" class="lui-icon lui-icon--calendar lui-list__aside"></span>\n\t\t\t\t\t\t<span qve-highlight text="{{getFieldDisplayName(field)}}" title="{{field.toolTip}}" query="search.term" class="lui-list__text lui-list__text--ellipsis"></span>\n\t\t\t\t\t\t<i class="object-add-popover-toogle-step2-icon  lui-list__aside lui-icon  lui-icon--triangle-right"></i>\n\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t\t<div class="object-add-popover-nohits" ng-if="!measures.length && !fields.length" q-translation="Toolbox.Search.Nohits"></div>\n\t\t\t</div>\n\t\t</object-add-typeahead>\n\t</div>\n\t<div class="object-add-popover back" ng-show="step2">\n\t\t<div class="object-add-popover-header">\n\t\t\t<div qva-activate="goBack($event);">\n\t\t\t\t<i class="object-add-popover-back-icon  lui-icon  lui-icon--triangle-left"></i>\n\t\t\t\t<span q-translation="Visualization.Requirements.Back"></span>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="object-add-popover-content">\n\t\t\t<div class="object-add-popover-list-header" q-translation="Visualization.Requirements.Aggregation"></div>\n\t\t\t<ul class="lui-list">\n\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="suggestion in fieldSuggestions" qva-activate="addFromField(suggestion)" tid="from-field-item">\n\t\t\t\t\t<span class="lui-list__text lui-list__text--ellipsis" title="{{suggestion.aggregation}}({{suggestion.field}})">{{suggestion.aggregation}}({{suggestion.field}})</span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n</lui-popover>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(89),n(272),n(231),n(147)],a=function(t,e,n,i){function a(){this.measureTitles={}}a.prototype.getDimensionTitle=s;a.prototype.getMeasureTitle=r;a.prototype.resetTitles=o;return a;function s(t,i,a){if(!t)return"";if(t.qError&&!e.isCalcCondNotCalculatedErr(t.qError))return n.getDimensionError(t.qError.qErrorCode);var s=i.qLibraryId,r="H"===t.qGrouping;return r||s&&a?t.title||"":!s&&a?i.qDef.qLabelExpression||t.qFallbackTitle||"":t.qFallbackTitle||""}function r(t,e,n,i){var a=l(t,this.measureTitles);if(a)return a.promise;a=c(t,this.measureTitles);a.promise=u(t,e,n,i);return a.promise}function o(){this.measureTitles={}}function l(t,e){var n=d(t);return e[n]}function c(t,e){var n=d(t);var i={id:n,promise:null};e[n]=i;return i}function u(e,a,s,r){if(!e)return t.when("");var o=a.qLibraryId;if(e.qError)return t.when(n.getMeasureError(e.qError.qErrorCode));if(o&&s){if(!r)throw new Error("TitleRetriever: Argument 'app' is required");return i.get(o,r).then(function(t){return t.getProperties()}).then(function(t){return t.qMeasure.qLabel||""})}return!o&&s?t.when(a.qDef.qLabelExpression||e.qFallbackTitle||""):t.when(e.qFallbackTitle||"")}function d(t){return t&&t.cId}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div qv-errorhandler class="object-error" ng-class="error.class" tid="object.Error">\n\t<div class="object-error-content">\n\t\t<div class="object-error-title">\n\t\t\t<span>{{error.title}}</span>\n\t\t\t<i class="object-error-more lui-icon lui-icon--info lui-icon--large" ng-click="showMore($event)"></i>\n\t\t</div>\n\t\t<div ng-if="error.message" class="object-error-message">{{error.message}}</div>\n\t</div>\n</div>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(281)],a=function(t){function e(t,e,n){return t?e&&!n:!n}function n(t){var e=new Array(t),n;for(n=0;n<t;++n)e[n]={index:n};return e}function i(e,n){if(e.layers&&e.layers[0]){var i=e.layers[0],a=i.qHyperCube.qDimensionInfo;return"point"===i.type?a[1].qError&&a[1].qError.qErrorCode?[a[1]]:[a[0]]:e.layers[0].qHyperCube.qDimensionInfo||[]}var s=t.getHyperCube(e,n);if(s)return s.qDimensionInfo||[];if(e.qChildList){var r=e.qChildList.qItems||[];return r.map(function(){return{}})}return e.qListObject&&e.qListObject.qDimensionInfo?[e.qListObject.qDimensionInfo]:[]}function a(e,n){var i=t.getHyperCube(e,n);return i&&i.qMeasureInfo||[]}function s(t,e){var n=t.ext.dimensionDefinition?t.ext.dimensionDefinition.min:0,s=t.ext.dimensionDefinition?t.ext.dimensionDefinition.max:0,r=t.ext.measureDefinition?t.ext.measureDefinition.min:0,o=t.ext.measureDefinition?t.ext.measureDefinition.max:0;var l=i(e,t.hyperCubePath),c=a(e,t.hyperCubePath);t.minDimensions="function"===typeof n?n.call(null,c.length):n;t.minMeasures="function"===typeof r?r.call(null,l.length):r;t.maxDimensions="function"===typeof s?s.call(null,c.length):s;t.maxMeasures="function"===typeof o?o.call(null,l.length):o}return{updateShowAdd:e,getArray:n,getDimensionInfo:i,getMeasureInfo:a,updateMinMax:s}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(95)],a=function(t){function e(e){e=e||{};t.publish("/ui/object/resize",e)}["/resize/end","/ui/panel/toggle","/ui/grid/cellswap","/ui/grid/cellresize","/ui/grid/cellsplitting","/ui/grid/zoom/activated","/ui/grid/zoom/deactivated"].forEach(function(n){t.subscribe(n,e)})}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(1022)],a=function(t,e){t.directive("qvThrobber",["$timeout",function(t){return{replace:true,template:e,restrict:"E",scope:{model:"=",progress:"=",delay:"=",disabled:"="},link:function e(n){var i;n.$watch("model.isValidating",function(e){if(true===n.disabled){n.progress=false;return}if(n.model&&void 0===n.model.state)n.progress=true;else if(e){i&&t.cancel(i);i=t(function(){n.model&&n.model.isValidating&&(n.progress=true)},n.delay||1e3)}else n.progress=false})}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div ng-show="progress" class="qv-animate progress ng-hide">\n\t<div class="progress-loader" style="width:20%;height:20%;position:absolute;top:40%;left:40%"></div>\n</div>\n'},function(t,e){t.exports='<div class="rain progress" ng-class="{\'qv-fade-out\': fadeOut}">\n\t<div class="rain-image-container" ng-if="isLoadingCardImageFlag"></div>\n\n\t<div ng-if="!isLoadingCardImageFlag" class="rain-progress" ng-style="rainStyle" aria-label="{{objectSRloading}}">\n\t\t<div class="progress-div rotating" ng-class="ngClasses">\n\t</div>\n\n\t<div class="qv-loader-text" ng-if="messageObj" ng-class="ngClasses">\n\t\t<div ng-show="messageObj.task" q-translation="{{messageObj.task}}"></div>\n\t\t<div ng-show="messageObj.message" q-translation="{{messageObj.message}}"></div>\n\t</div>\n</div>\n'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(1025),n(1026)],a=function(t,e){t.directive("qvaNavMenu",[function(){return{template:e,replace:true,scope:{menu:"=",options:"="},controller:["$scope","$element",function(t,e){t.menu.getSize=function(){var n=e[0].getBoundingClientRect();return{width:t.menu.visible?n.width:0,height:t.menu.visible?n.height:0}}}]}}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div qva-direction x-dir-setting="{{options.direction}}" class="qv-object-nav" aria-hidden="true" ng-style="styles.backgroundColor" ng-class="{\'zero-top\' : options.isZoomed, \'visible\' : menu.visible, \'active\': options.isActive, \'inline\' : options.thinHeader}">\n  <qva-nav-menu-item ng-repeat="menuItem in menu.items | orderBy:\'+\':true" model="menuItem"></qva-nav-menu-item>\t\n</div>'},function(t,e,n){"use strict";var i,a;!(i=[n(48),n(1027)],a=function(t,e){t.directive("qvaNavMenuItem",[function(){return{template:e,replace:true,scope:{model:"="},link:function t(e,n){e.model.mounted&&e.model.mounted(n)}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<a\n  ng-show="model.isVisible()"\n  ng-class="[model.cssClasses, model.dynamicCssClasses()]"\n  qva-activate="model.action($event)"\n  q-title-translation="{{model.translation}}"\n  tid="{{model.tid}}">\n</a>'},,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(90),n(94),n(89),n(1121),n(1122),n(1046),n(1123)],a=function(t,e,n,i,a,s,r){function o(){this._generationInProgress=false}o.prototype.isDerivedUpToDate=l;o.prototype.updateDerivedProperties=c;o.prototype.addDefaultHyperCubeHash=u;return o;function l(t){r.validate(t);var e=t.properties,n=i.generateHash(t.hashData);if(!e.qUndoExclude||e.qUndoExclude.hashCode!==n)return false;return true}function c(a){r.validate(a);if(this._generationInProgress)return n.resolve(true);if(l(a)){var o=a.layout.qUndoExclude&&a.layout.qUndoExclude.hashCode===a.properties.qUndoExclude.hashCode;return n.resolve(!o)}var c=this,u=a.model,d=a.layout,p=a.properties,h=t.extend(true,{},p);this._generationInProgress=true;i.updateHash(p,a.hashData);return a.generateDerivedProperties(d,p).then(function(){return s.saveDerivedProperties(u,d,p,h,e).then(function(){c._generationInProgress=false;return n.resolve(true)})})}function u(e,n,i,s){return a.getDefaultHashDataForHyperCube(e,n,i).then(function(e){return t.extend(true,s,e)})}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(376),n(982)],a=function(t,e){return{saveDerivedProperties:n};function n(n,i,a,s,r){if(e.canModifyHardProperties(r,n,i))return n.setProperties(a);var o=new t(n);return o.saveSoftProperties(s,a)}}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(89),n(97)],a=function(t,e){var n={template:null,controller:["$scope","$element","$timeout",function(n,i,a){var s=this;s.selectionsActivated=function(){};s.selectionsDeactivated=function(){};s.close=function(){r()};function r(){a(function(){n.destroyComponent();i.remove()});e.off("start.listbox-popover-error",r)}function o(){return a(function(){return i.find(".toolbar-wrapper").outerWidth()})}n.closeView=function(t){n.onPopoverClose(t);r()};t.all({object:n.getVisualization(),width:o()}).then(function(t){var i=t.object,a=t.width;i.getSelectionToolbar().then(function(t){n.toolbar=t;n.toolbar.showLock=n.options.showLock;n.toolbar.position={width:a};i.activateSelections()});i.loaded.then(function(){i.ext.hasError(i)&&e.on("start.listbox-popover-error",r)});i.selectionsApi.watchActivated(function(){s.selectionsActivated()});i.selectionsApi.watchDeactivated(function(){s.selectionsDeactivated();r()});n.closeView=function(t){i.selectionsApi.confirm();n.onPopoverClose(t);r()}})}]};return n}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<div\n\tclass="qv-listbox-popover-small-device">\n\t<div class="toolbar-wrapper"\n\t\tqva-include-selection-toolbar\n\t\tcomponent="selectionToolbarComponent"\n\t\ttoolbar="toolbar"\n\t\toptions="options">\n\t</div>\n\t<h1 qva-direction x-dir-setting="{{options.direction}}" x-dir-text="{{model.layout.title || model.layout.qListObject.qDimensionInfo.qFallbackTitle}}" class="qvt-visualization-title">{{model.layout.title || model.layout.qListObject.qDimensionInfo.qFallbackTitle}}</h1>\n\t<div class="listbox-wrapper">\n\t\t<qv-object object="object" model="model" options="options"></qv-object>\n\t</div>\n</div>\n'},,function(t,e,n){"use strict";var i,a;!(i=[n(379),n(89)],a=function(t,e){function n(){return t.get().then(function(t){return t.getRestService()})}function i(t){return t}function a(t){if(t.stats.dims>9||t.stats.msrs>9)return e.resolve([]);var a={exploreSupplemental:["appNMinExplore"]};return n().then(function(e){return e.getVisRecommendations(t,true,a,[]).then(function(e){var n=[];var i=t.stats;e.appRecommendations.forEach(function(t){s(t)&&t.recAnalyses.forEach(function(t){r(t,i)&&n.push(t)})});return n})}).catch(i)}function s(t){return t&&t.group&&"insight"!==t.group}function r(t,e){if(t.isExtendedAnalysis)return false;var n=t.analysis.dims||[];var i=t.analysis.msrs||[];return n.length===e.dims&&i.length===e.msrs}function o(t){function e(t){if(t.isLibraryItem())return{libId:t.libId,cType:"eLibItem"};if(t.isFieldItem())return{field:t.name,expr:t.expr,cType:"eField"};return{expr:t.expr,cType:"eInlineExpr"}}var n={analysis:{analysis:"list",dims:t.dimensions.map(e),msrs:t.measures.map(e)}};return n}return{getChartRecommendations:a,getFallbackRecommendation:o}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;function s(t){s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return s(t)}!(i=[n(54),n(878),n(1113),n(90),n(186)],a=function(t,e,n,i,a){var r={createChartDataProperties:o,findPossibleCharts:u,findChartsByAnalysis:p};return r;function o(t,e){var n=t.analysis.dims||[];var i=t.analysis.msrs||[];function a(t,e){var n=-1;t.some(function(t,i){if(t.mapLayer&&t.mapLayer===e){n=i;return true}return false});return n}function s(t,e){var s,r;var o={};if(void 0!==e.index){s=e.index;r=e.index}else if(void 0!==e.indexRange){s=e.indexRange.start;r=e.indexRange.end}else if("area"===e.key){var l=a(n,"geo_poly");if(l>-1){s=l;r=l;var c=n[l];c.relatedGeoDim&&(o.mapProperties=c.relatedGeoDim)}}else if("points"===e.key){var u=a(n,"geo_point");if(u>-1){s=u;r=u;var p=n[u];p.relatedGeoDim&&(o.mapProperties=p.relatedGeoDim)}}else{s=-1;r=-1}for(var h=s;h<=r;h++){var f=d(e.key,e.classification,e.adapt,h,n,i,o);f&&t.push(f)}return t}var r=[];e.forEach(function(t){var e={type:t.chartType,score:t.score,encodings:t.analysis.encodings.reduce(s,[]),adapt:t.adapt};r.push(e)});return r}function l(t,e,n,i,a){for(var r in t){var o=t[r];if("object"==s(o)&&null!==o){var c=o.classification;if(c){var u=Number.isNaN(+o.max)?1:o.max,d=o.min||0;if(-1!==c.indexOf("measure")){o.pseudoDim&&u>1&&e.unallocated>1&&n.unallocated++;u>1?o.indexRange={start:e.capacity,end:e.capacity+u-1}:o.index=e.capacity;e.unallocated=e.unallocated-u;e.capacity+=u;e.required+=d;i.push(o)}if(-1!==c.indexOf("dimension")&&"color"!==o.key){var p=-1!==c.indexOf("numeric"),h=false;a.dimensions.length&&(h="N"===a.dimensions[0].qDimensionType);if(!p||p&&h){u>1?o.indexRange={start:n.capacity,end:n.capacity+u-1}:o.index=n.capacity;n.unallocated=n.unallocated-u;n.capacity+=u;n.required+=d;i.push(o)}}}l(o,e,n,i,a)}}}function c(t){t=t||[];var e=t.map(function(t){if(!t.qGroupFieldDefs&&t.libId)return t.libId;var e=t.qGroupFieldDefs||[];return e.map(function(t){return a.normalizeExpression(t)}).join(",")});return i.getUnique(e).length!==e.length}function u(t,n){var i=[];t.forEach(function(t){var a=[],s=e.getChartDataDefinition(t);if(s.encodings){var r={length:n.measures?n.measures.length:0,capacity:0,required:0,unallocated:n.measures?n.measures.length:null,isSupported:function t(){return this.unallocated<1&&this.capacity>=this.length&&this.required<=this.length}},o={length:n.dimensions?n.dimensions.length:0,capacity:0,required:0,unallocated:n.dimensions?n.dimensions.length:null,isSupported:function t(){var e=s.supportsDuplicateDimensions||!c(n.dimensions);return this.unallocated<1&&this.capacity>=this.length&&this.required<=this.length&&e}};l(s.encodings,r,o,a,n);if(r.isSupported()&&o.isSupported()){var u={chartType:t,score:-1,analysis:{encodings:a}};i.push(u)}}});return i}function d(t,e,i,a,s,r,o){var l=-1!==e.indexOf("dimension");var c=l?s:r;if(c.length<=a)return;var u=new n.Value(c[a]);var d=new n.Encoding(t,e,u,i,o);return d}function p(t,n){var i=[];var a=t.analysis;e.getSupportedChartTypes().forEach(function(t){var s=e.getChartDataDefinition(t);if(s.analyses){var r=s.analyses.filter(function(t){if(t.analysis!==a.analysis)return false;if(!h(a.dims,t.dimensions))return false;if(!h(a.msrs,t.measures))return false;if(t.criteria&&!t.criteria(n))return false;var e=s.supportsDuplicateDimensions||!c(n.dimensions);if(!e)return false;return true});r.forEach(function(e){var n={chartType:t,encodings:s.encodings,score:e.score||0,adapt:e.adapt,analysis:e};i.push(n)})}});return i}function h(e,n){if(t.isObject(n)){if(f(e?e.length:0,n.min,n.max))return true}else if(f(e?e.length:0,n,n))return true;return false}function f(t,e,n){return t>=e&&t<=n}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(49)],a=function(t){var e={type:"barchart",supportsDuplicateDimensions:true,encodings:[{key:"bars",classification:"dimension",path:"qHyperCubeDef.qDimensions.0.qDef.qFieldDefs.0",min:t.getFlag("BARCHART")?0:1,encodings:[{key:"height",classification:"measure",path:"qHyperCubeDef.qMeasures.$measureIndex.qDef.qDef",pseudoDim:true,min:1,max:15},{key:"groupStack",classification:"dimension",path:"qHyperCubeDef.qDimensions.$dimensionIndex.qDef.qFieldDefs.0"},{key:"color",classification:"dimension",path:"qHyperCubeDef.qDimensions.0.qDef.qAttrDims.0"}]}],analyses:[{analysis:"rank",dimensions:1,measures:1,score:5,encodings:[{key:"bars",classification:"dimension",index:"0"},{key:"height",classification:"measure",index:"0"}]},{analysis:"timeCycle",dimensions:1,measures:2,encodings:[{key:"bars",classification:"dimension",index:"0"},{key:"height",classification:"measure",indexRange:{start:0,end:1}}]},{analysis:"trend",dimensions:1,measures:1,score:101,criteria:function t(e){var n=e.getMetaDataForDimension(0);if(n)return n.qCardinal&&n.qCardinal<5&&n.qCardinal>1;return false},encodings:[{key:"bars",classification:"dimension",index:"0"},{key:"height",classification:"measure",index:"0"}]},{analysis:"ytdAnalysis",dimensions:2,measures:1,encodings:[{key:"bars",classification:"dimension",index:"0"},{key:"group",classification:"dimension",index:"1"},{key:"height",classification:"measure",indexRange:{start:0,end:1}}],adapt:function t(e){e.qHyperCubeDef.qDimensions[1].qNullSuppression=true}},{analysis:"countBasedRank",dimensions:1,measures:1,encodings:[{key:"bars",classification:"dimension",index:"0"},{key:"height",classification:"measure",index:"0"}]},{analysis:"breakdown",dimensions:1,measures:{min:2,max:15},encodings:[{key:"bars",classification:"dimension",index:"0"},{key:"height",classification:"measure",indexRange:{start:0,end:14}}]},{analysis:"breakdown",dimensions:2,measures:1,criteria:function t(e){var n=e.getMetaDataForDimension(0);if(n)return n.qCardinal&&n.qCardinal<13&&e.isPerfectHierarchy();return false},encodings:[{key:"bars",classification:"dimension",index:"1"},{key:"color",classification:"dimension",index:"0"},{key:"height",classification:"measure",index:"0"}]},{analysis:"breakdown",dimensions:2,measures:1,criteria:function t(e){return e.isPerfectHierarchy()},encodings:[{key:"bars",classification:"dimension",index:"1"},{key:"group",classification:"dimension",index:"0"},{key:"height",classification:"measure",index:"0"}]}]};return e}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={type:"kpi",supportsDuplicateDimensions:true,encodings:[{key:"values",path:"qHyperCubeDef.qMeasures.$measureIndex.qDef.qDef",classification:"measure",min:1,max:2}],analyses:[{analysis:"list",dimensions:0,measures:{min:1,max:1},score:10,encodings:[{key:"values",classification:"measure",index:0}]},{analysis:"fact",dimensions:0,measures:{min:1,max:2},score:15,encodings:[{key:"values",classification:"measure",indexRange:{start:0,end:1}}]}]};return t}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90)],a=function(t){var e={type:"gauge",supportsDuplicateDimensions:true,encodings:[{key:"values",path:"qHyperCubeDef.qMeasures.$measureIndex.qDef.qDef",classification:"measure",min:1}],analyses:[{analysis:"fact",dimensions:0,measures:1,criteria:function t(e){var n=e.getMetaDataForMeasure(0);if(n){if(!e.hasOwnProperty("intermediateHyperCube")||e.intermediateHyperCube)return n.qMin>0&&n.qMax<1;if(n.classification&&"percentage"===n.classification)return true}return false},score:20,encodings:[{key:"values",classification:"measure",index:"0"}],adapt:function e(n){t.setValue(n,"measureAxis.max",1);n.disclaimerClosed=true}}]};return e}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={type:"scatterplot",supportsDuplicateDimensions:true,encodings:[{key:"dots",path:"qHyperCubeDef.qDimensions.0.qDef.qFieldDefs.0",classification:"dimension",min:1,encodings:[{key:"x-axis",classification:"measure",path:"qHyperCubeDef.qMeasures.0.qDef.qDef",min:1},{key:"y-axis",classification:"measure",path:"qHyperCubeDef.qMeasures.1.qDef.qDef",min:1},{key:"size",classification:"measure",path:"qHyperCubeDef.qMeasures.2.qDef.qDef"},{key:"color",classification:"dimension",path:"qHyperCubeDef.qDimensions.0.qDef.qAttrDims.0"},{key:"color",classification:"measure",path:"qHyperCubeDef.qDimensions.0.qAttributeExpressions.0"}]}],analyses:[{analysis:"comparison",dimensions:1,measures:{min:2,max:4},score:10,encodings:[{key:"dots",classification:"dimension",index:"0"},{key:"x-axis",classification:"measure",index:"0"},{key:"y-axis",classification:"measure",index:"1"},{key:"size",classification:"measure",index:"2"},{key:"color",classification:"measure",index:"3"}]},{analysis:"comparison",dimensions:2,measures:{min:2,max:3},criteria:function t(e){return e.isPerfectHierarchy()},score:10,encodings:[{key:"dots",classification:"dimension",index:"1"},{key:"color",classification:"dimension",index:"0"},{key:"x-axis",classification:"measure",index:"0"},{key:"y-axis",classification:"measure",index:"1"},{key:"size",classification:"measure",index:"2"}]}]};return t}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={type:"linechart",supportsDuplicateDimensions:false,encodings:[{key:"linePoints",path:"qHyperCubeDef.qDimensions.0.qDef.qFieldDefs.0",classification:"dimension",min:1,encodings:[{key:"lines",classification:"dimension",path:"qHyperCubeDef.qDimensions.1.qDef.qFieldDefs.0"},{key:"position",classification:"measure",path:"qHyperCubeDef.qMeasures.$measureIndex.qDef.qDef",pseudoDim:true,min:1,max:15}]}],analyses:[{analysis:"trend",dimensions:1,measures:{min:1,max:4},encodings:[{key:"linePoints",classification:"dimension",index:"0"},{key:"position",classification:"measure",indexRange:{start:0,end:3}}]},{analysis:"trend",dimensions:2,measures:1,criteria:function t(e){if(!e.qSize)return false;var n=e.getMetaDataForDimension(1);if(n&&n.qCardinal>12)return false;var i=e.getMetaDataForDimension(0);var a=e.getMetaDataForDimension(1);var s=i.qCardinal*a.qCardinal;return s===e.qSize.qcy},encodings:[{key:"linePoints",classification:"dimension",index:"0"},{key:"lines",classification:"dimension",index:"1"},{key:"position",classification:"measure",index:"0"}],adapt:function t(e){e.lineType="area";e.stackedArea=true}},{analysis:"trend",dimensions:2,measures:1,criteria:function t(e){var n=e.getMetaDataForDimension(1);return n&&n.qCardinal<13},encodings:[{key:"linePoints",classification:"dimension",index:"0"},{key:"lines",classification:"dimension",index:"1"},{key:"position",classification:"measure",index:"0"}]}]};return t}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={type:"table",supportsDuplicateDimensions:true,encodings:[{key:"columns",classification:"dimension",path:"qHyperCubeDef.qDimensions.$dimensionIndex.qDef.qFieldDefs.0",min:0,max:15},{key:"columns",classification:"measure",path:"qHyperCubeDef.qMeasures.$measureIndex.qDef.qDef",max:15}],analyses:[{analysis:"list",dimensions:{min:0,max:15},measures:{min:0,max:15},encodings:[{key:"columns",classification:"dimension",indexRange:{start:0,end:14}},{key:"columns",classification:"measure",indexRange:{start:0,end:14}}]}]};return t}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(49)],a=function(t){var e=t.getFlag("PIE_RADIUS");var n={type:"piechart",supportsDuplicateDimensions:true,encodings:[{key:"slices",path:"qHyperCubeDef.qDimensions.0",classification:"dimension",min:1,encodings:e?[{key:"angle",path:"qHyperCubeDef.qMeasures.0",classification:"measure",min:1},{key:"radius",path:"qHyperCubeDef.qMeasures.1",classification:"measure"}]:[{key:"angle",path:"qHyperCubeDef.qMeasures.0",classification:"measure",min:1},{key:"color",path:"qHyperCubeDef.qDimensions.0.qDef.qAttrDims.0",classification:"dimension"},{key:"color",classification:"measure"}]}],analyses:[{analysis:"rank",dimensions:1,measures:1,score:10,criteria:function t(e){var n=e.getMetaDataForDimension(0);var i=e.getMetaDataForMeasure(0);if(n&&n.qCardinal<13&&i&&i.aggregation&&"sum"===i.aggregation.toLowerCase()&&e.isSummable())return true;return false},encodings:e?[{key:"slices",classification:"dimension",index:"0"},{key:"angle",classification:"measure",index:"0"},{key:"radius",classification:"measure",index:"1"}]:[{key:"slices",classification:"dimension",index:"0"},{key:"color",classification:"dimension",index:"0"},{key:"angle",classification:"measure",index:"0"}]}]};return n}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={type:"combochart",supportsDuplicateDimensions:false,encodings:[{key:"records",classification:"dimension",path:"qHyperCubeDef.qDimensions.0.qDef.qFieldDefs.0",min:1,encodings:[{key:"bars",classification:"measure",path:"qHyperCubeDef.qMeasures.$measureIndex.qDef.qDef"},{key:"lines",classification:"measure",path:"qHyperCubeDef.qMeasures.$measureIndex.qDef.series",min:1,max:15}]}],analyses:[{analysis:"trend",dimensions:1,measures:2,score:10,criteria:function t(e){function n(t){return Math.log(t)/Math.LN10}var i=e.getMetaDataForMeasure(0);var a=e.getMetaDataForMeasure(1);var s=Math.floor(n(i.qMax));var r=Math.floor(n(a.qMax));var o=Math.abs(s-r);return o>=1},encodings:[{key:"records",classification:"dimension",index:"0"},{key:"bars",classification:"measure",index:"0"},{key:"lines",classification:"measure",index:"1"}]},{analysis:"contribution",dimensions:1,measures:2,score:20,adapt:function t(e){var n=[{qSortByState:0,qSortByFrequency:0,qSortByNumeric:-1,qSortByAscii:-1,qSortByLoadOrder:-1,qExpression:{qv:e.qHyperCubeDef.qMeasures[0].qDef.qDef},qSortByExpression:-1,qSortByGreyness:0}];var i={qType:"R",qnDec:2,qUseThou:0,qFmt:"#,##0.00%",qDec:".",qThou:","};e.qHyperCubeDef.qDimensions[0].qDef.qSortCriterias=n;e.qHyperCubeDef.qMeasures[1].qDef.qNumFormat=i},encodings:[{key:"records",classification:"dimension",index:"0"},{key:"bars",classification:"measure",index:"0"},{key:"lines",classification:"measure",index:"1"}]}]};return t}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={type:"treemap",supportsDuplicateDimensions:false,encodings:[{key:"blocks",classification:"dimension",path:["qHyperCubeDef.qDimensions.$dimensionIndex.qDef.qFieldDefs.0","qHyperCubeDef.qDimensions.$dimensionIndex.qDef.qFieldLabels.0"],min:1,max:15,encodings:[{key:"color",classification:"dimension",path:"qHyperCubeDef.qDimensions.0.qDef.qAttrDims.0"},{key:"size",classification:"measure",path:"qHyperCubeDef.qMeasures.$measureIndex.qDef.qDef",min:1},{key:"color",classification:"measure",path:"qHyperCubeDef.qDimensions.0.qDef.qAttrExps.0"}]}],analyses:[{analysis:"breakdown",dimensions:{min:2,max:15},measures:{min:1,max:2},criteria:function t(e){var n=e.getMetaDataForDimension(0);if(n&&n.qCardinal>12)return false;if(!e.isPerfectHierarchy())return false;var i=false;var a=e.getMetaDataForMeasure(0);var s=e.getMetaDataForMeasure(1);a&&a.qMin>=0&&(i=!s||s.qMin>=0);return i},score:10,encodings:[{key:"blocks",classification:"dimension",index:"0"},{key:"group",classification:"dimension",indexRange:{start:1,end:14}},{key:"size",classification:"measure",index:"0"},{key:"color",classification:"measure",index:"1"}]},{analysis:"breakdown",dimensions:2,measures:{min:1,max:2},criteria:function t(e){var n=e.getMetaDataForDimension(1);if(n&&n.qCardinal>12)return false;var i=e.getMetaDataForMeasure(0);var a=e.getMetaDataForMeasure(1);if(i&&i.qMin>=0)return!a;return false},encodings:[{key:"blocks",classification:"dimension",index:"1"},{key:"group",classification:"dimension",index:"0"},{key:"size",classification:"measure",index:"0"},{key:"color",classification:"measure",index:"1"}]}]};return t}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90)],a=function(t){var e={type:"map",supportsDuplicateDimensions:true,encodings:[{key:"point",classification:"dimension",min:1,encodings:[{key:"size",classification:"dimension"},{key:"color",classification:"measure"}]}],analyses:[{analysis:"polymapdistribution",dimensions:1,measures:{min:0,max:1},criteria:function t(){return true},score:100,encodings:[{key:"area",classification:"dimension",index:"0"},{key:"color",classification:"measure",index:"0"}]},{analysis:"pointmapdistribution",dimensions:1,measures:{min:0,max:2},criteria:function t(){return true},score:100,encodings:[{key:"points",classification:"dimension",index:"0"},{key:"custom",classification:"measure",index:"0",adapt:function e(n,i){if(i.isFieldValue()||i.isExpressionValue()){t.setValue(n,"size.expression.key",i.getExpression());t.setValue(n,"size.expression.label",i.getExpression());t.setValue(n,"size.expression.type","expression")}else if(i.isLibraryValue()){t.setValue(n,"size.expression.key",i.getLibraryId());t.setValue(n,"size.expression.label","");t.setValue(n,"size.expression.type","libraryItem")}}},{key:"color",classification:"measure",index:"1"}]},{analysis:"geoAnalysis",dimensions:{min:1,max:2},measures:{min:0,max:2},criteria:function t(){return true},score:100,encodings:[{key:"area",classification:"dimension"},{key:"points",classification:"dimension"},{key:"color",classification:"measure",index:"0"},{key:"custom",classification:"measure",index:"1",adapt:function e(n,i){if(i.isFieldValue()||i.isExpressionValue()){t.setValue(n,"size.expression.key",i.getExpression());t.setValue(n,"size.expression.label",i.getExpression());t.setValue(n,"size.expression.type","expression")}else if(i.isLibraryValue()){t.setValue(n,"size.expression.key",i.getLibraryId());t.setValue(n,"size.expression.label","");t.setValue(n,"size.expression.type","libraryItem")}}}]}]};return e}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={type:"distributionplot",supportsDuplicateDimensions:false,encodings:[{key:"records",classification:"dimension",min:1,encodings:[{key:"bars",classification:"dimension"},{key:"lines",classification:"measure",min:1}]}],analyses:[{analysis:"overview",dimensions:{min:1,max:2},measures:1,criteria:function t(e){var n=false;var i=e.getMetaDataForDimension(0);var a=e.getMetaDataForDimension(1);i&&i.qCardinal<=500&&(a?a&&a.qCardinal<=500&&(n=true):n=true);return n},encodings:[{key:"records",classification:"dimension",index:"1"},{key:"bars",classification:"dimension",index:"0"},{key:"lines",classification:"measure",index:"0"}]}]};return t}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={type:"boxplot",supportsDuplicateDimensions:true,encodings:[{key:"records",classification:"dimension",min:1,encodings:[{key:"bars",classification:"dimension"},{key:"lines",classification:"measure",min:1}]}],analyses:[{analysis:"overview",dimensions:{min:1,max:2},measures:1,criteria:function t(e){var n=false;var i=e.getMetaDataForDimension(0);var a=e.getMetaDataForDimension(1);i&&i.qCardinal>500?n=true:a&&a.qCardinal>500&&(n=true);return n},encodings:[{key:"records",classification:"dimension",index:"1"},{key:"bars",classification:"dimension",index:"0"},{key:"lines",classification:"measure",index:"0"}]}]};return t}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={type:"histogram",supportsDuplicateDimensions:true,encodings:[{key:"values",path:"qHyperCubeDef.qDimensions.0.qDef.qFieldDefs.0",classification:"numeric dimension",min:1}],analyses:[{analysis:"values",dimensions:1,measures:0,criteria:function t(e){var n=e.getMetaDataForDimension(0);if(n&&("integer"===n.dataType||"double"===n.dataType))return true;return false},encodings:[{key:"values",classification:"dimension",index:0}]}]};return t}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={type:"pivot-table",supportsDuplicateDimensions:false,encodings:[{key:"rows",classification:"dimension",path:"qHyperCubeDef.qDimensions.$dimensionIndex.qDef.qFieldDefs.0",min:1,max:15},{key:"values",classification:"measure",path:"qHyperCubeDef.qMeasures.$measureIndex.qDef.qDef",min:1,max:15}],analyses:[{analysis:"rank",dimensions:{min:2,max:15},measures:{min:1,max:15},encodings:[{key:"rows",classification:"dimension",indexRange:{start:0,end:14}},{key:"values",classification:"measure",indexRange:{start:0,end:14}}]}]};return t}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){function t(t){this.type="eLibItem"===t.cType?"library":"eField"===t.cType?"field":"eInlineExpr"===t.cType?"expression":"unknown";this.expr=t.expr;this.field=t.field;this.libId=t.libId}t.prototype.isLibraryValue=function(){return"library"===this.type};t.prototype.getLibraryId=function(){return this.libId};t.prototype.isFieldValue=function(){return"field"===this.type};t.prototype.getFieldName=function(){return this.field||this.expr};t.prototype.isExpressionValue=function(){return"expression"===this.type};t.prototype.getExpression=function(){return this.expr};function e(t,e,n,i,a){this.key=t;this.classification=e;this.value=n;this.adapt=i;this.optionalObj=a}e.prototype.isMeasure=function(){return-1!==this.classification.indexOf("measure")};e.prototype.isDimension=function(){return-1!==this.classification.indexOf("dimension")};e.prototype.isColorBy=function(){return"color"===this.key};e.prototype.isCustom=function(){return"custom"===this.key};return{Value:t,Encoding:e}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90),n(282),n(204),n(483),n(879),n(89),n(186)],a=function(t,e,n,i,a,s,r){a=a.default;return{generateProperties:d};function o(e,s,r,o,l,c,u){var d=a.getInitialProperties(e);d.cId=t.generateId();var h=a.getDataSection().items.data;s.gaLayers.unshift(d);var f=d;var g=new n({app:r,dimensionDefinition:h.dimension||{},measureDefinition:h.measure||{},dimensionProperties:d.qHyperCubeDef.qDimensions,measureProperties:d.qHyperCubeDef.qMeasures,globalChangeListeners:[function(t){i.colorByUpdater(t,"qHyperCubeDef.",t.color)}]});g.setProperties(f);return p(g,s,f,o,l,c,u)}function l(t,e,n){var i=["points","custom"];var a=["area"];var s=["color"];var r=[];if(t||e){var o=[];var l=[];if(t){o=u(a,s,n);r[t]=o}if(e){l=o.length>0?u(i,[],n):u(i,s,n);r[e]=l}}return r}function c(t,e){var n=[];e.forEach(function(e){var i=e.key;t.indexOf(i)>=0&&n.push(e)});return n}function u(t,e,n){var i=[];var a=c(t,n);if(a.length>0){i.push.apply(i,a);if(e.length>0){var s=c(e,n);i.push.apply(i,s)}}return i}function d(t,n,i){var a=t.type;return s.all([e.getExtensionType(a),e.getInitialProperties(a)]).then(function(e){var r=e[0];var c=e[1];c.isRecommended=t.score>-1;var u;var d=c;if("map"===a){var h="AreaLayer";var f="PointLayer";var g=[];var v=[];var m=l(h,f,t.encodings);m[h]&&(v=m[h]);m[f]&&(g=m[f]);if(g.length>0&&v.length>0){o(f,c,i,n,t,g,r);return o(h,c,i,n,t,v,r)}return g.length>0?o(f,c,i,n,t,g,r):h.length>0?o(h,c,i,n,t,v,r):s.resolve()}d=c;r.mapProperties();u=r.getCreatePropertyHandler.call(r,i);u.setProperties(d);return p(u,c,d,n,t,t.encodings,r)})}function p(t,e,n,i,a,s,r){var o={dimensions:i?i.qHyperCubeDef.qDimensions.map(function(t){return t}):[],measures:i?i.qHyperCubeDef.qMeasures.map(function(t){return t}):[]};return h(s,0,o,n,t).then(function(){a.adapt&&a.adapt(e);m(e);var t=r.exportProperties&&r.importProperties;return t?r.importProperties(r.exportProperties({qProperty:e},r.options.hyperCubePath),e,r,r.options.hyperCubePath).qProperty:e})}function h(t,e,n,i,a){if(e>=t.length)return s.resolve();return f(t[e],n,i,a).then(function(){return h(t,e+1,n,i,a)})}function f(e,n,a,o){var l=e.value;if(e.isColorBy()){if(a.color){var c=e.isMeasure();var u=g(e,n);var d;if(l.isFieldValue()||l.isExpressionValue()){d={type:c?"expression":"field",name:c||l.isExpressionValue()?l.getExpression():l.getFieldName()};u&&(d.label=c?u.qDef.qLabel:u.qDef.qFieldLabels[0]);d.label||(d.label=r.convertEvaluationExpressionToLabel(d.name))}else l.isLibraryValue()&&(d={type:c?"measure":"dimension",id:l.getLibraryId()});if(d){e.adapt&&e.adapt(d);i.setColorByPropertyDef(a.color,d);o.updateGlobalChangeListeners()}}}else if(e.isCustom())e.adapt(a,l);else if(e.isMeasure()){var p;var h=g(e,n);if(h)p=t.extend(true,{},h);else if(l.isFieldValue()||l.isExpressionValue()){var f=l.getExpression();var v=r.convertEvaluationExpressionToLabel(f);p=o.createExpressionMeasure(f,v)}else if(l.isLibraryValue()){var m=l.getLibraryId();p=o.createLibraryMeasure(m)}if(p){e.adapt&&e.adapt(p);return o.addMeasure(p,void 0,void 0,true)}}else if(e.isDimension()){var b;var y=g(e,n);if(y)b=t.extend(true,{},y);else if(l.isFieldValue()){var S=r.convertEvaluationExpressionToLabel(l.getFieldName());var x=l.getExpression();b=o.createFieldDimension(x,S)}else if(l.isExpressionValue()){var q=l.getExpression();var I=r.convertEvaluationExpressionToLabel(q);b=o.createFieldDimension(q,I)}else if(l.isLibraryValue()){var C=l.getLibraryId();b=o.createLibraryDimension(C)}if(b){e.adapt&&e.adapt(b);return o.addDimension(b).then(function(){var t=e.optionalObj;if(t&&t.mapProperties){var n=t.mapProperties;var i="";b.qDef&&b.qDef.qFieldDefs&&b.qDef.qFieldDefs.length>0&&(i=b.qDef.qFieldDefs[0]);o.properties.locationOrLatitude.key=n.expr;o.properties.locationOrLatitude.label=n.field;o.properties.locationOrLatitude.type="expression";o.properties.locationDefault=o.properties.locationOrLatitude.key;o.properties.label.expression.key=i;o.properties.label.expression.type="expression";o.properties.label.expression.label="dimension.qDef.qFieldDefs[0]"}})}}return s.resolve()}function g(t,e){var n=t.value;if(t.isMeasure()){if(n.isFieldValue()||n.isExpressionValue()){var i=n.getExpression();var a=r.normalizeExpression(i);var s=v(e.measures,function(t){return t.qDef&&r.normalizeExpression(t.qDef.qDef)===a});return s}if(n.isLibraryValue()){var o=n.getLibraryId();var l=v(e.measures,function(t){return t.qLibraryId===o});return l}}else if(t.isDimension()){if(n.isFieldValue()){var c=n.getExpression();var u=r.normalizeExpression(c);var d=v(e.dimensions,function(t){return t.qDef&&t.qDef.qFieldDefs&&r.normalizeExpression(t.qDef.qFieldDefs[0])===u});return d}if(n.isExpressionValue()){var p=n.getExpression();var h=r.normalizeExpression(p);var f=v(e.dimensions,function(t){return t.qDef&&t.qDef.qFieldDefs&&r.normalizeExpression(t.qDef.qFieldDefs[0])===h});return f}if(n.isLibraryValue()){var g=n.getLibraryId();var m=v(e.dimensions,function(t){return t.qLibraryId===g});return m}}return}function v(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(e(i)){t.splice(n,1);return i}}return}function m(e){if(e.qHyperCubeDef){var n=e.qHyperCubeDef.qDimensions;var i=e.qHyperCubeDef.qMeasures;n.forEach(function(e){e.qDef.cId=t.generateId()});i.forEach(function(e){e.qDef.cId=t.generateId()})}}}.apply(e,i),void 0!==a&&(t.exports=a))},,function(t,e,n){"use strict";var i,a;!(i=[n(48),n(54),n(89),n(186),n(1117),n(229),n(233)],a=function(t,e,n,i,a,s){return{createDataCollection:r,adaptDataCollectionForRecommendations:o};function r(e,r,o){if(o)return a.createDataCollection(o,r.qHyperCubeDef.qDimensions,r.qHyperCubeDef.qMeasures);return n.all({appFieldList:e.getFieldList(),classificationsResult:t.getService("classificationService").getClassification()}).then(function(t){var e=t.appFieldList;var n=t.classificationsResult;var o=n?new s(n):void 0;i.addClassificationDataToFields(e,o);return a.createDataCollection(e,r.qHyperCubeDef.qDimensions,r.qHyperCubeDef.qMeasures)})}function o(t,e){var n={fields:[],libItems:[],expressions:[]};t.dimensions.forEach(function(t,a){var s={};if(e.qDimensionInfo&&e.qDimensionInfo.length>a){var r=e.qDimensionInfo[a];s.distinctCount=r.qCardinal}if(t.isLibraryItem())n.libItems.push({libId:t.libId,overrides:s});else if(t.isFieldItem()){n.fields.push({name:t.name,overrides:s});i.isDimension(t.defaultClassifications)||(s.classifications=[i.Constants.dimension])}else{n.expressions.push({expr:t.expr,overrides:s});l(t.expr,e)?s.classifications=[i.Constants.temporal]:s.classifications=[i.Constants.dimension]}});t.measures.forEach(function(t,a){var s={};if(e.qMeasureInfo&&e.qMeasureInfo.length>a){var r=e.qMeasureInfo[a];s.valueRange={min:r.qMin,max:r.qMax}}if(t.isLibraryItem())n.libItems.push({libId:t.libId,overrides:s});else if(t.isFieldItem()){n.fields.push({name:t.name,overrides:s});s.defaultAggregation=t.aggregation;i.isMeasure(t.defaultClassifications)||(s.classifications=[i.Constants.measure])}else{n.expressions.push({expr:t.expr,overrides:s});s.classifications=[i.Constants.measure]}});n.stats={total:t.dimensions.length+t.measures.length,dims:t.dimensions.length,msrs:t.measures.length};return n}function l(t,n){if(n&&n.qDimensionInfo){var i=e.find(n.qDimensionInfo,function(e){return e.qGroupFieldDefs&&e.qGroupFieldDefs.indexOf(t)>=0});return i&&i.qDerivedField}return false}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(54),n(92),n(1118)],a=function(t,e,n){var i=["sum","count","avg","min","max"];var a=e.extend("DataCollectionFactory",{getField:function e(n,i){return t.find(n,function(t){return t.qName===i})},isAggregation:function t(e){return e&&i.indexOf(e.toLowerCase())>=0},unwrapName:function t(e){var n="["===e.charAt(0)&&"]"===e.charAt(e.length-1)?e.substring(1,e.length-1):e;return n},createDataCollection:function t(e,i,a){var s=this;var r=new n.DataCollection;i.forEach(function(t){var i;if(t.qLibraryId)i=new n.Dimension({libId:t.qLibraryId});else{var a=t.qDef.qFieldDefs[0];var o=s.unwrapName(a);var l=s.getField(e,o);i=l?new n.Dimension({dataTypes:l.dataTypes,defaultClassifications:l.classifications,name:o,expr:a}):new n.Dimension({expr:a})}i&&r.dimensions.push(i)});a.forEach(function(t){var i;if(t.qLibraryId)i=new n.Measure({libId:t.qLibraryId});else{var a=t.qDef.qDef;var o=/^=?(.+)\(((\[(.+)\])|((.+)))\)$/;var l=o.exec(a);if(l){l=l.filter(function(t){return t});if(l.length>=5){var c=l[1];var u=l[4];c&&(c=c.trim());if(s.isAggregation(c)){var d=s.getField(e,u);d&&(i=new n.Measure({dataTypes:d.dataTypes,defaultClassifications:d.classifications,defaultAggregation:d.defaultAggregation,aggregation:c,name:u,expr:a}))}}}i||(i=new n.Measure({expr:a}))}i&&r.measures.push(i)});return r},merge:function t(e){var i=new n.DataCollection;e.forEach(function(t){i.dimensions=i.dimensions.concat(t.dimensions);i.measures=i.measures.concat(t.measures)});return i}});return new a}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){function t(t){this.name=t.name;this.expr=t.expr;this.defaultClassifications=t.defaultClassifications;this.libId=t.libId;this.dataTypes=t.dataTypes}t.prototype.isLibraryItem=function(){return!!this.libId};t.prototype.isFieldItem=function(){return!!this.name};function e(t){this.name=t.name;this.aggregation=t.aggregation;this.defaultAggregation=t.defaultAggregation;this.defaultClassifications=t.defaultClassifications;this.expr=t.expr;this.libId=t.libId;this.dataTypes=t.dataTypes}e.prototype.isLibraryItem=function(){return!!this.libId};e.prototype.isFieldItem=function(){return!!this.name};function n(){this.dimensions=[];this.measures=[]}n.prototype.size=function(){return this.dimensions.length+this.measures.length};return{Dimension:t,Measure:e,DataCollection:n}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(54),n(90),n(1120),n(186)],a=function(t,e,n,i){var a={collectFromRecommendation:r,merge:l};function s(t,e,n,a){a=a||[];var s=-1;t&&e&&e.some(function(e,r){"dimension"===n?(t.qLibraryId&&t.qLibraryId===e.libId||i.normalizeExpression(t.qDef.qFieldDefs[0])===i.normalizeExpression(e.expr))&&-1===a.indexOf(r)&&(s=r):"measure"===n&&(t.qLibraryId&&t.qLibraryId===e.libId||i.normalizeExpression(t.qDef.qDef)===i.normalizeExpression(e.expr))&&(s=r);return-1!==s});return s}function r(e){var i=e.analysis.dims?e.analysis.dims:[];var a=e.analysis.msrs?e.analysis.msrs:[];var s=e.matchRecord?e.matchRecord.matches:[];var r=i.map(function(t){var e={dataType:"",qCardinal:0};if("eField"===t.cType){e.expr=t.expr;e.qGroupFieldDefs=[t.field]}else"eInlineExpr"===t.cType?e.expr=t.expr:"eLibItem"===t.cType&&(e.libId=t.libId);if(t.fieldStats){e.dataType=t.fieldStats.dataType||"";e.qCardinal=t.fieldStats.distinctCount||0}return e});var l=a.map(function(e){var n={dataType:"",qMax:0,qMin:0,aggregation:"",libItemLabel:""};if("eField"===e.cType){n.expr=e.expr;var i=t.findWhere(s,{field:e.field});i&&i.aggr&&(n.aggregation=i.aggr)}else"eInlineExpr"===e.cType?n.expr=e.expr:"eLibItem"===e.cType&&(n.libId=e.libId);if(e.fieldStats){n.dataType=e.fieldStats.dataType||"";if(e.fieldStats.valueRange){n.qMax=e.fieldStats.valueRange.max;n.qMin=e.fieldStats.valueRange.min}if("eLibItem"===e.cType&&e.fieldStats.classification&&e.fieldStats.classification.length>0){var a=e.fieldStats.classification[0];n.classification=a}}return n});var c=o(e);var u={};u.intermediateHyperCube=false;return new n(r,l,c,u)}function o(e){var n=[];var i=e.analysis;var a=e.matchRecord;if(a&&i.dims&&i.dims.length>1){var s=true;for(var r=1;r<i.dims.length;r++){var o=i.dims[r];if("eField"!==o.cType){s=false;break}var l=t.findWhere(a.matches,{field:o.field});if(!l.groupCriteria||l.groupCriteria.indexOf("sameHierarchy")<0){s=false;break}}s&&n.push({name:"perfectHierarchy",result:"1"})}return n}function l(t,i,a,r){var l=r.analysis.dims?r.analysis.dims:[];var c=r.analysis.msrs?r.analysis.msrs:[];var u=new Array(c.length);var p=new Array(l.length);var h=[];t.qDimensionInfo.forEach(function(e,n){var o=i.qDimensions[n];var l=s(o,r.analysis.dims,"dimension",h);h.push(l);p.splice(l,1,d(t.qDimensionInfo[n],n,"dimension",i,a))});t.qMeasureInfo.forEach(function(e,n){var o=i.qMeasures[n];var l=s(o,r.analysis.msrs,"measure");u.splice(l,1,d(t.qMeasureInfo[n],n,"measure",i,a))});var f={qSize:e.extend(true,{},t.qSize)};var g=o(r);return new n(p,u,g,f)}function c(t,e,n,i,a){var s;var r=[];switch(i){case"dimension":r=a.dimensions;break;case"measure":r=a.measures;break}r.some(function(i){var a=false;if(e){a=i.expr===e;t.dataType=i.dataTypes&&i.dataTypes.length>0?i.dataTypes[0]:null;t.aggregation=i.aggregation?i.aggregation:null}else n&&(a=i.libId===n);s=a?i:s;return a})}function u(t,e,n,i,a){var s;var r;var o;function l(t,e){var n=!!s.qLibraryId;n?o=s.qLibraryId:"dimension"===e?r=s.qDef.qFieldDefs[0]:"measure"===e&&(r=s.qDef.qDef)}if("dimension"===n){s=i.qDimensions[e];l(s,"dimension")}else if("measure"===n){s=i.qMeasures[e];l(s,"measure")}c(t,r,o,n,a)}function d(t,n,i,a,s){var r=e.extend(true,{},t,n);u(r,n,i,a,s);return r}return a}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90)],a=function(t){function e(e,n,i,a){this.measures=n;this.dimensions=e;this.overallIndicators=i;t.extend(true,this,a)}e.prototype.getMetaDataForDimension=function(t){if(this.dimensions.length>t){var e=this.dimensions[t];return e}return};e.prototype.getMetaDataForMeasure=function(t){if(this.measures.length>t){var e=this.measures[t];return e}return};e.prototype.getIndicatorByName=function(t){var e=void 0;this.overallIndicators&&this.overallIndicators.some(function(n){var i=n.name===t;i&&(e=n);return i});return e};e.prototype.isSummable=function(){var t=this.getIndicatorByName("summable");return t&&"1"===t.result};e.prototype.isPerfectHierarchy=function(){var t=this.getIndicatorByName("perfectHierarchy");return t&&"1"===t.result};return e}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90)],a=function(t){var e={generateHash:n,updateHash:i};return e;function n(e){return t.hashFromString(JSON.stringify(e))}function i(t,n){t.qUndoExclude||(t.qUndoExclude={});t.qUndoExclude.hashCode=e.generateHash(n)}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90),n(89)],a=function(t,e){var n={getDefaultHashDataForHyperCube:i};return n;function i(t,e,n){return a(t,n).then(function(t){return{drillLevel:o(e),dimensionExpressions:r(e),measureExpressions:t}})}function a(t,n){var i=[];if(!t.qMeasures)return e.resolve(i);t.qMeasures.forEach(function(t){t.qLibraryId?i.push(s(t.qLibraryId,n)):i.push(e.resolve())});return e.all(i)}function s(t,e){return e.getMeasure(t).then(function(t){return t.getProperties().then(function(t){return t.qMeasure.qDef})})}function r(t){return t.qDimensionInfo.map(function(t){return t.qGroupFieldDefs})}function o(t){var e=l(t);return e.map(function(t){return t.qGroupPos})}function l(e){return t.getValue(e,"qDimensionInfo",[])}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){return{validate:t};function t(t){if(!t||!t.layout||!t.properties||!t.model||!t.hashData||!t.generateDerivedProperties)throw Error("Derived-properties: Missing input")}}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(1499),n(1505),n(1506),n(1507),n(1508),n(1509),n(1510),n(1511),n(1512),n(1513),n(1514),n(1515),n(1516),n(1517),n(1518),n(1519),n(1520),n(1521),n(90)],a=function(t,e,n,i,a,s,r,o,l,c,u,d,p,h,f,g,v,m,b){function y(t,h,b){switch(t){case"scale":return e(h,b);case"measure-scale":return e.measureScale(h,b);case"dimension-scale":return e.dimensionScale(h,b);case"axis":return n(h,b);case"box-marker":return i(h,b);case"point-marker":return o(h,b);case"scrollbar":return l(h,b);case"text":return c(h,b);case"lasso":return u(h,b);case"range":return d(h,b);case"range-area":return m(h,b);case"categorical-legend":return g(h,b);case"sequential-legend":return v(h,b);case"x-axis":return n.xAxis(h,b);case"y-axis":return n.yAxis(h,b);case"x-axis-title":return c.xAxisTitle(h,b);case"y-axis-title":return c.yAxisTitle(h,b);case"grid-line":return s(h,b);case"interaction":return r(h,b);case"ref-line":return p(h,b);case"event-area":return a(h,b);case"labels":return f(h,b)}}function S(t){this.options=t||{};this.settings={dockLayout:{layoutModes:h()},components:[],scales:{}}}S.prototype.addComponent=function t(e,n,i){var a=b.extend(true,{},this.options,i||{});var s=y(e,n,a);this.settings.components.push(s);return s};S.prototype.addInteraction=function t(e,n){var i=b.extend(true,{},this.options,n||{});var a=y("interaction",e,i);this.settings.interactions||(this.settings.interactions=[]);this.settings.interactions.push(a);return a};S.prototype.addScale=function t(e,n,i){var a=b.extend(true,{},this.options,i||{});var s=y(e,n,a);this.settings.scales[s.name]=s.component};S.prototype.getSettings=function t(){return this.settings};S.prototype.getComponent=function t(e){return this.settings.components.filter(function(t){return t.key===e})[0]};S.prototype.addPreset=function(e,n){t(e,this,n)};S.validateComponentKeys=function t(e){var n={};return e.map(function(t){var e=t.key;if(!e)return"Missing key for component "+t.type;if(n[e])return"Duplicate key for component "+t.type;n[e]=true;return null}).filter(function(t){return!!t})};S.create=function(t){return new S(t)};S.createComponent=y;return S}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){function t(t,e,a){return"y"===t?n(e,a):i(e)}function e(e,n,i){var a="far"===n?"near":"far";return t(e,a,i)}function n(t,e){var n=t||"near";return e&&"near"===n||!e&&"far"===n?"right":"left"}function i(t){return"far"===t?"top":"bottom"}return{getAxisDock:t,getOppositeAxisDock:e,getYAxisDock:n}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i;!(i=function(){var t={CENTER:0,BOTTOM:1};var e=[{label:"NoDataExist",alignment:t.CENTER,default:true},{label:"OnlyNanData",alignment:t.CENTER,default:true},{label:"OnlyNegativeOrZeroValues",alignment:t.CENTER,default:false},{label:"LimitedData",alignment:t.BOTTOM,default:false},{label:"OnlyNanColor",alignment:t.BOTTOM,default:false},{label:"NegativeOrZeroValues",alignment:t.BOTTOM,default:false},{label:"DataRangeIncludingZero",alignment:t.BOTTOM,default:false}];return{DISCLAIMERS:e,ALIGNMENT:t}}.call(e,n,e,t),void 0!==i&&(t.exports=i))},,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(109),n(395)],a=function(t,e){function n(e,n){return t.toHex(t.blend(e,n,.5))}function i(t,e,i){if(t.length!==e.length+1||e.length!==i.length)return false;var a=[t[0]];var s=[];var r=e.length;var o;for(o=0;o<r;o++)if(e[o]){a.push(n(t[o],t[o+1]));a.push(n(t[o],t[o+1]));s.push(i[o]);if(o!==r-1){a.push(t[o+1]);a.push(t[o+1]);s.push((i[o]+i[o+1])/2)}}else{a.push(t[o]);a.push(t[o+1]);s.push(i[o]);if(o!==r-1&&e[o+1]){a.push(t[o+1]);a.push(t[o+1]);s.push((i[o]+i[o+1])/2)}}a.push(t[o]);return{colors:a.reverse(),limits:s}}function a(t,e,n,i){var a=t.getLegendParts(0);var s=[];var r=e.max-e.min;if(Number.isNaN(+r))return s;var o;var l;var c=e.max;var u;for(var d=0;d<a.length;d++){o=a[d];if(i)u=d===a.length-1?e.min:i[a.length-1-d-1];else{l=(o.limits[1]-o.limits[0])*r;u=c-l}o.isMax=0===d;o.max=n.formatValue(o.isMax?e.max:c);o.min=n.formatValue(d+1===a.length?e.min:u);o.id=[];o.id[0]=o.isMax?e.max:c;o.id[1]=d===a.length-1?e.min:u;o.type="range";c=u;s.push(o)}return s}function s(t,n){var i,a,s=new e,r;if(n)for(a=0;a<t.length;a++){r=t[a];if(r)for(i=0;i<r.length;i+=2)s.addColorPart(r[i],r[i+1],a)}else for(i=0;i<t.length;i+=2)s.addColorPart(t[i],t[i+1]);return s}return{setupColors:i,setupLegend:a,createColorScale:s}}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(11),n(92),n(511),n(246)],a=function(t,e,n){function i(t){return!!t.qIsAutoFormat&&["M","D","T","TS","IV"].indexOf(t.qNumFormat.qType)<0}var a=e.extend("ChartFormatting",{init:function e(n,i){this.localeInfo=n;var a=this.getFormattersForMeasures(i);var s=t.extend(true,[],a);if(s&&1===s.length&&i[0].isCustomFormatted)s=null;else{var r=0;for(var o=0;o<s.length;o++)if(i[o].isCustomFormatted){s[o]=null;r++}r===s.length&&(s=null)}this.measureFormatters=s;this.combinedMeasuresFormatter=this.getFormatterFromFormatters(a)},createFormatter:function t(){return new n(this.localeInfo)},getLocaleInfo:function t(){return this.localeInfo||{}},getFormatters:function t(){return this.measureFormatters||[]},getMeasureFormatter:function t(e){if(this.measureFormatters&&this.measureFormatters[e])return this.measureFormatters[e]},getCombinedMeasuresFormatter:function t(){return this.combinedMeasuresFormatter},formatMeasure:function t(e,n){var i=this.measureFormatters[n];if(i)return i.format(e);return e},getFormatterFromFormatters:function t(e){var i=0,a=0,s,r,o,l=0,c=e?e.filter(function(t){return!!t.values&&!Number.isNaN(+t.values.range)}):[],u,d;if(e&&e.length){e.forEach(function(t){"U"===t.type||t.values&&Number.isNaN(+t.values.range)?a++:["D","T","TS","IV"].contains(t.type)?i=1:l=1;t.prepare();return t});if(c.length){s=c.reduce(function(t,e){return Math.min(e.values.min,t)},c[0].values.min);r=c.reduce(function(t,e){return Math.max(e.values.max,t)},c[0].values.max);o=Math.abs(r-s)}if(i+l>1){d=e.filter(function(t){return"datetime"!==t.type})[0]||{};u=new n(this.localeInfo,d.pattern,d.thousandDelimiter,d.decimalDelimiter,"U");Number.isNaN(+o)||(u.pattern=u.createPatternFromRange(s,r,true))}else if(i+l===1&&0===a){d=e[0]||{};u=new n(this.localeInfo,d.pattern,d.thousandDelimiter,d.decimalDelimiter,d.type)}else{d=e.filter(function(t){return"U"!==t.type});d=d.length?d[0]:e[0]||{};u=new n(this.localeInfo,d.pattern,d.thousandDelimiter,d.decimalDelimiter,d.type);Number.isNaN(+o)||"U"!==d.type||(u.pattern=u.createPatternFromRange(s,r,true))}u.prepare()}u||(u=new n(this.localeInfo,"0"));return u},getFormattersForMeasures:function t(e,a){var s=[],r;if(e&&e.length){r=a?e.filter(function(t,e){return a.indexOf(e)>=0}):e;s=r.map(function(t){var e=i(t),a=new n(this.localeInfo,t.qNumFormat.qFmt,t.qNumFormat.qThou,t.qNumFormat.qDec,e?"U":t.qNumFormat.qType),s=Math.abs(t.qMax-t.qMin),r=Number.isNaN(+s);a.values={min:t.qMin,max:t.qMax,range:s};!r&&e&&(a.pattern=a.createPatternFromRange(t.qMin,t.qMax,true));a.prepare();return a},this)}return s}});return a}.apply(e,i),void 0!==a&&(t.exports=a))},,,,function(t,e,n){"use strict";var i,a;!(i=[n(91),n(96)],a=function(t,e){var n=-2;var i=-3;var a=200;var s=50;return{getLegendData:p,getCategoricalLegendPanGesture:h,onMouseWheel:f};function r(t){return t.label?t.label:t.min&&t.max?t.min+" - "+(t.isMax?"":"<")+t.max:t.max?"<"+t.max:">"+t.min}function o(e){var r=e.colorItems;var o=e.selectionSettings;var l=e.colorMap;var c=e.colorDataInfo;var u=l.getLegendDataProvider()?l.getLegendDataProvider().getLegendMarker():"rect";var d=r.map(function(t){return Array.isArray(t.id)?t.id[0]:t.id});var p=r.map(function(t){return t.color.toRGBA()});var h=function t(e){return l.getColorFromPreScaledValue(e.qElemNo)};var f=function t(e){return h(e).toHex()};var g=function t(e){var i=h(e);return e.qElemNo!==n&&!i.isInvalid()};var v={extract:{source:e.source,field:"qDimensionInfo/"+(e.dimIndex||0),props:{label:function t(e){return e.qText}}}};if(c.hasOthers){var m=t.get("properties.dimensionLimits.others");var b=l.getColorFromPreScaledValue([i],m);v.amend=[{value:i,label:{value:m},color:{value:b},source:{}}];d.push(i);p.push(b)}var y=function t(e){return e.datum.color.value};var S=function t(e){return{data:e.data,context:e.context,style:{inactive:e.style.inactive}}};var x={displayOrder:a,minimumLayoutMode:"MEDIUM",prioOrder:s,renderer:"svg",mounted:function t(e){e.children[0].style.pointerEvents="none"},scale:{type:"categorical-color",data:v,label:function t(e){return e.datum.label.value},trackBy:"id"},settings:{title:e.title,item:{shape:{type:u}}},brush:{trigger:o&&o.trigger||[],consume:(o&&o.consume||[]).map(S)}};if(c.altMode){x.scale.domain=d;x.scale.range=p}else{x.scale.data.extract.props.color=f;x.scale.data.extract.filter=g;x.settings.item.shape.fill=y}return x}function l(t){var e=t.colorItems;var n=t.colorMap;var i=n.getLegendDataProvider()?n.getLegendDataProvider().getLegendMarker():"rect";var o=e.map(r);var l=e.map(function(t){return t.color.toRGBA()});return{displayOrder:a,minimumLayoutMode:"MEDIUM",prioOrder:s,scale:{type:"categorical-color",domain:o,range:l},settings:{title:t.title,item:{shape:{type:i}}}}}function c(t){var e=t.colorItems;var n=[];var i=[];var r=e[e.length-1].id[1];var o=e[0].id[0];var l=e[e.length-1].min;var c=e[0].max;var u=(o-r)/1e6;e.forEach(function(t){n.push(t.id[0]-u);n.push(t.id[1]+u)});e.forEach(function(t){i.push(t.grad[0].toRGBA());i.push(t.grad[1].toRGBA())});return{displayOrder:a,prioOrder:s,settings:{fill:{type:"color",range:i,domain:n,min:r,max:o},major:{type:"linear",min:r,max:o},tick:{label:function t(e){return 0===e?l:c}},title:t.title}}}function u(t,e,n){var i;if(n&&"dimension"===e.colorMode){i=n.map(function(e,n){var i=e[1].qNum;var a=e[0].qText;var s=t.getColorFromPreScaledValue(i,a);return{id:e[0].qElemNumber,index:n,label:a,color:s}});i=i.filter(function(t){return!t.color.isInvalid()}).slice(0,100)}else{i=t.getColorMapping().concat();i=i.filter(function(t){return!t.color.isInvalid()})}return i}function d(t,e){return{show:e.showTitle,text:t.getLegendTitle()}}function p(t){var e=t.colorMap;var n=e.getColorDataInfo();var i=n.legendMode||{};if(!n.valid)return;var a=u(e,i,t.legendData);if(0===a.length)return;var s={colorMap:e,selectionSettings:t.selectionSettings,source:t.source,dimIndex:t.dimIndex,colorDataInfo:n,colorItems:a,title:d(e,i)};return i.discrete?{type:"categorical-legend",settings:"dimension"===i.colorMode?o(s):l(s)}:{type:"sequential-legend",settings:c(s)}}function h(t){var n;function i(e,n){if(!n)return false;var i={x:n.center.x-n.deltaX,y:n.center.y-n.deltaY};var a=this.chart.componentsFromPoint(i);return a.some(function(e){return e.settings.key===t})}function a(){if(n){clearInterval(n);n=null}}return[{type:"Pan",options:{event:"catlegendpan",threshold:1,enable:i},events:{catlegendpanstart:function e(){a();var n=this.chart.component(t);n.emit("panstart")},catlegendpanmove:function e(n){var i=this.chart.component(t);i.emit("panmove",n)},catlegendpanend:function e(){var n=this.chart.component(t);n.emit("panend")},catlegendpancancel:function e(){var n=this.chart.component(t);n.emit("panend")}}},{type:"Press",options:{enable:i},events:{press:function i(s){var r=this.chart.component(t);var o=s.target;var l=o?o.getAttribute("data-action"):"";if(l){a();n=setInterval(function(){r.emit(l)},100);e.preventGestures()}},pressup:function t(){a()}}}]}function f(t,e,n){if(!!n&&e.componentsFromPoint(t).some(function(t){return t.settings.key===n})){var i=e.component(n);i.emit(t.delta>0?"prev":"next");return true}}}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(204),n(403),n(101)],a=function(t,e,n){return{getLayersProperties:i,getDimensionTitle:a,createHyperCubeHandler:s};function i(t,e){return n.getValue(t,e||"layers")}function a(t,n){if(!t.length)return"";var i=t[0];var a=i.qDef.cId;var s=n.getDimensionLayout(a);return e.create().getDimensionTitle(s,i,true)}function s(e,n,i,a){var s=new t({app:a,path:e});s.setProperties(n);s.setLayout(i);return s}}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t=-3,e=-2;function n(t,e,i){if(e===i)return[t];var a=[];"U"!==t.qType&&"O"!==t.qType&&"T"!==t.qType&&t.qSubNodes.forEach(function(t){a=a.concat(n(t,e+1,i))});return a}function i(n){return n.some(function(n){return n.qElemNumber===e||n.qElemNumber===t})}function a(t,e,n,i){t[e]={};t[e].elemValue=n[i];t[e].text=n.qText}function s(t,e,s,r,o,l){e=e||0;s=s||0;l=l||s;var c;var u=0;var d=[];var p=[];if(t){if(t.qDataPages[0]){var h=t.qDataPages[0].qMatrix;u=t.qDataPages[0].qArea.qTop||u;h.forEach(function(t,e){!o&&i(t)||(p[e]=t[s])});c=o?r?"qElemNo":"qElemNumber":"qNum"}else if(t.qStackedDataPages[0]){var f=t.qStackedDataPages[0].qData[0];p=n(f,0,s+1);var g=[];if(l>s)p.forEach(function(t){var e=n(t,0,l-s);e.forEach(function(e){g[e.qRow]=t})});else{g=[];p.forEach(function(t){g[t.qRow]=t})}p=g;c=o?"qElemNo":r?"qNum":"qValue"}r?p.forEach(function(t,n){a(d,u+n,t[r].qValues[e],c)}):p.forEach(function(t,e){a(d,u+e,t,c)})}return d}return{wrangleData:s}}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[],a=function(){function t(t,e,n){var i=t&&"far"!==e||!t&&"far"===e;!t&&n&&(i=!i);return i?"start":"end"}function e(t,e){var n=[];var i;t&&n.push("@"+t);e&&n.push("@"+e);n.length&&(i=n.join(","));return i}return{getBublesAlign:t,getDock:e}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i;!(i=function(){function t(t,e,n){this.disclaimersConfig=t;this.dataAttributes=e;this.supportedDisclaimers=n}function e(t,e){return t&&e&&e[t]}t.prototype.isValidAndSupported=function(t,n){return e(t.label,this.dataAttributes)&&(t.default||e(t.label,this.supportedDisclaimers))&&void 0!==n&&t.alignment===n};t.prototype.isAnyValidDisclaimer=function(t){var e=false,n=this;this.disclaimersConfig.forEach(function(i){n.isValidAndSupported(i,t)&&(e=true)});return e};t.prototype.getMessage=function(t,e){var n="",i=this;e&&this.disclaimersConfig.forEach(function(a){i.isValidAndSupported(a,t)&&(n+=e.get("Object.Disclaimer."+a.label)+" ")});return n};return t}.call(e,n,e,t),void 0!==i&&(t.exports=i))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[],a=function(){return{isByNthDimension:e,useFallback:n};function t(t){return void 0!==t&&-1!==t}function e(e){return"byDimension"===e.mode&&e.byDimDef&&t(e.byDimDef.activeDimensionIndex)}function n(t,n){var i=true;var a=n.auto||e(n);return i&&a}}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(199),n(1124),n(1125),n(1498),n(1301),n(448)],a=function(t,e,n,i,a){return function s(){e.renderer.prio(["canvas"]);t.DEVELOPER&&e.logger.level(e.logger.LOG_LEVEL.WARN);e.use(n);e.use(a);e.use(i)}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(1144)],a=function(t){function e(t,e){var n=e.length,i,a,s,r,o;if(t){a=!t.autoMinMax&&("min"===t.minMax||"minMax"===t.minMax)&&null!==t.min&&!Number.isNaN(+t.min);s=!t.autoMinMax&&("max"===t.minMax||"minMax"===t.minMax)&&null!==t.max&&!Number.isNaN(+t.max)}r=Number.MAX_VALUE;o=-Number.MAX_VALUE;for(i=0;i<n;i++){r=Math.min(r,e[i].qMin);o=Math.max(o,e[i].qMax);if(r<=0&&o>=0)return true}r=a?t.min:r;o=s?t.max:o;return r<=0&&o>=0}function n(t){return t&&t[0]&&t[0].qData[0]&&t[0].qData[0].qSubNodes}var i={getNoDataExistAttribute:function t(e){return e.qSize.qcy*e.qSize.qcx===0},getLimitedDataAttribute:function t(e,i){var a=false;var s;if(e){if(void 0!==i.explicitLimitedData)a=true===i.explicitLimitedData;else if(e.qDataPages&&e.qDataPages[0])a=!i.paging&&e.qSize.qcy>e.qDataPages[0].qMatrix.length;else if(n(e.qStackedDataPages)){s=i.maxNbrOfDimensions?i.maxNbrOfDimensions:2;a=e.qDimensionInfo.length>=s?e.qStackedDataPages[0].qData[0].qSubNodes.some(function(t){return t.qDown>0}):e.qStackedDataPages[0].qData[0].qSubNodes.length<e.qStackedDataPages[0].qArea.qHeight}}else a=true===i.explicitLimitedData;return a},getNegativeOrZeroValuesAttribute:function t(e,n){return!n.supportNegative&&e.qMeasureInfo.some(function(t){return t.qMin<=0})},getOnlyNegativeOrZeroValuesAttribute:function t(e,n){return!n.supportNegative&&e.qMeasureInfo.every(function(t){return t.qMax<=0&&t.qMax>=t.qMin})||0===e.qSize.qcy},getOnlyNanDataAttribute:function t(e,n){return void 0!==n.explicitOnlyNanData?n.explicitOnlyNanData:e.qMeasureInfo.every(function(t){return t.qMax<t.qMin||"NaN"===t.qMax})},getDataRangeIncludingZeroAttribute:function t(n,i){return!i.supportRangeOverZero&&e(n.measureAxis,n.qHyperCube.qMeasureInfo)},applyAttributes:function e(n,i){var a=n||{};var s={};a.supportNegative=void 0===a.supportNegative||a.supportNegative;a.supportRangeOverZero=void 0===a.supportRangeOverZero||a.supportRangeOverZero;t.DISCLAIMERS.forEach(function(t){s[t.label]=false});if(!i||!i.qHyperCube)return s;s.NoDataExist=this.getNoDataExistAttribute(i.qHyperCube);if(s.NoDataExist)return s;s.LimitedData=this.getLimitedDataAttribute(i.qHyperCube,a);s.NegativeOrZeroValues=this.getNegativeOrZeroValuesAttribute(i.qHyperCube,a);s.OnlyNegativeOrZeroValues=this.getOnlyNegativeOrZeroValuesAttribute(i.qHyperCube,a);s.OnlyNanData=this.getOnlyNanDataAttribute(i.qHyperCube,a);s.DataRangeIncludingZero=this.getDataRangeIncludingZeroAttribute(i,a);return s}};return i}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(48),n(1602)],a=function(t,e){t.directive("qvaZoomPanNavigation",function(){return{template:e,replace:true,link:function t(e){e.onHomePressed=function(){e.$broadcast("navigationPressed","resetZoom")};e.onNavigationPressed=function(t){e.$broadcast("navigationPressed",t)}}}})}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(100)],a=function(t){var e={};e.get=function(){return t};e.getTheme=function e(){return t.getCurrentTheme()};e.setTheme=function e(n){t.applyTheme(n)};e.getThemePalettes=function e(){return t.themePalettes};return e}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[n(91),n(92),n(344)],a=function(t,e,n){var i,a=-3,s=-2;function r(e,i){var r=[],o={},l,c,u,d,p,h=this._qDataObject,f=this._legendMarker?this._legendMarker:"rect",g=h?h.qDimensionInfo instanceof Array?h.qDimensionInfo:[h.qDimensionInfo]:null,v,m=this._colorMap,b;i=void 0===i?g.length-1:i[0];l=this._dimensionTree;if(e){p=h.qMeasureInfo;v=p.length;for(u=0;u<v;u++)r.push({label:p[u].qFallbackTitle,color:m.getColor(0,0,u),id:[-1],type:"measure",marker:this._legendMarker?this._legendMarker:this._measureLegendTypes&&this._measureLegendTypes[u]||"box"})}else n.each.call(l,function(e){b=n.getLevel.call(e);if(b-1===i&&e.data.qElemNo!==s&&void 0!==e.data.qText&&void 0===o[e.data.qElemNo]){d=[];d[i]=e.data.qElemNo;c={label:e.data.qElemNo!==a||void 0!==e.data.qText?e.data.qText:t.get("properties.dimensionLimits.others"),color:m.getColorFromPreScaledValue(e.data.qElemNo),id:[e.data.qElemNo],index:e.data.rowIndex,type:e.data.qElemNo!==a?"dimension":"others",marker:f};r.push(c);o[e.data.qElemNo]=c}});return r}function o(t,e){var n=[],i={},r=this._data.qListObject.qDataPages[0].qMatrix,o,l,c=this._qDataObject,u=c?c.qDimensionInfo instanceof Array?c.qDimensionInfo:[c.qDimensionInfo]:null,d,p,h,f,g,v=this._colorMap;e=void 0===e?u.length-1:e[0];if(t){o=this._data.qListObject.qMeasureInfo;l=o.length;for(p=0;p<l;p++)n.push({label:o[p].qFallbackTitle,color:v.getColor(0,0,p),id:[-1],type:"measure"})}else for(d=0;d<r.length;d++){h=r[d][e];if(h.qElemNumber!==a&&h.qElemNumbero!==s&&void 0===i[h.qText]){f=[];f[e]=h.qElemNumber;g={label:h.qText,color:v.getColor(f,0,0,d),id:[h.qElemNumber],type:"dimension"};n.push(g);i[h.qText]=g}}return n}function l(t){return t.discrete+","+t.boxType+","+t.colorMode}i=e.extend({init:function t(e){this._data=e;this._colorMappings={}},setColorMap:function t(e){this._colorMap=e},getColorMap:function t(){return this._colorMap},getColorMapping:function t(){if(!this._colorMap||!this._data)return[];var e,n=this._colorMap.getColorDataInfo().legendMode;if("primary"===n.colorMode)return[];if(this._colorMappings[l(n)])return this._colorMappings[l(n)];e=n.discrete&&"range"===n.boxType||!n.discrete?this._colorMap.generateScaleBasedMapping():this._data.qListObject?o.apply(this,["measure"===n.colorMode,this._colorMap.getDimensionIndex()]):r.apply(this,["measure"===n.colorMode,this._colorMap.getDimensionIndex()]);this._colorMappings[l(n)]=e;return e},setData:function t(e){var n=e.qHyperCube?e.qHyperCube:e.qListObject,i=e.qHyperCube?e.qHyperCube.qDimensionInfo:[e.qListObject.qDimensionInfo];this._qDataObject=n;this._data=e;e&&n.qDataPages.length?this._others=n.qDataPages[0].qMatrix.some(function(t){return i&&i.length&&true===t[i.length-1].qIsOtherCell}):this._others=false;this._colorMappings={}},setDimensionTree:function t(e){this._dimensionTree=e;this._colorMappings={}},setMeasureLegendTypes:function t(e){this._measureLegendTypes=e},setLegendMarker:function t(e){this._legendMarker=e},getLegendMarker:function t(){return this._legendMarker},release:function t(){this._colorMap=null;this._dimensionTree=null;this._data=null;this._qDataObject=null}});return i}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(100),n(252),n(1466),n(1227),n(160),n(511),n(91)],a=function(t,e,n,i,a,s,r){var o;function l(t,e){var n=-Number.MAX_VALUE,i=Number.MAX_VALUE,a,s=true;if(false===e.color.autoMinMax)return{min:e.color.measureMin||0,max:e.color.measureMax||0};if(t){t.forEach(function(t){a=t.value;if(!Number.isNaN(+a)){n=Math.max(n,a);i=Math.min(i,a);s=false}});if(s)return null;return{min:i,max:n}}return null}function c(t){var n=[];t.forEach(function(t,i){n[i]={color:e.retriveColor(Number.isNaN(+t.elemValue)?t.text:t.elemValue,"argb"),value:t.elemValue}});return n}o=n.extend({init:function t(e,n,i){this._formatter=new s(null);this._super(e,n,i)},setData:function t(e,n,i){this._precalculate(e);var a=this._super(e,n,i?{content:{chartData:i}}:e?e.snapshotData:null);if(e)if(this._byExpression){if(!this._wrangledMapping.length||!this._minMax)return;var s=this._wrangledMapping;this._numUsedColors=[this.calculateNumberOfUsedColors(this._minMax.max,this._minMax.min,s.map(function(t){return t.value}),1,this.getLargestScaleSize())];this._formatter.pattern=this._formatter.createPatternFromRange(this._minMax.min,this._minMax.max,true);this._formatter.prepare();this._activeScale.setMaxMinValues(this._minMax.max,this._minMax.min)}else{this._minMax=null;this._mapping=null;this._formatter.pattern=this._formatter.createPatternFromRange(0,1,true);this._formatter.prepare()}return a},getColor:function n(i,a,s,r){if(!this._byExpression)return this._super(i,a,s,r);var o;var l=this._wrangledMapping?this._wrangledMapping[a]:null;if(!l||l.color.isInvalid()&&this._isColorExpression)return e.retriveColor(t.dataColors.nullColor);o=this._isColorExpression?l.color:this._super(i,a,0,l.value);return o},getExpressionValue:function t(e){return!this._wrangledMapping[e]||this._isColorExpression?void 0:this._wrangledMapping[e].value},getLegendTitle:function t(){return this._byExpression?this._expressionLabel:this._super()},getLegendMode:function t(){return this._byExpression?this._isColorExpression?["box","item","primary",true]:[this._classes?"box":"scale",this._classes?"range":"item","measure",true]:this._super()},getValueFormatter:function t(){return this._colorDataInfo&&this._colorDataInfo.altMode&&void 0!==this._colorDataInfo.matchingDataMeasure?this._measureFormatters&&this._measureFormatters[this._colorDataInfo.matchingDataMeasure]?this._measureFormatters[this._colorDataInfo.matchingDataMeasure]:this._formatter:this._byExpression||this._colorDataInfo&&this._colorDataInfo.altMode?this._formatter:this._measureFormatters&&this._measureFormatters[0]?this._measureFormatters[0]:this._formatter},setGenericFormatter:function t(e){this._super(e);if(this._byExpression&&this._minMax){this._formatter.pattern=this._formatter.createPatternFromRange(this._minMax.min,this._minMax.max,true);this._formatter.prepare()}else this._formatter.pattern=this._formatter.createPatternFromRange(0,1,true);this._formatter.prepare()},getGenericFormatter:function t(){return this._formatter},_getMinMax:function t(e,n){return this._byExpression?this._minMax?{min:this._minMax.min,max:this._minMax.max}:null:this._super(e,n)},_precalculate:function t(e){this._wrangledMapping=[];if(e){var n=e.color||{},s=e.qHyperCube?e.qHyperCube:e.qListObject;this._qDataObject=s;this._data=e;this._isColorExpression=false!==n.expressionIsColor;this._byExpression="byExpression"===n.mode;this._expressionLabel=n.expressionLabel&&""!==n.expressionLabel?n.expressionLabel:r.get("Object.ChartTooltip.ColorExpression");if(this._byExpression){var o=-1;var u=-1;var d=false;s.qDimensionInfo.concat(s.qMeasureInfo).forEach(function(t,e){t.qAttrExprInfo&&t.qAttrExprInfo.every(function(t,n){if(t.id===a.IDMAP.COLOR_BY_EXPRESSION&&!d){o=e;u=n;d=true;return false}return true})});if(o>=0&&u>=0){var p=i.wrangleData(s,u,o,"qAttrExps",false,s.qDimensionInfo.length-1,false);this._wrangledMapping=c(p);this._minMax=l(this._wrangledMapping,e)}}}}});return o}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(100),n(252),n(92),n(1162),n(89),n(174)],a=function(t,e,n,i,a,s,r){var o;function l(t,e,n,i,a){var s,r=0,o=[],c,u,d;s=(t-e)/(i+1);if(0===s)return 1;for(c=0;c<n.length;c++){u=.99*(n[c]-e);d=n[c]>t?Math.floor(t/s):n[c]<e?0:Math.floor(u/s);if(Number.isNaN(+d))continue;o[d]?o[d]++:o[d]=1}for(c=0;c<o.length;c++)o[c]&&r++;return r<=i||r>=a?Math.max(r,i):l(t,e,n,++i,a)}function c(t){var e=[],n;for(n=0;n<t.length;n++)t[n]?e.push(u(t[n],false)):e.push(null);return e}function u(t,e){var n=1,i=[];i.push(t[0]);e||i.push(t[0]);for(;n<t.length-1;n++){i.push(t[n]);i.push(t[n])}if(n<t.length){i.push(t[n]);e||i.push(t[n])}return i}function d(t,e,n){var i={limits:[],colors:[]};var a=false;t.forEach(function(s,r){if(s>n.min&&!a)if(s<n.max){i.limits.push(s);i.colors.push(e[r]);r===t.length-1&&(a=true)}else if(s>n.max){if(t.indexOf(s)==r){i.colors.push(e[r]);a=true}}else if(s==n.max&&t.indexOf(s)==r){i.colors.push(e[r]);i.limits.push(s);a=true}a&&n.max>=s&&i.colors.push(e[r+1]);r!=t.length-1||a||i.colors.push(e[r+1])});0===t.length&&i.colors.push(e[0]);return i}function p(t){this._sequentialScales={};var e=this._sequentialScales;var n=0;t.scales.forEach(function(t){e[t.propertyValue]={type:t.type,scale:s.createColorScale("class-pyramid"===t.type?c(t.scale):u(t.scale,"gradient"===t.type),"class-pyramid"===t.type)};n=Math.max(t.scale.length,n)});this._largestScaleSize=n;this._wrangled=[];this._defaultScaleObj=this._sequentialScales[t.scales[0].propertyValue];this._activeScale=this._defaultScaleObj.scale}o=a.extend({init:function t(e,i,a){p.call(this,n);this.app=a;this._themeChangeWatcher=function(){p.call(this,n)}.bind(this);n.ThemeChanged.bind(this._themeChangeWatcher);this._measure=0;this.minMax={min:null,max:null};this.setData(e)},release:function t(){n.ThemeChanged.unbind(this._themeChangeWatcher)},setData:function t(i,a,o){this._data=i;this._colorDataInfo=a;this._customScale=false;this._invalidSpan=false;var c=this;var u;var p;c._unscaledLimits=null;function h(){c._activeScale.setMaxMinValues(u.max,u.min);void 0!==p.reverseScheme&&c._activeScale.setReverse(true===p.reverseScheme)}function f(t){return t.some(function(t){return t})}function g(t){t&&(f(t.breakTypes)?m(t):v(t))}function v(t){if(t){var e=t.colors.map(function(t){return n.resolveColor(t)});var i=t.limits;var a=null;var r;var o;var l={min:u.min,max:u.max};if("absolute"===t.limitType){a=d(i,e,l);i=a.limits;var p=l.max-l.min;var h=.001*p;c._unscaledLimits=i.concat();i.length&&i[0]===l.min&&(u.min=l.min-h);i.length&&i[i.length-1]===l.max&&(u.max=l.max+h);var f=u.max-u.min;i=l.min===l.max?i.map(function(t){return(t-l.min)/l.min}):i.map(function(t){return(t-l.min)/(l.max-l.min)});for(var g=0;g<i.length;g++)0!==f&&f!==p&&(i[g]*=p/(f+h*(1-(g+1)/i.length)));r=i.map(function(){return false})||i.map(function(){return 0});o=s.setupColors(a.colors,r,i)}else if("percent"===t.limitType)if(l.min===l.max)o=s.setupColors([e[0]],[],[]);else{i=i.map(function(t){return Math.max(Math.min(t,1),0)});r=t.breakTypes||i.map(function(){return 0});o=s.setupColors(e,r,i)}if(o){c._activeScale=s.createColorScale(o.colors,false);c._activeScale.setLimits(o.limits);c._customScale=true;c._classes=true}}c._measureGradient=t}function m(t){if(t){var e=t.colors.map(function(t){return n.resolveColor(t)});var i=t.limits;if("absolute"===t.limitType){u.max=Math.max(u.max,i[i.length-1]);u.min=Math.min(u.min,i[0]);i=u.max===u.min?i.map(function(t){return(t-u.min)/u.max}):i.map(function(t){return(t-u.min)/(u.max-u.min)})}var a=t.breakTypes||i.map(function(){return 0});var r=s.setupColors(e,a,i);if(r){c._activeScale=s.createColorScale(r.colors,false);c._activeScale.setLimits(r.limits);c._customScale=true;c._classes=false}}c._measureGradient=t}if(i){if(!a.valid){this._legendTitle="";this._wrangled=[];return}p=i.color||{};var b=i.qHyperCube?i.qHyperCube:i.qListObject;this._qDataObject=b;this._validColorInformation=this._colorDataInfo.valid&&!this._colorDataInfo.allNaN;this._byExpression="byExpression"===p.mode;this._legendTitle=this._colorDataInfo.legendTitle;if(void 0!==p.measureScheme){var y=this._sequentialScales[p.measureScheme]||this._defaultScaleObj;this._activeScale=y.scale;this._classes="class-pyramid"===y.type;u=this._getMinMax();this._invalidSpan=!u;if(!this._invalidSpan&&this._validColorInformation){this._wrangled=this._colorDataInfo.wrangled.map(function(t){return t.elemValue});this._numUsedColors=this._colorDataInfo.persistentColors?[Math.min(this.getLargestScaleSize(),this._colorDataInfo.dimSize)]:[l(u.max,u.min,this._wrangled,1,this.getLargestScaleSize())];if(a.attrInfo&&a.useMeasureGradient)return o&&o.content&&o.content.chartData?r.resolve(o.content.chartData.measureGradient).then(g).then(h):e.getService("qvColorMapService").getMeasureGradient(a.attrInfo.colorMapRef,this.app).then(g).then(h);h()}}}},getColor:function t(e,a,s,r){r=this._byExpression||void 0===this._wrangled[a]?r:this._wrangled[a];return this._byExpression||!this._invalidSpan&&!Number.isNaN(+r)&&this._validColorInformation?this._activeScale.getColor(r,this._getNumUsedColors(0)):i.retriveColor(n.dataColors.nullColor)},getColorFromPreScaledValue:function t(e){return this._activeScale.getColor(e,this._getNumUsedColors(0))},getActiveScale:function t(){return this._activeScale},getLargestScaleSize:function t(){return this._largestScaleSize||0},generateScaleBasedMapping:function e(){var n,i,a,r,o,l,c,u,d,p,h=this.getValueFormatter();p=this._activeScale;this.minMax=this._getMinMax();n=this.minMax;if(this._customScale)return s.setupLegend(p,n,h,this._unscaledLimits);d=[];c=p.getLegendParts(this._getNumUsedColors(0));if(!n)return d;i=n.max-n.min;if(Number.isNaN(+i))return d;o=c.length;r=i/o;l=n.max;if(!Number.isNaN(+n.measureMax)&&this._classes){u=t.extend(true,{},c[0]);u.isMax=true;u.min=h.formatValue(l);u.id=[n.measureMax,l];u.type="range";d.push(u)}for(a=0;a<o-1;a++){u=c[a];u.isMax=0===a;u.max=h.formatValue(l);u.min=h.formatValue(l-r);u.id=[l,l-r];u.type="range";l-=r;d.push(u)}u=c[a];u.isMax=0===a;u.max=h.formatValue(l);u.min=h.formatValue(n.min);u.id=[l,n.min];u.type="range";d.push(u);if(!Number.isNaN(+n.measureMin)&&this._classes){u=t.extend(true,{},c[a]);u.isMax=0===a;u.max=h.formatValue(n.min);u.min=void 0;u.id=[n.min,n.measureMin];u.type="range";d.push(u)}return d},getColorMapping:function t(){return this.generateScaleBasedMapping()},getLegendMode:function t(){return[this._classes?"box":"scale",this._classes?"range":"item","measure"]},getLegendTitle:function t(){return this._legendTitle},setMeasureFormatters:function t(e){this._measureFormatters=e},setGenericFormatter:function t(e){this._formatter=e},getValueFormatter:function t(){return this._measureFormatters&&this._measureFormatters[0]&&!this._byExpression?this._measureFormatters[0]:{formatValue:function t(e){return e}}},_getMinMax:function t(){var e;if(false===this._data.color.autoMinMax){e={min:this._data.color.measureMin||0,max:this._data.color.measureMax||0};return e.max>=e.min?e:null}if(this._validColorInformation&&this._colorDataInfo.minMax){e=this._colorDataInfo.minMax;return e}return null},_getNumUsedColors:function t(e){return this._numUsedColors?this._numUsedColors[e]:0},calculateNumberOfUsedColors:l,filterLimitsAndColorsBasedOnMinMax:d,getMeasureGradient:function t(){return this._measureGradient}});return o}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(91),n(100),n(252),n(92)],a=function(t,e,n,i){var a,s="auto",r="primary",o="measure",l="dim_master",c="meas_master",u="multiple",d=-2,p,h;function f(t,n){return e.resolveColor(n||t)}function g(t,e){var n=e||0;var i=[];t.forEach(function(t){if(void 0===i[t]&&t>=0){i[t]=n;n++}});return i}function v(t){return this._persistColors||this._measureMode?t:this._reMappedIndeces[t]}function m(){p={};e.dataPalettes.forEach(function(t){p[t.propertyValue]={type:t.type,scale:t.scale}});h=p[e.dataPalettes[0].propertyValue]}a=i.extend({init:function t(n,i){i=i||{};this._primaryColorMode=i.colorBy||s;this._autoMode=i.autoMode||s;this._primaryColor=e.dataColors.primaryColor;this._persistColors=true;this._wrangled=[];this._dimIndex=0;m();this._themeChangeWatcher=function(){m()};e.ThemeChanged.bind(this._themeChangeWatcher);n&&this.setData(n)},release:function t(){e.ThemeChanged.unbind(this._themeChangeWatcher)},setData:function e(n,i){this._data=n;this._colorDataInfo=i;if(!i.valid){this._dimLabel="";this._wrangled=[];return}var a=n.color||{},o=n.qHyperCube?n.qHyperCube:n.qListObject,d=o&&o.qMeasureInfo?o.qMeasureInfo.length:0;this._colorMode=a.auto?s:a.mode||r;this._internalMode=this._colorDataInfo.internalMode;this._measureMode=this._internalMode===u||"byMultiple"===this._colorMode||this._internalMode===c||this._internalMode===l;this._persistColors=this._colorDataInfo.persistentColors;this._dimIndex=this._colorDataInfo.dimIndex||0;this._measureMode?this._dimLabel=t.get("Common.Measures"):this._dimLabel=this._colorDataInfo.legendTitle;this._wrangled=this._colorDataInfo.wrangled.map(function(t){return t.elemValue});this._dimSize=this._measureMode?d:this._colorDataInfo.dimSize;this._persistColors||(this._reMappedIndeces=g(this._wrangled,this._colorDataInfo.top));this._primaryColor=f(a.singleColor,a.paletteColor);"none"===this._primaryColor&&(this._primaryColor="rgba(0,0,0,0)");var v=this._colorDataInfo.dimensionScheme&&p[this._colorDataInfo.dimensionScheme]||h;this._colorMode===s&&(v=h);if("pyramid"===v.type){var m=Math.max(Math.min(v.scale.length-1,this._dimSize-1)%v.scale.length,0);this._qualitativeScale=v.scale[m]}else this._qualitativeScale=v.scale},getColor:function t(i,a,o){var l=this._measureMode?o:this._wrangled[a];if(this._internalMode===r&&this._colorMode===s)return n.retriveColor(e.dataColors.primaryColor);if(this._internalMode===r)return n.retriveColor(this._primaryColor);if(Number.isNaN(+l)||l===d)return n.retriveColor(e.dataColors.nullColor);l=v.call(this,l);return n.retriveColor(this._qualitativeScale[l%this._qualitativeScale.length])},getLegendMode:function t(){var e=this._internalMode===r||this._internalMode===l?r:this._autoMode===o||this._measureMode?"measure":"dimension";return["box","item",e,"measure"===e]},getColorFromPreScaledValue:function t(e){e=v.call(this,e);return n.retriveColor(this._qualitativeScale[e%this._qualitativeScale.length])},getDimensionIndex:function t(){return this._colorDataInfo?this._dimIndex:0},getLegendTitle:function t(){return this._dimLabel}});return a}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(208)],a=function(t){function e(e,n){return'<div class="color-template-wrapper"><div class="color-dot" style="background:'+n+'"></div><span dir="ltr">'+t.encodeForHTML(e)+"</span></div>"}return{createLegendTemplate:e}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(252),n(100)],a=function(t,e){var n=-3,i=-2;function a(){this._colors={others:t.retriveColor(e.dataColors.othersColor),null:t.retriveColor(e.dataColors.nullColor),error:t.retriveColor(e.dataColors.errorColor)};this._wrangled=[]}a.prototype.setProperties=function(n,i){this._dimIndex=n.dimIndex||0;this._wrangled=n.wrangled||[];this._colorMode=n.internalMode;this._colors={others:t.retriveColor(e.dataColors.othersColor),null:t.retriveColor(e.dataColors.nullColor),error:t.retriveColor(e.dataColors.errorColor)};if(i&&"dimension"===n.internalMode&&n.useDimColVal){var a;if(i.oth){a=t.retriveColor(e.resolveColor(i.oth));a.isInvalid()||(this._colors.others=a)}if(i.nul){a=t.retriveColor(e.resolveColor(i.nul));a.isInvalid()||(this._colors.null=a)}}};a.prototype.getColor=function(t,e){var a=Array.isArray(t)?this._dimIndex>=0?t[this._dimIndex]:void 0:t;var s="measure"!==this._colorMode&&this._wrangled[e]?this._wrangled[e].elemValue:void 0;if(!Array.isArray(t)&&Number.isNaN(+t))return this._colors.error;if(a===n||Array.isArray(t)&&-1!==t.indexOf(n))return this._colors.others;if(a===i||s===i)return this._colors.null;return false};return a}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(92),n(48),n(100),n(89),n(174)],a=function(t,e,n,i){var a;function s(t){var e={};t&&t.forEach(function(t){e[t.value]=t.baseColor});return e}function r(t,e){var n={};e.forEach(function(t){n[t.text]||(n[t.text]=[]);n[t.text].push(t)});t.forEach(function(t){n[t.value]&&n[t.value].forEach(function(e){e.baseColor=t.baseColor})});return e.map(function(t){return t.baseColor})}function o(t){var e=[];t.forEach(function(t,n){var i=l(t);e[i]=n});return e}function l(t){return t.elemValue}function c(t,e,i,a,s){if(a){if(true===s){var r=u();return r[l(a)%r.length]}if(t&&i){var o=l(a);return i[o%i.length]}}var c=n.resolveColor(e);return"none"===c?n.dataColors.primaryColor:c}function u(t,e){return n.getPaletteScale(t||"",e)}a=t.extend({init:function t(e){this.colors={};this.filler={};this.reverseMapping=[];this.fieldValueMap={};this.app=e},release:function t(){this.colors=null;this.filler=null},setData:function t(n,a,l,c){var d=this;this.wrangled=a.wrangled;var p=a.altMode?a.attrInfo.colorMapRef:l&&l.coloring?l.coloring.colorMapRef:"";function h(t){var e=t||{};d.fieldValueMap=s(e.colors);d.colors=r(e.colors||[],a.wrangled||[]);d.filler=e.single;d.palette=u(e.pal);d.usePalette=e.usePal;d.reverseMapping=o(a.wrangled||[]);d._dimValCols=t;d.autoFill=e.autoFill;return t}return c?i.resolve(c.dimValsData).then(h):e.getService("qvColorMapService").getColorMap(p,this.app).then(h)},getColor:function t(e){return this.colors[e]?n.resolveColor(this.colors[e]):c(this.usePalette,this.filler,this.palette,this.wrangled[e],this.autoFill)},getColorFromPreScaledValue:function t(e,i){var a=this.reverseMapping[e];if(this.colors[a])return n.resolveColor(this.colors[a]);if(this.fieldValueMap[i])return n.resolveColor(this.fieldValueMap[i]);return this.usePalette||this.autoFill?c(this.usePalette,this.filler,this.palette,{elemValue:e},this.autoFill):"none"},getDimValsData:function t(){return this._dimValCols}});return a}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(195),n(100)],a=function(t,e){var n="primary",i="dimension",a="measure",s="expression",r="multiple",o="master",l="dim_master",c="meas_master",u="auto";var d=t.baseColor;function p(t,e,p,h,g){var v=Array.isArray(p.qDimensionInfo)?p.qDimensionInfo.length:1,m=p.qMeasureInfo?p.qMeasureInfo.length:0;var b,y,S;y="measure"===h&&f(p.qMeasureInfo);S="dimension"===h&&f(p.qDimensionInfo);b=y||S;t&&t!==u?"byMultiple"===t?t=b?o:r:"byDimension"===t?t=i:"byMeasure"===t?t=a:"byExpression"===t?t=s:t===n&&(S?t=l:y&&d.isSupported(g)&&(t=c)):t=v>1&&e!==n||e===i?i:f(p.qDimensionInfo)&&(1===v||e===n)&&(m<=1||e===n)?l:f(p.qMeasureInfo)&&(v<=1||e===n)&&d.isSupported(g)?c:e===n||e===u&&v<=1&&m<=1?n:m>1?r:i;t===o&&(t=y?c:l);return t}function h(t){var n=false;if(!t)return false;t.coloring&&t.coloring.baseColor&&t.coloring.baseColor.color?n=t.coloring.baseColor:t.baseColor&&t.baseColor.color&&(n=t.baseColor);if(n){"none"===n.color&&(n=e.dataColors.primaryColor);return n}return false}function f(t){return t.filter(function(t){return h(t)}).length>0}return{determineInternalMode:p,getBaseColor:h}}.apply(e,i),void 0!==a&&(t.exports=a))},,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i,a;!(i=[],a=function(){return function t(e){e.component("event-area",{mounted:function t(e){e.classList.add("event-area");e.style.pointerEvents="auto";e.style.zIndex=1},render:function t(){var e=[];return e}})}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(1500)],a=function(t){function e(e,n,i){switch(e){case"dimension-measure-chart":t(n,i);break;default:throw Error("There is no chart preset with that type")}}return e}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90),n(1501),n(1143),n(1502),n(1503)],a=function(t,e,n,i,a){var s=100;function r(t,e){var n=e||{};var i=n.measureAxisProperties||{},s=n.dimensionAxisProperties||{};var r=n.orientation||a.DEFAULT_CHART_ORIENTATION,I=r===a.HORIZONTAL,w=I?"x":"y",D=I?"y":"x";var M=a.SHOW_AXIS_LABELS_OPTIONS,T=a.SHOW_TITLE_OPTIONS;var A=M.contains(i.show),P=!!n.measureTitleText&&T.contains(i.show),k=n.includeDimensionAxis&&M.contains(s.show),E=n.includeDimensionAxis&&!!n.dimensionTitleText&&T.contains(s.show),_=n.gridlines&&!(!n.gridlines.auto&&0===n.gridlines.spacing),F=n.refLines&&n.refLines.some(function(t){return t.show});var $=[];A&&u(t,n,w,i);P&&d(t,n,w);c(t,n,r,i);k&&h(t,n,D);E&&f(t,n,D);n.includeDimensionAxis&&p(t,n,r);_&&g(t,n.gridlines,w);n.hasNavigation&&v(t,$,n,I);F&&m(t,n,w,i);if(n.enableLasso&&n.selectionsEnabled){var N=n.lasso||{};b(t,N)}if(n.enableDimRange&&n.includeDimensionAxis&&n.selectionsEnabled){var O=n.dimRange||{};var L=C(n,D);y(t,O,I,L.dock,n.isRtl)}if(n.enableMeasureRange&&n.selectionsEnabled){var R=n.measureRange||{};var H=q(n,w);S(t,R,I,H.dock,n.isRtl)}if(n.enableAreaRange&&n.selectionsEnabled){var G=n.areaRange||{};var j=C(n,D);x(t,G,I,j.dock,n.isRtl)}n.brushActions&&l($,n.brushActions);$.length&&o(t,$)}return r;function o(t,e){return t.addInteraction({},{gestures:e})}function l(t,e){e.forEach(function(e){t.push(e)})}function c(e,n,i,a){var r=n.measureScaleSettings,o={isRtl:n.isRtl,source:n.measureSource,orientation:i,measureAxisProperties:a};a&&a.spacing>0&&(r=t.extend(true,r||{},{component:{ticks:{distance:a.spacing*s}}}));e.addScale("measure-scale",r,o)}function u(e,n,i,s){var r={scale:"measure",forceBounds:s&&!s.autoMinMax&&s.showBounds};r=t.extend(r,a.LAYOUTSETTINGS.measureAxis);var o=q(n,i);e.addComponent(i+"-axis",r,o)}function d(e,n,i){var s={text:n.measureTitleText};s=t.extend(s,a.LAYOUTSETTINGS.measureAxisTitle);var r=I(n,i);e.addComponent(i+"-axis-title",s,r)}function p(t,e,n){var i={isRtl:e.isRtl,source:e.dimensionSource,orientation:n===a.HORIZONTAL?a.VERTICAL:a.HORIZONTAL};t.addScale("dimension-scale",e.dimensionScaleSettings,i)}function h(e,n,i){var s={scale:"dimension"};s=t.extend(s,a.LAYOUTSETTINGS.dimensionAxis);var r=C(n,i);t.extend(true,s,n.dimensionAxisSettings||{});e.addComponent(i+"-axis",s,r)}function f(e,n,i){var s={text:n.dimensionTitleText};s=t.extend(s,a.LAYOUTSETTINGS.dimensionAxisTitle);var r=w(n,i);e.addComponent(i+"-axis-title",s,r)}function g(e,n,i){var s={ticks:{show:true},minorTicks:{show:!n.auto&&!n.auto&&3===n.spacing}};s=t.extend(s,a.LAYOUTSETTINGS.gridLines);s[i]={scale:"measure"};e.addComponent("grid-line",s)}function v(n,i,s,r){var o=n.getSettings();o.scroll={dimension:{viewSize:s.scrollSettings&&s.scrollSettings.viewSize||0,max:s.scrollSettings&&s.scrollSettings.max||0}};var c={isRtl:s.isRtl,chartID:s.chartID,isHorizontal:!r};var u=t.extend({},a.LAYOUTSETTINGS.scrollBar);n.addComponent("scrollbar",u,c);l(i,e(s.isNavigationEnabledFn))}function m(e,s,r,o){var l=n.getAxisDock(r,o.dock,s.isRtl);var c={key:"ref-line",style:{oob:{show:false}},lines:{x:[],y:[]}};c=t.extend(c,a.LAYOUTSETTINGS.refLines);var u={key:"ref-line-labels-"+t.generateId(),require:["renderer","chart"],dock:n.getOppositeAxisDock(r,o.dock,s.isRtl),preferredSize:function t(){if("x"===r)return 26;var n=this.renderer.measureText;var i=this.chart.formatter({data:e.settings.scales.measure.data});var a=u.lines.y.map(function(t){var e="("+i(t.value)+")";var a=t.label.text+" "+e;var s=t.label.text?"� "+e:e;return{wanted:n({text:a,fontSize:t.fontSize,fontFamily:t.fontFamily}).width,required:n({text:s,fontSize:t.fontSize,fontFamily:t.fontFamily}).width}});var s=a[0];for(var o=1;o<a.length;o++){a[o].wanted>s.wanted&&(s.wanted=a[o].wanted);a[o].required>s.required&&(s.required=a[o].required)}var l=12;return s.required+l>100?s.required+l:Math.min(s.wanted+l,100)},lines:{x:[],y:[]}};u=t.extend(u,a.LAYOUTSETTINGS.refLinesLabels);s.refLines.forEach(function(e){if(!e.show)return;var n=e.refLineExpr&&e.refLineExpr.value;var a=t.extend(true,{},s,{paletteColor:e.paletteColor});var o=i.lineSettings({scale:"measure",dir:r,value:n},a);c.lines[r].push(o);var d=i.lineLabelSettings({scale:"measure",value:n,label:{text:e.label}},a);"x"===r?d.label.vAlign="near"===l?1:0:d.label.align="near"===l?0:1;u.lines[r].push(d)});e.addComponent("ref-line",c,{});e.addComponent("ref-line",u,{})}function b(t,e){var n={brushKey:e.brushKey,brushComponents:e.brushComponents,brushData:e.brushData};t.addComponent("lasso",a.LAYOUTSETTINGS.lasso,n)}function y(e,n,i,s,r){var o={key:"rangeDim"};o=t.extend(o,a.LAYOUTSETTINGS.rangeDim);var l={brushKey:n.brushKey,brushAxis:n.brushAxis,brushArea:n.brushArea,brushScale:n.brushScale,isHorizontal:!i,dock:s,isRtl:r};e.addComponent("range",o,l)}function S(e,n,i,s,r){var o={key:"rangeMeasure"};o=t.extend(o,a.LAYOUTSETTINGS.rangeMeasure);var l={brushKey:n.brushKey,brushAxis:n.brushAxis,brushArea:n.brushArea,brushScale:n.brushScale,multiple:n.multiple,isHorizontal:i,dock:s,isRtl:r};e.addComponent("range",o,l)}function x(e,n,i,s,r){var o={key:"rangeMinor"};o=t.extend(o,a.LAYOUTSETTINGS.rangeMinor);var l={brushKey:n.brushKey,brushAxis:n.brushAxis,brushData:n.brushData,brushArea:n.brushArea,brushComponents:n.brushComponents,brushScale:n.brushScale,multiple:n.multiple,isHorizontal:"measure"===n.brushScale?i:!i,dock:s,isRtl:r,chartInstance:n.chartInstance};e.addComponent("range-area",o,l)}function q(t,e){return{dock:t.measureAxisProperties&&t.measureAxisProperties.dock,direction:e,isRtl:t.isRtl}}function I(t,e){return q(t,e)}function C(t,e){return{dock:t.dimensionAxisProperties&&t.dimensionAxisProperties.dock,direction:e,isRtl:t.isRtl}}function w(t,e){return C(t,e)}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t="scrollbar";function e(e){function n(n,i){if(!i||!e())return false;var a={x:i.center.x-i.deltaX,y:i.center.y-i.deltaY};var s=this.chart.componentsFromPoint(a);return s.some(function(e){return e.settings.key===t})}var i={type:"Tap",options:{enable:n},events:{tap:function e(n){this.chart.component(t).emit("tap",n)}}};var a={type:"Pan",options:{enable:n},events:{panstart:function e(n){this.chart.component(t).emit("panStart",n)},pan:function e(n){this.chart.component(t).emit("panMove",n)},panend:function e(n){this.chart.component(t).emit("panEnd",n)},pancancel:function e(n){this.chart.component(t).emit("panCancel",n)}}};var s=[i,a];return s}return e}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90),n(201)],a=function(t,e){function n(n,i){var a="undefined"!==typeof i.paletteColor?e.Theme.resolveColor(i.paletteColor):"transparent";var s={value:0,line:{stroke:a}};return t.extend(true,s,n||{})}function i(n,i){var a=i&&i.chartID;var s=e.getStyle(a,"referenceLine.label.name","color");var r=e.getFontSize(a,"referenceLine.label.name","fontSize");var o="QlikView Sans";i.paletteColor?s=e.Theme.resolveColor(i.paletteColor):s||(s="transparent");var l={value:0,line:{stroke:"transparent"},label:{align:"center",vAlign:"middle",text:"",fill:s,fontFamily:o,fontSize:r,maxWidthPx:135}};return t.extend(true,l,n||{})}return{lineSettings:n,lineLabelSettings:i}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(1504)],a=function(t){var e={SHOW_AXIS_LABELS_OPTIONS:["all","labels"],SHOW_TITLE_OPTIONS:["all","title"],HORIZONTAL:"horizontal",VERTICAL:"vertical",LAYOUTSETTINGS:t};e.DEFAULT_CHART_ORIENTATION=e.HORIZONTAL;return e}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){return{lasso:{displayOrder:1e4},rangeDim:{displayOrder:1e4},rangeMeasure:{displayOrder:1e4},rangeMinor:{displayOrder:1e4},scrollBar:{minimumLayoutMode:"SPARK",prioOrder:-1,displayOrder:100},refLines:{minimumLayoutMode:"SPARK",prioOrder:60,displayOrder:-10},measureAxisTitle:{minimumLayoutMode:"XSMALL",prioOrder:30,displayOrder:90},dimensionAxisTitle:{minimumLayoutMode:"XSMALL",prioOrder:30,displayOrder:90},measureAxis:{minimumLayoutMode:"XSMALL",prioOrder:10,displayOrder:80},dimensionAxis:{minimumLayoutMode:"XSMALL",prioOrder:10,displayOrder:80},gridLines:{minimumLayoutMode:"XSMALL",displayOrder:-100},refLinesLabels:{minimumLayoutMode:"SMALL",prioOrder:60,displayOrder:0}}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90)],a=function(t){function e(e,n){var i=n||{},a=!i.orientation||"horizontal"===i.orientation,s=!!i.isRtl;var r={name:i.name||"scale",component:{invert:a&&s,minorTicks:{count:1},range:i.range||void 0,domain:i.domain||void 0,trackBy:i.trackBy||"id"}};return t.extend(true,{},r,e||{})}function n(n,i){var a=i||{};var s=a.source||[];"string"===typeof s&&(s=[s]);var r={name:"measure",component:{expand:.1,data:{fields:s.map(function(t){return{field:t}})}}};var o=i&&i.measureAxisProperties;if(o&&!o.autoMinMax){["min","minMax"].contains(o.minMax)&&(r.component.min=o.min);["max","minMax"].contains(o.minMax)&&(r.component.max=o.max)}var l=t.extend(true,r,n||{}),c=e(l,i),u=n&&n.component&&"undefined"!==typeof n.component.invert;!u&&i&&"vertical"===i.orientation&&(c.component.invert=!c.component.invert);return c}function i(n,i){var a={name:"dimension",component:{trackBy:"id",type:"band",data:{extract:{field:i&&i.source||"",props:{label:function t(e){return e.qText||""}}}},label:function t(e){return e.datum.label.value}}};var s=t.extend(true,a,n||{});return e(s,i)}e.measureScale=n;e.dimensionScale=i;return e}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(201),n(1143),n(90)],a=function(t,e,n){function i(i,a){var s=a&&a.chartID;var r=a&&a.layoutMode;var o=a&&a.dock;var l=a&&a.direction;var c=a&&a.isRtl;var u=t.getStyle(s,"axis.line.major","color");var d=t.getFontSize(s,"axis.title",r);var p=t.getStyle(s,"axis.title","color");var h=t.getStyle(s,"axis.label.name","color");var f=t.getFontSize(s,"axis.label.name",r);var g="QlikView Sans";var v="QlikView Sans";var m={key:"axis",type:"axis",dock:e.getAxisDock(l,o,c),brush:{trigger:[],consume:[]},settings:{title:{fontSize:d,fontFamily:g,fill:p},line:{show:true,strokeWidth:1,stroke:u},labels:{fill:h,fontSize:f,fontFamily:v,tiltAngle:c?-40:40,maxEdgeBleed:75,maxSize:150,mode:"auto"},ticks:{stroke:u},minorTicks:{stroke:u}}};return n.extend(true,{},m,i||{})}function a(t,e){var a={key:"x-axis",scale:"x"};var s=n.extend(true,a,t||{});return i(s,e)}function s(t,a){var s=a&&a.dock;var r=a&&a.isRtl;var o={key:"y-axis",scale:"y",dock:e.getYAxisDock(s,r)};var l=n.extend(true,o,t||{});return i(l,a)}i.xAxis=a;i.yAxis=s;return i}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90)],a=function(t){function e(e){var n={key:"box-marker",type:"box-marker",settings:{minor:{scale:"x"},orientation:"horizontal"},brush:{trigger:[],consume:[]}};return t.extend(true,{},n,e||{})}return e}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90)],a=function(t){function e(e){var n={type:"event-area",key:"event-area"};return t.extend(true,{},n,e||{})}return e}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(201),n(90)],a=function(t,e){function n(n,i){var a=i&&i.chartID;var s=t.getStyle(a,"grid.line.major","color");var r={displayOrder:-1,key:"grid-line",type:"grid-line",x:null,y:null,ticks:{stroke:s},minorTicks:{stroke:s}};return e.extend(true,{},r,n||{})}return n}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90)],a=function(t){function e(e,n){var i=n&&n.gestures||[];var a={type:"hammer",key:"hammered",gestures:i};return t.extend(true,{},a,e||{})}return e}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90)],a=function(t){function e(e){var n={key:"point-marker",type:"point-marker",settings:{},brush:{trigger:[],consume:[]}};return t.extend(true,{},n,e||{})}return e}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90),n(201)],a=function(t,e){function n(n,i){var a=i&&i.isRtl;var s=i&&i.chartID;var r=i&&i.isHorizontal;var o={key:"scrollbar",type:"scrollbar",scroll:"dimension",dock:r?"bottom":a?"left":"right",settings:{backgroundColor:e.getStyle(s,"","backgroundColor"),invert:a&&r}};return t.extend(true,{},o,n||{})}return n}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(201),n(1143),n(90)],a=function(t,e,n){function i(i,a){var s=a&&a.chartID;var r=a&&a.layoutMode;var o=a&&a.dock;var l=a&&a.direction;var c=a&&a.isRtl;var u=31===r?r:"medium";var d=t.getFontSize(s,"axis.title",u);var p=t.getStyle(s,"axis.title","color");var h="QlikView Sans";var f={key:"text",type:"text",dock:e.getAxisDock(l,o,c)||"bottom",displayOrder:0,style:{text:{fontSize:d,fontFamily:h,fill:p}}};return n.extend(true,{},f,i||{})}function a(t,e){var a={key:"x-axis-title"};var s=n.extend(true,a,t||{});return i(s,e)}function s(t,a){var s=a&&a.dock;var r=a&&a.isRtl;var o={key:"y-axis-title",dock:e.getYAxisDock(s,r)||"left"};var l=n.extend(true,o,t||{});return i(l,a)}i.xAxisTitle=a;i.yAxisTitle=s;return i}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90)],a=function(t){function e(e,n){var i=n&&n.brushKey;var a=n&&n.brushComponents?n.brushComponents:[];var s=n&&n.brushData?n.brushData:["elemNo"];var r={type:"brush-lasso",key:"lasso",displayOrder:99,settings:{brush:{components:[]},lasso:{fill:"rgba(0, 0, 0, 0)",stroke:"rgba(102,102,102,1)",strokeWidth:2,opacity:1,strokeDasharray:null},startPoint:{r:10,fill:"rgba(0, 152, 69, 1)",strokeWidth:0,opacity:1}}};a.forEach(function(t){r.settings.brush.components.push({contexts:i?[i]:void 0,key:t,data:s})});return t.extend(true,{},r,e||{})}return e}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90),n(1246)],a=function(t,e){function n(n,i){var a=i&&i.brushKey;var s=i&&i.brushAxis;var r=i&&i.brushArea;var o=i&&i.brushScale;var l=i&&i.isHorizontal;var c=i&&i.dock;var u=i&&i.isRtl;var d={type:"brush-range",key:"range",displayOrder:99,dock:e.getDock(s,r),settings:{brush:a,fill:"rgba(0, 0, 0, 0)",scale:o,multiple:!i||false!==i.multiple||i.multiple,direction:l?"horizontal":"vertical",target:{component:s,fill:"rgba( 82, 204, 82, 0.2 )",fillActive:"rgba(82, 204, 82, 0.4)"},bubbles:{align:e.getBublesAlign(l,c,u)}}};return t.extend(true,{},d,n||{})}return n}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90),n(201)],a=function(t,e){function n(n,i){var a=i&&i.chartID;var s=e.getStyle(a,"referenceLine.outOfBounds","color");var r=e.getStyle(a,"referenceLine.outOfBounds","backgroundColor");var o={key:"ref-line",type:"ref-line",dock:"center",prioOrder:-1,lines:{x:[],y:[]},style:{oob:{width:7,fill:r,text:{fill:s},padding:{x:7,y:5}}}};return t.extend(true,{},o,n||{})}return n}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={SPARK:{width:0,height:0},XSMALL:{width:150,height:75},SMALL:{width:300,height:150},MEDIUM:{width:400,height:220},FULL:{width:550,height:450}};function e(){return t}e.getLayoutModeKeys=function(){var e=[];var n;for(n in t)e.push(n);return e};return e}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90),n(201)],a=function(t,e){function n(t){var e=t.data.end;var n=t.dataset(e.source.key).field(e.source.field).formatter();return n(e.value)}function i(i,a){var s=a&&a.chartID;var r=a&&a.layoutMode;var o=e.getStyle(s,"label.value","color");var l=e.getFontSize(s,"label.value",r);var c="QlikView Sans";var u={key:"labels",type:"labels",displayOrder:1,settings:{sources:[{component:"box-marker",selector:"rect",strategy:{type:"bar",settings:{direction:"up",fontFamily:c,fontSize:parseFloat(l),align:.5,labels:[{placements:[{position:"outside",fill:o,justify:0},{position:"inside",fill:i&&i.settings.sources[0].strategy.settings.labels[0].placements[1].fill,justify:1}],label:n}]}}}]}};return t.extend(true,{},u,i||{})}return i}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(201),n(90)],a=function(t,e){var n={left:"left",right:"right",up:"top",down:"bottom"};function i(i,a){var s=a&&a.chartID;var r=a&&a.isRtl;var o=a&&a.dock||"auto";var l=a&&a.show;"auto"===o&&(o=a.chartHeight/a.chartWidth<1?r?"left":"right":"bottom");var c=t.getStyle(s,"legend.title","color");var u=t.getStyle(s,"legend.title","fontSize");var d=t.getStyle(s,"legend.label","color");var p=t.getStyle(s,"legend.label","fontSize");var h="QlikView Sans";var f="QlikView Sans";var g={key:"legend",type:"legend-cat",dock:o,show:l,scale:{type:"color"},settings:{title:{anchor:"middle"},layout:{direction:r?"rtl":"ltr",size:"top"===o||"bottom"===o?2:1,vertical:"top"===o||"bottom"===o?16:8},navigation:{button:{class:{"lui-fade-button":true},content:function t(e,i){var a=["lui-button__icon","lui-icon","lui-icon--triangle-"+n[i.direction]];return e("span",{style:{pointerEvents:"none"},class:a.join(" ")})}}}},style:{item:{label:{fontSize:p,fontFamily:f,fill:d,lineHeight:1,wordBreak:"break-word"},margin:{top:5,left:10,right:10,bottom:10},shape:{type:a.type?a.type:"square",size:3*parseInt(p,10)/4}},title:{show:a.showTitle,fontSize:u,fontFamily:h,fill:c}}};return e.extend(true,{},g,i)}return i}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(201),n(90)],a=function(t,e){function n(n,i){var a=i&&i.chartID;var s=i&&i.layoutMode;var r=i&&i.isRtl;var o=i.dock||"auto";"auto"===o&&(o=i.chartHeight<i.chartWidth?r?"left":"right":"bottom");var l=t.getStyle(a,"legend.title","color");var c=t.getFontSize(a,"legend.title",s);var u="QlikView Sans";var d=t.getStyle(a,"legend.label","color");var p=t.getFontSize(a,"legend.label",s);var h="QlikView Sans";function f(t){switch(t){case"left":return 0;case"right":return 1;case"middle":default:return.5}}var g={key:"seqlegend",type:"legend-seq",dock:o,displayOrder:200,minimumLayoutMode:"MEDIUM",prioOrder:0,settings:{align:f(r?"right":"left"),major:{invert:"left"===o||"right"===o||r},title:{show:i.showTitle,fontSize:c,fontFamily:u,fill:l},tick:{fill:d,fontSize:p,fontFamily:h}}};var v=e.extend(true,{},g,n);return v}return n}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(90),n(1246)],a=function(t,e){function n(n,i){var a=i&&i.brushKey;var s=i&&i.brushAxis;var r=i&&i.brushComponents?i.brushComponents:[];var o=i&&i.brushData?i.brushData:["elemNo"];var l=i&&i.brushArea;var c=i&&i.isHorizontal;var u=i&&i.dock;var d=i&&i.isRtl;var p=i&&i.chartInstance;var h=true;var f={type:"brush-area-dir",key:"area",displayOrder:99,dock:e.getDock(s,l),settings:{brush:{components:[]},direction:c?"horizontal":"vertical",target:{component:s,fill:"rgba( 82, 204, 82, 0.2 )",fillActive:"rgba(82, 204, 82, 0.4)"},bubbles:{align:e.getBublesAlign(c,u,d),label:function t(e){if(h){h=false;var n=p.dataset(e.binStart.source.key).field(e.binStart.source.field).formatter()(e.binStart.value);return n}h=true;var i=p.dataset(e.binEnd.source.key).field(e.binEnd.source.field).formatter()(e.binEnd.value);return i}},multiple:!i||false!==i.multiple||i.multiple}};r.forEach(function(t){f.settings.brush.components.push({contexts:a?[a]:void 0,key:t,data:o,action:"add"})});return t.extend(true,{},f,n||{})}return n}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(11),n(1144),n(1309),n(1523),n(1247)],a=function(t,e,n,i,a){s.ERRORS={SET:"Calling Disclaimer.set() without attributes",DISPLAY:"Calling Disclaimer.display() before attributes are applied"};function s(t){this.options=t;this.clear()}s._applyDefaultSupport=function(t,e){var n=t;n||(n={});e.forEach(function(t){void 0===n[t.label]&&(n[t.label]=t.default)});return n};s.prototype.getBottomDisclaimerVisibility=function(){var t=new a(e.DISCLAIMERS,this.dataAttributes,this.vizAttributes.supportedDisclaimers);return t.isAnyValidDisclaimer(e.ALIGNMENT.BOTTOM)&&!t.isAnyValidDisclaimer(e.ALIGNMENT.CENTER)};s.prototype.toggleBottomDisclaimerVisibility=function(t,e){var n=!!(e||this.vizAttributes.options&&this.vizAttributes.options.paddingBottom);this.options.showDisclaimerStar=e;t.toggleClass("qv-viz-with-disclaimer",n)};s.prototype.display=function(n){var a;if(!(this.vizAttributes&&this.dataAttributes&&this.options))throw new Error(s.ERRORS.DISPLAY);this.vizAttributes.supportedDisclaimers=s._applyDefaultSupport(this.vizAttributes.supportedDisclaimers,e.DISCLAIMERS);a=t(n);a.siblings(".disclaimer").addClass("to-remove");a.parent().append("<div class='disclaimer'></div>");a.siblings(".disclaimer").last().showComponent(i,{dataAttributes:t.extend(true,{},this.dataAttributes),direction:this.options.direction,supportedDisclaimers:t.extend(true,{},this.vizAttributes.supportedDisclaimers),onRender:function t(){a.siblings(".disclaimer.to-remove").remove()}});this.toggleBottomDisclaimerVisibility(a,this.getBottomDisclaimerVisibility())};s.prototype.set=function(t){this.clear();if(!t)throw new Error(s.ERRORS.SET);this.vizAttributes=t;this.dataAttributes=n.applyAttributes(this.vizAttributes.options,this.vizAttributes.data)};s.prototype.clear=function(){this.vizAttributes=null;this.dataAttributes=null};return s}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e,n){"use strict";var i,a;!(i=[n(1524),n(1144),n(1247),n(91)],a=function(t,e,n,i){return{template:t,scope:{dataAttributes:"=",direction:"=",supportedDisclaimers:"=",onRender:"="},controller:["$scope","$timeout",function(t,a){var s=new n(e.DISCLAIMERS,t.dataAttributes,t.supportedDisclaimers);t.centerDisclaimer={show:s.isAnyValidDisclaimer(e.ALIGNMENT.CENTER),message:s.getMessage(e.ALIGNMENT.CENTER,i)};t.outerDisclaimer={show:s.isAnyValidDisclaimer(e.ALIGNMENT.BOTTOM),message:s.getMessage(e.ALIGNMENT.BOTTOM,i)};t.languageString=i.get("Object.Disclaimer.LimitedData");a(function(){t.onRender()},5)}]}}.apply(e,i),void 0!==a&&(t.exports=a))},function(t,e){t.exports='<span class="qv-viz-center-disclaimer" ng-if="centerDisclaimer.show" title="{{ centerDisclaimer.message }}" dir="ltr">{{ centerDisclaimer.message }}</span>\n<div class="qv-viz-disclaimer"\n\t ng-if="!centerDisclaimer.show && outerDisclaimer.show"\n\t style="font-size: 1em;"\n\t qva-direction x-dir-setting="{{direction}}" x-dir-text="{{languageString}}">\n\t<span class="ltr-star">*</span>\n\t<span class="title" title="{{ outerDisclaimer.message }}">{{ outerDisclaimer.message }}</span>\n\t<span class="rtl-star">*</span>\n</div>'},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){t.exports='<div class="qv-zoom-pan-nav" ng-style="navigationStyle">\n\t<div ng-show="navigationHomeOnly && navigationVisible" class="qv-zoom-pan-nav-homeonly">\n\t\t<button class="qv-zoom-pan-nav-home  lui-fade-button  lui-fade-button--large" qva-activate="onHomePressed()" ng-disabled="navigationDefaultPosition || navigationDisabled" q-title-translation="Object.Navigation.ResetZoom">\n\t\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--large  lui-icon--home"></span>\n\t\t\t</button>\n\t</div>\n\t<div ng-show="!navigationHomeOnly && navigationVisible" class="qv-zoom-pan-nav-fullnav">\n\t\t<div class="qv-zoom-pan-nav-top">\n\t\t\t<button class="qv-zoom-pan-nav-up  lui-fade-button  lui-fade-button--large" qva-activate="onNavigationPressed(\'navUp\')" ng-disabled="navigationDisabled" q-title-translation="Object.Navigation.PanUp">\n\t\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--large  lui-icon--triangle-top"></span>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="qv-zoom-pan-nav-middle">\n\t\t\t<button class="qv-zoom-pan-nav-left  lui-fade-button  lui-fade-button--large" qva-activate="onNavigationPressed(\'navLeft\')" ng-disabled="navigationDisabled" q-title-translation="Object.Navigation.PanLeft">\n\t\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--large  lui-icon--triangle-left"></span>\n\t\t\t</button>\n\t\t\t<button class="qv-zoom-pan-nav-home  lui-fade-button  lui-fade-button--large" qva-activate="onHomePressed()" ng-disabled="navigationDefaultPosition || navigationDisabled" q-title-translation="Object.Navigation.ResetZoom">\n\t\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--large  lui-icon--home"></span>\n\t\t\t</button>\n\t\t\t<button class="qv-zoom-pan-nav-right  lui-fade-button  lui-fade-button--large" qva-activate="onNavigationPressed(\'navRight\')" ng-disabled="navigationDisabled" q-title-translation="Object.Navigation.PanRight">\n\t\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--large  lui-icon--triangle-right"></span>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="qv-zoom-pan-nav-bottom">\n\t\t\t<button class="qv-zoom-pan-nav-down  lui-fade-button  lui-fade-button--large" qva-activate="onNavigationPressed(\'navDown\')" ng-disabled="navigationDisabled" q-title-translation="Object.Navigation.PanDown">\n\t\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--large  lui-icon--triangle-bottom"></span>\n\t\t\t</button>\n\t\t\t<button class="qv-zoom-pan-nav-in  lui-fade-button  lui-fade-button--large" qva-activate="onNavigationPressed(\'zoomIn\')" ng-disabled="navigationDisabled" q-title-translation="Object.Navigation.ZoomIn">\n\t\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--large  lui-icon--zoom-in"></span>\n\t\t\t</button>\n\t\t\t<button class="qv-zoom-pan-nav-out  lui-fade-button  lui-fade-button--large" qva-activate="onNavigationPressed(\'zoomOut\')" ng-disabled="navigationDisabled" q-title-translation="Object.Navigation.ZoomOut">\n\t\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--large  lui-icon--zoom-out"></span>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n</div>'}])]);