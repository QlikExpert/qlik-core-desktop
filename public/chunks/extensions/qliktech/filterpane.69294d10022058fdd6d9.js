/*!
 * sense-client@6.105.4
 * 
 * Copyright(C) 2019 Qlik International AB
 * All Rights Reserved
 * 
 */
(window["qJsonp"]=window["qJsonp"]||[]).push([[43],{1053:function(e,t,n){"use strict";var i,o;!(i=[n(11),n(48),n(90),n(89),n(1570),n(1571),n(1572),n(153),n(156),n(1573),n(205),n(447),n(189),n(91),n(113),n(167),n(1574),n(1575),n(1577),n(1578)],o=function(e,t,n,i,o,s,r,l,u,a,c,d,f,p,h,m){var v=1e3,q=1;var g=0;function b(){return"filterpane-"+ ++g}function x(e){return e.columns.some(function(e){return e.items.some(function(e){return e.expand&&(!e.object||1!==e.object.renderState)})})}var D=c.extend({size:{},columns:[],expandable:false,init:function t(n,i,o,s,r){this.$scope=n;this.$element=i;this.$timeout=o;this.filterpaneLayout=s;this.updateDeferred;n.object.throbberApi.off();this.showThrobberTimeout=o(function(){n.object.throbberApi.show()},1e3);n.outsideIgnoreName=b();n.columns=[];n.ext.expandable=function(){return this.expandable}.bind(this);n.options||(n.options={});n.navService=r;n.accessibleFilterpane=h.ACCESSIBLE_FILTERPANE;n.fullscreenButtonLabel=p.get("Accessibility.Filterpane.SpaceForFullScreen");function l(e){if(h.ACCESSIBLE_FILTERPANE){n.focus&&n.focus.item&&!e||r.init(n,e);n.focus.item.focus();n.focus.focusInListbox=false}}n.setFocus=l;n.object.setOnFocusHandler(l);n.handleKeyDown=function(e){if(h.ACCESSIBLE_FILTERPANE){if(n.focus.focusInListbox)return;if(e.which===m.ESCAPE){if(n.object.expanded){n.$emit("zoomOut");n.focus.shouldResetFocus=true}else"function"===typeof n.object.blur&&n.object.blur();e.preventDefault()}else if(e.which===m.ENTER||e.which===m.SPACE)if(n.focus.isFullscreenBtn){n.triggerFullScreen();n.focus.shouldResetFocus=true}else if(n.focus.item.expand){n.focus.item.object.focus();n.focus.focusInListbox=true}else n.$broadcast("openPopover",{target:e.target});else if(m.isArrow(e.which)){e.preventDefault();e.stopPropagation();r.handleNavigation(n,e.which)}}};n.setFocusInListbox=function(){if(h.ACCESSIBLE_FILTERPANE){n.focus||(n.focus={});n.focus.focusInListbox=true}};n.hasFocus=function(){return i[0].contains(document.activeElement)};n.triggerFullScreen=function(){if(n.object.inAnalysisState()){e(".embedded-sheet-toolbar").length>0&&e(".embedded-sheet-toolbar").css("display","none");n.$emit("zoomOnCell")}};n.$on("objectRenderStateChange",function(e,t){e.stopPropagation();t&&!x(n)&&this.renderStateDfd.resolve()}.bind(this));i.on("focusout",function(t){if(null===t.target.getAttribute("tabIndex"))return;var n=e(t.target);var i=n.scope().item;!i&&n.closest(".qv-filterpane-column").scope().column&&(i=n.closest(".qv-filterpane-column").scope().column.fullscreen);i&&"function"===typeof i.blur&&i.blur()});n.$on("$destroy",function(){i.off("focusout")})},onPaint:function e(){this.renderStateDfd=i();this.update(this.$scope.layout).then(function(){x(this.$scope)||this.renderStateDfd.resolve()}.bind(this));return this.renderStateDfd.promise},onResize:function e(){this.renderStateDfd=i();this.update(this.$scope.layout).then(function(){x(this.$scope)||this.renderStateDfd.resolve()}.bind(this));return this.renderStateDfd.promise},update:function e(t){this.updateDeferred&&this.updateDeferred.reject();this.updateDeferred=new i;var o=this.size,s=this.$scope,r=this.columns,l=this.$element,u=s.focus,a=s.object.model.app,c=this.filterpaneLayout,d=c.getSize(l,t),f=c.getResolveModelFunction(a),p,h;if(c.sizeChanged(o,d)){u&&(h=u.item?u.item.id:"fullscreen");o=d;this.size=d;r=this.getColumns(o);this.columns=r}if(!c.isValid(t)){r=[];s.columns=r;return i.resolve()}p=c.getDimensions(t);p=c.sortDimensions(t,p);this.dimensions=p;this.preferredSizeDeferred&&this.preferredSizeDeferred.resolve();r=c.mergeColumnsAndDimensions(r,p);c.resolveAllModels(s,r,f,i).then(function(){this.updateDeferred.resolve()}.bind(this));this.updateDeferred.promise.then(function(){c.calculateExpandPriority(r,o);c.patchScope(s,r,n);this.$timeout.cancel(this.showThrobberTimeout);s.object.throbberApi.hide();this.expandable=!s.columns.some(function(e){return e.items.some(function(e){var t=e.model;return t&&t.layout&&t.layout.qSelectionInfo&&t.layout.qSelectionInfo.qInSelections})});s.hasExpanded=s.columns.some(function(e){return e.expand});s.navService.updateFocus(s,h)}.bind(this));return this.updateDeferred.promise},getColumns:function e(t){var n=[];this.filterpaneLayout.calculateColumns(t,n,this.$scope.options.zoomEnabled);return this.filterpaneLayout.balanceColumns(t,n)},setInteractionState:function e(t){this.$scope.interactive=this.$scope.object&&this.$scope.object.inAnalysisState()&&false!==this.$scope.options.navigation&&false!==this.$scope.options.selections;this.$scope.columns.forEach(function(e){e.items.forEach(function(e){e.expand&&e.object.setInteractionState(t)})})},setDirection:function e(t){this.$scope.options&&(this.$scope.options.direction=t);this.$scope.columns.forEach(function(e){e.items.forEach(function(e){e.expand&&e.object.setDirection(t)})})},getPreferredSize:function e(){var t=i();this.preferredSizeDeferred&&this.preferredSizeDeferred.reject();this.preferredSizeDeferred=i();var n=this;this.preferredSizeDeferred.promise.then(function(){n.preferredSizeDeferred=null;t.resolve({w:n.$element.width(),h:n.filterpaneLayout.getHeightOf(n.dimensions.length)})});this.dimensions&&this.preferredSizeDeferred.resolve();return t.promise}});D.$inject=["$scope","$element","$timeout","qvFilterpaneLayout","qvFilterPaneKeyboardNavigationService"];var y={type:"filterpane",template:a,BackendApi:o,controller:D,definition:s,initialProperties:{qChildListDef:{qData:{info:"/qInfo"}}},data:{dimensions:{min:1,max:1e3,description:function e(){return p.get("Visualizations.Descriptions.Pane")}}},expandable:function e(){return false},mapProperties:function e(){this.mappedDefinition=u.mapDefinition(this.definition,this.type);this.dimensionDefinition={min:1}},getCreatePropertyHandler:function e(t){return new r({app:t,dimensionDefinition:this.dimensionDefinition})},addFieldDimension:function e(n,i){return i.model.getProperties().then(function(e){var o=i.getCreatePropertyHandler();o.setProperties(e);o.setModel(i.model);return o.addFieldDimension(n.value,n.displayName).then(function(e){t.$rootScope.$broadcast("pp-open-path","data."+e.qDef.cId)})})},addLibraryDimension:function e(n,i){return i.model.getProperties().then(function(e){var o=i.getCreatePropertyHandler();o.setProperties(e);o.setModel(i.model);return o.addLibraryDimension(n.libraryId).then(function(e){t.$rootScope.$broadcast("pp-open-path","data."+e.qDef.cId)})})},getDropFieldOptions:function e(n,i,o){if(i.getDimensions().length<i.maxDimensions()){i.setModel(o);i.addFieldDimension(n.item.name,n.item.displayName).then(function(e){o.setProperties(i.properties);t.$rootScope.$broadcast("pp-open-path","data."+e.qDef.cId)})}},getDropDimensionOptions:function e(n,i,o){if(i.getDimensions().length<i.maxDimensions()){i.setModel(o);i.addLibraryDimension(n.item.id).then(function(e){o.setProperties(i.properties);t.$rootScope.$broadcast("pp-open-path","data."+e.qDef.cId)})}},getDropMeasureOptions:function e(t,n,i,o){o()},getExportRawDataOptions:function e(n,o){return o.model.getLayout().then(function(e){if(1===e.qChildList.qItems.length){n.addItem({translation:"contextMenu.export",tid:"export",select:function n(){o.model.app.getObject(e.qChildList.qItems[0].qInfo.qId).then(function(e){t.getService("$exportDialog").show(e)})}});return}var s=[];n.addItem({translation:"Export.AllDimensions",tid:"export-all-dimensions",select:function e(){t.getService("$exportDialog").show(o.model)}});e.qChildList.qItems.forEach(function(e){s.push(o.model.app.getObject(e.qInfo.qId).then(function(e){return e.getLayout().then(function(i){n.addItem({translation:i.title,tid:"export",select:function n(){t.getService("$exportDialog").show(e)}})})}))});return i.all(s)})},exportProperties:function e(t){var n=new d,i=t.qProperty,o=n.data[0],s,r,l,u,a;if(t.qChildren)for(r=0;r<t.qChildren.length;++r){s=t.qChildren[r].qProperty;o.dimensions.push({qDef:s.qListObjectDef.qDef,qLibraryId:s.qListObjectDef.qLibraryId,qOtherTotalSpec:s.qListObjectDef.qOtherTotalSpec||{qOtherMode:"OTHER_OFF",qOtherCounted:{qv:"10"}},title:s.title})}if(i.qLayoutExclude&&i.qLayoutExclude.qHyperCubeDef){if(i.qLayoutExclude.qHyperCubeDef.qDimensions)for(r=0;r<i.qLayoutExclude.qHyperCubeDef.qDimensions.length;++r)o.excludedDimensions.push(i.qLayoutExclude.qHyperCubeDef.qDimensions[r]);if(i.qLayoutExclude.qHyperCubeDef.qMeasures)for(r=0;r<i.qLayoutExclude.qHyperCubeDef.qMeasures.length;++r)o.excludedMeasures.push(i.qLayoutExclude.qHyperCubeDef.qMeasures[r]);if(i.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder)for(r=0;r<i.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder.length;++r)o.interColumnSortOrder.push(i.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder[r])}for(u in i)"qChildListDef"!==u&&(n.properties[u]=i[u]);i.qLayoutExclude||(i.qLayoutExclude={});if(i.qLayoutExclude.disabled){for(u in i.qLayoutExclude.disabled){a=u;n.properties.hasOwnProperty(a)||(n.properties[a]=i.qLayoutExclude.disabled[u])}i.qLayoutExclude.disabled.previousShowTitles&&(n.properties.showTitles=true)}delete i.qLayoutExclude;for(r=0;r<o.dimensions.length;++r)for(l=0;l<o.dimensions[r].qDef.qSortCriterias.length;++l){o.dimensions[0].qDef.qSortCriterias[l].qSortByFrequency=0;o.dimensions[0].qDef.qSortCriterias[l].qSortByState=0}return n},importProperties:function e(t,i){var o={qChildren:[]},s={},r=t.data[0],u,a;s.qLayoutExclude||(s.qLayoutExclude={});s.qLayoutExclude.disabled={};for(u in t.properties)"qLayoutExclude"===u?t.properties[u].quarantine&&(s.qLayoutExclude.quarantine=n.extend(true,{},t.properties[u].quarantine)):i.hasOwnProperty(u)||f.isMasterItemProp(u)?s[u]=t.properties[u]:s.qLayoutExclude.disabled[u]=t.properties[u];s=n.extend(true,{},i,s);for(a=0;a<r.dimensions.length;++a)if(o.qChildren.length<v)o.qChildren.push({qProperty:l.createDefaultListBox(r.dimensions[a],r.dimensions[a].title),qChildren:[]});else{s.qLayoutExclude||(s.qLayoutExclude={});s.qLayoutExclude.qHyperCubeDef||(s.qLayoutExclude.qHyperCubeDef={});s.qLayoutExclude.qHyperCubeDef.qDimensions||(s.qLayoutExclude.qHyperCubeDef.qDimensions=[]);s.qLayoutExclude.qHyperCubeDef.qDimensions.push(r.dimensions[a])}if(r.measures.length){s.qLayoutExclude.qHyperCubeDef||(s.qLayoutExclude.qHyperCubeDef={});s.qLayoutExclude.qHyperCubeDef.qMeasures||(s.qLayoutExclude.qHyperCubeDef.qMeasures=[]);for(a=0;a<r.measures.length;++a)s.qLayoutExclude.qHyperCubeDef.qMeasures.push(r.measures[a])}for(a=0;a<r.excludedDimensions.length;++a)if(o.qChildren.length<q)o.qChildren.push({qProperty:l.createDefaultListBox(r.excludedDimensions[a],r.excludedDimensions[a].title),qChildren:[]});else{s.qLayoutExclude.qHyperCubeDef||(s.qLayoutExclude.qHyperCubeDef={});s.qLayoutExclude.qHyperCubeDef.qDimensions||(s.qLayoutExclude.qHyperCubeDef.qDimensions=[]);s.qLayoutExclude.qHyperCubeDef.qDimensions.push(r.excludedDimensions[a])}for(a=0;a<r.excludedMeasures.length;++a){s.qLayoutExclude.qHyperCubeDef||(s.qLayoutExclude.qHyperCubeDef={});s.qLayoutExclude.qHyperCubeDef.qMeasures||(s.qLayoutExclude.qHyperCubeDef.qMeasures=[]);s.qLayoutExclude.qHyperCubeDef.qMeasures.push(r.excludedMeasures[a])}for(a=0;a<r.interColumnSortOrder.length;++a)if(s.qLayoutExclude.qHyperCubeDef){s.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder||(s.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder=[]);s.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder.push(r.interColumnSortOrder[a])}f.importCommonProperties(s,t,i);if(s.showTitles){s.qLayoutExclude.disabled.previousShowTitles=true;s.showTitles=false}o.qProperty=s;return o}};return y}.apply(t,i),void 0!==o&&(e.exports=o))},1570:function(e,t,n){"use strict";var i,o;!(i=[n(198)],o=function(e){var t;t=e.extend("FieldApi",{init:function e(t){this._super(t,"/dimensions");this.cacheCube.setMethodName("getListObjectData")},updateCache:function e(){},getProperties:function e(){return this.model.getProperties()},getData:function e(t){return this.cacheCube.getData(t)},getSize:function e(){return this.model.layout.qListObject.qSize},isLocked:function e(){return this.model.layout.qListObject.qDimensionInfo.qLocked}});return t}.apply(t,i),void 0!==o&&(e.exports=o))},1571:function(e,t,n){"use strict";var i,o;!(i=[],o=function(){var e,t,n,i;i={qSortByState:1,qSortByAscii:1,qSortByNumeric:1,qSortByLoadOrder:1};e={uses:"settings",items:{general:{items:{showTitles:{defaultValue:false}}}}};t={type:"array",component:"filterpane-data",translation:"Common.Data",allowAdd:true,allowRemove:true,allowMove:true,addTranslation:"properties.dimensions.add",grouped:false,ref:"qChildListDef",items:{libraryId:{type:"string",component:"library-item",libraryItemType:"dimension",ref:"qListObjectDef.qLibraryId",translation:"Common.Dimension",show:function e(t){return t.qListObjectDef.qLibraryId}},field:{type:"string",component:"expression",expressionType:"dimension",ref:"qListObjectDef.qDef.qFieldDefs.0",translation:"Common.Field",show:function e(t){return!t.qListObjectDef.qLibraryId},change:function e(t){var n=t.qListObjectDef.qDef;n.qFieldLabels||(n.qFieldLabels=[]);n.qFieldLabels[0]=n.qFieldDefs[0]}},title:{ref:"title",type:"string",expression:"optional",translation:"Common.Title"},autoSort:{ref:"qListObjectDef.qDef.autoSort",type:"boolean",defaultValue:true,show:false},cId:{ref:"qListObjectDef.qDef.cId",type:"string",show:false}}};n={type:"items",component:"filterpane-sorting",translation:"properties.sorting",allowMove:true,schemaIgnore:true,items:{autoSort:{ref:"qListObjectDef.qDef.autoSort",type:"boolean",translation:"properties.sorting",component:"switch",defaultValue:true,options:[{value:true,translation:"Common.Auto"},{value:false,translation:"Common.Custom"}],change:function e(t){if(t.qListObjectDef.qDef.autoSort){var n=t.qListObjectDef;for(var o=0;o<n.qDef.qSortCriterias.length;o++)n.qDef.qSortCriterias[o]=i}}},dimension:{component:"sorting-dimension",ref:"qListObjectDef",show:function e(t){return!t.qListObjectDef.qDef.autoSort},sortingItems:{state:true,expression:true,frequency:true,numeric:true,ascii:true}}}};return{type:"items",component:"accordion",items:{data:t,sorting:n,settings:e}}}.apply(t,i),void 0!==o&&(e.exports=o))},1572:function(e,t,n){"use strict";var i,o;!(i=[n(238),n(153),n(130),n(90),n(115)],o=function(e,t,n,i,o){var s=1e3;var r=e.extend({init:function e(t){this._super(t);this.dimensionLayout=[];this.dimensions=[]},autoSortDimension:function e(i){return i.qLibraryId?this.app.getDimensionList().then(function(e){var o=n.findLibraryDimension(i.qLibraryId,e);var s=o?o.qData.info:void 0;t.autoSortDimension(i,s);return i}):this.app.getFieldList().then(function(e){var o=n.findField(i.qDef.qFieldDefs[0],e);var s=o?[o]:void 0;t.autoSortDimension(i,s);return i})},getDimensions:function e(){return this.dimensions||[]},minDimensions:function e(){return 1},maxDimensions:function e(){return 1e3},setModel:function e(t){this.model=t},addDimension:function e(t){var n,r,l=this;t.qDef.cId=i.generateId();t.qShowAlternatives=true;if(this.getDimensions().length<s){n=o.getType("listbox");r=n.getInitialProperties({});return r.then(function(e){return l.autoSortDimension(t).then(function(){e.qListObjectDef=t;if(t.qLibraryId)return l.app.getDimension(t.qLibraryId).then(function(t){return t.getProperties().then(function(t){t.qDim.qLabelExpression?e.title={qStringExpression:{qExpr:t.qDim.qLabelExpression}}:e.title=t.qDim.title;return l.model.createChild(e,l.properties).then(function(){return e.qListObjectDef})})});e.title=t.qDef.title||t.qDef.qFieldLabels[0]||t.qDef.qFieldDefs[0];return l.model.createChild(e,l.properties).then(function(){return e.qListObjectDef})})})}},removeDimension:function e(t){var n=this.layout.qChildList.qItems[t];return this.model.destroyChild(n.qInfo.qId,this.properties).then(function(){return n})},getDimensionLayouts:function e(){return this.dimensionLayout||[]},getDimensionLayout:function e(t){var n=this.getDimensionLayouts();return n[t]?n[t].qListObject.qDimensionInfo:""}});return r}.apply(t,i),void 0!==o&&(e.exports=o))},1573:function(e,t){e.exports='<qv-filterpane\n\t\tclass="qv-filterpane"\n\t\tqv-collapsed-listbox-delegated-open\n\t\toutside-ignore-name="outsideIgnoreName"\n\t\tinteractive="interactive"\n\t\tqva-direction x-dir-setting="{{options.direction}}"\n\t\tng-class="{\'qv-filterpane-scrollable\': !hasExpanded && !options.zoomEnabled}"\n\t\tng-attr-aria-hidden="{{accessibleFilterpane ? \'false\' : \'true\'}}"\n\t\tng-keydown="handleKeyDown($event)"\n\t\trole="list">\n\t<div ng-repeat="column in columns"\n\t\t class="qv-filterpane-column"\n\t\t ng-class="{ \'qv-fullscreen-hidden\': !hasFocus() && $last && column.showAll && !object.expanded }"\n\t\t role="presentation">\n\t\t<div ng-repeat="item in column.items"\n\t\t\t ng-class="{\'qv-filterpane-collapsed\': !item.expand, \'qv-filterpane-expanded\': item.expand}"\n\t\t\t ng-style="{height: item.height}"\n\t\t\t tid="qv-object-filterpane.dimension"\n\t\t\t qv-focusable-filterpane-item="{ type: \'item\' }"\n\t\t\t tabindex="-1"\n\t\t\t role="listitem">\n\t\t\t<qv-object ng-if="item.expand" model="item.model" options="item.options" object="item.object" ng-click="setFocusInListbox()"></qv-object>\n\t\t\t<qv-collapsed-listbox ng-if="!item.expand" model="item.model" read-direction="options.direction" outside-ignore-name="outsideIgnoreName" responsive-mode="item.responsiveMode" interactive="interactive"></qv-collapsed-listbox>\n\t\t</div>\n\n\t\t<div ng-if="column.showAll && object.expanded"\n\t\t\tclass="qv-filterpane-collapsed qv-filterpane-showall"\n\t\t\tqv-focusable-filterpane-item="{ type: \'fullscreen\' }"\n\t\t\ttabindex="-1"\n\t\t\trole="listitem"\n\t\t>\n\t\t\t<span class="lui-icon lui-icon--more" aria-hidden="true"></span>\n\t\t\t<div class="presentation" q-title-translation="Tooltip.Filterpane.NotAllItemsShow"></div>\n\t\t</div>\n\n\t\t<div ng-if="column.showAll && !object.expanded"\n\t\t\t class="qv-filterpane-collapsed qv-filterpane-fullscreen"\n\t\t\t qv-focusable-filterpane-item="{ type: \'fullscreen\' }"\n\t\t\t aria-label="{{fullscreenButtonLabel}}"\n\t\t\t tabindex="-1"\n\t\t\t role="listitem">\n\t\t\t<button class="lui-button"\n\t\t\t\tng-class="{ \'lui-disabled\': !object.inAnalysisState() }"\n\t\t\t\tqva-activate="triggerFullScreen()"\n\t\t\t\tq-title-translation="Tooltip.Filterpane.ClickForFullScreen"\n\t\t\t\ttabindex="-1"\n\t\t\t>\n\t\t\t\t<span class="lui-icon lui-icon--more lui-button__icon" aria-hidden="true"></span>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n</qv-filterpane>\n'},1574:function(e,t,n){"use strict";var i,o;!(i=[n(10),n(48),n(50),n(101)],o=function(e,t,n,i){var o=34,s=28,r=10,l=89,u=160,a=20,c=47,d=30;t.service("qvFilterpaneLayout",function(){return{getMaxColumns:function e(t){return n.isSmallDevice?1:Math.floor((t.width+a)/(u+a))||1},getMaxItemsPerColumn:function e(t){return Math.max(1,Math.floor((t.height+r)/(o+r)))},getDimensionCount:function e(t){return t.qChildList.qItems.length},getColumnItemsCount:function e(t){var n=0;t.forEach(function(e){n+=e.itemCount});return n},getHeightOf:function e(t){var n=(o+r)*t-r;return Math.max(n,0)},getDimensionCardinal:function e(t){var n=i.getValue(t,"model.layout.qListObject.qDimensionInfo.qStateCounts",void 0);if(!n)return;return Object.keys(n).reduce(function(e,t){return e+n[t]},0)},getHeightOfExpanded:function e(t){var n=t*d+c+3;return n},doesAllFit:function e(t,n,i){return i<=t*n},haveRoomToExpandOne:function e(t,i){var o=i.itemCount>1?r:0;return!n.isSmallDevice&&t.height>this.getHeightOf(i.itemCount-1)+l+o},getSize:function e(t,n){return{width:t.innerWidth()-1,height:t.innerHeight(),dimensionCount:this.getDimensionCount(n)}},sizeChanged:function t(n,i){return!e.equals(n,i)},calculateColumns:function e(t,i,o){var u=!n.isSmallDevice&&t.height>l,a=this.getMaxColumns(t),c=this.getMaxItemsPerColumn(t),d=this.getColumnItemsCount(i);if(u&&this.doesAllFit(c,a-i.length-1,t.dimensionCount-d-1)){i.push({expand:true,itemCount:1});d+1<t.dimensionCount&&this.calculateColumns(t,i,o)}else{var f;f=Math.min(t.dimensionCount-d,c);if(n.isSmallDevice)f=t.dimensionCount-d;else if(!o){f=Math.ceil((t.dimensionCount-d)/(a-i.length));f=Math.max(c,f);f=Math.min(t.dimensionCount-d,f)}i.push({expand:false,itemCount:f});if(i.length>=a&&c>0&&this.getColumnItemsCount(i)<t.dimensionCount){i[i.length-1].showAll=true;s+r>t.height-this.getHeightOf(c)&&(i[i.length-1].itemCount=Math.max(i[i.length-1].itemCount-1,0))}this.getColumnItemsCount(i)<t.dimensionCount&&i.length<a&&this.calculateColumns(t,i,o)}},balanceColumns:function e(t,n){var i,o,s;i=n.filter(function(e){return e.expand});o=n.filter(function(e){return false===e.expand});if(o.length>0&&!o[o.length-1].showAll&&this.haveRoomToExpandOne(t,o[o.length-1]))o[o.length-1].expand=true;else{s=this.getColumnItemsCount(o);o.forEach(function(e,t){var n,i;n=t<s%o.length?1:0;i=Math.floor(s/o.length)+n;e.itemCount=i},this)}return o.concat(i)},getDimensions:function e(t){return t.qChildList.qItems.map(function(e){return{id:e.qInfo.qId,expand:false,height:void 0,responsiveMode:"full"}})},sortDimensions:function e(t,n){var i;i=t.qChildList.qItems.map(function(e){return e.qInfo.qId});return i.map(function(e){return n.filter(function(t){return t.id===e})[0]})},isValid:function e(t){return!!t&&!!t.qChildList&&!!t.qChildList.qItems&&this.getDimensionCount(t)>0},mergeColumnsAndDimensions:function e(t,n){t.forEach(function(e){e.items=n.slice(0,e.itemCount);n=n.slice(e.itemCount)},this);return t},reSizeArray:function e(t,n,i,o){while(t.length>n)t.pop();while(t.length<n)t.push(i.extend(true,{},o))},dimensionsEqual:function e(t,n){return t.id===n.id&&t.expand===n.expand&&t.height===n.height},shouldDimensionBeUpdated:function e(t,n){return!this.dimensionsEqual(t,n)},patchScope:function e(t,n,i){this.resizeScopeArrays(t,n,i);t.columns.forEach(function(e,i,o){var s=n[i];o[i].showAll=s.showAll;o[i].expand=s.expand;o[i].itemCount=s.itemCount;e.items.forEach(function(e,n){var o=s.items[n];if(this.shouldDimensionBeUpdated(e,o)){e.colIdx=i;e.rowIdx=n;o.expand||delete e.options;o.expand&&!e.options&&(e.options={isPopover:false,isReadonly:t.object.isReadonly,interactionState:t.options.interactionState,card:t.options.card,selections:t.options.selections,navigation:t.options.navigation,direction:t.options.direction});this.copyDimensionValues(o,e)}},this)},this)},expandOne:function e(t,n){var i,o,s;for(i=0;i<t.length;i++){o=t[i];if(o.cardinal&&!o.expand){s=this.getHeightOfExpanded(o.cardinal);if(s<n){o.expand=true;o.height=s+"px";return s+r}}}return false},calculateExpandPriority:function e(t,n){t.forEach(function(e){if(e.expand){var t=0,i,s,u=n.height-this.getHeightOf(e.itemCount-1)-r,a=0;e.items.forEach(function(e){e.cardinal=this.getDimensionCardinal(e)}.bind(this));i=e.items.concat().sort(function(e,t){return e.cardinal-t.cardinal});if(i.length>1){while(u>l){var c=this.expandOne(i,u);if(!c)break;t++;a+=c;u=n.height-this.getHeightOf(e.itemCount-t)-a}var d=i.filter(function(e){return e.expand});a=0;d.forEach(function(e){a+=this.getHeightOfExpanded(e.cardinal)+r},this);u=n.height-this.getHeightOf(e.itemCount-d.length)-a}s=i.filter(function(e){return!e.expand});if(u>l&&s.length){var f=s[0],p=s.length>1?r:0;if(!f.expand){i.length>1&&(f.height=n.height-this.getHeightOf(s.length-1)-a-p+"px");f.expand=true}}}if(1===e.items.length&&n.height<o-4){e.items[0].responsiveMode=n.height<.5*o?"spark":"small";e.items[0].height=n.height+"px"}},this)},resolveAllModels:function e(t,n,i,o){var s=[];n.forEach(function(e,n){var o=t.columns[n]||{items:[]};e.items.forEach(function(e,t){var n=o.items[t]||{};this.shouldDimensionBeUpdated(e,n)||!n.model?s.push(i(e)):e.model=n.model},this)},this);return o.all(s)},resizeScopeArrays:function e(t,n,i){t.columns.length!==n.length&&this.reSizeArray(t.columns,n.length,i,{items:[]});t.columns.forEach(function(e,o){e.items.length!==n[o].items.length&&this.reSizeArray(t.columns[o].items,n[o].items.length,i,{})},this)},copyDimensionValues:function e(t,n){Object.keys(t).forEach(function(e){n[e]=t[e]})},getResolveModelFunction:function e(t){return function(e){return this.resolveModel(e,t)}.bind(this)},resolveModel:function e(t,n){return n.getObject(t.id).then(function(e){t.model=e;return e.getLayout()})}}})}.apply(t,i),void 0!==o&&(e.exports=o))},1575:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(11),n(106),n(1576),n(100),n(50),n(392),n(290),n(289)],o=function(e,t,n,i,o,s){e.directive("qvCollapsedListbox",function(){return{restrict:"E",replace:true,template:i,scope:{model:"=",outsideIgnoreName:"=",responsiveMode:"=",interactive:"=",readDirection:"="},require:"^?qv-collapsed-listbox-delegated-open",link:function t(i){var s=o.initializeService("object.listBox");var r=function e(){i.backgroundStyle={"background-color":s.getStyle("","backgroundColor")};i.listStyle={color:s.getStyle("title.main","color"),"font-size":s.getStyle("title.main","fontSize")}};r();o.ThemeChanged.bind(r);i.$on("$destroy",function(){o.ThemeChanged.unbind(r)});i.title="";i.hasError=false;i.isLocked=false;i.options={direction:i.readDirection};n(i,"model",function(t){e.$apply(i,function(){var e=t.qListObject.qDimensionInfo;i.hasError=!(!t.qListObject.qError&&!t.qListObject.qDimensionInfo.qError);i.stateCounts=e.qStateCounts;i.isLocked=e.qStateCounts.qLocked>0;i.isDrillDown="H"===e.qGrouping;i.title=t.title;i.id=t.qInfo.qId})})}}});e.directive("qvCollapsedListboxDelegatedOpen",function(){return{restrict:"A",scope:{outsideIgnoreName:"=",interactive:"=?"},controller:["$scope","$element","qvListboxPopoverService","qvListboxPopoverServiceMobile",function(e,n,i,o){var r;e.$on("openPopover",function(e,n){var i=t(n.target).find(".qv-collapsed-listbox");l(i,true)});var l=function l(u,c){var d=u.isolateScope().model,f=u.isolateScope().id,p=u.isolateScope().options.direction,h={qvaOutsideIgnoreFor:e.outsideIgnoreName,$alignToElement:u,position:a(u,n),collision:"flipfit",direction:p};if(!e.interactive)return;if(f===r){s.isSmallDevice?o.close():i.close();r=void 0;return}r=f;var m=s.isSmallDevice?o.show(d,h):i.show(d,h);var v;if(!s.isSmallDevice){m.closing.then(function(e){e&&!t(e.target).closest(".qv-collapsed-listbox").length>0&&(r=void 0);v=e});m.closed.then(function(){m=null;v||(r=void 0);c&&u.closest(".qv-filterpane-collapsed").focus()})}};n.on("qv-activate",".qv-collapsed-listbox:not(.error)",function(e){e.preventDefault();var n=t(e.target).closest(".qv-collapsed-listbox");l(n,false)});function u(e,t){return{left:e.position().left-t.position().left,top:e.position().top-t.position().top,right:t.width()-e.position().left-e.width(),bottom:t.height()-e.position().top-e.height()}}function a(e,t){var n=u(e,t),i;i=Math.max(n.left,n.right)>Math.max(n.top,n.bottom)?n.left>n.right?"left":"right":n.top>n.bottom?"top":"bottom";return i}}]}})}.apply(t,i),void 0!==o&&(e.exports=o))},1576:function(e,t){e.exports='<div class="qv-collapsed-listbox"\n\t ng-class="{locked: isLocked, error: hasError, spark: responsiveMode == \'spark\', small: responsiveMode == \'small\', interactive: interactive}"\n\t ng-style="backgroundStyle"\n\t qva-outside-ignore-for="{{outsideIgnoreName}}"\n\t qva-direction x-dir-setting="{{readDirection}}">\n\t<div class="error-layer"></div>\n\t<div class="title-wrapper" ng-style="listStyle">\n\t\t<span ng-if="isLocked" class="lui-icon lui-icon--lock" qva-direction x-dir-setting="{{readDirection}}"></span>\n\t\t<span ng-if="isDrillDown" class="lui-icon lui-icon--select-alternative" q-title-translation="Tooltip.dimensions.drilldown" x-dir-setting="{{readDirection}}"></span>\n\t\t<span class="title" ng-attr-title="{{title}}" qva-direction x-dir-setting="{{readDirection}}" x-dir-text="{{title}}">{{title}}</span>\n\t</div>\n\t<qv-state-count-bar ng-if="!hasError" state-counts="stateCounts" options="options"></qv-state-count-bar>\n</div>\n'},1577:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(167)],o=function(e,t){e.service("qvFilterPaneKeyboardNavigationService",function(){function e(e,t){var n=e.columns,i=0===n[0].itemCount,o=t?t.colIdx:0,s=t?t.rowIdx:0;e.focus={item:i?n[0].fullscreen:n[o].items[s],isFullscreenBtn:i,focusInListbox:false}}function n(e,t){var n=e.columns,o=n[n.length-1],s=e.focus;if(o.showAll)if(o.fullscreen){o.fullscreen.colIdx=n.length-1;o.fullscreen.rowIdx=o.itemCount}else o.fullscreen={colIdx:n.length-1,rowIdx:o.itemCount,id:"fullscreen"};else o.fullscreen=null;if(s&&!s.focusInListbox&&t){i(e,t);e.hasFocus()&&s.item&&s.item.focus&&s.item.focus()}}function i(e,t){var n=e.focus,i=e.columns;for(var o=0;o<i.length;++o){var s=i[o].items;for(var r=0;r<s.length;++r)if(s[r].id===t){n.item=i[o].items[r];return}}var l=i[i.length-1];if(l.showAll){n.item=l.fullscreen;n.forceFocus=e.hasFocus();n.isFullscreenBtn=true}else{n.item=l.items[l.itemCount-1];n.isFullscreenBtn=false}}function o(e,n){var i=e.focus,o=i.item.rowIdx,s=i.item.colIdx,r=e.columns,l=r.length-1,u=i.isFullscreenBtn?o-1:r[s].itemCount-1,a=!r[l].itemCount,c=r[l].fullscreen;switch(n){case t.ARROW_UP:if(o>0){o-=1;i.isFullscreenBtn=false}else if(0===o&&s>0){s-=1;o=r[s].itemCount-1;i.isFullscreenBtn=false}break;case t.ARROW_DOWN:if(o<u)o+=1;else if(o===u)if(c&&s===l)i.isFullscreenBtn=true;else if(s<l){s+=1;o=0;i.isFullscreenBtn=s===l&&a}break;case t.ARROW_RIGHT:if(s<l){s+=1;o=0;i.isFullscreenBtn=s===l&&a}break;case t.ARROW_LEFT:if(s>0){s-=1;o=0;i.isFullscreenBtn=false}break}i.item=i.isFullscreenBtn?c:r[s].items[o];i.item.focus()}return{init:e,updateFocus:n,setFocusById:i,handleNavigation:o}})}.apply(t,i),void 0!==o&&(e.exports=o))},1578:function(e,t,n){"use strict";var i,o;!(i=[n(48)],o=function(e){var t="qvFocusableFilterpaneItem";e.directive(t,[function(){return{restrict:"A",link:function e(n,i,o){var s=n.$eval(o[t]).type;n.$on("listboxBlur",function(){var e;n.item&&(e={colIdx:n.item.colIdx,rowIdx:n.item.rowIdx});n.setFocus(e)});n.$on("listTab",function(){n.focus.item.blur()});function r(){i[0].setAttribute("tabindex",0);i[0].focus()}function l(){i[0].setAttribute("tabindex",-1)}if("item"===s){n.item.focus=r;n.item.blur=l;n.focus&&(n.focus.shouldResetFocus?n.setFocus({colIdx:0,rowIdx:0}):n.hasFocus()&&n.focus.item.id===n.item.id&&n.focus.item.focus())}else if("fullscreen"===s){n.column.fullscreen||(n.column.fullscreen={});n.column.fullscreen.focus=r;n.column.fullscreen.blur=l;if(n.focus)if(n.focus.shouldResetFocus){n.setFocus({colIdx:0,rowIdx:0});n.focus.shouldResetFocus=true}else if(n.focus.isFullscreenBtn){n.focus.item=n.column.fullscreen;(n.hasFocus()||n.focus.forceFocus)&&n.focus.item.focus()}}}}}])}.apply(t,i),void 0!==o&&(e.exports=o))},167:function(e,t,n){"use strict";var i,o;!(i=[],o=function(){var e={};Object.defineProperties(e,{ENTER:{value:13},ESCAPE:{value:27},SPACE:{value:32},TAB:{value:9},BACKSPACE:{value:8},DELETE:{value:46},ALT:{value:18},CTRL:{value:17},SHIFT:{value:16},ARROW_UP:{value:38},ARROW_DOWN:{value:40},ARROW_LEFT:{value:37},ARROW_RIGHT:{value:39},PAGE_DOWN:{value:34},PAGE_UP:{value:33},HOME:{value:36},END:{value:35},F10:{value:121},A:{value:65},F:{value:70}});e.isArrow=function(t){return t===e.ARROW_UP||t===e.ARROW_DOWN||t===e.ARROW_LEFT||t===e.ARROW_RIGHT};return e}.apply(t,i),void 0!==o&&(e.exports=o))},290:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(90),n(89),n(141),n(283),n(364),n(50),n(365),n(245)],o=function(e,t,n,i,o,s,r,l){e.service("qvListboxPopoverService",["luiPopover",function(e){var u;var a;var c={showDelayed:function i(c,d,f,p){var h=n();if(u){a.selectionsActivated=function(){};a.selectionsDeactivated=function(){};u.close()}a={getVisualization:function e(){return h.promise},onPopoverClose:this.onPopoverClose,options:{setController:h.resolve,isPopover:true,showLock:d.showLock,search:d.search||{},smallDevice:r.isSmallDevice,direction:d.direction},selectionToolbarComponent:o,onClose:s};u=e.show({template:l,controller:s.controller,alignTo:d.$alignToElement[0],input:a,closeOnResize:false,dock:"top"});c.then(function(e){a.model=e}).catch(function(e){false});a.selectionsActivated=function(){t.isFunction(p)&&p()};a.selectionsDeactivated=function(){t.isFunction(f)&&f();f=null;p=null};return u},show:function e(t,i,o,s){return this.showDelayed(n.when(t),i,o,s)},showField:function e(t,o,s,r,l,u){return i.createTransientField(o,t,r).then(function(e){return n.resolve(this.show(e,s,l,u))}.bind(this)).catch(function(e){false})},showDimension:function e(t,n,o,s,r,l){i.createTransientDimension(n,t,s).then(function(e){this.show(e,o,r,l)}.bind(this)).catch(function(e){false})},close:function e(){u&&u.close();u=null},onPopoverClose:function e(){},getPopover:function e(){return u},onClosing:function e(){}};return c}])}.apply(t,i),void 0!==o&&(e.exports=o))},364:function(e,t,n){"use strict";var i,o;!(i=[n(89),n(97)],o=function(e,t){var n={template:null,controller:["$scope","$element","$timeout",function(n,i,o){var s=this;n.input.selectionsActivated=function(){};n.input.selectionsDeactivated=function(){};s.close=function(){r()};function r(){o(function(){n.destroyComponent();i.remove()});t.off("start.listbox-popover-error",r)}function l(){return o(function(){return i.find(".toolbar-wrapper").outerWidth()})}var u=n.input.onPopoverClose;var a=null;n.closingDeferred.promise.then(function(e){a&&a();u(e);r()});e.all({object:n.input.getVisualization(),width:l()}).then(function(e){var i=e.object,o=e.width;i.getSelectionToolbar().then(function(e){n.toolbar=e;n.toolbar.showLock=n.input.options.showLock;n.toolbar.position={width:o};i.activateSelections()});i.loaded.then(function(){i.ext.hasError(i)&&t.on("start.listbox-popover-error",r)});i.selectionsApi.watchActivated(function(){n.input.selectionsActivated()});i.selectionsApi.watchDeactivated(function(){n.input.selectionsDeactivated();r()});a=function e(){i.selectionsApi.confirm()}})}]};return n}.apply(t,i),void 0!==o&&(e.exports=o))},365:function(e,t){e.exports='<lui-popover\n\t\tclass="qv-listbox-popover"\n\t\tstyle="min-width: 200px;width: 234px;height: 332px"\n\t\ton-close-view="closeView(event)"\n\t\tqva-outside-ignore-for="{{input.qvaOutsideIgnoreFor}}"\n\t\tqva-mouse-wheel-outside="close()">\n\t<lui-popover-body style="height: 332px" class="lui-nopad">\n\t\t<qv-spinner show="!input.model" spinner-height="100px" spinner-width="100px" show-Delay="300" center-in-parent="true"></qv-spinner>\n\t\t<div class="toolbar-wrapper"\n\t\t\t qva-include-selection-toolbar\n\t\t\t component="input.selectionToolbarComponent"\n\t\t\t toolbar="toolbar"\n\t\t\t options="input.options"></div>\n\t\t<div class="listbox-wrapper">\n\t\t\t<qv-object object="object" model="input.model" options="input.options"></qv-object>\n\t\t</div>\n\t</lui-popover-body>\n</lui-popover>\n'},392:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(409)],o=function(e,t){e.directive("qvStateCountBar",function(){return{restrict:"E",template:t,replace:true,scope:{stateCounts:"=",options:"="},link:function e(t){t.percents=[];t.$watchCollection("stateCounts",function(){n()});function n(){var e=t.stateCounts,n;if(!e)return;n=o(e);t.percents=s(n)}function i(e){return Object.keys(e).reduce(function(t,n){return t+e[n]},0)}function o(e){var t=i(e),n={};["qSelected","qLocked","qOption","qAlternative"].forEach(function(i){var o=e[i]||0,s=Math.round(o/t*100);o>0&&0===s&&(s=1);n[i]=s});return n}function s(e){var t={},n,i,o=0;for(n in e){t[n]=e[n];(!i||e[n]>e[i])&&(i=n);o+=e[n]}o>100&&(t[i]=e[i]-(o-100));return t}}}})}.apply(t,i),void 0!==o&&(e.exports=o))},409:function(e,t){e.exports='<div class="qv-state-count-bar" tid="stateCount" qva-direction x-dir-setting="{{options.direction}}">\n\t<div class="state selected" ng-style="{\'width\': percents.qSelected + \'%\'}"></div>\n\t<div class="state locked" ng-style="{\'width\': percents.qLocked + \'%\'}"></div>\n\t<div class="state optional" ng-style="{\'width\':  percents.qOption + \'%\'}"></div>\n\t<div class="state alternative" ng-style="{\'width\':  percents.qAlternative + \'%\'}"></div>\n</div>'}}]);