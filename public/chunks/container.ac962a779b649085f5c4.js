/*!
 * sense-client@6.105.4
 * 
 * Copyright(C) 2019 Qlik International AB
 * All Rights Reserved
 * 
 */
(window["qJsonp"]=window["qJsonp"]||[]).push([[36],{1030:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(13),n(1031),n(145)],a=function(t,e,n){t.service("$exportDialog",["luiDialog",function(t){return{show:function i(a,s,o){return t.show({controller:["$scope",function(t){t.states={FAILED:-1,IDLE:0,PENDING:1,COMPLETED:2};t.state=t.states.PENDING;a.getLayout().then(function(n){var i=a.exportData(null,s,n.title||null);t.rpcId=i.requestId;i.then(function(n){t.exportUrl=e.rootPath+n.qUrl.substring(1);t.state=t.states.COMPLETED;n.qWarnings&&1e3===n.qWarnings[0]&&(t.dataIsTruncated=true)},function(e){t.state=t.states.FAILED;t.errorTranslation="ErrorCode."+e.code;e.isHandled=true})});t.openExportWindow=function(){window.open(t.exportUrl)};t.cancel=function(){t.rpcId?a.app.global.cancelRequest(t.rpcId).finally(t.close):t.close()};t.close=function(){t.destroyComponent();o&&o()}}],template:n})}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},1031:function(t,e){t.exports='<lui-dialog id="export-dialog">\n\t<div ng-if="state === states.PENDING">\n\t\t<lui-dialog-header q-translation="Export.Exporting"></lui-dialog-header>\n\t\t<lui-dialog-body class="export-dialog-body">\n\t\t\t<div class="qv-loader pb-10"></div>\n\t\t</lui-dialog-body>\n\t\t<lui-dialog-footer>\n\t\t\t<lui-button ng-click="cancel()" q-translation="Common.Cancel"></lui-button>\n\t\t</lui-dialog-footer>\n\t</div>\n\t<div ng-if="state === states.COMPLETED">\n\t\t<lui-dialog-header q-translation="Export.Completed"></lui-dialog-header>\n\t\t<lui-dialog-body class="export-dialog-body">\n\t\t\t<p class="pb-10">\n\t\t\t\t<span q-translation="Export.CompletedDescription"></span>\n\t\t\t\t<span q-translation="Export.WarningDataTruncated" ng-if="dataIsTruncated"></span>\n\t\t\t</p>\n\t\t\t<p class="pb-10">\n\t\t\t\t<a class="export-url" ng-href="{{exportUrl}}" target="_blank" q-translation="Export.CompletedLink"></a>\n\t\t\t</p>\n\t\t</lui-dialog-body>\n\t\t<lui-dialog-footer>\n\t\t\t<lui-button ng-click="close()" q-translation="Common.Close"></lui-button>\n\t\t</lui-dialog-footer>\n\t</div>\n\t<div ng-if="state === states.FAILED">\n\t\t<lui-dialog-header q-translation="Export.Failed"></lui-dialog-header>\n\t\t<lui-dialog-body class="export-dialog-body">\n\t\t\t<p class="pb-10" q-translation="{{errorTranslation}}"></p>\n\t\t</lui-dialog-body>\n\t\t<lui-dialog-footer>\n\t\t\t<lui-button ng-click="close()" q-translation="Common.Close"></lui-button>\n\t\t</lui-dialog-footer>\n\t</div>\n</lui-dialog>\n'},105:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={Precedents:{PrecedentTypes:{Like:"like",Dislike:"dislike"}},Visualization:{ChartTypes:{Custom:"custom",Kpi:"kpi",Gauge:"gauge",BarChart:"barchart",ValueRange:"ValueRange",Table:"table",Mapping:"Mapping"},CustomVisualizations:{CountFact:"countFact",Ordinal:"Ordinal",NullFacts:"nullFacts",RangeFacts:"rangeFacts",UniValueFrequency:"uniValueFrequency",DTypeFacts:"dTypeFacts",ValueFrequency:"valueFrequency",TemporalFacts:"temporalFacts",MixedTypeValues:"mixedTypeValues"},Actions:{Bucketing:"bucket",Ordinal:"ordinal",SplitValuesDef:"splitValuesDef",SplitValues:"splitValues",SplitEmail:"splitEmail",SplitAddress:"splitAddress",SplitField:"splitField",MapValues:"mapValues",MixedTypeValues:"mixedTypeValues",RenameMapping:"rename",MapNulls:"mapNulls",MappingLimit:99,SplitLimit:9},Size:{Auto:"auto",Small:"small",Medium:"medium",Large:"large"},Layout:{Cellspan:{Small:1,Medium:2,Large:3}},ValueRangeDisplayModes:{Text:"text",RangeLine:"rangeLine"}},Events:{Associations:{ApplyRecommendation:"ApplyRecommendation",ToggleAssociationsRecommendationsPanel:"ToggleAssociationsRecommendationsPanel",UpdateAssociationsRecommendationsToolbarButtonState:"UpdateAssociationsRecommendationsToolbarButtonState"},TablePreview:{UpdateTablePreview:"UpdateTablePreview"},SplitAction:{Reset:"SpitActionReset",Validate:"SpitActionValidate",LoadComplete:"CardLoadComplete"},EditorDetailsPane:{CardsResize:"cardsResize",ResizeChart:"resizeChart",BucketingChange:"bucketingChange",BucketingReset:"bucketingReset",OrderingChange:"orderingChange",FieldCreated:"fieldCreated",MappingCreated:"MappingCreated",MappingReset:"MappingReset",DisableMappingActionButtons:"DisableMappingActionButtons"},PubSub:{ForceReloadComplete:"/datamanager/forcereloadcomplete",StartSpinInvalidation:"/spin/start/invalidation",StopSpinInvalidation:"/spin/stop/invalidation",StartSpin:"/spin/start",StopSpin:"/spin/stop",ConnectionDeleted:"/connection/deleted",ConnectionCreated:"/connection/created",AppDetailsViewChange:"/datamanager/appdetailsviewchange",ExpandSmartSearchSuggestedChart:"expandSmartSearchSuggestedChart",RestoreSearchState:"restoreSearchState"}},KeyCodes:{Enter:13,Esc:27,Up:38,Down:40,Tab:9,SpaceBar:32,Delete:8},AddData:{Folder:"folder",InlineData:"inlinedata"},Tags:{Hidden:"$hidden"},JoinTables:{joinTypes:{join:"Join",innerJoin:"Inner Join",outerJoin:"Outer Join",leftJoin:"Left Join",rightJoin:"Right Join"}},Toolbar:{height:42}};return t}.apply(e,i),void 0!==a&&(t.exports=a))},1145:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){function t(t){var e=t.layout;if(e){var n="auto-chart"===e.visualization?e.qUndoExclude.generated.visualization:e.visualization;return n}return""}return{get:t}}.apply(e,i),void 0!==a&&(t.exports=a))},1160:function(t,e,n){"use strict";var i,a;!(i=[n(173),n(120),n(94),n(122),n(93),n(162),n(89)],a=function(t,e,n,i,a,s,o){var r=";";var l={},c={};var u=false;var d=true;function p(t){try{return decodeURIComponent(t)}catch(e){console.log(e);return t}}function h(t){var e=[];t.forEach(function(t){Number.isNaN(+t)||(t=+t);"number"===typeof t?e.push({qIsNumeric:true,qNumber:t}):"string"===typeof t?e.push({qText:t}):e.push(t)});return e}function g(t){return t.getLayout().then(function(t){if(t.sheetId)return e.get(t.sheetId).then(function(){i.goToSheet(t.sheetId,Object.keys(n.States)[n.state]);return true})})}function f(e,n){return t.apply(e).then(function(){if(n)return t.get(e).then(function(t){return g(t)})})}function v(t){t=t||[];var e=t.reduce(function(t,e){var n=o.resolve(t);return n.then(function(){return e()})},o.resolve());return e}function m(){return l.bookmark||!d?o.resolve():D()}function b(t){return t.reduce(function(t,e){return t.then(e)},o.resolve())}function S(){if(l.clearAllSelections||l.clearStateSelections)return a.getApp().then(function(t){return E().then(function(e){var n=[];l.clearAllSelections?e.forEach(function(e){n.push(t.clearAll(false,e))}):l.clearStateSelections&&l.alternateStates.forEach(function(i){e.indexOf(i)>-1&&n.push(t.clearAll(false,i))});return b(n)})});return o.resolve()}function y(){return l.bookmark?f(l.bookmark,true):o.resolve()}function I(){if(l.selections&&l.selections.length){var t=l.selections.map(function(t){return a.getApp().then(function(e){return E().then(function(n){if(n.indexOf(t.state)>-1)return e.getField(t.field,t.state).then(function(n){var i=[];t.values=h(t.values);i.push(n.selectValues(t.values,false,true));if(t.searches&&t.searches.length>0){var a=[];t.searches.forEach(function(t){a.push(p(t))});i.push(e.selectAssociations({qContext:"CurrentSelections",qSearchFields:[t.field]},a,0))}return o.all(i)})})})});return o.all(t)}return o.resolve()}function x(){return v([m,S,y,I])}function q(t,e){e=p(e);var n=new RegExp("\\/"+t+"\\/([^/]*)?","i");n=e.match(n);if(n&&n.length>0)return n[1];return false}function w(t){return q("bookmark",t)}function C(t){var e=q("options",t);e&&(e=e.split(r));return e}function P(t){var e="---xxx---";var n=[];var i=[];var a=new RegExp("(\\[|%5B)[^\\]]*?(\\]|%5D)","gi");a=t.match(a);if(a){i=a;a.forEach(function(n){t=t.replace(n,e)})}var s=T(t);s&&s.forEach(function(t){var a=t.match(/\/select\/([^/]*)\/[^/]*/);var s="$";if(a[1].indexOf("::")>-1){s=a[1].match(/(.*)::/);s=!!(s&&s.length>0)&&p(s[1]);a=a[1].match(/::(.*)/)}a=!!(a&&a.length>0)&&p(a[1]);var o=t.match(/\/select\/[^/]*\/([^/]*)/);o=!!(o&&o.length>0)&&p(o[1]).split(r);var l=[];if(a&&o){var c=[];o.forEach(function(t){if(t===e){var n=p(i[0]);n=n.substring(1,n.length-1);c.push(n);i=i.splice(1,i.length)}else l.push(p(t))});n.push({field:a,values:l,state:s,searches:c})}});return n}function T(t){var e=new RegExp("(\\/select\\/[^\\/]*\\/[^\\/]*)","g");e=t.match(e);return e}function A(t){return t.getProperties().then(function(t){return t.defaultBookmarkId||null})}function D(){return A(s).then(function(t){return t?f(t,false):null})}function E(){return a.getApp().then(function(t){return t.getLayout().then(function(t){var e=t.qStateNames;e.push("$");return e})})}function k(t){var e=[];t.forEach(function(t){if("clearselections"===t)l.clearAllSelections=true;else if(t.indexOf("::clearselections")>-1){l.clearStateSelections=true;var n=t.match(/(.*)::/);e.push(!!(n&&n.length>0)&&n[1])}else c.option=true});return e}function M(t){var e=P(t);var n=q("options",t);if(n){n=n.split(r);l.alternateStates=k(n)}e&&(l.selections=e);var i=w(t);i&&(l.bookmark=i)}function $(t){t=t||"";if(u)return o.resolve();u=true;M(t);return x()}var O={apply:$,_extract:q,_extractOptions:C,_extractBookmark:w,_extractSelections:P,_extractSelectionsPart:T,_fetchDefaultBookmark:A,_runPromisesInSequence:v,_extractParameters:M,_extractStatesFromOptions:k};Object.defineProperty(O,"shouldApplyDefaultBookmark",{get:function t(){return d},set:function t(e){d=e}});return O}.apply(e,i),void 0!==a&&(t.exports=a))},1178:function(t,e,n){"use strict";var i,a;!(i=[n(10),n(48),n(90),n(95),n(91),n(97),n(167),n(89),n(115),n(94),n(49),n(123),n(156),n(426),n(382),n(50),n(262),n(205),n(499),n(387),n(131),n(128),n(2113),n(2114),n(2115),n(2116),n(2117),n(1749),n(2118),n(2119),n(2120)],a=function(t,e,n,i,a,s,o,r,l,c,u,d,p,h,g,f,v,m,b,S,y,I,x,q,w,C,P,T,A,D,E){var k=t.injector(["ng"]);var M=k.get("$cacheFactory");var $=M("pp-object");var O=200;function F(t){return["container","qlik-show-hide-container","qlik-tabbed-container","qlik-trellis-container"].indexOf(t)>-1}function N(t){return t.children?t.children.filter(function(t){return t.isMaster}).map(function(t){return t.refId}):[]}function L(t,e){var n=t.model.app;var a={id:e.model?e.model.id:t.model.id+"_empty",type:"gridCell",customObject:e,canCopy:function t(){return e.model&&!e.isInvalid},copy:function t(){i.publish("/activeSheet/copyObject",e)},canCut:function t(){return e.model&&!e.isInvalid},cut:function t(){i.publish("/activeSheet/cutObject",e)},paste:function t(){i.publish("/activeSheet/pasteObject",e)},canRemove:function t(){return e},remove:function n(){return h.get().then(function(n){return n.startGroup().then(function(i){B(t.model,e.model.id);n.endGroup(i)})})},getAllPropertyPanelContent:function i(){var a=e.model||t.model;return r.all({appLayout:n.getLayout(),properties:a.getProperties(),layout:a.getLayout()}).then(function(i){var s=l.getType(i.layout.visualization);return s.load().then(function(){return s.getExtensionType().then(function(o){o.mapProperties();o.model||(o.model=a);var r=t.model.layout.children.filter(function(t){return t.refId===e.model.layout.containerChildId||t.refId===e.model.layout.qExtendsId});return{definition:p.mapDefinition(o.definition),globalChangeListeners:void 0,type:i.layout.visualization,ext:o,handler:o.getCreatePropertyHandler.call(o,n),iconName:s.getIconName(),titleRef:"title",headerLabel:r.length>0?r[0].label:"Back",headerAction:function e(){var n=I.getGrid();if(n){var i=n.cells.filter(function(e){return e.id===t.model.id});i.length>0&&n.toggleActive(i[0])}},properties:i.properties,layout:i.layout,localeInfo:i.appLayout.qLocaleInfo,app:n,model:a,cache:$}})})})}};return a}function _(t,n){var i=N(t.layout);t.app.getMasterObjectList().then(function(o){var r=false;var c=l.getRegisteredNames().map(function(t){var e=l.getType(t).getLibraryInfo();return{name:e.translationKey?a.get(e.translationKey):e.name,visualization:t,icon:e.icon?"lui-icon--"+e.icon:void 0,visible:e.visible,isLibraryItem:e.isLibraryItem,isThirdParty:e.isThirdParty,certified:e.certified}}).filter(function(t){var e=t.visible&&t.isLibraryItem&&!F(t.visualization);e&&t.isThirdParty&&(r=true);return e});var u=o.filter(function(t){return!F(t.qData.visualization)&&i.indexOf(t.qInfo.qId)<0}).map(function(t){var e=l.getIconName(t.qData.visualization);return{qExtendsId:t.qInfo.qId,visualization:t.qData.visualization,name:t.qData.name,icon:e?"lui-icon--"+e:void 0}});var d=e.getService("luiPopover").show({template:q,alignTo:n,closeOnEscape:true,input:{items:u.concat(c).sort(function(t,e){return t.name>e.name?1:-1}),hasMasterItems:function t(){return u.length>0},hasExtensions:function t(){return r},select:function e(n,i){i.qExtendsId?z(t,{qExtendsId:i.qExtendsId,visualization:i.visualization},i.name).then(function(){d.close()}):G({id:i.visualization,name:i.name},t).then(function(){d.close()})}}});s.on("start.container",d.close);d.closed.then(function(){s.off(".contaier")})})}function R(t){if(t&&t.length>=O){v.show({title:a.get("Container.MaxChildrenExceeded.Title"),message:a.get("Container.MaxChildrenExceeded.Message")});return false}return true}function j(){return n.generateId()}function z(t,e,n){if(!R(t.layout.children))return;e.qInfo={qType:e.visualization||e.qInfo.qType};e.qExtendsId||(e.containerChildId=j());return h.get().then(function(i){return i.startGroup().then(function(a){return t.createChild(e).then(function(s){return t.getProperties().then(function(o){D.trackAddChart(t.id,e,s.id);o.children.push({refId:e.qExtendsId||e.containerChildId,label:n,isMaster:!!e.qExtendsId});return t.setProperties(o).then(function(){i.endGroup(a);t.items.setNewId(s.id)})})})})})}function G(t,e){return b.createProperties(e.app.enigmaModel,t.id).then(function(n){return z(e,n,t.name)})}function H(t,e,i){if(F(e.visualization))return r.reject();if(!R(t.layout.children))return;if(e.qExtendsId&&N(t.layout).indexOf(e.qExtendsId)>-1)return r.reject();var s=n.extend(true,{},e);s.visualization=s.visualization||s.qInfo.qType;s.qInfo={qType:s.visualization};s.qExtendsId||(s.containerChildId=j());return t.createChild(s).then(function(e){return e.getFullPropertyTree().then(function(n){n.qChildren=i;return e.setFullPropertyTree(n).then(function(){return t.getProperties().then(function(n){var i=s.title;if(!i){var o=l.getType(s.visualization).getLibraryInfo();i=o.translationKey?a.get(o.translationKey):o.name}n.children.push({refId:s.qExtendsId||s.containerChildId,label:i,isMaster:!!s.qExtendsId});return t.setProperties(n).then(function(){t.items.setNewId(e.id);D.trackAddChart(t.id,s,e.id)})})})})})}function B(t,e){return t.getProperties().then(function(n){var i=t.layout.qChildList.qItems.filter(function(t){return t.qInfo.qId===e});var a=i.length>0?i[0].qData.qExtendsId||i[0].qData.containerChildId:"";n.children=n.children.filter(function(t){return t.childId!==e&&t.refId!==a});D.trackRemoveChart(t.id,i[0],e);t.items.scrollTabs(-1);return t.setProperties(n)}).then(function(){return t.destroyChild(e)})}function V(t,e){var n;return t.getChild(e).then(function(t){return t.getProperties()}).then(function(i){n=i;return B(t,e)}).then(function(){if(n.visualization)return n;return t.app.getObject(n.qExtendsId).then(function(t){return t.getProperties().then(function(t){n.visualization=t.visualization;return n})})})}function U(t,e){g.addDrag(e.find(".qsc-item-wrapper"),"",{isEnabled:function e(){var n=t.items.getChild();if(n&&n.preventDrag)return false;return t.items.activeId&&c.isInEditMode()},info:function e(){return{type:"containerItem",item:t.items.activeId,extractObject:function e(){return V(t.object.model,t.items.activeId)}}},elem:"<div class='qv-gridmove-icon'></div>"})}var K=m.extend({init:function t(n,i){var s=e.getService("$timeout"),p=I.getGrid();this.$scope=n;this.$element=i;u.get("SSA_IN_EDIT")||i.closest(".object-wrapper").children(".qv-object-nav").hide();n.object.model.items=new T(this);n.items=n.object.model.items;n.items.init(i[0],n.object.backendApi,n.layout.qInfo.qId);n.cell=new A(n.object,n.items.getChild(),i.find(".qsc-item"),{zoom:function t(e){if(p)if(e){var i=p.cells.filter(function(t){return t.id===n.object.model.id});i.length>0&&p.zoom(i[0])}else p.zoom()},isZoomed:function t(){return p&&!!p.zoomCell},permissions:p&&p.layout?p.layout.permissions:{},remove:function t(){return h.get().then(function(t){return t.startGroup().then(function(e){B(n.object.model,n.cell.model.id);t.endGroup(e)})})},addObject:function t(e){if(e.init.qExtendsId&&N(n.object.model.layout).indexOf(e.init.qExtendsId)>-1)return r.reject();var i=e.init.title;if(!i&&e.init.visualization){var s=l.getType(e.init.visualization).getLibraryInfo();i=s.translationKey?a.get(s.translationKey):s.name}return z(n.object.model,e.init,i||"")},setCellSelected:function t(e){if(u.getFlag("SSA_IN_EDIT")&&y.selectedObject&&!(e&&e.id===y.selectedObject.id)&&y.selectedObject.customObject&&y.selectedObject.customObject.object){y.selectedObject.customObject.object.setInteractionState(d.ANALYSIS);y.selectedObject.customObject.object.update();p&&p.clearActiveCell()}if(e&&!e.isEmpty){if(!y.selectedObject||"gridCell"!==y.selectedObject.type||y.selectedObject.id!==e.id){y.setSelectedObject(L(n.object,e));if(u.getFlag("SSA_IN_EDIT")&&y.selectedObject.customObject.object){y.selectedObject.customObject.object.setInteractionState(d.EDIT);y.selectedObject.customObject.object.update()}y.propertiesOpen=true}}else{y.setSelectedObject();y.resetPropertyPanelToggle()}},isActive:function t(e){return y.selectedObject&&y.selectedObject.id===e}});n.items.onChildChange(function(){s(function(){n.cell.setObject(n.items.getChild(),n.items.getOptions());if(!n.object.model.layout.qExtendsId&&(n.object.model.showPP||y.propertiesOpen)){delete n.object.model.showPP;y.setSelectedObject(L(n.object,n.cell));if(u.getFlag("SSA_IN_EDIT")&&y.selectedObject.customObject.object){y.selectedObject.customObject.object.setInteractionState(d.EDIT);y.selectedObject.customObject.object.update()}y.propertiesOpen=true}})});n.isSmallDevice=f.isSmallDevice;n.showAddObjDialog=function(t){_(n.object.model,t.target)};n.setActiveId=function(t){D.trackSetActive(n.layout.qInfo.qId,n.items);n.items.setActiveId(t,i[0],n.options)};n.getItemClass=function(){return n.cell.showExploreMenu?"rightpanel-open":""};n.getEmptyItemClass=function(){return y.selectedObject&&n.layout.qInfo.qId+"_empty"===y.selectedObject.id?"active":""};n.openTabDropdown=function(t){var i=e.getService("luiPopover").show({template:w,alignTo:t.target,closeOnEscape:true,input:{activeId:n.items.activeId,items:n.items.items,onClick:function t(e){try{n.setActiveId(e.childId)}finally{i.close()}}}})};n.showContextMenu=function(t){E.showContextMenu(t,n.object,n.items.getChild(),n.cell)};n.showRadialContextMenu=function(t){E.showRadialContextMenu(t,n.object,n.items.getChild(),n.cell)};n.focus=function(t){n.layout.showTabs?n.items.focus(i,t):n.cell.focus()};n.object.setOnFocusHandler(n.focus);n.$watchCollection("items.items",function(){n.items.updateActivePosition()});n.keyDown=function(t){if(c.isInEditMode())return;if(n.layout.showTabs&&n.items.hasFocus(i))switch(t.which){case o.ENTER:case o.SPACE:t.stopImmediatePropagation();t.preventDefault();n.cell.focus();break;case o.ARROW_LEFT:t.stopImmediatePropagation();t.preventDefault();n.items.stepFocus(i,-1);break;case o.ARROW_RIGHT:t.stopImmediatePropagation();t.preventDefault();n.items.stepFocus(i,1);break;case o.ESCAPE:n.object.blur();t.preventDefault();t.stopPropagation();break;case o.F10:if(t.shiftKey){var e=i.offset();t.pageY=e.top+50;t.pageX=e.left+10;n.showContextMenu(t)}break}else n.cell.keyDown(t)};u.get("SSA_IN_EDIT")||U(n,i);n.$on("$destroy",function(){n.cell.destroy()})},onPaint:function t(e){var n=this;this.$scope.backendApi.isSnapshot&&(this.$scope.options.viewState={activeId:e.snapshotData.object.activeId});this.$scope.showAdd=c.isInEditMode()&&!this.$scope.object.isReadonly;this.$scope.isSmallDevice=f.isSmallDevice;return this.$scope.items.setLayout(e,this.$scope.options,this.$element[0]).then(function(){D.trackRenderContainer(e,n.$scope.items.activeId)})},onResize:function t(e){var n=I.getGrid();if(n){n.zoomCell||this.$scope.cell.zoom(false);n.zoomCell&&this.$scope.cell.zoom(true)}this.$scope.items.setSize(e,this.$element[0]);this.$scope.isSmallDevice=f.isSmallDevice;this.$scope.showAdd=c.isInEditMode()&&!this.$scope.object.isReadonly;return r.resolve()},update:function t(){},getViewState:function t(){var e=this;return this.$scope.cell.object.getViewState().then(function(t){return{activeId:e.$scope.items.activeId,childViewState:t}})},setSnapshotData:function t(e){var i=this,a=new r,s=e.qChildList.qItems,o=this.$scope.object.model.items.getChild(),l=null;for(var c=0;c<s.length;c++)if(s[c].qInfo.qId===i.$scope.items.activeId){l=s[c];break}if(l){var u=o.model.layout;i.$scope.cell.getVisualization().then(function(t){u.snapshotData={object:{size:t.objectSize},rtl:e.snapshotData.rtl};t.setSnapshotData(u,{});l=n.extend(l,u);e.snapshotData.object.activeId=sessionStorage["cntr-"+e.qInfo.qId+"-active-tab"];a.resolve(e)})}return a.promise}});K.$inject=["$scope","$element"];var W={type:"container",template:x,controller:K,definition:C,initialProperties:{children:[],qChildListDef:{qData:{visualization:"/visualization",containerChildId:"/containerChildId",qExtendsId:"/qExtendsId",title:"/title",showCondition:"/showCondition"}},showTabs:true,showIcons:false,useDropdown:true,useScrollButton:true},support:{cssScaling:false,sharing:false,colorBy:false,snapshot:false,export:true,exportData:false,viewData:false},getCreatePropertyHandler:function t(n){var i=this.model;return new P({app:n,removeChild:function t(e){B(i,e)},addChild:function t(e){_(i,e)},editProps:function t(e){i.showPP=true;i.items.switchTo(e)},editMasterProps:function t(n){var s=i.layout.qChildList.qItems.filter(function(t){return t.qData.qExtendsId===n});var o=s.length>0?s[0].qData.visualization:"";e.getService("qvConfirmDialog").show({message:a.get("Object.Master.EditWarning.Text"),icon:"cogwheel"}).closed.then(function(t){t&&I.editMaster(n,o)})}})},getDropOptions:function t(e,i,a){var s=i.item;if("state"===s.type){var o=this.getDropStateOptions;return e.model.getProperties().then(function(t){var s=e.getCreatePropertyHandler();var r=n.extend(true,{},t);s.setProperties(r);s.setLayout(e.model&&e.model.layout);return o(i,s,e.model,a,e)})}if("visualization"===s.type){var r=N(e.model.layout);!F(s.visualization)&&r.indexOf(s.id)<0&&i.menu.addItem({translation:["Object.Container.DropItem",s.name],tid:"addvisualization",select:function t(){z(e.model,{qExtendsId:s.id,visualization:s.visualization},s.name)}})}else if("template"===s.type)F(s.id)||i.menu.addItem({translation:["Object.Container.DropItem",s.name],tid:"createvisualization",select:function t(){G(s,e.model)}});else{var l=this.model.items.getChild();if(l){if(l.isLink)return S.showNotEditableDialog();return l.getDropOptions(i,a)}}a()},addChild:function t(e,n){return H(this.model,e,n)},canReceive:function t(e){if(this.model.layout.qExtendsId)return false;if(this.model.layout.children.length<1&&e.item&&["field","dimension","measure"].indexOf(e.item.type)>-1)return false;if("libraryitem"===e.type){if(this.model.layout.children.length<1&&["field","dimension","measure"].indexOf(e.item.type)>-1)return false;if("visualization"===e.item.type){if(F(e.item.visualization))return false;return N(this.model.layout).indexOf(e.item.id)<0}if("template"===e.item.type)return!F(e.item.template)}if("gridcell"===e.type){if(F(e.cell.model.layout.visualization))return false;return N(this.model.layout).indexOf(e.cell.model.layout.qExtendsId)<0}return true},exportProperties:null,importProperties:function t(e,i){var a=e.properties,s=n.extend(true,{},i,{qInfo:{qType:"container"},visualization:"container",qStateName:a.qStateName,title:a.title,subtitle:a.subtitle,footnote:a.footnote,showTitles:a.showTitles}),o=[];if(a.conditionalVis){a.conditionalVis.forEach(function(t){var e=t.conditionalMasterObject.split("|");s.children.push({refId:e[1],label:e[0],condition:t.condition,isMaster:true});o.push({qProperty:{qExtendsId:e[1],qInfo:{qType:"containerChild"}},qChildren:[],qEmbeddedSnapshotRef:null})});s.showTabs=false;s.conditionalVis=[]}a.props&&["tab1","tab2","tab3","tab4","tab5"].forEach(function(t){var e=a.props[t];if(e.chart){s.children.push({refId:e.chart,label:e.label,condition:"",isMaster:true});o.push({qProperty:{qExtendsId:e.chart,qInfo:{qType:"containerChild"}},qChildren:[],qEmbeddedSnapshotRef:null})}});return{qProperty:s,qChildren:o,qEmbeddedSnapshotRef:null}}};return W}.apply(e,i),void 0!==a&&(t.exports=a))},1179:function(t,e,n){"use strict";var i,a;!(i=[n(89),n(288),n(141)],a=function(t,e,n){function i(i,r,l){var c,u=i.qSelectionObject?i.qSelectionObject.qSelections:null;var d=[];var p=1e4;if(l&&i.selectionsInStates&&i.selectionsInStates.length>0){var h=[];i.selectionsInStates.forEach(function(t){h=h.concat(t.qSelectionObject.qSelections)});u=h}if(u&&u.length>0){var g=function i(l,c){var u=o(c,p);var d=n.createTransientField(r,l.name,{qStateName:l.stateName}).then(function(n){var i=new e(n);var o=[];for(var r=1;r<=u;r++){var d=a(r,u,c,p);o.push(i.getData(d).then(function(t){return s(t,l)}))}return t.all(o).then(function(t){return t[0]})});return d};for(c=0;c<u.length;c++){var f={name:u[c].qField,values:[],isNumeric:false,stateName:u[c].stateName||"$"};var v=g(f,u[c].qSelectedCount);d.push(v)}}return t.all(d)}function a(t,e,n,i){var a;a=1==e?n:t*i<n?i:n%i;var s=[{qTop:(t-1)*i,qLeft:0,qWidth:1,qHeight:a}];return s}function s(t,e){if(t&&t.length){var n=t[0].qMatrix;var i;for(var a=0;a<n.length;a++){i=n[a][0];var s=!Number.isNaN(+i.qNum);e.values.push(s?i.qNum:i.qText);e.isNumeric=e.isNumeric||s}}return e}function o(t,e){return Math.ceil(t/e)}return{get:i,getRects:a,getFieldSelections:s,getCallCount:o}}.apply(e,i),void 0!==a&&(t.exports=a))},1180:function(t,e,n){"use strict";var i,a;!(i=[n(91),n(432),n(1145)],a=function(t,e,n){function i(n){var i={};var a=o(n);i.dataArea={show:true,title:a.title,hint:a.hint,tooltip:a.tooltip,options:[{label:t.get("Download.Image.DataArea.Default"),isDefault:true},{label:t.get("Common.Custom"),isCustom:true}]};i.scale={show:!e.getUsingReportingService(),title:"Download.Image.Scale",tooltip:"Download.Image.Scale.Tooltip",hint:"Download.Image.Scale.CustomHint",options:[{label:t.get("Download.Image.Scale.Default"),isDefault:true},{label:t.get("Common.Custom"),isCustom:true}]};return i}function a(){var n={};n.paperFormat={show:true,title:"Download.PDF.PaperFormat",aria:"Download.Aria.PDF.PaperFormat",options:r().slice()};n.paperFormat.options.splice(4,1);n.size={show:true,title:"Download.PDF.Scale",aria:"Download.Aria.PDF.Size"};var i=e.getUsingReportingService();n.size.options=i?[{label:t.get("Download.PDF.Scale.FitToPage"),value:3},{label:t.get("Download.PDF.Scale.NoScaling"),value:0}]:[{label:t.get("Print.Layout.CurrentSize"),value:"0"},{label:t.get("Print.Layout.BestFitNoPreserveAspectRatio"),value:"2"}];n.orientation={show:true,title:"Download.PDF.Orientation",options:l()};return n}function s(){var t={};t.output={show:true,title:"Print.ChooseFormat",options:[{type:"pdf",format:"pdf",label:"PDF"},{type:"image",format:"png",label:"PNG"}]};t.pdf=a();return t}function o(t){var e=n.get(t);var i=["barchart","linechart","combochart","boxplot","distributionplot","table","pivot-table"];return i.indexOf(e)>-1?{title:"Download.Image.DataArea",hint:"Download.Image.DataArea.CustomHint",tooltip:"Download.Image.DataArea.Tooltip"}:{title:"Tooltip.Details",hint:"Download.Image.DataArea.CustomHintDetails",tooltip:"Download.Image.DataArea.TooltipDetails"}}function r(){var e="landscape";var n={w:33.1,h:46.8};var i=function t(e,n,i){this.name=e;this.unit=i||"in";this.dimensions=n};i.prototype={toPixels:function t(e){var n,i,a=0;switch(this.unit){case"in":a=e;break;case"pi":a=1;break;case"cm":a=.393701*e;break}n=this.dimensions.w*a;i=this.dimensions.h*a;return{w:Math.round(n),h:Math.round(i)}},toMillimeters:function t(){var e,n,i=0;switch(this.unit){case"in":i=1/.0393701;break;case"cm":i=10;break}e=this.dimensions.w*i;n=this.dimensions.h*i;return{w:Math.floor(e),h:Math.floor(n)}},setLabel:function e(n){var i=this;var a;var s=t.localeDetected&&"en"===t.localeDetected.substring(0,2);var o=s?i.dimensions:i.toMillimeters();var r=o["portrait"===n?"w":"h"],l=o["portrait"===n?"h":"w"];a=s?" ("+r+'" x '+l+'")':" ("+r+" mm x "+l+" mm)";"Letter"===i.name?i.label=t.get("Print.PaperSize.Letter")+a:i.label=i.name+a}};function a(t,e){var n,i;if(t<e){n=t;i=e/2}else{n=t/2;i=e}return{w:n>i?i:n,h:i>n?i:n}}var s=[new i("A0",{w:n.w,h:n.h})];for(var o=1;o<8;o++)s.push(new i("A"+o,a(s[o-1].dimensions.w,s[o-1].dimensions.h)));s.push(new i("Letter",{w:8.5,h:11}));for(var r=0;r<3;r++)s.shift();s.forEach(function(t){t.setLabel(e)});return s}function l(){var e=[{orientation:"portrait",translationKey:"Print.Portrait"},{orientation:"landscape",translationKey:"Print.Landscape"}];e.forEach(function(e){t.ready.then(function(){e.label=t.get(e.translationKey)})});return e}return{getForImage:i,getForPdf:a,getForMobile:s}}.apply(e,i),void 0!==a&&(t.exports=a))},122:function(t,e,n){"use strict";var i,a;!(i=[n(135),n(177),n(90)],a=function(t,e,n){var i={getUrlForHub:function e(){return t.buildHubUrl().replace("/noData/true","")},getUrlForSheet:function i(a,s,o){var r=n.getParameterByName("app");s||(s=e.analysis(r).state);if(o)return t.buildUrl(true,"sense","app",r,"sheet",a,"state",s,"overlay",o);return t.buildUrl(true,"sense","app",r,"sheet",a,"state",s)},getUrlForStory:function i(a,s,o){var r=n.getParameterByName("app");"undefined"===typeof s&&(s=e.story(r).state||"editstory");return o?t.buildUrl(true,"sense","app",r,"story",a,"state",s,"slide",o):t.buildUrl(true,"sense","app",r,"story",a,"state",s)},getUrlForOverview:function e(){var i=n.getParameterByName("app");return t.buildUrl(true,"sense","app",i)},getUrlForDataModelViewer:function e(){var i=n.getParameterByName("app");return t.buildUrl(true,"datamodelviewer","app",i)},getUrlForDataLoadEditor:function e(){var i=n.getParameterByName("app");return t.buildUrl(true,"dataloadeditor","app",i)},getUrlForDataManager:function e(){var i=n.getParameterByName("app");return t.buildUrl(true,"sense","app",i,"datamanager","datamanager")},goToHub:function e(){t.setUrl(i.getUrlForHub(),false,false,true)},goToOverview:function e(){t.setUrl(i.getUrlForOverview())},goToDataManager:function e(){t.setUrl(i.getUrlForDataManager())},goToDataModelViewer:function e(){t.setUrl(i.getUrlForDataModelViewer())},goToDataLoadEditor:function e(){t.setUrl(i.getUrlForDataLoadEditor())},goToSheet:function e(n,a,s){t.setUrl(i.getUrlForSheet(n,a,s))},goToStory:function e(n,a,s){t.setUrl(i.getUrlForStory(n,a,s))}};return i}.apply(e,i),void 0!==a&&(t.exports=a))},1314:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(89),n(94),n(387),n(388),n(95),n(50),n(1535),n(99),n(96),n(1537),n(1316),n(432),n(322),n(1562),n(51),n(1160),n(49),n(131),n(123),n(1030),n(1564),n(111),n(442)],a=function(t,e,n,i,a,s,o,r,l,c,u,d,p,h,g,f,v,m,b,S){var y=false;function I(e){e.currentTarget=t(".qv-gridcell-empty:not(.qv-gridresize-cell):not(.qv-gridcell-disabled)").first();e.target=e.currentTarget.find(".qv-gridcell-content");var n=t(e.currentTarget),i=n.scope(),a=i.cell,s=i.model;B(e,a,s,i.grid)}function x(t,e,n){var i=b.getFlag("SSA_IN_EDIT")?1:0;i=c.treatAsDesktop()?i:++i;t&&e.addItem({translation:"contextMenu.addToMasterItems",tid:"add-to-master-items",icon:"link",select:function t(){a.addObjectInCellToLibrary(n)}},i)}function q(t,s,o,l,c,u){var d=new n,p=i.view===i.Views.masterObject;if(i.isInEditMode()&&!p){l.object.isLink&&t.addItem({translation:"Visualization.Unlink",icon:"link",tid:"link",select:function t(){l.getVisualization().then(function(t){a.showBreakLinkDialog(t.model)})}});a.canAddToMasterItems(l,c).then(function(e){x(e,t,l)}).then(function(){d.resolve()})}else i.isInEditMode()||i.state===i.States.play?d.resolve():s.app.getLayout().then(function(n){w(l)&&n.permissions.createSnapshot&&t.addItem({translation:"contextMenu.takeSnapshot",icon:"camera",tid:"take-snapshot",select:function t(){if(r.isSmallDevice)l.snapshot.take();else{l.snapshot.isAnnotating=true;l.snapshot.take(true,true)}}});w(l)&&t.addItem({translation:"contextMenu.openSnapshotLibrary",tid:"open-snapshot-library",icon:"photo-library",select:function t(){l.snapshot.openLibrary(u,l.options.isZoomed)}});l.object.supportObjectInfo()&&t.addItem({translation:"contextMenu.showDetails",tid:"object-info",icon:"info",select:function t(){r.isSmallDevice?v.show(f,{object:l.object}):e.getService("objectInfoCard").show(l.object)}});d.resolve()});return d.promise}function w(t){return t.object.supportSnapshot()&&!t.object.ext.showRequirements(t.object)&&!t.object.viewDataToggled}function C(t,s,o,r,l,u,d){var p=[],h=i.view===i.Views.masterObject,g=!c.treatAsDesktop();if(h||!i.isInEditMode()||r.object.viewDataToggled)i.isInEditMode()||i.state===i.States.play||r.object.viewDataToggled?r.object.viewDataToggled&&p.push(s.app.getLayout().then(function(e){L(t,r);if(e.permissions.exportData)return N(t,r,true)})):p.push(s.app.getLayout().then(function(n){r.object.supportObjectInfo()&&!g&&t.addItem({translation:"contextMenu.showDetails",tid:"object-info",icon:"info",select:function t(){e.getService("objectInfoCard").show(r.object)}});g||R(t,n,r,d);r.object.canShowExploreMenu()&&!g&&t.addItem({translation:o.zoomCell&&o.zoomCell.showExploreMenu?"contextMenu.closeVisualExploration":"contextMenu.openVisualExploration",tid:"visual-exploration",icon:"control",select:function t(){o.zoomCell||o.zoom(r);r.toggleExploreMenu(!o.zoomCell.showExploreMenu);r.object.resize()}});r.object.supportViewData()&&!r.options.isActive&&L(t,r);E(t,r);F(t,s,r,g);_(t,r);return P(t,r,d,t.items.length,n.permissions.exportData)}));else{l&&u&&!g&&p.push(a.canAddToMasterItems(r,u).then(function(e){x(e,t,r)}));g||A(t,o,r);l&&r.object.isLink&&t.addItem({translation:"Visualization.Unlink",tid:"unlink",icon:"link",select:function t(){r.getVisualization().then(function(t){a.showBreakLinkDialog(t.model)})}});F(t,s,r,g);j(o,t,r,l);b.getFlag("SSA_IN_EDIT")&&p.push(z(t,s,r,d))}return n.all(p)}function P(t,e,n,i,a){if(r.isSmallDevice||!h.getDownloadObjectFlag()&&!h.getDownloadObjectDataFlag())return T(t,e,n,a);k(t,e,i);if(a)return"filterpane"===e.object.type.type?T(t,e,n,a):N(t,e,true,++i);return Promise.resolve()}function T(t,n,i,a){var s=e.getService("qvContextMenu"),o=s.menu();if(!a||n.object&&"container"===n.object.type.type)return Promise.resolve();O(o,n,i);return N(o,n).then(function(){if(o.items.length){var e;var n;for(var i=0;i<t.items.length;i++)if(t.items[i].divider){n=i;break}void 0===n&&(n=t.items.length);e=t.addItem({translation:"contextMenu.exportGroup",tid:"export-group",icon:"export"},n);o.items.forEach(function(t){e.addItem(t)})}})}function A(t,e,n){if(b.getFlag("SSA_IN_EDIT")&&i.isInEditMode()&&!r.isSmallDevice){var a=e.isActive?e.isActive(n.id):e.activeCell&&e.activeCell.id===n.id;t.addItem({translation:a?"Tooltip.StopEdit":"Tooltip.EditObject",icon:a?"tick":"edit",tid:"edit-properties",select:function t(){if(a){e.toggleActive(null);S.resetPropertyPanelToggle()}else e.toggleActive(n)}})}}function D(t,e){b.getFlag("SSA_IN_EDIT")&&i.isInEditMode()&&!r.isSmallDevice&&t.addItem({translation:"contextMenu.editSheetProperties",icon:"edit",tid:"edit-sheet-properties",select:function t(){e&&e.activeCell&&e.toggleActive(null);S.propertiesOpen=true}})}function E(t,e){if(b.getFlag("CLOUD_SHARING_SERVICE")){t.addItem({translation:"contextMenu.share",tid:"share",icon:"share",select:function t(){d.show(e.object)}});return true}return false}function k(t,e,n){var i=h.getDownloadObjectFlag();var a=h.getDownloadObjectDataFlag();var s=e.object&&"container"!==e.object.type.type&&"filterpane"!==e.object.type.type;if((i||a)&&!r.isSmallDevice&&s){if((!i||!e.object.supportExport())&&(!a||!e.object.supportExportData()))return false;t.addItem({translation:"Download.Title",tid:"download",icon:"download",select:function t(){var n=e.object.objectSize&&e.object.objectSize.w?e.object.objectSize.w:"640";var i=e.object.objectSize&&e.object.objectSize.h?e.object.objectSize.h:"480";p.show(e.object,n,i)}},n);return true}return false}function M(t,e){e.object.supportExport()&&!r.isSmallDevice&&t.addItem({translation:"contextMenu.export.chart.image",tid:"print-object-image",select:function t(n){var i=e.object.objectSize&&e.object.objectSize.w?e.object.objectSize.w:"640";var a=e.object.objectSize&&e.object.objectSize.h?e.object.objectSize.h:"480";var s="Image";g.showForObject(e.object,s,"object",i,a,n)}})}function $(t,e){e.object.supportExport()&&!r.isSmallDevice&&t.addItem({translation:"contextMenu.export.chart.pdf",tid:"print-object-pdf",select:function t(n){var i=e.object.objectSize&&e.object.objectSize.w?e.object.objectSize.w:"640";var a=e.object.objectSize&&e.object.objectSize.h?e.object.objectSize.h:"480";var s="Pdf";g.showForObject(e.object,s,"object",i,a,n)}})}function O(t,e,n){M(t,e,n);$(t,e)}function F(t,n,i,a){var s=m._extractOptions(location.pathname);!a&&s&&s.indexOf("developer")>-1&&t.addItem({translation:"Developer",tid:"object-developer",icon:"debug",select:function t(){e.getService("objectDeveloperDialog").show(n,i.object)}})}function N(t,n,i,a){if(!n.object.supportExportData())return Promise.resolve();if("function"===typeof n.object.ext.getExportRawDataOptions)return n.object.ext.getExportRawDataOptions.call(this,t,n);t.addItem({translation:"contextMenu.export",tid:"export",icon:i?"export":null,select:function t(i){e.getService("$exportDialog").show(n.model,void 0,i)}},a);return Promise.resolve()}function L(t,e,n){t.addItem({translation:e.object.viewDataToggled?"contextMenu.viewSource":"contextMenu.viewData",tid:e.object.viewDataToggled?"1f4b8c":"10093a",icon:e.object.viewDataToggled?"back":"table",select:function t(){e.object.toggleDataView()}},n)}function _(t,e,n){b.getFlag("SINGLE_CONFIG")&&!r.isSmallDevice&&t.addItem({translation:"contextMenu.embed",tid:"79f6",icon:"code",suppressOnCloseCall:true,select:function t(n){o.publish("/embed-dialog/open",{type:"object",objectId:e.id,onClose:n})}},n)}function R(t,e,n,i,a){if(w(n)){e.permissions.createSnapshot&&t.addItem({translation:"contextMenu.takeSnapshot",icon:"camera",tid:"take-snapshot",select:function t(){if(r.isSmallDevice)n.snapshot.take();else{n.snapshot.isAnnotating=true;n.snapshot.take(true,true)}}},a);t.addItem({translation:"contextMenu.openSnapshotLibrary",tid:"open-snapshot-library",icon:"photo-library",select:function t(){n.snapshot.openLibrary(i,n.options.isZoomed)}},++a)}}function j(t,e,n,i){if(i&&!n.object.isInvalid){e.addItem({translation:"contextMenu.cut",divider:b.getFlag("SSA_IN_EDIT"),tid:"cut",icon:"cut",select:function t(){o.publish("/activeSheet/cutObject",n)}});e.addItem({translation:"contextMenu.copy",tid:"copy",icon:"copy",select:function t(){o.publish("/activeSheet/copyObject",n)}})}var a=localStorage["QlikView-clipboard"]&&localStorage["QlikView-clipboard"].length>0;a&&e.addItem({translation:t.canInsert||n.object.ext.addChild?"contextMenu.paste":"contextMenu.pasteAndReplace",tid:"paste-and-replace",icon:"paste",select:function t(){o.publish("/activeSheet/pasteObject",n)}});e.addItem({translation:"Common.Delete",tid:"delete",icon:"bin",select:function e(){t.gridService.removeCell(n)}})}function z(t,e,n,i){return e.app.getLayout().then(function(e){var a;for(var s=0;s<t.items.length;s++)if(t.items[s].divider){a=s;break}void 0===a&&(a=t.items.length);R(t,e,n,i,a);a++;n.object.supportViewData()&&!n.options.isActive&&L(t,n,++a);_(t,n,++a);return P(t,n,i,++a,e.permissions.exportData)})}function G(t,n,i,a,s,o){var r=e.getService("qvContextMenu");var l=r.menu();return s&&s.getContextMenu?s.getContextMenu(l,a).then(function(){return C(l,t,n,i,s,o,a).then(function(){return l})}):C(l,t,n,i,s,o,a).then(function(){return l})}function H(t,n,a,r,c,u){function d(e){h.show(p,{position:{x:t,y:n},component:l,onOpen:function t(){e.showingObjectMenu=true},onClosing:function t(){e.closeMenu();e.showingObjectMenu=false}})}var p;var h=e.getService("qvContextMenu");var g=a.target.classList.contains("lui-icon--draggable")||a.target.classList.contains("qv-gridresize-point");!b.getFlag("SSA_IN_EDIT")&&i.isInEditMode()&&u.gridService.activateCell(r);if(g){a.stopPropagation();return}if(r.isEmpty){u.gridService.activateCell(null);p=h.menu();if(i.isInEditMode){var f=localStorage["QlikView-clipboard"]&&localStorage["QlikView-clipboard"].length>0;f&&p.addItem({translation:"contextMenu.paste",tid:"paste",icon:"paste",select:function t(){o.publish("/activeSheet/pasteObject",r)}})}d(r)}else r.getVisualization().then(function(t){s.load().then(function(n){p=e.getService("qvContextMenu").menu();var s=i.view===i.Views.masterObject,o=function t(){if(!r.object.viewDataToggled){A(p,u,r);u.zoomCell?p.addItem({translation:"Tooltip.ZoomOut",icon:"remove",tid:"zoom-out",select:function t(){u.zoom(null);r.object.selectionsApi&&r.object.selectionsApi.active&&r.object.selectionsApi.cancel()}}):p.addItem({translation:"Tooltip.ZoomIn",icon:"expand",tid:"zoom-in",select:function t(){u.zoom(r);r.object.selectionsApi&&r.object.selectionsApi.active&&r.object.selectionsApi.cancel()}});r.object.canShowExploreMenu()&&!i.isInEditMode()&&p.addItem({translation:u.zoomCell&&u.zoomCell.showExploreMenu?"contextMenu.closeVisualExploration":"contextMenu.openVisualExploration",tid:"visual-exploration",icon:"control",select:function t(){u.zoomCell||u.zoom(r);r.object.selectionsApi&&r.object.selectionsApi.active&&r.object.selectionsApi.cancel();r.toggleExploreMenu(!u.zoomCell.showExploreMenu);r.object.resize()}})}q(p,c,u,r,n,a).then(function(){d(r)})};t.getObjectMenu&&!s&&t.getObjectMenu(p).then(function(){i.state!==i.States.play?G(c,u,r,a,t,n).then(function(t){t.items.length&&p.addItem({translation:"contextMenu.title",tid:"more",icon:"more",select:function e(n,i){h.show(t,{position:{x:i.x,y:i.y}})}});o()}):o()})})})}function B(t,a,r,l,c){var u;var d=e.getService("qvContextMenu");!b.getFlag("SSA_IN_EDIT")&&i.isInEditMode()&&l.gridService.activateCell(a);if(a.isEmpty){u=d.menu();D(u,l);var p=localStorage["QlikView-clipboard"]&&localStorage["QlikView-clipboard"].length>0;i.isInEditMode()&&p&&u.addItem({translation:"contextMenu.paste",tid:"paste",icon:"paste",select:function t(){o.publish("/activeSheet/pasteObject",a)}});d.show(u,{position:{x:t.pageX,y:t.pageY}})}else{u=d.menu();var h=e.getService("$timeout");var g=h(function(){return null},500);var f=function t(){return null};var v=n.Promise.race([a.getVisualization().catch(f),g]);var m=n.Promise.race([s.load().catch(f),g]);n.all({obj:v,assets:m}).then(function(e){var n=e.obj;var i=e.assets;G(r,l,a,t,n,i).then(function(e){"keydown"===t.type?d.showInline(e,{position:{x:t.pageX,y:t.pageY},onCloseFn:c},t.currentTarget):d.show(e,{position:{x:t.pageX,y:t.pageY}})})})}}function V(e,n,a,s){var o;if(r.isSmallDevice&&n!==s.zoomCell||i.inStoryPlayState())return;function l(){var i=".objectmenu",a=[];function s(){n.object&&o&&n.object.on();u(document.body).off("*",i)}n.closeMenu=s;function r(e){var n=document.elementFromPoint(e.pagePoints[0].x,e.pagePoints[0].y);if(t(n).hasClass("touch-object-menu-item-label"))return[];return t(n).closest(".qv-objectmenu-item-container")}function l(){if(n.showingObjectMenu){var e=t(".touch-object-menu");e.trigger("touch-release-outside");s();u.preventGestures(this.gestureHandler);window.event&&window.event.preventDefault()}}function c(t,e){if(n.showingObjectMenu){var i=r(e);if(!i[0]){l.call(this,t);return}i.trigger("touch-release",e.pagePoints[0]);s();u.preventGestures(this.gestureHandler);t.preventDefault()}}t(e.target).trigger("qv-swipecancel");u(document.body).swipe({id:i,options:{preventDefault:true},start:function t(e){u.preventGestures(this.gestureHandler);e.preventDefault()},update:function t(e,n){var i=r(n);if(i[0]){if(i[0]!==a[0]){a[0]&&a.trigger("touch-out");i.trigger("touch-in");a=i}}else if(a[0]){a.trigger("touch-out");a=[]}u.preventGestures(this.gestureHandler);e.preventDefault()},end:function t(e,i){a[0]?c.call(this,e,i,n):l.call(this,e,n)},cancel:function t(e){l.call(this,e,n)}})}function c(){n.object&&n.object.isOn().then(function(t){o=t;n.object.off()});H(e.pageX,e.pageY,e,n,a,s);l()}c()}function U(t,e,n,i,a){if(y){y=false;return}c.treatAsDesktop()?B(t,e,n,i,a):V(t,e,n,i)}function K(t,e,n,i){if(!c.treatAsDesktop()){y=true;V(t,e,n,i)}}function W(t,i,a,o){var r=e.getService("$timeout");var l=r(function(){return null},500);var c=function t(){return null};var u=n.Promise.race([a.getVisualization().catch(c),l]);var d=n.Promise.race([s.load().catch(c),l]);return n.all({obj:u,assets:d}).then(function(e){return G(t,i,a,o,e.obj,e.assets)})}return{onHintContextMenu:I,onCellContextMenu:U,onCellRadialContextMenu:K,addDownloadOrExport:P,getObjectMenu:W}}.apply(e,i),void 0!==a&&(t.exports=a))},1315:function(t,e,n){"use strict";var i,a;!(i=[n(89),n(48),n(140),n(132),n(94),n(1179)],a=function(t,e,n,i,a,s){var o=function t(){return n.get().then(function(t){var e=t.layout&&t.layout.qTitle||"";var n=t.id||"";var i={appName:e,appId:n};return i})};var r=function e(r){var l=o();var c=n.get().then(function(t){return i.get().then(function(e){return e.getLayout().then(function(e){return s.get(e,t.enigmaModel)})})});return t.all([l,c]).then(function(e){var n=e[0];var i=e[1];if(!n)return t.reject();var s=a.model&&"sheet"===a.model.genericType?a.model.id:"";var o=r.layout&&r.layout.title?r.layout.title:" ";var l=n.appId.indexOf(".");var c=l>-1?n.appId.substring(0,l):n.appId;var u={appId:c,selections:i,chartId:r.model.id,sheetId:s,chartTitle:o};return{payload:u}})};var l={generateInsights:function t(e){return r(e).then(function(t){return l.postInsights(t.payload)})},postInsights:function n(i,a,s){var o=t();this.cancel();var r=this.getStates();var c="/api/v1/insights";var u=e.getService("$http");var d=e.getService("$interval");a=a||15e3;s=s||3e3;var p=a/s;var h=0;var g=null;var f=function t(){h++;if(h>p){d.cancel(g);o.reject({status:r.TIMEOUT});return}u({url:c,method:"POST",data:i}).then(function t(e){var n=e.data.StaticEndpointURL;var i=e.data.DirectEndpointURL;var a=0;var s={};i&&u({url:i,method:"GET"}).then(function(t){r("direct",t)},function(t){console.log(t)});function r(t,e){a++;switch(t){case"direct":s.directUrl=e.config.url;break}if(a>=1){s.staticUrl=n;d.cancel(g);o.resolve(s)}}},function t(e){if(413==e.status){d.cancel(g);o.reject({status:r.FAILED,data:e.data,httpStatusCode:e.status});return}console.log("No workers available on service - retrying ...")})};f();g=d(f,s);l.poolPromise=g;return o.promise},getInsightDetails:function t(n){var i="/api/v1/insights/"+n+"/details";var a=e.getService("$http");return a.get(i).then(function(t){return t.data})},cancel:function t(){if(this.poolPromise){var n=e.getService("$interval");n.cancel(this.poolPromise);this.poolPromise=null}},getStates:function t(){return{TIMEOUT:-2,FAILED:-1,PENDING:0,COMPLETED:2}}};return l}.apply(e,i),void 0!==a&&(t.exports=a))},1316:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(1543),n(1317),n(1547),n(1548),n(1550),n(1551),n(1554),n(1555),n(91),n(11),n(432),n(103),n(1145),n(1559),n(1560)],a=function(t,e,n,i,a,s,o,r,l,c,u,d,p,h){function g(n,i,a){var s="Download.Title";var o=I();var r=t.getService("luiDialog").show({controller:m,template:e,input:{title:s,object:n,sourceType:"visualization",currentWidth:i,currentHeight:a,currentDpi:o}});r.closed.then(function(){d.cancel()})}function f(n){var i;var a="Download.Title";i=n.model.isCustomSize()?u("#grid"):u(".qvt-sheet > .sheet-grid");var s=Math.round(i.width()||960);var o=Math.round(i.height()||720);var r=I();var l=t.getService("luiDialog").show({controller:m,template:e,input:{title:a,object:n,sourceType:"sheet",currentWidth:s,currentHeight:o,currentDpi:r}});l.closed.then(function(){d.cancel()})}var v;m.$inject=["$scope"];function m(t){v=t;t.states=d.getStates();t.tabS=[];t.getChangedActiveTabAria=r;t.getCurrentlyActiveTabAria=l;t.translate=c.get;t.title=t.input.title;t.selectTab=n;t.tabList=o();var e={sourceType:t.sourceType};"visualization"===t.sourceType&&(e.chartType=h.get(t.object));p.trackEvent(p.customEvents.DOWNLOAD_DIALOG_OPEN,e);t.closingDeferred.promise.then(function(){t.closingDialog=true});function n(e){if(!t.closingDialog){t.activeTab=e;t.tabS[e]&&t.tabS[e].attemptFirstCall&&t.tabS[e].attemptFirstCall()}}t.injectTab=i;function i(e,n){!t.tabList||t.tabList[e].hide||t.tabList[e].disabled?t.tabS[e]={}:t.tabS[e]=n}t.doCall=a;function a(e){var n=t.tabS[e];var i=t.tabList[e].ref;return y(n,i)}function s(){return"sheet"===t.sourceType}function o(){var e=[{ref:"image",index:"0",aria:c.get("Download.Aria.TabCurrentlyOnImage")+" "+c.get("Download.Aria.TabImage"),id:"download-image-tab",tid:"download-image-tab",translationKey:"Download.Image.TabTitle",icon:"image",pendingKey:"Download.Image.Pending"},{ref:"pdf",index:"1",aria:c.get("Download.Aria.TabCurrentlyOnPDF")+" "+c.get("Download.Aria.TabPDF"),id:"download-pdf-tab",tid:"download-pdf-tab",translationKey:"Download.PDF.TabTitle",icon:"file",pendingKey:"Download.PDF.Pending"},{ref:"data",index:"2",aria:c.get("Download.Aria.TabCurrentlyOnData")+" "+c.get("Download.Aria.TabData"),id:"download-data-tab",tid:"download-data-tab",translationKey:"Common.Data",icon:"table",pendingKey:"Download.Data.Pending",disabledTitleKey:"Download.Data.NoData"}];if(s()){e[0].disabled=true;e[2].disabled=true}else{e[0].hide=!d.getDownloadObjectFlag();e[0].disabled=!t.object.supportExport();e[1].hide=!d.getDownloadObjectFlag();e[1].disabled=!t.object.supportExport();e[2].hide=!d.getDownloadObjectDataFlag();e[2].disabled=!t.object.supportExportData()}return e}function r(e){switch(e){case t.tabList[0].ref:return t.translate("Download.Aria.TabChangedToImage");case t.tabList[1].ref:return t.translate("Download.Aria.TabChangedToPDF");case t.tabList[2].ref:return t.translate("Download.Aria.TabChangedToData");default:""}}function l(e){switch(e&&t.tabList){case t.tabList[0].ref:return t.translate("Download.Aria.TabCurrentlyOnImage");case t.tabList[1].ref:return t.translate("Download.Aria.TabCurrentlyOnPDF");case t.tabList[2].ref:return t.translate("Download.Aria.TabCurrentlyOnData");default:return""}}t.downloadFile=u;function u(){var n=t.tabS[t.activeTab].printUrl;var i=t.tabS[t.activeTab].printFileName;var a=t.tabS[t.activeTab].fileType;e.fileType=a;p.trackEvent(p.customEvents.DOWNLOAD_CONFIRMED,e);var s=function e(){t.tabS[t.activeTab].state=t.states.FAILED};d.downloadFile(n,i,a,s)}}var b={pdf:{directive:"qvDownloadPdfTab",template:s,link:o.directiveLinkFunction},image:{directive:"qvDownloadImageTab",template:r,link:l.directiveLinkFunction},data:{directive:"qvDownloadDataTab",template:i,link:a.directiveLinkFunction}};t.directive(b.image.directive,[function(){return S(b.image)}]);t.directive(b.pdf.directive,[function(){return S(b.pdf)}]);t.directive(b.data.directive,[function(){return S(b.data)}]);function S(t){return{restrict:"E",template:t.template,replace:true,scope:{},controller:["$scope","$sce",function(e,n){e.sce=n;e.input=v.input;e.states=v.states;if(e.input.object){var i=e.input.object.model.id;var a={id:i,model:e.input.object.model,options:{id:i,isVisible:true,isOnGrid:false,isZoomed:false}};e.obj=a;e.translate=c.get}e.doCall=v.doCall;e.injectScopeToParent=v.injectTab;t.link(e)}]}}function y(t,e){var i=n.create(t);return i.confirm(e)}function I(){var t=document.createElement("div");t.style.width="1in";var e=document.getElementsByTagName("body")[0];e.appendChild(t);var n=document.defaultView.getComputedStyle(t,null).getPropertyValue("width");e.removeChild(t);var i=n&&Math.round(parseFloat(n));i=i||96;return i>300?300:i}return{show:g,showForGlobalMenu:f}}.apply(e,i),void 0!==a&&(t.exports=a))},1317:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(11),n(432),n(91),n(1145),n(312)],a=function(t,e,n,i,a,s){var o={image:null,pdf:null};function r(i){function a(t){i.statusCode=t?t.httpStatusCode:"";var e=t&&t.status;switch(e){case i.states.CANCELED:case i.states.TIMEOUT:i.state=e;break;default:i.state=i.states.FAILED;break}}function s(){return{width:e("#qv-story-play").is(":visible")?e("#qv-story-play").find(".qv-story-play-slide").first().width():i.input.currentWidth,height:e("#qv-story-play").is(":visible")?e("#qv-story-play").find(".qv-story-play-slide").first().height():i.input.currentHeight,dpi:i.input.currentDpi}}function r(t){if("data"===t&&i.print.hasNoDataToExport){i.state=i.states.NODATA;return false}c(t);return true}function c(e){if(i.obj&&i.input.object){var r,c,u,d,p;var h=i.print.minSize?i.print.minSize:8;i.print.width<h&&(i.print.width=h);i.print.height<h&&(i.print.height=h);i.print.dpi<i.minDpi&&(i.print.dpi=i.minDpi);i.print.dpi>i.maxDpi&&(i.print.dpi=i.maxDpi);var g=s();p={width:Math.round(g.width),height:Math.round(g.height),dpi:g.dpi};var f=i.imageCustomSize?{width:i.print.width,height:i.print.height,dpi:i.print.dpi}:{width:i.input.currentWidth,height:i.input.currentHeight,dpi:i.input.currentDpi};c={width:Math.round(f.width*(i.input.currentDpi/f.dpi)),height:Math.round(f.height*(i.input.currentDpi/f.dpi))};r={};"image"===e&&(r={imageType:i.print.format,captureSize:f});if("pdf"===e){u=i.selectedSize.toMillimeters();d={right:10,left:10,top:10,bottom:10};r={width:u["portrait"===i.selectedLayout.orientation?"w":"h"],height:u["portrait"===i.selectedLayout.orientation?"h":"w"],dpi:i.print.dpi,fitCriteria:i.print.fitCriteria,margin:d,sourceSize:p,size:i.selectedSize,orientation:i.selectedLayout.orientation}}r.timeoutMsec=12e4;r.checkInterval=3e3;i.state=i.states.PENDING;"data"===e&&(r.timeoutMsec=24e4);var v=t.getService("$timeout");switch(e){case"image":v.cancel(o.image);break;case"pdf":v.cancel(o.pdf);break}n.requestDownload(i.input.object,r,e,p,c,i.input.sourceType).then(function(n){i.printUrl=n.qUrl;i.printFileName=l(i.input.object);var a=t.getService("$timeout");var s=a(function(){i.state=i.states.COMPLETED},1e3);switch(e){case"image":o.image=s;break;case"pdf":o.pdf=s}},a)}else i.destroyComponent()}return{confirm:r}}function l(t){var e=50;var n="Qlik Sense";var a=" - ";var s=t.model?t.model.layout.title:"";s.length>e&&(s=s.substring(0,e-3)+"...");return s?n+a+s+u(a):n+a+i.get("Common.Untitled")+d(t,a)+u(a)}function c(){var e=t.getService("$window");var n;n=e.navigator.languages?e.navigator.languages[0]:e.navigator.userLanguage||e.navigator.language;return n}function u(t){var e={year:"numeric",month:"long",day:"numeric"};var n=c();return n?t+(new Date).toLocaleDateString(c(),e):t+(new Date).toLocaleDateString()}function d(t,e){var n=a.get(t);if(n){var o=new s({type:n}).getLibraryInfo().translationKey;var r=i.get(o);return r===o?"":e+r}return""}return{create:r}}.apply(e,i),void 0!==a&&(t.exports=a))},1534:function(t,e,n){"use strict";var i,a;!(i=[n(89),n(90)],a=function(t,e){function n(e,n){return{session:{currentApp:{getLayout:function e(){return t.resolve(this.layout)}}},app:{layout:{qLocaleInfo:n}},state:1,layout:e,getLayout:function n(){return t.resolve(e)},Invalidated:function t(){},layoutSubscribe:function t(n){n(e)}}}function i(t){t.qInfo||(t.qInfo={});t.qInfo.qId||(t.qInfo.qId=e.generateId());t.qInfo.qType||(t.qInfo.qType=t.visualization||"unknown")}return{getMockedModel:n,fixInvalidSnapshotLayout:i}}.apply(e,i),void 0!==a&&(t.exports=a))},1535:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(96),n(486),n(97),n(1536)],a=function(t,e,n,i,a,s){var o="objectMenuListView";function r(t,e,n){t.css({display:"block",left:e-100,top:n-100})}function l(t,e,n){var i={start:3*Math.PI/2,end:-Math.PI/2,range:Math.PI,direction:-1,distance:Math.PI/3.5,radius:n},a={x:t.left+t.width/2,y:t.top+t.height/2},s=window.innerWidth,o=window.innerHeight,r={left:-Math.min(a.x-(e+n),0),right:-Math.min(s-(a.x+e+n),0),top:-Math.min(a.y-(e+n),0),bottom:-Math.min(o-(a.y+e+n),0)},l=i.start,c=i.end,u=function e(n){return n<=0?0:2*Math.acos(1+-n/t.height)};if(r.left){i.direction=1;c=l;l+=Math.PI-u(e);r.top?c+=-u(r.top):r.bottom&&(l+=-u(r.bottom))}else if(r.top){l+=u(r.top);r.right&&(c+=-u(r.top))}else if(r.right){c+=Math.PI+u(e);r.bottom&&(c+=u(r.bottom))}else if(r.bottom){c+=Math.PI;c+=u(r.bottom+2*e);l+=Math.PI-u(r.bottom+e)}i.range=l-c;i.start=l;i.end=c;return i}function c(t,e){t.distance=Math.max(Math.min(t.range/e,Math.PI/3.5),Math.PI/5)}function u(t,e){var a=e._items,s=t[0].getBoundingClientRect(),r=a[0].getBoundingClientRect(),l=t.index(),u=a.children().length,d,p=e._rimInfo,h;c(p,u-(u>8?1:2));d=1===p.direction?p.end+l*p.distance:p.start-l*p.distance;h=i.getCartPos({r:p.radius,a:d},{x:r.width/2,y:r.height/2});t.delay(200).animate({top:h.y-s.height/2,left:h.x-s.width/2},350,"easeOutQuint");n(t[0]).tap({id:o,end:function e(i,a){t.find(".qv-objectmenu-item-container").trigger("touch-release",a.pagePoints[0]);n.preventGestures(this.gestureHandler)}})}function d(t,n,i,a,s,o){t.on("touch-release",r);t.on("touch-in",c);t.on("touch-out",l);function r(t,r){var l=300;n.animate({backgroundColor:"#FF9326",color:"#FFF"},50,"easeInCubic");e.$apply(e.$rootScope,function(){s(a.args);i(function(){a.select(a.args,r);o()},l)});t.stopPropagation()}function l(){if(!a.hover)return;var t,i,s=16;n.stop(true,true);t=n.position();i=parseFloat(n.css("fontSize").split("px")[0]);n.toggleClass("big");n.animate({height:n.outerHeight()-s,width:n.outerWidth()-s,fontSize:i-s/2,left:t.left+s/2,top:t.top+s/2},200,"easeInCubic");e.$apply(e.$rootScope,function(){a.hover=false})}function c(){if(a.hover)return;var t,i,s=16;n.stop(true,true);t=n.position();i=parseFloat(n.css("fontSize").split("px")[0]);n.toggleClass("big");n.animate({height:n.outerHeight()+s,width:n.outerWidth()+s,fontSize:i+s/2,left:t.left-s/2,top:t.top-s/2},200,"easeInCubic");e.$apply(e.$rootScope,function(){a.hover=true})}}var p={template:s,scope:{menu:"=",options:"="},controller:["$scope","$element","$timeout",function(e,i,s){function c(){return i.children().first()}function p(){"function"===typeof e.options.onClosing&&e.options.onClosing.call(null)}e.close=function(){"function"===typeof e.options.onClosing&&e.options.onClosing.call(null);var i=c();n(i).off("*",o);h._rimItems.each(function(t,e){n(e).off("*",o)});h=null;a.off("start",e.close);t(document).off("keydown.touch-context-menu");e.destroyComponent()};a.on("start",e.close);c().on("touch-release-outside",e.close);t(document).on("keydown.touch-context-menu",function(t){27===t.keyCode&&e.close()});var h={};s(function(){var n=c();r(n,e.options.position.x,e.options.position.y);var i=n.find(".touch-object-menu-decor");h._rimInfo=l(n[0].getBoundingClientRect(),25,80);h._rimItems=n.find(".touch-object-menu-item");h._items=n.find(".items");s(function(){h._rimItems.each(function(n,i){u(t(i),h);d(t(i).children(),t(i),s,e.menu.items[n],p,e.close)});i.addClass("big")});"function"===typeof e.options.onOpen&&e.options.onOpen.call(null)})}]};return p}.apply(e,i),void 0!==a&&(t.exports=a))},1536:function(t,e){t.exports='<div class="touch-object-menu" qva-outside="close()">\n\t<div class="touch-object-menu-decor"></div>\n\t<div class="items">\n\t\t<div ng-repeat="item in menu.items" class="touch-object-menu-item" tid="{{item.tid}}">\n\t\t\t<div class="qv-objectmenu-item-container">\n\t\t\t\t<div ng-if="item.hover" class="touch-object-menu-item-wrapper top">\n\t\t\t\t\t<span class="touch-object-menu-item-label top">{{item.getLabel()}}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="lui-icon  lui-icon--{{item.icon}}"/>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n'},1537:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(1315),n(1538),n(1539),n(1540),n(1541),n(1542),n(91),n(49)],a=function(t,e,n,i,a,s,o,r,l){var c;u.$inject=["$scope"];function u(t){c=t;t.translate=r.get;t.getCurrentlyActiveTabAria=a;t.tabList=[{ref:"link"},{ref:"other"}];t.states=e.getStates();t.state=t.states.PENDING;t.enableOther=l.getFlag("CLOUD_SHARING_SERVICE_OTHER");t.enableSnapshot=l.getFlag("CLOUD_SHARING_SERVICE_SNAPSHOT");t.shareUrl="";t.shareUrlList=[];e.generateInsights(t.obj).then(function(e){t.showUrl=true;t.state=t.states.COMPLETED;t.shareUrlList=[e.staticUrl,e.directUrl];i(1)},function(e){t.statusCode=e.httpStatusCode;t.state=e.status});t.modeOptions=[{value:"0",label:r.get("Share.QlikSnapshot"),desc:r.get("Share.QlikSnapshotDesc")},{value:"1",label:r.get("Share.DirectLink"),label2:" ("+r.get("Share.RequiresLogin")+")",desc:r.get("Share.DirectLinkDesc")}];t.currentModeValue=t.enableSnapshot?t.modeOptions[0].value:t.modeOptions[1].value;t.updateLink=i;var n=false;function i(e){if(t.showUrl){var i;if(n)i=e;else{i="0"==e?"1":"0";t.enableSnapshot||(i="1")}n=false;t.shareUrl=t.shareUrlList[i]}else n=0==e}function a(e){switch(e){case t.tabList[0].ref:return t.translate("Share.Aria.TabCurrentlyOnCopyLink");case t.tabList[1].ref:return t.translate("Share.Aria.TabCurrentlyOnOther")}}}var d={link:{directive:"shareLink",template:a,link:i.directiveLinkFunction},other:{directive:"shareOther",template:o,link:s.directiveLinkFunction}};t.directive(d.link.directive,[function(){return p(d.link)}]);t.directive(d.other.directive,[function(){return p(d.other)}]);function p(t){return{restrict:"E",template:t.template,replace:true,scope:{},controller:["$scope",function(e){e.parentScope=c;t.link(e)}]}}function h(i){var a=t.getService("luiDialog").show({controller:u,template:n,input:{obj:i}});a.closed.then(function(){e.cancel()})}return{show:h}}.apply(e,i),void 0!==a&&(t.exports=a))},1538:function(t,e){t.exports='<div>\n\t<lui-dialog id="share-dialog">\n\t\t<lui-tab-view>\n\t\t\t<lui-dialog-header class="sd-header" ng-class="{\'with-tabs\': enableOther}">\n\t\t\t\t<lui-dialog-title class="sd-title" q-translation="contextMenu.share"></lui-dialog-title>\n\t\t\t\t<div class="sd-close" qva-activate="$event.preventDefault(); close()" name="cancel" tid="share-cancel">\n\t\t\t\t\t<i class="lui-icon lui-icon--close lui-icon--small"></i>\n\t\t\t\t</div>\n\t\t\t\t<div ng-show="enableOther" class="sd-tabset-wrap">\n\t\t\t\t\t<lui-tabset class="sd-tabset" active-tab="activeTab">\n\t\t\t\t\t\t<lui-tab ref="{{tabList[0].ref}}" class="sd-tab" tabindex="0" aria-label="{{translate(\'Share.Aria.TabCopyLink\')}}. {{getCurrentlyActiveTabAria(activeTab)}}">\n\t\t\t\t\t\t\t<i class="lui-icon lui-icon--link tab-icon"></i>\n\t\t\t\t\t\t\t<span q-translation="Share.Link.Title"></span>\n\t\t\t\t\t\t</lui-tab>\n\t\t\t\t\t\t<lui-tab ref="{{tabList[1].ref}}" class="sd-tab" tabindex="0" aria-label="{{translate(\'Share.Aria.TabOther\')}}. {{getCurrentlyActiveTabAria(activeTab)}}">\n\t\t\t\t\t\t\t<i class="lui-icon lui-icon--more tab-icon"></i>\n\t\t\t\t\t\t\t<span q-translation="Share.Other.Title"></span>\n\t\t\t\t\t\t</lui-tab>\n\t\t\t\t\t</lui-tabset>\n\t\t\t\t</div>\n\t\t\t</lui-dialog-header>\n\n\t\t\t<lui-dialog-body class="sd-body">\n\t\t\t\t<div ng-show="enableSnapshot" class="modeOptions section" style="padding-top: 0;">\n\t\t\t\t\t<div class="main-label" q-translation="Share.ShareAs"></div>\n\t\t\t\t\t<div class="form-element">\n\t\t\t\t\t\t<lui-radiobutton value="{{modeOptions[0].value}}" x-model="currentModeValue" x-change="updateLink(currentModeValue)" \n\t\t\t\t\t\t\taria-label="{{translate(\'Share.Aria.SharingMode\')}}"\n\t\t\t\t\t\t\t>{{modeOptions[0].label}}</lui-radiobutton>\n\t\t\t\t\t\t<lui-radiobutton value="{{modeOptions[1].value}}" x-model="currentModeValue" x-change="updateLink(currentModeValue)" \n\t\t\t\t\t\t\taria-label="{{translate(\'Share.Aria.SharingMode\')}}">\n\t\t\t\t\t\t\t<span>{{modeOptions[1].label}}<span style="color: rgba(0, 0, 0, 0.4)">{{modeOptions[1].label2}}</span></span>\n\t\t\t\t\t\t</lui-radiobutton>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="section">\n\t\t\t\t\t<span style="font-style: italic; font-size: 12px;">{{modeOptions[currentModeValue].desc}}</span>\n\t\t\t\t</div>\n\t\t\t\t<lui-tab-content ref="{{tabList[0].ref}}"><share-link></share-link></lui-tab-content>\n\t\t\t\t<lui-tab-content ref="{{tabList[1].ref}}"><share-other></share-other></lui-tab-content>\n\t\t\t</lui-dialog-body>\n\t\t</lui-tab-view>\n\n\t</lui-dialog>\n</div>\n'},1539:function(t,e,n){"use strict";var i,a;!(i=[n(393)],a=function(){function t(){}return{directiveLinkFunction:t}}.apply(e,i),void 0!==a&&(t.exports=a))},1540:function(t,e){t.exports='<div>\n\t<div class="section">\n\t\t<div style="font-weight: bold; display: flex;">\n\t\t\t<span style="margin-right: 5px;" q-translation="Common.Link"></span>\n\t\t\t<div ng-if="parentScope.state === parentScope.states.PENDING" class="loading-screen">\n\t\t\t\t\t<div class="spinner">\n\t\t\t\t\t\t<div class="qv-loader"></div>\n\t\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div style="display: flex" ng-if="parentScope.state === parentScope.states.TIMEOUT">{{parentScope.translate(\'Share.Link.Timeout\')}}</div>\n\t\t<div style="display: flex" ng-if="parentScope.statusCode == 413">{{parentScope.translate(\'Download.Error.Selections\')}}</div>\n\t\t<div class="lui-input-group" style="padding-top: 3px;">\n\t\t\t<input class="lui-input-group__item  lui-input-group__input  lui-input" style="width: auto;" ng-model="parentScope.shareUrl" aria-label="{{parentScope.translate(\'Share.Aria.Link.Url\')}}" readonly/>\n\t\t\t<div class="lui-input-group__item  lui-input-group__button">\n\t\t\t\t<button class="lui-button  lui-button--success" qv-click-copy="{{parentScope.shareUrl}}" q-translation="Common.Copy" aria-label="{{parentScope.translate(\'Share.Aria.Link.Copy\')}}"></button>\n\t\t\t</div>\n\t\t\t<a id="emailBtnInline" \n\t\t\t  style="margin-left: 8px;"\n\t\t\t  ng-href="mailto:?subject={{parentScope.translate(\'Share.Link.EmailText\')}}&body={{parentScope.translate(\'Share.Link.EmailBody\') + \' \' + parentScope.shareUrl}}" \n\t\t\t  class="lui-button" \n\t\t\t  q-translation="Share.Link.Email" \n\t\t\t  ng-class="{\'lui-disabled\': parentScope.shareUrl == \'\'}"\n\t\t\t  aria-label="{{parentScope.translate(\'Share.Aria.Link.Email\')}}"></a>\n\t\t</div>\n\t\t<a id="emailBtnSeparateLine" \n\t\t  ng-href="mailto:?subject={{parentScope.translate(\'Share.Link.EmailText\')}}&body={{parentScope.translate(\'Share.Link.EmailBody\') + \' \' + parentScope.shareUrl}}" \n\t\t  class="lui-button" \n\t\t  q-translation="Share.Link.Email" \n\t\t  ng-class="{\'lui-disabled\': parentScope.shareUrl == \'\'}"\n\t\t  aria-label="{{parentScope.translate(\'Share.Aria.Link.Email\')}}"></a>\n\t\t<div style="display: flex; margin: 8px 0 0 0;">\n\t\t\t<a href="{{parentScope.shareUrl}}" class="link" target="_blank" q-translation="Share.Link.Open" aria-label="{{parentScope.translate(\'Share.Aria.Link.Open\')}}"></a>\n\t\t</div>\n\t</div>\n</div>'},1541:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){function t(t){var e=n.p+"assets/images/ShareIcons_";t.socialList=[{value:0,label:"Facebook",src:e+"FB.png",ariaLabel:t.parentScope.translate("Share.Aria.Other.ShareToFacebook")},{value:1,label:"LinkedIn",src:e+"LI.png",ariaLabel:t.parentScope.translate("Share.Aria.Other.ShareToLinkedIn")},{value:2,label:"Twitter",src:e+"TW.png",ariaLabel:t.parentScope.translate("Share.Aria.Other.ShareToTwitter")}];t.shareOnSocial=i;function i(e){var n;switch(e){case 0:n="http://www.facebook.com/sharer.php?u=";break;case 1:n="http://www.linkedin.com/shareArticle?mini=true&url=";break;case 2:n="http://twitter.com/share?url=";break}n+=t.parentScope.shareUrl;window.open(n)}}return{directiveLinkFunction:t}}.apply(e,i),void 0!==a&&(t.exports=a))},1542:function(t,e){t.exports='<div>\n\t<div class="section" q-translation="Share.Other.WhereToShare"></div>\n\t<div class="section" style="display: inline-flex; text-align: center;">\n\t\t<div class="social-media" ng-repeat="item in socialList" ng-click="shareOnSocial(item.value)" tabindex="0" aria-label="{{item.ariaLabel}}">\n\t\t\t<img ng-src="{{item.src}}" />\n\t\t\t<div>{{item.label}}</div>\n\t\t</div>\n\t</div>\n</div>\n'},1543:function(t,e){t.exports='<lui-tab-view id="download-dialog" aria-label="{{translate(\'Download.Aria.Dialog\')}}" class="lui-dialog">\n\t<div class="lui-dialog__header dd-header with-tabs">\n\t\t<div class="lui-dialog__title dd-title" q-translation="{{title}}"></div>\n\t\t<div class="dd-close" ng-click="$event.preventDefault(); close()" name="cancel" tid="download-cancel">\n\t\t\t<i class="lui-icon lui-icon--close lui-icon--small"></i>\n\t\t</div>\n\t\t<input ng-hide="true" ng-model="activeTab" aria-live="{{getChangedActiveTabAria(activeTab)}}" />\n\t\t<div class="dd-tabset-wrap">\n\t\t\t<lui-tabset class="dd-tabset" active-tab="activeTab">\n\t\t\t\t<span ng-repeat="tab in tabList" q-title-translation="{{tab.disabled ? tab.disabledTitleKey : \'\'}}">\n\t\t\t\t\t<lui-tab \n\t\t\t\t\t\tng-if="!tab.hide && !tab.disabled"\n\t\t\t\t\t\ton-tab-selected="selectTab(tab.index)"\n\t\t\t\t\t\tref="{{tab.index}}"\n\t\t\t\t\t\tclass="dd-tab"\n\t\t\t\t\t\ttabindex="0"\n\t\t\t\t\t\taria-label="{{tab.aria}}"\n\t\t\t\t\t\tid="{{tab.id}}"\n\t\t\t\t\t\ttid="{{tab.tid}}">\n\t\t\t\t\t\t<i class="lui-icon lui-icon--{{tab.icon}} tab-icon"></i>\n\t\t\t\t\t\t<span q-translation="{{tab.translationKey}}"></span>\n\t\t\t\t\t</lui-tab>\n\t\t\t\t\t<div\n\t\t\t\t\t\tng-if="!tab.hide && tab.disabled"\n\t\t\t\t\t\tclass="lui-tab dd-tab lui-disabled"\n\t\t\t\t\t\tid="{{tab.id}}-disabled"\n\t\t\t\t\t\ttid="{{tab.tid}}-disabled">\n\t\t\t\t\t\t<i class="lui-icon lui-icon--{{tab.icon}} tab-icon"></i>\n\t\t\t\t\t\t<span q-translation="{{tab.translationKey}}"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</span>\n\t\t\t</lui-tabset>\n\t\t</div>\n\t</div>\n\n\t<div class="lui-dialog__body lui-nopad dd-body">\n\t\t<lui-tab-content ref="{{tabList[0].index}}" tid="{{tabList[0].ref}}" class="download-tab-content"><qv-download-image-tab></qv-download-image-tab></lui-tab-content>\n\t\t<lui-tab-content ref="{{tabList[1].index}}" tid="{{tabList[1].ref}}" class="download-tab-content"><qv-download-pdf-tab></qv-download-pdf-tab></lui-tab-content>\n\t\t<lui-tab-content ref="{{tabList[2].index}}" tid="{{tabList[2].ref}}" class="download-tab-content"><qv-download-data-tab></qv-download-data-tab></lui-tab-content>\n\t</div>\n\n\t<div class="lui-dialog__footer dd-footer">\n\t\t<div ng-hide="tabS[activeTab].state < 0 || !tabS[activeTab].state" class="download-button-wrap">\n\t\t\t<div ng-if="tabS[activeTab].state === states.PENDING" id="pendingText" class="marginRight" q-translation="{{tabList[activeTab].pendingKey}}"></div>\n\t\t\t<div ng-if="tabS[activeTab].state === states.PENDING" id="pendingIcon" class="loading-screen marginRight">\n\t\t\t\t<div class="spinner">\n\t\t\t\t\t<div class="qv-loader"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<lui-button\n\t\t\t\tng-click="downloadFile()" \n\t\t\t\tclass="lui-button lui-button--success dd-button download-button" \n\t\t\t\tng-class="{ \'dd-disabled lui-disabled\': tabS[activeTab].state === states.PENDING || !tabS[activeTab].printUrl || tabS[activeTab].getModifyingCustomSize() }" \n\t\t\t\ttid="download-export"\n\t\t\t\tq-translation="Download.Title" \n\t\t\t\taria-label="{{translate(\'Download.Aria.DownloadButton\')}}">\n\t\t\t</lui-button>\n\t\t</div>\n\t\t<div ng-show="tabS[activeTab].state < 0 || !tabS[activeTab].state" class="download-button-wrap" >\n\t\t\t<div class="lui-text-danger" ng-if="activeTab === \'2\'">\n\t\t\t\t<i class="lui-icon lui-icon--warning lui-icon--large download-warning-icon"></i>\n\t\t\t\t<span ng-show="tabS[activeTab].state === states.FAILED"><span q-translation="Download.Error.Generic_1"></span>.</span>\n\t\t\t\t<span ng-show="tabS[activeTab].state === states.FAILED"><span q-translation="Download.Error.Generic_2"></span>.</span>\n\t\t\t\t<span ng-show="tabS[activeTab].state === states.NODATA"><span q-translation="Download.Data.NoData"></span>.</span>\n\t\t\t</div>\n\t\t\t<lui-button \n\t\t\t\tqva-activate="$event.preventDefault(); tabS[activeTab].printUrl = \'\'; tabS[activeTab].doCallLocal();" \n\t\t\t\tname="confirm" \n\t\t\t\tid="download-try-again" \n\t\t\t\ttid="download-try-again" \n\t\t\t\tclass="lui-button--warning dd-button download-try-again-button" \n\t\t\t\tq-translation="Common.TryAgain" \n\t\t\t\taria-label="{{translate(\'Download.Aria.TryAgainButton\')}}">\n\t\t\t</lui-button>\n\t\t</div>\n\n\t</div>\n</lui-tab-view>\n'},1544:function(t,e,n){"use strict";var i,a;!(i=[n(89),n(48),n(140),n(132),n(91),n(100),n(1179),n(49),n(188),n(308)],a=function(t,e,n,i,a,s,o,r,l,c){var u=function t(){return n.get().then(function(t){var e=t.layout&&t.layout.qTitle||"";var n=t.id||"";var i={appName:e,appId:n};return i})};var d=function t(){return n.get().then(function(t){return i.get().then(function(e){return e.getLayout().then(function(e){return o.get(e,t.enigmaModel)})})})};var p=function t(e){var n=[];if(e&&e.length)for(var i=0;i<e.length;i++)n.push({name:e[i].name,values:e[i].values.map(String),isNumeric:e[i].isNumeric});return n};var h=function t(){var n=e.getService("$window");var i;i=n.navigator.languages?n.navigator.languages[0]:n.navigator.userLanguage||n.navigator.language;return i};var g=function t(){return a.language};function f(e){if(!e.layout||!e.layout.qHasSoftPatches)return t.resolve();return t.all({properties:e.model.getProperties(),effective:e.model.getEffectiveProperties()}).then(function(t){var e=l.generate(t.properties,t.effective);e&&e.length&&(e=e.map(function(t){return{qOp:t.op,qValue:JSON.stringify(t.value),qPath:t.path}}));return e})}var v=function e(n,i,a,o){var l=this;var u=this.getConfig();var d=this.getSelections();var h="visualization"==o?n.getViewState():null;var g=s.getCurrentTheme();var f=this.getAppliedPatches(n);return t.all([u,d,h,f]).then(function(e){var s=e[0];var o=p(e[1]);var u=e[2];var d=e[3]||[];if(!s)return t.reject();var h=[];r.getFlag("VIZ_EXT_BUNDLE")&&h.push("VIZ_EXT_BUNDLE");r.getFlag("VIZBUN_QCS_31")&&h.push("VIZBUN_QCS_31");r.getFlag("VIZBUN_QCS_SMARTPIVOT")&&h.push("VIZBUN_QCS_SMARTPIVOT");r.getFlag("VIZBUN_QCS_TRELLIS")&&h.push("VIZBUN_QCS_TRELLIS");var f;switch(a){case"image":f={appId:s.appId,chartId:n.model.id,filters:o,inWidth:i.captureSize.width,inHeight:i.captureSize.height,outDpi:i.captureSize.dpi,outFormat:i.imageType,timeoutSec:20,patches:d,opts:{language:l.getClientLanguage(),theme:g,viewState:u,forceFlags:h,deviceType:c.deviceType}};break;case"pdf":var v;var b=i.sourceSize.width;var S=i.sourceSize.height;var y=i.dpi;var I={};var x="none";if(3==i.fitCriteria){var q=m(i);v=q[i.size.name];if(v){y=v.dpi;b=v.w;S=v.h;x="fit";I={fit:"landscape"===i.orientation?v.fitL:v.fitP}}}f={type:"sense-composition-1.1",selections:o,senseCompositionTemplate:{appId:s.appId,webCanvas:{zoom:1,widthPx:v?b:1,heightPx:v?S:1},elements:[{position:{leftPx:0,topPx:0,"z-index":-5},visualization:{id:n.model.id,widthPx:b,heightPx:S,patches:d,jsOpts:{language:l.getClientLanguage(),theme:g,viewState:u,forceFlags:h}}}]},outputs:[{outputId:"Qlik_PDF",type:"pdf",pdfOutput:{size:i.size.name,orientation:"portrait"==i.orientation?"P":"L",margins:[],imageRenderingDpi:y,resizeType:x,resizeData:I,align:{horizontal:"center",vertical:"middle"}}}]};break;case"data":f={type:"sense-data-1.0",selections:o,senseDataTemplate:{appId:s.appId,id:n.model.id,patches:d},outputs:[{outputId:"Qlik_Excel",type:"xlsx"}]};break}return{payload:f}})};function m(t){return{A3:{w:t.sourceSize.width,h:t.sourceSize.height,fitL:"42cmx29.7cm",fitP:"29.7cmx42cm",dpi:t.sourceSize.dpi},A4:{w:t.sourceSize.width,h:t.sourceSize.height,fitL:"27.7cmx21cm",fitP:"21cmx27.7cm",dpi:t.sourceSize.dpi},A5:{w:t.sourceSize.width,h:t.sourceSize.height,fitL:"21cmx14.8cm",fitP:"14.8cmx21cm",dpi:t.sourceSize.dpi},A6:{w:t.sourceSize.width,h:t.sourceSize.height,fitL:"14.8cmx10.5cm",fitP:"10.5cmx14.8cm",dpi:t.sourceSize.dpi},Letter:{w:t.sourceSize.width,h:t.sourceSize.height,fitL:"27.94cmx21.59cm",fitP:"21.59cmx27.94cm",dpi:t.sourceSize.dpi}}}var b={allPoolPromises:[],download:function t(e,n,i,a){return this.getObjects(e,n,i,a).then(function(t){return b.enqueueRequest(t.payload,i,n)})},enqueueRequest:function t(e,n,i){switch(n){case"image":return b.enqueueImageRequest(e,n,i.timeoutMsec,i.checkInterval);case"pdf":case"data":return b.enqueueReportRequest(e,n,i.timeoutMsec,i.checkInterval)}},enqueueReportRequest:function n(i,a,s,o){var r="/api/v1/reports";var l=t();var c=this.getStates();var u=s||12e4;var d=o||3e3;var p=u/d;var h=0;var g=e.getService("$http");var f=e.getService("$interval");g({url:r,method:"POST",data:i}).then(function t(e){var n=e.headers(["content-location"]);var i=function t(){h++;if(h>p){b.cancel(a);l.reject({status:c.TIMEOUT});return}g({url:n,method:"GET"}).then(function t(e){if("200"==e.status)switch(e.data.status){case"done":var n=e.data.results[0].location;b.cancel(a);l.resolve({status:c.COMPLETED,qUrl:n});break;case"failed":console.error(e.data);b.cancel(a);l.reject({status:c.FAILED,data:e.data,httpStatusCode:e.status});break}},function t(e){b.cancel(a);l.reject({status:c.FAILED,data:e.data,httpStatusCode:e.status});return})};var s=f(i,d);b.addToPoolPromises(a,s);i()},function t(e){b.cancel(a);l.reject({status:c.FAILED,data:e.data,httpStatusCode:e.status});return});return l.promise},enqueueImageRequest:function n(i,a,s,o){var r="/api/v1/images";var l=t();var c=this.getStates();s=s||12e4;o=o||3e3;var u=s/o;var d=0;var p=e.getService("$http");var h=e.getService("$interval");var g=null;p({url:r,method:"POST",data:i}).then(function t(e){var n=e.headers(["content-location"]);var i=function t(){d++;if(d>u){h.cancel(g);l.reject({status:c.TIMEOUT});return}p({url:n,method:"GET"}).then(function t(e){if("200"==e.status)if(e.data.message){console.error(e.data.message);h.cancel(g);l.reject({status:c.FAILED,data:e.data,httpStatusCode:e.status})}else{var n=e.config.url;h.cancel(g);l.resolve({status:c.COMPLETED,qUrl:n})}},function t(e){h.cancel(g);l.reject({status:c.FAILED,data:e.data,httpStatusCode:e.status})})};g=h(i,o);b.addToPoolPromises(a,g)},function t(e){l.reject({status:c.FAILED,data:e.data,httpStatusCode:e.status})});return l.promise},addToPoolPromises:function t(e,n){this.cancel(e);this.allPoolPromises[e]=n},cancel:function t(n){var i=this.allPoolPromises[n];if(i){var a=e.getService("$interval");a.cancel(i);this.allPoolPromises[n]=null}},cancelAll:function t(){Object.keys(this.allPoolPromises).forEach(function(t){b.cancel(t)})},getStates:function t(){return{NODATA:-4,CANCELED:-3,TIMEOUT:-2,FAILED:-1,IDLE:0,PENDING:1,COMPLETED:2}},getObjects:v,getNavigatorLanguage:h,getClientLanguage:g,getConfig:u,getSelections:d,getAppliedPatches:f};return b}.apply(e,i),void 0!==a&&(t.exports=a))},1545:function(t,e,n){var i,a;var s=s||function(t){"use strict";if("undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))return;var e=t.document,n=function(){return t.URL||t.webkitURL||t},i=e.createElementNS("http://www.w3.org/1999/xhtml","a"),a="download"in i,s=function(t){var e=new MouseEvent("click");t.dispatchEvent(e)},o=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),r=t.webkitRequestFileSystem,l=t.requestFileSystem||r||t.mozRequestFileSystem,c=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},u="application/octet-stream",d=0,p=4e4,h=function(t){var e=function(){"string"===typeof t?n().revokeObjectURL(t):t.remove()};setTimeout(e,p)},g=function(t,e,n){e=[].concat(e);var i=e.length;while(i--){var a=t["on"+e[i]];if("function"===typeof a)try{a.call(t,n||t)}catch(t){c(t)}}},f=function(t){if(/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type))return new Blob(["\ufeff",t],{type:t.type});return t},v=function(e,c,p){p||(e=f(e));var v=this,m=e.type,b=false,S,y,I=function(){g(v,"writestart progress write writeend".split(" "))},x=function(){if(y&&o&&"undefined"!==typeof FileReader){var i=new FileReader;i.onloadend=function(){var t=i.result;y.location.href="data:attachment/file"+t.slice(t.search(/[,;]/));v.readyState=v.DONE;I()};i.readAsDataURL(e);v.readyState=v.INIT;return}!b&&S||(S=n().createObjectURL(e));if(y)y.location.href=S;else{var a=t.open(S,"_blank");void 0===a&&o&&(t.location.href=S)}v.readyState=v.DONE;I();h(S)},q=function(t){return function(){if(v.readyState!==v.DONE)return t.apply(this,arguments)}},w={create:true,exclusive:false},C;v.readyState=v.INIT;c||(c="download");if(a){S=n().createObjectURL(e);setTimeout(function(){i.href=S;i.download=c;s(i);I();h(S);v.readyState=v.DONE});return}if(t.chrome&&m&&m!==u){C=e.slice||e.webkitSlice;e=C.call(e,0,e.size,u);b=true}r&&"download"!==c&&(c+=".download");(m===u||r)&&(y=t);if(!l){x();return}d+=e.size;l(t.TEMPORARY,d,q(function(t){t.root.getDirectory("saved",w,q(function(t){var n=function(){t.getFile(c,w,q(function(t){t.createWriter(q(function(n){n.onwriteend=function(e){y.location.href=t.toURL();v.readyState=v.DONE;g(v,"writeend",e);h(t)};n.onerror=function(){var t=n.error;t.code!==t.ABORT_ERR&&x()};"writestart progress write abort".split(" ").forEach(function(t){n["on"+t]=v["on"+t]});n.write(e);v.abort=function(){n.abort();v.readyState=v.DONE};v.readyState=v.WRITING}),x)}),x)};t.getFile(c,{create:false},q(function(t){t.remove();n()}),q(function(t){t.code===t.NOT_FOUND_ERR?n():x()}))}),x)}),x)},m=v.prototype,b=function(t,e,n){return new v(t,e,n)};if("undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob)return function(t,e,n){n||(t=f(t));return navigator.msSaveOrOpenBlob(t,e||"download")};m.abort=function(){var t=this;t.readyState=t.DONE;g(t,"abort")};m.readyState=m.INIT=0;m.WRITING=1;m.DONE=2;m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null;return b}("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||this.content);true,t.exports?t.exports.saveAs=s:(true,null!==n(1546))&&null!==n(593)&&!(i=[],a=function(){return s}.apply(e,i),void 0!==a&&(t.exports=a))},1546:function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},1547:function(t,e){t.exports='<div id="download-data">\n    <div class="section section-with-bottom">{{translate(\'Download.Data.Message\')}}</div>\n</div>\n'},1548:function(t,e,n){"use strict";var i,a;!(i=[n(1549)],a=function(t){function e(e){e.fileType="xlsx";e.doCallLocal=n;function n(){e.print={};e.print.hasNoDataToExport=t.hasNoDataToExport(e.input.object.layout);e.doCall(2)}var i=false;e.attemptFirstCall=a;function a(){if(!i){n();i=true}}e.injectScopeToParent(2,e)}return{directiveLinkFunction:e}}.apply(e,i),void 0!==a&&(t.exports=a))},1549:function(t,e,n){"use strict";var i,a;!(i=[n(90)],a=function(t){function e(t){var e=function t(e){return e.qcy*e.qcx===0};var i=n(t);var a=i.some(function(t){if(t.qSize&&false===e(t.qSize))return true});return!a}function n(e){var n=["qHyperCube","qUndoExclude.box.qHyperCube","boxplotDef.qHyperCube","qUndoExclude.qHyperCubeDef","qUndoExclude.generated.qHyperCubeDef","qUndoExclude.generated.qHyperCube"];var i=[];n.forEach(function(n){var a=t.getValue(e,n,false);a&&i.push(a)});return i}return{hasNoDataToExport:e}}.apply(e,i),void 0!==a&&(t.exports=a))},155:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(95),n(92),n(89),n(90),n(183),n(396),n(105),n(182)],a=function(t,e,i,a,s,o,r,l,c){var u;var d=i.extend("DataPrepRestService",{init:function t(){},_getAPI:function t(){u||(u=o.getApi("api/dataprepservice/v1","openapi",void 0,void 0,void 0,void 0,c.getServerNodeId()));return u},_handleRestResponse:function t(i,a,s){if(s.body&&s.body.notification&&1005===s.body.notification.data.code){e.publish(l.Events.PubSub.StartSpin,{method:i});return this.executeAfterReload({apiFunc:this[i],initialParams:a}).finally(function(){e.publish(l.Events.PubSub.StopSpin,{method:i})})}s.body.response&&s.body.response.loadModel&&Promise.all([n.e(22),n.e(93)]).then(function(){var t=[n(253)];(function(t){t.updateProperties(s.body.response.loadModel)}).apply(null,t)}).catch(n.oe);return s.body.response},executeAfterReload:function t(e){var n=new a;this.waitForReload(n);return n.promise.then(function(){return e.apiFunc.apply(this,e.initialParams)}.bind(this))},waitForReload:function t(e){this.getProgress().then(function(t){this._checkProgress(t.result)?e.resolve(true):setTimeout(function(){this.waitForReload(e)}.bind(this),1e3)}.bind(this),function(t){e.reject(t)})},_checkProgress:function t(e){var n=false;e.engine&&e.engine.qProgressData&&e.engine.qProgressData.qFinished&&true===e.dps.dataLoad.complete&&true===e.dps.profiling.complete&&(n=true);return n},_getAppName:function t(){return s.getParameterByName("app")},getRestResponseHandler:function t(e,n){return function(){return this[e].bind(this,n)}.bind(this)},getSerializedLoadModel:function t(){var e=this;var n=arguments;return this._getAPI().then(function(t){return t.apis.model.getCurrentLoadModel({appId:e._getAppName()}).then(e._handleRestResponse.bind(e,"getSerializedLoadModel",n))})},_addTables:function t(e){var n=this;var i=arguments;return this._getAPI().then(function(t){return t.apis.table.addTables({appId:n._getAppName(),body:e}).then(n._handleRestResponse.bind(n,"_addTables",i))})},_getDesiredTransforms:function t(){var e=[];e.push("makeGeoPoint");e.push("lookupGeoInfo");return e},isRunning:function t(){return this._getAPI()},getForcedConcatRecommendations:function t(e){var n=this;var i=arguments;return this._getAPI().then(function(t){var a={type:"concatenate",queries:e};return t.apis.table.recommendTableTransformation({appId:n._getAppName(),body:a}).then(n._handleRestResponse.bind(n,"getForcedConcatRecommendations",i))})},getTargetTables:function t(e,n){var i=this;var a=arguments;return this._getAPI().then(function(t){return t.apis.table.getCurrentTables({appId:i._getAppName(),forceReload:e,noData:n}).then(i._handleRestResponse.bind(i,"getTargetTables",a))})},getRecommendations:function t(){var e=this;var n=arguments;return this._getAPI().then(function(t){return t.apis.model.getRecommendations({appId:e._getAppName()}).then(e._handleRestResponse.bind(e,"getRecommendations",n))})},getCurrentClassification:function t(){var e=this;var n=arguments;return this._getAPI().then(function(t){return t.apis.model.getCurrentClassification({appId:e._getAppName()}).then(e._handleRestResponse.bind(e,"getCurrentClassification",n))})},getTableRecommendations:function t(e){var n=this;var i=arguments;return this._getAPI().then(function(t){return t.apis.table.getTableRecommendations({appId:n._getAppName(),tableId:e}).then(n._handleRestResponse.bind(n,"getTableRecommendations",i))})},getTargetTablePreview:function t(e){var n=this;var i=arguments;return this._getAPI().then(function(t){return t.apis.table.getPreviewData({appId:n._getAppName(),tableId:e}).then(n._handleRestResponse.bind(n,"getTargetTablePreview",i))})},getTableFields:function t(e){var n=this;var i=arguments;return this._getAPI().then(function(t){return t.apis.field.getFieldExpressions({appId:n._getAppName(),tableId:e}).then(n._handleRestResponse.bind(n,"getTableFields",i))})},getLoadScript:function t(e){var n=this;var i=arguments;return this._getAPI().then(function(t){return t.apis.model.getCurrentScript({appId:n._getAppName(),useCache:e}).then(n._handleRestResponse.bind(n,"getLoadScript",i))})},invokeWithPolling:function t(n,i,a){i&&e.publish(l.Events.PubSub.StartSpin,{method:a});var s=true;var o=void 0;o=setInterval(function(){s&&this.getProgress().then(function(){})}.bind(this),15e3);var r=function t(){s=false;void 0!==o&&clearInterval(o);o=void 0};return n().then(function(t){r();i&&e.publish(l.Events.PubSub.StopSpin,{method:a});return t},function(t){r();i&&e.publish(l.Events.PubSub.StopSpin);throw t})},invokeWithGlobalSpinnerSupport:function t(n){e.publish(l.Events.PubSub.StartSpinInvalidation);return n().catch(function(){e.publish(l.Events.PubSub.StopSpinInvalidation)})},createConcatenatedQuery:function t(e,n,i){var a=this;var s=arguments;return this.invokeWithGlobalSpinnerSupport(function(){return a._getAPI().then(function(t){var o={type:"forceConcatenate",payload:{name:e,queries:n,mappings:i}};return t.apis.table.applyTransformation({appId:a._getAppName(),body:o}).then(a._handleRestResponse.bind(a,"createConcatenatedQuery",s))})})},createJoinedQuery:function t(e,n,i,a){var s=this;var o=arguments;return this.invokeWithGlobalSpinnerSupport(function(){return s._getAPI().then(function(t){var r={type:"join",payload:{name:e,joinType:n,queries:i,mappings:a}};return t.apis.table.applyTransformation({appId:s._getAppName(),body:r}).then(s._handleRestResponse.bind(s,"createJoinedQuery",o))})})},splitQuery:function t(e,n){var i=this;var a=arguments;return this.invokeWithGlobalSpinnerSupport(function(){return i._getAPI().then(function(t){var s={type:"split",payload:{queries:[e],queryProperties:[{sourceQueries:n}]}};return t.apis.table.applyTransformation({appId:i._getAppName(),body:s}).then(i._handleRestResponse.bind(i,"splitQuery",a))})})},synchronizeScriptedTables:function t(){return this.invokeWithPolling(function(){return this.addTables([],true).then(function(t){return t})}.bind(this),true,"synchronize")},getProgress:function t(){var e=this;var n=arguments;return this._getAPI().then(function(t){var i={appId:e._getAppName()};return t.apis.session.getProgress(i).then(e._handleRestResponse.bind(e,"getProgress",n))})},addTables:function e(n,i){var a={data:[],applyTransformations:this._getDesiredTransforms(),defaults:{},scriptedSources:i};for(var s=0;s<n.length;s++){var o=n[s];var l={tables:[]};l.connectionInfo=t.extend(true,{},o.connectionInfo,{dbInfo:o.dbInfo});a.data.push(l);var c=l.tables;o.tablesAndFields.map(function(t){var e={databaseName:o.databaseName,ownerName:o.ownerName,tableName:t.table.qName,formatSpec:t.table.qFormatSpec,fileFormatSettings:t.table.fileFormatSettings};e.fields=[];t.fields.forEach(function(t){e.fields.push({name:t.qName,selected:true})});c.push(e)})}var u=new r;return u.get().then(function(t){a.defaults.enableQVDCaching=t.enableQVDCaching;return this._addTables(a)}.bind(this))},getVisRecommendations:function t(e,n,i,a,s){var o=this;var r=arguments;return this._getAPI().then(function(t){var l={appId:o._getAppName()};if(e){var c=["fields","libItems","expressions"];c.forEach(function(t){e[t]&&e[t].length&&(l[t]=JSON.stringify(e[t]))});e["table"]&&(l["table"]=e["table"])}i&&(l.bundleOverride=JSON.stringify(i));a&&(l.detailLevel=JSON.stringify([]));s&&(l.options=JSON.stringify(s));var u=t.apis.visualization;var d=n?u.getVisualizationsForLoaded(l):u.getVisualizationsForCurrent(l);return d.then(o._handleRestResponse.bind(o,"getVisRecommendations",r))})},getInsightRecommendations:function t(e,n,i,a,s){var o=this;var r=arguments;i||(i=true);return this._getAPI().then(function(t){var l={appId:o._getAppName()};e&&(l["sp"]=e);n&&(l.bundleOverride=JSON.stringify(n));a&&(l.detailLevel=JSON.stringify([]));s&&(l.options=JSON.stringify(s));var c=t.apis.visualization;var u=i?c.getVisualizationsForLoaded(l):c.getVisualizationsForCurrent(l);return u.then(o._handleRestResponse.bind(o,"getVisRecommendations",r))})},bucketField:function t(e,n,i){var a=this;var s=arguments;return this._getAPI().then(function(t){var o={type:"bucket",bucketing:i};o.bucketing.fieldId=n;var r={appId:a._getAppName(),tableId:e,body:o};return t.apis.table.applyTableTransformation(r).then(a._handleRestResponse.bind(a,"bucketField",s))})},applyOrdinal:function t(e,n,i){var a=this;var s=arguments;return this._getAPI().then(function(t){var o={type:"ordinal",ordinals:i};var r={appId:a._getAppName(),tableId:e,fieldId:n,body:o};return t.apis.field.addFieldTransformation(r).then(a._handleRestResponse.bind(a,"applyOrdinal",s))})},applyFieldMapping:function t(e,n,i){var a=this;var s=arguments;return this._getAPI().then(function(t){var o={type:"mapping",mappings:i};var r={appId:a._getAppName(),tableId:e,fieldId:n,body:o};return t.apis.field.addFieldTransformation(r).then(a._handleRestResponse.bind(a,"applyFieldMapping",s))})},splitField:function t(e,n,i){var a=this;var s=arguments;return this._getAPI().then(function(t){var o={type:"splitField",splitDef:{fieldId:n,splitInfo:i}};var r={appId:a._getAppName(),tableId:e,body:o};return t.apis.table.applyTableTransformation(r).then(a._handleRestResponse.bind(a,"splitField",s))})},adaptVisualization:function t(e,n,i,a,s,o){var r=this;var l=arguments;return this._getAPI().then(function(t){var c={action:e,datasetName:n,analysisType:a,dims:s,msrs:o,visType:i};return t.apis.visualization.createVisRecommendationForCurrent({appId:r._getAppName(),body:c}).then(r._handleRestResponse.bind(r,"adaptVisualization",l))})},adaptMatchRecord:function t(e,n,i){var a=this;var s=arguments;return this._getAPI().then(function(t){var o={action:e,matchRecord:n,analysisType:i,detailLevel:[]};return t.apis.visualization.createVisRecommendationForLoaded({appId:a._getAppName(),body:o}).then(a._handleRestResponse.bind(a,"adaptVisualization",s))})},getExcludedCompareVisualizations:function t(e,n,i){var a=this;var s=arguments;return this._getAPI().then(function(t){var o={appId:a._getAppName(),detailLevel:"complete",analysisTypes:JSON.stringify(["excludedCompare","excludedCompareMsrSelector"]),bundleOverride:JSON.stringify({explore:"grayInsight"})};if(e.length>0)if(i){var r=[];e.forEach(function(t){r.push({libId:t})});o["libItems"]=JSON.stringify(r)}else{var l=[];e.forEach(function(t){l.push({name:t,overrides:{classifications:["measure"],defaultAggregation:"sum"}})});o["fields"]=JSON.stringify(l)}n&&(o.options=JSON.stringify(n));return t.apis.visualization.getVisualizationsForLoaded(o).then(a._handleRestResponse.bind(a,"getVisRecommendations",s))})},adaptAggregationForExcludedCompareVisualization:function t(e){var n=this;var i=arguments;return this._getAPI().then(function(t){var a={action:"update",analysisType:"excludedCompare",matchRecord:e};return t.apis.visualization.createVisRecommendationForLoaded({appId:n._getAppName(),body:a}).then(n._handleRestResponse.bind(n,"adaptVisualization",i))})}});return d}.apply(e,i),void 0!==a&&(t.exports=a))},1550:function(t,e){t.exports='<div id="download-pdf">\n\t<div class="preview-section preview-section-pdf">\n\t\t<dd-pdf-preview states="states" state="state" preview-disabled="optionChanged && state === states.PENDING" current-orientation-index="currentOrientationIndex" status-code="statusCode" preview-url="embedUrl"></dd-pdf-preview>\n\t</div>\n\n\t<div class="section form-element" ng-show="paperFormat.show">\n\t\t<div class="form-label" q-translation="{{paperFormat.title}}"></div>\n\t\t<div class="form-input" aria-label="{{translate(paperFormat.aria)}}">\n\t\t\t<lui-select\n\t\t\t\ttid="download-pdf-paper-format"\n\t\t\t\tx-change="onFormChange()"\n\t\t\t\tx-model="selectedPaperFormat"\n\t\t\t\tx-options="paperFormatOpt.label for paperFormatOpt in paperFormat.options">\n\t\t\t</lui-select>\n\t\t</div>\n\t</div>\n\n\t<div class="section form-element form-rbtns" ng-show="orientation.show">\n\t\t<lui-radiobutton tid="download-pdf-landscape" id="download-pdf-landscape" value=1 x-model="currentOrientationIndex"><span q-translation="{{orientation.options[1].translationKey}}"></span></lui-radiobutton>\n\t\t<lui-radiobutton tid="download-pdf-portrait" id="download-pdf-portrait" value=0 x-model="currentOrientationIndex"><span q-translation="{{orientation.options[0].translationKey}}"></span></lui-radiobutton>\n\t</div>\n\n\t<div class="section section-with-bottom form-element" ng-show="size.show">\n\t\t<div class="form-label" q-translation="{{size.title}}"></div>\n\t\t<div class="form-input" aria-label="{{translate(size.aria)}}">\n\t\t\t<lui-select\n\t\t\t\ttid="download-pdf-size"\n\t\t\t\tx-change="onFormChange()"\n\t\t\t\tx-model="selectedFitCriteria"\n\t\t\t\tx-options="sizeOpt.label for sizeOpt in size.options">\n\t\t\t</lui-select>\n\t\t</div>\n\t</div>\n</div>\n'},1551:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(1180),n(432),n(1552)],a=function(t,e,n){function i(i){i.fileType="pdf";i.doCallLocal=u;i.onFormChange=c;i.onOrientationChange=l;i.embedUrl="";var a="";i.$watch("printUrl",s);function s(e){if(e&&e!=a){a=e;var s=t.getService("$timeout");n.getPdfEmbedUrl(a).then(function(t){s(function(){i.embedUrl=i.sce.trustAsResourceUrl(t+"#zoom=42")})},function(){i.embedUrl=""})}}var o=e.getForPdf();i.paperFormat=o.paperFormat;i.selectedPaperFormat=i.paperFormat.options[1];i.size=o.size;i.selectedFitCriteria=i.size.options[0];i.orientation=o.orientation;i.currentOrientationIndex="1";var r=true;i.$watch("currentOrientationIndex",l);function l(t){d(t);r?r=false:c()}function c(){i.printUrl="";i.embedUrl="";i.optionChanged=true;u()}function u(){i.print={};i.print.dpi=200;i.minDpi=72;i.maxDpi=300;i.selectedSize=i.selectedPaperFormat;i.selectedLayout=i.orientation.options[i.currentOrientationIndex];i.print.fitCriteria=i.selectedFitCriteria.value;i.doCall(1)}function d(t){var e=i.orientation.options[t];if(!e||!e.orientation)return;i.paperFormat.options.forEach(function(t){t.setLabel(e.orientation)})}var p=false;i.attemptFirstCall=h;function h(){if(!p){u();p=true}}i.injectScopeToParent(1,i)}return{directiveLinkFunction:i}}.apply(e,i),void 0!==a&&(t.exports=a))},1552:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(1553)],a=function(t,e){t.directive("ddPdfPreview",function(){return{restrict:"E",template:e,replace:true,scope:{state:"=",states:"=",previewDisabled:"=",currentOrientationIndex:"=",statusCode:"=",previewUrl:"="},link:function t(e,n){e.showPreviewNotAvailable=i;function i(){if(!e.previewUrl)return true;try{var t=n[0].querySelector("iframe.preview-pdf").contentWindow.document.getElementsByTagName("body");return!!t.length&&!t[0].children.length}catch(t){return false}}}}})}.apply(e,i),void 0!==a&&(t.exports=a))},1553:function(t,e){t.exports='<div class="dd-preview dd-preview-pdf">\n    <div class="preview" ng-class="{\'dd-opacity-0 dd-hidden\': !(state && state === states.COMPLETED) }">\n        <div class="preview-content preview-content-pdf">\n            <div class="preview-embed-wrap-pdf" ng-class="{\'dd-opacity-0\': showPreviewNotAvailable()}">\n                <iframe \n                    width="100%"\n                    height="99%"\n                    tabindex="-1" \n                    class="preview-pdf" \n                    ng-class="{ \'preview-pdf-l\': currentOrientationIndex == 1, \'preview-pdf-p\': currentOrientationIndex == 0, \'preview-disabled\': previewDisabled }"\n                    ng-hide="!previewUrl"\n                    ng-src="{{previewUrl}}"\n                    tid="download-preview" \n                    type="application/pdf">\n                </iframe>\n            </div>\n        </div>\n        <div ng-show="showPreviewNotAvailable()" tid="unavailable-status" id="unavailable-status" class="status-wrap">\n            <div class="lui-icon lui-icon--warning status-icon"></div>\n            <div class="status-text">\n                <div class="st-header" q-translation="Download.PreviewNotAvailable"></div>\n            </div>\n        </div>\n    </div>\n    <div ng-if="state === states.FAILED || !state" tid="failed-status" id="failed-status" class="status-wrap">\n        <div class="lui-icon lui-icon--warning status-icon"></div>\n        <div class="status-text">\n            <div class="st-header" q-translation="Download.Error.Generic_1"></div>\n            <div ng-switch="statusCode">\n                <div ng-switch-when="413" q-translation="Download.Error.Selections"></div>\n                <div ng-switch-default q-translation="Download.Error.Generic_2"></div>\n            </div>\n        </div>\n    </div>\n    <div ng-if="state === states.TIMEOUT" tid="timeout-status" id="timeout-status" class="status-wrap">\n        <div class="lui-icon lui-icon--idle status-icon"></div>\n        <div class="status-text">\n            <div q-translation="Download.PDF.Timeout" class="st-header"></div>\n            <div q-translation="Download.Error.Generic_2"></div>\n        </div>\n    </div>\n    <div ng-if="state === states.PENDING" tid="pending-status" id="pending-status" class="status-wrap"> \n        <div class="status-spinner">\n            <div class="spinner">\n                <div class="qv-loader white"></div>\n            </div>\n        </div>\n        <div class="status-text">\n            <div q-translation="Download.PendingPreview" class="st-header"></div>\n        </div>\n    </div>\n</div>\n'},1554:function(t,e){t.exports='<div id="download-image">\n\t<div class="preview-section preview-section-image">\n\t\t<dd-image-preview state="state" states="states" preview-url="printUrl" disable-preview="getModifyingCustomSize()" top-text="getSummaryText(1)" bottom-text="getSummaryText(0)"></dd-image-preview>\n\t</div>\n\t\x3c!-- Data Area select --\x3e\n\t<div class="section" ng-class="{\'section-with-bottom\': !scale.show}" ng-if="dataArea.show">\n\t\t<div class="sub-section form-element">\n\t\t\t<div class="form-label" q-translation="{{dataArea.title}}" q-title-translation="{{dataArea.tooltip}}"></div>\n\t\t\t<div class="form-input" aria-label="{{translate(dataArea.title)}}">\n\t\t\t\t<lui-select\n\t\t\t\t\tid="download-image-data-area"\n\t\t\t\t\ttid="download-image-data-area"\n\t\t\t\t\tx-model="selectedDataArea"\n\t\t\t\t\tx-change="onDataAreaChange()"\n\t\t\t\t\tx-options="dataAreaOpt.label for dataAreaOpt in dataArea.options">\n\t\t\t\t</lui-select>\n\t\t\t</div>\n\t\t</div>\n\t\t\x3c!-- Data Area width/ height inputs --\x3e\n\t\t<div ng-show="selectedDataArea.isCustom" class="download-customSize" id="download-custom-data-area" tid="download-custom-data-area">\n\t\t\t<div class="download-customSize-form dcf-with-top-bottom">\n\t\t\t\t<div class="form-content">\n\t\t\t\t\t<div class="form-label" q-translation="Common.Width"></div>\n\t\t\t\t\t   <dd-input \n\t\t\t\t\t\t\t  ng-class="{\'lui-invalid\': width.percError}"\n\t\t\t\t\t\t\t  on-blur="changeCustomSize(1)" \n\t\t\t\t\t\t\t  model="width.percentageValue" \n\t\t\t\t\t\t\t  on-change="width.onDynamicPercentageChange()"\n\t\t\t\t\t\t\t  on-enter="changeCustomSize(1)"\n\t\t\t\t\t\t\t  tid="download-custom-width-percentage" id="download-custom-width-percentage" \n\t\t\t\t\t\t\t  aria-label="{{translate(\'Download.Aria.Image.CustomSizeWidth\')}}. {{translate(\'Download.Aria.Image.CustomSizeGeneral\')}}">\n\t\t\t\t\t\t</dd-input>\n\t\t\t\t\t<div class="download-customSize-unit">%</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\x3c!-- Data Area - Height --\x3e\n\t\t\t<div class="download-customSize-form">\n\t\t\t\t<div class="form-content">\n\t\t\t\t\t<div class="form-label" q-translation="Common.Height"></div>\n\t\t\t\t\t\t<dd-input \n\t\t\t\t\t\t\tng-class="{\'lui-invalid\': height.percError}"\n\t\t\t\t\t\t\ton-blur="changeCustomSize(2)" \n\t\t\t\t\t\t\tmodel="height.percentageValue" \n\t\t\t\t\t\t\ton-change="height.onDynamicPercentageChange()"\n\t\t\t\t\t\t\ton-enter="changeCustomSize(2)"\n\t\t\t\t\t\t\ttid="download-custom-height-percentage" id="download-custom-height-percentage" \n\t\t\t\t\t\t\taria-label="{{translate(\'Download.Aria.Image.CustomSizeHeight\')}}. {{translate(\'Download.Aria.Image.CustomSizeGeneral\')}}">\n\t\t\t\t\t\t</dd-input>\n\t\t\t\t\t\t<div class="download-customSize-unit">%</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="download-customSize-hint" ng-show="selectedDataArea.isCustom">\n\t\t\t\t<span q-translation="{{dataArea.hint}}"></span>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t\x3c!-- Scale select --\x3e\n\t<div class="section section-with-bottom" ng-if="scale.show">\n\t\t<div class="sub-section form-element">\n\t\t\t<div class="form-label" q-translation="{{scale.title}}" q-title-translation="{{scale.tooltip}}"></div>\n\t\t\t<div class="form-input" aria-label="{{translate(scale.title)}}">\n\t\t\t\t<lui-select\n\t\t\t\t\tid="download-image-scale"\n\t\t\t\t\ttid="download-image-scale"\n\t\t\t\t\tx-model="selectedScale"\n\t\t\t\t\tx-change="onScaleChange()"\n\t\t\t\t\tx-options="scaleOpt.label for scaleOpt in scale.options">\n\t\t\t\t</lui-select>\n\t\t\t</div>\n\t\t</div>\n\t\t\x3c!-- Scale - Custom input --\x3e\n\t\t<div ng-show="selectedScale.isCustom" class="sub-section download-customSize" id="download-custom-scale" tid="download-custom-scale">\n\t\t\t<div class="download-customSize-form-wrap">\n\t\t\t\t<div>\n\t\t\t\t\t<div class="download-customSize-form dcf-with-top-bottom">\n\t\t\t\t\t\t<div class="form-content">\n\t\t\t\t\t\t\t<div class="form-label" q-translation="Common.Width"></div>\n\t\t\t\t\t\t\t\t<dd-input\n\t\t\t\t\t\t\t\t\t\tng-class="{\'lui-invalid\': width.pxError}"\n\t\t\t\t\t\t\t\t\t\ton-blur="changeCustomSize(1)" \n\t\t\t\t\t\t\t\t\t\tmodel="width.current" \n\t\t\t\t\t\t\t\t\t\ton-change="width.onDynamicPixelChange()"\n\t\t\t\t\t\t\t\t\t\ton-enter="changeCustomSize(1)"\n\t\t\t\t\t\t\t\t\t\ttid="download-custom-width-pixels" id="download-custom-width-pixels" \n\t\t\t\t\t\t\t\t\t\taria-label="{{translate(\'Download.Aria.Image.CustomSizeWidth\')}}. {{translate(\'Download.Aria.Image.CustomSizeGeneral\')}}">\n\t\t\t\t\t\t\t\t\t</dd-input>\n\t\t\t\t\t\t\t<div class="download-customSize-unit" q-translation="Common.px"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t\x3c!-- Data Area - Height --\x3e\n\t\t\t\t\t<div class="download-customSize-form">\n\t\t\t\t\t\t<div class="form-content">\n\t\t\t\t\t\t\t<div class="form-label" q-translation="Common.Height"></div>\n\t\t\t\t\t\t\t\t<dd-input \n\t\t\t\t\t\t\t\t\tng-class="{\'lui-invalid\': height.pxError}"\n\t\t\t\t\t\t\t\t\ton-blur="changeCustomSize(2)" \n\t\t\t\t\t\t\t\t\tmodel="height.current" \n\t\t\t\t\t\t\t\t\ton-change="height.onDynamicPixelChange()"\n\t\t\t\t\t\t\t\t\ton-enter="changeCustomSize(2)"\n\t\t\t\t\t\t\t\t\ttid="download-custom-height-pixels" id="download-custom-height-pixels" \n\t\t\t\t\t\t\t\t\taria-label="{{translate(\'Download.Aria.Image.CustomSizeHeight\')}}. {{translate(\'Download.Aria.Image.CustomSizeGeneral\')}}">\n\t\t\t\t\t\t\t\t</dd-input>\n\t\t\t\t\t\t\t<div class="download-customSize-unit" q-translation="Common.px"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="download-customSize-hint">\n\t\t\t\t<span q-translation="{{scale.hint}}"></span>\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n</div>\n'},1555:function(t,e,n){"use strict";var i,a;!(i=[n(1180),n(1556),n(91),n(432),n(1557)],a=function(t,e,n,i){function a(a){a.usingRS=i.getUsingReportingService();a.fileType="png";a.doCallLocal=w;a.changeCustomSize=C;a.onFormChange=b;a.onDataAreaChange=S;a.onScaleChange=I;a.getModifyingCustomSize=T;a.getSummaryText=D;a.currentDpi=a.input.currentDpi;var s=100;var o=a.input.currentWidth/a.input.currentHeight;a.maxSize=5e3;a.minSize=8;a.maxDpi=300;function r(t){return e.verifyPercentage(t)}function l(t,e){if(t)return r(t);return r(e)}function c(t,e){var n="width"===t.dimensionName?t:e;var i="height"===t.dimensionName?t:e;var s=o*(n.percentageValue/i.percentageValue);var r="width"===t.dimensionName?t.current/s:t.current*s;return P(Math.round(r),0,a.maxSize,true)}function u(t,n){return e.reduceByPercentage(t,n)}function d(t,n){return e.calculateInitialDimensions(t,n,q(),a.maxSize)}function p(t,n){if(t.current){var i=P(t.current,0,a.maxSize,true);t.current=i.value;t.pxError=P(i.value,a.minSize,a.maxSize).error;var s=c(t,n);n.current=s.value;n.pxError=P(n.current,a.minSize,a.maxSize).error;s.error&&(t.current=c(n,t).value);t.modifying=e.wasDimensionModified(t);a.dpiMultiplier=t.current/(t.orig*(t.percentageValue/100))*q();var o=a.dpiMultiplier*a.currentDpi;if(o>a.maxDpi){var r=h(100*(o-a.maxDpi)/o);a.dpiMultiplier=h(u(a.dpiMultiplier,r));t.current=Math.round(u(t.current,r));n.current=Math.round(u(n.current,r))}t.modifying=e.wasDimensionModified(t);t.fallback=t.current;n.fallback=n.current}else t.pxError=true;t.modifying=e.wasDimensionModified(t)}function h(t){return t.toFixed(3)}function g(t){var n=r(t.percentageValue);var i=Math.floor(n.value/100*t.orig);var s=P(i,8,a.maxSize);t.current=s.value;if(n.error)t.percError=true;else{if(s.error&&"max"===s.errorType){t.percentageValue=Math.floor(t.current/t.orig*100);t.current=Math.floor(t.percentageValue/100*t.orig)}t.percError=false;t.modifying=e.wasDimensionModified(t)}a.width.fallback=a.width.current;a.height.fallback=a.height.current}var f=d(a.input.currentWidth,a.input.currentHeight);a.dpiMultiplier=f.dpi;a.width={dimensionName:"width",orig:f.w,prev:f.w,current:f.w,fallback:f.w,percentageValue:s,percentageFallback:s,modifying:false,min:8,max:5e3,onDynamicPixelChange:function t(){p(a.width,a.height)},onDynamicPercentageChange:function t(){if(a.width.percentageValue){v();g(a.width);g(a.height);a.width.percentageFallback=a.width.percentageValue}else a.width.percError=true}};a.height={dimensionName:"height",orig:f.h,prev:f.h,current:f.h,fallback:f.h,percentageValue:s,percentageFallback:s,modifying:false,min:8,max:5e3,onDynamicPixelChange:function t(){p(a.height,a.width)},onDynamicPercentageChange:function t(){if(a.height.percentageValue){v();g(a.width);g(a.height);a.height.percentageFallback=a.height.percentageValue}else a.height.percError=true}};function v(){a.width.current=a.width.orig;a.height.current=a.height.orig;a.dpiMultiplier=q()}var m=t.getForImage(a.input.object);a.dataArea=m.dataArea;a.selectedDataArea=a.dataArea.options[0];a.scale=m.scale;a.selectedScale=a.scale.options[0];function b(){a.width.prev=a.width.current;a.height.prev=a.height.current;a.width.modifying=false;a.height.modifying=false;a.printUrl="";w()}function S(){if(a.selectedDataArea.isDefault&&(a.width.current!==a.width.orig||a.height.current!==a.height.orig)){a.width.current=a.width.orig;a.height.current=a.height.orig;a.width.percentageValue=s;a.height.percentageValue=s;b()}if(a.selectedDataArea.isMax){var t=5e3;var e=2500;if(a.width.current!==t||a.height.current!==e){a.width.current=t;a.height.current=e;b()}}}function y(){var t=a.width.current!==x(a.width);var e=a.height.current!==x(a.height);var n=a.dpiMultiplier!==q();return t||e||n}function I(){if(a.selectedScale.isDefault&&y()){a.width.current=x(a.width);a.height.current=x(a.height);a.dpiMultiplier=q();b()}}function x(t){return Math.floor(t.orig*t.percentageValue/100)}function q(){return a.usingRS?1:2}function w(){a.print={};a.print.minSize=a.minSize;a.print.width=a.width.current;a.print.height=a.height.current;a.print.dpi=a.dpiMultiplier?Math.floor(a.currentDpi*a.dpiMultiplier):a.currentDpi;a.width.percentageValue=r(a.width.percentageValue).value;a.height.percentageValue=r(a.height.percentageValue).value;a.imageCustomSize=true;a.print.format="png";a.prevPrintUrl=a.printUrl;a.doCall(0)}function C(){M();a.width.current=A(a.width.current,a.minSize,a.maxSize,false,a.width.fallback).value;a.height.current=A(a.height.current,a.minSize,a.maxSize,false,a.height.fallback).value;a.width.percentageValue=l(a.width.percentageValue,a.width.percentageFallback).value;a.height.percentageValue=l(a.height.percentageValue,a.height.percentageFallback).value;a.width.prev===a.width.current&&a.height.prev===a.height.current||b()}function P(t,n,i,a){return e.verifySizeRange(t,n,i,a)}function T(){return a.width.modifying||a.height.modifying}function A(t,e,n,i,a){if(!t&&a)return P(a,e,n,i);return P(t,e,n,i,a)}function D(t){switch(t){case 0:var e=A(a.width.current,a.minSize,a.maxSize,false,a.width.fallback).value;var i=A(a.height.current,a.minSize,a.maxSize,false,a.height.fallback).value;return e+" x "+i+" "+a.translate("Common.px");case 1:return n.get("Common.Preview");default:return""}}var E=false;a.attemptFirstCall=k;function k(){if(!E){w();E=true}}a.injectScopeToParent(0,a);function M(){a.width.percError=false;a.width.pxError=false;a.height.percError=false;a.height.pxError=false}}return{directiveLinkFunction:a}}.apply(e,i),void 0!==a&&(t.exports=a))},1556:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){function t(t){return t?{value:t}:{value:1,error:true}}function e(t,e,n,i){if(!t&&0!==t&&!i)return{value:e,error:true,errorType:"min"};if(t<e)return{value:e,error:true,errorType:"min"};if(t>n)return{value:n,error:true,errorType:"max"};return{value:t,error:false}}function n(t){return t.prev!==t.current}function i(t,e,n,i){var o=t*n;var r=e*n;var l=a(o>r?o:r,i);if(l){o=Math.floor(s(o,l));r=Math.floor(s(r,l));n=s(n,l)}return{w:o,h:r,dpi:n}}function a(t,n){var i=e(t,0,n);if("max"===i.errorType)return 100-100*n/t;return 0}function s(t,e){return t-t*e/100}return{verifySizeRange:e,wasDimensionModified:n,calculateInitialDimensions:i,verifyPercentage:t,reduceByPercentage:s}}.apply(e,i),void 0!==a&&(t.exports=a))},1557:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(1558),n(91)],a=function(t,e,n){t.directive("ddImagePreview",function(){return{restrict:"E",template:e,replace:true,scope:{state:"=",states:"=",disablePreview:"=",topText:"=",bottomText:"=",previewUrl:"="},link:function t(e){e.$watch("state",i);function i(t){t===e.states.PENDING&&(e.imageLoaded=false)}e.translate=n.get;e.hidePreviewCondition=a;function a(){return!e.state||!e.previewUrl||e.state!==e.states.COMPLETED}e.hidePendingCondition=s;function s(){return e.state!==e.states.PENDING}e.disablePreviewCondition=o;function o(){return e.state===e.states.PENDING||e.disablePreview}}}})}.apply(e,i),void 0!==a&&(t.exports=a))},1558:function(t,e){t.exports='<div class="dd-preview dd-preview-image">\n    <div class="preview" ng-hide="hidePreviewCondition()">\n        <div class="preview-text pt-top">{{topText}}</div>\n        <div class="preview-separator"></div>\n        <div class="preview-content preview-content-image" >\n            <img \n            class="preview-image"\n            tid="download-preview" \n            ng-src="{{previewUrl}}" \n            ng-class="{ \'preview-disabled\': disablePreviewCondition() }"\n            imageonload\n            loaded="imageLoaded"\n            />\n        </div>\n        <div class="preview-separator"></div>\n        <div class="preview-text pt-bottom">{{bottomText}}</div>\n    </div>\n    <div ng-if="state === states.PENDING" class="status-wrap" tid="pending-status" id="pending-status"> \n        <div class="status-spinner">\n            <div class="spinner">\n                <div class="qv-loader white"></div>\n            </div>\n        </div>\n        <div class="status-text">\n            <div q-translation="Download.PendingPreview" class="st-header"></div>\n        </div>\n    </div>\n    <div ng-if="state === states.FAILED || !state" tid="failed-status" id="failed-status" class="status-wrap">\n        <div class="lui-icon lui-icon--warning status-icon"></div>\n        <div class="status-text">\n            <div class="st-header" q-translation="Download.Error.Generic_1"></div>\n            <div ng-switch="statusCode">\n                <div ng-switch-when="413" q-translation="Download.Error.Selections"></div>\n                <div ng-switch-default q-translation="Download.Error.Generic_2"></div>\n            </div>\n        </div>\n    </div>\n    <div ng-if="state === states.TIMEOUT" tid="timeout-status" id="timeout-status" class="status-wrap">\n        <div class="lui-icon lui-icon--idle status-icon"></div>\n        <div class="status-text">\n            <div q-translation="Download.Image.Timeout" class="st-header"></div>\n            <div q-translation="Download.Error.Generic_2"></div>\n        </div>\n    </div>\n</div>\n'},1559:function(t,e,n){"use strict";var i,a;!(i=[n(48)],a=function(t){t.directive("imageonload",function(){return{restrict:"A",scope:{loaded:"="},template:"<img />",link:function t(e,n){n.bind("load",function(){e.loaded=true;e.$apply("loaded")})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},1560:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(1561)],a=function(t,e){t.directive("ddInput",function(){return{restrict:"E",require:"ngModel",replace:true,scope:{onChange:"&",model:"=",onBlur:"&",onEnter:"&"},template:e,controller:n,link:function t(e,n,i,a){function s(t){if(t){var e=t.replace(/[^0-9]/g,"");if(e!==t){a.$setViewValue(e);a.$render()}return e}return}a.$parsers.push(s)}}});var n=["$scope","$timeout",function(t,e){t.prev=t.model;t.onKeyDown=function(e){switch(e.which){case 13:t.onEnter();break;case 38:t.model++;n();break;case 40:t.model--;n();break}};t.change=n;function n(){t.model=parseInt(t.model);e(function(){t.onChange()})}}]}.apply(e,i),void 0!==a&&(t.exports=a))},1561:function(t,e){t.exports='<input type="text" class="lui-input form-input dd-input" min="0" maxlength="5"\n  ng-change="change()" \n  ng-model="model" \n  ng-blur="onBlur()" \n  ng-keydown="onKeyDown($event)" />\n'},1562:function(t,e,n){"use strict";var i,a;!(i=[n(443),n(1563),n(50)],a=function(t,e,n){return{template:e,scope:{},controller:["$scope","$element",function(e,i){i.find(".content").showComponent(t,{input:e.input});e.cancel=function(){e.destroyComponent()};n.ViewChanged.bind(e.destroyComponent);e.$on("$destroy",function(){n.ViewChanged.unbind(e.destroyComponent)})}]}}.apply(e,i),void 0!==a&&(t.exports=a))},1563:function(t,e){t.exports='<div class="qv-object-info-mobile">\n\n\t<div class="qui-toolbar qv-mi-toolbar" qva-direction x-dir-setting="{{direction}}">\n\n\t\t<div class="qv-mi-toolbar-title">\n\t\t\t<span q-translation="ObjectInfo.Dialog.Header" class="qv-mi-toolbar-text"></span>\n\t\t</div>\n\n\t\t<qui-toolbarbutton qva-activate="cancel($event)" name="cancel" class="qv-mi-toolbar-close" tid="object-info-close">\n\t\t\t<span q-translation="Common.Close" class="qv-mi-toolbar-text"></span>\n\t\t</qui-toolbarbutton>\n\t</div>\n\n\t<div class="content"></div>\n\n</div>\n\n'},1564:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(1565),n(91),n(13),n(100),n(89),n(451),n(188)],a=function(t,e,n,i,a,s,o,r){function l(t,e){if(!e.qHasSoftPatches)return s.resolve();return s.all({properties:t.getProperties(),effective:t.getEffectiveProperties()}).then(function(t){var e=r.generate(t.properties,t.effective);e&&e.length&&(e=e.map(function(t){return{qOp:t.op,qValue:JSON.stringify(t.value),qPath:t.path}}));return e})}t.service("objectDeveloperDialog",["luiDialog",function(t){function r(r,c){t.show({controller:["$scope","$element",function(t,e){t.layout=c.model.layout;t.closeLabel=n.get("Common.Close");t.title="Developer";e.on("keyup,keydown",function(t){t.stopPropagation()});t.state={layoutExpanded:false,propertiesExpanded:false};t.toggleProperties=function(){t.state.propertiesExpanded?t.state.propertiesExpanded=false:c.model.getProperties().then(function(e){t.properties=e;t.state.propertiesExpanded=true})};Object.defineProperty(t,"formattedLayout",{get:function t(){return JSON.stringify(c.model.layout,null,2)}});Object.defineProperty(t,"formattedProperties",{get:function e(){return JSON.stringify(t.properties||{},null,2)},set:function e(n){var i=JSON.parse(n);i.qInfo.qId=c.model.layout.qInfo.qId;c.model.setProperties(i);t.properties=i}});t.clickPrintLink=function(t){t.preventDefault();s.all([c.model.app.getLayout(),c.getSnapshotLayout()]).then(function(t){var e=t[0];var a=t[1];var s=c.model.layout.qInfo.qId+Date.now();localStorage.setItem("print-"+s,JSON.stringify({data:a,language:n.language,appLocaleInfo:e.qLocaleInfo}));var o=i.rootPath+"resources/printing-snapshot.html?callback=fromLocalStorage&printId="+s;window.open(o,"_blank")})};t.clickPrintLinkFull=function(t){t.preventDefault();s.all([o.snapshot(c.model.id,"object",{size:{width:document.body.clientWidth,height:document.body.clientHeight},source:c,sourceSize:{width:100,height:100},sheetLayout:"grid"})]).then(function(t){var e=t[0];var n=c.model.layout.qInfo.qId+Date.now();localStorage.setItem("print-"+n,e.snapshotData);var a=i.rootPath+"resources/printing-snapshot.html?callback=fromLocalStorage&printId="+n;window.open(a,"_blank")})};t.clickPrintLiveLink=function(t,e){t.preventDefault();var o=c.model.layout.qInfo.qId+Date.now();var u=i.rootPath+"resources/printing-live.html?callback=fromLocalStorage&livePrintId="+o;switch(e){case"object":s.all([c.getViewState(),l(c.model,c.model.layout)]).then(function(t){var i=t[0];var s=t[1];localStorage.setItem("live-print-"+o,JSON.stringify({appId:c.model.app.id,type:e,objectId:c.model.layout.qInfo.qId,options:{language:n.language,viewState:i,theme:a.getCurrentTheme(),patches:s,objectSize:c.objectSize}}));window.open(u,"_blank")});break;case"sheet":localStorage.setItem("live-print-"+o,JSON.stringify({appId:c.model.app.id,type:e,objectId:r.layout.qInfo.qId,language:n.language}));window.open(u,"_blank")}};t.clickSingleIntegratorLink=function(t){t.preventDefault();var e=encodeURIComponent(c.model.app.layout.qFileName);var n=c.model.layout.qInfo.qId;var a=i.rootPath+"dev-hub/single-configurator#qapp{"+e+";"+n+"}";window.open(a,"_blank")}}],template:e,closeOnEscape:true})}return{show:r}}])}.apply(e,i),void 0!==a&&(t.exports=a))},1565:function(t,e){t.exports='<lui-dialog class="qv-developer-dialog" style="min-width: 350px;">\n\t<lui-dialog-header>\n\t\t<lui-dialog-title>Developer</lui-dialog-title>\n\t</lui-dialog-header>\n\t<lui-dialog-body>\n\t\t<div style="margin-top: 5px;">\n\t\t\t<span style="font-weight: bold;">Object ID</span>\n\t\t\t<input readonly="readonly" ng-model="layout.qInfo.qId" style="display: inline-block; text-align: right; border: none; cursor: text;"/>\n\t\t</div>\n\t\t\n\t\t<div style="margin-top: 8px; font-weight: bold;" ng-click="toggleProperties()">\n\t\t\t<span>Properties</span>\n\t\t\t<span class="lui-icon lui-icon--small" ng-class="state.propertiesExpanded ? \'lui-icon--triangle-top\' : \'lui-icon--triangle-right\'"\n\t\t\t\tstyle="cursor: pointer; margin-left: 5px;">\n\t\t\t</span>\n\t\t</div>\n\t\t<div ng-if="state.propertiesExpanded" style="margin-top: 5px;">\n\t\t\t<textarea type="text" rows="15" class="lui-textarea" ng-readonly="!layout.permissions.update"\n\t\t\t\tng-model="formattedProperties" ng-change="change()" ng-model-options="{ updateOn: \'blur\' }">\n\t\t\t</textarea>\n\t\t</div>\n\t\n\t\t<div style="margin-top: 8px; font-weight: bold;" ng-click="state.layoutExpanded = !state.layoutExpanded">\n\t\t\t<span>Layout</span>\n\t\t\t<span class="lui-icon lui-icon--small" ng-class="state.layoutExpanded ? \'lui-icon--triangle-top\' : \'lui-icon--triangle-right\'"\n\t\t\t\tstyle="cursor: pointer; margin-left: 5px;">\n\t\t\t</span>\n\t\t</div>\n\t\t<div ng-if="state.layoutExpanded" style="margin-top: 5px;">\n\t\t\t<textarea type="text" rows="15" class="lui-textarea" readonly="true" ng-model="formattedLayout"></textarea>\n\t\t</div>\n\t\n\t\t<div style="margin: 12px 5px; border-top: 1px solid rgb(179, 179, 179)"></div>\n\t\n\t\t<div style="margin-top: 8px;">\n\t\t\t<a href="javascript:void(0)" target="_blank" ng-click="clickSingleIntegratorLink( $event );">\n\t\t\t\tOpen in single configurator <span class="lui-icon  lui-icon--new-tab lui-icon--small"></span>\n\t\t\t</a>\n\t\t</div>\n\t\n\t\t<div style="margin-top: 8px;">\n\t\t\t<a href="javascript:void(0)" ng-click="clickPrintLink( $event );">\n\t\t\t\tTest exporting <span class="lui-icon  lui-icon--new-tab lui-icon--small"></span>\n\t\t\t</a>&nbsp;&nbsp;\n\t\t\t<a href="javascript:void(0)" ng-click="clickPrintLinkFull( $event );">\n\t\t\t\tTest window sized export <span class="lui-icon  lui-icon--new-tab lui-icon--small"></span>\n\t\t\t</a>\n\t\t</div>\n\t\t<div style="margin-top: 8px;">\n\t\t\tTest Live mashup: \n\t\t\t<a href="javascript:void(0)" ng-click="clickPrintLiveLink( $event, \'object\' );">\n\t\t\t\tObject&nbsp;<span class="lui-icon  lui-icon--new-tab lui-icon--small"></span>\n\t\t\t</a>&nbsp;&nbsp;\n\t\t\t<a href="javascript:void(0)" ng-click="clickPrintLiveLink( $event, \'sheet\' );">\n\t\t\t\tSheet&nbsp;<span class="lui-icon  lui-icon--new-tab lui-icon--small"></span>\n\t\t\t</a>\n\t\t</div>\n\t</lui-dialog-body>\n\t<lui-dialog-footer>\n\t\t<lui-button tid="developer-dialog-close" ng-click="close(true);" qva-focus="true">{{::closeLabel}}</lui-button>\n\t</lui-dialog-footer>\n</lui-dialog>\n'},167:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={};Object.defineProperties(t,{ENTER:{value:13},ESCAPE:{value:27},SPACE:{value:32},TAB:{value:9},BACKSPACE:{value:8},DELETE:{value:46},ALT:{value:18},CTRL:{value:17},SHIFT:{value:16},ARROW_UP:{value:38},ARROW_DOWN:{value:40},ARROW_LEFT:{value:37},ARROW_RIGHT:{value:39},PAGE_DOWN:{value:34},PAGE_UP:{value:33},HOME:{value:36},END:{value:35},F10:{value:121},A:{value:65},F:{value:70}});t.isArrow=function(e){return e===t.ARROW_UP||e===t.ARROW_DOWN||e===t.ARROW_LEFT||e===t.ARROW_RIGHT};return t}.apply(e,i),void 0!==a&&(t.exports=a))},168:function(t,e,n){"use strict";var i,a;!(i=[n(92),n(90),n(183)],a=function(t,e,n){var i;var a;var s;var o=t.extend("PrecedentsService",{init:function t(){},_getAPI:function t(){i||(i=n.getApi("api/precedent/v1","openapi"));return i},_handleRestResponse:function t(e,n,i){return i.body.response},_getAppName:function t(){return e.getParameterByName("app")},defineDimension:function t(e){var n=this;var i=arguments;var a={};a.targets=[{type:"dimension",dimension:e}];a.source={type:"user"};a.relation={relation:"define"};return this._getAPI().then(function(t){return t.apis.precedents.addPrecedent({appId:n._getAppName()},{requestBody:a,server:t.spec.servers[0].url}).then(n._handleRestResponse.bind(n,"defineDimension",i))})},defineMeasure:function t(e){var n=this;var i=arguments;var a={};a.targets=[{type:"measure",measure:e}];a.source={type:"user"};a.relation={relation:"define"};return this._getAPI().then(function(t){return t.apis.precedents.addPrecedent({appId:n._getAppName()},{requestBody:a,server:t.spec.servers[0].url}).then(n._handleRestResponse.bind(n,"defineMeasure",i))})},dislikeField:function t(e){var n=this;var i=arguments;a=void 0;var s={};s.targets=[{type:"field",field:e}];s.source={type:"user"};s.relation={relation:"dislike"};return this._getAPI().then(function(t){return t.apis.precedents.addPrecedent({appId:n._getAppName()},{requestBody:s,server:t.spec.servers[0].url}).then(n._handleRestResponse.bind(n,"dislikeField",i))})},removeDefinedItem:function t(e){var n=this;var i=arguments;s=void 0;return this._getAPI().then(function(t){return t.apis.precedents.removePrecedent({appId:n._getAppName(),sourceType:"user",relation:"define",targetNodeId:e}).then(n._handleRestResponse.bind(n,"removeDefinedItem",i))})},getLearnedItems:function t(){var e=this;var n=arguments;if(s&&s.pending)return s;var i={};i.targets=[{type:"field"},{type:"libItem"},{type:"dimension"},{type:"measure"}];i.source={type:"user"};i.relations=[{relation:"define"},{relation:"dislike"}];s=this._getAPI().then(function(t){return t.apis.precedents.getRelationships({appId:e._getAppName()},{requestBody:i,server:t.spec.servers[0].url}).then(e._handleRestResponse.bind(e,"getDefinedItems",n))});return s},undislikeItem:function t(e){var n=this;var i=arguments;a=void 0;return this._getAPI().then(function(t){return t.apis.precedents.removePrecedent({appId:n._getAppName(),sourceType:"user",relation:"dislike",targetNodeId:e}).then(n._handleRestResponse.bind(n,"undislikeItem",i))})},getDislikedItems:function t(){var e=this;var n=arguments;if(a)return a;var i={};i.targets=[{type:"field"},{type:"libItem"}];i.source={type:"user"};i.relations=[{relation:"dislike"}];a=this._getAPI().then(function(t){return t.apis.precedents.getRelationships({appId:e._getAppName()},{requestBody:i,server:t.spec.servers[0].url}).then(e._handleRestResponse.bind(e,"getDislikedItems",n))});return a},dislikeLibItem:function t(e){var n=this;var i=arguments;a=void 0;var s={};s.targets=[{type:"libItem",libItem:e}];s.source={type:"user"};s.relation={relation:"dislike"};return this._getAPI().then(function(t){return t.apis.precedents.addPrecedent({appId:n._getAppName()},{requestBody:s,server:t.spec.servers[0].url}).then(n._handleRestResponse.bind(n,"dislikeLibItem",i))})},likeAnalysis:function t(e){var n=this;var i=arguments;var a={};a.targets=[{type:"analysis",analysis:e}];a.source={type:"user"};a.relation={relation:"like"};return this._getAPI().then(function(t){return t.apis.precedents.addPrecedent({appId:n._getAppName()},{requestBody:a,server:t.spec.servers[0].url}).then(n._handleRestResponse.bind(n,"likeAnalysis",i))})},dislikeAnalysis:function t(e){var n=this;var i=arguments;var a={};a.targets=[{type:"analysis",analysis:e}];a.source={type:"user"};a.relation={relation:"dislike"};return this._getAPI().then(function(t){return t.apis.precedents.addPrecedent({appId:n._getAppName()},{requestBody:a,server:t.spec.servers[0].url}).then(n._handleRestResponse.bind(n,"dislikeAnalysis",i))})},undislikeAnalysis:function t(e){var n=this;var i=arguments;return this._getAPI().then(function(t){return t.apis.precedents.removePrecedent({appId:n._getAppName(),sourceType:"user",relation:"dislike",targetNodeId:e.precedents.id}).then(n._handleRestResponse.bind(n,"undislikeAnalysis",i))})},scrapeApp:function t(){var e=this;var n=arguments;a=void 0;return this._getAPI().then(function(t){return t.apis.precedents.scrapeApp({appId:e._getAppName()}).then(e._handleRestResponse.bind(e,"scrapeApp",n))})}});return o}.apply(e,i),void 0!==a&&(t.exports=a))},169:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91)],a=function(t,e){var n=0;var i=6;var a=1;function s(t,e,s,r){var l;if(0===e.length)return;t[s]||(t[s]={});l=t[s];l.string=e;l.isWhitespace=r||e.length<a&&!o(e)||'"'===e;l.colorIx=l.isWhitespace?-1:n;n=l.isWhitespace?n:(n+1)%i}function o(t){return t.match(/[\u3040-\u9FBF]/)||t.match(/[\uFF65-\uFF9F]/)}function r(t,e,n,i){if(e.length<a&&!o(e))return;t.push({string:e,startQuote:n,endQuote:i})}t.service("qvGlobalSearchDataService",function(){this.transformResult=function(t,n){var i=n;t.matches=t.matches||[];t.searchTermGroups=t.searchTermGroups||[];t.searchVisualsGroups=t.searchVisualsGroups||[];for(var a=0;a<i.qSearchGroupArray.length;++a)if("DatasetType"===i.qSearchGroupArray[a].qGroupType){t.searchTermGroups.push(i.qSearchGroupArray[a]);var s=i.qSearchGroupArray[a];-1===t.matches.indexOf(s.qSearchTermsMatched.length)&&t.matches.push(s.qSearchTermsMatched.length)}else t.searchVisualsGroups.push(i.qSearchGroupArray[a]);t.displayResult.data=t.searchTermGroups.length>0;t.displayResult.visuals=t.searchVisualsGroups.length>0;t.searchVisualsGroups.length>0&&(t.existingChartGroupTitle=e.get("GlobalSearch.Existing.ChartsTitle",[t.searchVisualsGroups[0].qItems.length]))};this.showMore=function(t,e){if(!e||!t||1!==t.qSearchGroupArray.length)return;var n=t.qSearchGroupArray[0],i;for(var a=0;a<n.qItems.length;a++)if(n.qItems[a].qIdentifier===e.qIdentifier){i=n.qItems[a].qItemMatches;break}i&&(e.qItemMatches=i)};this.setHeaders=function(t){var e,n=0;for(e=0;e<t.searchTermGroups.length;e++)t.searchTermGroups[e].qTotalNumberOfItems>n&&(n=t.searchTermGroups[e].qTotalNumberOfItems);t.columnCount=n;t.columnWidth=Math.floor(100/n)+"%";t.shadowHeaders=t.shadowHeaders||[];t.shadowHeaders.splice(0,t.shadowHeaders.length-n);for(e=t.shadowHeaders.length;e<n;e++)t.shadowHeaders[e]={}};this.transformSuggest=function(t,e,n){var i,a=0,s,o=[];this.getUnderlinersAndSearchTerms(t.query,o,[]);n=void 0!==n?n:25;n=Math.min(n,e.qSuggestions.length);for(i=0;i<n;++i){s={value:e.qSuggestions[i].qValue,term:e.qSuggestions[i].qTerm};if(t.query===this.getResultingQueryFromSuggestion(o,s))continue;t.suggestions[a]=s;a++}t.suggestions.splice(a,t.suggestions.length-a)};this._whitespaces=[" ","\t","\n","\r","\r\n","　"];this.isWhiteSpaceAt=function(t,e){var n=this._whitespaces;var i=t.charAt(e),a;for(a=0;a<n.length;++a)if(i===n[a])return true;return false};this.getUnderlinersAndSearchTerms=function(t,e,i){var a=0,o=0,l=t.length,c=0,u,d=this._whitespaces,p=this;i.length=0;n=0;function h(t,e){var n,i,a;for(i=0;i<d.length;++i){n=t.indexOf(d[i],e);n>=0&&(!a||n<a)&&(a=n)}return a||-1}function g(t,e){var n;do{n=t.indexOf('"',e);e=n+1}while(n>=0&&e<l&&!p.isWhiteSpaceAt(t,e));return n}function f(){while(o<l&&p.isWhiteSpaceAt(t,o))o++;o>a&&s(e,t.substring(a,o),c++,true);a=o}f();while(a<l){if('"'===t.charAt(a)){s(e,t.substring(a,a+1),c++);o=g(t,++a);u=o>=0?t.substring(a,o):t.substring(a);s(e,u,c++);r(i,u,true,o>0);if(o<0)break;s(e,t.substring(o,o+1),c++);o+=1;a=o;f();continue}o=h(t,a);u=o>=0?t.substring(a,o):t.substring(a);s(e,u,c++);r(i,u,false,false);if(o<0)break;a=o;f()}e.splice(c,e.length-c)};this.getSuggestTerms=function(t,e){var n=this,i,a;function s(t){var e,i,a;t=t.trim();if(0===t.length)return null;e=t.length;i=e-1;a=-1;while(i>-1){if(n.isWhiteSpaceAt(t,i)){a=i+1;break}i--}a=Math.max(a,0);return t.substring(a,e)}a=s(t);i=e.map(function(t){return t.string});a&&2===a.length&&'"'===a.charAt(0)&&i.push(a.charAt(1));return i};this.getUnderlineLengthFromTermIx=function(t,e){var n=0,i,a=0;while(n<t.length){i=t[n];if(!(a<e||i.isWhitespace))break;if(n===t.length-1&&1===i.string.length&&!this.isWhiteSpaceAt(i.string,0)&&'"'!==i.string)break;i.isWhitespace||a++;n++}return n>0?n:0};this.getResultingQueryFromSuggestion=function(t,e){var n,i,a,s,o=this.getUnderlineLengthFromTermIx(t,e.term);n=t.slice(0,o).reduce(function(t,e){return t+e.string},"");i='"'===n.charAt(n.length-1);a=!i&&e.value.indexOf(" ")>=0;s=a||i;return n+(a?'"':"")+e.value+(s?'"':"")};this.getMinQueryLength=function(){return a};this.getMaxColorsNum=function(){return i}})}.apply(e,i),void 0!==a&&(t.exports=a))},1749:function(t,e,n){"use strict";var i,a;!(i=[n(10),n(284),n(90),n(48),n(115),n(422),n(89),n(1534)],a=function(t,e,n,i,a,s,o,r){function l(e,n,a){var s=new o;if(e){var r=e[0]?e[0]:e;r.innerHTML='<qv-object model="model" options="options" object="object"></qv-object>';var l=t.element(r).scope();if(l){var c=l.$new(true);var u=t.copy(a)||{};u.isReadonly=false!==u.isReadonly;c.model=n;c.options=u;c.object={};var d=i.getService("$compile");d(t.element(r).children("qv-object"))(c);s.resolve(c);i.$apply(c)}else s.reject(new Error("Element scope is undefined."))}else s.reject(new Error("Element is undefined."));return s.promise}function c(t,e){return t.isSnapshot?e.snapshotData.object.activeId:sessionStorage["cntr-"+e.qInfo.qId+"-active-tab"]}function u(t){t.children&&0==t.children.length&&t.qChildList.qItems.length>0&&t.qChildList.qItems.forEach(function(e){e.qData.containerChildId=n.generateId();t.children.push({refId:e.qData.containerChildId,label:e.qData.title,condition:e.qData.showCondition})})}function d(t,e){var n=e.filter(function(e){return t.refId?t.refId===e.qData.containerChildId||t.refId===e.qData.qExtendsId:t.childId===e.qInfo.qId});return n.length>0?n[0]:{qData:{},qInfo:{}}}function p(t,e,n,i){if(150*t<e)return t;var a=0;n&&(a+=36);i&&(a+=76);return Math.floor((e-a)/150)}function h(t,e){var n=-1;t.forEach(function(t,i){t.childId===e&&(n=i)});return n}function g(t){Object.defineProperties(this,{qapp:{value:e.currApp(t)},items:{value:[]}});this.firstTab=0}g.prototype.init=function(t,e,n){this.backendApi=e;this.element=t;this.containerId=n;if(this.visModel){var i=t.querySelector(".qsc-item");this.visModel.show(i,{isReadonly:false})}};g.prototype.setLayout=function(t,e,n){this.showTabs=t.showTabs;this.useDropdown=t.useDropdown;this.useScrollButton=t.useScrollButton;this.items.length=0;this.empty=0===t.qChildList.qItems.length;var i=this,s=false,r=c(this.backendApi,t),l=this.items;u(t);t.children.forEach(function(e){if(g.evaluateCondition(e)){var n=d(e,t.qChildList.qItems),i=n.qData.visualization||n.qInfo.qType;l.push({label:e.label,childId:n.qInfo.qId,refId:e.refId,visualization:i,icon:t.showIcons?a.getIconName(i):""});n.qInfo.qId===r&&(s=true)}});this.setSize(t,n);if(this.newId)return this.setActiveId(this.newId,n,e).then(function(){delete i.newId});if(e.viewState&&e.viewState.activeId)return this.setActiveId(e.viewState.activeId,n,e);if(r&&s)return this.setActiveId(r,n,e);if(!this.showTabs||!s)return this.setActiveId(this.items.length>0?this.items[0].childId:"",n,e);if(this.direction!==e.direction){this.direction=e.direction;if(this.visModel)return this.visModel.show(n.querySelector(".qsc-item"),{isReadonly:false})}this.direction=e.direction;return o.resolve()};g.prototype.setSize=function(t,e){var n=p(this.items.length,e.clientWidth,this.useDropdown,this.useScrollButton);if(n<1){n=1;this.useScrollButton=false}else this.useScrollButton=t.useScrollButton;this.tabCount=n;this.tabCount===this.items.length&&(this.firstTab=0);this.lastTab=this.firstTab+this.tabCount;this.scrollToItem(this.activeId)};g.prototype.scrollToItem=function(t,e){if(this.showTabs&&this.items.length>this.tabCount){var n=h(this.items,t);if(n>-1&&(n<this.firstTab||n>=this.lastTab)){this.firstTab=Math.max(0,Math.min(n-Math.floor(this.tabCount/2),this.items.length-this.tabCount));this.lastTab=this.firstTab+this.tabCount}if(n<0&&!e){var a=this,s=i.getService("$timeout");s(function(){a.scrollToItem(t,true)},500)}}};g.prototype.setActiveId=function(t,e,n){var i=o(),a="cntr-"+this.containerId+"-active-tab",c=sessionStorage[a];if(c!==t||this.activeId!==t){sessionStorage.setItem(a,t);this.activeId=t;this.activePos=h(this.items,this.activeId);if(this.visModel){this.visModel.model&&(this.visModel.model._expendable=false);this.visModel.close();this.visModel=void 0}var u=e?e.querySelector(".qsc-item"):this.element.querySelector(".qsc-item");var d=this;if(this.backendApi.isSnapshot){this.scrollToItem(t);this.backendApi.model.layout.qChildList.qItems.forEach(function(e){if(e.qInfo.qId===t){var n=r.getMockedModel(e,d.backendApi.model.app.layout.qLocaleInfo);l(u,n,{isReadonly:true,APIType:s,direction:d.backendApi.model.layout.snapshotData.rtl?"rtl":"ltr",onRendered:function t(){i.resolve()}})}})}else{if(t){this.scrollToItem(t);return this.qapp.visualization.get(t).then(function(t){n=n||{};t.show(u,{isReadonly:n.isReadonly||false,noInteraction:n.noInteraction,noSelections:n.noSelections,viewState:n.viewState?n.viewState.childViewState:void 0});d.visModel=t;d.onChildChangeListener&&d.onChildChangeListener();return t.rendered.promise})}u.innerHTML="";i.resolve()}}else i.resolve();return i.promise};g.prototype.getChild=function(){return this.visModel&&this.visModel._scopes&&this.visModel._scopes[0].object};g.prototype.getOptions=function(){return this.visModel&&this.visModel._scopes&&this.visModel._scopes[0].options};g.prototype.setNewId=function(t){this.newId=t};g.prototype.scrollTabs=function(t){var e=this.activePos+t;if(e>-1&&e<this.items.length){this.setActiveId(this.items[e].childId);this.scrollToItem(this.activeId)}};g.prototype.getLeftScrollButtonClass=function(){return this.activePos<1?"lui-disabled":""};g.prototype.getRightScrollButtonClass=function(){return this.activePos>=this.items.length-1?"lui-disabled":""};g.prototype.showScrollButtons=function(){return this.tabCount<this.items.length&&this.tabCount>1};g.prototype.showDropdown=function(){return this.tabCount<this.items.length};g.prototype.focus=function(t,e){if(this.items.length>0){e||(this.focusId=this.items[this.firstTab].childId);t.find('[data-itemid="'+this.focusId+'"]').focus()}};g.prototype.stepFocus=function(t,e){var n=h(this.items,this.focusId)+e;if(n>-1&&n<this.items.length){this.focusId=this.items[n].childId;this.scrollToItem(this.focusId);var a=this.focusId;var s=i.getService("$timeout");s(function(){t.find('[data-itemid="'+a+'"]').focus()},50)}};g.prototype.hasFocus=function(t){return t.find(".qsc-tab-row")[0].contains(document.activeElement)};g.prototype.onChildChange=function(t){this.onChildChangeListener=t;this.onChildChangeListener()};g.prototype.switchTo=function(t){var e=this.items.filter(function(e){return e.refId===t});e.length>0&&(e[0].childId!==this.activeId?this.setActiveId(e[0].childId,this.element,{}):this.onChildChangeListener&&this.onChildChangeListener())};g.prototype.updateActivePosition=function(){this.activePos=h(this.items,this.activeId)};g.evaluateCondition=function(t){if(t){var e=t.condition?+t.condition:-1;if(Number.isNaN(+e))return"true"===t.condition.toLowerCase();return 0!==e}};return g}.apply(e,i),void 0!==a&&(t.exports=a))},175:function(t,e,n){"use strict";var i,a;!(i=[n(95),n(11),n(10),n(48),n(833),n(839),n(94),n(50),n(202)],a=function(t,e,n,i,a,s,o,r,l){i.service("qvGlobalSelectionsService",["$document","$timeout",function(i,c){var u={},d,p=false,h=null,g=[];function f(t){if(!t)return u[0];return u[m(t)]}function v(t,e){u[m(t)]=e}function m(t){return t&&t.id?t.id.toUpperCase():""}function b(t){function e(){var e=f(t);y(e)}function n(){var e=f(t);y(e);S(e)}return{$container:void 0,$app:t,$selectionCount:false,$showFields:false,getComponent:function t(){return r.isSmallDevice?s:a},setup:function t(){r.ViewChanged.bind(n);o.StateChanged.bind(e)},destroy:function t(){r.ViewChanged.unbind(n);o.StateChanged.unbind(e)}}}function S(t){t.$container=n.element("<div>");i.find("#global-selections-container").length>0?i.find("#global-selections-container").append(t.$container):i.find("body").append(t.$container);t.$container.showComponent(t.getComponent(),["$scope",function(e){e.app=t.$app}]);t.setup()}function y(t){if(t.$container){t.$container.remove();t.$container=void 0}g.forEach(function(t){t()});t.destroy()}function I(t){var e=f(t);if(!e){e=new b(t.enigmaModel);v(t,e)}return e}function x(t){return t&&void 0!==t.$container}function q(){t.publish("/toolbar/setContextItemsVisibility",d.getCaoActive()||d.isSelectActive())}function w(t){var n=l.getCurrentSheetInfo();if(x(t)){l.closeAnalysisOverlay(n.sheetId,n.appId);y(t);e("body").removeClass("qv-global-selections-enabled")}else{l.openAnalysisOverlay(n.sheetId,n.appId,o.States.selections);e("body").addClass("qv-global-selections-enabled");S(t)}q()}d={toggleGlobalSelection:function t(e){w(I(e))},off:function t(){Object.keys(u).forEach(function(t){y(u[t])})},isSelectActive:function t(e){var n=f(e);return!!(void 0!==e&&x(n))},getCaoActive:function t(){return p},setCaoActive:function t(e){c(function(){p=e;q()})},setCsShowCallback:function t(e){h=e},setCsShow:function t(e){h&&h(e)},setSelectionCount:function e(n,i){var a=I(i);a.$selectionCount=n;t.publish("/toolbar/invalidateMobileToolbar",n)},getSelectionCount:function t(e){var n=f(e)||{};return n.$selectionCount},setShowFields:function t(e,n){var i=I(n);i.$showFields=e},getShowFields:function t(e){var n=f(e)||{};return!!n.$showFields},onClose:function t(e){"function"===typeof e&&g.push(e)}};return d}])}.apply(e,i),void 0!==a&&(t.exports=a))},177:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t="q3TnObj";function e(){var e=JSON.parse(sessionStorage.getItem(t));null===e&&(e=JSON.parse(localStorage.getItem(t))||{});return e}function n(){return e()}function i(n){var i=e();if(!i[n]){i[n]={data:{view:"",scriptTabIndex:0},tab:"",analysis:{sheetId:"",state:""},story:{storyId:"",slideId:"",state:""}};sessionStorage.setItem(t,JSON.stringify(i));localStorage.setItem(t,JSON.stringify(i));return i[n]}return i[n]}function a(n,a,s,o){var r=i(n);var l=e();void 0===s&&(s=l[n].data.scriptTabIndex);o||(r.tab="data");r.data={view:a,scriptTabIndex:s};l[n]=r;localStorage.setItem(t,JSON.stringify(l));sessionStorage.setItem(t,JSON.stringify(l));return l[n]}function s(t){var n=e();if(n[t])return n[t].data;return"not_found"}function o(n,a,s,o){var r=i(s);var l=e();r.tab="analysis";r.analysis={sheetId:n,state:a,overlay:o};l[s]=r;localStorage.setItem(t,JSON.stringify(l));sessionStorage.setItem(t,JSON.stringify(l));return l[s]}function r(t){var n=e();if(n[t])return n[t].analysis;return"not_found"}function l(n,a,s,o){var r=i(o);var l=e();r.tab="story";r.story={slideId:n,storyId:s,state:a};l[o]=r;localStorage.setItem(t,JSON.stringify(l));sessionStorage.setItem(t,JSON.stringify(l));return l[o]}function c(t){var n=e();if(n[t])return n[t].story;return"not_found"}function u(n,a){var s=i(a);var o=e();s.tab=n;o[a]=s;localStorage.setItem(t,JSON.stringify(o));sessionStorage.setItem(t,JSON.stringify(o));return o[a]}function d(t){var n=e();if(n[t])return n[t].tab;return"not_found"}return{isInSession:n,setData:a,data:s,setSheet:o,analysis:r,setStory:l,story:c,setTab:u,tab:d}}.apply(e,i),void 0!==a&&(t.exports=a))},184:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(127)],a=function(t,e){var n={a:65,alt:18,b:66,backspace:8,c:67,ctrl:17,d:68,del:46,down:40,e:69,end:35,f:70,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,enter:13,esc:27,g:71,h:72,home:36,i:73,insert:45,j:74,k:75,l:76,left:37,m:77,n:78,o:79,p:80,pagedown:34,pageup:33,q:81,r:82,right:39,s:83,shift:16,space:32,t:84,tab:9,u:85,up:38,v:86,w:87,win:224,x:88,y:89,z:90,cmd:91,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,0:48,"*":106},i="qvKeyboardShortcuts",a=false,s;function o(){this.groups=[];this.shortcuts=[];this.timer={id:null};this.isReleased=true;this.currentEvent=void 0}o.prototype.createGroup=function(t,e){var n=this,i,a;for(a=0;a<this.groups.length;a++)if(this.groups[a].name===t){i=this.groups[a];break}if(!i){i={name:t,priority:e,active:false,shortcuts:[]};this.groups.push(i);this.groups.sort(function(t,e){return t.priority-e.priority})}return{registerKeys:function t(e,a,s){n.registerKeys(i,e,a,s)},unregisterKeys:function t(e,n){var a=i.shortcuts;for(var s=0;s<a.length;s++)if(a[s].keyCombo===e&&a[s].callback===n){a.splice(s,1);break}},on:function t(){n.activateGroup(i)},off:function t(){n.deactivateGroup(i)},delete:function t(){n.deactivateGroup(i);n.deleteGroup(i)}}};o.prototype.activateGroup=function(e){var n=this;e.active=true;if(!a){a=true;t(document).on("keydown."+i,function(t){n.handleEvent(t)})}};o.prototype.deactivateGroup=function(e){var n;e.active=false;n=this.groups.reduce(function(t,e){e.active&&t++;return t},0);if(0===n&&a){a=false;t(document).off("keydown."+i)}};o.prototype.deleteGroup=function(t){this.groups=this.groups.filter(function(e){return e!==t})};o.prototype.registerKeys=function(t,e,i,a){var s=e.toLowerCase().split("+"),o={keyCombo:e,ctrlKey:false,shiftKey:false,altKey:false,keyCode:null,name:"",callback:null,allowInAllContexts:!!(a&&"allowInInput"in a)&&a.allowInInput,preventDefault:!(a&&"preventDefault"in a)||a.preventDefault,delay:a&&"delay"in a?a.delay:250};for(var r in n)for(var l=0;l<s.length;l++){o.name=e.toLowerCase();o.callback=i;"ctrl"!==s[l]&&"cmd"!==s[l]||(o.ctrlKey=true);"alt"===s[l]&&(o.altKey=true);"shift"===s[l]&&(o.shiftKey=true);s[l]===r&&17!==n[r]&&16!==n[r]&&91!==n[r]&&18!==n[r]&&(o.keyCode=n[r])}t.shortcuts.push(o)};o.prototype.preventDefault=function(){this.currentEvent&&this.currentEvent.preventDefault()};o.prototype.handleEvent=function(t){var i=this;this.currentEvent=t;function a(e,a,o,r){var l,c;for(var u=0;u<i.groups.length;u++){l=i.groups[u];if(l.active)for(var d=l.shortcuts.length-1;d>=0;d--){c=l.shortcuts[d];if((c.keyCode===n["*"]||c.keyCode===r&&c.ctrlKey===e&&c.shiftKey===a&&c.altKey===o)&&!s(t,c))break}}}function s(t,n){var i=e.isInput(document.activeElement);return!(i&&!n.allowInAllContexts)&&o(t,n)}function o(t,e){e.preventDefault&&t.preventDefault();if("number"!==typeof i.timer.id){e.delay>0&&(i.timer.id=setTimeout(function(){r()},e.delay));if(true===e.callback(e,t)){r();return true}}}function r(){clearTimeout(i.timer.id);delete i.timer.id}t.shiftKey?!t.ctrlKey&&!t.metaKey||t.altKey?t.ctrlKey||t.metaKey||!t.altKey?a(false,true,false,t.which):a(false,true,true,t.which):a(true,true,false,t.which):!t.ctrlKey&&!t.metaKey||t.altKey?t.ctrlKey||t.metaKey||!t.altKey?a(false,false,false,t.which):a(false,false,true,t.which):a(true,false,false,t.which)};s=new o;return s}.apply(e,i),void 0!==a&&(t.exports=a))},196:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){return{MEASURE:"measure",DIMENSION:"dimension",FIELD:"field",PUBSUB_TOPIC:"/cao/light-editing/swap"}}.apply(e,i),void 0!==a&&(t.exports=a))},202:function(t,e,n){"use strict";var i,a;!(i=[n(90),n(89),n(122),n(177),n(94),n(93),n(49),n(108),n(50)],a=function(t,e,n,i,a,s,o,r,l){function c(){var e=t.getParameterByName("app");var n=t.getParameterByName("sheet");var a=i.analysis(e);var s=a&&a.sheetId?a.sheetId:n;return{appId:e,sheetId:s}}function u(t){if(!r.inClient()||!o.getFlag("SSA_IN_EDIT")||l.isSmallDevice||t)return e.resolve("analysis");return s.getApp().then(function(t){return t.getLayout().then(function(t){var e=t&&t.permissions&&t.permissions.update;var n=e?a.States.edit:a.States.analysis;return a.getAllStateKeys()[n]})}).catch(function(){return e.resolve("analysis")})}function d(n,a){var s=i.analysis(t.getParameterByName("app"));if(r.inClient()&&s&&s.state&&!a)return e.resolve(s.state);return u(n)}function p(t,e,a,s){i.setSheet(t,e,a,s);n.goToSheet(t,e,s)}function h(e){var n=t.getParameterByName("app");var s=i.analysis(n).overlay;return s===a.getAllStateKeys()[e]}function g(){return o.getFlag("SSA_IN_EDIT")||a.state!==a.States.edit}function f(){return h(a.States.insight)}function v(){return h(a.States.selections)}function m(t,e,n){if(r.inClient()){var s=i.analysis(e).state;var o=a.getAllStateKeys()[n];s||u().then(function(n){p(t,n,e,o)});p(t,s,e,o)}}function b(t,e){if(r.inClient()){var n=i.analysis(e).state;n?p(t,n,e,null):u().then(function(n){p(t,n,e,null)})}}return{getCurrentSheetInfo:c,closeAnalysisOverlay:b,openAnalysisOverlay:m,getDefaultSheetViewState:u,getCurrentSheetViewState:d,shouldShowOverlay:g,isInInsightMode:f,isInSelectionsMode:v}}.apply(e,i),void 0!==a&&(t.exports=a))},207:function(t,e,n){"use strict";var i,a;!(i=[n(92),n(90),n(249),n(303)],a=function(t,e,n,i){var a=t.extend("SortableItemList",{init:function t(e,n){this.items=[];this.disabled=false;this.typeFlag=e||1;this.locked=false;Object.keys(n||{}).forEach(function(t){this[t]=n[t]},this)},addSortableItem:function t(e,n){Object.defineProperty(e,"__sortableItem__",{configurable:false,enumerable:true,writable:true,value:{typeFlag:n||1}});this.items.push(e)},moveItem:function t(e,n){this.items.splice(n,0,this.items.splice(e,1)[0])},getIndexByItem:function t(e){return this.items.indexOf(e)},get:function t(e){return this.items.filter(e||function(){return true})},getLockedIndices:function t(){return this.get(function(t){return!!(t.__sortableItem__.typeFlag&i.TYPEFLAG_LOCKED)}).map(function(t){return this.getIndexByItem(t)},this)},reset:function t(){this.items.length=0;this.disabled=false},isEmpty:function t(){return 0===this.items.length},setLocked:function t(e){this.locked=e}});Object.defineProperties(a.prototype,{length:{get:function t(){return this.items.length}}});var s=n.extend("SortableItemLists",{init:function t(){this._super.apply(this,arguments);this.lists=[];this.dragPlaceholder=null},addPlaceholder:function t(n){var a=this.getList(n),s=a?a.items.indexOf(n):-1;this.dragPlaceholder=e.extend(true,{},n);this.dragPlaceholder.id="placeholder";this.dragPlaceholder.__sortableItem__.typeFlag=i.TYPEFLAG_PLACEHOLDER;this.dragPlaceholder.style={opacity:"0.3"};a&&a.items.splice(s,0,this.dragPlaceholder);return this.dragPlaceholder},removePlaceholder:function t(){if(!this.dragPlaceholder)return;var e=this.getList(this.dragPlaceholder),n=e?e.items.indexOf(this.dragPlaceholder):-1;if(-1!==n){e.items.splice(n,1);this.dragPlaceholder=null}},getPlaceholder:function t(){return this.dragPlaceholder},createList:function t(e,n){var i=new a(e,n);this.lists.push(i);return i},reset:function t(){this.lists.forEach(function(t){t.reset()})},getList:function t(e){return this.lists.filter(function(t){return-1!==t.items.indexOf(e)})[0]},disable:function t(e){this.lists.forEach(function(t){t.disabled=!(e.__sortableItem__.typeFlag&t.typeFlag)})},enable:function t(){this.lists.forEach(function(t){t.disabled=false})},getIndexOfItem:function t(e){var n=this.getList(e);var i=n?n.items.indexOf(e):-1;return i},moveItem:function t(e,n){var i=this.getList(e),a=this.getList(n),s,o;if(!i||!a)return;o=a.items.indexOf(n);s=i.items.indexOf(e);i.items.splice(s,1);a.items.splice(o,0,e)},onBegin:function t(e,n){this.addPlaceholder(e,n);this.disable(e)},onEnter:function t(e,n){var a=this.getList(e),s=a.getLockedIndices();if(e===this.dragPlaceholder)return;if(n===i.ENTER_BEFORE||n===i.ENTER_AFTER){var o=this.getList(this.dragPlaceholder),r,l;if(!o||!a)return;r=o.getIndexByItem(this.dragPlaceholder);o.items.splice(r,1);l=a.getIndexByItem(e);l+=n===i.ENTER_AFTER?1:0;a.items.splice(l,0,this.dragPlaceholder)}else this.moveItem(this.dragPlaceholder,e);var c=a.getLockedIndices();s.forEach(function(t,e){a.moveItem(c[e],t)})},onEnterList:function t(e){if(e.disabled||e.locked)return;var n=this.getList(this.dragPlaceholder);if(!n)return;var i=n.getIndexByItem(this.dragPlaceholder);n.items.splice(i,1);e.items.push(this.dragPlaceholder)},onMove:function t(e){if(-1===this.getIndexOfItem(e)){this.onCancel();return false}var n=this.dragPlaceholder;this.moveItem(e,n);this.removePlaceholder();this.enable();return true},onMoveToList:function t(e,n){var i=this.getList(e);if(i&&!(n.disabled||n.locked)){var a=i.items.indexOf(e);if(i===n){this.onMove(e,this.dragPlaceholder);return true}i.items.splice(a,1);n.items.push(e)}this.removePlaceholder();this.enable();return!!i},onCancel:function t(){this.removePlaceholder();this.enable()},allowEnter:function t(e,n){var i=this.getList(e);return void 0!==i&&!i.disabled&&!i.locked&&!!(n.__sortableItem__.typeFlag&i.typeFlag)},allowEnterList:function t(e,n){return!e.disabled&&!e.locked&&!!(n.__sortableItem__.typeFlag&e.typeFlag)}});s.create=function(t){var e=s.extend(t||{});t=new e(t&&t.options);return t};return s}.apply(e,i),void 0!==a&&(t.exports=a))},2113:function(t,e){t.exports='<div class="qs-container" ng-keydown="keyDown($event)">\n    <div class="requirements-wrapper" ng-show="items.empty" qva-activate="onItemClick($event)"\n        ng-class="getEmptyItemClass()">\n        <div class="requirements">\n            <h2 class="header">\n                <i class="object-icon lui-icon lui-icon--box"></i>\n            </h2>\n            <button ng-if="showAdd" class="add-button lui-button" ng-click="showAddObjDialog($event)" q-translation="Object.Container.AddItem"></button>\n            <div ng-if="!showAdd" class="text hint-content" q-translation="Object.Container.EmptyHint"></div></div>\n    </div>\n    <div class="qsc-root" ng-show="!items.empty" qva-context-menu="showContextMenu($event)" qva-radial-context-menu="showRadialContextMenu($event)" ng-class="{ \'smallDevice\': isSmallDevice }">\n        <div qva-direction x-dir-setting="{{options.direction}}" class="qsc-tab-row" ng-if="items.showTabs">\n            <div qva-direction x-dir-setting="ltr" class="lui-button-group" ng-if="items.useScrollButton" ng-show="items.showScrollButtons()">\n                <button class="lui-button lui-buttongroup__button" tabindex="-1" ng-click="items.scrollTabs(-1)" ng-class="items.getLeftScrollButtonClass()">\n                    <span class="lui-icon  lui-icon--previous lui-button__icon"></span>\n                </button>\n                <button class="lui-button lui-buttongroup__button" tabindex="-1" ng-click="items.scrollTabs(1)" ng-class="items.getRightScrollButtonClass()">\n                    <span class="lui-icon  lui-icon--next lui-button__icon"></span>\n                </button>\n            </div>\n            <ul qva-direction x-dir-setting="{{options.direction}}" class="lui-tabset" role="tablist" ng-if="!isSmallDevice">\n                <li class="lui-tab" tabindex="-1" role="tab" ng-repeat="tab in items.items track by $index"\n                    ng-show="$index < items.lastTab && $index >= items.firstTab" ng-click="setActiveId(tab.childId)"\n                    data-itemid="{{tab.childId}}" ng-class="{\'lui-active\': tab.childId === items.activeId}"\n                    aria-selected="{{tab.childId === items.activeId}}">\n                    <span ng-if="tab.icon" class="lui-icon lui-icon--{{tab.icon}}"></span>\n                    <span qva-direction x-dir-setting="{{options.direction}}" class="lui-tab__text" title="{{tab.label}}" x-dir-text="{{tab.label}}">{{tab.label}}</span>\n                </li>\n            </ul>\n            <button class="lui-button dropdown" tabindex="-1" ng-show="items.showDropdown()" ng-if="layout.useDropdown && !isSmallDevice"\n                ng-click="openTabDropdown($event)">\n                <span class="lui-button__icon  lui-icon  lui-icon--unordered-list"></span>\n            </button>\n            <ul qva-direction x-dir-setting="{{options.direction}}" class="lui-tabset" ng-if="isSmallDevice" role="listbox" ng-click="openTabDropdown($event)">\n                <li class="lui-tab single-tab" role="listitem" ng-repeat="tab in items.items track by $index"\n                    ng-show="tab.childId === items.activeId">\n                    <span ng-if="tab.icon" class="lui-icon lui-icon--{{tab.icon}}"></span>\n                    <span class="lui-tab__text">{{tab.label}}</span>\n                    <span class="lui-tab__icon lui-icon lui-icon--arrow-down"></span>\n                </li>\n            </ul>\n        </div>\n        <div class="qsc-item-wrapper" role="tabpanel" aria-label="{{items.activeLabel}}" ng-class="getItemClass()">\n            <div class="qsc-item" tabindex="-1"></div>\n            <qva-nav-menu options="cell.options" menu="cell.navMenu"></qva-nav-menu>\n            <qv-soft-property-panel object="cell.object" ng-if="cell.showExploreMenu && cell.object.hasSoftProperties"\n                can-save-soft-properties="cell.options.canSaveSoftProperties" ng-hide="!cell.showExploreMenu"\n                on-toggle="cell.toggleExploreMenu" show-explore-menu="cell.showExploreMenu"></qv-soft-property-panel>\n        </div>\n    </div>\n</div>'},2114:function(t,e){t.exports='<lui-popover x-arrow="arrow" class="qsc-popover">\n\t<div class="object-add-popover-content">\n\t\t<ul class="lui-list">\n\t\t\t<li class="qsc-popover-header" ng-show="hasMasterItems();" q-translation="Object.Container.MasterItems"></li>\n\t\t\t<li ng-repeat="item in input.items" ng-if="item.qExtendsId" class="lui-list__item  lui-list__action"\n\t\t\t\tng-click="input.select($event, item); $event.stopPropagation();">\n\t\t\t\t<span ng-if="item.icon" ng-class="item.icon" class="lui-icon lui-list__aside"></span>\n\t\t\t\t<span class="lui-list__text">{{item.name}}</span>\n\t\t\t</li>\n\t\t\t<li class="qsc-popover-header" q-translation="Common.Charts"></li>\n\t\t\t<li ng-repeat="item in input.items" ng-if="!item.qExtendsId && !item.isThirdParty" class="lui-list__item  lui-list__action"\n\t\t\t\tng-click="input.select($event, item); $event.stopPropagation();">\n\t\t\t\t<span ng-if="item.icon" ng-class="item.icon" class="lui-icon lui-list__aside"></span>\n\t\t\t\t<span class="lui-list__text">{{item.name}}</span>\n\t\t\t</li>\n\t\t\t<li class="qsc-popover-header" ng-show="hasExtensions();" q-translation="Common.CustomObjects"></li>\n\t\t\t<li ng-repeat="item in input.items" ng-if="!item.qExtendsId && item.isThirdParty" class="lui-list__item  lui-list__action"\n\t\t\t\tng-click="input.select($event, item); $event.stopPropagation();">\n\t\t\t\t<span ng-if="item.icon" ng-class="item.icon" class="lui-icon lui-list__aside"></span>\n\t\t\t\t<span class="lui-list__text">{{item.name}}</span>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</lui-popover>'},2115:function(t,e){t.exports='<lui-popover x-arrow="arrow" class="qsc-dropdown" >\n\t<lui-popover-body >\n\t\t<ul class="lui-list">\n\t\t\t<li ng-repeat="item in input.items track by $index" class="lui-list__item  lui-list__action" ng-class="{\'lui-active\': item.childId === activeId}"\n\t\t\t ng-click="input.onClick(item); $event.stopPropagation();">\n\t\t\t\t<span class="lui-list__text">{{item.label}}</span>\n\t\t\t</li>\n\t\t</ul>\n\t</lui-popover-body>\n</lui-popover>'},2116:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={type:"array",translation:"Object.Container.Props.Content",ref:"children",itemTitleRef:function t(e){return e.label},allowAdd:true,customAdd:true,allowMove:true,allowRemove:true,addTranslation:"Object.Container.Props.Add",grouped:true,remove:function t(e,n,i){i.layout.qChildList.qItems.forEach(function(t){t.qData.containerChildId===e.refId&&i.removeChild(t.qInfo.qId)})},add:function t(e,n,i){i.addChild(document.querySelector(".pp-toplist-add-button"))},items:{label:{ref:"label",type:"string",translation:"Object.Container.Props.Label",expression:"optional"},condition:{ref:"condition",translation:"Object.Container.Props.ShowCondition",type:"string",defaultValue:"",expression:"optional",change:function t(e){e.condition&&!e.condition.qStringExpression&&(e.condition={qStringExpression:{qExpr:"="+e.condition}})}},editProps:{component:"button",translation:"Object.Container.Props.EditProperties",action:function t(e,n){n.editProps(e.refId)},show:function t(e){return!e.isMaster}},editMasterHeader:{component:"text",style:"sHeader",translation:"Object.Linked.NoEdit.PropPanel.Title",show:function t(e){return e.isMaster}},editMasterText:{component:"text",translation:"Object.Linked.Edit.PropPanel.Text",show:function t(e){return e.isMaster}},editMaster:{component:"button",translation:"Object.Container.Props.Edit",action:function t(e,n){n.editMasterProps(e.refId)},show:function t(e){return e.isMaster}}}};var e={uses:"settings",items:{general:{items:{showTitles:{defaultValue:false}}},container:{type:"items",translation:"Object.Container.Props.Container",items:{showTabs:{type:"boolean",translation:"Object.Container.Props.ShowTabs",ref:"showTabs",defaultValue:true,component:"switch",options:[{value:true,translation:"properties.on"},{value:false,translation:"properties.off"}]},useDropdown:{type:"boolean",translation:"Object.Container.Props.UseDropdown",label:"Menu",ref:"useDropdown",component:"switch",options:[{value:true,translation:"Common.Auto"},{value:false,translation:"properties.off"}],defaultValue:true,show:function t(e){return e.showTabs}},useScrollButton:{type:"boolean",translation:"Object.Container.Props.UseScrollButtons",ref:"useScrollButton",component:"switch",options:[{value:true,translation:"Common.Auto"},{value:false,translation:"properties.off"}],defaultValue:true,show:function t(e){return e.showTabs}},showIcons:{type:"boolean",translation:"Object.Container.Props.ShowIcons",ref:"showIcons",component:"switch",options:[{value:true,translation:"properties.on"},{value:false,translation:"properties.off"}],defaultValue:false,show:function t(e){return e.showTabs}}}}}};return{type:"items",component:"accordion",defaultActiveTabIndex:0,items:{items:t,settings:e}}}.apply(e,i),void 0!==a&&(t.exports=a))},2117:function(t,e,n){"use strict";var i,a;!(i=[n(238)],a=function(t){var e=t.extend({init:function t(e){this._super(e);this.removeChild=e.removeChild;this.addChild=e.addChild;this.editProps=e.editProps;this.editMasterProps=e.editMasterProps},getDimensions:function t(){return[]},getMeasures:function t(){return[]}});return e}.apply(e,i),void 0!==a&&(t.exports=a))},2118:function(t,e,n){"use strict";var i,a;!(i=[n(119),n(167),n(89),n(50),n(94),n(247),n(123),n(114)],a=function(t,e,n,i,a,s,o,r){function l(t,e){var n="big",i="border white";return{active:false,visible:false,items:[{translation:"contextMenu.takeSnapshot",tid:"nav-menu-snapshot",cssClasses:"lui-icon lui-icon--camera",dynamicCssClasses:function a(){var s=e.isZoomed()?n:i;t.snapshot.dialogOpen&&(s+=" blue");return s},isVisible:function e(){return t.snapshot.dialogOpen},action:function t(){}}]}}function c(t,e){this.container=t;this.canInsert=true;this.helper=e;this.zoom=function(t){this.helper.zoom(t);this.zoomCell&&this.zoomCell.zoom(false);t&&t.zoom(true);this.zoomCell=t};this.isZoomed=e.isZoomed;this.hasUpdatePermission=e.permissions.update;this.gridService={activateCell:function t(e){console.log("activate cell",e)},removeCell:function t(){e.remove()},isBlocked:function t(){return false},addObject:function t(n){return e.addObject(n)}};this.toggleActive=function(t){var e=this;if(!a.isInEditMode())return;e.clearActiveCell();if(t&&!t.isEmpty&&e.hasUpdatePermission){e.activeCell=t;t.options.isActive=true}e.setCellSelected(t)};this.clearActiveCell=function(){if(this.activeCell){this.activeCell.options.isActive=false;this.activeCell=null}this.setCellSelected()};this.isActive=e.isActive;this.setCellSelected=e.setCellSelected}function u(e,i,u,d){this.container=e;this.object=i;this.$element=u;this.grid=new c(e,d);this.isEmpty=true;this.navMenu=l(this,this.grid);this.getVisualization=function(){return n.resolve(this.object)};var p=this;p.updateState=function(){var t=a.state===a.States.edit?o.EDIT:o.ANALYSIS;p.object&&p.object.setInteractionState&&p.object.setInteractionState(t)};a.StateChanged.bind(p.updateState);p.updateDirection=function(t){p.object&&p.object.setDirection&&p.object.setDirection(t)};r.DirectionChanged.bind(p.updateDirection);var h={showCounter:false,snapshotCount:0,isAnnotating:false,dialogOpen:false,snapshotTimer:null,updateCount:function t(){s.getNumberOfSnapshots(p.object.id).then(function(t){h.snapshotCount=t;h.disabledSave=false})},openAnnotation:function e(n){var i=t.getService("$timeout");h.dialogOpen=true;h.disabledSave=true;return i(function(){var e=p.$element.parent().find(".qv-object-nav .lui-icon--camera");return t.getService("annotationsDialog").openDialog(e,h.closeAnnotation,n,function(){return h.disabledSave})})},closeAnnotation:function t(){h.dialogOpen=false;h.isAnnotating=false},take:function t(e,i){var a;if(p.object.supportSnapshot()){a=e?h.openAnnotation(i):n.resolve();a.then(function(t){if(e){p.navMenu.active=true;p.navMenu.visible=true;h.isAnnotating=true}s.createSnapshot(p.object,u).then(function(n){h.updateCount();e&&(t.currentAnnotationId=n)})})}},openLibrary:function e(n,i){n.stopImmediatePropagation();t.getService("storyItemsLibrary").openPopover({event:n,library:"snapshot",objectId:p.object.id,isZoomed:i})}};this.snapshot=h;this.removeIt=function(){d.remove()};this.$element.on("qv-activate",function(){p.grid.toggleActive(p)})}u.prototype.setObject=function(t,e){this.object=t;this.model=t?t.model:void 0;this.id=t?t.model.id:void 0;this.isEmpty=!t;this.options=e;if(this.options){this.options.canSaveSoftProperties=!i.isSmallDevice&&this.grid.hasUpdatePermission;this.options.removeIt=this.removeIt}this.isEmpty||this.updateState()};u.prototype.zoom=function(t){this.grid.zoomCell=t?this:null;t||(this.showExploreMenu=false)};u.prototype.toggleExploreMenu=function(t){this.showExploreMenu=void 0!==t?t:!this.showExploreMenu;return this.showExploreMenu};u.prototype.focus=function(){this.$element.focus()};u.prototype.keyDown=function(t){if(!this.object.isInvalid)switch(t.which){case e.ENTER:case e.SPACE:if(t.shiftKey)if(this.grid.zoomCell)this.grid.zoom(null);else{this.grid.zoom(this);this.object.focus&&this.object.focus()}else{var n=!this.object.viewDataToggled&&this.object.supportViewData();n?this.object.toggleDataView().then(function(){}):this.object.viewDataToggled&&"function"===typeof this.object.dataViewObject.focus?this.object.dataViewObject.focus():"function"===typeof this.object.focus&&this.object.focus()}t.stopImmediatePropagation();t.preventDefault();break;case e.ESCAPE:this.object.viewDataToggled?this.object.toggleDataView():this.container.focus(true);t.preventDefault();t.stopPropagation();break}};u.prototype.destroy=function(){this.$element.off("qv-activate");a.StateChanged.unbind(this.updateState);r.DirectionChanged.unbind(this.updateDirection)};return u}.apply(e,i),void 0!==a&&(t.exports=a))},2119:function(t,e,n){"use strict";var i,a;!(i=[n(115),n(103),n(1749)],a=function(t,e,n){function i(t,n){e.trackEvent(t,n)}function a(e){var n=t.getLibraryInfo(e);return n?n.isThirdParty:void 0}var s={};var o={};s.trackAddChart=function(t,n,s){var o={container_id:t,chart_type:n.visualization,chart_id:s,chart_isThirdParty:a(n.visualization),chart_isMaster:!!n.qExtendsId};i(e.customEvents.CONTAINER_ADD_CHART,o)};s.trackRemoveChart=function(t,n,s){var o={container_id:t,chart_type:n.qData.visualization,chart_id:s,chart_isThirdParty:a(n.qData.visualization),chart_isMaster:!!n.qData.qExtendsId};i(e.customEvents.CONTAINER_REMOVE_CHART,o)};s.trackRenderContainer=function(t,s){if(o[t.qInfo.qId])return;o[t.qInfo.qId]=true;var r={container_id:t.qInfo.qId,objects:t.qChildList.qItems.map(function(e,i){return{chart_type:e.qData.visualization,chart_id:e.qInfo.qId,chart_isThirdParty:a(e.qData.visualization),chart_isMaster:!!e.qData.qExtendsId,tab_isVisible:n.evaluateCondition(t.children[i]),tab_isActive:e.qInfo.qId===s}})};i(e.customEvents.CONTAINER_RENDERED,r)};s.trackSetActive=function(t,n){var s=n.items.filter(function(t){return t.childId===n.activeId});s=s.length>0?s[0]:{};var o={container_id:t,chart_type:s.visualization,chart_id:n.activeId,chart_isThirdParty:a(s.visualization)};i(e.customEvents.CONTAINER_SET_ACTIVE,o)};return s}.apply(e,i),void 0!==a&&(t.exports=a))},212:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(10),n(95),n(48),n(909),n(94),n(140),n(184),n(103),n(168),n(155),n(49),n(89),n(202),n(223),n(176),n(175)],a=function(t,e,n,i,a,s,o,r,l,c,u,d,p,h,g){i.service("qvCaoService",["$document","qvSelectionToolbarService","qvGlobalSelectionsService","qvCaoSelectionService",function(i,f,v,m){var b,S,y;var I=300;var x=new c;var q=new u;var w=false;var C=d.getFlag("CE_PRECEDENTS");var P,T;y=r.createGroup("cao",1);y.registerKeys("ctrl+left",r.preventDefault);y.registerKeys("ctrl+home",r.preventDefault);y.registerKeys("ctrl+right",r.preventDefault);y.registerKeys("ctrl+end",r.preventDefault);y.registerKeys("ctrl+e",r.preventDefault);y.registerKeys("ctrl+c",r.preventDefault);y.registerKeys("ctrl+x",r.preventDefault);y.registerKeys("ctrl+v",r.preventDefault);y.registerKeys("ctrl+z",r.preventDefault);y.registerKeys("ctrl+y",r.preventDefault);y.registerKeys("cmd+shift+z",r.preventDefault);y.registerKeys("del",r.preventDefault);y.registerKeys("ctrl+f",r.preventDefault);y.registerKeys("backspace",r.preventDefault);y.registerKeys("esc",r.preventDefault);y.registerKeys("ctrl+shift+left",E);y.registerKeys("ctrl+shift+right",k);function A(){return{$container:void 0,$containerId:".qv-cao-container",getComponent:function t(){return a},setup:function t(){o.get().then(function(t){s.StateChanged.bind(D);t.enigmaModel.isInModalSelection()&&f.confirm()})},destroy:function t(){s.StateChanged.unbind(D)}}}function D(){(s.isInEditMode()||s.isInAnalysisMode()||s.inObjectView())&&O()}function E(){o.get().then(function(t){g.toggleAssetsPanel(t.id);n.publish("cao/insight/assetsPanelToggled",g.storageObj(t.id).assetsPanel)})}function k(){o.get().then(function(t){g.toggleContextPanel(t.id);n.publish("cao/insight/contextPanelToggled",g.storageObj(t.id).contextPanel)})}function M(n){y.on();S.$container=e.element("<div>");n=n||i;n.find(S.$containerId).append(S.$container);S.$container.showComponent(S.getComponent());S.setup();v.setCaoActive(true);t(".qv-cao").slideDown(I)}function $(){return!(!S||void 0===S.$container)}function O(){y.off();if(!S)return;t(".qv-cao").slideUp(I,function(){if(S.$container){S.$container.remove();S.$container=void 0}S.destroy();S=null;v.setCaoActive(false)})}b={isCaoOpen:$,toggleCao:function t(e){var n=h.getCurrentSheetInfo();m.clearSelection();S||(S=new A);if($()){O();h.closeAnalysisOverlay(n.sheetId,n.appId);l.trackEvent(l.customEvents.INSIGHTS_CLICKED,{type:"close"});return false}h.openAnalysisOverlay(n.sheetId,n.appId,s.States.insight);M(e);w=false;l.trackEvent(l.customEvents.INSIGHTS_CLICKED,{type:"open"});return true},off:function t(){l.trackEvent(l.customEvents.INSIGHTS_CLICKED,{type:"off"});O()},scrapeApp:function t(){if(C){if(P)return T;P=true;T=x.scrapeApp().then(function(){P=false});return T}return(new p).resolve()},setRefreshIndicatorVisibility:function t(e){w=e},getRefreshIndicatorVisibility:function t(){return w},isInsightsAvailable:function t(){var e=new p;q.isRunning().then(function(){e.resolve(true)},function(){e.resolve(false)});return e.promise}};return b}])}.apply(e,i),void 0!==a&&(t.exports=a))},2120:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(115),n(99),n(128)],a=function(t,e,i,a){var s=false;var o;function r(i,r,c,u){i.stopImmediatePropagation();if(s){s=false;return}o=o||t.getService("qvContextMenu");var d=o.menu(),p=a.getGrid();if(p){var h=n(1314);var g=a.getModel(),f=p.cells.filter(function(t){return t.id===r.model.id});if(f.length<1)return;f=f[0];h.getObjectMenu(g,p,f,i).then(function(t){if(t.items.length>0){var n=d.addItem({translation:"Object.Container",tid:"container-menu",icon:"box"});t.items.forEach(function(t){n.addItem(t)})}if(c){var a=e.getType(c.layout.visualization),s=a.getLibraryInfo();h.getObjectMenu(g,u.grid,u,i).then(function(t){var e=r.model.layout.qExtendsId?["link","unlink","paste","cut","bin"]:["link","unlink","paste"];var n=t.items.filter(function(t){return e.indexOf(t.icon)<0});if(n.length>0){var o=d.items.length>0?d.addItem({translation:s.translationKey,label:s.name,tid:"child-menu",icon:a.getIconName()}):d;n.forEach(function(t){o.addItem(t)})}l(d,i)})}})}else{c.getContextMenu&&c.getContextMenu(d,i);c.supportViewData()&&d.addItem({translation:c.viewDataToggled?"contextMenu.viewSource":"contextMenu.viewData",icon:c.viewDataToggled?"back":"table",select:function t(){c.toggleDataView()}});c.supportExportData()&&("function"===typeof c.ext.getExportRawDataOptions?c.ext.getExportRawDataOptions.call(this,d,c):d.addItem({translation:"contextMenu.export",tid:"export",icon:"export",select:function e(n){t.getService("$exportDialog").show(c.model,void 0,n)}}));l(d,i)}}function l(t,e){var n={position:{x:e.pageX,y:e.pageY}};"keydown"===e.type?o.showInline(t,n,e.currentTarget):o.show(t,n)}function c(t,e,o,r){t.stopImmediatePropagation();if(!i.treatAsDesktop()){s=true;var l=n(1314);l.onCellRadialContextMenu(t,r,a.getModel(),r.grid)}}return{showContextMenu:r,showRadialContextMenu:c}}.apply(e,i),void 0!==a&&(t.exports=a))},220:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(155),n(89),n(94),n(91),n(54),n(154),n(147),n(246),n(363),n(273),n(142),n(93),n(275),n(271)],a=function(t,e,n,i,a,s,o,r,l,c,u,d,p){t.service("qvSelectionInsightsService",["qvCaoSearchService","qvCurrentSelectionsService",function(t,h){var g;var f=new e;var v=new l(a.localeDetected,"","","","numeric");var m={};var b=2e4;var S="$";function y(t){return v.format(t,"#.#A")}function I(t){var e=parseFloat(t.toFixed(3));return new Intl.NumberFormat(a.localeDetected,{style:"percent",maximumSignificantDigits:3,minimumSignificantDigits:1}).format(parseFloat(e))}function x(t){var e="";var n=t.measureAggregation;if("avg"==n){var i=y(t.excludedMeasure.qNumber);e=a.get("SelectionInsights.CardSummaryAvg",[i])}else e=Number.isNaN(+t.excludedMeasurePercentage.toFixed(1))?"NaN":a.get("SelectionInsights.CardSummarySum",[I(t.excludedMeasurePercentage.toFixed(1)/100)]);return e}function q(t){var e=t.counts.excluded+t.counts.included;var n=t.counts.excluded;var i=t.measureBreakdown.excluded.num;return n>1?a.get("SelectionInsights.InsightSummaryExcludedLongMulti",[n,e,"<span class='dimLabelDesc'>"+t.dimension+"</span>","<span>"+i+"</span>","<span>"+t.measure+"</span>","<span>"+(t.measureAggregation[0].toUpperCase()+t.measureAggregation.slice(1))+"</span>"]):a.get("SelectionInsights.InsightSummaryExcludedLongSingle",[n,e,"<span class='dimLabelDesc'>"+t.dimension+"</span>","<span>"+i+"</span>","<span>"+t.measure+"</span>","<span>"+(t.measureAggregation[0].toUpperCase()+t.measureAggregation.slice(1))+"</span>"])}function w(t,e){var i=new n;var s={};var o=true;s.counts={};s.counts.excluded=parseFloat(e.analysis.numExcluded);s.counts.included=parseFloat(e.analysis.distinctCount)-parseFloat(e.analysis.numExcluded);s.counts.summary=a.get("SelectionInsights.CardCountsSummary",[s.counts.excluded,s.counts.excluded+s.counts.included,I(s.counts.excluded/(s.counts.excluded+s.counts.included))]);var r="";var l="";var c="";var u="";for(var d in e.analysis.matchRecord.matches){var p=e.analysis.matchRecord.matches[d];if("dimension"==p.slotRole){c=p.field||p.libIdLabel;u=p.libId}else{r=p.field||p.libIdLabel;l=Array.isArray(p.aggr)?p.aggr[0]:p.aggr}}s.dimension=c;s.measure=r;s.measureAggregation=l;s.dimensionId=u;var h=[];var g=t.evaluateEx(e.analysis.aggrMrsExcluded);h.push(g);var f=t.evaluateEx(e.analysis.aggrMrsTotal);h.push(f);var v=t.evaluateEx(e.analysis.aggrMrsIncluded);h.push(v);var S=t.evaluateEx(e.analysis.aggrMrs);h.push(S);var w=setTimeout(function(){var e=false;h.forEach(function(n){if(-1===n.$$state.status){e=true;t.global.cancelRequest(n.requestId).then(function(){})}});e&&i.reject()},b);n.all(h).then(function(t){var n=t[0];var a=t[1];var r=t[2];var l=t[3];s.excludedMeasurePercentage=n.qNumber/a.qNumber*100;s.includedMeasurePercentage=r.qNumber/a.qNumber*100;s.excludedMeasure=n;s.totalMeasure=a;s.includedMeasure=r;s.summaryString=x(s);s.excludedVis={dimension:e.analysis.dim,measure:e.analysis.aggrMrsExcluded};s.includedVis={dimension:e.analysis.dim,measure:e.analysis.aggrMrsIncluded};s.measureBreakdown={};s.measureBreakdown.excluded={num:y(n.qNumber),percentage:s.excludedMeasurePercentage.toFixed(1)};s.measureBreakdown.included={num:y(r.qNumber),percentage:s.includedMeasurePercentage.toFixed(1)};s.selectedMeasure={total:y(a.qNumber),selected:{num:y(l.qNumber),percentage:l.qNumber/a.qNumber*100,qNum:l.qNumber},excluded:{num:y(a.qNumber-l.qNumber),percentage:(a.qNumber-l.qNumber)/a.qNumber*100,qNum:a.qNumber-l.qNumber}};s.summaryStringLong=q(s);m[s.dimension].insight=s;clearTimeout(w);o=s.excludedMeasurePercentage+s.includedMeasurePercentage<100.01&&s.counts.included>=0&&s.counts.excluded>=0&&s.excludedMeasurePercentage+s.includedMeasurePercentage>99.9;s.show=o;i.resolve({show:o,summary:s.summaryString})}).catch(function(t){i.reject(t)});return i.promise}function C(t){return t.getObject(i.model.id).then(function(t){return t.getLayout().then(function(t){return t.qMeta.title})})}function P(t){var e=void 0;t||(e={scope:["libItems"]});return e}function T(t){b=t.runtimeSettings.suggestedTimeout;var e={};var n=null;if(!s.isEmpty(t.appRecommendations)){var i=t.appRecommendations[0].visualizations;var a=[];i.forEach(function(t){if("excludedCompareMsrSelector"!=t.analysis.analysis){var i=parseFloat(t.analysis.numExcluded)/parseFloat(t.analysis.distinctCount);var s=(parseFloat(t.analysis.distinctCount)-parseFloat(t.analysis.numExcluded))/parseFloat(t.analysis.distinctCount);var o="";var r="";var l="";for(var c in t.analysis.matchRecord.matches){var u=t.analysis.matchRecord.matches[c];if("dimension"==u.slotRole)l=u.field||u.libIdLabel;else{o=u.field||u.libIdLabel;r=u.aggr}}var d=true;(0===i||0===s||"avg"!=r&&"sum"!=r)&&(d=false);a.indexOf(l)>-1&&(d=false);if(d){a.push(l);e[l]={vis:t,measure:o,measureAggregation:r}}else;}else for(var p in t.analysis.matchRecord.matches){var h=t.analysis.matchRecord.matches[p];"measure"==h.slotRole&&(n=h.field||h.libIdLabel)}})}return{insights:e,measure:n}}function A(t,e){var n=P(t);var i=[];var s=false;if(void 0!=e)if(e.masterItem){i.push(e.libId);s=true}else i.push(e.qName);return f.getExcludedCompareVisualizations(i,n,s).then(function(t){if(t.__report.appDataModel.memberSelectionDone)return T(t);throw{error:a.get("SelectionInsights.Unsupported")}})}function D(e){var n=[];return e?o.getList().then(function(t){return t.getLayout()}).then(function(t){var e=t.filter(function(t){return t.qTags&&(-1===t.qTags.indexOf("$date")||-1===t.qTags.indexOf("$timestamp"))&&-1===t.qTags.indexOf("$geopoint")&&(t.qTags.indexOf("$numeric")>-1||t.qTags.indexOf("$integer")>-1)});n=n.concat(e);return E()}).then(function(e){n=n.concat(e);var i=t.sortFields(n);return i}):E().then(function(e){var n=t.sortFields(e);return n})}function E(){return r.getList().then(function(t){return t.getLayout().then(function(t){var e=t.map(function(t){return{qName:t.qData.title,classifications:["measure"],masterItem:true,libId:t.qInfo.qId,libIdLabel:t.qMeta.title}});return e})})}function k(t){if(t&&t.selectionsInStates){var e=[];t.selectionsInStates.forEach(function(t){t.qSelectionObject.qSelections.forEach(function(e){e.stateName=t.stateName});e=e.concat(t.qSelectionObject.qSelections)});var n=e.filter(function(t){return!t.qIsHidden});n.forEach(function(t){t.translation=h.translate(t);t.screenReaderLabel=h.translatedScreenReaderLabel(t);t.name=t.qReadableName||t.qField;t.displayStateName=t.stateName===S?a.get(u.DEFAULT_STATE_TRANSLATION):t.stateName});var i=c.groupSelectionsByField(n);var s=i.filter(function(t){return!t.isSingleState});s.forEach(function(t){t.translation=h.translate(t);t.screenReaderLabel=h.translatedScreenReaderLabel(t)});i=i.sort(d.sortSelections);return i}}function M(t,e){var n={qHyperCubeDef:{qDimensions:[{qDef:{qFieldDefs:[e?t.excludedVis.dimension:t.includedVis.dimension],qFieldLabels:[t.dimension]},qNullSuppression:true}],qMeasures:[{qDef:{qDef:e?t.excludedVis.measure:t.includedVis.measure,qLabel:t.measureAggregation[0].toUpperCase()+t.measureAggregation.slice(1)+"("+t.measure+")",qNumFormat:{qType:"F",qnDec:2,qUseThou:0,qFmt:"#,##0.00",qDec:".",qThou:","}},qSortBy:{qSortByAscii:-1}}],qInterColumnSortOrder:[1,0],qInitialDataFetch:[{qTop:0,qHeight:500,qLeft:0,qWidth:2}],columnOrder:[0,1],columnWidths:[197,230],qSuppressMissing:true,qReductionMode:"N",qMode:"S",qPseudoDimPos:-1,qNoOfLeftDims:-1,qMaxStackedCells:5e3},qInfo:{qId:"",qType:"visualization"},visualization:"table"};return p.getApp().then(function(t){return t.enigmaModel.createSessionObject(n).then(function(t){return t})})}function $(t){if(t&&t.selectionsInStates){var e=c.getAllSelectionsInStates(t);var n=e.filter(function(t){return true===t.qOneAndOnlyOne}).map(function(t,e){return"<strong>"+(e?" ":"")+t.name+"</strong>"});if(n.length>0)return{isOneAndOnlyOne:true,items:n};return false}return false}function O(t){if(t&&t.selectionsInStates){var e=c.getAllSelectionsInStates(t);if(e.filter(function(t){return true===t.qLocked}).length>0)return true;return false}return false}g={getSheet:function t(e){return C(e).then(function(t){return t})},getInsightDimensions:function t(e,n){return A(e,n).then(function(t){m={};m=t.insights;var e=[];for(var n in m){var i={};i.excluded=parseFloat(m[n].vis.analysis.numExcluded);i.included=parseFloat(m[n].vis.analysis.distinctCount)-parseFloat(m[n].vis.analysis.numExcluded);i.summary=a.get("SelectionInsights.CardCountsSummary",[i.excluded,i.excluded+i.included,I(i.excluded/(i.excluded+i.included))]);e.push({dimension:n,counts:i,measure:m[n].measure,measureAggregation:m[n].measureAggregation,show:true})}return{insights:e,measure:t.measure}}).catch(function(t){throw t})},getInsightSummary:function t(e,n){var i=m[e].vis;return w(n,i).then(function(t){return t})},getInsightDetails:function t(e){return m[e].insight},clearInsights:function t(){m={}},getMeasures:function t(e){return D(e).then(function(t){return t})},getLocalizedPercentage:function t(e){return I(e)},getSelectionItems:function t(e){return k(e)},getTableVis:function t(e,n){return M(e,n).then(function(t){return t})},isOneAndOnlyOne:function t(e){return $(e)},isHasLockedSelections:function t(e){return O(e)}};return g}])}.apply(e,i),void 0!==a&&(t.exports=a))},221:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(89),n(155),n(406),n(367),n(876),n(877),n(880),n(368)],a=function(t,e,n,i,a,s,o,r){t.service("qvCaoChartService",["qvCaoComplexityEstimatorService",function(t){var l;var c;var u=new n;function d(t,e,n){n.title=t;return i.createChart(n,e,false).then(function(t){return{model:t}})}function p(t){if(c)return f(c.app,c.searchPhrase,c.libItems,t);return e.reject({norefresh:true})}function h(t,e,n){var i=[];e.forEach(function(e){i.push(o.generateChartPropertiesForRecommendation(e.visualization,n).then(function(n){e.visualization=new a(e.visualization,t.__report,n);return e}))});return i}function g(n,i){var a=[];var o=3e3;n.runtimeSettings&&n.runtimeSettings.suggestedTimeout&&(o=n.runtimeSettings.suggestedTimeout);n.appRecommendations.forEach(function(e){e.recAnalyses.forEach(function(e){if("fact"===e.analysis.analysis&&1!==e.relevance)return;var n={relevance:e.relevance,suggestedTimeout:o,visualization:e,complexity:t.estimateComplexity(e,i)};a.push(n)})});return e.all(h(n,a,i)).then(function(t){var e=[];n.appCharts&&n.appCharts.forEach(function(t){t.appearsOnSheets.length>0&&e.push({relevance:t.relevance,suggestedTimeout:o,visualization:new s(t.id,t.appearsOnSheets,n.__report,i),complexity:-1})});return{recommendations:t.map(function(t){return new r(t,i)}),chartMatches:e.map(function(t){return new r(t,i)})}})}function f(t,e,n,i){c={app:t,searchPhrase:e,libItems:n};var a={exploreSupplemental:["appInsights"]};var s={};n&&(s={scope:["libItems"]});"boolean"===typeof i&&false===i&&(s.appPrecedents="skip");return u.getInsightRecommendations(e,a,true,[],s).then(function(e){return g(e,t)})}function v(t,e,n){c={app:t,searchPhrase:"",libItems:n};var i={exploreSupplemental:["appInsights"]};var a;n&&(a={scope:["libItems"]});return u.getVisRecommendations(e,true,i,[],a).then(function(e){return g(e,t)})}function m(t,e,n){return d(t,e,n)}function b(t,e){var n=t.matchRecord;var i=t.analysis.analysis;return u.adaptMatchRecord("update",n,i).then(function(n){n[0].analysis={analysis:n[0].analysis,analysisGroup:n[0].analysisGroup,dims:n[0].dims,msrs:n[0].msrs,titleTemplate:n[0].titleTemplate};return o.generateChartPropertiesForRecommendation(n[0],e).then(function(e){return{properties:e,analysis:n[0].analysis,matchRecord:t.matchRecord}})})}l={getInsights:f,getVisualRecommendations:v,refreshInsights:p,buildInsightChart:m,adaptRecommendation:b};return l}])}.apply(e,i),void 0!==a&&(t.exports=a))},222:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={resizeCharts:function t(e){if("function"===typeof Event)e.dispatchEvent(new Event("resize"));else{var n=e.document.createEvent("UIEvents");n.initUIEvent("resize",true,false,e,0);e.dispatchEvent(n)}}};return t}.apply(e,i),void 0!==a&&(t.exports=a))},223:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t="qCaoStorageObj";function e(){var e=JSON.parse(sessionStorage.getItem(t));null===e&&(e=JSON.parse(localStorage.getItem(t))||{});return e}function n(e){var n=JSON.parse(localStorage.getItem(t))||{};if(!n||!n[e]){n[e]={contextPanel:true,assetsPanel:true};sessionStorage.setItem(t,JSON.stringify(n));localStorage.setItem(t,JSON.stringify(n));return n[e]}return n[e]}var i={storageObj:function t(e){return n(e)},toggleContextPanel:function n(i){var a=e(i);a[i].contextPanel=!a[i].contextPanel;localStorage.setItem(t,JSON.stringify(a));sessionStorage.setItem(t,JSON.stringify(a));return a},toggleAssetsPanel:function n(i){var a=e(i);a[i].assetsPanel=!a[i].assetsPanel;localStorage.setItem(t,JSON.stringify(a));sessionStorage.setItem(t,JSON.stringify(a));return a}};return i}.apply(e,i),void 0!==a&&(t.exports=a))},246:function(t,e,n){"use strict";var i,a;!(i=[n(92),n(90),n(405)],a=function(t,e,n){var i,a={3:"k",6:"M",9:"G",12:"T",15:"P",18:"E",21:"Z",24:"Y","-3":"m","-6":"μ","-9":"n","-12":"p","-15":"f","-18":"a","-21":"z","-24":"y"},s=/%$/,o=/^\(r(0[2-9]|[12]\d|3[0-6])\)/i,r=/^\(oct\)/i,l=/^\(dec\)/i,c=/^\(hex\)/i,u=/^\(bin\)/i,d=/^\(rom\)/i,p=/^(\(rom\)|\(bin\)|\(hex\)|\(dec\)|\(oct\)|\(r(0[2-9]|[12]\d|3[0-6])\))/i;function h(t,e,n,i){t=t.toString(e);n[1]===n[1].toUpperCase()&&(t=t.toUpperCase());t.length-t.indexOf(".")>10&&(t=t.slice(0,t.indexOf(".")+11));return t.replace(".",i||".")}function g(t,e,n){var i;if(o.test(e))t=h(t,Number(/\d{2}/.exec(e)[0]),e,n);else if(r.test(e))t=h(t,8,e,n);else if(l.test(e))t=h(t,10,e,n);else if(c.test(e))t=h(t,16,e,n);else if(u.test(e))t=h(t,2,e,n);else if(d.test(e)){i="";if(t<0){i="-";t=-t}t=Math.floor(t);if(0===t)t="0";else if(t<=5e5){t=f(t,e);t=i+t}else t=e+i+t.toExponential(0)}return t}function f(t,e){var n,i="",a=Number(String(t).slice(-3)),s=(t-a)/1e3,o=[0,1,4,5,9,10,40,50,90,100,400,500,900].reverse(),r=["0","I","IV","V","IX","X","XL","L","XC","C","CD","D","CM"].reverse();while(a>0)for(n=0;n<o.length;n++)if(o[n]<=a){i+=r[n];a-=o[n];break}for(n=0;n<s;n++)i="M"+i;e[1]!==e[1].toUpperCase()&&(i=i.toLowerCase());return i}function v(t){if(!t||!t.qNumericalAbbreviation)return a;var e={};var n=t.qNumericalAbbreviation.split(";");n.forEach(function(t){var n=t.split(":");2===n.length&&(e[n[0]]=n[1])});return e}i=t.extend("NumberFormatter",{init:function t(e,n,i,a,s){this.localeInfo=e;this.pattern=n;this.thousandDelimiter=i||",";this.decimalDelimiter=a||".";this.type=s||"numeric";this.abbreviations=v(e);this.prepare()},clone:function t(){var e=new i(this.localeInfo,this.pattern,this.thousandDelimiter,this.decimalDelimiter,this.type);e.subtype=this.subtype;return e},format:function t(e,n,i,a){this.prepare(n,i,a);return this.formatValue(e)},prepare:function t(e,n,i){var a,s;"undefined"===typeof e&&(e=this.pattern);"undefined"===typeof n&&(n=this.thousandDelimiter);"undefined"===typeof i&&(i=this.decimalDelimiter);if(!e){this._prepared={pattern:false};return}this._prepared={positive:{d:i,t:n,abbreviate:false,isFunctional:false,prefix:"",postfix:""},negative:{d:i,t:n,abbreviate:false,isFunctional:false,prefix:"",postfix:""}};a=this._prepared;e=e.split(";");a.positive.pattern=e[0];a.negative.pattern=e[1];p.test(e[0])&&(a.positive.isFunctional=true);e[1]?p.test(e[1])&&(a.negative.isFunctional=true):a.negative=false;s=a.positive.isFunctional&&(!a.negative||a.negative&&a.negative.isFunctional);if(!s){m(a.positive,n,i);a.negative&&m(a.negative,n,i)}},formatValue:function t(e){var i=this._prepared,a,s,o="",r,l,c="",u,d,p,h,f;if(Number.isNaN(+e))return e;if(false===i.pattern)return e.toString();if(e<0&&i.negative){i=i.negative;e=-e}else i=i.positive;u=i.d;d=i.t;if(i.isFunctional)e=g(e,i.pattern,u);else{i.percentage&&(e*=100);if(i.abbreviate){var v=this.abbreviations;var m=Object.keys(v).map(function(t){return parseInt(t)}).sort(function(t,e){return t>e?1:-1});var b;var S=m[0];p=0;s=Number(Number(e).toExponential().split("e")[1]);while(S<=s&&p<m.length){p++;S=m[p]}p>0&&(b=m[p-1]);var y;b&&s>0&&b>0?y=b:(s<0&&b<0||!b)&&(S<0&&S-s<=i.maxPrecision?y=S:b<=s&&!(S>0&&-s<=i.maxPrecision)&&(y=b));if(y){o=v[y];e/=Math.pow(10,y)}}r=Math.abs(e);a=i.temp;h=i.numericPattern;f=h.split(u)[1];"I"===this.type&&(e=Math.round(e));l=e;if(f||"#"!==h.slice(-1)[0])if(r>=1e15||r>0&&r<=1e-14)e=r?r.toExponential(15).replace(/\.?0+(?=e)/,""):"0";else{var I=Number(e.toFixed(Math.min(20,f?f.length:0)).split(".")[0]);var x=h.split(u)[0];x+=u;e=n(x,I)||"0";if(f){var q=Math.max(0,Math.min(14,f.length));var w=f.replace(/#+$/,"").length;var C=Number((r%1).toPrecision(q)).toFixed(q);C=C.slice(2).replace(/0+$/,"");for(p=C.length;p<w;p++)C+="0";C&&(e+=u+C)}else 0===I&&(l=0)}else if(r>=Math.pow(10,a)||r<1||r<1e-4)if(0===e)e="0";else if(r<1e-4||r>=1e20){e=l.toExponential(Math.max(1,Math.min(14,a))-1);e=e.replace(/\.?0+(?=e)/,"");c=""}else{e=e.toPrecision(Math.max(1,Math.min(14,a)));if(e.indexOf(".")>=0){e=e.replace(e.indexOf("e")<0?/0+$/:/\.?0+(?=e)/,"");e=e.replace(".",u)}}else{h+=u;a=Math.max(0,Math.min(20,a-Math.ceil(Math.log(r)/Math.log(10))));for(p=0;p<a;p++)h+="#";e=n(h,e)}e=e.replace(i.numericRegex,function(t){if(t===d)return i.groupTemp;if(t===u)return i.decTemp;return""});l<0&&!/^-/.test(e)&&(e="-"+e)}return i.prefix+e+c+o+i.postfix}});function m(t,e,n){var i,a,o=t.pattern,r,l,c,u,d,p,h;if(o.indexOf("A")>=0){o=o.replace("A","");t.abbreviate=true}h=S(e,n);r=o.match(h);r=r?r[0]:"";l=r?o.substr(0,o.indexOf(r)):o;c=r?o.substring(o.indexOf(r)+r.length):"";r||(r=o?"#":"##########");if(e&&e===n){i=r.split(n);a=i.pop();r=i.join("")+n+a;e=""}u=e;e=/,/.test(n)?"¤":",";u&&(r=r.replace(b(u,"g"),e));d=n;n=".";d&&(r=r.replace(b(d,"g"),n));p=r.match(/#/g);p=p?p.length:0;var g=o.split(d);var f;g[1]&&(f=g[1].match(/#|0/g));t.prefix=l||"";t.postfix=c||"";t.pattern=o;t.maxPrecision=f?f.length:2;t.percentage=s.test(o);t.numericPattern=r||"";t.numericRegex=new RegExp(b(e,null,true)+"|"+b(n,null,true),"g");t.groupTemp=u;t.decTemp=d;t.t=e;t.d=n;t.temp=p}function b(t,n,i){var a=e.escapeRegExp(t);if(i)return a;return new RegExp(a||"",n)}function S(t,n){n&&(n=e.escapeRegExp(n));t&&(t=e.escapeRegExp(t));return new RegExp("(?:[#0]+"+t+")?[#0]+(?:"+n+"[#0]+)?")}window.NumberFormatter=i;i.getStaticFormatter=function(){return{prepare:function t(){},formatValue:function t(e){return e+""}}};return i}.apply(e,i),void 0!==a&&(t.exports=a))},257:function(t,e,n){"use strict";var i,a;!(i=[n(10),n(48),n(871),n(94),n(102),n(169),n(176)],a=function(t,e,n,i,a){e.service("qvGlobalSearchService",["$document","qvSelectionToolbarService",function(e,s){var o,r={};function l(t){return r[u(t)]}function c(t,e){r[u(t)]=e}function u(t){if(t.id)return t.id.toUpperCase();return t.id}function d(t){return{$container:void 0,$containerId:".qv-global-search-container",$app:t,$lastKnownIndexProgress:void 0,$haveQuery:false,getComponent:function t(){return n},setup:function e(){i.StateChanged.bind(p.bind(null,t));t.isInModalSelection()&&s.confirm()},destroy:function t(){i.StateChanged.unbind(p)}}}function p(t){(i.isInEditMode()||!i.isInAnalysisMode||i.inObjectView())&&f(l(t))}function h(n,i,a){n.$container=t.element("<div>");i=i||e;i.find(n.$containerId).append(n.$container);n.$container.showComponent(n.getComponent(),["$scope",function(t){t.app=n.$app;t.options={objectSearchIsOn:a}}]);n.setup()}function g(t){return!(!t||void 0===t.$container)}function f(t){if(t.$container){t.$container.remove();t.$container=void 0}t.destroy()}function v(t){var e=l(t);if(!e){e=new d(t);c(t,e)}return e}function m(t,e){try{var n=e.qTransientProgressMessage.qMessageParameters[0],i=new Number(n),a=v(t);!Number.isNaN(+i)&&n&&(a.$lastKnownIndexProgress=i);o.IndexProgressUpdate.emit(u(t),i)}catch(t){return}}o={toggleGlobalSearch:function t(e,n,i){var a=v(e);g(a)?f(a):h(a,n,i)},openGlobalSearch:function t(e,n){var i=v(e);if(!g(i)){f(i);h(i,n)}},closeGlobalSearchIfNoQuery:function t(e){var n=l(e);n&&n.$haveQuery||this.off()},off:function t(){Object.keys(r).forEach(function(t){f(r[t])})},isSearchOpen:function t(e){return g(l(e))},setLastKnownIndexProgress:function t(e,n){var i=l(e)||{};i.$lastKnownIndexProgress=n},getLastKnownIndexProgress:function t(e){var n=l(e)||{};return n.$lastKnownIndexProgress},couldEngineBeIndexing:function t(e){var n=l(e)||{},i=n.$lastKnownIndexProgress;return void 0!==i&&i<100},requestIndexProgressUpdate:function t(e){e.global.getProgress(0).then(m.bind(null,e))},setHaveQuery:function t(e,n){var i=v(e);i.$haveQuery=n}};a.mixin(o);o.notification("IndexProgressUpdate");return o}])}.apply(e,i),void 0!==a&&(t.exports=a))},264:function(t,e,n){"use strict";var i,a;!(i=[n(612)],a=function(t){return{template:t,controller:[function(){}],scope:{item:"=",style:"="}}}.apply(e,i),void 0!==a&&(t.exports=a))},271:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91)],a=function(t,e){t.service("qvCurrentSelectionsService",[function(){function t(t){return t.qStateCounts.qSelected+t.qStateCounts.qSelectedExcluded+t.qStateCounts.qLocked+t.qStateCounts.qLockedExcluded}function n(t){var n=t.states.length;return e.get("CurrentSelections.SelectionsInStates",n)}function i(n){var i=t(n),a=n.qTotal,s;s=a===i&&a>1?e.get("CurrentSelections.All"):i>1&&a>1?e.get("CurrentSelections.Of",[i,a]):n.qSelectedFieldSelectionInfo.map(function(t){return t.qName}).join(", ").toString();return s}return{translate:function t(e){return e.states?n(e):i(e)},translatedScreenReaderLabel:function i(a){var s;if(a.states)s=n(a);else{var o=t(a),r=a.qTotal,l=a.qField,c=a.qSelected;s=r===o&&r>1?e.get("CurrentSelections.AllSelections",[l]):o>1&&r>1?e.get("CurrentSelections.MultipleSelections",[l,o,r]):e.get("CurrentSelections.SingleSelection",[l,c])}return s}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},273:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){return{DEFAULT_STATE_TRANSLATION:"AlternateState.DefaultState",DEFAULT_STATE_NAME:"$"}}.apply(e,i),void 0!==a&&(t.exports=a))},274:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(97),n(99),n(854)],a=function(t,e,n){t.directive("qvPager",["$timeout",function(t){return{restrict:"A",priority:0,link:function i(a,s){n.treatAsDesktop()||s.css("overflow-x","auto");a.pagerData=s.find("ul").pager().data("qv-pager");s.addClass("qv-pager");a.nextPage=function(){t(function(){a.pagerData.goToNextPage();a.refreshPager(true)})};a.prevPage=function(){t(function(){a.pagerData.goToPreviousPage();a.refreshPager(true)})};a.goToPage=function(t){a.pagerData.goToPage(t);a.refreshPager(true)};a.refreshPager=function(t){var e="";t||a.pagerData.refresh();s.removeClass("qv-pager-back qv-pager-forward");if(1!==a.pagerData.currentPage){a.showShadow=true;e+="qv-pager-back "}else a.showShadow=false;a.pagerData.currentPage!==a.pagerData.maxPages&&(e+="qv-pager-forward ");s.addClass(e)};function o(){a.refreshPager()}a.$on("refreshPager",o);a.$on("$destroy",function(){e.off("end",o)})}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},275:function(t,e,n){"use strict";var i,a;!(i=[n(54),n(91),n(48),n(89),n(105),n(147),n(154),n(134),n(112),n(233),n(366)],a=function(t,e,n,i,a,s,o,r,l){n.service("qvCaoSearchService",["qvCaoSelectionService",function(n){var c;function u(){c=this;this.fieldList=[];this.queryString=[];this.queryTokens=[];this.caoSearchQueryHandlers=[]}u.prototype.createFieldList=function(){var t=[];return o.getList().then(function(t){return t.getLayout()}).then(function(e){t=t.concat(e);return c.getMasterItems()}).then(function(e){t=t.concat(e);c.fieldList=c.sortFields(t);return c.fieldList})};u.prototype.getFields=function(){return this.fieldList};u.prototype.getSelectedFields=function(t){return this.getFields().filter(function(t){return t.selected}).filter(function(e){var n=t.indexOf(e.qName);return n>-1})};u.prototype.syncFieldsInQueryWithFieldPicker=function(e){var n=this.getSelectedFields(e);this.fieldList=this.fieldList.map(function(e){var i=t.find(n,function(t){return t.caoFieldId===e.caoFieldId});e.selected=!!i;return e})};u.prototype.getMeasureMasterItems=function(){var t=this;return s.getList().then(function(e){return e.getLayout().then(function(e){t.measureMasterItems=e.map(function(t){return{qName:t.qData.title,classifications:["measure"],masterItem:true,libId:t.qInfo.qId,libIdLabel:t.qMeta.title}});return t.measureMasterItems})})};u.prototype.getDimensionMasterItems=function(){var t=this;return r.getList().then(function(e){return e.getLayout().then(function(e){t.dimensionMasterItems=e.map(function(t){return{qName:t.qData.title,classifications:["dimension"],masterItem:true,libId:t.qInfo.qId,libIdLabel:t.qMeta.title}});return t.dimensionMasterItems})})};u.prototype.getMasterItems=function(){var t=[];return i.all({measureItems:this.getMeasureMasterItems(),dimItems:this.getDimensionMasterItems()}).then(function(e){t=e.measureItems.concat(e.dimItems);return t})};u.prototype.sortFields=function(t){t=t.map(function(t){var n="cao_field_"+t.qName;n=n.split(" ").join("_");t.masterItem||(1===t.qSrcTables.length?t.tablesAssociated=t.qSrcTables[0]+" "+e.get("cao.search.field.table"):t.tablesAssociated=e.get("cao.search.field.table.title",t.qSrcTables.length));t.qSrcTables&&(t.tablesTooltip=t.qSrcTables.join(", "));t.name=t.qName;t.caoFieldId=t.masterItem?n+"masterItem_"+t.classifications[0]:n;t.highlight=false;t.classificationIcon=c.getFieldClassificationIcon(t);t.displayNameTokens=[{text:t.qName,matching:false}];if(t.classifications&&t.classifications.length>0){t.masterItemDimension="dimension"===t.classifications[0]&&t.masterItem;t.masterItemMeasures="measure"===t.classifications[0]&&t.masterItem}t.masterItem&&(t.masterItemTitle=t.masterItemDimension?e.get("cao.fieldPicker.masterItem.dimension"):e.get("cao.fieldPicker.masterItem.measure"));return t});return l.localeOrderBy(t,function(t){return t.qName})};u.prototype.getFieldClassificationIcon=function(e){var n;var i=t.find(e.qTags,function(t){return"$date"===t});var a=t.find(e.qTags,function(t){return"$geoname"===t});i?n="lui-icon--calendar":a&&(n="lui-icon--map");return n};u.prototype.indexesOfWordInString=function(t,e){t=t.toLowerCase();e=e.toLowerCase();var n=[];var i=t.indexOf(e);i>-1&&n.push(i);while(i>-1){i=t.indexOf(e,++i);i>-1&&n.push(i)}return n};u.prototype.getQueryTokensBasedOnQuotes=function(t){var e=[];if(t&&t.length>0){var n=t.split(" ");var i=0;var a=null;var s=null;var o=null;var r=false;n.forEach(function(l,u){a='"'===l.charAt(0);s='"'===l.charAt(l.length-1);u<n.length-1&&(o='"'===n[u+1].charAt(0));if(a){i=u;r=true;if(1===n.length&&a){l=l.substr(1);e.push(c.createToken(l,e,t,false));r=false}else if(u===n.length-1&&n.length>1){l=n.slice(i,u+1).join(" ").substr(1);e.push(c.createToken(l,e,t,false));r=false}if(r&&o&&!s){l=n.slice(i,u+1).join(" ").substr(1);e.push(c.createToken(l,e,t,false));r=false}}else if(r&&o&&!s){l=n.slice(i,u+1).join(" ").substr(1);e.push(c.createToken(l,e,t,false));r=false}else if(s){l=n.slice(i,u+1).join(" ");e.push(c.createToken(l,e,t,true));r=false}else if(r&&u===n.length-1){l=n.slice(i,u+1).join(" ").substr(1);e.push(c.createToken(l,e,t,false));r=false}else r||e.push(c.createToken(l,e,t,false))})}this.queryTokens=e;return this.queryTokens};u.prototype.createToken=function(t,e,n,i){var a;var s=t.length;if(e&&e.length>0){var o=e[e.length-1];a=n.indexOf(t,o.indexEnd)}else a=n.indexOf(t);""===t&&(s=1);return{word:i?t.substr(1).slice(0,-1):t,indexStart:""===t?a+1:a,indexEnd:a+s}};u.prototype.addStringToQueryAtIndex=function(t,e,n){var i="";if(e&&e.length>0){var a=e;var s=e.slice(0,n).trim();var o=a.slice(n).trim();i=s+t+o}return i};u.prototype.getCurrentToken=function(t,e){var n={index:null,token:null};var i=this.getQueryTokensBasedOnQuotes(t);i.some(function(t,i){if(e>=t.indexStart&&e<=t.indexEnd){n.index=i;n.token=t;return e>=t.indexStart&&e<=t.indexEnd}});return n};u.prototype.replaceTwoOrMoreSpacesWithOne=function(t){return t.replace(/\s\s+/g," ")};u.prototype.removeFieldFromQuery=function(t,e,n){var i=this.indexesOfWordInString(e,t.qName);if(i.length>1){n=n.filter(function(e){return e.caoFieldId!==t.caoFieldId}).map(function(t){t.indexStartOfFieldInQuery=e.indexOf(t.qName);t.indexEndOfFieldInQuery=e.indexOf(t.qName)+t.qName.length;return t});var a=-1;i.forEach(function(i){n.forEach(function(n){a=i!==n.indexStartOfFieldInQuery?i:e.indexOf(t.qName)})});if(-1===a)e=e.replace(t.qName,"");else{var s=e.split("");s.splice(a,t.qName.length);e=s.join("")}}else e=e.replace(t.qName,"");return e.replace(/^\s+/g,"")};u.prototype.addFieldToQuery=function(t,e,n,i,a){e=e||"";var s=t.qName.match(" ")||t.qName.match(String.fromCharCode(160));var o=s?'"'+t.qName+'"':t.qName;var r=this.getQueryTokensBasedOnQuotes(e);var l=0;var c=a-i>0;if(c){var u=e.split("");u.splice(i,a-i,o);e=u.join("");l=i+o.length+1}else if(""===e){e=o;l=n+o.length+1}else if(r.length>0&&t){var d=this.getCurrentToken(e,n);if(null!==d.index){r[d.index]={word:t.qName};e=r.map(function(t,e){if(e===d.index&&e<r.length-1&&r[e+1].word)return t.word.match(" ")?'"'+t.word+'" ':t.word+" ";return t.word.match(" ")?'"'+t.word+'"':t.word}).join(" ");l=d.token.indexStart+o.length+1}else{var p=" "+o;e=this.addStringToQueryAtIndex(p,e,n);l=n+o.length+1}}e=e.replace(/^\s+/g,"");return{query:e,cursorPosition:l}};u.prototype.searchResultPositionRelativeToQuery=function(t,e){var n=7.5;var i=.7;var a=0;if(t&&t.length>0){var s=t.slice(0,e).split("");var o=s.filter(function(t){return" "!==t});var r=s.filter(function(t){return" "===t});a+=o.length*n;a+=r.length*i}return a};u.prototype.registerForCaoSearchQuery=function(t){this.caoSearchQueryHandlers.push(t)};u.prototype.unRegisterFromCaoSearchQuery=function(){this.caoSearchQueryHandlers=[]};u.prototype.getMatchingFields=function(e,n){var i=[];var a=this.fieldList;var s;e?e=e?e.toLowerCase():"":e&&""!==e||(s=true);i=a.filter(function(t){var i=t.qName.toLowerCase();if(s||i.indexOf(e)>-1)return!n||n&&t.masterItem;return false});i=t.uniq(i).filter(function(t){return l.librarySearchFn(t,e)});return l.localeOrderBy(i,function(t){return t.qName})};u.prototype.clearSelectedFields=function(){this.fieldList.forEach(function(t){t.selected=false});n.clearSelection()};u.prototype.selectField=function(t,e){this.fieldList=this.fieldList.map(function(n){n.caoFieldId===t.caoFieldId&&(n.selected=e);return n})};u.prototype.updateInsights=function(t){this.caoSearchQueryHandlers.forEach(function(e){e&&e({query:t,fields:c.getFields().filter(function(t){return t.selected})})});n.clearSelection()};u.prototype.showIntro=function(t){this.caoSearchQueryHandlers.forEach(function(e){e&&e({showIntro:t})})};u.prototype.matchingField=function(t,e,n){var i=e>0&&e<=n.length-1;var s=e>=-1&&e<n.length-1;switch(t){case a.KeyCodes.Up:i&&e--;break;case a.KeyCodes.Down:s&&e++;break;case a.KeyCodes.Tab:break}return n[e]};return new u}])}.apply(e,i),void 0!==a&&(t.exports=a))},276:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(907)],a=function(t,e){t.directive("qvProgressBar",["$interval",function(t){return{replace:true,template:e,restrict:"E",scope:{percentDone:"=",onCompleted:"&",options:"="},link:function e(n){var i,a=true;n.display="0%";n.showPercent=0;function s(){if(n.showPercent>=100){t.cancel(i);n.onCompleted();return}if(n.showPercent>=n.percentDone){t.cancel(i);return}o(n.showPercent+1)}n.$watch("percentDone",function(e){if(void 0!==e)if(a){o(e);a=false}else{t.cancel(i);i=t(s,10)}});function o(t){n.showPercent=t;n.display=t+"%"}n.$on("$destroy",function(){t.cancel(i)})}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},277:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(968)],a=function(t,e){var n={bindings:{currentSelectionDisabled:"<"},template:e};t.directive("qvCurrentSelectionsItem",function(){return n});return n}.apply(e,i),void 0!==a&&(t.exports=a))},280:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(89),n(48),n(397),n(10)],a=function(t,e,n,i){var a=window.angular,s={"max-height":"90%","max-width":"90%","min-height":"180px",width:"400px"},o,r=false,l=false;n.directive("qvDelayedDialogButton",function(){return{replace:true,restrict:"A",link:function t(e){e.button&&e.button.defaultEscButton&&(o=e);e.closeModal=function(t,n){if(t){t.preventDefault();t.stopPropagation()}e.button&&e.button.callback&&("undefined"===typeof e.button.expression||e.button.expression)&&e.button.callback();(n||e.autoClose||e.button&&!e.button.callback)&&e.destroyModal();return}}}});n.service("$delayedModal",["$compile","$rootScope","$document",function(n,c,u){var d={},p,h,g,f,v=i,m;var b={open:function t(i){var b=new e,S;if(p){h=p;f=g}p=c.$new();g=a.element('<div class="qv-modal-container qui-modalbackground-centered" qva-outside-ignore-for="allOutside" ng-style="containerStyle" ng-class="classes"></div>');p.containerStyle={content:" "};p.classes={};p.modalStyle={};var y;for(y in s)p.modalStyle[y]=s[y];p.wasDisabled=[];p.showDefaultButton=true;r=true;l=false;d=i;p.failed=false;p.autoClose=true;for(y in d)p[y]=d[y];g.html(v).appendTo(u.find("body"));p.html&&g.find("main").append(p.html);S=p.$watch("element",function(){b.resolve();S()});m=n(g)(p);p.destroyModal=this.close.bind(this);p.handleEscButton=function(t){if(t){t.preventDefault();t.stopPropagation()}p.buttons&&o?o&&o.closeModal():p.destroyModal()};p.$broadcast("delayed-modal-opened");p.$watchCollection("[width, height]",function(){p.width&&(p.modalStyle.width=p.width);p.height&&(p.modalStyle.height=p.height)});return b.promise},update:function t(e){if(!r)return;for(var i in e){p[i]=e[i];d[i]=e[i]}if(e.html||e.buttons){g.html(v);g.find("main").html(e.html);u.find("body").find(".qui-delayedModal").replaceWith(g.html());m=n(g)(p)}},close:function t(){if(p&&g){p.$broadcast("delayed-modal-closed");g.remove();p.$destroy();p=h||null;g=f||null;f=null;h=null}r=false;l=false},lock:function e(){l=true;p.wasDisabled.length=0;m.find("button, input, textarea, select").each(function(){var e=t(this);e.prop("disabled")?p.wasDisabled.push(this):e.prop("disabled",true)})},unlock:function e(){l=false;m.find("button, input, textarea, select").each(function(){-1===p.wasDisabled.indexOf(this)&&t(this).prop("disabled",false)});p.wasDisabled.length=0}};Object.defineProperty(b,"isOpened",{get:function t(){return r}});Object.defineProperty(b,"isLocked",{get:function t(){return l}});Object.defineProperty(b,"scope",{get:function t(){return p}});return b}])}.apply(e,i),void 0!==a&&(t.exports=a))},284:function(t,e,n){"use strict";var i,a;!(i=[n(94),n(158),n(334),n(239),n(848),n(849),n(341),n(335),n(427),n(320),n(360),n(361),n(245),n(306),n(508),n(428)],a=function(t,e,n,i,a,s,o,r){var l=e.inClient(),c,u;var d=new r;d.scope="root";if(!l){t.setState(t.States.analysis);t.setView(t.Views.sheet)}if(p()){document.body.classList.add("absolute-position-mashup");document.documentElement.classList.add("absolute-position-mashup")}c=new a(l);u=new o;s.init();function p(){var t=Array.prototype.slice.call(document.querySelectorAll("body > .qvobject, body > .qvplaceholder"));if(0===t.length)return false;return!t.some(function(t){return"absolute"!==t.style.position})}function h(t,e){i.setErrorCallback(t,e);n.setErrorCallback(t,e)}function g(t,e){d.register({scope:"root",name:t,callback:e})}function f(t){d.clear(t)}var v={openApp:i.openApp.bind({_qEvent:d}),currApp:i.currApp,getGlobal:n.get.bind({_qEvent:d}),setOnError:h,on:g,off:f,setLanguage:e.setLanguage,setDeviceType:e.setDeviceType,table:i.table,getAppList:n.getAppList,resize:e.resize,getExtensionList:e.getExtensionList,callRepository:e.callRepository,registerExtension:e.registerExtension,navigation:c,sessionApp:i.sessionApp,sessionAppFromApp:i.sessionAppFromApp,getThemeList:o.getThemeList,theme:u};Object.defineProperty(v,"Promise",{get:function t(){return e.Promise}});return v}.apply(e,i),void 0!==a&&(t.exports=a))},290:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(90),n(89),n(141),n(283),n(364),n(50),n(365),n(245)],a=function(t,e,n,i,a,s,o,r){t.service("qvListboxPopoverService",["luiPopover",function(t){var l;var c;var u={showDelayed:function i(u,d,p,h){var g=n();if(l){c.selectionsActivated=function(){};c.selectionsDeactivated=function(){};l.close()}c={getVisualization:function t(){return g.promise},onPopoverClose:this.onPopoverClose,options:{setController:g.resolve,isPopover:true,showLock:d.showLock,search:d.search||{},smallDevice:o.isSmallDevice,direction:d.direction},selectionToolbarComponent:a,onClose:s};l=t.show({template:r,controller:s.controller,alignTo:d.$alignToElement[0],input:c,closeOnResize:false,dock:"top"});u.then(function(t){c.model=t}).catch(function(t){false});c.selectionsActivated=function(){e.isFunction(h)&&h()};c.selectionsDeactivated=function(){e.isFunction(p)&&p();p=null;h=null};return l},show:function t(e,i,a,s){return this.showDelayed(n.when(e),i,a,s)},showField:function t(e,a,s,o,r,l){return i.createTransientField(a,e,o).then(function(t){return n.resolve(this.show(t,s,r,l))}.bind(this)).catch(function(t){false})},showDimension:function t(e,n,a,s,o,r){i.createTransientDimension(n,e,s).then(function(t){this.show(t,a,o,r)}.bind(this)).catch(function(t){false})},close:function t(){l&&l.close();l=null},onPopoverClose:function t(){},getPopover:function t(){return l},onClosing:function t(){}};return u}])}.apply(e,i),void 0!==a&&(t.exports=a))},306:function(t,e,n){"use strict";var i,a;function s(t){s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return s(t)}!(i=[n(10),n(48),n(96),n(850),n(851),n(132),n(106),n(97),n(50),n(94),n(202),n(90),n(114),n(113),n(852),n(853),n(363),n(273),n(142),n(95),n(105),n(89),n(167),n(103),n(290),n(274),n(175),n(855),n(257),n(212),n(392),n(240),n(271),n(289),n(276),n(965),n(277)],a=function(t,e,n,i,a,o,r,l,c,u,d,p,h,g,f,v,m,b,S,y,I,x,q,w){var C=b.DEFAULT_STATE_TRANSLATION;var P=b.DEFAULT_STATE_NAME;e.directive("qvSelectionPager",["qvGlobalSelectionsService","$timeout",function(t,n){var i=e.getService("$templateCache");i.put("current-selections-tooltip-template.ng.html",a);return{restrict:"A",priority:1,link:function e(i){var a=i.$watch(function(){return t.isSelectActive(i.app)},function(t){i.$emit("globalSelectionActive",t);n(function(){i.refreshPager(false)})});function s(){i.refreshPager(false)}l.on("end",s);i.$on("$destroy",function(){a();l.off("end",s)})}}}]);var T={template:i,replace:true,restrict:"E",scope:{app:"=",options:"=",expandSmartSearchSuggestedChart:"=?"},link:function t(n,i){var a=e.getService("$timeout"),s=e.getService("qvGlobalSelectionsService"),l=e.getService("qvExploreSelectionsService"),p=e.getService("qvGlobalSearchService"),h=e.getService("qvCaoService"),b=i.parent(),S,x,q;var T=new v(n,c,s,l,p,h);q=new f(n);n.isCaoActive=d.isInInsightMode();n.isExploreSelectionsActive=false;n.nbrSelection=0;n.haveHiddenSelections=false;n.isSmallDevice=c.isSmallDevice;n.cachedPlaceHolders=[];n.isGlobalSearchIndexing=false;n.progressBarOptions={hideText:true};n.setSearchIndexingDone=function(){n.isGlobalSearchIndexing=false};function A(t,e){if(t!==(n.app.enigmaModel.id||"").toUpperCase())return;var i=new Number(e);if(!n.isGlobalSearchIndexing&&i<100){n.indexPercentDone=i;n.isGlobalSearchIndexing=true;E(500)}else if(n.isGlobalSearchIndexing){n.indexPercentDone=i;i<100&&E(500)}else D()}function D(){a.cancel(x);if(S){p.IndexProgressUpdate.unbind(A);S=false}}function E(t){if(!S){p.IndexProgressUpdate.bind(A);S=true}a.cancel(x);x=a(function(){p.requestIndexProgressUpdate(n.app.enigmaModel)},t||0)}function k(){a(function(){n.isSmallDevice=c.isSmallDevice;if(g["SMARTSEARCH_INDEX_CLOSE"])if(n.isSmallDevice){D();n.setSearchIndexingDone()}else!p.isSearchOpen(n.app.enigmaModel)&&p.couldEngineBeIndexing(n.app.enigmaModel)&&E(0);n.isSmallDevice&&n.isCaoActive&&(n.isCaoActive=false)})}function M(){if(!q)return;u.isInAnalysisMode()?q.on():q.off()}function $(){u.inSheetView()&&c.isSmallDevice&&p.openGlobalSearch(n.app.enigmaModel,b);M();var t=d.isInInsightMode();t?t&&!n.isCaoActive&&(n.isCaoActive=true):n.isCaoActive=false}M();c.ViewChanged.bind(k);n.$watch("isSmallDevice",function(t){true!==t||u.inObjectView()?p.closeGlobalSearchIfNoQuery(n.app.enigmaModel):p.openGlobalSearch(n.app.enigmaModel,b)});u.StateChanged.bind($);n.mobileIndicatorTop=false;n.mobileIndicatorShow=false;s.setCsShowCallback(function(t){n.mobileIndicatorShow=t});s.onClose(function(){document.activeElement!==i.find('[tid="toggleCaoButton"]')[0]&&document.activeElement!==i.find('[tid="currentSelections.toggleExploreSelection"]')[0]&&i.find('[tid="currentSelections.toggleGlobalSelections"]').focus()});n.$on("globalSelectionActive",function(t,e){n.isGlobalSelectionsActive=e});n.$on("exploreSelectionActive",function(t,e){n.isExploreSelectionsActive=e});function O(t){o.get(t).then(function(t){n.model=t;r(n,"app",L)}).catch(function(t){false});n.$watch(t.isInModalSelection.bind(t),function(t){n.inSelection=t;if(n.inSelection&&n.activeFieldName&&n.activeFieldName.length>0)n.cachedPlaceHolders=n.items.map(function(t){return m.createPlaceHolder({},t.qField,t.qReadableName||t.qField)});else{n.cachedPlaceHolders=[];n.items=n.items.filter(function(t){return!t.isPlaceHolder})}});n.app=t;r(n,"app",L)}var F=[];var N;function L(t){var e=false;var i;if(F.length!==t.qStateNames.length||!F.every(function(e,n){return e===t.qStateNames[n]})){i=[C].concat(t.qStateNames);e=true;F=t.qStateNames.concat()}if(n.model&&(!N||e)){i=[P].concat(t.qStateNames);n.model.getProperties().then(function(t){t.selectionsInStates=i.map(function(t){return{stateName:t,qSelectionObjectDef:{qStateName:t}}});n.model.setProperties(t)})}N=n.model}var _=n.$watch("app",function(t){O(t.enigmaModel);_()});n.$watch(function(){return p.isSearchOpen(n.app.enigmaModel)},function(t){n.isGlobalSearchActive=t;if(g["SMARTSEARCH_INDEX_CLOSE"])if(n.isSmallDevice||t){D();n.isGlobalSearchIndexing=false}else if(p.couldEngineBeIndexing(n.app.enigmaModel)){var e=p.getLastKnownIndexProgress(n.app.enigmaModel);n.isGlobalSearchIndexing=true;n.indexPercentDone=e;E(500)}});n.toggleGlobalSelection=function(t){t.preventDefault();T.toggleGlobalSelection(n.app);n.currentSelectionDisabled=false;n.expandSmartSearchSuggestedChart=false;y.publish(I.Events.PubSub.ExpandSmartSearchSuggestedChart,null);w.trackEvent(w.customEvents.GLOBAL_SELECTIONS_CLICKED,{type:"clicked"})};n.toggleGlobalSearch=function(){T.toggleGlobalSearch(b)};n.toggleExploreSelection=function(){T.toggleExploreSelection(b);n.expandSmartSearchSuggestedChart=false;y.publish(I.Events.PubSub.ExpandSmartSearchSuggestedChart,null);n.currentSelectionDisabled=false};n.toggleCao=function(){n.currentSelectionDisabled=false;T.toggleCao(b)};n.$watch("isCaoActive",function(t){false===t&&h.off()});n.$on("$destroy",function(){c.ViewChanged.unbind(k);p.off();h.off();n.isCaoActive=false;s.off();l.off();n.isExploreSelectionsActive=false;u.StateChanged.unbind($);s.setCsShowCallback(null);a.cancel(x);p.IndexProgressUpdate.unbind(A);q&&q.delete()})},controller:["$scope","$element","$timeout","qvChartTooltipService","qvGlobalSelectionsService","qvCurrentSelectionsService",function(i,a,o,l,d,g){var f,v=false,b,I,w=e.getService("qvListboxPopoverService"),C=e.getService("qvListboxPopoverServiceMobile"),P=e.getService("qvMultiStatePopoverService");i.items=[];i.disable={clear:true,back:true,forward:true};i.brightCurSel=i.options&&"bright"===i.options.variant;i.hideUndoRedo=i.options&&true===i.options.hideUndoRedo;i.hideSelectionsTool=i.options&&true===i.options.hideSelectionsTool;i.hideSearch=i.options&&true===i.options.hideSearch;i.hideClearSelections=i.options&&true===i.options.hideClearSelections;i.currentSelectionDisabled=false;function T(){d.setCsShow(c.isSmallDevice&&i.items.length>0&&u.view!==u.Views.object)}function A(e){i.currentSelectionDisabled=false;i.disable.clear=0===S.getClearableStates(e.selectionsInStates).length;i.disable.back=0===e.qSelectionObject.qBackCount;i.disable.forward=0===e.qSelectionObject.qForwardCount;var n=m.getAllSelectionsInStates(e);i.haveHiddenSelections=n.some(function(t){return t.qIsHidden});var a=n.filter(function(t){return!t.qIsHidden});a.forEach(function(t){t.translation=g.translate(t);t.screenReaderLabel=g.translatedScreenReaderLabel(t);t.name=t.qReadableName||t.qField;t.displayStateName=m.getDisplayStateName(t.stateName);t.currentSelectionDisabled=i.currentSelectionDisabled});i.nbrSelections=a.length;d.setSelectionCount(a.length,i.app);T();var s=m.groupSelectionsByField(a);var r=s.filter(function(t){return!t.isSingleState});r.forEach(function(t){t.translation=g.translate(t);t.screenReaderLabel=g.translatedScreenReaderLabel(t)});s=s.sort(S.sortSelections);if(i.cachedPlaceHolders.length>0&&i.activeFieldName&&i.activeFieldName.length>0){i.cachedPlaceHolders.forEach(function(t){m.createPlaceHolder(t)});a.forEach(function(t){i.cachedPlaceHolders.forEach(function(e,n){t.qField===e.qField&&(i.cachedPlaceHolders[n]=p.extend(true,{},t))})});a=i.cachedPlaceHolders}if(i.multiPopover){var l=m.getIndexByKey(s,"name",i.multiPopover.fieldName);var c=m.getIndexByKey(i.items,"name",i.multiPopover.fieldName);var u=l>-1;if(u){var h=s.splice(l,1)[0];s.splice(c,0,h);var f=m.getAllStatesFromSelections(s,i.multiPopover.fieldName);if(f.length<=1&&i.activeFieldName.length){t.element('.item[data-csid="'+i.activeFieldName+'"]').focus();i.multiPopover.close()}}else i.multiPopover.close()}i.items=s;T();o(function(){i.$broadcast("refreshPager")})}r(i,"model",function(){I&&I.dispose();I=i.model.layoutSubscribe(A)});i.$watch(u.inObjectView,T);i.$watch("isSmallDevice",T);i.clear=function(t,e,n){var a=e?[e]:m.getAllStatesFromSelections(i.items);i.$parent.itemSelected&&(i.$parent.itemSelected=false);n&&n.stopPropagation();var s=a.map(function(e){return i.model.clearField(t,e)});return x.all(s)};i.clearAllFields=function(){return i.model.clearAll()};i.back=function(){return i.model.back()};i.forward=function(){return i.model.forward()};function D(e){var n=t.element(e).next("li");if(t.element(e).parent().find("li").length<=1)return null;return t.element(e).parent().find("li").length>1&&n.length>0?n:null}function E(e){var n=t.element(e).prev("li");if(t.element(e).parent().find("li").length<=1)return null;return n.length>0?n:null}function k(e,n){var a;var s=e.which;s=e.shiftKey&&q.TAB===s?"SHIFT_TAB":s;var r=document.activeElement&&"qv-multi-state-popover-btn-clear"===t.element(document.activeElement).attr("tid");var l=".item-multi-state[data-csid="+i.multiPopover.fieldName+"]";switch(s){case q.ESCAPE:i.multiPopover.close();a=t.element(l);break;case q.DELETE:a=D(e.target)||E(e.target);i.clear(n.qField,n.stateName);break;case q.SPACE:case q.ENTER:o(function(){e.target.click()});break;case q.ARROW_RIGHT:case q.ARROW_DOWN:case q.TAB:if(r)a=t.element('[tid="qv-multi-state-popover"] li.item:first');else{a=D(e.target);if(null===a&&s===q.TAB){i.multiPopover.close();a=t.element(l)}}break;case q.ARROW_LEFT:case q.ARROW_UP:case"SHIFT_TAB":if(r){a=t.element(l);i.multiPopover.close()}else a=E(e.target);break}if(a){a.focus();e.preventDefault()}}i.showPopover=function(e){var n=t.element(e.target).closest(".item"),a=n.scope().item.qField,s=n.scope().item.isPlaceHolder,r={qvaOutsideIgnoreFor:"currentSelectionsItems",$alignToElement:n,showLock:true,direction:h.direction};if(i.isClearSelectionIcon(e.target)){if(i.activeFieldName){c.isSmallDevice?w.close():C.close();i.activeFieldName=""}return}if(!n.hasClass("item-multi-state")&&(a===i.activeFieldName||s)){c.isSmallDevice?w.close():C.close();i.activeFieldName="";return}o(function(){i.closeTooltip()},100);i.activeFieldName=a;var l={listboxPopoverService:w,listboxPopoverServiceMobile:C,$timeout:o};var u=m.getAllStatesFromSelections(i.items,a);if(u.length>1){if(i.multiPopover)return;var d=function t(){return m.getMultiPopoverItems(i.items,a)};i.multiPopover=m.openMultiStatePopover(P,d,n[0],i.brightCurSel,{onClose:function t(){i.multiPopover=null;i.activeFieldName=""},clear:i.clear,click:function e(n){var a=t.element(n.target).closest(".item");var s=a.scope().item.qField;var o=a.scope().item.displayStateName;i.multiPopover.close();i.closeTooltip();i.onCloseFocusSelector='.item[data-csid="'+s+'"]';m.openListboxPopover(m.activatePopover,i,c.isSmallDevice,o,s,r,l)},openTooltip:i.openTooltip,closeTooltip:i.closeTooltip,direction:h.direction,handleKeyDown:k});i.multiPopover.fieldName=a}else m.openListboxPopover(m.activatePopover,i,c.isSmallDevice,u[0],a,r,l)};i.openTooltip=function(t,e){if(i.isClearSelectionIcon(t.target)){i.closeTooltip();return}if(v||n.utils.touch)return;var a=i.multiPopover&&i.multiPopover.fieldName===e.qField;if(e.states&&a)return;i.cancelTooltip();f=o(function(){var n=e.qStateCounts,i="object"===s(n),o=i?" ("+(n.qSelected+n.qSelectedExcluded+n.qLocked+n.qLockedExcluded)+"/"+e.qTotal+")":"";var r=e.states||!a&&"$"===e.stateName?e.translation:[m.getDisplayStateName(e.stateName),": ",e.translation].join("");v=true;l.open({content:[{header:(e.qReadableName||e.qField)+o,rows:[{content:r}]}],position:{x:t.clientX,y:t.clientY},alwaysOnTop:true,direction:"bottom",template:"current-selections-tooltip-template.ng.html"})},500)};i.closeTooltip=function(){v=false;i.cancelTooltip();l.close()};i.cancelTooltip=function(){o.cancel(f)};i.isClearSelectionIcon=function(e){return t.element(e).closest(".remove").is(".remove")};i.handleKeyDown=function(e,n){var s;var o=e.which;o=e.shiftKey&&q.TAB===o?"SHIFT_TAB":o;switch(e.which){case q.DELETE:s=i.items&&i.items.length>1?D(e.target):a.find('[data-tid="current-selections-back"]');i.clear(n.qField);break;case q.ESCAPE:if(i.multiPopover){i.multiPopover.close();s=t.element('.item[data-csid="'+i.multiPopover.fieldName+'"]')}break}if(n.isSingleState)switch(e.which){case q.SPACE:case q.ENTER:case q.ARROW_DOWN:i.showPopover(e);break}else switch(o){case q.SPACE:case q.ENTER:i.multiPopover?i.multiPopover.close():i.showPopover(e);s=t.element('.item[data-csid="'+i.multiPopover.fieldName+'"]');break;case q.ARROW_DOWN:i.multiPopover||i.showPopover(e);s=t.element('.item[data-csid="'+i.multiPopover.fieldName+'"]');break;case q.TAB:if(i.multiPopover){s=t.element('[tid="qv-multi-state-popover-btn-clear"]');e.preventDefault()}break;case"SHIFT_TAB":i.multiPopover&&i.multiPopover.close();break}s&&s.focus()};function M(t,n){i.items.forEach(function(t){if(-1!==n[0].indexOf(t.qField)){n[1]?t.feedbackActive=false:t.feedbackActive=true;e.$apply(i)}})}b=e.$rootScope.$on("locked-feedback",M);var $=function t(){var n=e.getService("qvExploreSelectionsService");n.off();i.isExploreSelectionsActive=false;i.currentSelectionDisabled=false};y.subscribe("selection/insights/close",$);y.subscribe("cao/insights/close",function(){i.isCaoActive=false});y.subscribe("selections/insights/details/close",function(){i.currentSelectionDisabled=false});y.subscribe("selections/insights/details/open",function(){i.currentSelectionDisabled=true});i.$on("$destroy",function(){b();I&&I.dispose();y.unsubscribe("cao/insights/close");y.unsubscribe("selection/insights/close",$);y.unsubscribe("selections/insights/details/close");y.unsubscribe("selections/insights/details/open")})}]};e.directive("qvStageCurrentSelections",function(){return T});return T}.apply(e,i),void 0!==a&&(t.exports=a))},322:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(429),n(224),n(430),n(478),n(479),n(480),n(481),n(482)],a=function(t,e,n,i,a,s,o,r,l,c){function u(t,e){t=t.toLowerCase()||"image";e=e.toLowerCase();var u=e+"-"+t;function d(){var t;switch(u){case"sheet-pdf":case"object-pdf":t=r;break;case"sheet-image":case"object-image":t=o;break;case"story-ppt":t=l;break;case"story-pdf":t=c;break;default:t=o}return t}var p={template:d(),controller:["$scope","$timeout",function(e,o){e.exportType=t;e.states=i.getStates();e.state=e.states.IDLE;var r={CurrentSize:"0",BestFitPreserveAspectRatio:"1",BestFitNoPreserveAspectRatio:"2"};e.print={fitCriteria:r.CurrentSize};if(e.input.object){var l=e.input.object.model.id;var c={id:l,model:e.input.object.model,options:{id:l,isVisible:true,isOnGrid:false,isZoomed:false}};e.obj=c}switch(u){case"sheet-pdf":case"object-pdf":case"story-pdf":e.sizes=a.sizes;e.layouts=a.layouts;e.selectedSize=e.sizes[1];e.print.dpi=200;e.selectedLayout=e.layouts[1];e.minDpi=72;e.maxDpi=300;o(function(){e.onPrintLayout(e.selectedLayout)});break;case"sheet-image":case"object-image":e.availableFormats=["Jpeg","Png"];e.print.width=e.input.currentWidth;e.print.height=e.input.currentHeight;e.print.dpi=e.input.currentDpi;e.print.format="Png";e.imageCustomSize=false;break;case"story-ppt":e.availablePptDpi=[96,150,220];e.print.dpi=e.availablePptDpi[2];e.print.currentWidth=e.input.currentWidth;e.print.currentHeight=e.input.currentHeight;e.print.currentDpi=e.input.currentDpi;e.formats=s.formats;e.selectedFormat=e.formats[3];o(function(){e.onPptFormatChange(e.selectedFormat)});break}var d=n.create(e);e.confirm=d.confirm;e.onImageCustomSize=d.onImageCustomSize;e.onSizeChange=d.onSizeChange;e.onPrintLayout=d.onPrintLayout;e.onPptFormatChange=d.onPptFormatChange}]};return p}function d(){var t=document.createElement("div");t.style.width="1in";var e=document.getElementsByTagName("body")[0];e.appendChild(t);var n=document.defaultView.getComputedStyle(t,null).getPropertyValue("width");e.removeChild(t);var i=n&&Math.round(parseFloat(n));i=i||96;return i>300?300:i}function p(t,n,a,s,o,r){var l="Print."+n+".Title";var c=d();var p=u(n,a);var h=e.getService("luiDialog").show({controller:p.controller,template:p.template,input:{title:l,object:t,sourceType:"object",exportType:n,currentWidth:s,currentHeight:o,currentDpi:c}});h.closed.then(function(){i.cancel();r&&r()});return h}function h(n,a,s){var o="Print."+a+".Title";var r;r="story"===s.toLowerCase()?n&&n.inStoryPlayState()?t("#qv-storytelling .qv-story-slide-active"):t("#qv-storytelling .qv-grid-story"):n.model&&n.model.isCustomSize()?t("#grid"):t(".qvt-sheet > .sheet-grid");var l=Math.round(r.width()||960);var c=Math.round(r.height()||720);var p=d();var h=u(a,s);var g=e.getService("luiDialog").show({controller:h.controller,template:h.template,input:{title:o,object:n,exportType:a,currentWidth:l,currentHeight:c,currentDpi:p}});g.closed.then(function(){i.cancel()})}return{showForObject:p,showForGlobalMenu:h,getScreenDpi:d}}.apply(e,i),void 0!==a&&(t.exports=a))},323:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(54),n(89),n(91),n(133),n(975),n(280)],a=function(t,e,i,a,s){t.service("odagNavpointService",["$timeout","$delayedModal","odagNavpointServiceUI",function(t,o,r){var l;var c={};var u={SUCCEEDED:"succeeded",FAILED:"failed",VALIDATING:"validating",QUEUED:"queued",LOADING:"loading",CANCELING:"canceling",CANCELED:"canceled"};var d=[u.SUCCEEDED,u.FAILED,u.CANCELED];function p(t,e){r.updateImageOnItemHeader(e);return t.getLoadedLinkInfo(t).then(function(t){if(t.templateApp){e.templateName=t.templateApp.name;e.templateDescription=t.templateApp.description;if(t.templateApp.thumbnail){"/"===t.templateApp.thumbnail.substr(0,1)&&(t.templateApp.thumbnail=t.templateApp.thumbnail.substr(1));e.templateThumbnail=n.p+t.templateApp.thumbnail}r.updateImageOnItemHeader(e)}else{e.invalid=true;e.templateName=a.get("odag.toolbar.navpoint.popup.noTemplate");e.templateDescription=""}})}function h(t){switch(t.state){case u.SUCCEEDED:var e=a.get("odag.toolbar.navpoint.popup.delete.confirmation",[t.name]);var n=new i;o.open({title:a.get("odag.toolbar.navpoint.popup.delete.confirmation.title"),content:e,buttons:[{name:"Common.Cancel",tid:"odag-applist-modal-cancelBtn",callback:function t(){n.resolve()}},{name:"Common.Delete",tid:"odag-applist-modal-deleteBtn",defaultButton:true,callback:function e(){return s.deleteGenApp(t.parentContext.app,t.requestId).then(function(){n.resolve()})}}]});return n.promise;case u.FAILED:return s.requestAction(t.parentContext.app,t.requestId,s.ODAGRequestActionConst.FAIL_ACK,true,true);case u.VALIDATING:case u.QUEUED:case u.LOADING:case u.CANCELING:var r=true;var l=true;if(t.lastLoadedTime){r=false;l=false}return s.requestAction(t.parentContext.app,t.requestId,s.ODAGRequestActionConst.CANCEL,r,l);case u.CANCELED:return s.requestAction(t.parentContext.app,t.requestId,s.ODAGRequestActionConst.CANCEL_ACK,true,true)}}function g(t,e,n){return t.getLoadedLinkInfo(t).then(function(i){return s.reloadApp(t.model.parent.app,i,e,n,t.actualRowEst)})}function f(t,e){return s.getSelections(t,e)}function v(t,e){return r.getSelectedValuesDisplayString(t,e)}function m(t){return t.getLoadedLinkInfo(t).then(function(e){return s.generateApp(t.model.parent.app,t.model.parent.id,e,t.id,t.actualRowEst)})}function b(t){delete c[t.id]}function S(n,a,o,l){if(!o){l=Date.now();c[n.id]=l}return c[n.id]&&l>=c[n.id]?s.getGeneratedAppsForLink(n.model.parent.app,n.model.parent.id,n.data.odagLinkRefID,n.id).then(function(i){i.forEach(function(t){var i=r.createGeneratedAppWrapper(t,n.model.parent);var s=a.map(function(t){return t.requestId}).indexOf(t.id);if(s>-1){var o=a[s];var l=e.chain(i).keys().every(function(t){return e.has(o,t)&&e.isEqual(i[t],o[t])}).value();l||a.splice(s,1,i)}else a.push(i)});for(var s=a.length-1;s>-1;s--){var o=a[s];i.some(function(t){return t.id===o.requestId})||a.splice(s,1)}a.sort(function(t,e){var n=new Date(t.createdDate);var i=new Date(e.createdDate);return i-n});if(a.some(function(t){return t.loading}))return t(function(){S(n,a,true,l)},3e3);delete c[n.id]}):i.resolve()}function y(t){var e=a.get("Common.None");t.range&&(t.range.lowerBound&&t.range.lowerBound===t.range.upperBound?e=t.range.lowerBound:void 0===t.range.lowerBound||t.range.upperBound?void 0===t.range.upperBound||t.range.lowerBound?void 0!==t.range.lowerBound&&void 0!==t.range.upperBound&&(e="["+t.range.lowerBound+" - "+t.range.upperBound+"]"):e="<="+t.range.upperBound:e=">="+t.range.lowerBound);return e}function I(t,e){var n=true;t.range&&(t.range.lowerBound&&t.range.lowerBound===t.range.upperBound?n=t.range.lowerBound===e.length:void 0===t.range.lowerBound||t.range.upperBound?void 0===t.range.upperBound||t.range.lowerBound?void 0!==t.range.lowerBound&&void 0!==t.range.upperBound&&(n=e.length>=t.range.lowerBound&&e.length<=t.range.upperBound):n=e.length<=t.range.upperBound:n=e.length>=t.range.lowerBound);return n}function x(t,e){e.length=0;t.getLoadedLinkInfo(t).then(function(n){s.getConstraintFieldBindingValues(t.model.parent.app,n.bindings).then(function(t){for(var i=0;i<n.bindings.length;i++){var a=t[i];var s={fieldName:n.bindings[i].selectAppParamName,values:a.fieldValues,hasConstraint:!a.noConstraint,constraint:y(n.bindings[i]),bindingPassesConstraint:I(n.bindings[i],a.fieldValues)};e.push(s)}})})}function q(t,e,n){return s.renameGenApp(t,e,n)}function w(t){var e=t.parentContext.app;return s.clearSelections(e).then(function(){var n=[];for(var a=0;a<t.selectionsState.length;a++){var o=t.selectionsState[a];var r=o.selectionAppParamName;var l=o.values;n.push(s.selectFieldValuesForField(e,r,l))}return i.all(n)})}l={ODAG_STATE:u,ODAG_TERMINAL_STATES:d,updateItemHeader:p,loadGeneratedApps:S,stopLoadGeneratedApps:b,deleteGeneratedApp:h,reloadApp:g,getSelections:f,getSelectedValuesDisplayString:v,generateApp:m,renameGenApp:q,applySelections:w,initializeBindings:x};return l}])}.apply(e,i),void 0!==a&&(t.exports=a))},362:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(95),n(93),n(122),n(94),n(120),n(215),n(301),n(143)],a=function(t,e,n,i,a,s,o,r,l,c){var u=false;var d=false;var p={userId:void 0,userDirectory:void 0};function h(t){var n=e.getService("qvAppViewService");n.blockScrollIntoView=true;n.activeId=t.qInfo.qId;n.lastActiveId=t.qInfo.qId;n=null}function g(t){u=t}var f={update:function t(){return r.getList().then(function(t){return t.getLayout().then(function(t){f.all.approvedStories=t.filter(l.filterApproved).sort(l.sortByRank);f.all.publishedStories=t.filter(l.filterMyPublishedCommunity(p)).sort(l.sortPublishedTime);f.all.privateStories=t.filter(l.filterPrivate).sort(l.sortByRank);f.all.communityStories=t.filter(l.filterCommunity(p)).sort(l.sortCommunity(1));f.all.mashed=[];if(f.current)for(var e=0;e<Object.keys(f.all).length;e++){var i=f.all[Object.keys(f.all)[e]];for(var a=0;a<i.length;a++)f.all.mashed.push(i[a])}n.publish("/data/story-list-layout-changed")})})},all:{mashed:[],approvedStories:[],publishedStories:[],privateStories:[],communityStories:[]},privateStories:[],current:{},currentIndex:function t(){for(var e=0;e<f.all.mashed.length;e++)if(f.current.id===f.all.mashed[e].qInfo.qId)return e;return 0},hasPrevious:function t(){return f.currentIndex()>0},hasNext:function t(){return f.currentIndex()<f.all.mashed.length-1},getPrevious:function t(){if(f.hasPrevious())return f.all.mashed[f.currentIndex()-1];return null},getNext:function t(){if(f.hasNext())return f.all.mashed[f.currentIndex()+1];return null},getFirst:function t(){return f.all.mashed[f.currentIndex()]},getLast:function t(){return f.all.mashed[f.all.mashed.length-1]},navigate:function e(){if(u)return;var n=f.all.mashed.length-f.all.communityStories.length-1;var i=f.current===f.getFirst()?f.getNext():f.currentIndex()<n?f.getNext():f.currentIndex()===n?f.getPrevious():null;var o=s.view===s.Views.story;if(i){if(o){h(i);r.get(i.qInfo.qId).then(function(t){a.goToStory(t.id,Object.keys(s.States)[s.state])})}}else{var l=t(".qv-pop-appview").scope();l&&l.closeView();l=null;o&&a.goToOverview()}},communitySort:function t(e,n){var i=f.all.communitySheets.sort(l.sortCommunity(e));n&&i.reverse();f.all.communitySheets=i}};var v={update:function t(){return o.getList().then(function(t){return t.getLayout().then(function(t){v.all.approvedSheets=t.filter(l.filterApproved).sort(l.sortByRank);v.all.publishedSheets=t.filter(l.filterMyPublishedCommunity(p)).sort(l.sortPublishedTime);v.all.privateSheets=t.filter(l.filterPrivate).sort(l.sortByRank);v.all.communitySheets=t.filter(l.filterCommunity(p)).sort(l.sortCommunity(1));v.all.mashed=[];if(v.current)for(var e=0;e<Object.keys(v.all).length;e++){var i=v.all[Object.keys(v.all)[e]];for(var a=0;a<i.length;a++)v.all.mashed.push(i[a])}n.publish("/data/sheet-list-layout-changed",v.all.mashed)})})},all:{mashed:[],approvedSheets:[],publishedSheets:[],privateSheets:[],communitySheets:[]},privateSheets:[],current:{},getNumberOfSheets:function t(){return v.all.mashed.length},currentIndex:function t(){for(var e=0;e<v.all.mashed.length;e++)if(v.current.id===v.all.mashed[e].qInfo.qId)return e;return 0},hasPrevious:function t(){return v.currentIndex()>0},hasNext:function t(){return v.currentIndex()<v.all.mashed.length-1},getPrevious:function t(){if(v.hasPrevious())return v.all.mashed[v.currentIndex()-1];return null},getNext:function t(){if(v.hasNext())return v.all.mashed[v.currentIndex()+1];return null},getFirst:function t(){return v.all.mashed[0]},getLast:function t(){return v.all.mashed[v.all.mashed.length-1]},getById:function t(e){for(var n=0;n<v.all.mashed.length;n++)if(v.all.mashed[n].qInfo.qId===e)return v.all.mashed[n];return null},navigate:function e(){if(u)return;var n=v.all.mashed.length-v.all.communitySheets.length-1;var i=v.current===v.getFirst()?v.getNext():v.currentIndex()<n?v.getNext():v.currentIndex()===n?v.getPrevious():null;var r=s.view===s.Views.sheet||s.view===s.Views.object||s.view===s.Views.masterObject;if(i){if(r){h(i);o.get(i.qInfo.qId).then(function(t){a.goToSheet(t.id,Object.keys(s.States)[s.state])})}}else{var l=t(".qv-pop-appview").scope();l&&l.closeView();l=null;r&&a.goToOverview()}},navigateToSheet:function t(e){if(e){h(e);o.get(e.qInfo.qId).then(function(t){a.goToSheet(t.id,Object.keys(s.States)[s.state])})}},communitySort:function t(e,n){var i=v.all.communitySheets.sort(l.sortCommunity(e));n&&(i=i.reverse());v.all.communitySheets=i}};function m(){if(d)return Promise.resolve();s.SheetChanged.bind(function(t){v.current=t});s.StoryChanged.bind(function(t){f.current=t});c.onDataReceived.then(function(t){if("NONE"!==t.userDirectory){p.userId=t.userId;p.userDirectory=t.userDirectory}});return i.getApp().then(function(){return Promise.all([v.update(),f.update()]).then(function(){return Promise.all([o.getList(),r.getList()]).then(function(t){var e=t[0];e.Invalidated.bind(v.update);var n=t[1];n.Invalidated.bind(f.update);d=true;return d})})})}var b={isInitialized:function t(){return d},init:m,Sheets:v,Stories:f,suspendNavigation:g};e.service("$navigationService",function(){return b});return b}.apply(e,i),void 0!==a&&(t.exports=a))},363:function(t,e,n){"use strict";var i,a;!(i=[n(91),n(273),n(90),n(11)],a=function(t,e,n,i){return{activatePopover:a,createPlaceHolder:o,getMultiPopoverItems:r,openMultiStatePopover:l,getAllStatesFromSelections:c,getAllSelectionsInStates:u,groupSelectionsByField:d,openListboxPopover:p,getIndexByKey:h,getDisplayStateName:s};function a(t,e,n,i,a,s){return t.showField(e,i.model.app.enigmaModel,n,{qStateName:s},function(){i.activeFieldName="";a(function(){i.closeTooltip()},100)})}function s(n){return n===e.DEFAULT_STATE_NAME?t.get(e.DEFAULT_STATE_TRANSLATION):n}function o(t,e,n){t.isPlaceHolder=true;t.active=false;t.qLocked=false;t.feedbackActive=false;t.translation="";t.qTotal=0;t.qStateCounts=0;e&&(t.qField=e);n&&(t.name=n);return t}function r(t,e){t=t||[];var n=t.filter(function(t){return t.qField===e})[0];var i=[];n&&n.states&&(i=n.states.map(function(t){t.isSingleState=true;t.displayStateName=s(t.stateName);return t}));return i}function l(t,e,n,i,a){var s=t.show({alignToElement:n,clear:a.clear,click:a.click,onClose:a.onClose,openTooltip:a.openTooltip,closeTooltip:a.closeTooltip,handleKeyDown:a.handleKeyDown,getItems:e,brightCurSel:i});return s}function c(t,e){e=e||null;var i=[];e&&(t=t.filter(function(t){return t.qField===e}));t.forEach(function(t){t.states?t.states.forEach(function(t){i.push(t.stateName)}):i.push(t.stateName)});i=n.getUnique(i);return i}function u(t){var e=[];(t.selectionsInStates||[]).forEach(function(t){t.qSelectionObject.qSelections.forEach(function(e){e.stateName=t.stateName});e=e.concat(t.qSelectionObject.qSelections)});return e}function d(t){var e={};t.forEach(function(t){var n=e[t.qField];n=n||{states:[],qField:t.qField};n.states.push(t);e[t.qField]=n});var n=Object.keys(e).map(function(t){var n=e[t];var i=n.states;if(1===i.length){n=n.states[0];n.isSingleState=true;n.isDefaultState="$"===i[0].stateName}else n.name=i[0].name;return n});return n}function p(t,e,n,a,s,o,r){if(n)return t(r.listboxPopoverServiceMobile,s,o,e,r.$timeout,a).catch(function(t){false});return t(r.listboxPopoverService,s,o,e,r.$timeout,a).then(function(t){var n;t.closing.then(function(t){t&&!i(t.target).closest(".current-selections-item").length>0&&(e.activeFieldName="");n=t}).catch(function(t){false});t.closed.then(function(){if(e.onCloseFocusSelector){i(e.onCloseFocusSelector).focus();e.onCloseFocusSelector=null}else e.activeFieldName&&i('.item[data-csid="'+e.activeFieldName+'"]').focus();t=null;n||(e.activeFieldName="")}).catch(function(t){false});t.opened.catch(function(t){false})}).catch(function(t){false})}function h(t,e,n){if([void 0,null].contains(e)||[void 0,null].contains(n))throw new Error("unaccepted key or val ( key: "+e+", val: "+n+")");var i=t.map(function(t){return t[e]});return i.indexOf(n)}}.apply(e,i),void 0!==a&&(t.exports=a))},364:function(t,e,n){"use strict";var i,a;!(i=[n(89),n(97)],a=function(t,e){var n={template:null,controller:["$scope","$element","$timeout",function(n,i,a){var s=this;n.input.selectionsActivated=function(){};n.input.selectionsDeactivated=function(){};s.close=function(){o()};function o(){a(function(){n.destroyComponent();i.remove()});e.off("start.listbox-popover-error",o)}function r(){return a(function(){return i.find(".toolbar-wrapper").outerWidth()})}var l=n.input.onPopoverClose;var c=null;n.closingDeferred.promise.then(function(t){c&&c();l(t);o()});t.all({object:n.input.getVisualization(),width:r()}).then(function(t){var i=t.object,a=t.width;i.getSelectionToolbar().then(function(t){n.toolbar=t;n.toolbar.showLock=n.input.options.showLock;n.toolbar.position={width:a};i.activateSelections()});i.loaded.then(function(){i.ext.hasError(i)&&e.on("start.listbox-popover-error",o)});i.selectionsApi.watchActivated(function(){n.input.selectionsActivated()});i.selectionsApi.watchDeactivated(function(){n.input.selectionsDeactivated();o()});c=function t(){i.selectionsApi.confirm()}})}]};return n}.apply(e,i),void 0!==a&&(t.exports=a))},365:function(t,e){t.exports='<lui-popover\n\t\tclass="qv-listbox-popover"\n\t\tstyle="min-width: 200px;width: 234px;height: 332px"\n\t\ton-close-view="closeView(event)"\n\t\tqva-outside-ignore-for="{{input.qvaOutsideIgnoreFor}}"\n\t\tqva-mouse-wheel-outside="close()">\n\t<lui-popover-body style="height: 332px" class="lui-nopad">\n\t\t<qv-spinner show="!input.model" spinner-height="100px" spinner-width="100px" show-Delay="300" center-in-parent="true"></qv-spinner>\n\t\t<div class="toolbar-wrapper"\n\t\t\t qva-include-selection-toolbar\n\t\t\t component="input.selectionToolbarComponent"\n\t\t\t toolbar="toolbar"\n\t\t\t options="input.options"></div>\n\t\t<div class="listbox-wrapper">\n\t\t\t<qv-object object="object" model="input.model" options="input.options"></qv-object>\n\t\t</div>\n\t</lui-popover-body>\n</lui-popover>\n'},366:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95)],a=function(t,e){t.service("qvCaoSelectionService",[function(){var t={sendSelectedChartChangeEvent:function t(){e.publish("cao/insight/selectedChartChanged",this.selectedChart)},getSelectedChart:function t(){return this.selectedChart},selectChart:function t(e){this.selectedChart=e;this.sendSelectedChartChangeEvent()},clearSelection:function t(){if(this.selectedChart){this.selectedChart=void 0;this.sendSelectedChartChangeEvent()}}};return t}])}.apply(e,i),void 0!==a&&(t.exports=a))},367:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(89),n(875)],a=function(t,e,n){function i(t,e,n){this.visualization=t;this.searchReport=e;this.options=t.options;this.type="generated";this.analysisPrecedentId=t.matchRecord.analysisPrecedentId;this.appearsOnSheets=[];this.properties=n}i.prototype.getTitle=function(){var t=this.visualization.analysis.titleTemplate;var i=this.visualization.matchRecord.matches;return e.resolve(n.findTitleForChart(t,i))};i.prototype.getMatchDetails=function(){var t=[];if(this.searchReport.search){var e=this.searchReport.search.fieldLibItemFinder.searchHits;this.visualization.matchRecord.matches.forEach(function(n){var i=n.field;n.libId&&(i=n.libId+"- "+n.libIdLabel);var a=e[i];a&&t.push({matchedOn:a.matchingTypes[0],matchedField:n.field||n.libIdLabel})})}return t};i.prototype.getChartType=function(){return e.resolve(this.properties.visualization)};i.prototype.loadChart=function(n){var i=new e;var a=t.getService("qvCaoChartService");var s=this;s.getTitle().then(function(t){a.buildInsightChart(t,n,s.properties).then(function(t){i.resolve(t)})});return i.promise};return i}.apply(e,i),void 0!==a&&(t.exports=a))},368:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(369)],a=function(t,e){t.service("qvCaoComplexityEstimatorService",[function(){var t;var n=[];var i=/aggr|rangeSum|FirstSortedValue/gi;function a(t){t.getFieldList().then(function(t){n=t})}function s(t){var e=n.filter(function(e){return e.qName===t});return e[0]&&e[0].qCardinal?e[0].qCardinal:0}function o(t){var n=e.classify(t);var a=0;var s=false;n.results.forEach(function(t){(-1!=t.content.search(i)||t.remainder&&-1!=t.remainder.content.search(i))&&(s=true);(t.function&&""!=t.function.content||t.isOperator)&&a++});return a*(s?3:1)}function r(t){var e=o(t.expr);var n=s(t.field,t)*e;return n*(e+1)}var l=function t(e){var n=0;e.analysis.dims&&e.analysis.dims.forEach(function(t){n+=r(t)});e.analysis.msrs&&e.analysis.msrs.forEach(function(t){n+=r(t)});return n};t={init:a,estimateComplexity:l};return t}])}.apply(e,i),void 0!==a&&(t.exports=a))},369:function(t,e,n){"use strict";var i,a;!(i=[n(54),n(407),n(187),n(178),n(408)],a=function(t,e,n,i,a){var s={};var o={classify:r};return o;function r(n){if(!t.isString(n))throw new Error("Expression-classifier: Expression must be a string");var i=n;if(s[i])return s[i];var o={content:n,count:0,result:{},results:[]};if(""===n){s[i]=o;return o}"="===n.charAt(0)&&(n=n.substr(1));var r=a.stripComments(n);var c=e.tokenize(r);o.count=c.length;c.forEach(function(t,e){var n;if(t.isOperator)o.results.push(t);else{n=l(t.content);o.results.push(n)}0===e&&(o.result=n)});s[i]=o;return o}function l(t){var e={content:t,function:{content:"",isCommon:false},remainder:{content:"",isFunction:false,isCommonFunction:false,isCommaSeparated:false,isFieldlike:false,isString:false,isNumber:false,isQualifier:false,qualified:{qualifier:"",content:"",isFieldlike:false}}};var n=c(t);if(n.hasAggregation){e.function.content=u(t,n);e.function.isCommon=v(e.function.content);e.remainder.content=d(t,n);var i=c(e.remainder.content);e.remainder.isFunction=b(i);e.remainder.isCommonFunction=S(e.remainder.content,i);e.remainder.isQualifier=h(e.remainder.content);e.remainder.isCommaSeparated=m(e.remainder.content);if(e.remainder.isQualifier){var a=g(e.remainder.content),s=f(e.remainder.content,a),o=c(s);e.remainder.qualified={qualifier:a,content:s,isFieldlike:y(o)}}n=i}else e.remainder.content=e.content;e.remainder.isFieldlike=y(n);e.remainder.isString=I(e.remainder.content);e.remainder.isNumber=x(e.remainder.content);return e}function c(t){var e={};e.expression=t;e.hasPrefix="="===t.charAt(0);e.leftSymbolIndex=t.indexOf(n.SYMBOLS.FUNCTION.LEFT);e.hasAggregation=e.leftSymbolIndex>0;e.isRightSymbolLast=t.substring(t.length-1)===n.SYMBOLS.FUNCTION.RIGHT;e.isEncapsulated=e.hasAggregation&&e.isRightSymbolLast;e.hasOperator=p(t);return e}function u(t,e){var n=e.hasPrefix?1:0,i=e.hasPrefix?e.leftSymbolIndex+1:e.leftSymbolIndex;return t.substr(n,i).trim()}function d(t,e){var n=t.substr(e.leftSymbolIndex),i=n.substr(1,n.length-2);return i.trim()}function p(t){var e=n.OPERATORS,i=e.SINGLES,a=e.MULTIPLES,s=e.WORDS;var o=i.some(function(e){return t.indexOf(e)>-1});if(o)return true;var r=a.some(function(e){return t.indexOf(e)>-1});if(r)return true;var l=s.some(function(e){return t.indexOf(" "+e+" ")>-1});return l}function h(t){return n.QUALIFIERS.some(function(e){return 0===t.toLowerCase().indexOf(e)})}function g(t){var e=n.QUALIFIERS.filter(function(e){return 0===t.toLowerCase().indexOf(e)}).shift();return e}function f(t,e){return t.slice(e.length).trim()}function v(t){return n.COMMON_FUNCTIONS.some(function(e){return t.toLowerCase()===e})}function m(t){var e=i.getCharacterIndexes(t,",");return e.some(function(e){return!P(t,e)})}function b(t){return t.isEncapsulated&&!t.isBleedingOperator}function S(t,e){if(!e.isEncapsulated)return false;var n=t.substr(0,e.leftSymbolIndex);return v(n)}function y(t){var e=t.expression;if(I(t.expression))return false;var a=q(e,n.SYMBOLS.FIELD.LEFT),s=w(e,n.SYMBOLS.FIELD.RIGHT),o=i.getCharacterCount(e,n.SYMBOLS.FIELD.LEFT),r=i.getCharacterCount(e,n.SYMBOLS.FIELD.RIGHT);if(a&&s&&1===o&&1===r)return true;return C(t)}function I(t){var e=q(t,n.SYMBOLS.STRING.LEFT),a=w(t,n.SYMBOLS.STRING.RIGHT),s=n.SYMBOLS.STRING.LEFT===n.SYMBOLS.STRING.RIGHT,o=i.getCharacterCount(t,n.SYMBOLS.STRING.LEFT),r;if(s)r=2===o;else{var l=i.getCharacterCount(t,n.SYMBOLS.STRING.RIGHT);r=1===o&&1===l}return e&&a&&r}function x(t){return!Number.isNaN(+t)}function q(t,e){return t.charAt(0)===e}function w(t,e){return t.charAt(t.length-1)===e}function C(t){if(t.hasAggregation)return false;var e=t.expression,i=e.indexOf(" ")>-1;if(i)return false;var a=n.OPERATORS.SINGLES.concat(n.OPERATORS.MULTIPLES).some(function(t){return e.indexOf(t)>-1});return!a}function P(t,e){return Object.keys(n.SYMBOLS).some(function(a){var s=n.SYMBOLS[a];return i.getIsCharacterEncapsulated(t,e,s.LEFT,s.RIGHT)})}}.apply(e,i),void 0!==a&&(t.exports=a))},370:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(894),n(169)],a=function(t,e){t.directive("qvGlobalSearchHighlights",function(){return{restrict:"E",template:e,replace:true,scope:{qText:"=",qRanges:"="},link:function e(n){var i=t.getService("qvGlobalSearchDataService").getMaxColorsNum();n.slices=null;n.$watch("qRanges",function(t){if(t){var e=0,s=[],o=t.sort(function(t,e){return t.qCharPos-e.qCharPos});for(var r=0;r<o.length;r++){var l=o[r];l.qCharPos>e&&s.push({qTerm:-1,qSliceText:n.qText.slice(e,l.qCharPos),highlight:false,iStart:e,iEnd:l.qCharPos});e=l.qCharPos+l.qCharCount;var c={qTerm:l.qTerm%i,highlight:true,qSliceText:n.qText.slice(l.qCharPos,e),iStart:l.qCharPos,iEnd:e};a(s,c);r===t.length-1&&e<n.qText.length&&s.push({qTerm:-1,qSliceText:n.qText.slice(e,n.qText.length),highlight:false,iStart:e,iEnd:n.qText.length})}n.slices=s}});function a(t,e){var n=null;for(var i=0;i<t.length;i++)if(t[i].iStart===e.iStart){n=t.splice(i,1,e);break}n||t.push(e)}}}})}.apply(e,i),void 0!==a&&(t.exports=a))},371:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(99),n(96)],a=function(t,e,n){t.directive("qvaSmartSearchSwipeHorizontal",["$parse",function(t){var i={up:false,down:false,right:true,left:true};return{restrict:"A",link:function a(s,o,r){var l=t(r.qvaSmartSearchSwipeHorizontal);function c(t,e){if(i[e.swipe.direction]){var a=e.swipe.curDeltaX>0?-1:0===e.swipe.curDeltaX?0:1;l(s,{delta:a});n.preventGestures(this.gestureHandler)}}e.treatAsDesktop()||n(o[0]).swipe({options:{radiusThreshold:50,preventDefault:false,useMomentum:true},start:c});s.$on("$destroy",function(){n(o[0]).off()})}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},372:function(t,e,n){"use strict";var i,a;!(i=[n(2)],a=function(t){var e=function t(){};e.parseQuery=function(e,n){var i={text:e,appId:n};var a={method:"POST",url:"/api/v1/sentences",data:i};return t.request(a).then(function(t){var e=t.data;return e}).catch(function(t){throw t})};e.getQueries=function(e,n){var i="?limit="+e+"&appId="+n;var a={method:"GET",url:"/api/v1/sentences"+i};return t.request(a).then(function(t){var e=t.data.data;return e}).catch(function(t){throw t})};return e}.apply(e,i),void 0!==a&&(t.exports=a))},373:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91)],a=function(t,e){t.service("qvCaoLearningConfidenceService",[function(){var t;var n={HIGH:{value:10,text:"high"},MEDIUM:{value:5,text:"medium"},LOW:{value:2,text:"low"},EMPTY:{value:0,text:"empty"}};function i(t){var e=t.getRelevance();var i=t.getMatchRecord();var a=n.EMPTY;if(t.isModified()){a=n.EMPTY;return a.text}1===e?a=n.HIGH:e>=.5?a=n.HIGH:e>0&&(a=n.HIGH);i.precedentStats&&(i.precedentStats.matchedFields===i.matches.length?a=n.HIGH:i.precedentStats.matchedFields>0&&a.value<n.MEDIUM.value&&(a=n.HIGH));return a.text}function a(t,n,i,a){var s={search:[],learned:[]};var o=t.field||t.libIdLabel;var r="";var l=i.filter(function(t){return t.matchedField===o})[0];var c=!!t.libIdLabel;var u=c?t.libId:null;if(l){switch(l.matchedOn){case"absoluteExactMatchCaseSensitive":r=e.get("cao.search.generated.absoluteExactMatchCaseSensitive");break;case"absoluteExactMatch":r=e.get("cao.search.generated.absoluteExactMatch");break;case"exactMatch":r=e.get("cao.search.generated.exactMatch");break;case"literalMatch":r=e.get("cao.search.generated.literalMatch");break;case"headMatch":r=e.get("cao.search.generated.headMatch");break;case"headSynonymMatch":r=e.get("cao.search.generated.headSynonymMatch");break;case"headStemMatch":r=e.get("cao.search.generated.headStemMatch");break;case"headStemSynonymMatch":r=e.get("cao.search.generated.headStemSynonymMatch");break;case"partialTokenMatch":r=e.get("cao.search.generated.partialTokenMatch");break;case"substrPartialMatch":r=e.get("cao.search.generated.substrPartialMatch");break;case"semanticMatch":r=e.get("cao.search.generated.semanticMatch");break;case"valueMatch":r=e.get("cao.search.generated.valueMatch");break;default:break}if(r){r=r.replace(/\{1\}/g,function(t){return"<b>"+t+"</b>"});var d=e.get(r,[n.search.searchPhrase.text,l.matchedField]);s.search.push({text:d,field:l.matchedField,priority:1,type:t.slotRole,isLibItem:c,libItemId:u,searchMatch:true})}}if(t.appPrecedent&&t.appPrecedent.appPrecedent){var p=false;if(t.appPrecedent.userDefined&&t.appPrecedent.userDefined.isUserDefined&&t.appPrecedent.userDefined.relations.indexOf("define")>-1){p=true;r=t.aggr||"measure"===t.slotRole?e.get("cao.confidence.reason.defined_measure"):e.get("cao.confidence.reason.defined_dimension")}else r=t.aggr||"measure"===t.slotRole?e.get("cao.confidence.reason.learned_measure"):e.get("cao.confidence.reason.learned_dimension");r=r.replace(/\{0\}/g,function(t){return"<b>"+t+"</b>"});s.learned.push({text:e.get(r,o),field:o,priority:1,type:t.slotRole,isLibItem:c,libItemId:u,userMatch:p})}if(0===s.learned.length&&a){r=t.aggr||"measure"===t.slotRole?e.get("cao.confidence.reason.assumed_measure"):e.get("cao.confidence.reason.assumed_dimension");r=r.replace(/\{0\}/g,function(t){return"<b>"+t+"</b>"});s.learned.push({text:e.get(r,o),field:o,priority:0,type:t.slotRole,isLibItem:c,libItemId:u})}return s}t={getReasonForSelectingField:a,determineConfidence:i,confidenceLevels:n};return t}])}.apply(e,i),void 0!==a&&(t.exports=a))},374:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(936),n(103)],a=function(t,e,n,i){t.nativeComponent("qvCaoRefreshIndicator",{bindings:{},controller:[function(){this.refresh=function(){i.trackEvent(i.customEvents.INSIGHTS_REFRESH_CLICKED);e.publish("cao/insight/refresh")}}],template:n})}.apply(e,i),void 0!==a&&(t.exports=a))},375:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(89),n(971)],a=function(t,e,n){var i=null;var a=null;function s(s){var o={id:s.id,type:s.type,canCopy:function t(){return false},canCut:function t(){return false},canRemove:function t(){return true},remove:function t(){s.model.removeObject()},getAllPropertyPanelContent:function o(){if(!i){i=t.getService("$cacheFactory");a=i("pp-navPoint")}return e.all({properties:s.model.getProperties(),layout:s.model.getLayout()}).then(function(t){var e={definition:n,iconClass:"lui-icon lui-icon--sign-post",titleRef:"qMeta.title",properties:t.properties,layout:t.layout,model:s.model,cache:a,type:s.invalid?"invalid":"odagNavPoint"};return e})}};return o}return{createSelectedObjFromNavPoint:s}}.apply(e,i),void 0!==a&&(t.exports=a))},379:function(t,e,n){"use strict";var i,a;!(i=[n(95),n(92),n(117),n(254),n(89),n(108),n(90),n(91),n(11),n(155),n(105),n(182)],a=function(t,e,n,i,a,s,o,r,l,c,u,d){var p={};var h=e.extend("DataPrepService",{init:function t(e,n){e=e||o.getParameterByName("app");n=n||h.connectOptions;n.route="app/"+encodeURIComponent(e).toLowerCase();n.responseInterceptors=[{onRejected:function t(e,n,i){i.isHandled=true;return a.reject(i)}}];this.session=i.get(null,n);var s=this;this._callbacks=l.Callbacks();this.waitForOpen=new a;this.waitForResume=new a;this.waitForResume.resolve(s);this.restService=new c;document.addEventListener("onAppStateChanged",function(t){if(t.detail&&t.detail.inForegroundNow)s.session.resume(false).then(function(){s.waitForResume.resolve(s)});else if(t.detail&&!t.detail.inForegroundNow){s.session.suspend();s.waitForResume=new a}});function u(t){t=t||{};t.isHandled=true;t.message=r.get("DataPrep.Recommendations.ConnectionLostToDPS");s.waitForOpen.reject(t)}function d(){s.waitForOpen.resolve(s)}function p(t){var e=t.error;if(e){e.isHandled=true;-32e3!==e.code&&(e.dpsError=true)}}this.session.Error.bind(p);this.session.Close.bind(u);this.session.Open.bind(d);s.waitForResume.promise.then(function(){if(n.serverNodeId){var t=[];t.push(n.serverNodeId);s.rpc("setServerNodeId",t)}});this.session.enigmaPromise.then(d).catch(u)},rpc:function e(n,i){var a={method:n,params:i||[]};var s=this;return s.waitForResume.promise.then(function(){return s.session.rpc(a).then(function(e){if(e.result&&e.result.notification&&1005===e.result.notification.data.code){t.publish(u.Events.PubSub.StartSpin,{method:n});var a=i.length&&i.length>1&&i[1].forceReload;true===a&&(i[1].forceReload=false);return s.executeAfterReload(n,i).finally(function(){t.publish(u.Events.PubSub.StopSpin,{method:n})})}return e})})},rpcWithPolling:function e(n,i,a){a&&t.publish(u.Events.PubSub.StartSpin,{method:n});var s=true;var o=void 0;var r=function e(){a&&t.publish(u.Events.PubSub.StopSpin,{method:n})};o=setInterval(function(){s&&this.getProgress().then(function(){})}.bind(this),15e3);var l=function t(){s=false;void 0!==o&&clearInterval(o);o=void 0};return this.rpc(n,i).then(function(t){l();r();return t},function(t){l();r();throw t})},executeAfterReload:function t(e,n){var i=new a;this.waitForReload(i);return i.promise.then(function(){return this.rpc(e,n)}.bind(this))},_checkProgress:function t(e){var n=false;e.engine&&e.engine.qProgressData&&e.engine.qProgressData.qFinished&&true===e.dps.dataLoad.complete&&true===e.dps.profiling.complete&&(n=true);return n},waitForReload:function t(e){this.getProgress().then(function(t){this._checkProgress(t.result)?e.resolve(true):setTimeout(function(){this.waitForReload(e)}.bind(this),1e3)}.bind(this),function(t){e.reject(t)})},augmentOptions:function t(e){e["throwOnReload"]=true;return e},getProgress:function t(){return this.rpc("getProgress",[0])},getModel:function t(e){return this.rpc("getModel",[e||{}])},setModel:function t(e,n){return this.rpc("setModel",[e,n||{}])},initModel:function t(e,n){return this.rpc("initModel",[e,n||{}])},analyzeModel:function t(e,n){return this.rpc("analyzeModel",[e,n||{}])},getTargetTables:function t(e,n){return this.rpc("getTargetTables",[e,this.augmentOptions(n)||{}])},warmUpDPS:function t(e,n){return this.rpc("getTargetTables",[e,this.augmentOptions(n)||{}]).catch(function(t){t.error.dpsHandled=true;console.log("Warming up DPS ignored this error: ");console.log(t);throw t})},getTablePreview:function t(e,n,i){return this.rpc("getTablePreview",[e,n,this.augmentOptions(i)||{}])},getTableFields:function t(e,n,i){return this.rpc("getTableFields",[e,n,this.augmentOptions(i)||{}])},getLoadScript:function t(e,n){return this.rpc("getLoadScript",[e,n||{}])},getClassifications:function t(e){return this.rpc("getClassifications",[e])},getRestService:function t(){return this.restService},getVisRecommendations:function t(e,n){return this.rpc("getVisRecommendations",[e,n])},adaptVisualization:function t(e,n){return this.rpc("adaptVisualization",[e,n])},syncLoadModel:function t(e){return this.rpc("syncLoadModel",[e])},getRecommendations:function t(e,n){return this.rpcWithPolling("getRecommendations",[e,this.augmentOptions(n)||{}],true)},getDataPreview:function t(e){return this.rpc("getDataPreview",[e])},updateSources:function t(e,n,i){return this.rpcWithPolling("updateSources",[e,n,i||{}])}});h.getConnectOptions=function(){if(h.connectOptions){var t=new a;t.resolve(h.connectOptions);return t.promise}return n.global.getConfiguration().then(function(){h.connectOptions={host:o.hostname,isSecure:o.isSecure,prefix:o.basePath,port:o.port,subpath:"dataprepservice",reloadURI:o.reloadURI,serverNodeId:d.getServerNodeId()};return h.connectOptions})};h.isRunning=function(){var t=new c;return t.isRunning()};h.get=function(t,e){return h.getConnectOptions(e).then(function(e){t=t||o.getParameterByName("app");t=f(t);var n=p[t.toLowerCase()]||new h(t,e);p[t.toLowerCase()]=n;return n.waitForOpen.promise})};var g=".qvw";function f(t){if(s.isPersonalModeSync()&&-1!==t.indexOf(g,t.length-g.length))return t.substr(0,t.length-1)+"f";return t}return h}.apply(e,i),void 0!==a&&(t.exports=a))},380:function(t,e,n){"use strict";var i,a;!(i=[n(91)],a=function(t){function e(t){return"MessageCode."+(t||0)}function n(n){var i=t.get(e(n.qMessageCode),n.qMessageParameters);return i}function i(t){var e="";if(t)for(var i in t){e+=n(t[i]);i<t.length-1&&(e+="\n")}return e}function a(t){t=Math.floor(t);return t>9?""+t:"0"+t}function s(t){var e,n;var i=[];var a=[];for(e in t){n=t[e];!n.qErrorString||!n.qLine||(a[n.qLine]=true)}for(e in t){n=t[e];!n.qErrorString&&a[n.qLine]||i.push(n)}return i}return{translateMessage:n,translateMessageArray:i,formatNum:a,filterOutDuplicates:s}}.apply(e,i),void 0!==a&&(t.exports=a))},392:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(409)],a=function(t,e){t.directive("qvStateCountBar",function(){return{restrict:"E",template:e,replace:true,scope:{stateCounts:"=",options:"="},link:function t(e){e.percents=[];e.$watchCollection("stateCounts",function(){n()});function n(){var t=e.stateCounts,n;if(!t)return;n=a(t);e.percents=s(n)}function i(t){return Object.keys(t).reduce(function(e,n){return e+t[n]},0)}function a(t){var e=i(t),n={};["qSelected","qLocked","qOption","qAlternative"].forEach(function(i){var a=t[i]||0,s=Math.round(a/e*100);a>0&&0===s&&(s=1);n[i]=s});return n}function s(t){var e={},n,i,a=0;for(n in t){e[n]=t[n];(!i||t[n]>t[i])&&(i=n);a+=t[n]}a>100&&(e[i]=t[i]-(a-100));return e}}}})}.apply(e,i),void 0!==a&&(t.exports=a))},393:function(t,e,n){"use strict";var i,a;!(i=[n(10),n(48)],a=function(t,e){var n=document.createElement("textarea");n.style.position="absolute";n.style.left="-9999px";n.setAttribute("readonly","");function i(t){n.value=t;document.body.appendChild(n);n.select();n.setSelectionRange(0,n.value.length);document.execCommand("copy");document.body.removeChild(n)}e.service("qvCopy",["$window",function(e){var n=t.element(e.document.body);var i=t.element("<textarea/>");i.css({position:"fixed",opacity:"0"});return function(t){i.val(t);n.append(i);i[0].select();try{var e=document.execCommand("copy");if(!e)throw e}catch(e){window.prompt("Copy to clipboard: Ctrl+C, Enter",t)}i.remove()}}]);e.directive("qvClickCopy",["qvCopy",function(t){return{restrict:"A",link:function e(n,i,a){i.bind("click",function(){t(a.qvClickCopy)})}}}]);return{copyToClipboard:i}}.apply(e,i),void 0!==a&&(t.exports=a))},396:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(414)],a=function(t){var e=function t(){this.globalDefaults={enableQVDCaching:true}};e.prototype.get=function(){var e=this;return t.getService("qvDataManagerAppStorageService").get("globalDefaults").then(function(t){return t||e.set().then(function(){return e.globalDefaults})})};e.prototype.set=function(e){return t.getService("qvDataManagerAppStorageService").set("globalDefaults",e||this.globalDefaults)};return e}.apply(e,i),void 0!==a&&(t.exports=a))},397:function(t,e){t.exports='<div class="lui-dialog error-dialog" on-close-view="closeView( $event )" qv-escape="handleEscButton( $event )" ng-style="modalStyle" tid="errorDialog">\n\t<div class="lui-dialog__header">\n\t\t<div class="lui-dialog__title" ng-if="title" q-translation="{{title}}"></div>\n\t</div>\n\t<div class="lui-dialog__body dm-main">\n\n\t\t<main ng-if="!html">{{content | translate}}</main>\n\t\t<main ng-if="html" class="qv-appname"></main>\n\n\t</div>\n\n\t<div class="lui-dialog__footer">\n\t\t<lui-button qv-delayed-dialog-button ng-if="!buttons.length && showDefaultButton" ng-click="closeModal( $event, true );" qva-focus="true"\n\t\t\t\t\tq-translation="Common.OK" tid="confirm"></lui-button>\n\t\t<lui-button qv-delayed-dialog-button ng-repeat="button in buttons" qva-focus="button.defaultButton" ng-click="closeModal( $event );" ng-disabled="button.expression === false"\n\t\t\t\t\tq-translation="{{button.name}}" tid="{{button.tid}}"></lui-button>\n\t</div>\n</div>'},405:function(t,e,n){var i;!(i=function(){return function(t,e){if(!t||isNaN(+e))return e;var e="-"==t.charAt(0)?-e:+e;var n=e<0?e=-e:0;var i=t.match(/[^\d\-\+#]/g);var a=i&&i[i.length-1]||".";var s=i&&i[1]&&i[0]||",";var t=t.split(a);e=e.toFixed(t[1]&&t[1].length);e=+e+"";var o=t[1]&&t[1].lastIndexOf("0");var r=e.split(".");(!r[1]||r[1]&&r[1].length<=o)&&(e=(+e).toFixed(o+1));var l=t[0].split(s);t[0]=l.join("");var c=t[0]&&t[0].indexOf("0");if(c>-1)while(r[0].length<t[0].length-c)r[0]="0"+r[0];else 0==+r[0]&&(r[0]="");e=e.split(".");e[0]=r[0];var u=l[1]&&l[l.length-1].length;if(u){var d=e[0];var p="";var h=d.length%u;for(var g=0,f=d.length;g<f;g++){p+=d.charAt(g);!((g-h+1)%u)&&g<f-u&&(p+=s)}e[0]=p}e[1]=t[1]&&e[1]?a+e[1]:"";return(n?"-":"")+e[0]+e[1]}}.call(e,n,e,t),void 0!==i&&(t.exports=i))},407:function(t,e,n){"use strict";var i,a;!(i=[n(54),n(187)],a=function(t,e){var n=s();var i={tokenize:a};return i;function a(e){if(!t.isString(e))throw new Error("Expression-tokenizer: Expression must be a string");e=e.trim();"="===e.charAt(0)&&(e=e.substr(1));var n=[],i=0,a=o(e);a.forEach(function(t){var a=e.substr(i,t.start-i).trim();a&&n.push({content:a,isOperator:false});n.push({content:t.content,isOperator:true});i=t.end});var s=e.substr(i,e.length);n.push({content:s.trim(),isOperator:false});return n}function s(){var t={};for(var n in e.SYMBOLS)if(e.SYMBOLS.hasOwnProperty(n)){var i=e.SYMBOLS[n];t[i.LEFT]=i.RIGHT}return t}function o(t){var e=[];for(var n=0;n<t.length;n++){var i=t.charAt(n);if(r(i)){n=l(t,i,n);continue}var a=[],s=false,o=c(i);a=u(i);if(a.length){var p=t.substr(n).toLowerCase();for(var h=0;h<a.length;h++){var g=a[h],f=d(p,g);if(f){e.push({content:g,start:n,end:n+g.length});s=true;n+=g.length-1;break}}}!s&&o&&e.push({content:i,start:n,end:n+1})}return e}function r(t){return n.hasOwnProperty(t)}function l(t,i,a){var s=i,o=n[s],r=t.substring(a).split(""),l=0,c=false;for(var u=0;u<r.length;u++){var d=r[u];d===e.SYMBOLS.STRING.LEFT&&(c=!c);if(c)continue;d===s&&l++;d===o&&l--;if(!l)return u+a}return a}function c(t){return e.OPERATORS.SINGLES.indexOf(t.toLowerCase())>-1}function u(t){var n=[];var i=e.OPERATORS.MULTIPLES.concat(e.OPERATORS.WORDS).filter(function(t){return t.length>1}).map(function(t){return t.toLowerCase()});i.forEach(function(e){0===e.indexOf(t.toLowerCase())&&n.push(e)});return n}function d(t,n){var i=0===t.indexOf(n+" "),a=e.OPERATORS.SINGLES.some(function(e){return 0===t.indexOf(n+e)});return i||a}}.apply(e,i),void 0!==a&&(t.exports=a))},408:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={stripComments:e};return t;function e(t){if(!t)return"";t=n(t);t=i(t);return t.trim()}function n(t){return t.replace(/\/\/(.*)$/gm,"")}function i(t){return t.replace(/\/\*[^]*?\*\//g,"")}}.apply(e,i),void 0!==a&&(t.exports=a))},409:function(t,e){t.exports='<div class="qv-state-count-bar" tid="stateCount" qva-direction x-dir-setting="{{options.direction}}">\n\t<div class="state selected" ng-style="{\'width\': percents.qSelected + \'%\'}"></div>\n\t<div class="state locked" ng-style="{\'width\': percents.qLocked + \'%\'}"></div>\n\t<div class="state optional" ng-style="{\'width\':  percents.qOption + \'%\'}"></div>\n\t<div class="state alternative" ng-style="{\'width\':  percents.qAlternative + \'%\'}"></div>\n</div>'},414:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(93),n(440)],a=function(t,e){function n(t){return e.getApp().then(function(e){return e.id+"."+t})}function i(t){this.localStorageService=t}i.prototype.get=function(t){var e=this;return n(t).then(function(t){return e.localStorageService.get(t)})};i.prototype.set=function(t,e){var i=this;return n(t).then(function(t){i.localStorageService.set(t,e)})};i.prototype.remove=function(t){var e=this;return n(t).then(function(t){e.localStorageService.remove(t)})};t.service("qvDataManagerAppStorageService",["qvDataManagerLocalStorageService",function(t){return new i(t)}])}.apply(e,i),void 0!==a&&(t.exports=a))},415:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(93),n(89),n(108),n(50)],a=function(t,e,n,i,a){t.service("qvAppDetailsService",["$q",function(t){var a;return{get:function o(){if(!a){a=t.defer();e.getApp().then(function(t){t.global.allowCreateApp().then(function(e){var o;t.getScriptEx().then(function(t){o=t.qMeta.privileges}).catch(function(t){o=false;t.isHandled=true}).then(function(){n.all([t.getLayout()]).then(function(n){var r=n[0];var l={app:{id:t.id,appTitle:r.qTitle,readOnly:r.qReadOnly,hasData:!!r.qHasData,hasScript:!!r.qHasScript,published:r.published},permissions:{createSheet:!r.qReadOnly&&r.permissions.createSheet,createApp:e,update:r.permissions.update,createBookmark:r.permissions.createBookmark,updateScript:i.isPersonalModeSync()&&!o||o&&-1!==o.indexOf("update")}};a.resolve(new s(l))})})})})}return a.promise}}}]);function s(t){this.model=t;this.events={onModelChanged:[]};var n=this;e.getApp().then(function(t){t.Invalidated.bind(function(){t.getLayout().then(function(t){n.model.app.appTitle=t.qTitle;n.model.app.readOnly=t.qReadOnly;n.model.app.hasData=t.qHasData;n.model.app.published=t.published;n.model.permissions.createSheet=!t.qReadOnly&&t.permissions.createSheet;n.model.permissions.update=t.permissions.update;n.events.onModelChanged.forEach(function(e){e&&e(n.model,t)})}).catch(function(t){var e=11e3;t.code===e&&(t.isHandled=true)})})})}s.prototype.appHasData=function(){return this.model.app.hasData};s.prototype.isDataManagerHidden=function(){return a.isSmallDevice||!this.model.permissions.createSheet||!this.model.permissions.update||!this.model.permissions.createApp||!this.model.permissions.updateScript};s.prototype.isScriptEditorHidden=function(){return a.isSmallDevice||!this.model.permissions.createSheet||!this.model.permissions.update||!this.model.permissions.updateScript};s.prototype.isDataModelViewerHidden=function(){return a.isSmallDevice||!this.model.permissions.createSheet||!this.model.permissions.update};s.prototype.isQDLEnabled=function(){return this.model.permissions.update&&this.model.permissions.updateScript&&!a.isSmallDevice&&this.model.permissions.createApp};s.prototype.bindOnModelChanged=function(t){this.events.onModelChanged.push(t)};s.prototype.unbindOnModelChanged=function(t){var e=this.events.onModelChanged.indexOf(t);e>=0&&this.events.onModelChanged.splice(e,1)}}.apply(e,i),void 0!==a&&(t.exports=a))},426:function(t,e,n){"use strict";var i,a;!(i=[n(93),n(89)],a=function(t,e){var n={};return{get:function i(a){var s=a?e.resolve(a.enigmaModel):t.getApp();return s.then(function(t){return n[t.id]=n[t.id]||t.getUndoInfoObject()})}}}.apply(e,i),void 0!==a&&(t.exports=a))},427:function(t,e,n){"use strict";var i,a;!(i=[n(462),n(464),n(467),n(472),n(475)],a=function(){}.apply(e,i),void 0!==a&&(t.exports=a))},428:function(t,e,n){"use strict";"undefined"===typeof Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{enumerable:false,get:function t(){var e=this.toString().match(/^function( (.*?))?\(/);return e&&e.length>=3?e[2]:"anonymous function"}});Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),n=this,i=function t(){},a=function a(){return n.apply(this instanceof i&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};i.prototype=this.prototype;a.prototype=new i;return a});Array.prototype.contains||Object.defineProperty(Array.prototype,"contains",{enumerable:false,value:function t(e){return-1!==this.indexOf(e)}});"scrollX"in window.constructor.prototype||Object.defineProperties(window.constructor.prototype,{scrollX:{get:function t(){return this.pageXOffset}},scrollY:{get:function t(){return this.pageYOffset}}})},429:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(224)],a=function(t,e){function n(n){function i(t){n.imageCustomSize=t}function a(t){n.selectedSize=t}function s(t){if(!t||!t.orientation)return;n.selectedLayout=t;n.sizes.forEach(function(e){e.setLabel(t.orientation)})}function o(t){n.export=t;n.print.format=t.format}function r(t){var e=l();if(t.isCustom){n.print.width=Math.round(e.width);n.print.height=Math.round(e.height);return}var i=t.toPixels(e.width);n.print.width=i.w;n.print.height=i.h}function l(){return{width:t("#qv-story-play").is(":visible")?t("#qv-story-play").find(".qv-story-play-slide").first().width():n.input.currentWidth,height:t("#qv-story-play").is(":visible")?t("#qv-story-play").find(".qv-story-play-slide").first().height():n.input.currentHeight,dpi:n.input.currentDpi}}function c(t){if(n.obj&&n.input.object){var i,a,s,o,r;n.print.width<8&&(n.print.width=8);n.print.height<8&&(n.print.height=8);n.print.dpi<n.minDpi&&(n.print.dpi=n.minDpi);n.print.dpi>n.maxDpi&&(n.print.dpi=n.maxDpi);var c=Math.round(n.print.width),p=Math.round(n.print.height);var h=l();r={width:Math.round(h.width),height:Math.round(h.height),dpi:h.dpi};var g=n.imageCustomSize?{width:n.print.width,height:n.print.height,dpi:n.print.dpi}:{width:n.input.currentWidth,height:n.input.currentHeight,dpi:n.input.currentDpi};a={width:Math.round(g.width*(n.input.currentDpi/g.dpi)),height:Math.round(g.height*(n.input.currentDpi/g.dpi))};"image"===t&&(i={imageType:n.print.format,captureSize:g});if("pdf"===t){s=n.selectedSize.toMillimeters();o={right:10,left:10,top:10,bottom:10};i={width:s["portrait"===n.selectedLayout.orientation?"w":"h"],height:s["portrait"===n.selectedLayout.orientation?"h":"w"],dpi:n.print.dpi,fitCriteria:n.print.fitCriteria,margin:o,sourceSize:r}}"ppt"===t&&(i={width:c,height:p,dpi:n.print.dpi,sourceSize:r});n.state=n.states.PENDING;return e.printTree(n.input.object,r,a,i,t).then(function(e){u(e,t)},d)}n.destroyComponent()}function u(t,e){n.printUrl=t.qUrl;n.printFileName=t.fileName;var i=e.charAt(0).toUpperCase()+e.slice(1);n.printUrlTranslationKey="Print."+i+".CompletedLink";n.state=n.states.COMPLETED}function d(t){n.statusCode=t.httpStatusCode;var e=t&&t.status;switch(e){case n.states.CANCELED:case n.states.TIMEOUT:n.state=e;break;default:n.state=n.states.FAILED;break}}return{onImageCustomSize:i,onSizeChange:a,onPrintLayout:s,onFormatChange:o,confirm:c,onPptFormatChange:r}}return{create:n}}.apply(e,i),void 0!==a&&(t.exports=a))},430:function(t,e,n){"use strict";var i,a;!(i=[n(91)],a=function(t){var e="landscape";var n={w:33.1,h:46.8};var i=function t(e,n,i){this.name=e;this.unit=i||"in";this.dimensions=n};i.prototype={toPixels:function t(e){var n,i,a=0;switch(this.unit){case"in":a=e;break;case"pi":a=1;break;case"cm":a=.393701*e;break}n=this.dimensions.w*a;i=this.dimensions.h*a;return{w:Math.round(n),h:Math.round(i)}},toMillimeters:function t(){var e,n,i=0;switch(this.unit){case"in":i=1/.0393701;break;case"cm":i=10;break}e=this.dimensions.w*i;n=this.dimensions.h*i;return{w:Math.floor(e),h:Math.floor(n)}},setLabel:function e(n){var i=this;var a;var s=t.localeDetected&&"en"===t.localeDetected.substring(0,2);var o=s?i.dimensions:i.toMillimeters();var r=o["portrait"===n?"w":"h"],l=o["portrait"===n?"h":"w"];"Print.PaperSize.Letter"===i.name&&(i.name=t.get(i.name));a=s?" ("+r+'" x '+l+'")':" ("+r+" mm x "+l+" mm)";i.label=i.name+a}};function a(t,e){var n,i;if(t<e){n=t;i=e/2}else{n=t/2;i=e}return{w:n>i?i:n,h:i>n?i:n}}var s=[new i("A0",{w:n.w,h:n.h})];for(var o=1;o<8;o++)s.push(new i("A"+o,a(s[o-1].dimensions.w,s[o-1].dimensions.h)));s.push(new i("Print.PaperSize.Letter",{w:8.5,h:11}));for(var r=0;r<3;r++)s.shift();s.forEach(function(t){t.setLabel(e)});var l=[{orientation:"portrait",translationKey:"Print.Portrait"},{orientation:"landscape",translationKey:"Print.Landscape"}];l.forEach(function(e){t.ready.then(function(){e.label=t.get(e.translationKey)})});var c=[{type:"pdf",format:"pdf",label:"PDF"},{type:"image",format:"png",label:"PNG"},{type:"image",format:"jpeg",label:"JPEG"}];return{sizes:s,layouts:l,outputs:c}}.apply(e,i),void 0!==a&&(t.exports=a))},432:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(1544),n(224),n(49),n(1545),n(93),n(89)],a=function(t,e,n,i,a,s,o){function r(){return i.getFlag("DOWNLOAD_USE_REPORTING")}function l(){return i.getFlag("DOWNLOAD_OBJECT")}function c(){return i.getFlag("DOWNLOAD_DATA_OBJECT")}function u(t,a,r,l,c,u,d){if(i.getFlag("DOWNLOAD_USE_REPORTING")){var p=d?o.resolve(d):s.getApp();return p.then(function(n){return n.global.getConfiguration().then(function(t){return t.qFeatures.qAutoSave&&n.layout.permissions.update?n.doSave():void 0}).then(function(){return e.download(t,a,r,u)})})}if("data"===r){var h=t.model;var g=t.ext.options.hyperCubePath||"";return h.exportData(null,g,h.layout.title||null)}return n.printTree(t,l,c,a,r)}function d(){i.getFlag("DOWNLOAD_USE_REPORTING")?e.cancelAll():n.cancel()}function p(){return i.getFlag("DOWNLOAD_USE_REPORTING")?e.getStates():n.getStates()}function h(e){var n=new Promise(function(n,a){if(i.getFlag("DOWNLOAD_USE_REPORTING"))n(e);else{var s=t.getService("$http");s({url:e,method:"GET",responseType:"blob"}).then(function(t){if("application/pdf"===t.data.type){var e=URL.createObjectURL(t.data);n(e)}else a("Url doesn't return pdf blob")},function(t){a(t)})}});return n}function g(e,n,i,s){var o=t.getService("$http");o({url:e,method:"GET",responseType:"blob"}).then(function(t){var e=n?n+"."+i:void 0;a.saveAs(t.data,e)},s)}return{requestDownload:u,cancel:d,getStates:p,getPdfEmbedUrl:h,downloadFile:g,getUsingReportingService:r,getDownloadObjectDataFlag:c,getDownloadObjectFlag:l}}.apply(e,i),void 0!==a&&(t.exports=a))},440:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(54),n(113)],a=function(t,e,n){var i="DataManager";var a=1;var s=2592e6;function o(t){if(!n["DISABLE_DM_LOCAL_STORAGE"]&&c()){var e=new r(localStorage,true);this.storage=e;t(function(){u(e)})}else this.storage=new r({},false)}o.prototype.get=function(t){var e=this.storage.get(l(t));var n=p(e);return n?n.value:void 0};o.prototype.set=function(t,e){var n=(new Date).getTime();var i={created:n,version:a,value:e};var s=d(i);this.storage.set(l(t),s)};o.prototype.remove=function(t){this.storage.remove(l(t))};function r(t,e){this.storage=t;this.supportsLocalStorage=e}r.prototype.get=function(t){var e=this.supportsLocalStorage?this.storage.getItem(t):this.storage[t];return e};r.prototype.set=function(t,e){this.supportsLocalStorage?this.storage.setItem(t,e):this.storage[t]=e};r.prototype.remove=function(t){this.supportsLocalStorage?this.storage.removeItem(t):delete this.storage[t]};r.prototype.keys=function(){var t=[];var e;if(this.supportsLocalStorage)for(var n=0;n<this.storage.length;n++){e=this.storage.key(n);t.push(e)}else for(e in this.storage)t.push(e);return t};function l(t){return i+"."+t}function c(){try{localStorage.setItem(i,i);localStorage.removeItem(i);return true}catch(t){return false}}function u(t){var n=i+".";var a=(new Date).getTime();t.keys().forEach(function(i){if(0===i.lastIndexOf(n,0)){var o=t.get(i);var r=p(o);r&&r.created&&e.isNumber(r.created)&&a-r.created>s&&t.remove(i)}})}function d(t){return JSON.stringify(t)}function p(t){if(!t)return;try{return JSON.parse(t)}catch(t){return}}t.service("qvDataManagerLocalStorageService",["$timeout",function(t){return new o(t)}])}.apply(e,i),void 0!==a&&(t.exports=a))},460:function(t,e,n){"use strict";var i,a;!(i=[n(115),n(89)],a=function(t,e){var i={width:144,height:96},a=2;function s(t){var e={};e.width=t.width-t.numCols*t.spacing;e.height=t.height-t.numRows*t.spacing;e.columnWidth=e.width/t.numCols;e.rowHeight=e.height/t.numRows;e.cols=t.numCols;e.rows=t.numRows;e.spacing=t.spacing;return e}function o(e,n,i,a){var s=i.colspan/n.cols*n.width+(i.colspan-2)*n.spacing,o=i.rowspan/n.rows*n.height+(i.rowspan-2)*n.spacing,r=n.spacing+n.columnWidth*i.col+n.spacing*i.col,l=n.spacing+n.rowHeight*i.row+n.spacing*i.row,c=t.getIconPath(i.type),u=s>=o?o:s;e.fillStyle="rgb(242, 242, 242)";e.fillRect(r,l,s,o);u=Math.max(8,Math.min(u,24))/16;e.fillStyle=a?"rgba(0, 152, 69,.6)":"rgba(89, 89, 89,0.6)";e.text="center";e.textAlign="center";e.textBaseline="middle";e.save();e.translate(Math.round(r+s/2-8*u),Math.round(l+o/2-8*u));e.scale(u,u);e.fill(new Path2D(c));e.restore()}var r={staticSrc:function t(){return{staticPublishedSheet:function t(){return n.p+"img/core/static/Default-sheet-published.png"},staticUnPublishedSheet:function t(){return n.p+"img/core/static/Default-sheet-unpublished.png"},staticPublishedStory:function t(){return n.p+"img/core/static/Default-story-published.png"},staticUnPublishedStory:function t(){return n.p+"img/core/static/Default-story-unpublished.png"},staticApp:function t(){return n.p+"img/core/static/Default_thumbnail_app.png"},brokenImage:function t(){return n.p+"img/core/static/Ic_BrokenBig@2x.png"}}},dimensions:{original:i,width:i.width-2,height:i.height-2,spacing:2},getSrc:function t(e,n){var i=n?"Sheet":"Story",a=e?"staticPublished":"staticUnPublished";return r.staticSrc()[a+i]()},generateImageForStory:function t(n,i){var a=new e;i.get(n.item.qInfo.qId).then(function(t){t.getLayout().then(function(e){if(e.qChildList&&e.qChildList.qItems.length){n.slide=e.qChildList.qItems.slice().sort(function(t,e){if(t.qData.rank===e.qData.rank)return 0;return t.qData.rank<e.qData.rank?-1:1})[0];n.slide?t.app.getObject(n.slide.qInfo.qId).then(function(t){t.getLayout().then(function(t){t.qChildList.qItems.length>0?a.resolve():a.reject()},a.reject)}):a.reject()}else a.reject()})});return a.promise},paintCanvas:function t(e){var n=document.createElement("canvas"),i,l,c;i=s({width:r.dimensions.width*a,height:r.dimensions.height*a,spacing:r.dimensions.spacing,numRows:e.qData.rows,numCols:e.qData.columns});n.width=r.dimensions.width*a;n.height=r.dimensions.height*a;l=n.getContext("2d");function u(t){t.forEach(function(t){var n=e.qMeta.published;o(l,i,t,n)})}l.clearRect(0,0,n.width,n.height);u(e.qData.cells);c=n.toDataURL();l=null;i=null;n.remove&&n.remove();n=null;return c}};return r}.apply(e,i),void 0!==a&&(t.exports=a))},462:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(463)],a=function(t,e){t.component("quiFloat",{transclude:true,template:e,scope:{quiOffset:"=",quiResizeOnChange:"="},controller:["$scope","$element","$timeout",function(t,e,n){function i(){if(!t.quiOffset||!t.reportedSize||!t.reportedWindowSize)t.visible=false;else{t.quiOffset.left+t.reportedSize.width<t.reportedWindowSize.width?t.left=t.quiOffset.left:t.left=t.reportedWindowSize.width-t.reportedSize.width;t.quiOffset.top+t.reportedSize.height<t.reportedWindowSize.height?t.top=t.quiOffset.top:t.top=t.reportedWindowSize.height-t.reportedSize.height;t.visible=true}}function a(){n(function(){t.reportedSize={width:e.outerWidth(),height:e.outerHeight()}})}t.$watch("quiResizeOnChange",a,true);t.$watch("[quiOffset, reportedSize, reportedWindowSize]",i,true)}]})}.apply(e,i),void 0!==a&&(t.exports=a))},463:function(t,e){t.exports='<div class="qui-float" ng-style="{top:top, left:left}" ng-show="visible" qva-reported-window-size="reportedWindowSize">\n\t<div ng-transclude></div>\n</div>\n'},464:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(465),n(466)],a=function(t,e,n){t.component("quiInputNumber",{template:n,scope:{quiModel:"=",quiDisabled:"=",quiTitle:"@",quiMin:"@",quiMax:"@",quiClass:"@",quiSelectTextOnFocus:"@",quiWithButtons:"@",quiTid:"@"},controller:["$scope","$element",function(t,n){if(t.quiSelectTextOnFocus){t.selected=false;n.click(function(){if(false===t.selected){n.select();t.selected=true}});n.blur(function(){t.selected=false})}t.onChange=function(i){var a=parseInt(i)||0;t.quiModel=e.getNumerical(parseInt(n.find(".lui-input").val())+a,t.quiMin,t.quiMax)}}]})}.apply(e,i),void 0!==a&&(t.exports=a))},465:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){function t(t){return Number(String(t).replace(/[^-\d]/g,""))}return{getNumerical:function e(n,i,a){n=t(n);i=Number(i);a=Number(a);if(n<i)return i;if(0!==a&&n>a)return a;return n}}}.apply(e,i),void 0!==a&&(t.exports=a))},466:function(t,e){t.exports='<span class="qui-input-number lui-input-group">\n\t<button class="lui-input-group__item  lui-input-group__button  lui-button" qva-activate="onChange(-1)" ng-disabled="quiDisabled" ng-if="quiWithButtons">\n\t\t<span class="lui-button__icon">-</span>\n\t</button>\n\t<input type="tel" class="lui-input-group__item  lui-input-group__input  lui-input {{quiClass}}" tid="{{quiTid}}" title="{{quiTitle}}" ng-model="quiModel" ng-model-options="{ updateOn: \'blur\' }" ng-change="onChange()" ng-disabled="quiDisabled"/>\n\t<button class="lui-input-group__item  lui-input-group__button  lui-button" qva-activate="onChange(1)" ng-disabled="quiDisabled" ng-if="quiWithButtons">\n\t\t<span class="lui-button__icon">+</span>\n\t</button>\n</span>\n'},467:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(119),n(468),n(469),n(470)],a=function(t,e,n,i){var a={TAB:9};function s(t){return t.parents(".popover-container").length?t.parents(".popover-container")[0]:null}function o(e,n,i){return e.which===a.TAB&&e.target!==n.alignTo&&t(e.target).closest(".lui-popover-container")[0]!==i[0]}var r={template:i,scope:{quiModel:"=",shared:"=",close:"="},controller:["$scope","$element","$document",function(t,e,n){t.menuClasses=t.quiModel.menuOptions.content.menuClasses?t.quiModel.menuOptions.content.menuClasses:"qui-textlist";t.quiModel.menuOptions.content.createMenuItems().then(function(e){t.menuItems=e});t.selectMenuItem=function(e,n,i){n&&n.preventDefault&&n.preventDefault();if(!e.disable){t.close&&t.close();e.selected(n,i)}};n.on("keyup.qv-popover",function(n){s(e)&&o(n,t,e)&&t.close&&t.close()});t.$on("$destroy",function(){n.off("keyup.qv-popover")})}]};e.directive("qvPopoverButton",function(){return{template:n,transclude:true,replace:true,restrict:"E",scope:{quiModel:"=",quiPopoverContainer:"=?"},controller:["$scope","$element","luiPopover","qvMobileMenu",function(t,e,n,i){var a;t.shared={pressed:false};t.onClick=function(){if(t.shared.pressed&&a){a.close();return}t.shared.pressed=!t.shared.pressed;var o=t.quiModel.menuOptions||{};a=o.smallview?i.show({controller:r.controller,template:r.template,autoFocus:false,closeOnResize:true,outsideIgnore:t.quiModel.tid,input:{quiModel:t.quiModel,shared:t.shared,close:function t(){a.close()}}}):n.show({controller:r.controller,template:r.template,dock:"bottom",alignTo:e[0],autoFocus:false,closeOnResize:true,outsideIgnore:t.quiModel.tid,container:s(e),input:{quiModel:t.quiModel,shared:t.shared,close:function t(){a.close()}}});a.closed.then(function(){t.shared.pressed=false})};t.$watch("shared.pressed",function(e){t.currentTitle=e&&t.quiModel.tooltipActive?t.quiModel.tooltipActive:t.quiModel.tooltipInactive})}]}})}.apply(e,i),void 0!==a&&(t.exports=a))},468:function(t,e){t.exports='<button\n\t\ttid="{{quiModel.tid}}"\n\t\tng-disabled="quiModel.isDisabled()"\n\t\tng-class="[quiModel.buttonClass, quiModel.buttonVariant, {\'lui-active\': shared.pressed }]"\n\t\tq-title-translation="{{currentTitle}}"\n\t\tqva-outside-ignore-for="{{quiModel.tid}}"\n\t\tng-click="onClick()">\n\t<span class="{{quiModel.buttonClass}}__icon lui-icon  lui-icon--{{quiModel.icon}}  {{quiModel.menuOptions.smallview ? \'lui-icon--large\' : \'\'}}"></span>\n\t<span class="{{quiModel.buttonClass}}__text" ng-if="quiModel.buttonText">\n\t\t{{quiModel.buttonText}}\n\t</span>\n\t<span ng-if="!quiModel.hideCaret" class="{{quiModel.buttonClass}}__caret  lui-caret"></span>\n</button>\n'},469:function(t,e){t.exports='<lui-popover ng-style="{ width: quiModel.menuOptions.width }">\n\t<ul ng-class="menuClasses" tid="{{quiModel.menuOptions.content.tid}}">\n\t\t<li class="lui-list__item"\n\t\t\tng-repeat="menuItem in menuItems"\n\t\t\tng-class="{\'open-in-new-tab-always\': menuItem.openInNewTab == \'always\', \'lui-disabled\': menuItem.disable, \'header-item\': menuItem.headerItem, \'last-menu-item\' : menuItem.last}"\n\t\t\tng-hide="menuItem.hide">\n\n\t\t\t<qv-menu-switch tid="{{menuItem.tid}}" x-model="menuItem" callback="selectMenuItem(menuItem, $event)" ng-if="menuItem.showSwitch"/>\n\n\t\t\t<button tid="{{menuItem.tid}}"\n\t\t\t\t class="action-item"\n\t\t\t\t ng-class="[quiModel.buttonClass, quiModel.buttonVariant]"\n\t\t\t\t ng-click="selectMenuItem(menuItem, $event)"\n\t\t\t\t q-title-translation="{{ menuItem.title || menuItem.text}}"\n\t\t\t\t ng-disabled="menuItem.disable"\n\t\t\t\t ng-if="!menuItem.showSwitch">\n\t\t\t\t<span ng-if="menuItem.icon"\tclass="lui-list__aside">\n\t\t\t\t\t<span class="lui-icon  lui-icon--{{menuItem.icon}}" ng-disabled="menuItem.disable"></span>\n\t\t\t\t</span>\n\t\t\t\t<span class="lui-list__text menu-item-text"\n\t\t\t\t\t  q-translation="{{menuItem.text}}"\n\t\t\t\t\t  ng-class="{\'open-in-new-tab-text-optional\': menuItem.openInNewTab == \'optional\', \'open-in-new-tab-always\': menuItem.openInNewTab == \'always\'}" aria-hidden="true">\n\t\t\t\t</span>\n\t\t\t</button>\n\t\t\t<div class="list-divider" ng-if="menuItem.openInNewTab === \'optional\'"></div>\n\t\t\t<button ng-if="menuItem.openInNewTab" class="lui-fade-button"\n\t\t\t\t\tng-class="[quiModel.buttonClass, quiModel.buttonVariant]"\n\t\t\t\t\tq-title-translation="{{ menuItem.title || \'Tooltip.OpenInNewTab\'}}"\n\t\t\t\t\tng-click="selectMenuItem(menuItem, $event, \'true\')"\n\t\t\t\t\tng-disabled="menuItem.disable" tabindex="-1">\n\t\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--new-tab"></span>\n\t\t\t</button>\n\t\t</li>\n\t</ul>\n</lui-popover>\n'},470:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(471)],a=function(t,e){t.directive("qvMenuSwitch",function(){return{template:e,scope:{model:"=",callback:"&"},link:function t(e){e.switchValue=e.model.value;e.$watch("switchValue",function(t,n){void 0!==t&&t!==n&&e.callback()})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},471:function(t,e){t.exports='<div class="menu-switch-component" tcl="switch" q-title-translation="{{ model.text }}">\n    <span ng-if="model.icon" class="lui-list__aside switch_icon">\n        <span class="lui-icon  lui-icon--{{model.icon}}" ng-disabled="model.disable"></span>\n    </span>\n    <span class="label" ng-disabled="readOnly">\n        <div class="title" q-translation="{{ model.text }}"></div>\n        <div class="value" q-translation="{{ model.label() }}"></div>\n    </span>\n    <lui-switch x-model="switchValue"/>\n</div>'},472:function(t,e,n){"use strict";var i,a;!(i=[n(119),n(11),n(473),n(474),n(51),n(97)],a=function(t,e,n,i,a,s){var o={template:i,scope:{quiModel:"=",alignTo:"=",shared:"="},controller:["$scope",function(t){t.shared.destroyComponent=t.destroyComponent;t.menuClasses=t.quiModel.menuOptions.content.menuClasses?t.quiModel.menuOptions.content.menuClasses:"qui-textlist";t.quiModel.menuOptions.content.createMenuItems().then(function(e){t.menuItems=e});t.selectMenuItem=function(e,n,i){n&&n.preventDefault&&n.preventDefault();if(!e.disable){t.onClose&&t.onClose(n);e.selected(n,i)}};t.onClose=function(n){if(!e(n.target).hasClass("qui-popover-button")||t.quiModel.tid!==e(n.target).attr("tid")){t.destroyComponent();t.shared.pressed=false}};t.closeFromContent=function(){t.destroyComponent();t.shared.pressed=false};t.$on("$destroy",function(){s.off("start",t.onClose)});s.on("start",t.onClose)}]};t.directive("quiPopoverButton",function(){return{template:n,transclude:true,replace:true,restrict:"E",scope:{quiModel:"=",quiPopoverContainer:"=?"},controller:["$scope","$element",function(t,e){var n={ENTER:13,SPACE:32};t.shared={};t.shared.pressed=false;t.$watch("shared.pressed",function(e){t.currentTitle=e&&t.quiModel.tooltipActive?t.quiModel.tooltipActive:t.quiModel.tooltipInactive});e.on("keypress",function(e){e.keyCode!==n.ENTER&&e.keyCode!==n.SPACE||t.onClick()});t.onClick=function(){if(t.shared.pressed){if(t.shared.destroyComponent){t.shared.destroyComponent();t.shared.pressed=false}}else{t.shared.pressed=true;a.show(t.quiPopoverContainer||o,{quiModel:t.quiModel,alignTo:e,shared:t.shared})}};t.quiModel&&(t.quiModel.forceClick=t.onClick)}]}})}.apply(e,i),void 0!==a&&(t.exports=a))},473:function(t,e){t.exports='<button\n\t\ttid="{{quiModel.tid}}"\n\t\tng-disabled="quiModel.isDisabled()"\n\t\tng-class="[quiModel.buttonClass, quiModel.buttonVariant, {\'lui-active\': shared.pressed }]"\n\t\tq-title-translation="{{currentTitle}}"\n\t\tqva-outside-ignore-for="{{quiModel.tid}}"\n\t\tng-click="onClick()">\n\t<span ng-if="!quiModel.hideIcon" class="{{quiModel.buttonClass}}__icon lui-icon  lui-icon--{{quiModel.icon}}  {{quiModel.menuOptions.smallview ? \'lui-icon--large\' : \'\'}}"></span>\n\t<span class="{{quiModel.buttonClass}}__text" ng-if="quiModel.buttonText">\n\t\t{{quiModel.buttonText}}\n\t</span>\n\t<span ng-if="!quiModel.hideCaret" class="{{quiModel.buttonClass}}__caret  lui-caret"></span>\n</button>\n'},474:function(t,e){t.exports='<immidiate-contextual align-to="alignTo"\n\t\t\t\t\t  smallview="quiModel.menuOptions.smallview"\n\t\t\t\t\t  position="quiModel.menuOptions.position"\n\t\t\t\t\t  width="quiModel.menuOptions.width"\n\t\t\t\t\t  top="quiModel.menuOptions.top"\n\t\t\t\t\t  lui-style="true"\n\t\t\t\t\t  no-padding="true"\n\t\t\t\t\t  hidepointer="quiModel.menuOptions.hidepointer"\n\t\t\t\t\t\tqva-outside-ignore-for="{{quiModel.tid}}"\n\t\t\t\t\t  on-close-view="onClose(event)">\n\t<ul ng-class="menuClasses" tid="{{quiModel.menuOptions.content.tid}}">\n\t\t<li class="lui-list__item" ng-repeat="menuItem in menuItems" ng-disabled="menuItem.disable" qui-click=\'menuItem.fn()\'\n\t\t\tng-class="{\'open-in-new-tab-always\': menuItem.openInNewTab == \'always\'}" ng-hide="menuItem.hide">\n\t\t\t<span ng-if="menuItem.icon" class="lui-list__aside">\n\t\t\t\t<span class="lui-icon  lui-icon--{{menuItem.icon}}"></span>\n\t\t\t</span>\n\t\t\t<span class="lui-list__text menu-item-text"\n\t\t\t\t  tid="{{menuItem.tid}}"\n\t\t\t\t  q-title-translation="{{ menuItem.title || menuItem.text}}"\n\t\t\t\t  ng-class="{\'open-in-new-tab-text-optional\': menuItem.openInNewTab == \'optional\', \'open-in-new-tab-always\': menuItem.openInNewTab == \'always\'}"\n\t\t\t\t  qva-activate="selectMenuItem(menuItem, $event)" q-translation="{{menuItem.text}}" ng-disabled="menuItem.disable">\n\t\t\t</span>\n\t\t\t<div class="list-divider" ng-if="menuItem.openInNewTab === \'optional\'"></div>\n\t\t\t<button ng-if="menuItem.openInNewTab" class="lui-fade-button  open-in-new-tab" ng-class="{\'open-in-new-tab-always\': menuItem.openInNewTab == \'always\'}" q-title-translation="{{ menuItem.title || \'Tooltip.OpenInNewTab\'}}" qva-activate="selectMenuItem(menuItem, $event, \'true\')" ng-disabled="menuItem.disable">\n\t\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--new-tab"></span>\n\t\t\t</button>\n\t\t</li>\n\t</ul>\n</immidiate-contextual>\n'},475:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(49),n(476),n(477)],a=function(t,e,n,i,a){e.component("quiToolbar",{template:"<div class='qui-toolbar' ng-transclude />"});e.component("quiToolbarLeft",{template:"<div class='qui-buttonset-left' ng-transclude />"});e.component("quiToolbarRight",{template:"<div class='qui-buttonset-right' ng-transclude />"});e.component("quiToolbarButtonGroup",{template:"<div class='lui-buttongroup' ng-transclude />"});e.component("quiToolbarButton",{template:i,scope:{quiModel:"="},controller:["$scope",function(e){e.isMouseDown=false;e.onMouseDown=function(){e.isMouseDown=true};e.clientTabNavigation=n.getFlag("CLIENT_TAB_NAVIGATION");e.onButton=function(n){t.support.touch&&n.target.focus();e.quiModel.isToggleButton&&(e.quiModel.pressed=!e.quiModel.pressed);e.quiModel.isOpenedByClick=e.isMouseDown;e.isMouseDown=false;e.quiModel.onButtonClicked(e.quiModel,n)};function i(){var t=[];var n=e.quiModel;n.pressed?n.activeVariant?t.push(n.activeVariant):t.push("lui-active"):n.variant?t.push(n.variant):e.clientTabNavigation||t.push("lui-button--toolbar");e.classList=t}e.$watch("quiModel.pressed",i);e.$watch("quiModel.variant",i);e.$watch("quiModel.activeVariant",i);i()}]});e.component("quiToolbarMobileButton",{template:a,scope:{quiModel:"="},controller:["$scope",function(e){e.onButton=function(n){t.support.touch&&n.target.focus();e.quiModel.isToggleButton&&(e.quiModel.pressed=!e.quiModel.pressed);e.quiModel.onButtonClicked(e.quiModel,n)}}]})}.apply(e,i),void 0!==a&&(t.exports=a))},476:function(t,e){t.exports='<button\n\t\ttid="{{quiModel.tid}}"\n\t\tng-click="onButton($event)"\n\t\tng-mousedown="onMouseDown()"\n\t\tqva-outside-ignore-for="{{quiModel.name}}"\n\t\tq-title-translation="{{(quiModel.pressed && quiModel.tooltipActive ? quiModel.tooltipActive : quiModel.tooltipInactive)}}"\n\t\tng-disabled="quiModel.isDisabled()"\n\t\tng-hide="quiModel.isHidden()"\n\t\tclass="lui-button"\n\t\ttext-inactive="{{quiModel.textInactive ? quiModel.textInactive : \'\'}}"\n\t\tng-class="classList">\n\t<span\n\t\tqva-outside-ignore-for="{{quiModel.name}}"\n\t\tng-if="quiModel.icon && quiModel.iconToTheLeft"\n\t\tclass="lui-button__icon  lui-icon  lui-icon--{{quiModel.icon}} center"\n\t></span>\n\t<span\n\t\tqva-outside-ignore-for="{{quiModel.name}}"\n\t\tng-if="!quiModel.dynamicText && quiModel.showText()"\n\t\tclass="lui-button__text  item-title"\n\t\tqva-direction\n\t\tx-dir-text="{{(quiModel.pressed && quiModel.textActive ? quiModel.textActive : quiModel.textInactive) | translate}}"\n\t>\n\t\t{{(quiModel.pressed && quiModel.textActive ? quiModel.textActive : quiModel.textInactive) | translate}}\n\t</span>\n\t<span\n\t\tqva-outside-ignore-for="{{quiModel.name}}"\n\t\tng-if="quiModel.icon && !quiModel.iconToTheLeft"\n\t\tclass="lui-button__icon  lui-icon  lui-icon--{{quiModel.icon}} center"\n\t></span>\n\t<span\n\t\tqva-outside-ignore-for="{{quiModel.name}}"\n\t\tng-if="!quiModel.dynamicText && !quiModel.textOnly && quiModel.isDropdownButton"\n\t\tclass="lui-button__caret  lui-caret"\n\t></span>\n\t<span class="lui-button__text" qva-outside-ignore-for="{{quiModel.name}}" ng-if="quiModel.dynamicText">\n\t\t{{ quiModel.dynamicText() }}\n\t</span>\n</button>\n'},477:function(t,e){t.exports='<button\n\t\ttid="{{quiModel.tid}}"\n\t\tng-click="onButton($event)"\n\t\tqva-outside-ignore-for="{{quiModel.name}}"\n\t\tq-title-translation="{{(quiModel.pressed && quiModel.tooltipActive ? quiModel.tooltipActive : quiModel.tooltipInactive)}}"\n\t\tng-disabled="quiModel.isDisabled()"\n\t\tng-hide="quiModel.isHidden()"\n\t\tclass="lui-fade-button lui-fade-button--large lui-fade-button--inverse"\n\t\tng-class="{ \'lui-active\': quiModel.pressed }">\n\t<span qva-outside-ignore-for="{{quiModel.name}}" ng-if="!quiModel.dynamicText && quiModel.showText()"\n\t\tclass="lui-fade-button__text  item-title"\n\t\tqva-direction\n\t\tx-dir-text="{{(quiModel.pressed && quiModel.textActive ? quiModel.textActive : quiModel.textInactive) | translate}}">\n\t\t{{(quiModel.pressed && quiModel.textActive ? quiModel.textActive : quiModel.textInactive) | translate}}\n\t</span>\n\t<span\n\t\tqva-outside-ignore-for="{{quiModel.name}}"\n\t\tng-if="!quiModel.dynamicText && !quiModel.textOnly"\n\t\tclass="lui-fade-button__icon  lui-icon  lui-icon--large  lui-icon--{{quiModel.icon}}"></span>\n\t<span\n\t\tqva-outside-ignore-for="{{quiModel.name}}"\n\t\tclass="lui-fade-button__text"\n\t\tng-if="quiModel.dynamicText">{{ quiModel.dynamicText() }}</span>\n</button>\n'},478:function(t,e,n){"use strict";var i,a;!(i=[n(91)],a=function(t){var e=[],n=[{tid:"Print.Ppt.Format.Standard",w:4,h:3},{tid:"Print.Ppt.Format.Widescreen",w:16,h:9},{tid:"Print.Ppt.Format.Widescreen",w:16,h:10},{tid:"Print.Ppt.Format.Custom"}];var i=function t(e,n){this.ratio=e||{};this.isCustom=n||false};i.prototype={toPixels:function t(e){var n=parseInt(e)||960;var i=n/this.ratio.w*this.ratio.h;return{w:Math.round(n),h:Math.round(i)}},setLabel:function e(){var n=this;t.ready.then(function(){var e=t.get(n.ratio.tid);n.label=e;n.ratio.w&&n.ratio.h&&(n.label+=" "+n.ratio.w+":"+n.ratio.h)})}};var a=n.length;for(var s=0;s<a;s++){var o=new i(n[s]);3===s&&(o.isCustom=true);e.push(o)}e.forEach(function(t){t.setLabel("portrait")});return{formats:e}}.apply(e,i),void 0!==a&&(t.exports=a))},479:function(t,e){t.exports='<lui-dialog id="print-dialog" tcl="print-image-settings">\n\t<lui-dialog-header>\n\t\t<lui-dialog-title q-translation="{{input.title}}"></lui-dialog-title>\n\t</lui-dialog-header>\n\t<lui-dialog-body class="print-dialog">\n\n\t\t<div class="section">\n\t\t\t<div class="lui-buttongroup">\n\t\t\t\t<button class="lui-button" tid="print-current-size" ng-class="{ \'lui-active\': ! imageCustomSize }" q-translation="Print.Image.CurrentSize" ng-click="onImageCustomSize(false)" ng-disabled="state === states.PENDING"></button>\n\t\t\t\t<button class="lui-button" tid="print-custom-size"  ng-class="{ \'lui-active\': imageCustomSize }" q-translation="Common.Custom" ng-click="onImageCustomSize(true)" ng-disabled="state === states.PENDING"></button>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="section" ng-show="! imageCustomSize">\n\t\t\t{{input.currentWidth}} x {{input.currentHeight}} px @ 96 dpi</span>\n\t\t</div>\n\n\t\t<div class="section" ng-show="imageCustomSize">\n\t\t\t<div class="section-title" q-translation="Print.Image.Width"></div>\n\t\t\t<div class="print-image">\n\t\t\t\t<qui-input-number\n\t\t\t\t\t\tqui-tid="print-image-width"\n\t\t\t\t\t\tqui-model="print.width" qui-disabled="state === states.PENDING" qui-min="0" qui-max="2000" qui-with-buttons="true"></qui-input-number>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="section" ng-show="imageCustomSize">\n\t\t\t<div class="section-title" q-translation="Print.Image.Height"></div>\n\t\t\t<div class="print-image">\n\t\t\t\t<qui-input-number\n\t\t\t\t\t\tqui-tid="print-image-height"\n\t\t\t\t\t\tqui-model="print.height" qui-disabled="state === states.PENDING" qui-min="0" qui-max="2000" qui-with-buttons="true"></qui-input-number>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="section" ng-show="imageCustomSize">\n\t\t\t<div class="section-title" q-translation="Print.Image.Dpi"></div>\n\t\t\t<div class="print-image">\n\t\t\t\t<qui-input-number\n\t\t\t\t\t\tqui-tid="print-image-dpi"\n\t\t\t\t\t\tqui-model="print.dpi" qui-disabled="state === states.PENDING" qui-min="0" qui-max="300" qui-with-buttons="true"></qui-input-number>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.Image.Format"></div>\n\t\t\t<div class="print-image">\n\t\t\t\t<div class="component-wrapper">\n\t\t\t\t\t<lui-select\n\t\t\t\t\t\t\tx-model="print.format"\n\t\t\t\t\t\t\tx-options="f as f for f in availableFormats"\n\t\t\t\t\t\t\tx-disabled="state === states.PENDING"\n\t\t\t\t\t\t\ttid="print-image-selected-format"></lui-select>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.PENDING" class="loading-screen">\n\t\t\t<div class="spinner">\n\t\t\t\t<div class="qv-loader"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.COMPLETED">\n\t\t\t<div class="section">\n\t\t\t\t<a ng-if="!usingReportingService" ng-href="{{printUrl}}" target="_blank" q-translation="Print.Image.CompletedLink"></a>\n\t\t\t\t<a ng-if="usingReportingService" ng-href="{{printUrl}}" target="_blank" q-translation="Print.Image.CompletedLink" download="{{printFileName}}"></a>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.TIMEOUT">\n\t\t\t<div class="section">\n\t\t\t\t<p class="dm-p" q-translation="Print.Failed.TimeoutMessage"></p>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.FAILED">\n\t\t\t<div class="section">\n\t\t\t\t<p class="dm-p" q-translation="Print.Failed.GenericMessage"></p>\n\t\t\t</div>\n\t\t</div>\n\t</lui-dialog-body>\n\n\t<lui-dialog-footer>\n\t\t<lui-button ng-click="$event.preventDefault(); close()" name="cancel" q-translation="Common.Cancel" tid="print-cancel"></lui-button>\n\t\t<lui-button ng-click="$event.preventDefault(); confirm(exportType)" name="confirm" autofocus q-translation="Print.Download" ng-disabled="state === states.PENDING" tid="print-export"></lui-button>\n\t</lui-dialog-footer>\n</lui-dialog>\n'},480:function(t,e){t.exports='<lui-dialog id="print-dialog" tcl="print-pdf-settings">\n\t<lui-dialog-header>\n\t\t<lui-dialog-title q-translation="{{input.title}}"></lui-dialog-title>\n\t</lui-dialog-header>\n\t<lui-dialog-body class="print-dialog">\n\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.PaperSize"></div>\n\t\t\t<div class="component-wrapper">\n\t\t\t\t<lui-select\n\t\t\t\t\t\ttid="print-paper-size"\n\t\t\t\t\t\tx-model="selectedSize"\n\t\t\t\t\t\tx-disabled="state === states.PENDING"\n\t\t\t\t\t\tx-options="size.label for size in sizes"\n\t\t\t\t\t\tx-change="onSizeChange(selectedSize)"\n\t\t\t\t\t\tx-disabled="state === states.PENDING">\n\t\t\t\t</lui-select>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.Image.Dpi"></div>\n\t\t\t<div class="print-image">\n\t\t\t\t<qui-input-number\n\t\t\t\t\t\tqui-tid="print-pdf-dpi"\n\t\t\t\t\t\tqui-model="print.dpi"\n\t\t\t\t\t\tqui-disabled="state === states.PENDING"\n\t\t\t\t\t\tqui-min="{{minDpi}}"\n\t\t\t\t\t\tqui-max="{{maxDpi}}"\n\t\t\t\t\t\tqui-with-buttons="true"></qui-input-number>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.Layout"></div>\n\t\t\t<div class="lui-buttongroup">\n\t\t\t\t<button class="lui-button"\n\t\t\t\t\t\ttid="print-orientation-portrait"\n\t\t\t\t\t\tng-class="{ \'lui-active\': \'portrait\' === selectedLayout.orientation }"\n\t\t\t\t\t\tq-translation="Print.Portrait"\n\t\t\t\t\t\tng-click="onPrintLayout(layouts[0])"\n\t\t\t\t\t\tng-disabled="state === states.PENDING"></button>\n\t\t\t\t<button class="lui-button"\n\t\t\t\t\t\tid="print-orientation-landscape"\n\t\t\t\t\t\tng-class="{ \'lui-active\': \'landscape\' === selectedLayout.orientation }"\n\t\t\t\t\t\tq-translation="Print.Landscape"\n\t\t\t\t\t\tng-click="onPrintLayout(layouts[1])"\n\t\t\t\t\t\tng-disabled="state === states.PENDING"></button>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.Layout.Aspect"></div>\n\t\t\t<lui-radiobutton class="print-dialog-radio-single"\n\t\t\t\t\t\t\t tid="print-aspect-current-size"\n\t\t\t\t\t\t\t x-name="print-aspect"\n\t\t\t\t\t\t\t x-model="print.fitCriteria"\n\t\t\t\t\t\t\t x-value="0"\n\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t x-disabled="state === states.PENDING">{{ \'Print.Layout.CurrentSize\' | translate }}</lui-radiobutton>\n\t\t\t<lui-radiobutton class="print-dialog-radio-single"\n\t\t\t\t\t\t\t tid="print-aspect-fit-page"\n\t\t\t\t\t\t\t x-name="print-aspect"\n\t\t\t\t\t\t\t x-model="print.fitCriteria"\n\t\t\t\t\t\t\t x-value="2"\n\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t x-disabled="state === states.PENDING">{{ \'Print.Layout.BestFitNoPreserveAspectRatio\' | translate }}</lui-radiobutton>\n\t\t</div>\n\t\t<div ng-if="state === states.PENDING" class="loading-screen">\n\t\t\t<div class="spinner">\n\t\t\t\t<div class="qv-loader"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.COMPLETED">\n\t\t\t<div class="section">\n\t\t\t\t<a ng-href="{{printUrl}}" target="_blank" q-translation="Print.Pdf.CompletedLink"></a>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.TIMEOUT">\n\t\t\t<div class="section">\n\t\t\t\t<p class="dm-p" q-translation="Print.Failed.TimeoutMessage"></p>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.FAILED">\n\t\t\t<div class="section">\n\t\t\t\t<p class="dm-p" q-translation="Print.Failed.GenericMessage"></p>\n\t\t\t</div>\n\t\t</div>\n\t</lui-dialog-body>\n\n\t<lui-dialog-footer>\n\t\t<lui-button ng-click="$event.preventDefault(); close()" name="cancel" q-translation="Common.Cancel" tid="print-cancel"></lui-button>\n\t\t<lui-button ng-click="$event.preventDefault(); confirm(exportType)" name="confirm" autofocus q-translation="Print.Download" ng-disabled="state === states.PENDING" tid="print-export"></lui-button>\n\t</lui-dialog-footer>\n</lui-dialog>\n'},481:function(t,e){t.exports='<lui-dialog id="print-dialog" tcl="print-ppt-settings">\n\t<lui-dialog-header>\n\t\t<lui-dialog-title q-translation="{{input.title}}"></lui-dialog-title>\n\t</lui-dialog-header>\n\t<lui-dialog-body class="print-dialog">\n\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.Ppt.Format"></div>\n\t\t\t<div class="component-wrapper">\n\t\t\t\t<lui-select\n\t\t\t\t\ttid="print-ppt-selected-size"\n\t\t\t\t\tx-model="selectedFormat"\n\t\t\t\t\tx-options="f.label for f in formats"\n\t\t\t\t\tx-change="onPptFormatChange(selectedFormat)">\n\t\t\t\t</lui-select>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="section" ng-show="selectedFormat.isCustom">\n\t\t\t<div class="section-title" q-translation="Print.Image.Width"></div>\n\t\t\t<qui-input-number\n\t\t\t\tqui-tid="print-ppt-width"\n\t\t\t\tqui-model="print.width" qui-min="0" qui-max="4000" qui-with-buttons="true"></qui-input-number>\n\t\t</div>\n\n\n\t\t<div class="section" ng-show="selectedFormat.isCustom">\n\t\t\t<div class="section-title" q-translation="Print.Image.Height"></div>\n\t\t\t<qui-input-number\n\t\t\t\tqui-tid="print-ppt-height"\n\t\t\t\tqui-model="print.height" qui-min="0" qui-max="4000" qui-with-buttons="true"></qui-input-number>\n\t\t</div>\n\n\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.Image.Dpi"></div>\n\t\t\t<div class="print-ppt-dpi">\n\t\t\t\t<div class="component-wrapper">\n\t\t\t\t\t<lui-select\n\t\t\t\t\t\ttid="print-ppt-dpi"\n\t\t\t\t\t\tx-model="print.dpi"\n\t\t\t\t\t\tx-options="d as d for d in availablePptDpi">\n\t\t\t\t\t</lui-select>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="section">\n\t\t\t{{print.width}} x {{print.height}} px @ {{print.dpi}} dpi\n\t\t</div>\n\t\t\x3c!--\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.Ppt.CurrentSlideSize"></div>\n\t\t\t<p>\n\t\t\t{{print.currentWidth}} x {{print.currentHeight}} px @ {{print.currentDpi}} dpi\n\t\t\t</p>\n\t\t</div>\n\t\t--\x3e\n\t\t<div ng-if="state === states.PENDING" class="loading-screen">\n\t\t\t<div class="spinner">\n\t\t\t\t<div class="qv-loader"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.COMPLETED">\n\t\t\t<div class="section">\n\t\t\t\t<a ng-href="{{printUrl}}" target="_blank" q-translation="Print.Ppt.CompletedLink"></a>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.TIMEOUT">\n\t\t\t<div class="section">\n\t\t\t\t<p class="dm-p" q-translation="Print.Failed.TimeoutMessage"></p>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.FAILED">\n\t\t\t<div class="section">\n\t\t\t\t<p class="dm-p" q-translation="Print.Failed.GenericMessage"></p>\n\t\t\t</div>\n\t\t</div>\n\t</lui-dialog-body>\n\n\t<lui-dialog-footer>\n\t\t<lui-button ng-click="$event.preventDefault(); close()" name="cancel" q-translation="Common.Cancel" tid="print-cancel"></lui-button>\n\t\t<lui-button ng-click="$event.preventDefault(); confirm(exportType)" name="confirm" autofocus q-translation="Print.Download" ng-disabled="state === states.PENDING"></lui-button>\n\t</lui-dialog-footer>\n</lui-dialog>\n'},482:function(t,e){t.exports='<lui-dialog id="print-dialog" tcl="print-pdf-settings">\n\t<lui-dialog-header>\n\t\t<lui-dialog-title q-translation="{{input.title}}"></lui-dialog-title>\n\t</lui-dialog-header>\n\t<lui-dialog-body class="print-dialog">\n\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.PaperSize"></div>\n\t\t\t<div class="component-wrapper">\n\t\t\t\t<lui-select\n\t\t\t\t\t\ttid="print-paper-size"\n\t\t\t\t\t\tx-model="selectedSize"\n\t\t\t\t\t\tx-disabled="state === states.PENDING"\n\t\t\t\t\t\tx-options="size.label for size in sizes"\n\t\t\t\t\t\tx-change="onSizeChange(selectedSize)"\n\t\t\t\t\t\tx-disabled="state === states.PENDING">\n\t\t\t\t</lui-select>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.Image.Dpi"></div>\n\t\t\t<div class="print-image">\n\t\t\t\t<qui-input-number\n\t\t\t\t\t\tqui-tid="print-pdf-dpi"\n\t\t\t\t\t\tqui-model="print.dpi"\n\t\t\t\t\t\tqui-disabled="state === states.PENDING"\n\t\t\t\t\t\tqui-min="0"\n\t\t\t\t\t\tqui-max="300"\n\t\t\t\t\t\tqui-with-buttons="true"></qui-input-number>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.Layout"></div>\n\t\t\t<div class="lui-buttongroup">\n\t\t\t\t<button class="lui-button"\n\t\t\t\t\t\ttid="print-orientation-portrait"\n\t\t\t\t\t\tng-class="{ \'lui-active\': \'portrait\' === selectedLayout.orientation }"\n\t\t\t\t\t\tq-translation="Print.Portrait"\n\t\t\t\t\t\tng-click="onPrintLayout(layouts[0])"\n\t\t\t\t\t\tng-disabled="state === states.PENDING"></button>\n\t\t\t\t<button class="lui-button"\n\t\t\t\t\t\tid="print-orientation-landscape"\n\t\t\t\t\t\tng-class="{ \'lui-active\': \'landscape\' === selectedLayout.orientation }"\n\t\t\t\t\t\tq-translation="Print.Landscape"\n\t\t\t\t\t\tng-click="onPrintLayout(layouts[1])"\n\t\t\t\t\t\tng-disabled="state === states.PENDING"></button>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="section">\n\t\t\t<div class="section-title" q-translation="Print.Layout.Aspect"></div>\n\t\t\t<lui-radiobutton class="print-dialog-radio-single"\n\t\t\t\t\t\t\t tid="print-aspect-current-size"\n\t\t\t\t\t\t\t x-name="print-aspect"\n\t\t\t\t\t\t\t x-model="print.fitCriteria"\n\t\t\t\t\t\t\t x-value="0"\n\t\t\t\t\t\t\t x-disabled="state === states.PENDING">{{ \'Print.Layout.CurrentSize\' | translate }}</lui-radiobutton>\n\t\t\t<lui-radiobutton class="print-dialog-radio-single"\n\t\t\t\t\t\t\t tid="print-aspect-fit-page"\n\t\t\t\t\t\t\t x-name="print-aspect"\n\t\t\t\t\t\t\t x-model="print.fitCriteria"\n\t\t\t\t\t\t\t x-value="2"\n\t\t\t\t\t\t\t x-disabled="state === states.PENDING">{{ \'Print.Layout.BestFitNoPreserveAspectRatio\' | translate }}</lui-radiobutton>\n\t\t</div>\n\t\t<div ng-if="state === states.PENDING" class="loading-screen">\n\t\t\t<div class="spinner">\n\t\t\t\t<div class="qv-loader"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.COMPLETED">\n\t\t\t<div class="section">\n\t\t\t\t<a ng-href="{{printUrl}}" target="_blank" q-translation="Print.Pdf.CompletedLink"></a>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.TIMEOUT">\n\t\t\t<div class="section">\n\t\t\t\t<p class="dm-p" q-translation="Print.Failed.TimeoutMessage"></p>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="state === states.FAILED">\n\t\t\t<div class="section">\n\t\t\t\t<p class="dm-p" q-translation="Print.Failed.GenericMessage"></p>\n\t\t\t</div>\n\t\t</div>\n\t</lui-dialog-body>\n\n\t<lui-dialog-footer>\n\t\t<lui-button ng-click="$event.preventDefault(); close()" name="cancel" q-translation="Common.Cancel" tid="print-cancel"></lui-button>\n\t\t<lui-button ng-click="$event.preventDefault(); confirm(exportType)" name="confirm" autofocus q-translation="Print.Download" ng-disabled="state === states.PENDING" tid="print-export"></lui-button>\n\t</lui-dialog-footer>\n</lui-dialog>\n'},484:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(138),n(485),n(105),n(91)],a=function(t,e,n,i,a){t.directive("circleChart",function(){return{scope:{model:"="},restrict:"E",replace:true,template:n,controller:["$scope","$element","$timeout",function(t,n,s){var o=n.find(".circular-bar");t.radius=50;t.arcValue="M50 0 A 50 50, 0, 0, 1, 0 0, L 50 50 z";function r(){if(p()){var e=o.height();var n=o.width();if(e<n){t.radius=e/2;t.svgPos={height:e,width:e,top:0,left:n/2-e/2}}else{t.radius=n/2;t.svgPos={height:n,width:n,top:e/2-n/2,left:0}}}d()}function l(t,e,n,i){var a=(i-90)*Math.PI/180;return{x:t+n*Math.cos(a),y:e+n*Math.sin(a)}}function c(t,e,n,i,a){var s=l(t,e,n,a);var o=l(t,e,n,i);var r=a-i<=180?"0":"1";var c=["M",s.x,s.y,"A",n,n,0,r,0,o.x,o.y].join(" ");return c}function u(t){return 3.6*t}function d(){var n=0;if(t.model.chartValue)n=t.model.chartValue;else if(t.model.numerator&&t.model.denominator){n=0===t.model.denominator?0:t.model.numerator/t.model.denominator;n*=100}if(n>0&&n<1){var i=e.format.number(0,{style:"percent"});t.chartPercentageValue=a.get("CircleChart.ChartPercentageValue.LessThanOne",i)}else t.chartPercentageValue=e.format.number(Math.round(n)/100,{style:"percent"});var s=t.radius;var o=8;var r=0;if(t.model.chartValueSubText){o=-3;r=17}t.percentagePos={x:s,y:s+o};t.subtextPos={x:s,y:s+r};var l=100===n?99.99:n,d=l;d||(d=0);t.arcValue=c(s,s,s-5,0,u(d))}function p(){return o.height()>0||o.width()>0}t.$on(i.Events.EditorDetailsPane.ResizeChart,function(){r()});t.$watch("model",function(){d()});p()?r():s(function(){r()})}]}})}.apply(e,i),void 0!==a&&(t.exports=a))},485:function(t,e){t.exports='<div class="ds-visualization-circle-chart">\n\t<div class="chart-heading">{{ model.header }}</div>\n\n\t<div class="circular-bar">\n\t\t<svg version="1.1" xmlns="http://www.w3.org/2000/svg" ng-style="svgPos">\n\t\t\t<g class="arcs">\n\t\t\t\t<circle ng-attr-cx="{{radius}}" ng-attr-cy="{{radius}}" ng-attr-r="{{radius}}" class="outer-circle" />\n\t\t\t\t <path ng-attr-d="{{arcValue}}" class="outer-arc" tid="circle-chart-arc1" /> \n\t\t\t\t<circle ng-attr-cx="{{radius}}" ng-attr-cy="{{radius}}" ng-attr-r="{{radius - 10}}" class="inner-circle"  />\n\t\t\t</g>\n\t\t\t<text ng-attr-x="{{percentagePos.x}}" ng-attr-y="{{percentagePos.y}}" class="percentage-label">{{ chartPercentageValue }}</text>\n\t\t\t<text ng-attr-x="{{subtextPos.x}}" ng-attr-y="{{subtextPos.y}}" class="percentage-subtext-label">{{ model.chartValueSubText }}</text>\n\t\t</svg>\n\t</div>\n\n\t<div class="chart-footer">{{ model.footer }}</div>\n</div>\n\n'},486:function(t,e,n){"use strict";var i,a;!(i=[n(200),n(104)],a=function(t){function e(e,a,c){var u=e.length>0?e[0].positions:[],d=a._style,p=a._radialOptions,h=new t,g=d.ticks.major.length*c,f=d.label.offset*c*20,v,m,b="far"===a.getAlignment()?"left":"right",S=[],y=Math.min(a.rect.height,a.rect.width),I=0,x,q,w,C,P=[],T=a._radius,A;m="left"===b?1:-1;g*=m;v=m>0?0:a.rect.width;a.getShowLine()&&S.push({stroke:d.line.color,shape:{cx:a._centerPoint.x,cy:a._centerPoint.y,radius:T,radianOffset:0,start:p.start,end:p.end},type:"arc"});if(a.getShowLabels())for(A=0;A<u.length;A++){x=(u[A]-I)/(y-I);w=o(x,a);C=r(w);C.r=C.r+f;C=l(C,a._centerPoint);q=s(x,a);C.angle=q;P.push(C);h.save();h.translate(w.x+a._centerPoint.x,w.y+a._centerPoint.y);h.rotate(q);S.push({stroke:d.ticks.major.color,opacity:a.ticks[A].opacity,transform:h.elements,shape:{x1:0,x2:-g,y1:0,y2:0},type:"line"});h.restore()}v+=d.ticks.major.length*m;if(a._showLabels&&a._layoutMode>1)for(A=0;A<e.length;A++){S=S.concat(n(e[A],P,v,a));v+=e[A].labelSpace*m}a._showTitle&&a._layoutMode>1&&(S=S.concat(i(a,d)));a._renderer.shapes=S;a._renderer.render()}function n(t,e,n,i){var a=t.labels,s=e,o=t.opacities,r,l,c=[],u=i._style,d,p,h,g,f,v,m;p=a?a.length:0;if(0===p)return;h=p-1;for(v=0;v<p;v++){g=i.yMirrorMode?a[h-v]:a[v];r=i._renderer.getTextWidth(g,u.label.font);f=s[v];d=f.angle;l=d-.1<3*Math.PI/2&&d+.1>3*Math.PI/2?"center":d<Math.PI/2||d>3*Math.PI/2?"left":"right";c.push({type:"text",fill:u.label.color,opacity:o?o[v]:1,shape:{text:g,x:f.x,y:f.y,maxWidth:f.x-r<0?f.x:f.x+r>i.rect.width?i.rect.width-f.x:r,height:m,maxNumLines:1,font:u.label.font,align:l,baseline:"middle"}})}return c}function i(t,e){var n=[],i=Math.min(t.rect.width,t.rect.height),s=a(t);n.push({type:"text",fill:e.title.color,opacity:1,shape:{text:t._title,x:s.x,y:s.y+i*(.06+Math.min(i-300,0)/-300*.04),maxWidth:1.4*t._radius,maxNumLines:1,font:e.title.font,align:"center",baseline:"middle"}});return n}function a(t){var e={x:t.rect.width/2,y:t.rect.height/2};return e}function s(t,e){var n=e._radialOptions,i=Math.max(Math.min(t,1),0)*(n.end-n.start)+n.start;return i}function o(t,e,n){var i=e._radialOptions,a=t*(i.end-i.start)+i.start,s=e._radius;return l({a:a,r:s},n)}function r(t){return{r:Math.sqrt(t.x*t.x+t.y*t.y),a:Math.atan2(t.y,t.x)}}function l(t,e){e||(e={x:0,y:0});return{x:e.x+t.r*Math.cos(t.a),y:e.y+t.r*Math.sin(t.a)}}return{renderRadial:e,getPointOfValue:o,getPolPos:r,getCartPos:l,getAngleOfNormalizedValue:s}}.apply(e,i),void 0!==a&&(t.exports=a))},508:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(91),n(94),n(969),n(207),n(99),n(97),n(133),n(236),n(509),n(192),n(287),n(510),n(274)],a=function(t,e,n,i,a,s,o,r,l,c,u,d){function p(t){return{odagLinkItem:function e(n){var a=n.item.getDropOption();var s={insertBeforeItem:t,title:a.args.init.linkRef.name,odagLinkRefID:a.args.init.linkRef.id};var o=i.model;l.addODAGNavPoint(o,s)}}}function h(e,n){function i(t,e,n){var i=p(e);var a={targetRect:n,drawRect:n,drop:i,dropShadePercentage:10};t.registerDropRect(a)}var a;var s={accept:{odagLinkItem:function t(){return true}},end:function t(){n.removeClass(a);e.dragging=false},start:function s(o){e.dragging=true;var r;try{r=n[0].getBoundingClientRect()}catch(t){return}var l={left:r.left+2,right:r.right-2,top:r.top+2,bottom:r.bottom-2};a="odagLinkItem"===o.info.type?"dragging library-dragging":"dragging";n.addClass(a);var c=n.find(".dropArea");for(var u=0;u<c.length;u++){var d=t(c[u]);var p=d[0].getBoundingClientRect();var h={left:p.left+2,right:p.right-2,top:p.top+2,bottom:p.bottom-2};var g=null;var f=e.odagNavPoints;u<f.items.length&&(g=f.items[u]);i(o,g,h)}var v=n.find(".odag-nav-point-cell:last");var m={left:0,right:0,top:0,bottom:0};var b=l.left;if(v.length){m=v[0].getBoundingClientRect();b=m.right}var S={left:b,top:l.top,right:l.right,bottom:l.bottom};i(o,null,S)}};c.registerDropTarget(s);e.$on("$destroy",function(){c.unregisterDropTarget(s)})}var g={template:a,restrict:"E",scope:{model:"=",inEditMode:"=",standAlone:"="},link:function t(e,n){h(e,n)},controller:["$scope","$timeout","$element","qvSheetService",function(t,e,a,c){t.sortableNavPoints=null;var p=t.standAlone?null:c;t.odagToolbarService=new u(p);t.dragging=false;t.waterMarkText="";var h=null;l.isODAGAvailable(t.model.app).then(function(e){e&&d.getList().then(function(e){e.layout&&e.layout.qAppObjectList&&e.layout.qAppObjectList.qItems.length>0&&l.getODAGLinks(t.model.app)})});t.sortableNavPoints=s.create({options:{direction:"horizontal",listKey:"list",listSelector:".list",itemKey:"item",itemSelector:".drag-odag-navpoint",itemDragSelector:".drag-odag-navpoint",gesture:{name:"swipe",options:{radiusThreshold:o.treatAsDesktop()?4:0,preventDefault:false}}},allowDrag:function e(){var e=this._super.apply(this,arguments);return e&&t.inEditMode},addPlaceholder:function t(){this._super.apply(this,arguments)},onBegin:function t(e){this._super.apply(this,arguments);h=e;h.classList=["reordering"];var n=a.find(".list");n.css("height",n.innerHeight())},removePlaceholder:function t(){this._super.apply(this,arguments);var e=a.find(".list");e.css("height","");h.classList=""},onMove:function e(){this._super.apply(this,arguments);var n=t.odagNavPoints.get().map(function(t){return t.data});var a=i.model;l.reorderNavPoints(a,n)}});t.odagNavPoints=t.sortableNavPoints.createList(1,{tid:"odagNavPoints"});t.$watchCollection("odagToolbarService.getOdagNavPoints()",function(n){t.odagNavPoints.reset();for(var i=0;i<n.length;i++)t.odagNavPoints.addSortableItem(n[i]);e(function(){t.$broadcast("refreshPager")})});t.$watch("model.sheetId",function(e){t.odagToolbarService.sheetChanged(e)});t.$watch("dragging",function(e){t.waterMarkText=e?n.get("odag.toolbar.help.dragging"):n.get("odag.toolbar.help.watermark")});t.odagToolbarService.init(t.model.app,t.model.openAppCallback).then(function(){t.waterMarkText=n.get("odag.toolbar.help.watermark")});r.on("end",function(){t.refreshPager(false)});t.$on("$destroy",function(){t.odagToolbarService.destroy()})}]};e.directive("qvOdagToolbar",function(){return g});return g}.apply(e,i),void 0!==a&&(t.exports=a))},509:function(t,e,n){"use strict";var i,a;!(i=[n(89),n(49),n(970),n(131),n(120),n(375),n(133),n(192),n(219)],a=function(t,e,n,i,a,s,o,r,l){function c(t){this.qvSheetService=t;this.currentApp=null;this.currentSheet=null;this.odagNavPoints=null;this.appLinkModelList=null;this.openAppCallback=null}c.prototype.init=function(t,e){var n=this;this.odagNavPoints=[];this.currentApp=t;this.openAppCallback=e;return r.getList(t).then(function(t){n.appLinkModelList=t;return t.getLayout().then(function(){n.updateNavPoints();t.Invalidated.bind(n.updateNavPoints.bind(n))})})};c.prototype.sheetChanged=function(t){var e=this;this.currentSheet&&this.currentSheet.Invalidated.unbind(this.updateNavPoints);t&&a.get(t,this.currentApp).then(function(t){e.currentSheet=t;if(e.currentSheet){e.updateNavPoints();e.currentSheet.Invalidated.bind(e.updateNavPoints.bind(e))}})};c.prototype.getODAGLinkInfo=function(n){var i=new t;if(n._cachedLinkProps)i.resolve(n._cachedLinkProps);else if(n.data.odagLinkRefID)l.getList(n.model.parent.app).then(function(t){if(t.filter(function(t){return t.properties.data.id===n.data.odagLinkRefID}).length>0)o.loadODAGLink(n.model.parent.app,n.data.odagLinkRefID).then(function(t){var a=e.getFlag("ODAG_SAAS_ENABLED")?t:t.objectDef;if(!t||"decommissioned"!==a){n.invalid=false;n.maxNumberOfApps=a.properties.genAppLimit[0].limit;n.maxRowExpressionCount=a.properties.rowEstRange[0].highBound;n._cachedLinkProps=a;return i.resolve(a)}n.invalid=true;i.resolve(null)},function t(){n.invalid=true;i.resolve(null)});else{n.invalid=true;i.resolve(null)}});else{n.invalid=true;i.resolve(null)}return i.promise};c.prototype.createODAGNavPointsList=function(e){var a=i.selectedObject?i.selectedObject:null;var r=null;var l=this;if(void 0!==e){this.odagNavPoints.splice(0,this.odagNavPoints.length);e.forEach(function(e){var c={id:e.info.id,type:"ODAGNavPoint",object:{isInvalid:true},data:e,openAppCallback:l.openAppCallback,model:null,maxRowExpressionCount:null,maxNumberOfApps:null,_cachedLinkProps:null,invalid:false,initialized:null};var u={parent:l.currentSheet,properties:e};c.model=new n(u);c.getLoadedLinkInfo=l.getODAGLinkInfo;c.getCurrentCountSessionObjectForLink=function(){return this.getLoadedLinkInfo(c).then(function(e){return e?o.getOrCreateSessionObjectsForLink(l.currentApp,e).then(function(t){return t}):t.resolve(null)})};l.odagNavPoints.push(c);if(a&&a.id===e.info.id&&!o.addingNewNavPointID[l.currentSheet.id]){r=c;i.setSelectedObject(s.createSelectedObjFromNavPoint(c))}});if(o.addingNewNavPointID[this.currentSheet.id]){var c=this.odagNavPoints.filter(function(t){return t.data.info.id===o.addingNewNavPointID[l.currentSheet.id]});if(c.length){i.setSelectedObject(s.createSelectedObjFromNavPoint(c[0]));r=c[0]}o.addingNewNavPointID[this.currentSheet.id]=null}this.qvSheetService&&a&&"ODAGNavPoint"===a.type&&!r&&this.qvSheetService.setSheetAsSelectedObj()}};c.prototype.updateNavPoints=function(){var t=this;if(this.currentApp&&this.currentSheet)return o.clearCachedSessionObjects(this.currentApp).then(function(){t.currentSheet.getNavPoints().then(function(e){t.createODAGNavPointsList(e)})})};c.prototype.hasODAGNavPoints=function(){return this.odagNavPoints.length>0};c.prototype.destroy=function(){this.odagNavPoints=[];this.appLinkModelList.Invalidated.unbind(this.updateNavPoints);this.currentSheet.Invalidated.unbind(this.updateNavPoints)};c.prototype.getOdagNavPoints=function(){return this.odagNavPoints};return c}.apply(e,i),void 0!==a&&(t.exports=a))},510:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(89),n(131),n(135),n(972),n(97),n(973),n(90),n(375),n(274),n(980)],a=function(t,e,n,i,a,s,o,r,l){var c={template:a,restrict:"E",replace:true,scope:{inEditMode:"=",inMobileMode:"=",item:"="},controller:["$scope","$timeout","$element","luiPopover",function(t,a,c,u){t.popover=null;t.stageState=n;t.$watch("stageState.selectedObject",function(e){t.selObject=e});var d=null;t.rowCountPercentage=0;function p(){if(t.popover){t.popover.close();return}var e={item:t.item};if(e.item.openAppCallback){var n=e.item.openAppCallback;e.item.openAppCallback=function(e,i){t.popover.close();n(e,i)}}var i=o;var a={input:e,dock:"top",alignTo:c[0],closeOnResize:true};i=r.extend(true,a,i);t.popover=u.show(i);t.popover.closed.then(function(){t.popover=null})}function h(){t.popover&&t.popover.close();return}function g(){var n=new e;if(d){var s=t.item;d.getLayout().then(function(e){s.actualRowEst=e.MaxRowCountExpression;i.isSuffixInUse("noData")&&(s.actualRowEst="NaN");var n=s.maxRowExpressionCount;var o=100*Math.min(n/s.actualRowEst,1);if(o>=100)if(100!==t.rowCountPercentage){t.rowCountPercentage=99;a(function(){t.rowCountPercentage=100;s.rowCountPercentage=100;s.rowCountPercentageNumber=100},300)}else s.rowCountPercentage=100;else{s.rowCountPercentage=o;t.rowCountPercentage=o}"number"===typeof s.rowCountPercentage&&Number.isNaN(+s.rowCountPercentage)?s.rowCountPercentageNumber=-1:s.rowCountPercentageNumber=s.rowCountPercentage}).finally(function(){n.resolve()})}else n.reject();return n.promise}function f(){t.item.getCurrentCountSessionObjectForLink().then(function(e){d=e;d&&d.Invalidated.bind(g);g().finally(function(){t.item.initialized.resolve()})})}t.$watchCollection("item",function(t,n){if(null!==n&&null===t.initialized){t.initialized=new e;f()}});s.on("end",h);t.onODAGNavPointClicked=function(e){if(t.inMobileMode)return;t.inEditMode?n.setSelectedObject(l.createSelectedObjFromNavPoint(e)):t.item.invalid||p(e)};t.deleteInvalidNavPoint=function(t,e){e.model.removeObject()};a(function(){t.$broadcast("refreshPager")});t.$on("$destroy",function(){d&&d.Invalidated.unbind(g)})}]};t.directive("qvOdagToolbarNavpoint",function(){return c});return c}.apply(e,i),void 0!==a&&(t.exports=a))},612:function(t,e){t.exports='<lui-tooltip ng-style="style">\n\t{{item}}\n</lui-tooltip>'},833:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(834),n(99),n(112),n(92),n(144),n(89),n(97),n(148),n(124),n(96),n(142),n(49),n(157),n(95),n(93),n(108),n(155),n(176),n(835),n(837),n(175)],a=function(t,e,n,i,a,s,o,r,l,c,u,d,p,h,g,f,v,m,b){var S=".globalSelections",y=s.extend({init:function e(n,a){var s=this;var o=m.inClient();this.$scope=n;this.callbacks=[];this.ignoreUpdates=false;this.hasLoaded=false;n.dimensions=[];n.dimensionsFields=[];n.selectedFields=[];n.fields=[];n.dimAvailable=false;n.showFields=a.getShowFields(n.app);n.showFieldsCheckbox=true;n.filter="";n.autoFocus=i.treatAsDesktop();n.selectionToolbarOpen=false;n.showNoMatches=false;n.disableSelectionInsights=false;n.selInsightsEnabled=h.getFlag("SELECTION_INSIGHTS")&&o;function l(){var t=new r;c.isRunning().then(function(){t.resolve(true)},function(){t.resolve(false)});return t.promise}var c;if(o){c=new b;var u=localStorage.getItem("qv-global-selections-settings");v.getApp().then(function(t){l().then(function(e){g.load(t).then(function(){!g.isVariableDefined("DISABLE_SELECTION_INSIGHTS")&&e||(n.disableSelectionInsights=true);u&&!JSON.parse(u).open?n.showInsights=false:n.showInsights=true})})})}n.handleEscape=function(t){if(n.filter&&n.filter.length>0){n.filter="";t.stopImmediatePropagation();t.preventDefault()}else a.off()};function d(){localStorage.setItem("qv-global-selections-settings",JSON.stringify({open:n.showInsights}))}n.showInsightsPanel=function(){n.showInsights=true;d();f.publish("selection/insights/show")};var p=function t(){n.showInsights=false;d();localStorage.setItem("qv-global-selections-settings",JSON.stringify({open:n.showInsights}))};f.subscribe("selection/insights/close",p);n.$on("$destroy",function(){f.unsubscribe("selection/insights/close",p)});r.all({fields:this.getFields(),select:this.bindCurrentSelections(),dim:this.getLibraryDimensions(),reg:this.registerExtensions()}).then(function(){s.hasLoaded=true;n.showFieldsCheckbox=n.fields.length>0;n.dimAvailable=n.dimensions.length>0;if(!n.dimAvailable&&n.showFieldsCheckbox){n.showFields=true;a.setShowFields(n.showFields,n.app)}n.$watch("filter",function(){s.filterShown(s,s.$scope)});n.$watch("showFields",function(){a.setShowFields(n.showFields,n.app);s.filterShown(s,s.$scope)});t(".qv-gs-section .qv-gs-header")[1].style.display="none";t(".qv-gs-section .qv-gs-header")[1].offsetHeight;t(".qv-gs-section .qv-gs-header")[1].style.display="block"})},registerExtensions:function t(){var e=new r;u.load().then(function(){e.resolve()});return e.promise},getFields:function t(){var e=this.$scope;return e.app.getFieldList().then(function(t){e.fields=o.expand(t).map(function(t){return{title:t.qName,qField:t.qName,qTags:t.qTags}})})},_updateCurrentSelectionFields:function t(e){var n=this,i=this.$scope;i.selectedFields=e.qSelectionObject.qSelections.filter(function(t){return!t.qIsHidden}).sort(p.sortSelections).map(function(t){return{title:t.qReadableName||t.qField,qField:t.qField,enableBadge:true}});n.hasLoaded&&n.filterShown(n,i)},handleCurrentSelectionFields:function t(){var e=this;this.$scope.currentSelectionsModel.getLayout().then(function(t){e._updateCurrentSelectionFields(t)})},bindCurrentSelections:function t(){var e=this.$scope,n=this;return n.$scope.app.getCurrentSelectionObject().then(function(t){e.currentSelectionsModel=t;n.subscription=t.layoutSubscribe(function(t){if(e.app.isInModalSelection())return;n._updateCurrentSelectionFields(t)})})},getLibraryDimensions:function t(){var e=this.isCalculatedField,n=this.$scope;return n.app.getDimensionList().then(function(t){n.dimensions=t.filter(function(t){return t.qData.info.length>0&&!t.qData.info.some(e)&&"H"!==t.qData.grouping}).map(function(t){return{title:t.qData.labelExpression||t.qData.title,fieldName:t.qData.info[0].qName,qId:t.qInfo.qId}})})},isCalculatedField:function t(e){return"="===e.qName[0]},filterShown:function t(n,i){var s="",o=[];i.dimensionsFields=i.dimensions.filter(function(t){return!i.selectedFields.some(function(e){return t.fieldName===e.qField})});if(i.showFields){o=i.fields.filter(function(t){return!i.selectedFields.some(function(e){return e.qField===t.qField})});o=c.removeMeasureAndDetailsFields(o);i.dimensionsFields=i.dimensionsFields.concat(o.filter(function(t){return!i.dimensions.some(function(e){return t.qField===e.fieldName})}))}if(i.filter.length>0){s=i.filter.toLowerCase();o=i.dimensionsFields.filter(function(t){return-1!==t.title.toLowerCase().indexOf(s)});i.dimensionsFields=o}a.localeOrderBy(i.dimensionsFields,function(t){return t.title});i.showNoMatches=0===i.dimensionsFields.length&&!this.ignoreUpdates&&i.filter.length>0;e.$apply(i,function(){n.notifyCallbacks(n)})},addCallback:function t(e,n){this.callbacks.push({type:e,fn:n})},notifyCallbacks:function t(e){if(!e.hasLoaded)return;if(e.ignoreUpdates)return;e.callbacks.forEach(function(t){"fields"!==t.type&&"dimensions"!==t.type||t.fn()})},setIgnoreUpdates:function t(e){this.ignoreUpdates=e}});y.$inject=["$scope","qvGlobalSelectionsService"];e.directive("qvGlobalSelections",["$document","qvSelectionToolbarService","$timeout",function(e,i,a){return{restrict:"E",template:n,controller:y,require:["qvGlobalSelections"],scope:{app:"="},replace:true,link:function n(s,o,r,c){s.toolbar=!!e.find(".qui-toolbar,.qs-toolbar")[0];var u=c[0],g=function t(){u.ignoreUpdates=false},f=function t(){s.selectionToolbarOpen=false;a(function(){u.handleCurrentSelectionFields()})},v=function t(){s.selectionToolbarOpen=true};i.Closed.bind(f);i.Opened.bind(v);e.on("keyup"+S,function(t){27===t.which?u.ignoreUpdates=false:13===t.which&&(u.ignoreUpdates=false)});h.getFlag("ALT_STATE_ONE")&&p.getSelectionStates(s.app).then(function(t){t.splice("$",1);s.hasStatesOtherThanDefault=t.length>0});d(e[0].body).tap({id:S,options:{preventDefault:false},start:function e(n){var i=t(n.target).closest(".qv-gs-badge").length>0,a=t(n.target).closest(".qv-gs-listbox").length>0,s=t(n.target).closest(".qv-selection-toolbar").length>0;u.ignoreUpdates=a&&!i&&!s}});l.on("start",g);s.$on("$destroy",function(){u.callbacks=[];i.Closed.unbind(f);i.Opened.unbind(v);d(e[0].body).off("*",S);e.off(S);l.off("start",g);u.subscription&&u.subscription.dispose()});s.onEnter=function(t){t.stopPropagation();t.target.blur()}}}}]);return'<qv-global-selections app="app"></qv-global-selections>'}.apply(e,i),void 0!==a&&(t.exports=a))},834:function(t,e){t.exports='<div class="qv-global-selections" ng-class="{\'toolbar\': toolbar, \'selection-toolbar-open\': selectionToolbarOpen, \'insights-active\': showInsights && selInsightsEnabled }">\n\t<div class="qv-gs-sections">\n\t<section class="qv-gs-section qv-gs-top" tid="globalSelections.topSection" ng-class="{\'qv-gs-section-margin\' : showInsights && !disableSelectionInsights}">\n\t\t<header class="qv-gs-header">\n\t\t\t<h2 ng-if="!hasStatesOtherThanDefault" q-translation="GlobalSelections.CurrentSelections"></h2>\n\t\t\t<h2 ng-if="hasStatesOtherThanDefault" q-translation="GlobalSelections.CurrentSelections.Default"></h2>\n\t\t\t<div class="show-insights-btn" ng-show="selInsightsEnabled && !showInsights && !disableSelectionInsights">\n\t\t\t\t<button tid="explore-selections-button" class="lui-button show-insights--button" ng-click="showInsightsPanel()">\n\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--lightbulb"></span><span class="lui-button__text"  q-translation="ExploreSelections.ExploreSelectionsBtn"></span>\n\t\t\t\t</button></div>\n\t\t</header>\n\t\t<div class="qv-gs-no-selections" ng-if="selectedFields.length == 0">\n\t\t\t<div class="qv-gs-no-selections-content">\n\t\t\t\t<div class="qv-qs-no-selections-image"></div>\n\t\t\t\t<div class="qv-qs-no-selections-title" q-translation="GlobalSelections.NoSelections"></div>\n\t\t\t\t<div class="qv-qs-no-selections-body" q-translation="GlobalSelections.NoSelectionsBody"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div qv-global-select-section="{ itemSize: 220, itemSpacing: 20, type: \'fields\' }" all-items="selectedFields" app="app"></div>\n\t</section>\n\n\t<section class="qv-gs-section" tid="globalSelections.bottomSection" ng-class="{\'qv-gs-section-margin\' : showInsights && !disableSelectionInsights}">\n\t\t<header class="qv-gs-header">\n\t\t\t<h2 q-translation="GlobalSelections.AppDimensions"></h2>\n\t\t\t<lui-checkbox class="global-show-fields-checkbox" x-model="showFields" title="{{\'GlobalSelections.ShowFields\'|translate}}" tid="globalSelections.showFields">{{\'GlobalSelections.ShowFields\'|translate}}</lui-checkbox>\n\t\t\t<lui-search  class="qv-gs-searchfield" placeholder="{{showFields ? \'GlobalSelections.FilterDimensionsAndFields\' : \'GlobalSelections.FilterDimensions\'}}" query="filter" maxlength="255"\n\t\t\t\t\t\t\t tid="globalSelections.searchField" on-escape="handleEscape($event)" auto-focus="autoFocus" on-enter="onEnter($event)"></lui-search>\n\t\t</header>\n\n\t\t<div class="qv-gs-info" ng-if="!dimAvailable && !showFields">\n\t\t\t<h2 q-translation="GlobalSelections.DimensionsWarning"></h2>\n\t\t</div>\n\t\t<div class="qv-gs-info" ng-if="showNoMatches">\n\t\t\t<h2 q-translation="GlobalSelections.NoMatchesForSearch"></h2>\n\t\t</div>\n\t\t<div qv-global-select-section="{ itemSize: 220, itemSpacing: 20, type: \'dimensions\'}" all-items="dimensionsFields" filter="filter" app="app"></div>\n\n\t</section>\n\t</div>\n\n\t<div tid="selection-insights-container" class="qv-insights-container" ng-if="selInsightsEnabled && showInsights && !disableSelectionInsights">\n\t\t<qv-selection-insights show-fields="showFields"></qv-selection-insights>\n\t</div>\n</div>\n'},835:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(836),n(92),n(141),n(153),n(97),n(89),n(206),n(179),n(270),n(11),n(90),n(104),n(251),n(114),n(99),n(176),n(244)],a=function(t,e,n,i,a,s,o,r,l,c,u,d,p,h,g,f){function v(t,e){while(t.length>e)t.pop()}var m=c.extend({init:function t(){this.resetColumnIndex();this._super.apply(this,arguments)},resetColumnIndex:function t(){this.columnIndex=0},setList:function t(e){this.list=e;this.scrollApi.setTotalRows(this.list.length);this.setItems(this.columnIndex,this.scrollApi.settings.blockSize);this.scrollApi.updateLoadingButtons()},onInitialNativeScroll:function t(){return o.resolve()},onGotoNextBlock:function t(){var e=this._super.apply(this,arguments).then(function(){this.columnIndex=this.getFirstElementIndex()}.bind(this));return e},onGotoPreviousBlock:function t(){var e=this._super.apply(this,arguments).then(function(){this.columnIndex=this.getFirstElementIndex()}.bind(this));return e}}),b=l.extend({resetNativeScroll:function t(){this.$scrollArea.scrollLeft(0)},alignToFirstRow:function t(){var e=this.getFirstRow(),n=e.children(".qv-object-wrapper").attr("id"),i=260;return function(){var t=u(this.$scrollArea.find("#"+n)),e;if(t.length>0){e=t.offset().left-i;this.$scrollArea.scrollLeft(e)}}.bind(this)},alignToLastRow:function t(){var e=this.getLastRow(),n=e.children(".qv-object-wrapper").attr("id"),i=250;return function(){var t=u(this.$scrollArea.find("#"+n)),e;if(t.length>0){this.$scrollArea.scrollLeft(0);e=t.parent().position().left-this.getScrollAreaBoundingBox().width+t[0].getBoundingClientRect().width+i;this.$scrollArea.scrollLeft(e)}}.bind(this)},getBoundingBox:function t(){var e=this._super.apply(this,arguments);return new p(e.top,e.left,e.height,e.width)}}),S=n.extend({size:{width:0,height:0},itemSize:0,itemSpacing:0,$element:void 0,init:function t(e,n,i){this.$scope=e;this.$timeout=n;this.selectionToolbarService=i;this.$scope.items=[];this.$scope.options={direction:g.direction}},initialize:function t(e,n,i){this.setSize(n);this.setItemSize(i.itemSize);this.setItemSpacing(i.itemSpacing);this.setElement(e.find(".qv-gs-scroll-area"));this.setItems();this.initialized=true},updateVisible:function t(){var e=this.offsetX-(this.$scope.scrollApi.loadPrevious?1:0),n=this.visibleItemsCount;this.$scope.items.forEach(function(t,i){var a=i>=e&&i<e+n;!t.visible&&a&&(t.options={isPopOver:false,highlightTitle:true,direction:g.direction});a&&!t.model&&this.getModel(t).then(function(t,e){t.model=e}.bind(null,t));t.visible=a},this)},getModel:function t(e){var n=this.getInitProps(e.title),a;e.qField?a=i.createTransientField(this.$scope.app,e.qField,n):e.qId&&(a=i.createTransientDimension(this.$scope.app,e.qId,n));return a},onScroll:function t(){this.qvGlobalSelectionsCtrl.setIgnoreUpdates(false);this.selectionToolbarService.confirm();this.updateHighlights();this.$timeout.cancel(this.scrollTimeout);this.scrollTimeout=this.$timeout(function(){this.updateVisible();this.updateHighlights()}.bind(this),100)},onResize:function t(e){this.setSize(e);this.updateVisible()},updateHighlights:function t(){this.$scope.items.forEach(function(t){t.options.highlightQuery=this.$scope.filter},this)},setItems:function t(){var e,n,i,a=this.$scope,s=this.totalItemsCount;a.items.length!==s&&v(a.items,s);for(e=0;e<s;e++){n=a.items[e]||{};i=a.scrollApi.items[e];i.enableBadge&&(n.enableBadge=i.enableBadge);n.model||(n.options={isPopOver:false,highlightTitle:true,direction:g.direction});if(i.qField){delete n.qId;if(!n.model||n.qField!==i.qField){if(n.visible){a.items[e]=d.extend(true,{},n);n=a.items[e];delete n.$$hashKey;delete n.options.search}n.title=i.title;n.qField=i.qField;n.id=h.sha256(n.qField);delete n.model}}else if(i.qId){delete n.qField;if(!n.model||n.qId!==i.qId){if(n.visible){a.items[e]=d.extend(true,{},n);n=a.items[e];delete n.$$hashKey;delete n.options.search}n.title=i.title;n.qId=i.qId;n.id=h.sha256(n.qId);delete n.model}}a.items[e]||(a.items[e]=n)}this.updateVisible()},getInitProps:function t(e){var n={title:e,qListObjectDef:{qDef:{}}};a.autoSortDimension(n.qListObjectDef);return n},getWidthOf:function t(e){return this.totalItemSize*e-this.itemSpacing},setItemSize:function t(e){this.itemSize=e||220},setItemSpacing:function t(e){this.itemSpacing=e||20},setSize:function t(e){this.size=e},setElement:function t(e){this.$element=e;this.$element.on("scroll",this.onScroll.bind(this))}});Object.defineProperties(S.prototype,{vPosX:{get:function t(){return this.$element.scrollLeft()}},totalItemSize:{get:function t(){return this.itemSize+this.itemSpacing}},visibleItemsCount:{get:function t(){var e=Math.ceil(((this.vPosX+(this.previousBtnVisible?240:0))%this.totalItemSize+this.size.width)/this.totalItemSize);return Math.min(e,this.totalItemsCount+(this.previousBtnVisible?1:0))}},totalItemsCount:{get:function t(){return(this.$scope.scrollApi.items||[]).length}},offsetX:{get:function t(){return Math.floor(this.vPosX/this.totalItemSize)}},previousBtnVisible:{get:function t(){return!!this.$scope.scrollApi.loadPrevious}}});S.$inject=["$scope","$timeout","qvSelectionToolbarService"];t.directive("qvGlobalSelectSection",["$parse","$timeout",function(t,n){return{controller:S,require:["qvGlobalSelectSection","^qvGlobalSelections"],template:e,replace:true,scope:{allItems:"=",filter:"=",app:"="},link:function e(i,a,o,l){var c=l[0],u=l[1],d=t(o.qvGlobalSelectSection)(),p={},h=a.find(".qv-gs-scroll-area"),g=h.controller("qvScrollArea"),v=a.find(".qv-scroll-loader").controller("qvScrollLoader"),S={blockSize:24,minRowHeight:240,maxRowHeight:240,keepItemsCount:4,virtualScrollEnabled:false},y=new r(n,S),I=new m(y),x=new b(a,h,".qv-gs-listbox",".qv-gs-listbox:first",".qv-gs-listbox:last"),q=null,w=function t(){p.width=a.innerWidth();p.height=a.innerHeight();c.onResize(p)};i.scrollApi=y;c.qvGlobalSelectionsCtrl=u;y.initialize(x,I,g,v).then(function(){y.activate();y.updateViewport();i.$watch("filter",function(){I.resetColumnIndex();y.resetNativeScroll()});i.$watch("allItems",function(t){if(!t)return;I.setList(t);q&&q();q=i.$watch("scrollApi.items",function(){var e=!f.treatAsDesktop();if(u.ignoreUpdates&&!e)return;if(0===y.items.length&&i.allItems.length>0){y.resetNativeScroll();I.resetColumnIndex();I.setList(t)}c.initialized&&c.setItems()})})}).catch(function(t){false});n(function(){p.width=a.innerWidth();p.height=a.innerHeight();c.initialize(a,p,d)});s.on("end",w);i.$on("$destroy",function(){s.off("end",w);y.destroy()});u.addCallback(d.type,function(){c.$timeout(function(){c.setItems();c.$timeout(function(){c.updateHighlights()})})})}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},836:function(t,e){t.exports='<div class="qv-gs-scroll-container">\n\t<qv-scroll-area class="qv-gs-scroll-area">\n\t\t<div ng-if="scrollApi.loadPrevious" class="qv-gs-scroll-btn qv-gs-scroll-btn-previous" tid="globalSelections.loadPrevious">\n\t\t\t<qv-scroll-load-button tag="div" class="qv-listbox-load-buttons" on-load="scrollApi.gotoPreviousBlock()" text="Object.Listbox.LoadPrevious" previous="true"></qv-scroll-load-button>\n\t\t</div>\n\t\t<div ng-repeat="item in items" class="qv-gs-listbox">\n\t\t\t<qv-object ng-if="item.visible" model="item.model" options="item.options" object="item.object" class="qv-object-listbox" id="{{item.id}}"></qv-object>\n\t\t\t<div ng-if="!item.visible" class="qv-object qv-object-listbox qv-gs-placeholder" id="{{item.id}}">\n\t\t\t\t<h1 class="qv-object-title" qva-direction x-dir-text="{{item.title}}">\n\t\t\t\t\t<span class="qv-object-title-text" qva-direction x-dir-text="{{item.title}}">{{item.title}}</span>\n\t\t\t\t</h1>\n\t\t\t\t<div class="progress">\n\t\t\t\t\t<qv-rain></qv-rain>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<p ng-if="item.qField" q-title-translation="Common.Field" tid="globalSelections.fieldIndicator" class="qv-gs-field-indicator" qva-direction>\n\t\t\t\t<span class="lui-icon  lui-icon--field"></span>\n\t\t\t</p>\n\t\t\t<qv-gs-badge></qv-gs-badge>\n\t\t</div>\n\t\t<div ng-if="scrollApi.loadNext" class="qv-gs-scroll-btn" tid="globalSelections.loadNext">\n\t\t\t<qv-scroll-load-button tag="div" class="qv-listbox-load-buttons" on-load="scrollApi.gotoNextBlock()" text="Object.Listbox.LoadMore"></qv-scroll-load-button>\n\t\t</div>\n\t</qv-scroll-area>\n\t<qv-scroll-loader tag="li" class="qv-scroll-row-loader"></qv-scroll-loader>\n</div>\n'},837:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(838),n(288)],a=function(t,e,n){function i(e,n){var i=n[2];t.$apply(t.$rootScope,function(){e.item.showBadge=(void 0===n[0]||false===n[0])&&false===n[1]&&!i})}t.directive("qvGsBadge",function(){return{restrict:"E",template:e,replace:true,link:function t(e){if(e.item.enableBadge){e.item.object||(e.item.object={});e.$watchCollection("[item.model.layout.qListObject.qDimensionInfo.qLocked, item.object.selectionsApi.active, item.object.model.layout.qListObject.qDimensionInfo.qIsOneAndOnlyOne]",function(t){i(e,t)});e.badgeClick=function(t){var e=new n(t.model);return e.beginSelections().then(function(){return e.clearSelections().then(function(){return e.endSelections(true)})})}}}}})}.apply(e,i),void 0!==a&&(t.exports=a))},838:function(t,e){t.exports='<div class="qv-gs-badge" ng-if="item.showBadge" q-title-translation="Tooltip.clearSelection" tid="globalSelections.badge" ng-click="badgeClick(item)">\n\t<span class="lui-icon lui-icon--remove"></span>\n</div>\n'},839:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(840),n(132),n(134),n(154),n(112),n(89),n(93),n(106),n(141),n(148),n(184),n(142),n(95),n(105),n(49),n(175),n(841),n(843),n(271),n(240),n(289)],a=function(t,e,n,i,a,s,o,r,l,c,u,d,p,h,g,f){function v(e,n){var i="",a=[];e.selectables=n.dimensions.filter(function(t){return!e.selectedFields.some(function(e){return t.qField===e.qField})});if(true===e.filter.showFields){a=n.fields.filter(function(t){return!e.selectedFields.some(function(e){return e.qField===t.qField})});a=u.removeMeasureAndDetailsFields(a);e.selectables=e.selectables.concat(a.filter(function(t){return!n.dimensions.some(function(e){return t.qField===e.qField})}))}if(e.filter.filter.length>0){i=e.filter.filter.toLowerCase();a=e.selectables.filter(function(t){return-1!==t.title.toLowerCase().indexOf(i)});e.selectables=a}s.localeOrderBy(e.selectables,function(t){return t.title});t.$apply(e)}function m(t){return t.every(function(t){return t.qLocked})}function b(e,i){var a=new o,s=t.getService("qvCurrentSelectionsService");n.get().then(function(t){e.currentSelectionsModel=t;l(e,"currentSelectionsModel",function(t){e.disable={clear:0===t.qSelectionObject.qSelections.length||m(t.qSelectionObject.qSelections),back:0===t.qSelectionObject.qBackCount,forward:0===t.qSelectionObject.qForwardCount};e.selectedFields=t.qSelectionObject.qSelections.filter(function(t){return!t.qIsHidden}).sort(p.sortSelections);e.selectedFields.forEach(function(t){t.translation=s.translate(t)});i.hasLoaded&&v(e,i)});a.resolve()});return a.promise}function S(t){var e=function t(e){return"="===e.qName[0]},n=new o;i.getList().then(function(i){i.getLayout().then(function(i){t.dimensions=i.filter(function(t){return t.qData.info.length>0&&!t.qData.info.some(e)&&"H"!==t.qData.grouping}).map(function(t){return{title:t.qData.title,qField:t.qData.info[0].qName,qId:t.qInfo.qId}});n.resolve()})});return n.promise}function y(t){var e=new o;a.getList().then(function(t){return t.getLayout()}).then(function(n){t.fields=n.map(function(t){return{title:t.qName,qField:t.qName,qTags:t.qTags,isField:true}});e.resolve()});return e.promise}var I=["$scope","qvGlobalSelectionsService",function(e,n){var i={hasLoaded:false,dimensions:[],fields:[]};e.filter={};r.getApp().then(function(a){e.app=a;e.selectedFields=[];e.filter.filter="";e.filter.showFields=n.getShowFields(a);e.filter.onEnter=function(t){t.stopPropagation();t.target.blur()};e.selectables=[];e.enableMenu=true;e.disable={clear:false,back:false,forward:false};t.getService("qvChartTooltipService").close();o.all({selectionsDfd:b(e,i),dimensionsDfd:S(i),fieldsDfd:y(i)}).then(function(){i.hasLoaded=true;e.enableMenu=i.fields.length>0;if(i.dimensions.length<=0&&e.enableMenu){e.filter.showFields=true;n.setShowFields(e.filter.showFields,a)}e.$watch("filter",function(){v(e,i)},true)})})}];t.directive("qvMobileSelections",["qvGlobalSelectionsService","qvListboxPopoverServiceMobile",function(t,n){return{restrict:"E",template:e,controller:I,replace:true,require:["qvMobileSelections"],scope:{},link:function e(i,a){var s,l=function t(){a.find(".qv-ms-scroll-area").animate({scrollTop:0})},u=d.createGroup("mobile-selections",0);u.registerKeys("enter",function(){});u.on();document.activeElement&&document.activeElement.blur();f.getFlag("ALT_STATE_ONE")&&r.getApp().then(function(t){p.getSelectionStates(t).then(function(t){t.splice("$",1);i.hasStatesOtherThanDefault=t.length>0})});i.close=function(e){e.preventDefault();t.toggleGlobalSelection(i.app);h.publish(g.Events.PubSub.RestoreSearchState)};i.selectionsBack=function(){i.disable.back||i.currentSelectionsModel.back()};i.selectionsForward=function(){i.disable.forward||i.currentSelectionsModel.forward()};i.selectionsClear=function(){i.disable.clear||i.currentSelectionsModel.clearAll()};i.toggleTooltip=i.filter.showFields?"GlobalSelections.HideFields":"GlobalSelections.ShowFields";i.toggleMenu=function(){i.filter.showFields=!i.filter.showFields;i.toggleTooltip=i.filter.showFields?"GlobalSelections.HideFields":"GlobalSelections.ShowFields";r.getApp().then(function(e){t.setShowFields(i.filter.showFields,e)})};i.$on("showListbox",function(t,e){var u={title:e.qReadableName||e.title,qListObjectDef:{qDef:{}}},d=-1!==i.selectedFields.indexOf(e),p=function t(){i.currentSelectionsModel.getLayout().then(function(t){var n;if(!d){n=t.qSelectionObject.qSelections.some(function(t){return e.qField===t.qField});if(n){s.resolve();return}}s.reject()})},h=function t(e){s&&s.reject();s=new o;s.promise.then(l);a.children(".qv-ms-searchbox").find("input").blur();n.show(e,{showLock:true},p)};r.getApp().then(function(t){e.qField?c.createTransientField(t,e.qField,u).then(h):c.createTransientDimension(t,e.qId,u).then(h)})});i.$on("$destroy",function(){s&&s.reject();u.delete()})}}}]);return"<qv-mobile-selections></qv-mobile-selections>"}.apply(e,i),void 0!==a&&(t.exports=a))},840:function(t,e){t.exports='<div class="qv-mobile-selections" tid="{{\'mobileSelections.showFields.\' + filter.showFields}}">\n\t<div class="qv-ms-toolbar">\n\t\t<p ng-click="selectionsBack()" ng-class="{\'qv-ms-button-disabled\' : disable.back, \'qv-ms-button-enabled\': !disable.back}" class="lui-icon lui-icon--selections-back qv-ms-toolbar-buttons" tid="mobileSelections.back" q-title-translation="Tooltip.NavigateBack"></p>\n\t\t<p ng-click="selectionsForward()" ng-class="{\'qv-ms-button-disabled\' : disable.forward, \'qv-ms-button-enabled\': !disable.forward}" class="qv-ms-toolbar-buttons lui-icon lui-icon--selections-forward" tid="mobileSelections.forward" q-title-translation="Tooltip.NavigateForward"></p>\n\t\t<p ng-click="selectionsClear()" ng-class="{\'qv-ms-button-disabled\' : disable.clear, \'qv-ms-button-enabled\': !disable.clear}" class="qv-ms-toolbar-buttons lui-icon lui-icon--clear-selections" tid="mobileSelections.clear" q-title-translation="Tooltip.ClearSelections"></p>\n\t\t<p ng-click="toggleMenu()" ng-class="{\'qv-ms-button-disabled\' : !enableMenu, \'qv-ms-button-enabled\': enableMenu, \'qv-ms-button-menu-active\': filter.showFields }" class="qv-ms-toolbar-buttons lui-icon\tlui-icon--settings" id="mobileSelectionsToggle" tid="mobileSelections.toggleFields" q-title-translation="{{toggleTooltip}}"></p>\n\n\t\t<qui-toolbarbutton ng-click="close($event)" name="close" class="qv-ms-toolbar-close" tid="mobileSelections.close">\n\t\t\t<span q-translation="Common.Close" class="qv-ms-toolbar-close-text"></span>\n\t\t</qui-toolbarbutton>\n\t</div>\n\t<header class="qv-ms-header">\n\t\t<h2 ng-if="!hasStatesOtherThanDefault" q-translation="GlobalSelections.CurrentSelections"></h2>\n\t\t<h2 ng-if="hasStatesOtherThanDefault" q-translation="GlobalSelections.CurrentSelections.Default"></h2>\n\t</header>\n\t<lui-search x-variant="inverse" class="qv-ms-searchbox" placeholder="{{filter.showFields ? \'GlobalSelections.FilterDimensionsAndFields\' : \'GlobalSelections.FilterDimensions\'}}" query="filter.filter" maxlength="255"\n\t\ton-enter="filter.onEnter($event)" tid="mobileSelections.searchfield">\n\t</lui-search>\n\t<div class="qv-ms-scroll-area">\n\t\t<qv-ms-selected ng-repeat="item in selectedFields"></qv-ms-selected>\n\t\t<div class="qv-ms-selectable" ng-if="filter.filter.length && (!selectables || selectables.length === 0)">\n\t\t\t<span q-translation="GlobalSelections.NoMatchesForSearch"></span>\n\t\t</div>\n\t\t<qv-ms-selectable ng-repeat="item in selectables"></qv-ms-selectable>\n\t</div>\n</div>\n'},841:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(842)],a=function(t,e){t.directive("qvMsSelectable",["$timeout",function(t){return{restrict:"E",replace:true,template:e,link:function e(n){n.showSelectable=function(){n.item.flash=true;t(function(){n.$emit("showListbox",n.item);n.item.flash=false},20)}}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},842:function(t,e){t.exports='<div ng-click="showSelectable()" ng-class="{\'qv-ms-touch-flash\' : item.flash}" class="qv-ms-selectable" tid="mobileSelections.selectable">\n\t<span ng-if="item.isField" class="lui-icon  lui-icon--field"></span>\n\t<div class="qv-ms-highlight">\n\t\t<span qve-highlight text="{{item.title}}" query="filter.filter"></span>\n\t</div>\n</div>\n'},843:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(844)],a=function(t,e){t.directive("qvMsSelected",function(){return{restrict:"E",replace:true,template:e,link:function t(e){e.showSelected=function(){e.$emit("showListbox",e.item)};e.clear=function(t){e.currentSelectionsModel.clearField(t)}}}})}.apply(e,i),void 0!==a&&(t.exports=a))},844:function(t,e){t.exports='<div class="qv-ms-selected" tid="mobileSelections.selected">\n\t<div class="qv-ms-selected-icon">\n\t\t<a ng-show="!item.qLocked && !item.qOneAndOnlyOne" ng-click="clear(item.qField)">\n\t\t\t<i class="lui-icon  lui-icon--remove"></i>\n\t\t</a>\n\t\t<a ng-show="item.qLocked" ng-click="showSelected(item.qField)">\n\t\t\t<i class="lui-icon lui-icon--lock"></i>\n\t\t</a>\n\t</div>\n\t<div ng-click="showSelected(item.qField)" class="qv-ms-selected-info" ng-class="{ \'no-icon\': item.qOneAndOnlyOne }">\n\t\t<h1 class="qv-object-title">{{item.qReadableName || item.qField}}</h1>\n\t\t<span>{{item.translation}}</span>\n\t\t<qv-state-count-bar state-counts="item.qStateCounts"></qv-state-count-bar>\n\t</div>\n</div>\n'},848:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(94),n(122),n(362)],a=function(t,e,n){var i;function a(){i||(i=t.getService("$navigationService"));return i}function s(){return a().Sheets.all.mashed}function o(){return a().Stories.all.mashed}function r(t){var n=e.model.id;var i=-1;t.forEach(function(t,e){t.qInfo.qId===n&&(i=e)});return i}function l(t,e){var n;e.forEach(function(e){e.qInfo.qId===t&&(n=e)});return n}function c(t,e){var n;e.forEach(function(e){e.qInfo.qId===t&&(n=e)});return n}function u(t){n.goToSheet(t,Object.keys(e.States)[e.state]);return{success:true,sheetId:t}}function d(t){n.goToStory(t,Object.keys(e.States)[e.States.play]);return{success:true,storyId:t}}function p(t,e,n){this.inClient=t;Object.defineProperties(this,{ANALYSIS:{get:function t(){return"analysis"}},EDIT:{get:function t(){return"edit"}},SNAPSHOT:{get:function t(){return"snapshot"}},sheets:{get:function n(){return t?s(this):e||[]}},stories:{get:function e(){return t?o(this):n||[]}}})}p.prototype.gotoSheet=function(t){var e=l(t,this.sheets);if(e)return u(t);return{success:false,error:"NOSUCHSHEET",errorMsg:"No such sheet"}};p.prototype.nextSheet=function(){if((e.view===e.Views.sheet||e.view===e.Views.object)&&e.model){var t=r(this.sheets)+1;var n=this.sheets[t===this.sheets.length?0:t].qInfo.qId;return u(n)}return{success:false,error:"NOCURRENTSHEET",errorMsg:"No current sheet"}};p.prototype.prevSheet=function(){if((e.view===e.Views.sheet||e.view===e.Views.object)&&e.model){var t=r(this.sheets)-1;var n=this.sheets[t<0?this.sheets.length-1:t].qInfo.qId;return u(n)}return{success:false,error:"NOCURRENTSHEET",errorMsg:"No current sheet"}};p.prototype.getCurrentSheetId=function(){if(e.view===e.Views.sheet&&e.model)return{success:true,sheetId:e.model.id};return{success:false,error:"NOCURRENTSHEET",errorMsg:"No current sheet"}};p.prototype.getMode=function(){return Object.keys(e.States)[e.state]};p.prototype.setMode=function(t){if(!this.isModeAllowed(t))return{success:false,error:"MODENOTALLOWED",errorMsg:"Mode not allowed"};e.setState(e.States[t]);return{success:true,mode:t}};p.prototype.isModeAllowed=function(t){switch(t){case this.ANALYSIS:return true;case this.EDIT:return this.inClient&&e.model.layout&&e.model.layout.permissions&&e.model.layout.permissions.update;case this.SNAPSHOT:return this.inClient}return false};p.prototype.gotoStory=function(t){var e=c(t,this.stories);if(e)return d(t);return{success:false,error:"NOSUCHSTORY",errorMsg:"No such story"}};return p}.apply(e,i),void 0!==a&&(t.exports=a))},849:function(t,e,n){"use strict";var i,a;!(i=[n(239)],a=function(t){function e(){this._options=null;this._appid=null;this._type=null;this._cols=null;return window.Reflect?window.Reflect.construct(HTMLElement,[],this.constructor):null}e.prototype=Object.create(HTMLElement.prototype);e.prototype.constructor=e;Object.setPrototypeOf(e,HTMLElement);e.prototype.connectedCallback=function(){i(this)};Object.defineProperty(e.prototype,"options",{get:function t(){return this._options},set:function t(e){this.setAttribute("options",e)}});e.observedAttributes=["options","appid","config"];e.prototype.attributeChangedCallback=function(t,e,s){if("options"===t&&this.vis){var o=JSON.parse(s);this.vis.setOptions(o)}else{a(this);"appid"!==t&&"config"!==t||n(this);i(this)}};e.prototype.disconnectedCallback=function(){a(this)};e.init=function(){window.customElements&&window.customElements.define&&customElements.define("qlik-visual",e)};return e;function n(e){var n=e.getAttribute("appid");if(n){var i=JSON.parse(e.getAttribute("config"));e.app=t.openApp(n,i)}else e.app=t.currApp()}function i(t){var e=t.getAttribute("visid"),i=JSON.parse(t.getAttribute("options"));t.app||n(t);if(t.app&&e)t.app.visualization.get(e).then(function(e){t.vis=e;i&&e.setOptions(i);e.show(t)});else if(t.app){var a=JSON.parse(t.getAttribute("cols")),s=t.getAttribute("type")||"barchart";t.app.visualization.create(s,a,i).then(function(e){t.vis=e;e.show(t)})}}function a(t){if(t.vis){t.vis.close();delete t.vis}}}.apply(e,i),void 0!==a&&(t.exports=a))},850:function(t,e){t.exports='<div class="qv-panel-subtoolbar qv-panel-current-selections" ng-class="{smallDevice: isSmallDevice, bright: brightCurSel, \'expand-smart-search-suggested-chart\': expandSmartSearchSuggestedChart}">\n\t<div ng-if="!isSmallDevice">\n\t\t<div class="qv-selections-pager" ng-class="{\'client-tab-navigation--bright\' : clientTabNavigation }">\n\t\t\t<div class="buttons borderbox border-bottom border-right" aria-hidden="true">\n\n\t\t\t\t<div tid="toggleGlobalSearchButton" tabindex="0" class="qv-subtoolbar-button toggle-button borderbox" ng-hide="hideSearch" ng-class="{active: isGlobalSearchActive, indexing: isGlobalSearchIndexing}" ng-click="toggleGlobalSearch()" q-title-translation="{{isGlobalSearchActive ? \'Tooltip.CloseGlobalSearch\' : \'Tooltip.GlobalSearch\'}}">\n\t\t\t\t\t<i class="lui-icon lui-icon--selection-search icon"></i>\n\t\t\t\t\t<div class="label" q-translation="GlobalSearch.Preparing" q-title-translation="GlobalSearch.Preparing.Tooltip"></div>\n\t\t\t\t\t<qv-progress-bar ng-if="isGlobalSearchIndexing" percent-done="indexPercentDone" on-completed="setSearchIndexingDone()" options="progressBarOptions"></qv-progress-bar>\n\t\t\t\t</div>\n\n\t\t\t\t<button class="qv-subtoolbar-button borderbox" ng-hide="hideUndoRedo" ng-click="back()" ng-disabled="disable.back" q-title-translation="Tooltip.NavigateBack" data-tid="current-selections-back">\n\t\t\t\t\t<i class="lui-icon lui-icon--selections-back"></i>\n\t\t\t\t</button>\n\n\t\t\t\t<button class="qv-subtoolbar-button borderbox" ng-hide="hideUndoRedo" ng-click="forward()" ng-disabled="disable.forward" q-title-translation="Tooltip.NavigateForward" data-tid="current-selections-forward">\n\t\t\t\t\t<i class="lui-icon lui-icon--selections-forward"></i>\n\t\t\t\t</button>\n\n\t\t\t\t<button id="clearselections" class="qv-subtoolbar-button borderbox" ng-disabled="disable.clear" ng-hide="hideClearSelections" ng-click="clearAllFields()" q-title-translation="Tooltip.ClearSelections" data-tid="current-selections-clear">\n\t\t\t\t\t<i class="lui-icon lui-icon--clear-selections"></i>\n\t\t\t\t</button>\n\n\t\t\t</div>\n\t\t\t<div class="selections-shadow" ng-if="showShadow"></div>\n\t\t\t<div class="wrap borderbox" style="height: 100%;" qv-pager qv-selection-pager>\n\t\t\t\t<ul class="list" ng-show="!isGlobalSelectionsActive || (items.length > 0 && currentSelectionDisabled) || (items.length > 0 && !isGlobalSelectionsActive)" qva-delegated-activate=".item#showPopover($event)" qva-outside-ignore-for="currentSelectionsItems">\n\t\t\t\t\t<li class="item" ng-class="{\'item-multi-state\': !item.isSingleState, \'multi-active\': multiPopoverFieldName && multiPopoverFieldName === item.qField, \'selection-insights-disabled\': currentSelectionDisabled}" ng-repeat="item in items track by item.qField" data-csid="{{item.qField}}" tabindex="0"\n\t\t\t\t\t ng-keydown="handleKeyDown($event, item)" aria-label="{{item.screenReaderLabel}}">\n\t\t\t\t\t\t<qv-current-selections-item ng-if="item.isSingleState" item="item" current-selection-disabled="currentSelectionDisabled"></qv-current-selections-item>\n\t\t\t\t\t\t<div ng-if="!item.isSingleState" class="current-selections-item" ng-mousemove="openTooltip($event, item)" ng-mouseleave="closeTooltip()">\n\t\t\t\t\t\t\t<div class="item-component label">\n\t\t\t\t\t\t\t\t<span ng-class="{ \'lui-icon lui-icon--lock\': item.qLocked }"></span><span class="name">{{item.name}}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="item-component count" title="">\n\t\t\t\t\t\t\t\t<span class="field-states-indicator">{{ item.states.length }}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="item-component caret">\n\t\t\t\t\t\t\t\t<span class="lui-icon lui-icon--arrow-down"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-if="currentSelectionDisabled" class="current-selections-disabled"></div>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\n\t\t\t\t<div ng-if="!items.length && !haveHiddenSelections" class="empty-text no-selection borderbox" q-translation="CurrentSelections.NoSelections"></div>\n\t\t\t\t<div ng-if="!items.length && haveHiddenSelections" class="empty-text no-selection borderbox" q-translation="CurrentSelections.OnlyHiddenSelections"></div>\n\t\t\t\t<a class="qv-pager-nav qv-pager-previous" ng-class="{inverted: brightCurSel}" ng-click="prevPage()" q-title-translation="Tooltip.Previous"><i class="lui-icon lui-icon--arrow-left"></i></a>\n\t\t\t\t<a class="qv-pager-nav qv-pager-next" ng-class="{inverted: brightCurSel}" ng-click="nextPage()" q-title-translation="Tooltip.Next"><i class="lui-icon lui-icon--arrow-right"></i></a>\n\t\t\t</div>\n\t\t\t<div class="buttons-end borderbox border-left">\n\t\t\t\t<div aria-hidden="true" class="qv-subtoolbar-button qv-explore-selections-btn toggle-button borderbox" tabindex="0" ng-class="{active: isGlobalSelectionsActive}" ng-hide="hideSelectionsTool" ng-click="toggleGlobalSelection($event)" q-title-translation="{{isGlobalSelectionsActive ? \'Tooltip.CloseGlobalSelector\' : \'Tooltip.GlobalSelector\'}}"\n\t\t\t\t tid="currentSelections.toggleGlobalSelections">\n\t\t\t\t\t<i class="lui-icon lui-icon--global-selector icon"></i>\n\t\t\t\t\t<span id="explore-selections-label" q-translation="CurrentSelections.ExploreSelectionsBtn"></span>\n\t\t\t\t</div>\n\n\t\t\t\t<div aria-labelledby="insights-label" tid="toggleCaoButton" id="toggle-insights" tabindex="0" class="qv-subtoolbar-button toggle-button borderbox qv-insight-toggle-button" ng-if="options && options.enableCao" ng-class="{active: isCaoActive, bright: brightCurSel}" ng-click="toggleCao()"\n\t\t\t\t q-title-translation="{{isCaoActive ? \'cao.CloseCognitiveAssociativeOverlay\' : \'cao.CognitiveAssociativeOverlay\'}}">\n\t\t\t\t\t<i class="lui-icon lui-icon--analyze icon" aria-hidden="true"></i>\n\t\t\t\t\t<span id="insights-label" q-translation="cao.CognitiveAssociativeOverlayToggleButton"></span>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\n\t\t</div>\n\t</div>\n\t<div ng-if="isSmallDevice && mobileIndicatorShow && !inSelection " ng-click="toggleGlobalSelection($event)" ng-class="{\'expand-smart-search-suggested-chart\': expandSmartSearchSuggestedChart}" class="qv-current-selections-mobile-wrapper" tid="currentSelections.toggleMobileSelections"\n\t q-title-translation="GlobalSelections.CurrentSelections">\n\t\t<div class="qv-current-selections-mobile-background">\n\t\t\t<p class="qv-current-selections-mobile-nbr" ng-class="{selections: nbrSelections > 0}">{{nbrSelections}}</p>\n\t\t</div>\n\t</div>\n</div>'},851:function(t,e){t.exports='<div qva-direction x-dir-setting={{options.direction}}" class="qv-tooltip qvt-generic-tooltip" ng-class="{\'above\':alwaysOnTop}">\n\t<div ng-repeat="item in content">\n\t\t<div qva-direction x-dir-text="{{item.header}}" x-dir-setting="{{options.direction}}" class="qv-tp-header">\n\t\t\t<strong>{{item.header}}</strong>\n\t\t</div>\n\t\t<table>\n\t\t\t<tr ng-repeat="row in item.rows" class="qv-tp-row">\n\t\t\t\t<td class=\'qv-tp-item\'>\n\t\t\t\t\t<div qva-direction x-dir-text="{{row.content}}" class="qv-tp-rowContent fade-out">{{row.content}}</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t</div>\n</div>'},852:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(184)],a=function(t,e,n){function i(i){var a={preventDefault:false,allowInInput:false};function s(){n.preventDefault();e.$rootScope.$apply()}function o(){i.inSelection&&t(document).trigger("qv-press");i.forward();s()}function r(){i.inSelection&&t(document).trigger("qv-press");i.back();s()}this.keyboardShortcutsGroup=n.createGroup("current-selection-"+i.app.id,1);this.keyboardShortcutsGroup.registerKeys("ctrl+shift+y",o,a);this.keyboardShortcutsGroup.registerKeys("ctrl+shift+z",r,a);this.keyboardShortcutsGroup.on();this.on=function(){if(!this._isOn){this.keyboardShortcutsGroup.on();this._isOn=true}};this.off=function(){if(this._isOn){this.keyboardShortcutsGroup.off();this._isOn=false}};this.delete=function(){this.keyboardShortcutsGroup.delete()}}return i}.apply(e,i),void 0!==a&&(t.exports=a))},853:function(t,e,n){"use strict";var i,a;!(i=[n(92)],a=function(t){var e=t.extend("CurrentSelectionsViewHelper",{init:function t(e,n,i,a,s,o){this.scope=e;this.responsiveState=n;this.globalSelectionService=i;this.exploreSelectionsService=a;this.globalSearchService=s;this.caoService=o},toggleGlobalSelection:function t(e){this.globalSelectionService.toggleGlobalSelection(e);this.responsiveState.isSmallDevice||this.globalSearchService.off();this.scope.isCaoActive=false;this.exploreSelectionsService.off();this.scope.isExploreSelectionsActive=false},toggleExploreSelection:function t(e){this.globalSelectionService.off();this.scope.isExploreSelectionsActive=this.exploreSelectionsService.toggleExploreSelection(e);this.globalSearchService.off();this.scope.isCaoActive=false},toggleGlobalSearch:function t(e){this.globalSearchService.toggleGlobalSearch(this.scope.app.enigmaModel,e,this.scope.options.objectSearch);this.scope.isCaoActive=false;this.globalSelectionService.off();this.exploreSelectionsService.off();this.scope.isExploreSelectionsActive=false},toggleCao:function t(e){this.scope.isCaoActive=this.caoService.toggleCao(e);this.globalSearchService.off();this.globalSelectionService.off();this.exploreSelectionsService.off();this.scope.isExploreSelectionsActive=false}});return e}.apply(e,i),void 0!==a&&(t.exports=a))},854:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(242)],a=function(t){t.widget("qv.pager",{options:{itemSelector:">li",orientation:"horizontal",pageSize:"auto",startPage:1,animationDuration:300},_create:function e(){var n=this.options;t.extend(this,{positionProperty:"horizontal"===n.orientation?"left":"top",sizeProperty:"horizontal"===n.orientation?"outerWidth":"outerHeight"});this.refresh();this.goToPage(n.startPage)},isItemInsidePage:function e(n){var i=t(n),a=i.position()[this.positionProperty]+i[this.sizeProperty](),s=Math.abs(parseFloat(i.parent().css("margin-"+this.positionProperty))),o=s+this.containerSize;return a>s&&a<o},calculatePageSize:function t(){return Math.floor(this.containerSize/this.calculateItemSize())},calculateItemSize:function t(){return this.element.find(this.options.itemSelector).eq(0)[this.sizeProperty]()},refresh:function t(){var e=this.currentPage||1;this.containerSize=this.element.parent()[this.sizeProperty]();this.pageSize="auto"===this.options.pageSize?this.calculatePageSize():this.options.pageSize;this.itemSize=this.calculateItemSize();this.maxPages=Math.ceil(this.element.find(this.options.itemSelector).length/this.pageSize||1);this.currentPage=Math.min(e,this.maxPages);this.goToPage(this.currentPage)},goToPage:function t(e){this.currentPage=Math.min(Math.max(1,e),this.maxPages);var n=(this.currentPage-1)*this.itemSize*this.pageSize,i={};i[this.positionProperty]=-n+"px";this.element.stop(true).animate(i,this.options.animationDuration)},goToPreviousPage:function t(){this.goToPage(this.currentPage-1)},goToNextPage:function t(){this.goToPage(this.currentPage+1)},goToPageContaining:function t(e){var n=Math.ceil(this.element.find(e).index()+1/this.pageSize);this.goToPage(n)},_destroy:function t(){this.element.off(this.eventNamespace)}});return t}.apply(e,i),void 0!==a&&(t.exports=a))},855:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(10),n(48),n(856),n(94),n(140),n(103),n(168),n(155),n(49),n(89),n(176)],a=function(t,e,n,i,a,s){n.service("qvExploreSelectionsService",["$document","qvSelectionToolbarService",function(n,o){var r,l;var c=300;function u(){return{$container:void 0,$containerId:".qv-explore-selections-container",getComponent:function t(){return i},setup:function t(){s.get().then(function(t){a.StateChanged.bind(d.bind(null,d));t.enigmaModel.isInModalSelection()&&o.confirm()})},destroy:function t(){a.StateChanged.unbind(d)}}}function d(){(a.isInEditMode()||!a.isInAnalysisMode||a.inObjectView())&&g()}function p(i){a.setState(a.States.analysis);l.$container=e.element("<div>");i=i||n;i.find(l.$containerId).append(l.$container);l.$container.showComponent(l.getComponent());l.setup();t(".qv-explore-selections").slideDown(c)}function h(){return!(!l||void 0===l.$container)}function g(){if(!l)return;t(".qv-explore-selections").slideUp(c,function(){if(l.$container){l.$container.remove();l.$container=void 0}l.destroy()})}r={toggleExploreSelection:function t(e){l||(l=new u);if(h()){g();return false}p(e);return true},off:function t(){g()}};return r}])}.apply(e,i),void 0!==a&&(t.exports=a))},856:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(857),n(858)],a=function(t,e){var n=["$scope",function(t){t.showFullModel=false;t.$on("$destroy",function(){})}];t.directive("qvExploreSelectionsComponent",function(){return{restrict:"E",template:e,controller:n,scope:true,replace:true,link:function t(e){e.target=null}}});return"<qv-explore-selections-component></qv-explore-selections-component>"}.apply(e,i),void 0!==a&&(t.exports=a))},857:function(t,e){t.exports='<div class="qv-explore-selections overlay" id="qv-explore-selections-overlay" style="display:none;">\n\t<qv-selection-insights full="showFullModel"></qv-selection-insights>\n</div>'},858:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(284),n(859),n(860),n(93),n(234),n(95),n(91),n(106),n(103),n(220),n(861),n(863),n(867)],a=function(t,e,n,i,a,s,o,r,l,c){var u={NO_SELECTIONS:0,GENERATE_INSIGHTS:1,INSIGHTS_FOUND:2,NO_INSIGHTS:3,UNSUPPORTED:4};var d={restrict:"E",bindings:{showFields:"<"},template:n,controller:["$scope","$timeout","qvSelectionInsightsService",function(n,d,p){var h=this;var g=null;this.showLoading=true;this.insights=[];this.activeCard=1e3;this.showInsightDetails=false;this.selectedInsight=null;this.hasSelection=false;this.measure="";this.newMeasureChosen=false;this.newSelection=false;this.isRefreshing=false;this.app=null;this.layout=null;this.selectionInsightsState=u.NO_SELECTIONS;this.states=u;this.measureError=false;this.loadingCards=false;this.cardIsInsight=true;this.selectionContribution="";this.isOneAndOnlyOneField=null;this.showing={table:false,excluded:false};this.$onInit=function(){f().then(function(t){if(t)a.getApp().then(function(t){h.app=t;t.enigmaModel.getCurrentSelectionObject().then(function(t){n.currentSelModel=t;l(n,"currentSelModel",function(){v()})});b(t);c.trackEvent(c.customEvents.EXPLORE_SELECTIONS_OPENED,{type:"clicked"})});else{m();h.showLoading=false}})};function f(){return p.getInsightDimensions(h.showFields).then(function(){return true}).catch(function(){return false})}this.generateInsights=function(){h.showLoading=true;h.newMeasureChosen=false;h.newSelection=false;S();c.trackEvent(c.customEvents.ASSOCIATIVE_INSIGHTS_GENERATED,{type:"clicked"})};function v(){if(h.selectionInsightsState!=u.UNSUPPORTED){h.hasSelection=n.currentSelModel.layout.qSelectionObject.qSelections.length>0;h.showLoading=false;h.isOneAndOnlyOneField=p.isOneAndOnlyOne(n.currentSelModel.layout);if(h.isOneAndOnlyOneField.isOneAndOnlyOne){h.selectionInsightsState=u.UNSUPPORTED;h.errorMsg=r.get("ExploreSelections.SingleSelectField",[h.isOneAndOnlyOneField.items])}else h.hasSelection||(h.selectionInsightsState=u.NO_SELECTIONS);h.hasSelection&&h.selectionInsightsState===u.NO_SELECTIONS&&(h.selectionInsightsState=u.GENERATE_INSIGHTS);h.layout=n.currentSelModel.layout;o.publish("selection/insights/current-selection",n.currentSelModel.layout)}}this.$onChanges=function(t){void 0===t.showFields||t.showFields.isFirstChange()||h.selectionInsightsState===u.NO_INSIGHTS&&(h.selectionInsightsState=u.GENERATE_INSIGHTS)};function m(){h.selectionInsightsState=u.UNSUPPORTED;h.errorMsg=r.get("ExploreSelections.NoSelectionInsights")}function b(t){return t.getCurrentSelectionObject().then(function(t){t.layoutSubscribe(function(){if(h.selectionInsightsState!=u.UNSUPPORTED){h.showInsightDetails=false;if(!h.newMeasureChosen){h.isRefreshing=true;o.publish("selection/insights/selection/changed")}if(h.selectionInsightsState!==u.NO_SELECTIONS&&h.selectionInsightsState!==u.NO_INSIGHTS){h.newSelection=true;h.newMeasureChosen=false}else h.selectionInsightsState===u.NO_INSIGHTS&&(h.selectionInsightsState=u.GENERATE_INSIGHTS)}c.trackEvent(c.customEvents.NEW_SELECTION_MADE,{type:"clicked"})})})}function S(){h.insights=[];return p.getInsightDimensions(h.showFields).then(function(t){o.publish("selection/insights/refreshed");h.showLoading=false;h.selectionInsightsState=u.INSIGHTS_FOUND;if(0!==t.insights.length){h.measure=t.insights[0].measure;h.loadingCards=true;y(t.insights)}else{o.publish("selection/insights/updated");t.measure?h.measure=t.measure:h.selectionInsightsState=u.NO_INSIGHTS}h.isRefreshing=false}).catch(function(){h.showLoading=false;m()})}function y(e){var n=t.getService("$q");function i(t){var a=e[t];if(!a)return n.resolve(true);return p.getInsightSummary(a.dimension,h.app).then(function(t){h.measureError="NaN"==t.summary;a.summaryNaN=h.measureError;a.summaryString=t.summary;if(t.show){h.insights.push(a);o.publish("selection/insight/draw",{insight:a,index:h.insights.length-1})}}).catch(function(){a.summaryError=true;h.insights.push(a)}).then(function(){t+=1;if(t<e.length)return i(t);h.loadingCards=false;o.publish("selection/insights/updated");return true})}return i(0)}this.openCardSummaryDialog=function(){g=t.getService("luiDialog").show({template:i,input:{title:"SelectionInsights.SummarySelection.HelpTitle",html:i,closeDialog:function t(){g.close();g=null}}})};this.backToSelections=function(){h.showInsightDetails=false;h.newMeasureChosen=false;o.publish("selections/insights/details/close")};this.closeInsights=function(){h.showInsightDetails=false;h.newMeasureChosen=false;p.clearInsights();o.publish("selection/insights/close")};this.openCard=function(t){o.publish("selections/insights/details/close");if(t>=0)h.newMeasureChosen||h.isRefreshing||h.insights[t].summaryNaN||!h.insights[t].show||d(function(){if(h.activeCard==t)h.closeCard();else{o.publish("selections/insights/details/open");h.activeCard=t;t=t>0?t:0;var n=p.getInsightDetails(h.insights[t].dimension,h.app);n.isMeasureNegative=n.includedMeasure.qNumber<0||n.excludedMeasure.qNumber<0;h.showInsightDetails=true;h.cardIsInsight=true;h.insights[t]=n;h.selectedInsight=h.insights[t];p.getTableVis(h.selectedInsight,h.showing.excluded).then(function(t){h.selectedInsight.table=t});n.isMeasureNegative?o.publish("selection/insights/details/negative",h.selectedInsight):o.publish("selection/insights/details/updated",{measure:h.selectedInsight.measure,aggr:h.selectedInsight.measureAggregation,dimension:h.selectedInsight.dimension,contribution:h.selectedInsight.selectedMeasure.selected.percentage.toFixed(1)});var i=e.openApp(h.app.qDocId);i.visualization.create("listbox",[h.selectedInsight.dimension],{showTitles:true,title:h.selectedInsight.dimension}).then(function(t){h.listbox=t.model.enigmaModel;I()})}});else if(!h.newMeasureChosen&&!h.isRefreshing)if(h.activeCard==t&&h.showInsightDetails)h.closeCard();else{h.activeCard=t;var n=p.getInsightDetails(h.insights[0].dimension,h.app);h.showInsightDetails=true;h.cardIsInsight=false;n.isSelectionNegative=n.selectedMeasure.selected.percentage<0||n.selectedMeasure.excluded.percentage<0;h.insights[0]=n;h.selectedInsight=h.insights[0];o.publish("selection/insights/current/open",{insight:h.selectedInsight});o.publish("selections/insights/details/open")}c.trackEvent(c.customEvents.ASSOCIATIVE_INSIGHTS_CARD_CLICKED,{type:"clicked"})};this.closeCard=function(){h.showInsightDetails=!h.showInsightDetails;h.cardIsInsight=true;h.activeCard=null};o.subscribe("selection/insights/details/close",function(){h.showInsightDetails=false});o.subscribe("selection/insights/new",function(t){h.isRefreshing=false;h.insights=[];h.activeCard=1e3;if(0===t.insights.length){h.measureError=false;o.publish("selection/insights/updated")}else{h.loadingCards=true;y(t.insights)}t.measure&&(h.measure=t.measure);h.showInsightDetails=false});o.subscribe("selection/insights/error",m);function I(){s.selectAll(".gwBar g").remove();var t=s.select(".gwBar svg");var e=t.append("g");var n=h.selectedInsight.counts.excluded/(h.selectedInsight.counts.excluded+h.selectedInsight.counts.included)*100/100*427;var i=h.selectedInsight.counts.included/(h.selectedInsight.counts.excluded+h.selectedInsight.counts.included)*100/100*427;e.append("rect").style("fill","#A9A9A9").attr("width",35).attr("height",Math.ceil(n)).attr("y",Math.ceil(i)).attr("x",0);e.append("rect").style("fill","white").attr("width",35).attr("height",Math.ceil(i)).attr("y",0).attr("x",0);var a=[];a.push([{x:35,y:Math.ceil(i)+Math.ceil(n)/2},{x:65,y:322}]);a.push([{x:65,y:322},{x:95,y:322}]);a.push([{x:35,y:Math.ceil(i)/2},{x:65,y:107}]);a.push([{x:65,y:107},{x:95,y:107}]);var o=s.svg.line().x(function(t){return t.x}).y(function(t){return t.y});var r=t.append("g").attr("class","lines");r.selectAll("path").data(a).enter().append("path").attr({d:o,"stroke-dasharray":"790 790","stroke-dashoffset":0}).style("stroke",function(t,e){return e>1?"white":"#A9A9A9"}).style("stroke-width","2").attr("opacity",1)}this.$onDestroy=function(){o.unsubscribe("selection/insights/show");o.unsubscribe("selection/insights/new");o.unsubscribe("selection/insights/error")}}]};t.nativeComponent("qvSelectionInsights",d)}.apply(e,i),void 0!==a&&(t.exports=a))},859:function(t,e){t.exports='<div class="qv-selections-insights-container">\n\t\x3c!-- Insights found --\x3e\n\t<div class="qv-selections-insights-header">\n\t\t<h2\n\t\t\tq-translation="SelectionInsights.AssociativeInsights"\n\t\t\tclass="qv-selections-insights-title"\n\t\t></h2>\n\t\t<span\n\t\t\tclass="lui-icon lui-icon--help lui-icon--small"\n\t\t\tng-click="$ctrl.openCardSummaryDialog()"\n\t\t></span>\n\t\t<div class="qv-insight-summary-close">\n\t\t\t<span\n\t\t\t\tclass="lui-icon lui-icon--close"\n\t\t\t\tng-click="$ctrl.closeInsights()"\n\t\t\t></span>\n\t\t</div>\n\t\t<qv-selection-insights-summary\n\t\t\tng-if="!$ctrl.showLoading && $ctrl.selectionInsightsState === $ctrl.states.INSIGHTS_FOUND"\n\t\t\tstates="$ctrl.states"\n\t\t\tselection-insights-state="$ctrl.selectionInsightsState"\n\t\t\tnew-measure-chosen="$ctrl.newMeasureChosen"\n\t\t\tnew-selection="$ctrl.newSelection"\n\t\t\tmeasure="$ctrl.measure"\n\t\t\tshow-loading="$ctrl.showLoading"\n\t\t\thas-selection="$ctrl.hasSelection"\n\t\t\tshow-fields="$ctrl.showFields"\n\t\t\tmeasure-error="$ctrl.measureError"\n\t\t\tselected-insight="$ctrl.selectedInsight"\n\t\t></qv-selection-insights-summary>\n\t</div>\n\t<qv-selection-insights-card-container\n\t\tng-show="!$ctrl.showLoading && $ctrl.selectionInsightsState === $ctrl.states.INSIGHTS_FOUND"\n\t\tnew-measure-chosen="$ctrl.newMeasureChosen"\n\t\tnew-selection="$ctrl.newSelection"\n\t\tmeasure="$ctrl.measure"\n\t\tshow-loading="$ctrl.showLoading"\n\t\tinsights="$ctrl.insights"\n\t\topen-card="$ctrl.openCard"\n\t\tactive-card="$ctrl.activeCard"\n\t\tclass="qv-selection-insights-card-container"\n\t\tshow-fields="$ctrl.showFields"\n\t\tloading-cards="$ctrl.loadingCards"\n\t\tcard-is-insight="$ctrl.cardIsInsight"\n\t></qv-selection-insights-card-container>\n\t\x3c!-- LOADING --\x3e\n\t<div class="qv-selections-insights-loading" ng-if="$ctrl.showLoading">\n\t\t<div class="spinner-container">\n\t\t\t<qv-spinner\n\t\t\t\tshow="$ctrl.showLoading"\n\t\t\t\tcenter-in-parent="true"\n\t\t\t></qv-spinner>\n\t\t</div>\n\t\t<div\n\t\t\tclass="loading-message"\n\t\t\tq-translation="SelectionInsights.Loading"\n\t\t></div>\n\t</div>\n\n\t\x3c!-- No selection has been made --\x3e\n\t<div\n\t\tclass="qv-selections-no-insights"\n\t\tng-if="!$ctrl.showLoading && $ctrl.selectionInsightsState === $ctrl.states.NO_SELECTIONS"\n\t>\n\t\t<div class="no-insights-icon"></div>\n\t\t<p\n\t\t\tclass="qv-selections-insights--p"\n\t\t\tq-translation="ExploreSelections.NoInsights"\n\t\t></p>\n\t</div>\n\n\t\x3c!-- AI is not supported for this app --\x3e\n\t<div\n\t\tclass="qv-selections-no-insights"\n\t\tng-if="!$ctrl.showLoading && $ctrl.selectionInsightsState === $ctrl.states.UNSUPPORTED"\n\t>\n\t\t<div class="no-insights-icon"></div>\n\t\t<p class="qv-selections-insights--p" ng-bind-html="$ctrl.errorMsg"></p>\n\t</div>\n\n\t\x3c!--\n\t\tUser opened the selection insights panel for the first time after making selections\n\t--\x3e\n\t<div\n\t\tclass="qv-selections-generate-insights qv-selections-no-insights"\n\t\tng-if="!$ctrl.showLoading && $ctrl.selectionInsightsState === $ctrl.states.GENERATE_INSIGHTS"\n\t>\n\t\t<div class="no-insights-icon"></div>\n\t\t<p\n\t\t\tq-translation="ExploreSelections.GenerateInsights"\n\t\t\tclass="qv-selections-insights--p"\n\t\t></p>\n\t\t<button\n\t\t\ttid="explore-selections-generate-insight-button"\n\t\t\tclass="lui-button lui-button--success"\n\t\t\tq-translation="ExploreSelections.GenerateInsights.Button"\n\t\t\tng-click="$ctrl.generateInsights()"\n\t\t></button>\n\t</div>\n\n\t\x3c!-- User has made a selection but no insights were found --\x3e\n\t<div\n\t\tclass="qv-selections-no-insights"\n\t\tng-if="!$ctrl.showLoading && $ctrl.selectionInsightsState === $ctrl.states.NO_INSIGHTS"\n\t>\n\t\t<div class="no-insights-icon"></div>\n\t\t<p\n\t\t\tclass="qv-selections-insights--p"\n\t\t\tq-translation="ExploreSelections.NoInsightsWithSelection.Paragraph1"\n\t\t></p>\n\t\t\x3c!--\n\t\t\tIf show fields checkbox is unchecked, we tell them to check it since they got no master item insights\n\t\t--\x3e\n\t\t<div\n\t\t\tng-if="!$ctrl.showFields"\n\t\t\tclass="select-fields"\n\t\t\tq-translation="ExploreSelections.NoInsightsWithSelection.Paragraph3"\n\t\t></div>\n\t</div>\n\n\t\x3c!-- Insights details --\x3e\n\t<qv-selection-insights-details\n\t\tng-show="$ctrl.selectionInsightsState === $ctrl.states.INSIGHTS_FOUND"\n\t\tshow-insight-details="$ctrl.showInsightDetails"\n\t\tselected-insight="$ctrl.selectedInsight"\n\t\tlistbox="$ctrl.listbox"\n\t\tcard-is-insight="$ctrl.cardIsInsight"\n\t\tback-to-selections="$ctrl.backToSelections()"\n\t\tlayout="$ctrl.layout"\n\t\tshowing="$ctrl.showing"\n\t></qv-selection-insights-details>\n</div>\n'},860:function(t,e){t.exports='<lui-dialog class="selection-insights-dialog" x-variant="{{::variant}}">\n\t<lui-dialog-header>\n\t\t<lui-dialog-title\n\t\t\tq-translation="SelectionInsights.SummarySelection.HelpTitle"\n\t\t></lui-dialog-title>\n\t</lui-dialog-header>\n\t<lui-dialog-body class="q-modal-loading">\n\t\t<p q-translation="SelectionInsights.SummarySelection.HelpText"></p>\n\t</lui-dialog-body>\n\t<lui-dialog-footer>\n\t\t<button\n\t\t\tclass="lui-button close-button"\n\t\t\tng-click="closeDialog();"\n\t\t\tq-translation="Common.Close"\n\t\t\ttid="selection-insights-dialog-help-button"\n\t\t></button>\n\t</lui-dialog-footer>\n</lui-dialog>\n'},861:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(862),n(234),n(95),n(220)],a=function(t,e,n,i){t.nativeComponent("qvSelectionInsightsCardContainer",{bindings:{showLoading:"<",insights:"=",openCard:"<",activeCard:"<",newMeasureChosen:"=",newSelection:"=",showFields:"<",loadingCards:"<",measure:"<",selectedInsight:"=",cardIsInsight:"<"},controller:["$timeout","qvSelectionInsightsService",function(t,e){var a=this;this.showLoading=true;this.insights=[];this.refreshActive=false;this.isRefreshing=false;this.hasInsights=true;this.itemString="";this.selectionContribution="";this.$onInit=function(){n.selectAll(".insight-bar-container svg").remove()};function s(){if(a.insights.length>0){var t=e.getInsightDetails(a.insights[0].dimension,a.app).selectedMeasure.selected.percentage/100;a.selectionContribution=a.getLocalizedPercentage(t)}}i.subscribe("selection/insights/updated",function(){t(function(){a.hasInsights=a.insights.length>0;s()})});i.subscribe("selection/insight/draw",function(e){t(function(){n.select("#insightCard"+e.index+" .insight-bar-container svg").remove();r(e.insight,e.index)})});i.subscribe("selection/insights/refresh",function(){a.isRefreshing=true});i.subscribe("selection/insights/refreshed",function(){a.isRefreshing=false;a.refreshActive=false});i.subscribe("selection/insights/new",function(){a.isRefreshing=false;a.refreshActive=false});i.subscribe("selection/insights/measure/cancel",function(){a.refreshActive=false});i.subscribe("selection/insights/fields/change",function(){a.refreshActive=true});i.subscribe("selection/insights/selection/changed",function(){a.refreshActive=true});i.subscribe("selection/insights/current-selection",function(t){o(e.getSelectionItems(t))});function o(t){if(t){a.itemString="";t.forEach(function(e,n){t.length-1===n?a.itemString+=e.name:a.itemString+=e.name+", "})}}this.getLocalizedPercentage=function(t){return e.getLocalizedPercentage(t)};this.getMeasurePercentage=function(t){var e=t.counts.excluded+t.counts.included;var n=t.counts.excluded<t.counts.included?t.counts.excluded:t.counts.included;var i=n/e*100;var s=Math.round(10*i)/100;s=a.getLocalizedPercentage(s/10);return s};function r(t,e){var i=n.select("#insightCard"+e+" .insight-bar-container").append("svg").attr("width",44).attr("height",125);var a=i.append("g");var s=t.counts.excluded/(t.counts.excluded+t.counts.included)*100/100*124;var o=t.counts.included/(t.counts.excluded+t.counts.included)*100/100*124;a.append("rect").style("fill","#A9A9A9").attr("width",12).attr("height",Math.ceil(s)).attr("y",Math.ceil(o)).attr("x",0);a.append("rect").style("fill","white").style("stroke-width",1).style("stroke","#E6E6E6").attr("width",12).attr("height",Math.ceil(o)).attr("y",0).attr("x",0);var r=[];var l=Math.ceil(o)+Math.ceil(s)/2;r.push([{x:12,y:l},{x:28,y:38}]);var c=n.svg.line().x(function(t){return t.x}).y(function(t){return t.y});var u=i.append("g").attr("class","lines");u.selectAll("path").data(r).enter().append("path").attr({d:c,"stroke-dasharray":"790 790","stroke-dashoffset":0}).style("stroke",function(t,e){return e>1?"white":"#A9A9A9"}).style("stroke-width","1").attr("opacity",1)}this.$onDestroy=function(){i.unsubscribe("selection/insights/updated");i.unsubscribe("selection/insights/fields/change");i.unsubscribe("selection/insights/measure/cancel");i.unsubscribe("selection/insights/selection/changed");i.unsubscribe("selection/insights/refresh");i.unsubscribe("selection/insights/new");i.unsubscribe("selection/insights/refreshed");i.unsubscribe("selection/insight/draw");i.unsubscribe("selection/insights/current-selection")}}],template:e})}.apply(e,i),void 0!==a&&(t.exports=a))},862:function(t,e){t.exports='<div tid="selection-insights-card-container" class="qv-selections-insights-cards-container" ng-show="!$ctrl.isRefreshing && $ctrl.hasInsights">\n\t<div ng-show="!$ctrl.showLoading" class="qv-selections-empty-cards">\n\t\t<div tid="current-selections-card" class="card selection-insights-card selection-insights-card--current-selection" ng-class="{\'active\': $ctrl.activeCard === -1 && !$ctrl.cardIsInsight}" ng-click="$ctrl.openCard(-1)" tabindex="0"> \n\t\t\t<div tid="no-longer-valid-overlay" class="no-longer-valid-overlay" ng-if="$ctrl.refreshActive">\n\t\t\t\t<div class="gray-overlay"></div>\n\t\t\t\t<span class="no-longer-valid-text" q-translation="SelectionInsights.Refresh.NoLongerValid"></span>\n\t\t\t</div>\n\t\t\t<div class="insight-card-content selection-insights-card--current-selection-content">\n\t\t\t\t<div class="insight-card-body">\n\t\t\t\t\t<div class="insight-dimension-title">\n\t\t\t\t\t\t<div class="insight-dimension-name" title="{{$ctrl.itemString}}">{{$ctrl.itemString}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="insight-card-body-your-selections" q-translation="SelectionInsights.CardSummaryYourSelections" q-title-translation="SelectionInsights.CardSummaryYourSelections"></div>\n\t\t\t\t\t<div class="insight-card-body-account" q-translation="SelectionInsights.CardSummaryAccountFor"></div>\n\t\t\t\t\t<div class="insight-measure-title">\n\t\t\t\t\t\t<div class="insight-current-selection-value" ng-show="$ctrl.selectionContribution">\n\t\t\t\t\t\t\t{{ $ctrl.selectionContribution }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="insight-measure-name" title="">\n\t\t\t\t\t\t\t{{ $ctrl.measure }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="selection-insights--other-fields" q-translation="SelectionInsights.FoundOtherFields"></div>\n\t\t<div tid="selection-insights-card" ng-repeat="insight in $ctrl.insights track by $index" id="insightCard{{ $index }}" class="card selection-insights-card insight-card" ng-class="{\'active\': $ctrl.activeCard === $index && $ctrl.cardIsInsight, \'disabled\': $ctrl.refreshActive || !insight.show, \'inactive\': insight.summaryNaN }"\n\t\t ng-click="$ctrl.openCard($index)" tabindex="0">\n\t\t\t<div tid="no-longer-valid-overlay" class="no-longer-valid-overlay" ng-if="$ctrl.refreshActive">\n\t\t\t\t<div class="gray-overlay"></div>\n\t\t\t\t<span class="no-longer-valid-text" q-translation="SelectionInsights.Refresh.NoLongerValid"></span>\n\t\t\t</div>\n\t\t\t<div class="insight-bar-container"></div>\n\t\t\t<div class="insight-card-content">\n\t\t\t\t<div class="insight-card-body">\n\t\t\t\t\t<div class="insight-dimension-title">\n\t\t\t\t\t\t<div class="insight-dimension-name" title="{{ insight.dimension }}">\n\t\t\t\t\t\t\t{{ insight.dimension }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div tid="insight-counts-summary" class="insight-card-body-your-selections" title="{{insight.counts.summary}}">{{insight.counts.summary}}</div>\n\t\t\t\t\t<div class="insight-card-body-account" q-translation="SelectionInsights.CardSummaryAccountFor"></div>\n\t\t\t\t\t<div class="insight-measure-title" ng-if="!insight.summaryError && !insight.summaryNaN && insight.show">\n\t\t\t\t\t\t<div class="insight-measure-value">\n\t\t\t\t\t\t\t{{ insight.summaryString }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="insight-measure-name" title="{{ insight.measure }}">\n\t\t\t\t\t\t\t{{ insight.measure }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="insight-measure-title" ng-if="insight.summaryError">\n\t\t\t\t\t\t<span class="timeout-error" q-translation="SelectionInsights.ErrorTimeout"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="insight-measure-title" ng-if="!insight.show && !insight.summaryNaN && !insight.summaryError">\n\t\t\t\t\t\t<span tid="selection-insight-error-calculation" class="timeout-error" q-translation="SelectionInsights.ErrorCalculations"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="insight-measure-title" ng-if="insight.summaryNaN">\n\t\t\t\t\t\t<span class="invalid-error" q-translation="SelectionInsights.InvalidMeasure"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div ng-if="$ctrl.showLoading" class="qv-selections-empty-cards">\n\t\t\t\t<div class="empty card"></div>\n\t\t\t\t<div class="empty card"></div>\n\t\t\t\t<div class="empty card"></div>\n\t\t\t\t<div class="empty card"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div id="cardLoading" class="card loading-card selection-insights-card inactive" ng-if="$ctrl.loadingCards">\n\t\t\t<div class="insight-bar-container">\n\t\t\t\t<div class="loading-line bar"></div>\n\t\t\t</div>\n\t\t\t<div class="insight-card-content">\n\t\t\t\t<div class="insight-card-body">\n\t\t\t\t\t<div class="loading-line title"></div>\n\t\t\t\t\t<div class="loading-line count"></div>\n\t\t\t\t\t<div class="loading-line contribution"></div>\n\t\t\t\t\t<div class="measure-container">\n\t\t\t\t\t\t<div class="loading-line percent"></div>\n\t\t\t\t\t\t<div class="loading-line measure"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n\n\x3c!-- LOADING --\x3e\n<div class="qv-selections-insights-loading" ng-if="$ctrl.isRefreshing">\n\t<div class="spinner-container">\n\t\t<qv-spinner show="$ctrl.isRefreshing" center-in-parent="true"></qv-spinner>\n\t</div>\n\t<div class="loading-message" q-translation="SelectionInsights.Loading"></div>\n</div>\n\n\x3c!-- NO INSIGHTS FOUND --\x3e\n<div class="qv-selections-no-insights" ng-show="!$ctrl.isRefreshing && !$ctrl.hasInsights">\n\t<div class="no-insights-icon"></div>\n\t<p class="qv-selections-insights--p" q-translation="ExploreSelections.NoInsightsWithSelection.Paragraph1"></p>\n\t<div ng-if="!$ctrl.showFields" class="select-fields" q-translation="ExploreSelections.NoInsightsWithSelection.Paragraph3"></div>\n</div>'},863:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(864),n(284),n(95),n(91),n(234),n(103),n(93),n(865),n(220)],a=function(t,e,n,i,a,s,o,r){t.nativeComponent("qvSelectionInsightsDetails",{bindings:{showInsightDetails:"<",selectedInsight:"<",listbox:"<",layout:"<",cardIsInsight:"<",backToSelections:"&",showing:"="},controller:["$timeout","qvSelectionInsightsService",function(t,e){var l=this;this.detailsTitle="";this.measure="";this.selectionHelp="";this.refreshActive=false;this.selectionInsightsMeasureBarTitle="";this.hasLockedSelections=false;this.selectionsBarTotal="";this.options={isReadonly:true,isPopover:false,selections:false,showSearch:true};this.showExcludedValues=false;this.celloptions={selections:false};l.selectionInsightsMeasureBarTitle=function(){if(l.selectedInsight&&l.selectedInsight.measureAggregation)return a.get("SelectionInsights.MeasureBarTitle",[l.selectedInsight.measureAggregation[0].toUpperCase()+l.selectedInsight.measureAggregation.slice(1),l.selectedInsight.measure])};l.selectionsBarTotal=function(){if(l.selectedInsight&&l.selectedInsight.selectedMeasure.total)return a.get("SelectionInsights.SelectionsBarTotal",[l.selectedInsight.selectedMeasure.total])};l.countBarTotal=function(){if(l.selectedInsight&&l.selectedInsight.counts.excluded&&l.selectedInsight.counts.included)return a.get("SelectionInsights.CountBarTotal",[l.selectedInsight.counts.excluded+l.selectedInsight.counts.included])};i.subscribe("selection/insights/details/negative",function(t){l.showExcludedValues=false;l.measure=t.measure;l.detailsTitle=a.get("SelectionInsights.DimensionContributionsTitle",["<strong>"+t.dimension+"</strong>","<strong>"+t.measure+"</strong>"]);l.selectionHelp=a.get("SelectionInsights.SelectionHelp","<strong>"+t.dimension+"</strong>");c(t)});i.subscribe("selection/insights/details/updated",function(t){l.showExcludedValues=false;l.measure=t.measure;l.hasLockedSelections=e.isHasLockedSelections(l.layout);l.detailsTitle=a.get("SelectionInsights.DimensionContributionsTitle",["<strong>"+t.dimension+"</strong>","<strong>"+t.measure+"</strong>"]);l.selectionHelp=a.get(l.hasLockedSelections?"SelectionInsights.SelectionHelpWithLockedSelections":"SelectionInsights.SelectionHelp","<strong>"+t.dimension+"</strong>");d()});i.subscribe("selection/insights/measure/cancel",function(){l.refreshActive=false});i.subscribe("selection/insights/fields/change",function(){l.refreshActive=true});i.subscribe("selection/insights/updated",function(){l.refreshActive=false});function c(t){s.selectAll(".bars-container svg").remove();var e=[{name:"excluded",value:t.counts.excluded,label:t.counts.excluded},{name:"included",value:t.counts.included,label:t.counts.included}];u(e,"value");var n=[{name:"excluded",value:t.excludedMeasure.qNumber,label:t.measureBreakdown.excluded.num},{name:"included",value:t.includedMeasure.qNumber,label:t.measureBreakdown.included.num}];u(n,"measure")}function u(t,e){var n=431;var i=120;var a=10;var o="";var r=45;var l=30;o="value"==e?" .val-dist":" .measure-dist";var c=s.select(".negative-chart"+o).append("svg").attr("width",i+r).attr("height",n+r);var u=c.append("g").attr("transform","translate("+a/2+",1)");var d=s.scale.ordinal().rangeRoundBands([0,i]);var p=s.scale.linear().range([n,0]);d.domain(t.map(function(t){return t.name}));"value"==e?p.domain([0,s.max(t,function(t){return t.value})]):p.domain(s.extent(t,function(t){return t.value}));var h=u.append("defs");h.append("filter").attr("id","blur").append("feGaussianBlur").attr("stdDeviation",5);if("value"==e){u.selectAll("bar").data(t).enter().append("rect").style("fill","rgba(0,0,0,0.1)").attr("x",function(t){return d(t.name)}).attr("width",d.rangeBand()).attr("y",function(t){return p(t.value)}).attr("height",function(t){return n-p(t.value)}).attr("filter","url(#blur)").attr("rx",3).attr("ry",3);u.selectAll("bar").data(t).enter().append("rect").style("fill",function(t){return"value"==e?"excluded"==t.name?"#A7A7A7":"#FFFFFF":"excluded"==t.name?"blue":"#FFFFFF"}).style("stroke",function(t){return"excluded"==t.name?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.27)"}).attr("x",function(t){return d(t.name)}).attr("width",d.rangeBand()).attr("y",function(t){return t.value>0?p(t.value):p(0)}).attr("height",function(t){return"value"==e?n-p(t.value):Math.abs(p(t.value)-p(0))}).attr("rx",3).attr("ry",3);u.selectAll("bar").data(t).enter().append("rect").style("fill",function(t){return"excluded"==t.name?"#A7A7A7":"#FFFFFF"}).attr("x",function(t){return d(t.name)}).attr("width",d.rangeBand()).attr("y",n-3).attr("height",3);var g=c.append("g").attr("class","barLabels").attr("transform","translate("+a/2+",0)");t.forEach(function(t,e){u.append("line").style("stroke","excluded"==t.name?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.27)").attr("x1",d(t.name)).attr("y1",n).attr("x2",d(t.name)).attr("y2",n-3);e>0&&u.append("line").style("stroke","excluded"==t.name?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.27)").attr("x1",d(t.name)+60).attr("y1",n).attr("x2",d(t.name)+60).attr("y2",n-3);var i=g.append("g");i.append("rect").attr("x",function(){return d(t.name)}).attr("width",d.rangeBand()).attr("height",2).attr("y",function(){return p(t.value)}).attr("opacity",0);i.append("text").attr("x",d(t.name)+l).attr("y",function(){return n-p(t.value)>n-l?p(t.value)+30:p(t.value)-10}).attr("text-anchor","middle").attr("class","grouped-bar-value-label").text(t.label).attr("fill",function(){var e="#404040";"excluded"==t.name&&n-p(t.value)>n-l&&(e="white");return e})})}else{h.append("pattern").attr("id","diagonalStripes").attr("patternUnits","userSpaceOnUse").attr("width",8).attr("height",8).attr("patternTransform","rotate(45)").append("rect").attr("width","2").attr("height","8").attr("fill","#4842b5");u.selectAll("bar").data(t).enter().append("rect").style("fill","rgba(0,0,0,0.1)").attr("x",function(t){return d(t.name)}).attr("width",d.rangeBand()).attr("y",function(t){return t.value>0?p(t.value):p(0)}).attr("height",function(t){return Math.abs(p(t.value)-p(0))}).attr("filter","url(#blur)").attr("rx",3).attr("ry",3);u.selectAll("bar").data(t).enter().append("rect").style("fill",function(t){return"excluded"==t.name?"#655DC6":"#FFFFFF"}).style("stroke",function(t){return"excluded"==t.name?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.27)"}).attr("x",function(t){return d(t.name)}).attr("width",d.rangeBand()).attr("y",function(t){return t.value>0?p(t.value):p(0)+1}).attr("height",function(t){return Math.abs(p(t.value)-p(0))}).attr("rx",3).attr("ry",3);u.selectAll("bar").data(t).enter().append("rect").style("fill",function(t){return"excluded"==t.name?"#655DC6":"#FFFFFF"}).attr("x",function(t){return d(t.name)}).attr("width",d.rangeBand()).attr("y",function(t){return t.value>0?p(t.value)-3:p(0)+1}).attr("height",2);var f=c.append("g").attr("class","barLabels").attr("transform","translate("+a/2+",0)");t.forEach(function(t,e){u.append("line").style("stroke","excluded"==t.name?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.27)").attr("x1",d(t.name)).attr("y1",function(){return t.value>0?p(t.value):p(0)}).attr("x2",d(t.name)).attr("y2",function(){return t.value>0?p(t.value)-3:p(0)+3});e>0&&u.append("line").style("stroke","excluded"==t.name?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.27)").attr("x1",d(t.name)+60).attr("y1",function(){return t.value>0?p(t.value):p(0)}).attr("x2",d(t.name)+60).attr("y2",function(){return t.value>0?p(t.value)-3:p(0)+3});"excluded"==t.name&&u.append("rect").attr("x",function(){return d(t.name)}).attr("width",d.rangeBand()).attr("y",function(){return t.value>0?p(t.value):p(0)}).attr("height",function(){return Math.abs(p(t.value)-p(0))}).attr("stroke","#504A9E").attr("rx",3).attr("ry",3).attr("fill","url(#diagonalStripes)");var n=f.append("g");n.append("rect").attr("x",function(){return d(t.name)}).attr("width",d.rangeBand()).attr("height",2).attr("y",function(){return t.value>0?p(t.value):p(0)}).attr("opacity",0);n.append("text").attr("x",d(t.name)+l).attr("y",function(){return t.value>0?p(t.value)+20:Math.abs(p(t.value)-p(0))<l?Math.abs(p(t.value)-p(0))+p(0)+20:Math.abs(p(t.value)-p(0))+p(0)-10}).attr("text-anchor","middle").attr("class","grouped-bar-label").text(t.label).attr("fill",function(){var e="#404040";"excluded"==t.name&&(e=Math.abs(p(t.value)-p(0))<l?"#655DC6":"#FFFFFF");return e})})}c.append("g").attr("class","x axis").append("line").attr("y1",p(0)).attr("y2",p(0)).attr("x2",i+a).attr("stroke","#404040").attr("stroke-width","3");var v=c.append("text").attr("x",i+2*a).attr("y",p(0)-28).attr("text-anchor","left").style("font-size","22px").attr("fill","#B3B3B3");v.append("tspan").attr("dx",0).attr("dy",4).text("+");v.append("tspan").attr("dx",-13).attr("dy",30).attr("fill","#404040").text("0");v.append("tspan").attr("dx",-10).attr("dy",30).text("-")}function d(){t(function(){var t=431;var e=213;s.selectAll(".connectors svg").remove();var n=s.select(".connectors .svg-container").append("svg").attr("width",e).attr("height",t);n.append("linearGradient").attr("id","area-gradient").attr("x1",0).attr("y1",0).attr("x2",5).attr("y2",0).selectAll("stop").data([{offset:"0%",color:"#A7A7A7"},{offset:"20%",color:"white"}]).enter().append("stop").attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color});var i=l.getPercentage("excluded")/100*t;var a=l.selectedInsight.measureBreakdown.excluded.percentage/100*t;var o=[{x:0,y:t-i},{x:e,y:t-a}];var r=[{x:0,y:i},{x:e,y:a}];var c=s.scale.linear().domain([0,s.max(r,function(t){return t.x})]).range([0,e]);var u=s.scale.linear().domain([0,t]).range([t,0]);var d=s.svg.area().x(function(t){return c(t.x)}).y0(t).y1(function(t){return u(t.y)});var p=s.svg.line().x(function(t){return t.x}).y(function(t){return t.y});var h=[];h.push(o);var g=n.append("g").attr("class","lines");g.selectAll("path").data(h).enter().append("path").attr({d:p,"stroke-dasharray":"3, 3","stroke-dashoffset":0}).style("stroke","#BEBEBE").style("stroke-width","1").attr("opacity",1);n.append("path").datum(r).attr("class","area").attr("d",d)})}this.getLocalizedPercentage=function(t){return e.getLocalizedPercentage(t)};this.getPercentageLocalized=function(t){if(l.selectedInsight){var e=l.selectedInsight.counts.excluded+l.selectedInsight.counts.included;return l.getLocalizedPercentage(l.selectedInsight.counts[t]/e)}return 0};this.getPercentage=function(t){if(l.selectedInsight){var e=l.selectedInsight.counts.excluded+l.selectedInsight.counts.included;return l.selectedInsight.counts[t]/e*100}return 0};this.showTable=function(t){l.showing={table:t,excluded:true};e.getTableVis(l.selectedInsight,true).then(function(t){l.selectedInsight.table=t})};this.toggleShowTableExcluded=function(t){l.showing={table:true,excluded:t};e.getTableVis(l.selectedInsight,t).then(function(t){l.selectedInsight.table=t})};this.selectExcluded=function(){var t=l.selectedInsight.dimension;var e=this.selectedInsight.dimensionId;l.showing={table:false,excluded:false};var a=l.layout.qSelectionObject.qSelections;if(void 0!==e)return r.getApp().then(function(t){t.getDimension(e).then(function(e){e.getDimension().then(function(e){var i=e.qFieldDefs[0].replace("=","");t.getField(i).then(function(t){return t.selectExcluded().then(function(){a.length>0&&a.forEach(function(t){n.currApp().field(t.qField).clear()})})})})})});n.currApp().field(t).selectExcluded().then(function(){a.length>0&&a.forEach(function(t){n.currApp().field(t.qField).clear()})});i.publish("selection/insights/close");o.trackEvent(o.customEvents.SELECT_POSSIBLE_CLICKED,{type:"clicked"})};this.selectPossible=function(){var t=l.selectedInsight.dimension;var e=this.selectedInsight.dimensionId;l.showing={table:false,excluded:false};var a=l.layout.qSelectionObject.qSelections;if(void 0!==e)return r.getApp().then(function(t){t.getDimension(e).then(function(e){e.getDimension().then(function(e){var i=e.qFieldDefs[0].replace("=","");t.getField(i).then(function(t){return t.selectPossible().then(function(){a.length>0&&a.forEach(function(t){n.currApp().field(t.qField).clear()})})})})})});n.currApp().field(t).selectPossible().then(function(){a.length>0&&a.forEach(function(t){n.currApp().field(t.qField).clear()})});i.publish("selection/insights/close");o.trackEvent(o.customEvents.SELECT_POSSIBLE_CLICKED,{type:"clicked"})};this.isLabelContained=function(t){var e=427;var n=55;var i=t/100*e;return n<i};this.isLabelSmall=function(t){var e=427;var n=65;var i=t/100*e;return n<i};this.getNegativeMeasureText=function(){return a.get("SelectionInsights.MeasureNegative",[l.selectedInsight.measureAggregation[0].toUpperCase()+l.selectedInsight.measureAggregation.slice(1),l.selectedInsight.measure,l.selectedInsight.dimension])};this.getNegativeMeasurePossible=function(){return a.get("SelectionInsights.MeasureNegativePossible",[l.selectedInsight.measureAggregation[0].toUpperCase()+l.selectedInsight.measureAggregation.slice(1),l.selectedInsight.measure,l.selectedInsight.dimension,"<span>"+l.selectedInsight.measureBreakdown.included.num+"</span>"])};this.getNegativeMeasureExcluded=function(){return a.get("SelectionInsights.MeasureNegativeExcluded",[l.selectedInsight.measureAggregation[0].toUpperCase()+l.selectedInsight.measureAggregation.slice(1),l.selectedInsight.measure,l.selectedInsight.dimension,"<span>"+l.selectedInsight.measureBreakdown.excluded.num+"</span>"])};this.$onDestroy=function(){i.unsubscribe("selection/insights/details/updated");i.unsubscribe("selection/insights/measure/cancel");i.unsubscribe("selection/insights/updated");i.unsubscribe("selection/insights/fields/change");i.unsubscribe("selection/insights/details/negative")}}],template:e})}.apply(e,i),void 0!==a&&(t.exports=a))},864:function(t,e){t.exports='<div class="qv-selections-insights-details" ng-show="$ctrl.showInsightDetails">\n\t<div class="main-details-wrapper" ng-class="{\'disabled\': $ctrl.refreshActive}">\n\t\t<div ng-if="$ctrl.refreshActive" class="gray-overlay"></div>\n\t\t<div class="current-selections-container" ng-show="!$ctrl.cardIsInsight">\n\t\t\t<div class="current-selections-container-inner">\n\t\t\t\t<qv-selection-insights-current selected-insight="$ctrl.selectedInsight" back-to-selections="$ctrl.backToSelections()"></qv-selection-insights-current>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="details-container" ng-show="$ctrl.cardIsInsight">\n\t\t\t<div class="details-container-inner">\n\t\t\t\t<div class="closeBtn">\n\t\t\t\t\t<button tid="back-to-selection-button" class="lui-button" ng-click="$ctrl.backToSelections()" q-translation="SelectionInsights.BackToSelections">\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div class="details-body">\n\t\t\t\t\t<div class="title details-title">\n\t\t\t\t\t\t<span tid="insight-details-title" ng-bind-html="$ctrl.detailsTitle"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div tid="insight-details-summary" class="detail-summary" ng-bind-html="$ctrl.selectedInsight.summaryStringLong"></div>\n\t\t\t\t\t<div class="qv-titles-and-bars">\n\t\t\t\t\t\t<div class="bars-titles">\n\t\t\t\t\t\t\t<div class="title-container longer" q-title-translation="{{ $ctrl.selectedInsight.dimension }}">\n\t\t\t\t\t\t\t\t<div tid="insights-with-selection-title" class="title-longer">\n\t\t\t\t\t\t\t\t\t{{ $ctrl.selectedInsight.dimension }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div tid="insight-with-selections-bar-total" class="bar-total" q-translation="SelectionInsights.CountBarTotal, {{$ctrl.selectedInsight.counts.excluded + $ctrl.selectedInsight.counts.included}}" title="{{$ctrl.countBarTotal()}}"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="title-container">\n\t\t\t\t\t\t\t\t<div tid="insights-without-selection-title" class="title-longer" q-translation="SelectionInsights.MeasureBarTitle, {{$ctrl.selectedInsight.measureAggregation[0].toUpperCase() + $ctrl.selectedInsight.measureAggregation.slice(1)}}, {{$ctrl.selectedInsight.measure}}"\n\t\t\t\t\t\t\t\t\ttitle="{{$ctrl.selectionInsightsMeasureBarTitle()}}"></div>\n\t\t\t\t\t\t\t\t<div tid="insight-without-selections-bar-total" class="bar-total" q-translation="SelectionInsights.SelectionsBarTotal, {{$ctrl.selectedInsight.selectedMeasure.total}}" title="{{$ctrl.selectionsBarTotal()}}"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="bars-container negative-chart" ng-show="$ctrl.selectedInsight.isMeasureNegative && !$ctrl.showing.table">\n\t\t\t\t\t\t\t<div class="val-dist">\n\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="legend-dist">\n\t\t\t\t\t\t\t\t<div class="possible-legend">\n\t\t\t\t\t\t\t\t\t<div class="square">\n\t\t\t\t\t\t\t\t\t\t<div class="white-square"></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="legend-label" tid="possible-chart-legend" q-translation="SelectionInsights.Possible" q-title-translation="{{SelectionInsights.Possible}}"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="excluded-legend">\n\t\t\t\t\t\t\t\t\t<div class="square">\n\t\t\t\t\t\t\t\t\t\t<div class="gray-square"></div>\n\t\t\t\t\t\t\t\t\t\t<div class="purple-square"></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="legend-label" tid="excluded-chart-legend" q-translation="SelectionInsights.Excluded" q-title-translation="{{SelectionInsights.Excluded}}"></div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="measure-dist">\n\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="bars-container" ng-show="!$ctrl.selectedInsight.isMeasureNegative && !$ctrl.showing.table">\n\t\t\t\t\t\t\t<div class="value-bar" ng-class="{\'negative\': $ctrl.selectedInsight.isMeasureNegative}">\n\t\t\t\t\t\t\t\t<div tid="insight-with-selections-included-bar" class="bar included" ng-style="{height: ($ctrl.getPercentage(\'included\') /100) * 427 + \'px\'}">\n\t\t\t\t\t\t\t\t\t<div tid="insight-with-selections-included-measure-value" class="label" ng-style="{top: ($ctrl.getPercentage(\'included\')/100) * 427 + 5 + \'px\'}"\n\t\t\t\t\t\t\t\t\t\tng-class="{\'overlay-top\': !$ctrl.isLabelContained($ctrl.getPercentage(\'included\')), \'small\': !$ctrl.isLabelSmall($ctrl.getPercentage(\'included\'))}">\n\t\t\t\t\t\t\t\t\t\t{{ $ctrl.selectedInsight.counts.included }}\n\t\t\t\t\t\t\t\t\t\t<div tid="insight-with-selections-included-measure-percentage" class="percentage">\n\t\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\t$ctrl.getPercentageLocalized(\n\t\t\t\t\t\t\t\t\t\t\t"included"\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div tid="insight-with-selections-excluded-bar" class="bar excluded" ng-style="{height: ($ctrl.getPercentage(\'excluded\') / 100) * 427 + \'px\'}">\n\t\t\t\t\t\t\t\t\t<div tid="insight-with-selections-excluded-measure-value" class="label" ng-style="{bottom: ($ctrl.getPercentage(\'excluded\')/100) * 427 + 5 + \'px\'}"\n\t\t\t\t\t\t\t\t\t\tng-class="{\'overlay-bottom\': !$ctrl.isLabelContained($ctrl.getPercentage(\'excluded\')), \'small\': !$ctrl.isLabelSmall($ctrl.getPercentage(\'excluded\'))}">\n\t\t\t\t\t\t\t\t\t\t{{ $ctrl.selectedInsight.counts.excluded }}\n\t\t\t\t\t\t\t\t\t\t<div tid="insight-with-selections-excluded-measure-percentage" class="percentage">\n\t\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\t$ctrl.getPercentageLocalized(\n\t\t\t\t\t\t\t\t\t\t\t"excluded"\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="connectors" ng-if="!$ctrl.selectedInsight.isMeasureNegative">\n\t\t\t\t\t\t\t\t<div class="svg-container">\n\t\t\t\t\t\t\t\t\t<svg width="215" height="429"></svg>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="possible-label" q-translation="SelectionInsights.PossibleValues"></div>\n\t\t\t\t\t\t\t\t<div class="excluded-label" q-translation="SelectionInsights.ExcludedValues"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="measure-bar excluded-insight" ng-if="!$ctrl.selectedInsight.isMeasureNegative">\n\t\t\t\t\t\t\t\t<div tid="insight-without-selections-included-bar" class="bar included" ng-style="{height: ($ctrl.selectedInsight.measureBreakdown.included.percentage/100) * 427 + \'px\'}">\n\t\t\t\t\t\t\t\t\t<div tid="insight-without-selections-included-measure-value" class="label" ng-style="{top: ($ctrl.selectedInsight.measureBreakdown.included.percentage/100) * 427 + 5 + \'px\'}"\n\t\t\t\t\t\t\t\t\t\tng-class="{\'overlay-top\': !$ctrl.isLabelContained($ctrl.selectedInsight.measureBreakdown.included.percentage), \'small\': !$ctrl.isLabelSmall($ctrl.selectedInsight.measureBreakdown.included.percentage)}">\n\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t$ctrl.selectedInsight.measureBreakdown\n\t\t\t\t\t\t\t\t\t\t.included.num\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t<div tid="insight-without-selections-included-measure-percentage" class="percentage">\n\t\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\t$ctrl.getLocalizedPercentage(\n\t\t\t\t\t\t\t\t\t\t\t$ctrl.selectedInsight\n\t\t\t\t\t\t\t\t\t\t\t.measureBreakdown.included\n\t\t\t\t\t\t\t\t\t\t\t.percentage / 100\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div tid="insight-without-selections-excluded-bar" class="bar excluded" ng-style="{height: ($ctrl.selectedInsight.measureBreakdown.excluded.percentage/100) * 427 + \'px\'}">\n\t\t\t\t\t\t\t\t\t<div tid="insight-without-selections-excluded-measure-value" class="label" ng-style="{bottom: ($ctrl.selectedInsight.measureBreakdown.excluded.percentage/100) * 427 + 5 + \'px\'}"\n\t\t\t\t\t\t\t\t\t\tng-class="{\'overlay-bottom\': !$ctrl.isLabelContained($ctrl.selectedInsight.measureBreakdown.excluded.percentage), \'small\': !$ctrl.isLabelSmall($ctrl.selectedInsight.measureBreakdown.excluded.percentage)}">\n\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t$ctrl.selectedInsight.measureBreakdown\n\t\t\t\t\t\t\t\t\t\t.excluded.num\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t<div tid="insight-without-selections-excluded-measure-percentage" class="percentage">\n\t\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\t$ctrl.getLocalizedPercentage(\n\t\t\t\t\t\t\t\t\t\t\t$ctrl.selectedInsight\n\t\t\t\t\t\t\t\t\t\t\t.measureBreakdown.excluded\n\t\t\t\t\t\t\t\t\t\t\t.percentage / 100\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="bars-container" style="display: block" ng-show="$ctrl.showing.table">\n\t\t\t\t\t\t\t<div class="table-container" ng-class="{\'possible\': !$ctrl.showing.excluded}">\n\t\t\t\t\t\t\t\t<qv-object tabindex="-1" class="cell-content" model="$ctrl.selectedInsight.table" options="$ctrl.celloptions"></qv-object>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="toggle-values" ng-class="{\'show-table\': !$ctrl.showing.table}">\n\t\t\t\t\t\t\t<button tid="show-table-button" ng-if="!$ctrl.showing.table" class="lui-button show-table--button" ng-click="$ctrl.showTable(true)">\n\t\t\t\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--table"></span><span class="lui-button__text" q-translation="SelectionInsights.ShowValues"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button tid="show-table-button" ng-if="!$ctrl.showing.excluded && $ctrl.showing.table" class="lui-button show-vis--button" ng-click="$ctrl.toggleShowTableExcluded(true)">\n\t\t\t\t\t\t\t\t<span class="lui-button__text" q-translation="SelectionInsights.ViewExcluded"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button tid="show-table-button" ng-if="$ctrl.showing.excluded && $ctrl.showing.table" class="lui-button show-vis--button" ng-click="$ctrl.toggleShowTableExcluded(false)">\n\t\t\t\t\t\t\t\t<span class="lui-button__text" q-translation="SelectionInsights.ViewPossible"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button tid="show-table-button" ng-if="$ctrl.showing.table" class="lui-button show-vis--button" ng-click="$ctrl.showTable(false)">\n\t\t\t\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--back"></span><span class="lui-button__text" q-translation="SelectionInsights.ShowVisualization"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="insight-summary-footer">\n\t\t\t\t<div class="help-text" ng-bind-html="$ctrl.selectionHelp"></div>\n\t\t\t\t<div class="btns" ng-if="!$ctrl.hasLockedSelections">\n\t\t\t\t\t<button tid="select-possible-button" class="lui-button selection-btn" ng-click="$ctrl.selectPossible()" q-translation="Selections.Possible"></button>\n\t\t\t\t\t<button tid="select-excluded-button" class="lui-button selection-btn" ng-click="$ctrl.selectExcluded()" q-translation="Selections.Excluded"></button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'},865:function(t,e,n){"use strict";var i,a;function s(t){s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return s(t)}!(i=[n(48),n(96),n(866),n(91),n(95),n(234),n(220)],a=function(t,e,n,i,a,o){t.nativeComponent("qvSelectionInsightsCurrent",{bindings:{selectedInsight:"<",backToSelections:"&"},controller:["$scope","qvSelectionInsightsService","qvChartTooltipService","$timeout",function(t,n,r,l){var c=this,u,d=false;this.items=[];this.app=null;this.model=null;this.selectionsTitle="";this.measure="";this.selectionsCaption="";this.selectionsBarTotal="";a.subscribe("selection/insights/current-selection",function(t){c.items=n.getSelectionItems(t)});a.subscribe("selection/insights/current/open",function(t){var e={measure:t.insight.measure,aggr:t.insight.measureAggregation,dimension:t.insight.dimension,contribution:t.insight.selectedMeasure.selected.percentage.toFixed(1)};var n=t.insight.isSelectionNegative?t.insight.selectedMeasure.selected.num:t.insight.selectedMeasure.selected.percentage.toFixed(1)+"%";c.measure=e.measure;c.selectionsTitle=i.get("SelectionInsights.SelectionsContributionsTitle","<strong>"+e.measure.substring(0,40)+"</strong>");c.selectionsCaption=i.get("SelectionInsights.SelectionContributionCaption",["<span>"+e.measure.substring(0,40)+"</span>","<span>"+n+"</span>","<span>"+(e.aggr[0].toUpperCase()+e.aggr.slice(1))+"</span>"]);o.selectAll(".negative-chart.select-measure-dist svg").remove();if(t.insight.isSelectionNegative){var a=[{name:"selected",value:t.insight.selectedMeasure.selected.qNum,label:t.insight.selectedMeasure.selected.num},{name:"excluded",value:t.insight.selectedMeasure.excluded.qNum,label:t.insight.selectedMeasure.excluded.num}];p(a)}});function p(t){var e=431;var n=120;var i=10;var a=".negative-chart.select-measure-dist";var s=45;var r=30;var l=o.select(".negative-chart"+a).append("svg").attr("width",n+s).attr("height",e+s);var c=l.append("g").attr("transform","translate("+i/2+",1)");var u=o.scale.ordinal().rangeRoundBands([0,n]);var d=o.scale.linear().range([e,0]);u.domain(t.map(function(t){return t.name}));d.domain(o.extent(t,function(t){return t.value}));var p=c.append("defs");p.append("filter").attr("id","blur").append("feGaussianBlur").attr("stdDeviation",5);p.append("pattern").attr("id","diagonalStripes").attr("patternUnits","userSpaceOnUse").attr("width",8).attr("height",8).attr("patternTransform","rotate(45)").append("rect").attr("width","2").attr("height","8").attr("fill","#4dc753");c.selectAll("bar").data(t).enter().append("rect").style("fill","rgba(0,0,0,0.1)").attr("x",function(t){return u(t.name)}).attr("width",u.rangeBand()).attr("y",function(t){return t.value>0?d(t.value):d(0)}).attr("height",function(t){return Math.abs(d(t.value)-d(0))}).attr("filter","url(#blur)").attr("rx",3).attr("ry",3);c.selectAll("bar").data(t).enter().append("rect").style("fill",function(t){return"selected"==t.name?"#6cd475":"#D8D8D8"}).style("stroke",function(t){return"selected"==t.name?"#37B342":"#959595"}).attr("x",function(t){return u(t.name)}).attr("width",u.rangeBand()).attr("y",function(t){return t.value>0?d(t.value):d(0)+1}).attr("height",function(t){return Math.abs(d(t.value)-d(0))}).attr("rx",3).attr("ry",3);c.selectAll("bar").data(t).enter().append("rect").style("fill",function(t){return"selected"==t.name?"#6cd475":"#D8D8D8"}).attr("x",function(t){return u(t.name)}).attr("width",u.rangeBand()).attr("y",function(t){return t.value>0?d(t.value)-3:d(0)+1}).attr("height",2);var h=l.append("g").attr("class","barLabels").attr("transform","translate("+i/2+",0)");t.forEach(function(t,e){c.append("line").style("stroke","selected"==t.name?"#37B342":"#959595").attr("x1",u(t.name)).attr("y1",function(){return t.value>0?d(t.value):d(0)}).attr("x2",u(t.name)).attr("y2",function(){return t.value>0?d(t.value)-3:d(0)+3});e>0&&c.append("line").style("stroke","selected"==t.name?"#37B342":"#959595").attr("x1",u(t.name)+60).attr("y1",function(){return t.value>0?d(t.value):d(0)}).attr("x2",u(t.name)+60).attr("y2",function(){return t.value>0?d(t.value)-3:d(0)+3});"selected"==t.name&&c.append("rect").attr("x",function(){return u(t.name)}).attr("width",u.rangeBand()).attr("y",function(){return t.value>0?d(t.value):d(0)}).attr("height",function(){return Math.abs(d(t.value)-d(0))}).attr("stroke","#504A9E").attr("stroke-width","0").attr("rx",3).attr("ry",3).attr("fill","url(#diagonalStripes)");var n=h.append("g");n.append("rect").attr("x",function(){return u(t.name)}).attr("width",u.rangeBand()).attr("height",2).attr("y",function(){return t.value>0?d(t.value):d(0)}).attr("opacity",0);n.append("text").attr("x",u(t.name)+r).attr("y",function(){return t.value>0?d(t.value)+20:Math.abs(d(t.value)-d(0))<r?Math.abs(d(t.value)-d(0))+d(0)+20:Math.abs(d(t.value)-d(0))+d(0)-10}).attr("text-anchor","middle").attr("class","grouped-bar-label").text(t.label).attr("fill",function(){var e="#414141";"selected"==t.name&&(e=Math.abs(d(t.value)-d(0))<r?"#2F9938":"#FFFFFF");return e})});l.append("g").attr("class","x axis").append("line").attr("y1",d(0)).attr("y2",d(0)).attr("x2",n+i).attr("stroke","#404040").attr("stroke-width","3");var g=l.append("text").attr("x",n+2*i).attr("y",d(0)-28).attr("text-anchor","left").style("font-size","22px").attr("fill","#B3B3B3");g.append("tspan").attr("dx",0).attr("dy",4).text("+");g.append("tspan").attr("dx",-13).attr("dy",30).attr("fill","#404040").text("0");g.append("tspan").attr("dx",-10).attr("dy",30).text("-")}c.selectionsBarTotal=function(){if(c.selectedInsight&&c.selectedInsight.selectedMeasure.total)return i.get("SelectionInsights.SelectionsBarTotal",[c.selectedInsight.selectedMeasure.total])};this.getLocalizedPercentage=function(t){return n.getLocalizedPercentage(t)};this.getSeparatorPos=function(){if(void 0!==c.items&&null!==c.selectedInsight&&void 0!==c.selectedInsight){var t=56;var e=427;if(c.selectedInsight.isSelectionNegative){var n=c.selectedInsight.selectedMeasure.selected.qNum;var i=c.selectedInsight.selectedMeasure.excluded.qNum;var a=0;e=431;var s=55;a=n<0?e-Math.abs(n)/2/((Math.abs(n)+i)/e):n/2/((Math.abs(i)+n)/e);return a+s}var o=38;var r=10;var l=(c.items.length*o+(c.items.length-1)*r)/2;var u=c.selectedInsight.selectedMeasure.selected.percentage/100*e/2;return t+Math.min(l,u)}};this.isLabelContained=function(t){var e=427;var n=55;var i=t/100*e;return n<i};this.getLabelFontSize=function(t){var e=427;var n=65;var i=t/100*e;return n<i?"24px":"36px"};this.getNegativeMeasureText=function(){return i.get("SelectionInsights.SelectionNegative",[c.selectedInsight.measureAggregation[0].toUpperCase()+c.selectedInsight.measureAggregation.slice(1),c.selectedInsight.measure])};function h(t){var e=t.qStateCounts;var n="";"object"===s(e)&&(n=" ("+(e.qSelected+e.qSelectedExcluded+e.qLocked+e.qLockedExcluded)+"/"+t.qTotal+")");return n}t.openTooltip=function(n,i){if(d||e.utils.touch)return;t.cancelTooltip();u=l(function(){d=true;var t=i.translation;var e=h(i);r.open({content:[{header:(i.qReadableName||i.qField)+e,rows:[{content:t}]}],position:{x:n.clientX,y:n.clientY},alwaysOnTop:true,direction:"bottom",template:"current-selections-tooltip-template.ng.html"})},500)};t.closeTooltip=function(){d=false;t.cancelTooltip();r.close()};t.cancelTooltip=function(){l.cancel(u)};this.getNegativeMeasurePossible=function(){return i.get("SelectionInsights.SelectionNegativePossible",[c.selectedInsight.measureAggregation[0].toUpperCase()+c.selectedInsight.measureAggregation.slice(1),c.selectedInsight.measure,"<span>"+c.selectedInsight.measureBreakdown.included.num+"</span>"])};this.getNegativeMeasureExcluded=function(){return i.get("SelectionInsights.SelectionNegativeExcluded",[c.selectedInsight.measureAggregation[0].toUpperCase()+c.selectedInsight.measureAggregation.slice(1),c.selectedInsight.measure,"<span>"+c.selectedInsight.measureBreakdown.excluded.num+"</span>"])};this.isLabelSmall=function(t){var e=427;var n=65;var i=t/100*e;return n<i};this.getVerticalHeight=function(){if(void 0!==c.items&&null!==c.selectedInsight&&void 0!==c.selectedInsight)return c.selectedInsight.isSelectionNegative?431:40*c.items.length+11*(c.items.length-1)};this.$onDestroy=function(){a.unsubscribe("selection/insights/current-selection");a.unsubscribe("selection/insights/current/open")}}],template:n})}.apply(e,i),void 0!==a&&(t.exports=a))},866:function(t,e){t.exports='<div class="closeBtn">\n\t<button tid="back-to-selection-button" class="lui-button" ng-click="$ctrl.backToSelections()" q-translation="SelectionInsights.BackToSelections"></button>\n</div>\n<div class="details-body">\n\t<div class="title current-selection-title">\n\t\t<span tid="selection-details-title" ng-bind-html="$ctrl.selectionsTitle"></span>\n\t</div>\n\t<div class="current-selection-caption">\n\t\t<div tid="selections-caption" ng-bind-html="$ctrl.selectionsCaption"></div>\n\t</div>\n\t<div class="current-selection-details">\n\t\t<div class="field-list">\n\t\t\t<div tid="selections-fields-title" class="fields-title" q-translation="SelectionInsights.YourSelections" q-title-translation="{{ SelectionInsights.YourSelections }}"></div>\n\t\t\t<div class="fields-items">\n\t\t\t\t<ul class="list" ng-show="$ctrl.items.length > 0">\n\t\t\t\t\t<li class="item" tid="selection-insight-details-user-selections" ng-class="{\'item-multi-state\': !item.isSingleState, \'multi-active\': multiPopoverFieldName && multiPopoverFieldName === item.qField}" ng-repeat="item in $ctrl.items track by item.qField" data-csid="{{ item.qField }}" tabindex="0"\n\t\t\t\t\t ng-keydown="handleKeyDown($event, item)" aria-label="{{ item.screenReaderLabel }}">\n\t\t\t\t\t\t<qv-current-selections-item ng-if="item.isSingleState" item="item"></qv-current-selections-item>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="separator" ng-class="{\'negative\': $ctrl.selectedInsight.isSelectionNegative}">\n\t\t\t<div class="legend-dist" ng-if="$ctrl.selectedInsight.isSelectionNegative">\n\t\t\t\t<div class="selected-legend">\n\t\t\t\t\t<div class="square">\n\t\t\t\t\t\t<div class="green-square"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="legend-label" tid="selected-chart-legend" q-translation="SelectionInsights.Selected" q-title-translation="{{ SelectionInsights.Selected }}"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="excluded-legend">\n\t\t\t\t\t<div class="square">\n\t\t\t\t\t\t<div class="gray-square"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="legend-label" tid="excluded-chart-legend" q-translation="SelectionInsights.Excluded" q-title-translation="{{ SelectionInsights.Excluded }}"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="vertical" ng-style="{height: $ctrl.getVerticalHeight() + \'px\'}"></div>\n\t\t\t<div class="horizontal" ng-style="{\'margin-top\': $ctrl.getSeparatorPos() + \'px\'}"></div>\n\t\t</div>\n\t\t<div class="chart">\n\t\t\t<div tid="selections-bar-title" class="bar-title" q-translation="SelectionInsights.SelectionsBarTitle, {{\n\t\t\t\t\t$ctrl.measure\n\t\t\t\t}}" q-translation-title="SelectionInsights.SelectionsBarTitle, {{\n\t\t\t\t\t$ctrl.measure\n\t\t\t\t}}"></div>\n\t\t\t<div tid="selections-bar-total" class="bar-total" title="{{ $ctrl.selectionsBarTotal() }}">\n\t\t\t\t{{ $ctrl.selectionsBarTotal() }}\n\t\t\t</div>\n\t\t\t<div class="bar selected" ng-if="!$ctrl.selectedInsight.isSelectionNegative" ng-style="{height: ($ctrl.selectedInsight.selectedMeasure.selected.percentage/100) * 427 + \'px\'}">\n\t\t\t\t<div tid="selected-measure-number" class="label" ng-style="{top: ($ctrl.selectedInsight.selectedMeasure.selected.percentage/100) * 427 + 5 + \'px\'}" ng-class="{\'overlay-top\': !$ctrl.isLabelContained($ctrl.selectedInsight.selectedMeasure.selected.percentage), \'small\': !$ctrl.isLabelSmall($ctrl.selectedInsight.selectedMeasure.selected.percentage)}">\n\t\t\t\t\t{{ $ctrl.selectedInsight.selectedMeasure.selected.num }}\n\t\t\t\t\t<div tid="selected-measure-percentage" class="percentage">\n\t\t\t\t\t\t{{\n\t\t\t\t\t\t$ctrl.getLocalizedPercentage(\n\t\t\t\t\t\t$ctrl.selectedInsight.selectedMeasure.selected\n\t\t\t\t\t\t.percentage / 100\n\t\t\t\t\t\t)\n\t\t\t\t\t\t}}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="bar excluded" ng-if="!$ctrl.selectedInsight.isSelectionNegative" ng-style="{height: ($ctrl.selectedInsight.selectedMeasure.excluded.percentage/100) * 427 + \'px\'}">\n\t\t\t\t<div tid="excluded-measure-number" class="label" ng-style="{bottom: ($ctrl.selectedInsight.selectedMeasure.excluded.percentage/100) * 427 + 5 + \'px\'}" ng-class="{\'overlay-bottom\': !$ctrl.isLabelContained($ctrl.selectedInsight.selectedMeasure.excluded.percentage), \'small\': !$ctrl.isLabelSmall($ctrl.selectedInsight.selectedMeasure.excluded.percentage)}">\n\t\t\t\t\t{{ $ctrl.selectedInsight.selectedMeasure.excluded.num }}\n\t\t\t\t\t<div tid="excluded-measure-percentage" class="percentage">\n\t\t\t\t\t\t{{\n\t\t\t\t\t\t$ctrl.getLocalizedPercentage(\n\t\t\t\t\t\t$ctrl.selectedInsight.selectedMeasure.excluded\n\t\t\t\t\t\t.percentage / 100\n\t\t\t\t\t\t)\n\t\t\t\t\t\t}}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="negative-chart select-measure-dist" ng-show="$ctrl.selectedInsight.isSelectionNegative"></div>\n\t\t</div>\n\t</div>\n</div>'},867:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(868),n(95),n(869),n(147),n(106),n(103),n(870)],a=function(t,e,n,i,a,s,o){t.nativeComponent("qvSelectionInsightsSummary",{bindings:{showLoading:"<",hasSelection:"<",measure:"=",newMeasureChosen:"=",newSelection:"=",showFields:"<",selectionInsightsState:"=",states:"=",measureError:"="},controller:["$scope","$timeout","luiPopover","qvSelectionInsightsService","qvSelectionInsightsSearchService",function(t,e,r,l,c){var u=this;this.showLoading=true;var d=[];this.fieldList=[];this.showFieldsChanged=false;this.currentMeasure=u.measure;function p(){e(function(){var t=document.getElementsByClassName("ai-change-field-input");t[0].focus()},100)}this.showChangeField=function(t){var e=["$scope",function(t){function e(e){var n=t.highlight;var i=c.getMatchingFields(e,n);t.measures=i.filter(function(t){return!t.masterItemMeasures});t.masterMeasures=i.filter(function(t){return t.masterItemMeasures})}function n(n){t.highlight=n;e(u.fieldList)}t.filterFields=n;t.onSelectMeasure=b;t.navigate=S;e(u.fieldList)}];h(i,e,t.currentTarget,"bottom",g)};function h(t,e,n,i,a){var s={template:t,controller:e,dock:i,alignTo:n,showArrow:true,autoFocus:false};var o=r.show(s);d.push(o);o.closed.then(function(){"function"===typeof a&&a()});p()}function g(){d.forEach(function(t,e){t.close();d.splice(e,1)})}function f(){l.getMeasures(u.showFields).then(function(t){u.fieldList=t})}function v(){a.getList().then(function(e){t.masterMeasuresListModel=e});s(t,"masterMeasuresListModel",function(){f()})}v();this.refreshInsights=function(){n.publish("selection/insights/refresh");u.newMeasureChosen=false;u.newSelection=false;u.showFieldsChanged&&m();return l.getInsightDimensions(u.showFields,u.selectedMeasure).then(function(t){n.publish("selection/insights/new",t);u.currentMeasure=u.measure}).catch(function(t){n.publish("selection/insights/error",t.error)})};this.$onChanges=function(t){if(void 0!==t.showFields&&!t.showFields.isFirstChange()){u.showFieldsChanged=true;u.newMeasureChosen=false;n.publish("selection/insights/fields/change")}};function m(){l.getMeasures(u.showFields).then(function(t){u.showFieldsChanged=false;u.fieldList=t})}n.subscribe("selection/insights/show",function(){u.showFieldsChanged&&m()});function b(t){u.newMeasureChosen=true;u.newSelection=false;u.measureError=false;u.selectedMeasure=t;u.measure=t.qName;g();o.trackEvent(o.customEvents.NEW_MEASURE_CHOSEN,{type:"clicked"});u.refreshInsights()}function S(t){b(t)}}],template:e})}.apply(e,i),void 0!==a&&(t.exports=a))},868:function(t,e){t.exports='<div class="qv-selections-insights-cards-summary" ng-class="{\'empty\': $ctrl.showLoading}">\n\t<div ng-if="!$ctrl.showLoading">\n\t\t<div class="summary-text" ng-if="!$ctrl.newMeasureChosen && !$ctrl.newSelection && !$ctrl.showFieldsChanged">\n\t\t\t<span q-translation="SelectionInsights.SummarySelection"> </span>\n\t\t</div>\n\t\t<div class="measure-select">\n\t\t\t<div class="refresh-insights-new-selection" ng-if="!$ctrl.newMeasureChosen && ($ctrl.newSelection || $ctrl.showFieldsChanged) ">\n\t\t\t\t<p class="refresh-insights-paragraph" q-translation="SelectionInsights.Refresh.NewSelection"></p>\n\t\t\t\t<div class="refresh-insights--button-group">\n\t\t\t\t\t<button class="lui-button  lui-button--success refresh-insights--button onlyOne" q-translation="SelectionInsights.Refresh" ng-click="$ctrl.refreshInsights()"></button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<h2 q-translation="Common.Measure"></h2>\n\t\t\t<p q-translation="SelectionInsights.CalculatedOn"></p>\n\t\t\t<button tid="ai-measure-picker" class="ai-measure-picker lui-button" id="ai-measure-picker" ng-click="$ctrl.showChangeField($event)" tabindex="0" ng-disabled="$ctrl.showFieldsChanged || $ctrl.newSelection">\n\t\t\t\t<span class="ai-measure-picker-text">{{ $ctrl.measure }}</span><span class="lui-icon lui-button__icon small lui-icon--small" ng-class="{\'lui-icon--arrow-down\' : !match.expanded, \'lui-icon--arrow-up\': match.expanded}"></span>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="measure-error" ng-if="$ctrl.measureError" q-translation="SelectionInsights.ErrorNaN"></div>\n\t</div>\n</div>\n<div class="hr-div">\n\t<hr class="qv-selection-insights-hr" ng-if="$ctrl.selectionInsightsState === $ctrl.states.INSIGHTS_FOUND" />\n</div>'},869:function(t,e){t.exports='<lui-popover class="ai-change-field-popover ai-popover">\n\t<object-add-typeahead>\n\t\t<lui-popover-header>\n\t\t\t<div class="lui-input-group">\n\t\t\t\t<input class="lui-input lui-input-group__input ai-change-field-input" type="text" autocomplete="off" ng-model="search.term" qva-focus="autoFocus" ng-change="filterFields(search.term)" maxlength="255" object-add-typeahead-input />\n\t\t\t</div>\n\t\t</lui-popover-header>\n\t\t<div class="lui-popover__body lui-nopad popover-body" object-add-typeahead-menu>\n\t\t\t<ul class="lui-list">\n\t\t\t\t<div ng-if="masterMeasures.length > 0" class="object-add-popover-list-header" q-translation="Common.MasterMeasures"></div>\n\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="field in masterMeasures" ng-click="onSelectMeasure(field)" on-select="navigate(field)" object-add-typeahead-item="field">\n\t\t\t\t\t<span class="lui-list__text" qve-highlight text="{{ field.qName }}" query="highlight"></span>\n\t\t\t\t</li>\n\n\t\t\t\t<div ng-if="measures.length > 0" class="object-add-popover-list-header" q-translation="Common.Measures"></div>\n\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="field in measures" ng-click="onSelectMeasure(field)" on-select="navigate(field)" object-add-typeahead-item="field">\n\t\t\t\t\t<span class="lui-list__text" qve-highlight text="{{ field.qName }}" query="highlight"></span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\n\t\t\t<div class="no-hits" ng-if="fieldList.length === 0">\n\t\t\t\t<span><i q-translation="Toolbox.Search.Nohits" /></span>\n\t\t\t</div>\n\t\t</div>\n\t</object-add-typeahead>\n</lui-popover>'},870:function(t,e,n){"use strict";var i,a;!(i=[n(54),n(48),n(112)],a=function(t,e,n){e.service("qvSelectionInsightsSearchService",[function(){var e;function i(e,i){var a=[];var s;i?i=i?i.toLowerCase():"":i&&""!==i||(s=true);if(s)return e;a=t.uniq(e).filter(function(t){return n.librarySearchFn(t,i)});return n.localeOrderBy(a,function(t){return t.qName})}e={getMatchingFields:function t(e,n){return i(e,n)}};return e}])}.apply(e,i),void 0!==a&&(t.exports=a))},871:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(872),n(873),n(306)],a=function(t,e,n){t.directive("qvGlobalSearch",function(){return{restrict:"E",template:e,controller:["$scope","$document","$element","$window",n],require:["qvGlobalSearch"],scope:true,replace:true,link:function t(){}}});return"<qv-global-search></qv-global-search>"}.apply(e,i),void 0!==a&&(t.exports=a))},872:function(t,e){t.exports='<div>\n\t<div class="qv-global-search" ng-class="{ \'overlay\': displaySuggestions || displayResult.data || displayResult.visuals }" ng-style="{paddingTop: toolbarHeight}" qva-outside="onOutsideSearch($event)" tid="globalSearch">\n\t\t<div class="zoomed-chart" ng-class="{\'animate-expand \': animateZoomedChart, \'animate-shrink\': !animateZoomedChart}">\n\t\t\t<div class="close-btn" ng-if="zoomedChart" tid="smartsearch-zoomed-chart">\n\t\t\t\t<button class="lui-fade-button" ng-click="minimizeExpandedChart()" tid="smartSearchExitZoomedChart">\n\t\t\t\t\t<span class="lui-fade-button__icon  lui-icon lui-icon--close lui-icon--large"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div class="chart" ng-if="zoomedChart">\n\t\t\t\t<qv-object tid="smartsearch-zoomed-chart-object" model="zoomedChart.model" options="zoomedChart.options"></qv-object>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<qv-global-search-input class="qv-global-search-input"></qv-global-search-input>\n\t\t<div class="qv-global-search-line" ng-if="!showMobileIndexProgressBar"></div>\n\t\t<qv-mobile-index-progress ng-if="isSmallDevice && query.length === 0 && isIndexClosedFeature"></qv-mobile-index-progress>\n\t\t<qv-global-search-history ng-if="isSearchHistoryFeature && searchInputFocused && query.length === 0"></qv-global-search-history>\n\t\t<div class="qv-global-search-dimmer" ng-if="query.length > 0 || forceShowDimmer" ng-style="dimmerStyles">\n\t\t\t<qv-global-search-result tid="globalSearch.ResultList"></qv-global-search-result>\n\t\t\t<div ng-show="scrollShow && !activity.show" class="scroll-affordance scroll-vertical"></div>\n\t\t</div>\n\t</div>\n\t<div class="qv-global-search-glass" ng-if="query.length > 0" qva-activate="close();"></div>\n</div>\n'},873:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(113),n(108),n(97),n(106),n(143),n(874),n(110),n(227),n(50),n(128),n(99),n(881),n(882),n(883),n(884),n(885),n(49),n(89),n(91),n(95),n(105),n(222),n(887),n(890),n(901),n(903),n(905),n(908),n(169),n(175)],a=function(t,e,n,i,a,s,o,r,l,c,u,d,p,h,g,f,v,m,b,S,y,I,x,q){function w(t,e,n,i){var a={qOffset:e,qCount:n,qGroupOptions:[],qGroupItemOptions:[]};if(t===g.data){a.qGroupOptions.push({qGroupType:"DatasetType",qOffset:0,qCount:-1});a.qGroupItemOptions.push({qGroupItemType:"Field",qOffset:0,qCount:i})}else if(t===g.visuals){a.qGroupOptions.push({qGroupType:"GenericObjectsType",qOffset:0,qCount:30});a.qGroupItemOptions.push({qGroupItemType:"GenericObject",qOffset:0,qCount:i})}return a}function C(t){var e={qContext:"CurrentSelections"};t&&(e.qCharEncoding="Utf16");return e}function P(t,e){t.dimmerStyles["max-height"]=e;t.dimmerStyles["height"]=e}function T(t){t.isSmallDeviceLandscape=u.orientation===u.Orientation.landscape&&u.isSmallDevice}function A(A,D,E,k){var M=e.getService("qvGlobalSearchDataService"),$=e.getService("$timeout"),O=e.getService("qvGlobalSelectionsService"),F=e.getService("qvGlobalSearchService"),N,L={search:{idCounter:0,requestState:h.idle,searchTerms:""},searchVisuals:{idCounter:0,requestState:h.idle,searchTerms:""},result:{requestState:h.idle},suggest:{idCounter:0,requestState:h.idle,suggestTerms:""}},_=function t(){$(function(){A.isSmallDevice=u.isSmallDevice;A.isSmallDevice&&(A.forceShowDimmer=false);T(A);G=z();j()})},R=function t(){A.isSmallDeviceLandscape=u.orientation===u.Orientation.landscape&&u.isSmallDevice;T(A);G=z();j()},j=function t(){P(A,D.find("body").height()-G)},z=function t(){return E.offset().top+E[0].offsetTop+E.find(".qv-global-search-input").outerHeight()},G=z(),H=E.parent().parent(),B=this;A.inClient=i.inClient();A.zoomedChart=false;A.focusState=new f(new v(f,this,A),f.Input);N=new r(E,A,this);A.forceShowDimmer=false;A.isSmallDevice=u.isSmallDevice;A.isSmallDeviceLandscape=u.orientation===u.Orientation.landscape&&u.isSmallDevice;A.showMobileIndexProgressBar=false;A.isObjectsFeature=n["SMARTSEARCH_OBJECTS"]&&A.inClient&&(A.isSmallDevice||A.options&&A.options.objectSearchIsOn);A.isSearchHistoryFeature=n["SEARCH_HISTORY"];A.isIndexClosedFeature=n["SMARTSEARCH_INDEX_CLOSE"];A.suggestedChartExpanded=null;I.subscribe(x.Events.PubSub.ExpandSmartSearchSuggestedChart,function(t){A.zoomedChart=t;A.animateZoomedChart=Boolean(t);A.suggestedChartExpanded=Boolean(t);t&&A.isSmallDevice&&q.resizeCharts(k)});I.subscribe(x.Events.PubSub.RestoreSearchState,function(){if(A.suggestedChartExpanded){A.query=A.suggestedChartExpanded;B.setQueryFromHistory()}});A.minimizeExpandedChart=function(){A.suggestedChartExpanded=null;I.publish(x.Events.PubSub.ExpandSmartSearchSuggestedChart,null)};if(A.isSearchHistoryFeature){o.userId?A.userID=o.userId:A.userID="DESKTOP";A.searchInputFocused=false;A.activeHistoryIx=-1;A.historyPermission=false;A.searchHistory=m.initHistory(A)}u.ViewChanged.bind(_);u.OrientationChanged.bind(R);a.on("end",j);A.input="input goes here";A.result="result goes here";A.isSelectActiveInSmallDevice=false;A.$on("$destroy",function(){E.off("qv-outside");N.delete();u.ViewChanged.unbind(_);u.OrientationChanged.unbind(R);a.off("end",j);I.unsubscribe(x.Events.PubSub.ExpandSmartSearchSuggestedChart);I.unsubscribe(x.Events.PubSub.RestoreSearchState)});A.$on("updateForceShowDimmer",function(t,e){A.forceShowDimmer=e});A.$watch("throbber.show",function(t){t&&A.focusState.reset()});A.app.getCurrentSelectionObject().then(function(t){A.modelSelections=t});s(A,"modelSelections",function(t){var e=t.qSelectionObject.qSelections,n;n=e.reduce(function(t,e){return t+(true===e.qLocked)?1:0},0);A.currentSelections=e.length>0;A.allSelectionsLocked=e.length===n;A.isObjectsFeature&&B.searchVisuals(A.searchTerms);B.search(A.searchTerms)});A.$watch("app.isModal()",function(t){t&&$(function(){F.toggleGlobalSearch(A.app)})});A.$watch(O.isSelectActive.bind(null,A.app),function(t){A.isSelectActiveInSmallDevice=t&&A.isSmallDevice});A.$watch("query",function(t){F.setHaveQuery(A.app,!!t)});if(A.isIndexClosedFeature&&!A.isSmallDevice&&F.couldEngineBeIndexing(A.app)){A.forceShowDimmer=true;$(function(){A.$broadcast("toggleActivityIndicator",true)})}A.underlines=[];A.query="";A.searchTerms=[];A.searchTermGroups=[];A.matches=[];A.displayResult={data:false,visuals:false};A.activity={show:false};A.throbber={show:false};A.indexProgress={enabled:false,show:false,visible:false};A.indexDone={show:false,visible:false};A.activeSelectIx=-1;A.showMeMoreFocus=false;A.forcePartials=false;A.allSelectionsLocked=false;A.dimmerStyles={};A.error={show:false,message:"",description:""};A.paging={lastRowIx:0,totalRows:0};A.searchOutsideSelections=function(){B.searchOutsideSelections()};A.onShowMoreHits=function(t,e,n){t.stopPropagation();if(e.disableShowMore)return;P(A,E.find(".qv-global-search-dimmer").height());e.disableShowMore=true;e.mobileExpand=true;var i=w(g.data,n,1,e.qItemMatches.length+15);B.callSearch(A.searchTerms,i).then(function(t){M.showMore(t,e)}).finally(function(){e.disableShowMore=false})};A.getSearchTermGroup=function(t){return A.searchTermGroups.filter(function(e){return e.qSearchTermsMatched.length===t})};A.close=function(){B.closeSearch()};E.on("qv-outside",V);function V(e){var n=t(e.target);if(1===n.closest(".qv-selections-pager").length||1===n.closest(".transparent-overlay-scroll").length)return;B.closeSearch()}A.suggestions=[];A.displaySuggestions=false;A.activeSuggestionIx=-1;A.ignoreQueryChange=false;A.onOutsideSearch=function(){A.isSearchHistoryFeature&&B.showHistory(false)};A.onSuggestSelect=function(t,e){var n,i,a=[];if(!e){t=void 0!==t?t:A.activeSuggestionIx;e=A.suggestions[t]}M.getUnderlinersAndSearchTerms(A.query,a,[]);n=M.getResultingQueryFromSuggestion(a,e);if(n.length>255){N.off();c.showDialog({message:"ErrorDialog.SearchStringTooLong"});i=A.$on("errorHandlerClosed",function(){N.on();i()})}else{A.query=n+" ";A.ignoreQueryChange=false}B.hideSuggestions();A.$broadcast("focusInput");A.getInsightsCharts(e.value)};A.haveUnlockedSelections=function(){return A.currentSelections&&!A.allSelectionsLocked};A.getInsightsCharts=function(t){if(b.getFlag("CAO_MOBILE")){var n=e.getService("qvCaoChartService");if(A.query){A.unableTofetchInsightCharts=false;A.fetchingInsightChartsPending=true;n.getInsights(A.app,t).then(function(t){var e=[].concat(t.recommendations).concat(t.chartMatches);var n=e.map(function(t){return t.visualization.loadChart(A.app)});S.all(n).then(function(t){e=e.map(function(e,n){e=Object.assign({},e,{itemIndex:n,load:true,qItemType:"GenericObject",qTotalNumberOfMatches:0,qIdentifier:t[n].model.id,qItemMatches:[],qTermsMatched:[],qSearchTermsMatched:[]});return e});if(e.length>0){A.suggestedChartGroupTitle=y.get("GlobalSearch.Insight.ChartsTitle",[e.length]);A.insightVisualsGroups=[{qGroupType:"GenericObjectsType",qid:0,qItems:e,insightCharts:true,qSearchTermsMatched:[0],qTotalNumberOfItems:e.length}]}A.fetchingInsightChartsPending=false})},function(){A.unableTofetchInsightCharts=true;A.insightVisualsGroups=[];A.fetchingInsightChartsPending=false})}else A.insightCharts=[]}};this.hideSuggestions=function(){if(A.displaySuggestions){A.displaySuggestions=false;this.resetSuggestions()}};this.hideSoftKeyboard=function(){A.$broadcast("blurInput")};this.showNoResultsMessage=function(){return false};this.searchOutsideSelections=function(){A.outsideSelection=true;A.modelSelections.clearAll();A.$broadcast("focusInput")};this.setShowPartialMatches=function(){A.forcePartials=!A.forcePartials;p.treatAsDesktop()&&A.$broadcast("focusInput")};A.isPartials=function(){return A.searchTermGroups.length&&A.searchTerms.length>A.searchTermGroups[0].qSearchTermsMatched.length};this.resetSuggestions=function(){A.activeSuggestionIx=-1;A.activeSelectIx=-1};this.showSuggestions=function(){A.displaySuggestions=true;A.activeSuggestionIx=-1;A.activeSelectIx=-1};this.showError=function(t){A.displayResult={data:false,visuals:false};A.error.show=true;A.error.translation="ErrorCode."+t.code;t.isHandled=true};this.toogleSuggestions=function(t){t?this.showSuggestions():this.hideSuggestions()};this.emptyResult=function(){A.insightVisualsGroups=[];A.displayResult={data:false,visuals:false};A.activeSelectIx=-1;A.error.show=false;L.search.requestState=h.idle;L.searchVisuals.requestState=h.idle;L.suggest.requestState=h.idle;A.searchTerms=[];A.searchTermGroups=[];A.searchVisualsGroups=[];A.matches=[];A.outsideSelection=false;A.$broadcast("toggleActivityIndicator",false);A.forcePartials=false;A.focusState.reset();this.hideSuggestions();H.removeClass("queryon")};this.moveActiveResult=function(t){A.showMeMoreFocus=false;if(0===t)return;if(t>0){A.activeSelectIx=Math.min(A.activeSelectIx+1,A.searchTermGroups.length);A.activeSelectIx=Math.min(A.activeSelectIx,A.paging.totalRows-1);A.activeSelectIx===A.searchTermGroups.length&&(A.showMeMoreFocus=true)}else t<0&&(A.activeSelectIx=Math.max(A.activeSelectIx-1,0))};this.searchVisuals=function(t){if(!A.isObjectsFeature)return;P(A,D.find("body").height()-G);if(0===t.length)return;L.searchVisuals.idCounter=L.searchVisuals.idCounter+1;var e=L.searchVisuals.idCounter,n=this,i={qAttributes:["qProperty"],qCharEncoding:"Utf16"},a=w(g.visuals,0,-1,20);L.searchVisuals.requestState=h.pending;L.searchVisuals.searchTerms=t;function s(t){A.searchVisualsGroups=[];if(e===L.searchVisuals.idCounter&&L.searchVisuals.requestState===h.pending){L.searchVisuals.requestState=h.idle;L.searchVisuals.searchTerms="";M.transformResult(A,t)}}function o(t){if(t.code===l.NxLocalizedErrorCode.LOCERR_SEARCH_TIMEOUT){n.emptyResult();n.showError(t)}if(t.code===l.NxLocalizedErrorCode.LOCERR_GENERIC_ABORTED)return;L.searchVisuals.requestState=h.idle;L.searchVisuals.searchTerms="";A.displayResult.visuals=false}A.app[g.visuals](i,t,a).then(s,o)};this.search=function(t){P(A,D.find("body").height()-G);A.focusState.reset();if(0===t.length)return;H.addClass("queryon");L.search.idCounter=L.search.idCounter+1;var e=L.search.idCounter,n=this,i=w(g.data,0,5,5);L.search.requestState=h.pending;L.search.searchTerms=t;A.$broadcast("toggleActivityIndicator",true);A.$broadcast("resultScrollToTop");function a(n){A.searchTermGroups=[];A.matches=[];if(e===L.search.idCounter&&L.search.requestState===h.pending){L.search.requestState=h.idle;L.search.searchTerms="";A.searchTerms=t;A.$broadcast("toggleActivityIndicator",false,true);A.$broadcast("resultScrollToTop");M.transformResult(A,n);A.activeSelectIx=-1;A.paging.lastRowIx=A.searchTermGroups.length;A.paging.totalRows=n.qTotalNumberOfGroups}}function s(t){if(t.code===l.NxLocalizedErrorCode.LOCERR_SEARCH_TIMEOUT){n.emptyResult();n.showError(t)}if(t.code===l.NxLocalizedErrorCode.LOCERR_GENERIC_ABORTED)return;L.search.requestState=h.idle;L.search.searchTerms="";A.displayResult.data=false}A.error.show=false;this.callSearch(t,i).then(a,s)};this.loadNextPage=function(){P(A,E.find(".qv-global-search-dimmer").height());var t=w(g.data,A.paging.lastRowIx,5,5),e=this;if(L.result.requestState!==h.idle)return;L.result.requestState=h.pending;A.showMeMoreFocus=false;A.$broadcast("toggleActivityIndicator",true);function n(t){L.result.requestState=h.idle;A.$broadcast("toggleActivityIndicator",false,true);M.transformResult(A,t);A.paging.lastRowIx=A.searchTermGroups.length}function i(){if(i.code===l.NxLocalizedErrorCode.LOCERR_SEARCH_TIMEOUT){e.emptyResult();e.showError(i)}if(i.code===l.NxLocalizedErrorCode.LOCERR_GENERIC_ABORTED)return;L.search.requestState=h.idle;L.search.searchTerms="";A.displayResult.data=false}this.callSearch(A.searchTerms,t).then(n,i)};this.callSearch=function(t,e){return A.app[g.data](C(true),t,e)};this.closeSearch=function(){if(A.isSmallDevice){B.emptyResult();A.query="";A.$broadcast("blurInput")}else F.toggleGlobalSearch(A.app)};this.suggest=function(t){if(0===t.length)return;var e=this;L.suggest.idCounter=L.suggest.idCounter+1;var n=L.suggest.idCounter;L.suggest.requestState=h.pending;L.suggest.suggestTerms=t;function i(t){if(b.getFlag("CAO_MOBILE")){var i=t.qFieldNames.map(function(t){return{qValue:t,qTerm:0}});t.qSuggestions=t.qSuggestions.concat(i)}L.suggest.suggestTerms="";if(M.isWhiteSpaceAt(A.query,A.query.length-1)||'"'===A.query.charAt(A.query.length-1))return;if(n===L.suggest.idCounter&&L.suggest.requestState===h.pending){M.transformSuggest(A,t,10);e.toogleSuggestions(A.suggestions.length>0);A.$broadcast("suggestShow",true,true)}L.suggest.requestState=h.idle}function a(t){t.code===l.NxLocalizedErrorCode.LOCERR_SEARCH_TIMEOUT&&(t.isHandled=true);if(t.code===l.NxLocalizedErrorCode.LOCERR_GENERIC_ABORTED)return;L.suggest.requestState=h.idle;L.suggest.suggestTerms=""}A.app.searchSuggest({},t).then(i,a)};this.select=function(t,e){A.$broadcast("blurInput");if(0===t.length||0===A.searchTermGroups.length)return;if(e<0){e=0;A.activeSelectIx=0}var n=[],i=[];M.getUnderlinersAndSearchTerms(A.query,n,i);var a=i;A.app.selectAssociations(C(),t,e).then(function(){A.isSearchHistoryFeature&&A.historyPermission&&m.createEntryInHistory(A,a)});this.emptyResult();A.query="";p.treatAsDesktop()&&!A.isSearchHistoryFeature&&A.$broadcast("focusInput")};this.setTestSearchTermGroups=function(t){A.searchTermGroups=t};this.onNavigateToSheet=function(t){var e=[],n=[];M.getUnderlinersAndSearchTerms(A.query,e,n);A.isSearchHistoryFeature&&A.historyPermission&&""!=A.query&&m.createEntryInHistory(A,n);if(p.treatAsDesktop()){B.emptyResult();A.query="";A.isSearchHistoryFeature?A.$broadcast("blurInput"):A.$broadcast("focusInput")}else $(function(){B.emptyResult();A.query=""},200);d.highlightedCell(t)};this.showMoreHitsForVisual=function(t){var e={qOffset:0,qCount:1,qGroupOptions:[{qGroupType:"GenericObjectsType",qOffset:t.itemIndex,qCount:1}],qGroupItemOptions:[{qGroupItemType:"GenericObject",qOffset:0,qCount:t.qItemMatches.length+15}]};return A.app[g.visuals]({qAttributes:["qProperty"]},A.searchTerms,e).then(function(e){M.showMore(e,t);return t})};this.showHistory=function(t){A.searchInputFocused=t};this.setQueryFromHistory=function(t){A.ignoreQueryChange=false;t>=0&&(A.query=A.searchHistory[t]);this.showHistory(false);A.$broadcast("focusInput");b.getFlag("CAO_MOBILE")&&A.query&&A.getInsightsCharts(A.query)};this.clearHistory=function(){m.clearSearchHistory(A);this.showHistory(false)};this.removeHistory=function(t){m.removeSingleHistory(A,t)}}return A}.apply(e,i),void 0!==a&&(t.exports=a))},874:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(184),n(49),n(221)],a=function(t,e,n){function i(i,a,s){var o,r,l=i.find("input")[0],c=t.getService("$document");o={preventDefault:false,allowInInput:true,delay:0};r={preventDefault:false,allowInInput:true,delay:75};a.focusState.ActiveStateChanged.bind(u);function u(){a.activeSelectIx=a.focusState.activeStateName===a.focusState.Results?0:-1;a.activeHistoryIx=a.focusState.activeStateName===a.focusState.History?0:-1;a.activeSuggestionIx=a.focusState.activeStateName===a.focusState.Suggestions?0:-1;a.activeVisualIx=a.focusState.activeStateName===a.focusState.Visuals?0:-1;a.$broadcast(a.focusState.activeStateName===a.focusState.Visuals?"visualsGroupFocus":"visualsGroupBlur")}function d(){return"INPUT"===c[0].activeElement.tagName}function p(){e.preventDefault();t.$rootScope.$apply()}function h(t){var e,n,i;if(document.selection&&document.selection.createRange){e=document.selection.createRange();n=e.getBookmark();i=n.charCodeAt(2)-2}else t.setSelectionRange&&(i=t.selectionStart);return i===t.value.length}function g(){d()?a.focusState.activeStateName===a.focusState.Suggestions?s.hideSuggestions():a.query?a.query="":a.close():a.close();p()}function f(){if(a.focusState.activeStateName===a.focusState.Suggestions){a.activeSuggestionIx=a.activeSuggestionIx>0?a.activeSuggestionIx-1:a.suggestions.length-1;p()}else if(a.focusState.activeStateName===a.focusState.Visuals){a.$broadcast("visualsGroupMoveActiveVisual",-1);p()}}function v(){if(a.focusState.activeStateName===a.focusState.Suggestions){a.activeSuggestionIx=(a.activeSuggestionIx+1)%a.suggestions.length;p()}else if(a.focusState.activeStateName===a.focusState.Visuals){a.$broadcast("visualsGroupMoveActiveVisual",1);p()}}function m(){var t=a.focusState.activeStateName;a.focusState.previous();if(t===a.focusState.activeStateName)switch(a.focusState.activeStateName){case a.focusState.History:a.activeHistoryIx=Math.max(-1,a.activeHistoryIx-1);break;case a.focusState.Results:s.moveActiveResult(-1);break}p()}function b(){var t=a.focusState.activeStateName;a.focusState.next();if(t===a.focusState.activeStateName)switch(a.focusState.activeStateName){case a.focusState.History:a.activeHistoryIx=Math.min(a.activeHistoryIx+1,a.searchHistory.length-1);break;case a.focusState.Results:s.moveActiveResult(1);break}p()}function S(t){switch(a.focusState.activeStateName){case a.focusState.History:s.setQueryFromHistory(a.activeHistoryIx);break;case a.focusState.Input:a.isPartials()?s.setShowPartialMatches():a.displaySuggestions?y(t,true):a.displayResult.data?n.getFlag("CAO_MOBILE")||s.select(a.searchTerms,0):s.showNoResultsMessage()&&a.haveUnlockedSelections()&&s.searchOutsideSelections();break;case a.focusState.Suggestions:y(t,true);break;case a.focusState.Visuals:a.$broadcast("selectActiveVisualItem");break;case a.focusState.Partials:s.setShowPartialMatches();break;case a.focusState.Results:a.showMeMoreFocus?s.loadNextPage():s.select(a.searchTerms,a.activeSelectIx);break;case a.focusState.StartNewSearch:s.searchOutsideSelections();break}n.getFlag("CAO_MOBILE")&&a.query&&a.getInsightsCharts(a.query);p()}function y(t,e){if(a.displaySuggestions&&(e||h(l))){a.activeSuggestionIx=-1===a.activeSuggestionIx?0:a.activeSuggestionIx;a.onSuggestSelect()}p()}function I(){s.closeSearch();p()}this.keyboardShortcutsGroup=e.createGroup("global-search-"+a.app.id,1);this.keyboardShortcutsGroup.registerKeys("esc",g,o);this.keyboardShortcutsGroup.registerKeys("left",f,r);this.keyboardShortcutsGroup.registerKeys("right",v,r);this.keyboardShortcutsGroup.registerKeys("up",m,r);this.keyboardShortcutsGroup.registerKeys("down",b,r);this.keyboardShortcutsGroup.registerKeys("enter",S,o);this.keyboardShortcutsGroup.registerKeys("tab",y,o);this.keyboardShortcutsGroup.registerKeys("ctrl+f",I,o);this.keyboardShortcutsGroup.on();this.on=function(){this.keyboardShortcutsGroup.on()};this.off=function(){this.keyboardShortcutsGroup.off()};this.delete=function(){this.keyboardShortcutsGroup.delete();a.focusState.ActiveStateChanged.unbind(u)}}return i}.apply(e,i),void 0!==a&&(t.exports=a))},875:function(t,e,n){"use strict";var i,a;!(i=[n(91)],a=function(t){function e(t){return t.libId?t.libIdLabel?t.libIdLabel:"Unknown master item":t.aggr?t.aggr+"("+t.field+")":t.field}function n(n,i){var a=i.filter(function(t){return void 0!==t}).length;var s=n&&n.filter(function(t){return Object.keys(t.msgParams).length===a});var o=null;s&&s.forEach(function(t){if(t.msgParams){var e=t.msgParams;var n=Object.keys(e);var a=true;n.forEach(function(t){var e=i.some(function(e){return e.slot&&e.slot===t});e||(a=false)});a&&(o=t)}});if(!o)return"";var r=[void 0,void 0,void 0,void 0,void 0];Object.keys(o.msgParams).forEach(function(t){var n=i.filter(function(e){return e.slot===t})[0];var a=e(n);r[o.msgParams[t]]=a});return t.get(o.msgId,r)}return{findTitleForChart:n}}.apply(e,i),void 0!==a&&(t.exports=a))},876:function(t,e,n){"use strict";var i,a;!(i=[n(89)],a=function(t){function e(t,e,n,i){this.chartId=t;this.searchReport=n;this.app=i;this.type="found";this.analysisPrecedentId="found";this.appearsOnSheets=e}e.prototype.getTitle=function(){var e=new t;this.app.getObject(this.chartId).then(function(t){t.getLayout().then(function(t){e.resolve(t.title)})});return e.promise};e.prototype.getMatchDetails=function(){var t=[];var e=this.chartId;if(this.searchReport.search){var n=this.searchReport.search["chartFinder-Title"].searchHits;Object.keys(n).forEach(function(i){if(i.includes(e)){var a=n[i].matchingTypes;a.forEach(function(e){t.push({matchedOn:n[i].title,matchedField:e})})}})}return t};e.prototype.getChartType=function(){var e=new t;this.app.getObject(this.chartId).then(function(t){t.getLayout().then(function(t){e.resolve(t.visualization)})});return e.promise};e.prototype.loadChart=function(e){var n=new t;e.getObject(this.chartId).then(function(t){t.getProperties().then(function(e){n.resolve({model:t,options:{interactionState:0,showTitles:false},properties:e})})});return n.promise};return e}.apply(e,i),void 0!==a&&(t.exports=a))},880:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(92),n(404),n(128),n(89),n(367),n(49),n(114),n(123),n(196)],a=function(t,e,n,i,a,s,o,r,l,c){var u=e.extend("CaoChartUiModel",{init:function e(n,i){this.app=i;this.zoomed=false;this.ObjectPlacementService=t.getService("qvObjectPlacementService");this.CaoChartService=t.getService("qvCaoChartService");this.$timeout=t.getService("$timeout");this.chart=n;this.object={};this.zoomedObject={};this.options={};this.zoomedOptions={};this.state="READY";this.modified=false;this.chartTypeImageUrl=void 0;this.chartType=void 0;this.rendered=false;this.renderedCount=0;this.insightFeedback=o.getFlag("CE_PRECEDENTS");this.interaction=true},updateState:function t(e){this.state=e},isHidden:function t(){if(this.isFound())return false;return this.insightFeedback&&this.chart.visualization.visualization.analysis.precedents&&this.chart.visualization.visualization.analysis.precedents.disliked||this.chart.invalidFromLearning},isRendered:function t(){return this.rendered},isFound:function t(){return"found"===this.chart.visualization.type},isGenerated:function t(){return"generated"===this.chart.visualization.type},isModified:function t(){return this.modified},setState:function t(e){this.state=e},setModified:function t(e){this.modified=e},setType:function t(e){this.chart.visualization.type=e},refreshChartType:function t(){var e=this;e.chart.visualization.getChartType().then(function(t){e.chartType=t;e.chartTypeImageUrl=n.getImageNameFromChartType(t)})},getTitle:function t(){return this.chart.visualization.getTitle().then(function(t){return t})},getComplexity:function t(){return this.chart.complexity},getRelevance:function t(){return this.chart.relevance},getMatchRecord:function t(){return this.chart.visualization.visualization.matchRecord},getState:function t(){return this.state},getModel:function t(){return this.chart.model},getObject:function t(){return this.zoomed?this.zoomedObject:this.object},getAnalysisPrecedentId:function t(){return this.chart.visualization.analysisPrecedentId},getMatchDetails:function t(){return this.chart.visualization.getMatchDetails()},getSheetsThisChartAppearsOn:function t(){return this.chart.visualization.appearsOnSheets},getMatches:function t(){return this.chart.visualization.visualization.matchRecord.matches},getFields:function t(){return this.getMatches().filter(function(t){return!t.slotRole})},getMeasures:function t(){return this.getMatches().filter(function(t){return t.slotRole===c.MEASURE})},getDimensions:function t(){return this.getMatches().filter(function(t){return t.slotRole===c.DIMENSION})},getChartType:function t(){return this.chart.visualization.visualization.analysis.analysis},getSearchReport:function t(){return this.chart.visualization.searchReport},getAnalysis:function t(){return this.chart.visualization.visualization.analysis},isObjectInvalid:function t(){return this.zoomed?this.zoomedObject.invalid:this.object.invalid},isViewDataToggled:function t(){return this.zoomed?this.zoomedObject.viewDataToggled:this.object.viewDataToggled},isDataViewSupported:function t(){return this.zoomed?this.zoomedObject.supportViewData&&this.zoomedObject.supportViewData():this.object.supportViewData&&this.object.supportViewData()},toggleDataView:function t(){if(this.zoomed)return this.zoomedObject.toggleDataView();return this.object.toggleDataView()},activateSelectionWatch:function t(e){this.object.selectionsApi.watchActivated(e)},deactivateSelectionWatch:function t(e){this.object.selectionsApi.watchDeactivated(e)},adaptChart:function t(e){var n=this;return this.CaoChartService.adaptRecommendation(n.chart.visualization.visualization,n.app).then(function(t){n.chart.visualization=new s({analysis:t.analysis,matchRecord:t.matchRecord},n.chart.visualization.searchReport,t.properties);delete n.rendered;n.isViewDataToggled()?n.toggleDataView().then(function(){n.shouldRedraw=true}):n.shouldRedraw=true;n.recalculateConfidence=e})},addToNewSheet:function t(){var e=this;return e.chart.model.getProperties().then(function(t){return e.ObjectPlacementService.addToNewSheet(t).then(function(t){e.setType("found");e.chart.visualization.appearsOnSheets.push(t.id);return t})})},addToSheet:function t(e){var n=this;return n.chart.model.getProperties().then(function(t){return n.ObjectPlacementService.addObjectToSheet(t,e,i.getModel()).then(function(t){n.setType("found");n.chart.visualization.appearsOnSheets.push(t.id);return t})})},setChartInteraction:function t(e){if(this.zoomed&&this.zoomedObject&&this.interaction!==e){this.interaction=e;e?this.zoomedObject.on():this.zoomedObject.off()}},setChartInteractionState:function t(e){this.options.interactionState=e},destroyChart:function t(){var e=this;if(e.zoomed){e.zoomed=false;return}if("LOADING"===e.state||"LOADED"===e.state){if(!e.rendered&&e.object&&e.object.subscription){e.rendered=false;e.object.cancel()}e.isGenerated()&&e.chart.model&&e.chart.model.id&&!e.zoomed?e.app.destroySessionObject(e.chart.model.id).then(function(){e.rendered=false;e.state="READY"}):e.state="READY"}},initializeOptions:function t(){this.options={};this.zoomedOptions={};this.options.isReadonly=false;this.options.isPopover=false;this.options.selectionsDisabled=true;this.options.interactionState=l.STATIC;this.options.direction=r.direction;this.zoomedOptions.isReadonly=false;this.zoomedOptions.isPopover=false;this.zoomedOptions.selectionsDisabled=false;this.zoomedOptions.interactionState=l.ANALYSIS;this.zoomedOptions.direction=r.direction},loadChart:function t(e){var n=this;var i=new a;var s;if(n.rendered){n.setState("LOADED");e();i.resolve()}else{n.initializeOptions();var o=n.chart.model?n.app.destroySessionObject(n.chart.model.id):a.when({});o.then(function(){n.chart.visualization.loadChart(n.app).then(function(t){n.object&&n.object.type&&(n.object.type=null);n.zoomedObject&&n.zoomedObject.type&&(n.zoomedObject.type=null);n.chart.model=t.model;n.state="LOADED";function a(){s&&n.$timeout.cancel(s)}var o=function t(){if(n.zoomed){n.renderedCount++;if(n.renderedCount<2)return}n.renderedCount=0;n.rendered=true;e&&e();n.state="LOADED";a();i.resolve()};n.options.onRendered=o;n.zoomedOptions.onRendered=o;var r=function t(){a();i.resolve()};n.options.onCanceled=r;n.zoomedOptions.onCanceled=r;s=n.$timeout(function(){if(!n.allowLongLoad&&!n.rendered&&n.object&&n.object.subscription){n.object.subscription.cancel();n.zoomedObject&&n.zoomedObject.subscription&&n.zoomedObject.subscription.cancel();n.state="MANUAL_LOAD";i.resolve()}},n.chart.suggestedTimeout)},function(){i.resolve()})})}return i.promise}});return u}.apply(e,i),void 0!==a&&(t.exports=a))},881:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={};Object.defineProperties(t,{idle:{value:0},pending:{value:1}});return t}.apply(e,i),void 0!==a&&(t.exports=a))},882:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={};Object.defineProperties(t,{data:{value:"searchResults"},visuals:{value:"searchObjects"},indexProgress:{value:"GetProgress"}});return t}.apply(e,i),void 0!==a&&(t.exports=a))},883:function(t,e,n){"use strict";var i,a;!(i=[n(102)],a=function(t){function e(n,i){var a=n[i];if(!(this instanceof e))throw new Error("FocusState needs to be called with the new keyword");if(!a)throw new Error("Invalid initialStateName provided");t.mixin(this);this.notification("ActiveStateChanged");Object.defineProperties(this,{initialState:{value:a},activeState:{configurable:true,value:a},activeStateName:{configurable:true,value:a.name}})}e.prototype.next=function(){var t=this.activeState;if(t.onBeforeNext&&!t.onBeforeNext())return;var e=t.next();while(e){if(!e.onBeforeEnter||e.onBeforeEnter()){n(this,e);return}e=e.next()}};e.prototype.previous=function(){var t=this.activeState;if(t.onBeforePrevious&&!t.onBeforePrevious())return;var e=t.previous();while(e){if(!e.onBeforeEnter||e.onBeforeEnter()){n(this,e);return}e=e.previous()}};e.prototype.reset=function(){n(this,this.initialState)};i(e,"Input");i(e,"Suggestions");i(e,"History");i(e,"Partials");i(e,"Visuals");i(e,"SuggestedCharts");i(e,"Results");i(e,"StartNewSearch");function n(t,e){Object.defineProperties(t,{activeState:{value:e},activeStateName:{value:e.name}});t.ActiveStateChanged.emit()}function i(t,e){var n={value:e};Object.defineProperty(t,e,n);Object.defineProperty(t.prototype,e,n)}return e}.apply(e,i),void 0!==a&&(t.exports=a))},884:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){function t(t,i,a){var s={};n(s,t.Input,{previous:function t(){return false},onBeforeNext:function t(){return!a.throbber.show},next:e.bind(s,t.Suggestions)});n(s,t.Suggestions,{onBeforeEnter:function t(){return!!a.displaySuggestions},previous:e.bind(s,t.Input),next:e.bind(s,t.History)});n(s,t.History,{onBeforeEnter:function t(){return a.isSearchHistoryFeature&&a.searchInputFocused&&0===a.query.length},onBeforeNext:function t(){return false},onBeforePrevious:function t(){return 0===a.activeHistoryIx},previous:e.bind(s,t.Suggestions),next:e.bind(s,t.Visuals)});n(s,t.Visuals,{onBeforeEnter:function t(){return a.isObjectsFeature&&a.displayResult.visuals&&!a.isSmallDeviceLandscape},previous:e.bind(s,t.History),next:e.bind(s,t.Partials)});n(s,t.Partials,{onBeforeEnter:function t(){return!!a.displayResult.data&&a.isPartials()},previous:e.bind(s,t.Visuals),next:e.bind(s,t.Results)});n(s,t.Results,{onBeforeEnter:function t(){return!!a.displayResult.data&&(!a.isPartials()||a.forcePartials)},onBeforeNext:function t(){return false},onBeforePrevious:function t(){return 0===a.activeSelectIx},previous:e.bind(s,t.Partials),next:e.bind(s,t.StartNewSearch)});n(s,t.StartNewSearch,{onBeforeEnter:function t(){return i.showNoResultsMessage()&&a.haveUnlockedSelections()},previous:e.bind(s,t.Results),next:function t(){return false}});return s}function e(t){var e=this[t];if(!e)throw new Error("Invalid stateName provided");return e}function n(t,e,n){if(t[e])throw new Error("State with name '"+e+"' already exists");n.name=e;t[e]=n}return t}.apply(e,i),void 0!==a&&(t.exports=a))},885:function(t,e,n){"use strict";var i,a;!(i=[n(54),n(886)],a=function(t,e){function n(t){return t.app.id+"."+t.userID+".smartSearch.history"}function i(t){t.storage=r(t);if("NONE"==t.storage)return;var e=n(t);if(t.storage.contains(e)){var i=g(t.storage.get(e));return i}}function a(t,e){var i=n(t),a=[],s=[];if(t.storage.contains(i)){a=t.storage.get(i);s=l(e);var o=c(s,a);var r=g(o);t.storage.set(i,o);t.searchHistory=r}else{s=l(e);a.unshift(s);t.storage.set(i,a);var u=g(a);t.searchHistory=u}}function s(t){var e=n(t);if(t.storage.contains(e)){t.searchHistory=[];t.storage.remove(e)}}function o(t,e){var i=n(t);if(t.storage.contains(i)){var a=t.storage.get(i);a.splice(e,1);t.storage.set(i,a);var s=g(a);t.searchHistory=s}}function r(t){if("DESKTOP"==t.userID){t.historyPermission=true;return e}if(t.userID&&"anonymous"!=t.userID.substring(0,9)){t.historyPermission=true;return e}t.historyPermission=false;return"NONE"}function l(t){return t.map(function(t){return t.startQuote&&t.endQuote?t.string='"'+t.string+'"':t.string})}function c(t,e){var n=d(e);var i=p(t);var a=h(n,i);var s=[];if(a>=0){e.splice(a,1);e.unshift(t);s=u(e)}else{e.unshift(t);s=u(e)}return s}function u(t){t.length>4&&(t.length=4);return t}function d(t){function e(t){return t.toLowerCase()}return t.map(function(t){return t.map(e)})}function p(t){return t.map(function(t){return t.toLowerCase()})}function h(e,n){for(var i=0;i<e.length;i++)if(t.isEqual(e[i],n))return i}function g(t){return t.map(function(t){return t.join(" ")})}return{initHistory:i,createEntryInHistory:a,clearSearchHistory:s,removeSingleHistory:o,getStoragePath:n}}.apply(e,i),void 0!==a&&(t.exports=a))},886:function(t,e,n){"use strict";var i,a;!(i=[n(54),n(118)],a=function(t,e){var n="sessionstorageservice";function i(e){if(!t.isString(e))throw new Error('The key "'+e+'" is not a String.');return n+"."+e}function a(e,n,a){var s=(new Date).getTime(),o,r;if(!t.isString(e))throw new Error('The key "'+e+'" is not a String.');if(!t.isObject(n))throw new Error('The value "'+n+'" for the key "'+e+'" is not valid object.');if(a){if(!t.isNumber(a))throw new Error('The time to live value "'+a+'" is not numeric.');a+=s}r={timeToLive:a,value:n};o=JSON.stringify(r);sessionStorage[i(e)]=o}function s(e){if(!t.isString(e))throw new Error('The key "'+e+'" is not a String.');var n=t.isEmpty(sessionStorage[i(e)]);return!n}function o(e,n){if(!t.isString(e))throw new Error('The key "'+e+'" is not a String.');if(!s(e)){if(void 0!==n)return n;throw new Error('There is no data set for the key "'+e+'". Please use contains() first to verify you should actually do a get().')}var i=r(e);return i.value}function r(t){var e=JSON.parse(sessionStorage[i(t)]);return e}function l(e){if(!t.isString(e))throw new Error('The key "'+e+'" is not a String.');if(!s(e))throw new Error('There is no data set for the key "'+e+'". Please use contains() first to verify you should actually do a get().');delete sessionStorage[i(e)]}function c(){var i,a,s;for(i in sessionStorage)if(e.startsWith(i,n)){i=i.substring(n.length+1);a=r(i);s=(new Date).getTime();t.isNumber(a.timeToLive&&s>a.timeToLive)&&l(i)}}return{set:a,get:o,contains:s,clean:c,remove:l}}.apply(e,i),void 0!==a&&(t.exports=a))},887:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(91),n(90),n(888),n(889),n(139),n(96),n(99),n(169)],a=function(t,e,n,i,a,s,o,r,l){var c=null;function u(t,e){var n;if(t.length!==e.length)return false;for(n=0;n<t.length;++n)if(t[n]!==e[n])return false;return true}e.directive("qvGlobalSearchInput",["$timeout","qvGlobalSearchDataService",function(s,o){return{restrict:"E",replace:true,template:a,require:"^qvGlobalSearch",link:function a(d,p,h,g){var f=p.find("input"),v=[],m=e.getService("$document");f.on("keydown",function(){d.ignoreQueryChange=false});d.$watch("isSelectActiveInSmallDevice",function(t){d.autoFocus=!i.isIos()&&!i.isAndroid()&&!t});d.placeholder=n.get("GlobalSearch.SearchData");function b(e){if(d.isInputFocused){if(1===t(e.target).closest(".qv-global-search-suggest").length||1===t(e.target).closest(".qv-search-last-history").length)return;e.preventDefault();e.stopPropagation();r.preventGestures(this.gestureHandler);d.$apply(function(){g.hideSuggestions();g.hideSoftKeyboard()})}}d.isObjectsFeature&&!l.treatAsDesktop()&&p.on("qv-outside",b);d.$watch("query",function(t){var e=[],n,i;s.cancel(c);g.showHistory(d.isSearchHistoryFeature&&d.isInputFocused&&0===d.query.length);d.ignoreQueryChange||g.resetSuggestions();if(!t||0===t.length){g.emptyResult();d.underlines.length=0;v=[];return}o.getUnderlinersAndSearchTerms(t,d.underlines,e);if(d.ignoreQueryChange){d.ignoreQueryChange=false;return}c=s(function(){if(o.isWhiteSpaceAt(t,t.length-1)||'"'===t.charAt(t.length-1))g.hideSuggestions();else{i=o.getSuggestTerms(t,e);g.suggest(i)}n=e.map(function(t){return t.string});if(e.length>0&&!u(n,v)){g.searchVisuals(n);g.search(n)}else t.length<o.getMinQueryLength()&&g.emptyResult();v=n;c=null},200)});d.$watch("isInputFocused",function(t){d.isSmallDevice&&(t?m.find("body").animate({scrollTop:p.offset().top},100):d.isObjectsFeature&&r.utils.touch&&g.hideSuggestions());d.isSearchHistoryFeature&&t&&0===d.query.length&&g.showHistory(true)});d.$on("focusInput",function(){f.focus()});d.$on("blurInput",function(){f.blur()});d.$on("$destroy",function(){f.off()})}}}]);e.directive("qvGlobalSearchInputHint",["qvGlobalSearchDataService",function(t){return{restrict:"E",replace:true,template:s,require:"^qvGlobalSearch",link:function e(n){function i(){var e=n.suggestions[-1===n.activeSuggestionIx?0:n.activeSuggestionIx],i=[],a=[],s,r,l,c,u;t.getUnderlinersAndSearchTerms(n.query,i,a);s=t.getSuggestTerms(n.query,a);if(!n.displaySuggestions||n.suggestions.length<=0||0===s.length)return;r=t.getUnderlineLengthFromTermIx(i,e.term);c=i.slice(r).reduce(function(t,e){return t+(e.isWhitespace?" ":e.string)},"");l=o.string(c).length;c=o.string(e.value).slice(0,l);u=o.string(e.value).slice(l);n.ignoreQueryChange=true;n.hintString=u}n.$watch("activeSuggestionIx",function(){i()});n.$watchCollection("suggestions",function(){i()});n.$watch("displaySuggestions",function(){i()})}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},888:function(t,e){t.exports='<div class="qv-search-input" ng-class="{\'focus\': isInputFocused}">\n\t<div class="search-field-area">\n\t\t<lui-search class="search-field" query="query" auto-focus="autoFocus" autocomplete="\'off\'" is-focused="isInputFocused" tid="globalSearch.searchField" placeholder="{{placeholder}}" />\n\t</div>\n\t<div class="search-underlines">\n\t\t<span ng-repeat="underline in underlines" class="underline" ng-class="underline.isWhitespace ? \'term-space\' : \'term\' + underline.colorIx">{{underline.string}}</span><qv-global-search-input-hint></qv-global-search-input-hint>\n\t</div>\n</div>\n'},889:function(t,e){t.exports='<span ng-show="displaySuggestions" class="search-suggest" tid="globalSearch.suggestionString">{{hintString}}</span>\n'},890:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(891),n(892),n(893),n(96),n(99),n(49),n(370),n(895)],a=function(t,e,n,i,a,s,o){var r={INITIAL:0,VISUALS_DOCKED:1,DATA_DOCKED:2};t.directive("qvGlobalSearchResult",["$timeout",function(t){return{restrict:"E",template:e,replace:true,require:["^qvGlobalSearch","qvGlobalSearchResult"],controller:function t(){this.getElement=function(){};this.setDockState=function(){}},link:function e(n,i,l,c){var u=c[0],d=c[1],p,h,g=function e(){var a=this,o=0;s.treatAsDesktop()&&!h&&(h=i.find(".qv-smartsearch-visuals-group"));t(function(){if(h&&h.length){o=h[0].offsetTop+h[0].offsetHeight-33;n.fixedbar=a.scrollTop>o}n.scrollShow=a.scrollHeight-a.scrollTop>a.clientHeight})},f=!s.treatAsDesktop()&&n.isObjectsFeature?i.find(".data-container"):i;n.dockState=r.INITIAL;n.caoMobile=o.getFlag("CAO_MOBILE");n.emptyMessageEnabled=false;n.fixedbar=false;n.classes={"qv-global-search-result-throbber-open":n.activity.show,"with-objects":n.isObjectsFeature&&!n.isSmallDeviceLandscape};n.$watch("isObjectsFeature && !isSmallDeviceLandscape",function(t){n.classes["with-objects"]=t});n.$watch("activity.show",function(t){n.classes["qv-global-search-result-throbber-open"]=t});n.$watch(function(){return n.showNoResultsMessage()},function(t){n.classes["noresults"]=t});n.select=function e(i,s){if(a.utils.touch){n.activeResultIx=s;t(function(){u.select(n.searchTerms,i.qId)},100)}else u.select(n.searchTerms,i.qId)};n.loadNextPage=function t(){u.loadNextPage()};d.getElement=function(){return i};d.setDockState=function(e){t(function(){n.dockState=e;n.classes["visuals-docked"]=e===r.VISUALS_DOCKED;n.classes["data-docked"]=e===r.DATA_DOCKED})};n.setShowPartialMatches=function(){u.setShowPartialMatches()};n.showNoResultsMessage=function(){var t;t=n.caoMobile?n.emptyMessageEnabled&&n.searchTerms.length>0&&!n.displayResult.data&&!n.error.show&&!n.activity.show&&0===n.insightVisualsGroups.length&&!n.fetchingInsightChartsPending||n.error.show:n.emptyMessageEnabled&&n.searchTerms.length>0&&!n.displayResult.data&&!n.error.show&&!n.activity.show||n.error.show;return t};u.showNoResultsMessage=function(){return n.showNoResultsMessage()};n.resetDockState=function(){n.dockState=r.INITIAL;s.treatAsDesktop()&&f.animate({scrollTop:0},300,"swing")};p=n.$watch(function(){return f[0]&&f[0].scrollHeight?f[0].scrollHeight:0},function(t){t&&(n.scrollShow=t>f[0].clientHeight)});f.on("scroll",g);n.$on("resultScrollToTop",function(){i[0].scrollTop=0});n.$on("$destroy",function(){p();f.off("scroll",g)})}}}]);t.directive("qvScrollToActive",function(){return{restrict:"A",require:"^qvGlobalSearchResult",link:function t(e,n,i,a){i.$observe("qvScrollToActive",function(t){t=t+""==="true";n.toggleClass("active",t);if(t){var e=a.getElement(),i=n.position();i.top<0?e[0].scrollTop=n[0].offsetTop:i.top+n.height()>e.height()&&n[0].scrollIntoView(false)}})}}});t.directive("qvGlobalSearchResultMsg",function(){return{restrict:"E",template:n,replace:true,require:["^qvGlobalSearch","^qvGlobalSearchResult"],link:function t(e){e.capUnderlineMaxNumber=6}}});t.directive("qvGlobalSearchNoResults",function(){return{restrict:"E",template:i,replace:true,require:["^qvGlobalSearch","^qvGlobalSearchResult"],link:function t(){}}})}.apply(e,i),void 0!==a&&(t.exports=a))},891:function(t,e){t.exports='<div class="qv-global-search-result" ng-class="classes" >\n\n\t<qv-global-search-suggest ng-if="displaySuggestions" class="qv-global-search-suggest" qv-scroll-to-active="{{activeSelectIx === -1 && focusState.activeStateName === focusState.Suggestions}}"></qv-global-search-suggest>\n\n\t<h3 ng-if="isObjectsFeature && ( displayResult.data || showNoResultsMessage() ) && matches.length > 0" class="title-section title-selections" >\n\t\t<span q-translation="GlobalSearch.Selections"></span>\n\t\t<i ng-click="resetDockState();" class="lui-icon lui-icon--arrow-up"></i>\n\t</h3>\n\n\t<qv-global-search-no-results class="search-no-results-message" ng-show="showNoResultsMessage()" ></qv-global-search-no-results>\n\n\t<div ng-if="(outsideSelection || currentSelections) && (!isPartials() || forcePartials)" class="qv-global-search-result-title strong" >\n\t\t<span ng-if="outsideSelection && !currentSelections" tid="globalSearch.matchesWholeDataset" q-translation="GlobalSearch.MatchesWholeDataset"></span>\n\t\t<span ng-if="currentSelections" tid="globalSearch.addToYourSelections" q-translation="GlobalSearch.AddToYourSelections"></span>\n\t</div>\n\n\t<div ng-repeat="m in matches" class="data-matches-group" ng-if="(!isPartials() || forcePartials)">\n\n\t\t<div ng-if="m !== searchTerms.length" class="caption-flex" q-translation="GlobalSearch.MatchedSearchTerms,{{m}}"></div>\n\n\t\t<div class="content-flex" ng-init="parentIndex = $index" ng-class="{ \'touch-off\':!isSmallDevice }" ng-repeat="row in getSearchTermGroup(m)" qv-scroll-to-active="{{( row.qId === activeSelectIx) && focusState.activeStateName === focusState.Results }}" tid="globalSearch.resultGroup" >\n\n\t\t\t<div class="cell" ng-repeat="item in row.qItems" tid="globalSearch.resultField" ng-class="{ \'maxcell\': !$last && !$first, \'maxcellfirst\': ($first && row.qTotalNumberOfItems > 1) }" >\n\t\t\t\t<div class="group-hits" ng-click="select( row, $parentIndex )" ng-class="{ \'shown\': (item.qTotalNumberOfMatches-item.qItemMatches.length) > 0  }">\n\t\t\t\t\t<span class="field-name" tid="globalSearch.resultField.Name">{{item.qIdentifier}}</span>\n\t\t\t\t\t<span ng-repeat="hit in item.qItemMatches" tid="globalSearch.resultField.Hit">\n\t\t\t\t\t\t<qv-global-search-highlights q-text="hit.qText" q-ranges="hit.qRanges"></qv-global-search-highlights >\n\t\t\t\t\t\t<span>{{$last ? \'\' : \', \'}}</span>\n\t\t\t\t\t</span>\n\t\t\t\t\t<div tid="globalSearch.resultField.MoreHits" ng-if="item.qTotalNumberOfMatches-item.qItemMatches.length > 0" ng-click="onShowMoreHits($event, item, row.qId)" class="more-hits"><span class="more-text" q-translation="GlobalSearch.MoreResults,{{(item.qTotalNumberOfMatches-item.qItemMatches.length)}}"></span></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="more-hits-area-mobile" ng-if="item.qTotalNumberOfMatches-item.qItemMatches.length > 0" tid="globalSearch.resultField.MoreHitsMobile" ng-click="onShowMoreHits($event, item, row.qId)">\n\t\t\t\t\t<button class="lui-button lui-button--rounded">\n\t\t\t\t\t\t<span class="lui-button__icon lui-icon lui-icon--more"></span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div ng-hide="matches.length === 0" qv-scroll-to-active="{{showMeMoreFocus}}" class="show-me-more"><button ng-if="paging.totalRows > paging.lastRowIx && (!isPartials() || forcePartials)" tid="globalSearch.showmemore" ng-click="loadNextPage($event)" class="lui-button" q-translation="GlobalSearch.ShowMeMore" ng-class="{\'lui-active\': showMeMoreFocus }"></button></div>\n\n\t<h3 class="title-section title-navigation" ng-if="displayResult.visuals && !isSmallDeviceLandscape" qv-scroll-to-active="{{focusState.activeStateName === focusState.Visuals}}">\n\t\t<span ng-if="!caoMobile" q-translation="GlobalSearch.Navigations"></span>\n\t\t<span ng-if="caoMobile">{{existingChartGroupTitle}}</span>\n\t\t<i ng-click="resetDockState();" class="lui-icon lui-icon--arrow-down"></i>\n\t</h3>\n\n\t<h3 class="title-section title-landscape" ng-if="displayResult.visuals && isSmallDeviceLandscape">\n\t\t<span class="lui-icon lui-icon--object"></span>\n\t\t<span q-translation="GlobalSearch.RotateForVisuals"></span>\n  </h3>\n  \n\t<qv-smartsearch-visuals-group tid="smartsearch-visuals-group" items="searchVisualsGroups" app="app" search-terms="searchTerms" options="{\'preload\': false}" ng-if="displayResult.visuals " ng-hide="isSmallDeviceLandscape"></qv-smartsearch-visuals-group>\n\n\t<h3 class="title-section title-navigation"\n\t\tng-if="insightVisualsGroups.length > 0 && caoMobile && !isSmallDeviceLandscape"\n\t\tqv-scroll-to-active="{{focusState.activeStateName === focusState.SuggestedCharts}}">\n\t\t<span tid="global.search.suggested.charts.title">{{suggestedChartGroupTitle}}</span>\n\t\t<i ng-click="resetDockState();" class="lui-icon lui-icon--arrow-down"></i>\n  </h3>\n  \n  <div class="insight-charts-unavailable" ng-if="unableTofetchInsightCharts === true" q-translation="GlobalSearch.SuggestedChartsUnavailable"></div>\n\t\n\t<div ng-if="isPartials()" qv-scroll-to-active="{{ focusState.activeStateName === focusState.Partials }}" class="qv-global-search-result-message search-partials-message">\n\t\t<qv-global-search-result-msg></qv-global-search-result-msg>\n\t\t<div>\n\t\t\t<button class="lui-button" ng-click="setShowPartialMatches($event)" tid="globalSearch.showPartialMatches" q-translation="{{ !forcePartials?\'GlobalSearch.ShowPartialMatches\' : \'GlobalSearch.HidePartialMatches\' }}"\n\t\t\t ng-class="{ \'lui-active\': focusState.activeStateName === focusState.Partials }"></button>\n\t\t</div>\n\t</div>\n\n\t<qv-smartsearch-visuals-group tid="smartsearch-visuals-group" items="insightVisualsGroups" app="app" search-terms="searchTerms" options="{\'preload\': false}" ng-if="insightVisualsGroups.length > 0 && caoMobile" ng-hide="isSmallDeviceLandscape"></qv-smartsearch-visuals-group>\n\n\t<div class="fixed-bar" ng-show="fixedbar">\n\t\t<span ng-click="resetDockState();" class="lui-fade-button">\n\t\t\t<span class="lui-fade-button__icon lui-icon lui-icon--arrow-down"></span>\n\t\t</span>\n\t</div>\n\n\t<qv-global-search-throbber></qv-global-search-throbber>\n</div>\n'},892:function(t,e){t.exports='<div class="qv-global-search-result-message-inline">\n    <span ng-if="currentSelections" q-translation="GlobalSearch.NoMatchesWithinCurrentSelection"></span>\n    <span ng-if="!currentSelections" q-translation="GlobalSearch.NoMatchesForYourTerms"></span>\n</div>'},893:function(t,e){t.exports='<div>\n    <div class="qv-global-search-result-groups" ng-if="!error.show">\n\n        <div class="qv-global-search-result-message" >            \n            <qv-global-search-result-msg></qv-global-search-result-msg>\n\n            <div ng-if="haveUnlockedSelections()">\n                <button class="lui-button qv-gs-new-search-button" qva-activate="searchOutsideSelections($event)" tid="globalSearch.newSearchJustFor"\n\t\t\t\t\t\tq-translation="GlobalSearch.ClearSelectionAndSearchAgain" q-title-translation="GlobalSearch.ClearSelectionAndSearchAgain"\n\t\t\t\t\t\tng-class="{ \'lui-active\': focusState.activeStateName === focusState.StartNewSearch }"></button>\n            </div>\n        </div>\n    </div>      \n\n    <div class="qv-global-search-result-error" ng-if="error.show">\n        <span q-translation="{{error.translation}}"></span>\n    </div>\n</div>'},894:function(t,e){t.exports="<span ng-repeat=\"slice in slices track by $index\" ng-class=\"slice.highlight ? 'highlighted' + slice.qTerm : ''\">{{slice.qSliceText}}</span>"},895:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(896),n(50),n(97),n(897),n(899),n(371)],a=function(t,e,n,i){var a={MAX_MOBILE_VISUALS:10,PAGE_VISUALS:3,PAGE_VISUALS_PORTRAIT:2,PADDING_PAGES:15};t.directive("qvSmartsearchVisualsGroup",["$timeout",function(t){return{restrict:"E",template:e,replace:true,scope:{items:"=",searchTerms:"=",options:"=",app:"="},controller:function t(){this.loadPage=function(){};this.preparePages=function(){}},link:function e(s,o,r,l){var c=0;s.pageIndex=0;s.activeVisualIx=-1;s.pages=[];s.objects=null;var u=o.find(".visuals-wrapper"),d=false,p=n.isSmallDevice?400:600,h=function t(){p=n.isSmallDevice?400:600;u[0].scrollLeft=s.pageIndex*(u[0].offsetWidth+a.PADDING_PAGES)},g=function t(){l.preparePages(s.items[0].qItems)};n.OrientationChanged.bind(g);n.ViewChanged.bind(g);s.setPageIndex=function(t){s.pageIndex=t;for(var e=0;e<s.pages.length;e++)s.pages[e].forEach(function(n){s.options.preload?n.load=e===t||e===t+1||e===t-1:n.load=e===t})};i.on("update",h);s.goToPage=function(t){l.loadPage(t)};s.onSwipePage=function(t){l.loadPage(s.pageIndex+t)};s.$watch("items",function(t){t&&t.length&&l.preparePages(t[0].qItems)});s.$on("visualsGroupMoveActiveVisual",function(t,e){if(d)return;var n=s.pages.reduce(function(t,e){return t+e.length},0),i,a;i=s.activeVisualIx>0||e>0?(s.activeVisualIx+e)%n:n-1;a=Math.floor(i/c);a!==s.pageIndex&&l.loadPage(a);s.activeVisualIx=i});s.$on("visualsGroupBlur",function(){s.activeVisualIx=-1});s.$on("visualsGroupFocus",function(){s.activeVisualIx=0;0!==s.pageIndex&&l.loadPage(0)});s.$on("$destroy",function(){i.off("update",h);n.OrientationChanged.unbind(g);n.ViewChanged.unbind(g)});l.loadPage=function(e){if(!d&&e>=0&&e<s.pages.length){d=true;u.animate({scrollLeft:e*(u[0].offsetWidth+a.PADDING_PAGES)},p,"swing",function(){d=false;t(function(){s.setPageIndex(e)})})}};l.preparePages=function(t){if(t){f();var e,i=0,o=[];n.orientation===n.Orientation.landscape?e=n.isSmallDevice?1:a.PAGE_VISUALS:n.orientation===n.Orientation.portrait&&(e=n.isSmallDevice?1:a.PAGE_VISUALS_PORTRAIT);c=e;for(var r=0;r<t.length;r++){if(n.isSmallDevice&&o.length>=a.MAX_MOBILE_VISUALS&&o[i].length>=e)break;if(o[i]){if(o[i].length>=e){i++;o.push([])}}else o.push([]);t[r].itemIndex=r;t[r].load=s.options.preload?0===i||1===i:0===i;o[i].push(t[r])}s.pages=o}};function f(){s.pages=[];u.scrollLeft(0);s.pageIndex=0}}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},896:function(t,e){t.exports='<div class="qv-smartsearch-visuals-group" qva-smart-search-swipe-horizontal="onSwipePage(delta)" >\n\t<div class="nav-visual-arrow left" qva-activate="goToPage( pageIndex - 1 );" ng-show="pageIndex > 0">\n\t\t<span class="lui-fade-button">\n\t\t\t<span class="lui-fade-button__icon  lui-icon lui-icon--arrow-left"></span>\n\t\t</span>\n\t</div>\n\t<div class="visuals-wrapper" >\n\t\t<div class="page" tid="swipeable-chart-page-container" ng-repeat="p in pages" ng-class="{ \'first\': $first, \'last\': $last }">\n\t\t\t<div class="content" >\n\t\t\t\t<qv-smartsearch-visual-preview\n\t\t\t\t\tng-repeat="visualItem in p"\n\t\t\t\t\tapp="app"\n\t\t\t\t\tactive-visual-ix="activeVisualIx"\n\t\t\t\t\tvisual-object="visualItem"\n\t\t\t\t\tsearch-terms="searchTerms"\n\t\t\t\t\tng-class="{ \'first\': $first && !$last, \'last\': $last, \'active\': focusState.activeStateName === focusState.Suggestions && activeVisualIx === visualItem.itemIndex }">\n\t\t\t\t</qv-smartsearch-visual-preview>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="nav-visual-arrow right" qva-activate="goToPage( pageIndex + 1 );" ng-show="pageIndex < (pages.length - 1)">\n\t\t<span class="lui-fade-button">\n\t\t\t<span class="lui-fade-button__icon  lui-icon lui-icon--arrow-right"></span>\n\t\t</span>\n\t</div>\n\n\t<qv-global-search-more-indicator pages="pages" active-page-ix="pageIndex" on-page-change="goToPage(index);"></qv-global-search-more-indicator>\n</div>'},897:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(54),n(95),n(105),n(898),n(89),n(114),n(123),n(370),n(169),n(267)],a=function(t,e,n,i,a,s,o,r){t.directive("qvSmartsearchVisualPreview",["$timeout",function(l){var c={TITLE:0,SUBTITLE:1,FOOTNOTE:2,DIMENSION:3,MEASURE:4,ALTERNATIVE_DIMENSION:5,ALTERNATIVE_MEASURE:6,TYPE:7,VALUE:8};function u(t,e){return e.getObject(t.qIdentifier).then(function(t){return{model:t,options:{isReadonly:true,isPopover:false,selectionsDisabled:true,interactionState:r.STATIC,components:{miniChart:{show:false},scrollArea:{showFlag:0}},direction:o.direction}}})}function d(t){var e=t.split("/");e=e.map(function(t){return parseInt(t)}).filter(function(t){return!Number.isNaN(+t)});return e.length?e[0]:-1}function p(t,e){t.id=-1;if(-1!==e.indexOf("qDimensions")||-1!==e.indexOf("qListObjectDef/qDef")){t.id=d(e);t.type=-1===e.indexOf("qLayoutExclude")?c.DIMENSION:c.ALTERNATIVE_DIMENSION;t.isLabel=-1!==e.indexOf("qFieldLabels")}else if(-1!==e.indexOf("qMeasures")){t.id=d(e);t.type=-1===e.indexOf("qLayoutExclude")?c.MEASURE:c.ALTERNATIVE_MEASURE;t.isLabel=-1!==e.indexOf("qLabel")}else{-1!==e.indexOf("subtitle")?t.type=c.SUBTITLE:-1!==e.indexOf("title")?t.type=c.TITLE:-1!==e.indexOf("footnote")?t.type=c.FOOTNOTE:-1!==e.indexOf("type")?t.type=c.TYPE:t.type=c.VALUE;t.isLabel=-1===e.indexOf("qExpr")}t.trans=h(t.type)}function h(t){var e="---";switch(t){case c.TITLE:e="Common.Title";break;case c.DIMENSION:e="Common.Dimensions";break;case c.MEASURE:e="Common.Measures";break;case c.ALTERNATIVE_DIMENSION:e="properties.alternative.dimensions";break;case c.ALTERNATIVE_MEASURE:e="properties.alternative.measures";break;case c.SUBTITLE:e="properties.subtitle";break;case c.FOOTNOTE:e="properties.footnote";break;case c.TYPE:e="properties.type";break;case c.VALUE:e="properties.dataPoints.labelmode.value";break}return e}return{restrict:"E",template:a,replace:true,require:["^qvGlobalSearch"],scope:{visualObject:"=",searchTerms:"=",activeVisualIx:"=",app:"="},link:function a(c,d,h,g){var f=t.getService("$navigationService").Sheets,v=t.getService("qvGlobalSearchDataService").getMaxColorsNum(),m=g[0],b;c.viz=null;c.termsMatched=null;c.extra=false;c.matches=null;c.loadManually=function(t){t.stopPropagation();c.viz.object.retry();c.isManualLoad=false};function S(){c.loadTimer=l(function(){if(c.viz.object){c.viz.object.cancel();c.isManualLoad=true}},c.visualObject.suggestedTimeout);c.viz.options.onRendered=function(){c.loadTimer&&l.cancel(c.loadTimer)}}c.$watch("visualObject.load",function(t){if(true===t){I();if(b)c.viz=b;else{u(c.visualObject,c.app).then(function(t){b=t;c.viz=t;c.viz.object={};c.visualObject.suggestedTimeout&&S()});x(c.visualObject.qItemMatches)}}else c.viz=null});c.$watch("searchTerms",function(t){t&&c.visualObject&&I()});c.$on("selectActiveVisualItem",function(){c.activeVisualIx===c.visualObject.itemIndex&&y()});c.$on("$destroy",function(){b=null});c.showMoreHits=function(t){t.stopPropagation();m.showMoreHitsForVisual(c.visualObject).then(function(t){x(t.qItemMatches)})};function y(t){var e=function t(e){e=e.filter(function(t){return t});return e.length?e[0]:null};w().then(function(a){var s=e(a);if(s){f.navigateToSheet(s.sheet);m.onNavigateToSheet(s.cell.name)}else if(t){var l={isReadonly:true,isPopover:false,selectionsDisabled:true,interactionState:r.ANALYSIS,components:{miniChart:{show:true},scrollArea:{showFlag:1}},direction:o.direction};n.publish(i.Events.PubSub.ExpandSmartSearchSuggestedChart,Object.assign({},t,{options:l}))}})}function I(){c.termsMatched=c.visualObject.qSearchTermsMatched.map(function(t){return{string:c.searchTerms[t],pos:t%v}})}function x(t){c.hitsDisplayed=t.length;var n,i,a;t.forEach(function(t){t.qAttributes&&t.qAttributes.length&&p(t,t.qAttributes[0][1])});n=c.visualObject.qItemMatches.filter(function(e){if(e.isLabel)return true;var n=t.filter(function(t){return t.isLabel&&e.type===t.type&&e.id===t.id&&e!==t});var i=e.qRanges.every(function(t){return n.some(function(e){return e.qRanges.some(function(e){return t.qTerm===e.qTerm})})});return!i});i=e.groupBy(n,function(t){return t.type});a=Object.keys(i).map(function(t){return i[t]});c.matches?a.forEach(function(t,e){if(t.length>c.matches[e].length){var n=c.matches[e].length;for(var i=n;i<t.length;i++)c.matches[e].push(t[i])}}):c.matches=a}function q(t,e,n){var i={sheet:t,cell:e};return e.name===c.visualObject.qIdentifier?s.resolve(i):"filterpane"===e.type?n.getObject(e.name).then(function(t){return t.getLayout().then(function(t){if(t.qChildList&&t.qChildList.qItems.length){var e=t.qChildList.qItems.filter(function(t){return t.qInfo.qId===c.visualObject.qIdentifier});return e.length?i:null}return null})}):s.resolve(null)}function w(){var t,e=[];for(var n=0;n<f.all.mashed.length;n++){t=f.all.mashed[n];for(var i=0;i<t.qData.cells.length;i++)e.push(q(t,t.qData.cells[i],c.app))}return s.all(e)}c.showExtraInfo=function(t){c.extra=!c.extra&&c.matches.length;t.stopPropagation()};c.navigateToSheet=function(t,e){if(!c.isManualLoad){t.stopPropagation();y(e)}}}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},898:function(t,e){t.exports='<div class="visual-item">\n\t<div class="object" qva-activate="navigateToSheet($event, viz)" >\n\t\t<qv-object ng-if="viz && visualObject.load" model="viz.model" options="viz.options" object="viz.object"></qv-object>\n\t\t<div class="transparent-overlay"></div>\n\t\t<div ng-hide="visualObject.load" class="qv-animate progress">\n\t\t\t<div class="progress-loader"></div>\n\t\t</div>\n\t\t<div class="cao-mobile-manual-loader" ng-click="$event.stopPropagation()" ng-if="isManualLoad">\n\t\t\t<ul>\n\t\t\t\t<li class="cao-mobile-loader-text" q-translation="cao.card.complex">\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<lui-button ng-click="loadManually($event)" q-translation="cao.card.complex.load"></lui-button>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n\t<div class="visual-data" qva-activate="showExtraInfo($event);">\n\t\t<div ng-if="visualObject.load" class="keywords">\n\t\t\t<div class="terms">\n\t\t\t\t<span ng-repeat="t in termsMatched"><span ng-if="!$first">&nbsp;</span><span class="highlighted{{t.pos}}">{{t.string}}</span></span>\n\t\t\t</div>\n\t\t\t<div class="lui-fade-button" ng-if="matches.length" tid="swipeableChartPageInfoButton">\n\t\t\t\t<span class="lui-fade-button__icon lui-icon lui-icon--info"></span>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="extra-info" ng-if="visualObject.load" ng-class="{ \'show\': extra }">\n\t\t\t<div ng-if="matches.length" ng-repeat="hits in matches" class="hits">\n\t\t\t\t<div ng-repeat="hit in hits" class="match-hit">\n\t\t\t\t\t<span ng-if="$first"><b q-translation="{{hit.trans}}"></b>: </span><qv-global-search-highlights q-text="hit.qText" q-ranges="hit.qRanges" class="highlights"></qv-global-search-highlights><span ng-if="!$last">,&nbsp;</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="more-hits" qva-activate="showMoreHits($event)" ng-if="$last && (visualObject.qTotalNumberOfMatches-hitsDisplayed) > 0" q-translation="GlobalSearch.MoreResults,{{(visualObject.qTotalNumberOfMatches-hitsDisplayed)}}"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'},899:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(99),n(900)],a=function(t,e,n){t.directive("qvGlobalSearchMoreIndicator",function(){return{replace:true,template:n,restrict:"E",scope:{pages:"=",activePageIx:"=",onPageChange:"&"},link:function t(n){n.touchOn=!e.treatAsDesktop();n.pressedPageIx=void 0;n.onPageClick=function(t){n.pressedPageIx=t;n.onPageChange({index:t})};n.$watch("activePageIx",function(){n.pressedPageIx=void 0})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},900:function(t,e){t.exports='<div class="qv-gs-more-indicator" ng-class="{ \'touch-on\': touchOn }">\n\t<div class="hit-area"  qva-activate="onPageClick($index);" ng-repeat="p in pages">\n\t\t<span tid="swipeableChartPageClickDot" class="dot" ng-class="{ \'active\': $index === activePageIx, \'pressed\': $index === pressedPageIx }"></span>\n\t</div>\n</div>'},901:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(902)],a=function(t,e){t.directive("qvGlobalSearchSuggest",[function(){return{restrict:"E",template:e,replace:true,require:["^qvGlobalSearch"],link:function t(){}}}]);t.directive("qvScrollToActiveSuggestion",function(){return{restrict:"A",link:function t(e,n,i){i.$observe("qvScrollToActiveSuggestion",function(t){t=t+""==="true";if(t){var e=n.position(),i=n.parent(),a=n[0].clientWidth>i[0].clientWidth,s=e.left+n[0].clientWidth-i[0].clientWidth;n[0].scrollIntoView(a);e.left<=i[0].offsetLeft?i.scrollLeft(n[0].offsetLeft-i[0].offsetLeft):s>0&&!a&&(i[0].scrollLeft=i[0].scrollLeft+s)}})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},902:function(t,e){t.exports='<div class="qv-search-suggest-wrapper" tid="globalSearch.suggestions">\n\t<span class="hidden">{{query}}</span>\n    <div ng-show="isSmallDevice" ng-if="!isObjectsFeature" class="dym" q-translation="GlobalSearch.DidYouMean"></div>\n\t<ul class="suggest-popup">\n\t\t<li ng-repeat="suggest in suggestions track by $index" qv-scroll-to-active-suggestion="{{$index === activeSuggestionIx && focusState.activeStateName === focusState.Suggestions}}" ng-class="{active: $index === activeSuggestionIx && focusState.activeStateName === focusState.Suggestions }" qva-activate="onSuggestSelect(null, suggest)" tid="globalSearch.suggestion" bold-suggest=\'{{suggest.value}}\'>\n\t\t\t{{suggest.value}}\n\t\t</li>\n\t</ul>\n</div>\n'},903:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(904),n(169)],a=function(t,e){t.directive("qvGlobalSearchHistory",["$timeout",function(n){return{restrict:"E",template:e,replace:true,require:["^qvGlobalSearch"],link:function e(i,a,s,o){var r=o[0],l=a.find(".history-popup")[0];i.colorsLimit=t.getService("qvGlobalSearchDataService").getMaxColorsNum();i.$watch("searchInputFocused",function(t){t&&n(function(){l.scrollTop=0})});i.onSearchHistorySelect=function(t){r.setQueryFromHistory(t)};i.clearSearchHistory=function(){r.clearHistory()};i.removeSelectedHistory=function(t){r.removeHistory(t)}}}}]);t.directive("qvScrollToActiveHistory",function(){return{restrict:"A",link:function t(e,n,i){i.$observe("qvScrollToActiveHistory",function(t){t=t+""==="true";n.toggleClass("active",t);t&&n[0].scrollIntoView(false)})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},904:function(t,e){t.exports='<div class="qv-search-last-history" tid="globalSearch.searchHistory">\n\t<div class="history-header" ng-show="searchHistory.length">\n\t\t<div class="title"  q-translation="GlobalSearch.RecentSearches"></div>\n\t\t<div class="clear-all-button" q-translation="GlobalSearch.ClearAll" qva-activate="clearSearchHistory($index)"></div>\n\t</div>\n\t<ul class="history-popup" ng-show="searchHistory.length">\n\t\t<li ng-repeat="items in searchHistory track by $index" qva-delegated-activate=".history-query#onSearchHistorySelect($index); .lui-icon--close#removeSelectedHistory($index);" tid="globalSearch.searchHistoryItem" ng-class="{active: $index === activeHistoryIx && focusState.activeStateName === focusState.History}" qv-scroll-to-active-history="{{$index === activeHistoryIx && focusState.activeStateName === focusState.History}}">\n\t\t\t<div class="history-query">{{searchHistory[$index]}}</div>\n\t\t\t<div class="lui-icon lui-icon--close" q-title-translation="Common.Delete" title="Delete"></div>\n\t\t</li>\n\t</ul>\n</div>'},905:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(906),n(163),n(89),n(50),n(97),n(276),n(257),n(371)],a=function(t,e,i,a,s,o){var r={};Object.defineProperties(r,{THROBBER:{value:1e3},INDEX_PROGRESS:{value:5e3},NEXT_INDEX_PROGRESS:{value:500},HIDE_INDEX_DONE:{value:1e3}});t.directive("qvGlobalSearchThrobber",["$timeout","$window","$animate",function(l,c,u){return{replace:true,template:e,restrict:"E",link:function e(d,p){var h=t.getService("qvGlobalSearchService"),g,f,v,m,b=p.find(".qv-gs-index-progress .qv-gs-index-group"),S,y;d.asyncHideActivity=false;d.percentDone=void 0;d.imgSrc=n.p+"img/core/static/smart-search.png";d.pages=[{},{}];d.activePageIx=0;S=function t(){l(function(){b[0].scrollLeft=d.activePageIx*b[0].offsetWidth})};s.OrientationChanged.bind(S);o.on("update",S);d.goToPage=function(t){b.animate({scrollLeft:t*b[0].offsetWidth},400,"swing",function(){l(function(){d.activePageIx=t})})};d.onSwipePage=function(t){if(d.isSmallDevice){var e=t>0?1:0;e!==d.activePageIx&&d.goToPage(e)}};d.openHelp=function(){c.open(i.path+"SmartSearch_Intro")};d.$on("$destroy",function(){l.cancel(g);l.cancel(f);l.cancel(v);l.cancel(m);o.off("update",S);s.OrientationChanged.unbind(S);h.IndexProgressUpdate.unbind(M);u.off("removeClass",p[0])});function I(t){var e=a(),n=p.find(t)[0];u.on("removeClass",n,function(t,i){if("close"===i){u.off(n);e.resolve()}});return e.promise}function x(){d.throbber.show=false;d.indexProgress.enabled=false;d.indexProgress.show=false;d.indexProgress.visible=false;d.indexDone.show=false;d.indexDone.visible=false}function q(){if(void 0!==d.percentDone&&d.percentDone<100)return true;return h.couldEngineBeIndexing(d.app)}function w(t){if(!y){h.IndexProgressUpdate.bind(M);y=true}l.cancel(m);m=l(function(){h.requestIndexProgressUpdate(d.app)},t||0)}d.showIndexDone=function(){I(".qv-gs-index-done").then(function(){d.indexProgress.show=false;d.indexProgress.visible=false;d.indexDone.visible=true;d.percentDone=void 0;l.cancel(v);v=l(C,r.HIDE_INDEX_DONE)});d.indexDone.show=true};function C(){d.indexDone.visible=false;d.indexDone.show=false;l.cancel(g);d.$emit("updateForceShowDimmer",false);d.asyncHideActivity?E():g=l(D,r.THROBBER)}function P(t){I(".qv-gs-index-progress").then(function(){d.indexProgress.visible=true;d.isSmallDevice||d.$emit("updateForceShowDimmer",true)});d.percentDone=t;d.indexProgress.show=true;d.activity.show=true;d.throbber.show=false;t<100?w(r.NEXT_INDEX_PROGRESS):A()}function T(t){d.percentDone=t;t<100?w(r.NEXT_INDEX_PROGRESS):A()}function A(){l.cancel(m);if(y){h.IndexProgressUpdate.unbind(M);y=false}}function D(){d.activity.show=true;d.throbber.show=true;d.emptyMessageEnabled=false}function E(){l.cancel(g);l.cancel(f);l.cancel(v);l.cancel(m);A();d.activity.show=false;d.throbber.show=false;d.indexProgress.enabled=false;d.indexProgress.show=false;d.indexProgress.visible=false;d.emptyMessageEnabled=d.searchTerms.length>0}function k(){d.indexProgress.enabled=true;w()}function M(t,e){if(t!==(d.app.id||"").toUpperCase())return;var n=new Number(e);if(Number.isNaN(+n)||!e){d.indexProgress.enabled=true;w(r.INDEX_PROGRESS);return}if(!d.indexProgress.show&&n<100)P(n);else if(d.indexProgress.show)T(n);else{l.cancel(g);g=l(D,r.THROBBER)}}function $(t,e,n){if(e){d.asyncHideActivity=false;if(d.activity.show)return;x();l.cancel(g);l.cancel(f);if(q())k();else{g=l(D,r.THROBBER);f=l(k,r.INDEX_PROGRESS)}}else{var i=d.percentDone&&d.percentDone<100;if(i&&n){h.setLastKnownIndexProgress(d.app,100);A();d.percentDone=100;d.asyncHideActivity=true}else if(i&&!n){if(!d.isSmallDevice)return;E()}else if(100==d.percentDone){h.setLastKnownIndexProgress(d.app,100);A();d.asyncHideActivity=true}else E()}}d.$on("toggleActivityIndicator",$)}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},906:function(t,e){t.exports='<div ng-show="activity.show" class="qv-qs-throbber-container qv-animate ng-hide">\n\n\t<div class="qv-gs-throbber-dimmer"></div>\n\n\t<div ng-show="throbber.show" class="qv-gs-throbber ng-hide"></div>\n\n\t<div ng-show="indexProgress.show" class="qv-gs-index qv-gs-index-progress qv-animate ng-hide">\n\n\t\t<div class="qv-gs-index-group" qva-smart-search-swipe-horizontal="onSwipePage(delta)">\n\t\t\t<div class="qv-gs-index-section">\n\t\t\t\t<div class="qv-gs-index-content qv-gs-index-content-shrink">\n\t\t\t\t\t<span class="qv-gs-index-header" q-translation="GlobalSearch.PreparingSmartSearch"></span>\n\n\t\t\t\t\t<qv-progress-bar percent-done="percentDone" on-completed="showIndexDone()"></qv-progress-bar>\n\n\t\t\t\t\t<span class="qv-gs-index-text" q-translation="GlobalSearch.NextTimeFaster"></span>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="qv-gs-index-section">\n\t\t\t\t<div class="qv-gs-index-content qv-gs-index-content-shrink">\n\t\t\t\t\t<div class="qv-gs-index-help" qva-activate="openHelp()">\n\t\t\t\t\t\t<span class="qv-gs-index-header" q-translation="GlobalSearch.LearnHowToUse"></span>\n\t\t\t\t\t\t<img ng-src="{{imgSrc}}" class="qv-gs-index-image" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<qv-global-search-more-indicator pages="pages" active-page-ix="activePageIx" on-page-change="goToPage(index);"></qv-global-search-more-indicator>\n\n\t</div>\n\n\t<div ng-show="indexDone.show" class="qv-gs-index qv-gs-index-done qv-animate ng-hide">\n\t\t<div class="qv-gs-index-section qv-gs-index-section-single">\n\t\t\t<div class="qv-gs-index-content qv-gs-index-shrink">\n\t\t\t\t<span class="qv-gs-index-icon lui-icon lui-icon--tick" aria-hidden="true"></span>\n\t\t\t\t<span class="qv-gs-index-text-big" q-translation="GlobalSearch.Done"></span>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n</div>'},907:function(t,e){t.exports='<div class="qv-progress-bar">\n\t<div class="progress-bar-bg">\n\t\t<div class="progress-bar-fg" ng-style="{ width: display }"></div>\n\t</div>\n\n\t<div class="progress-text" ng-bind="display" ng-hide="options.hideText"></div>\n</div>'},908:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(276),n(257)],a=function(t){t.directive("qvMobileIndexProgress",["$timeout",function(e){return{replace:true,template:'<div class="qv-mobile-index-progress"><qv-progress-bar ng-if="showMobileIndexProgressBar" percent-done="indexPercentDone" on-completed="hideMobileIndexProgressWhenDone()" options="progressBarOptions"></qv-progress-bar></div>',restrict:"E",link:function n(i){var a=t.getService("qvGlobalSearchService"),s,o;i.progressBarOptions={hideText:true};a.couldEngineBeIndexing(i.app)&&c(0);i.$on("$destroy",function(){e.cancel(o);a.IndexProgressUpdate.unbind(r)});i.hideMobileIndexProgressWhenDone=function(){i.showMobileIndexProgressBar=false};function r(t,e){if(t!==(i.app.id||"").toUpperCase())return;if(!i.showMobileIndexProgressBar&&e<100){i.indexPercentDone=e;i.showMobileIndexProgressBar=true;c(500)}else if(i.showMobileIndexProgressBar){i.indexPercentDone=e;e<100&&c(500)}else l()}function l(){e.cancel(o);if(s){a.IndexProgressUpdate.unbind(r);s=false}}function c(t){if(!s){a.IndexProgressUpdate.bind(r);s=true}e.cancel(o);o=e(function(){a.requestIndexProgressUpdate(i.app)},t||0)}}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},909:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(54),n(95),n(186),n(93),n(910),n(124),n(120),n(113),n(49),n(91),n(89),n(103),n(229),n(222),n(99),n(134),n(147),n(154),n(106),n(168),n(114),n(105),n(223),n(372),n(911),n(912),n(937),n(939),n(941),n(374),n(212),n(221),n(275),n(945),n(366),n(946),n(267),n(415),n(233),n(368),n(947),n(963)],a=function(t,e,n,i,a,s,o,r,l,c,u,d,p,h,g,f,v,m,b,S,y,I,x,q,w,C,P){var T=["$scope","$element","$window","$timeout","$q","qvCaoService","qvCaoSearchService","qvCaoChartService","qvAppDetailsService","qvCaoRenderService","qvCaoComplexityEstimatorService","qvCaoSelectionService",function(o,l,T,A,D,E,k,M,$,O,F,N){var L=this;var _=new I;var R=D.defer();var j=D.defer();var z=false;var G=0;L.zoomDeferred=null;L.lightEdits=[];o.loadedCount=0;o.query="";o.charts=[];o.chartMatches=[];o.renderableCharts=[];o.fieldList=[];o.debug=c.CAO_DEBUG;o.syncFieldPicker=u.getFlag("CAO_FIELD_PICKER_SYNC");o.insightFeedback=u.getFlag("CE_PRECEDENTS");o.caoTweakEnabled=u.getFlag("CAO_TWEAK");o.nluEnabled=u.getFlag("NLU_INSIGHTS");o.nluQueryInfoVisible=false;o.nluRawResponse=null;o.learningPerformed=false;o.contextPanelVisible=false;o.assetsPanelVisible=true;o.showHidden=false;o.showFieldPicker=true;o.limitedAccess=null;o.scrollContainer=l.find(".qv-cao-scroll-content")[0];o.mouseUp=function(){o.focusBorder=true};o.resultLabel=d.get("cao.search.title",[0,0,0,0]);o.introHeader=o.nluEnabled?d.get("cao.search.intro.nlu.header"):d.get("cao.search.intro.header");o.introDescriptionSearch=d.get("cao.search.intro.description.search");o.introDescriptionNoFields=d.get("cao.search.intro.description.nofields");o.introDescriptionGenerateInsights=d.get("cao.search.intro.description.generateInsights");o.introButton=d.get("cao.search.intro.button");o.goToSheetButton=d.get("cao.search.gotosheet.button");o.cellStatusElem=l.find("#sr-cell-status-label");o.direction=x.direction;o.appPrecedents={enabled:true};o.state="INIT";o.gridScreenReader=d.get("Cao.Accessibility.Object.Description");o.onGridFocus=function(){o.gridScreenReader=z?"":d.get("Cao.Accessibility.Object.Description")};o.onGridBlur=function(){A(function(){z=!!document.activeElement&&document.activeElement.classList.contains("cao-insight-container");o.gridScreenReader=""},1)};r.load();m.getList().then(function(t){o.masterDimensionsListModel=t});y(o,"masterDimensionsListModel",function(){H()});b.getList().then(function(t){o.masterMeasuresListModel=t});y(o,"masterMeasuresListModel",function(){H()});S.getList().then(function(t){o.fieldsListModel=t});y(o,"fieldsListModel",function(){H()});o.updateDirection=function(t){o.direction!==t&&(o.direction=t)};o.closeAndGoToSheet=function(){E.toggleCao();i.publish("cao/insights/close")};x.DirectionChanged.bind(o.updateDirection);s.getApp().then(function(i){j.resolve();o.app=i;o.contextPanelVisible=w.storageObj(i.id).contextPanel;o.assetsPanelVisible=w.storageObj(i.id).assetsPanel;$.get().then(function(t){o.limitedAccess=Boolean(t.model.app.published||!t.model.permissions.update)}).then(function(){p.all({appFieldList:i.getFieldList(),classificationsResult:e.getService("classificationService").getClassification(),appScrape:E.scrapeApp()}).then(function(e){var s=e.classificationsResult?new g(e.classificationsResult):void 0;a.addClassificationDataToFields(e.appFieldList,s);R.resolve();F.init(i);o.state="INTRO";v.treatAsDesktop()&&A(function(){t("#cao-search-input").focus()});k.getMasterItems().then(function(t){o.limitedAccess&&0===t.length&&(o.state="NO_FIELDS")});o.fieldList=e.fieldList;k.clearSelectedFields();k.registerForCaoSearchQuery(n.debounce(B,300));H()},function(){R.reject();V()})});o.app.getLayout().then(function(t){o.permissions=t.permissions})},function(){j.reject();V()});function H(){k.createFieldList().then(function(t){o.fieldList=t})}function B(t){E.setRefreshIndicatorVisibility(false);if("NO_FIELDS"===o.state)return;if(t.showIntro){o.state="INTRO";o.$apply(function(){o.query="";o.charts=[];o.chartMatches=[];o.selectedFieldNames=[]});return}o.query=t.query?t.query:"";o.loadGraphs(t.query);o.selectedFieldNames=t.selectedFields?t.selectedFields:[]}o.refreshCharts=function(){if("INTRO"===o.state){E.setRefreshIndicatorVisibility(false);return}i.publish("cao/insight/refreshPerformed");o.state="LOADING";E.setRefreshIndicatorVisibility(false);o.clearChartSelection();A(function(){O.clearRenderQueue();o.charts=[];o.chartMatches=[]}).then(function(){M.refreshInsights(o.appPrecedents.enabled).then(function(t){o.state="LOADED";o.loadedCount++;o.charts=t.recommendations;o.chartMatches=t.chartMatches;o.learningPerformed=false}).catch(V)})};o.$watch("appPrecedents.enabled",function(t,e){t!=e&&o.refreshCharts()});o.clearInsightResults=function(){i.publish("cao/insights/clear")};o.isClearResultsVisible=function(){return o.caoTweakEnabled&&(o.charts&&o.charts.length>0||o.chartMatches&&o.chartMatches.length>0)};o.setItemAccFocusVisibility=function(){this.itemAccFocus=true};o.removeItemAccFocusVisibility=function(){this.itemAccFocus=false};o.toggleFieldPicker=function(){o.showFieldPicker=!o.showFieldPicker;h.trackEvent(h.customEvents.INSIGHTS_FIELD_PICKER,{type:o.showFieldPicker?"open":"close"});A(o.resizeCharts)};o.resizeCharts=function(){f.resizeCharts(T)};function V(t){G--;t&&(t.norefresh||t.notFound)?t.notFound&&(o.state="NOT_FOUND"):o.state="ERROR";o.learningPerformed=false}o.loadGraphs=function(t){O.clearRenderQueue();E.setRefreshIndicatorVisibility(false);"LOADED"===o.state&&o.$apply(function(){o.charts=[];o.chartMatches=[]});o.state="LOADING";o.showHidden=false;var e=new Date;j.promise.then(function(){R.promise.then(function(){G++;var n;n=o.nluEnabled&&t&&t.length?C.parseQuery(t,o.app.id).then(function(t){o.nluRawResponse=t;i.publish("cao/nlu/new_queries",t);var e=P.buildDataCollection(t);return M.getVisualRecommendations(o.app,e,o.limitedAccess)}):M.getInsights(o.app,t,o.limitedAccess,o.appPrecedents.enabled);n.then(function(t){G--;if(G>0)return;o.state="LOADED";o.loadedCount++;o.charts=t.recommendations;o.chartMatches=t.chartMatches;var n=new Date;var i=(n-e)/1e3;h.trackEvent(h.customEvents.INSIGHTS_SEARCH,{query:o.query,queryTime:i})},V)},V)},V)};o.selectField=function(t){if(o.syncFieldPicker){o.fieldToAdd=t.selected?null:t;o.fieldToRemove=t.selected?t:null}else{o.fieldToAdd=null;A(function(){o.fieldToAdd=t})}i.publish("cao/insight/contextPanelToggled",!!o.insightFeedback&&w.storageObj(o.app.id).contextPanel);o.clearChartSelection()};o.updateFieldPicker=function(){A(function(){o.fieldList=[];o.fieldList=k.getFields()})};o.zoomChart=function(t){L.zoomDeferred=D.defer();o.zoomOpen=true;t.zoomed=true;A(function(){l.find(".qv-cao-zoomed-anmiation-container").addClass("animate-expand");A(function(){o.zoomedChart=t},400)});return L.zoomDeferred.promise};o.exitZoom=function(){A(function(){l.find(".qv-cao-zoomed-anmiation-container").addClass("animate-shrink");o.zoomedChart=void 0;A(function(){o.zoomOpen=false;L.zoomDeferred.resolve()},400)});return L.zoomDeferred.promise};o.sendFeedback=function(t,e){var n=t.getAnalysis();if(e===q.Precedents.PrecedentTypes.Dislike)return n.precedents&&n.precedents.disliked?_.undislikeAnalysis(n).then(function(){delete n.precedents;return false}):_.dislikeAnalysis(n).then(function(t){n.precedents={id:t.nodes[0].id,disliked:true};return true});if(e===q.Precedents.PrecedentTypes.Like)return _.likeAnalysis(n).then(function(t){n.precedents={id:t.nodes[0].id,liked:true};return true})};function U(e){t(e.currentTarget).blur()}o.showHiddenCharts=function(){o.showHidden=!o.showHidden;o.showHidden&&A(function(){var e=t(".qv-cao-section-hidden")[0];e&&e.scrollIntoView&&e.scrollIntoView({behavior:"smooth",block:"start"})})};o.showFoundInsights=function(t){13===t.which?o.chartsToShow={charts:o.chartMatches,activeTab:"found"}:"click"===t.type&&(o.chartsToShow={charts:o.chartMatches,activeTab:"found"});U(t)};o.showGeneratedInsights=function(t){13===t.which?o.chartsToShow={charts:o.renderableCharts,activeTab:"generated"}:"click"===t.type&&(o.chartsToShow={charts:o.renderableCharts,activeTab:"generated"});U(t)};o.isRefreshIndicatorVisible=function(){return E.getRefreshIndicatorVisibility()};o.isCaoInsightContextPanelVisible=function(){return o.caoTweakEnabled&&o.contextPanelVisible&&"ERROR"!==o.state};o.clearChartSelection=function(){N.clearSelection()};o.isChartSelected=function(){var t=N.getSelectedChart();return t&&o.zoomedChart&&o.zoomedChart===t};o.toggleNluQueryInfo=function(){o.nluQueryInfoVisible=!o.nluQueryInfoVisible};function K(t){o.contextPanelVisible=t}function W(t){o.assetsPanelVisible=t}function Q(t){o.learningPerformed=t}i.subscribe("cao/insight/refresh",o.refreshCharts);i.subscribe("cao/insight/contextPanelToggled",K);i.subscribe("cao/insight/assetsPanelToggled",W);i.subscribe("cao/insight/learningPerformed",Q);o.$watchGroup(["charts","chartMatches"],function(){0===o.charts.length&&"LOADED"===o.state&&V({notFound:true});o.renderableCharts=o.charts.filter(function(t){return!o.insightFeedback||!t.isHidden()});o.chartsToShow={charts:o.renderableCharts,activeTab:"generated"};o.hiddenCharts=o.charts.filter(function(t){return t.isHidden()});o.numberOfGeneratedInsights=d.get("cao.search.info.title.generated.plural",o.renderableCharts.length.toString());o.numberOfFoundInsights=d.get("cao.search.info.title.found.plural",o.chartMatches.length.toString());function t(){var t=[];if(o.charts.length+o.chartMatches.length===0)return null;o.charts.length+o.chartMatches.length>0&&t.push(d.get("cao.search.titleResults",[o.charts.length+o.chartMatches.length]));o.renderableCharts.length>0&&t.push(d.get("cao.search.titleGenerated",[o.renderableCharts.length]));o.hiddenCharts.length>0&&t.push(d.get("cao.search.titleHidden",[o.hiddenCharts.length]));switch(t.length){case 3:return d.get("cao.search.titleLength3",t);case 2:return d.get("cao.search.titleLength2",t);default:break}}o.resultLabel=t()});o.$on("$destroy",function(){k.unRegisterFromCaoSearchQuery(B);O.clearRenderQueue();i.unsubscribe("cao/insight/refresh");i.unsubscribe("cao/insight/contextPanelToggled");i.unsubscribe("cao/insight/assetsPanelToggled");i.unsubscribe("cao/insight/learningPerformed");x.DirectionChanged.unbind(o.updateDirection)})}];e.directive("qvCaoComponent",function(){return{restrict:"E",template:o,controller:T,scope:true,replace:true,link:function t(e){l.getList().then(function(t){t.getLayout().then(function(t){e.sheets=t})});e.target=null}}});return"<qv-cao-component></qv-cao-component>"}.apply(e,i),void 0!==a&&(t.exports=a))},910:function(t,e){t.exports='<div class="qv-cao overlay" id="qv-cao-overlay" style="display:none;" ng-keyup="setItemAccFocusVisibility()" ng-mouseup="removeItemAccFocusVisibility()">\n\t<div class="qv-cao-zoomed-chart" ng-if="zoomOpen" ng-class="{\'cao-tweak-width\' : caoTweakEnabled && isChartSelected() && contextPanelVisible}">\n\t\t<div class="qv-cao-zoomed-anmiation-container" ng-if="zoomOpen">\n\t\t\t<qv-cao-insight class="qv-cao-section-result-item qv-cao-section-result-item-zoomed" ng-class="{\'cao-insight-focus\': itemAccFocus}"\n\t\t\t\tng-if="zoomedChart"\n\t\t\t\tchart="zoomedChart"\n\t\t\t\tapp="::app"\n\t\t\t\tdebug="::debug"\n\t\t\t\tsheets="::sheets"\n\t\t\t\tinteractive="::true"\n\t\t\t\talways-show-header="true"\n\t\t\t\theader-icon="lui-icon--arrow-left"\n\t\t\t\theader-action="exitZoom"\n\t\t\t\tpermissions="permissions"\n\t\t\t\tng-keyup="mouseUp"\n\t\t\t\tsend-feedback="sendFeedback(chart, type)"\n\t\t\t\tdirection="direction"\n\t\t\t\tis-cao-context-panel-visible="contextPanelVisible"\n\t\t\t>\n\t\t\t</qv-cao-insight>\n\t\t</div>\n\t</div>\n\n\t<div ng-if="assetsPanelVisible" class="qv-cao-field-picker" ng-class="{ \'hide-field-picker\' : !showFieldPicker, \'field-picker-panel-container\': caoTweakEnabled }" tid="cao-assets-panel">\n\t\t<qv-cao-field-picker\n\t\t\tinsights-loaded="state !== \'INIT\'"\n\t\t\tis-limited ="limitedAccess"\n\t\t\tclass ="field-picker"\n\t\t\ttoggle-field-picker="toggleFieldPicker"\n\t\t\tshow-field-picker="showFieldPicker"\n\t\t\titems="fieldList"\n\t\t\tselect-field="selectField">\n\t\t</qv-cao-field-picker>\n\t</div>\n\n\t<div class="qv-cao-search" ng-class="{ \'hide-field-picker\' : !showFieldPicker, \'search-container-with-context-panel\': caoTweakEnabled, \'search-container-nlu\': nluEnabled }">\n\t\t<div class="qv-cao-insights-header" ng-if="nluEnabled && (state === \'INTRO\' || state === \'INIT\')">\n\t\t\t<h1 q-translation="cao.CognitiveAssociativeOverlay"></h1>\n\t\t\t<button class=\'lui-button\' tid="go-to-sheet-intro-btn" ng-click="closeAndGoToSheet()">\n\t\t\t\t{{ goToSheetButton }}\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="qv-cao-nlu-intro" ng-if="nluEnabled && (state === \'INTRO\' || state === \'INIT\')">\n\t\t\t<div class="qv-cao-intro-image"></div>\n\t\t\t<h1>{{ introHeader }}</h1>\n\t\t</div>\n\t\t<qv-cao-search field-to-remove="fieldToRemove"\n\t\t\t\t\tfield-to-add="fieldToAdd"\n\t\t\t\t\tupdate-field-picker="updateFieldPicker"\n\t\t\t\t\tclear-field-picker="clearFieldPicker"\n\t\t\t\t\tis-limited ="limitedAccess"\n\t\t\t\t\tdirection="direction"\n\t\t\t\t\tdata-disabled="state === \'INIT\'"\n\t\t\t\t\tnlu-query-info-button-visible="state === \'LOADED\'"\n\t\t\t\t\tnlu-query-info-visible="nluQueryInfoVisible"\n\t\t\t\t\ttoggle-nlu-query-info="toggleNluQueryInfo">\n\t\t</qv-cao-search>\n\t\t<div class="qv-cao-search-info" ng-if="nluEnabled && nluQueryInfoVisible">\n\t\t\t<div class="qv-cao-search-info-debug" ng-if="debug">\n\t\t\t\t<h2>Debug Information</h2>\n\t\t\t\t<p class="qv-cao-search-info-response-text">{{ nluRawResponse | json : spacing }}</p>\n\t\t\t</div>\n\t\t</div>\n\t\t<p ng-if="nluEnabled && (state === \'INTRO\' || state === \'INIT\')" class="qv-cao-nlu-intro-suggestion-text" q-translation="cao.search.nlu.suggestedQuestionsText"></p>\n\n\t\t<div class="qv-cao-search-line" ng-if="!nluEnabled || (state !== \'INTRO\' && state !== \'INIT\')"></div>\n\n\t\t<div class="qv-cao-scroll-content">\n\t\t\t<div class="qv-cao-scroll-area">\n\n\t\t\t\t<div class="qv-cao-intro" ng-if="state === \'INTRO\' || state === \'INIT\'">\n\t\t\t\t\t<div class="qv-cao-intro-content">\n\t\t\t\t\t\t<div class="qv-cao-intro-image"></div>\n\t\t\t\t\t\t<h1>{{ introHeader }}</h1>\n\t\t\t\t\t\t<p>{{ introDescriptionSearch }}</p>\n\t\t\t\t\t\t<p ng-if="state === \'INTRO\'">{{ introDescriptionGenerateInsights }}</p>\n\t\t\t\t\t\t<div class="btns">\n\t\t\t\t\t\t\t<button class=\'lui-button lui-button--large\' tid="go-to-sheet-intro-btn" ng-click="closeAndGoToSheet()" ng-if="state === \'INTRO\' ">\n\t\t\t\t\t\t\t\t{{ goToSheetButton }}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button class=\'lui-button lui-button--success lui-button--large\' tid="generate-insights-intro-btn" ng-click="loadGraphs()" ng-if="state === \'INTRO\' ">\n\t\t\t\t\t\t\t\t{{ introButton }}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-if="state === \'INIT\'">\n\t\t\t\t\t\t\t<div class="loader">\n\t\t\t\t\t\t\t\t<qv-spinner show="state === \'INIT\'" show-delay="300" center-in-parent="true"></qv-spinner>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<p q-translation="cao.loading"></p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="qv-cao-intro" ng-if="state === \'NO_FIELDS\'">\n\t\t\t\t\t<div class="qv-cao-intro-content">\n\t\t\t\t\t\t<div class="qv-cao-intro-image"></div>\n\t\t\t\t\t\t<h1>{{ introHeader }}</h1>\n\t\t\t\t\t\t<p>{{ introDescriptionNoFields }}</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="qv-cao-intro" ng-if="state === \'ERROR\'">\n\t\t\t\t\t<div class="qv-cao-intro-content">\n\t\t\t\t\t\t<h1 q-translation="cao.error.header"></h1>\n\t\t\t\t\t\t<p q-translation="cao.error.description"></p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="qv-cao-intro" ng-if="state === \'NOT_FOUND\'">\n\t\t\t\t\t<div class="qv-cao-intro-content">\n\t\t\t\t\t\t<h1 q-translation="cao.error.header"></h1>\n\t\t\t\t\t\t<p q-translation="cao.error.description.notfound"></p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="qv-cao-section qv-cao-section-insights">\n\t\t\t\t\t<div class="qv-cao-loading" ng-if="state === \'LOADING\'">\n\t\t\t\t\t\t<div class="spinner-container">\n\t\t\t\t\t\t\t<qv-spinner show="state === \'LOADING\'" show-delay="300" center-in-parent="true"></qv-spinner>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="qv-cao-section-header"\n\t\t\t\t\t\tng-if="state === \'LOADED\'">\n\t\t\t\t\t\t<p class="qv-cao-section-header-text" ng-if="chartMatches.length === 0">{{resultLabel}}</p>\n\t\t\t\t\t\t<span style="display:none;" ng-show="state === \'LOADED\'" tid="cao-last-loaded-query" test-attribute="{{query}}" test-loaded-count="{{loadedCount}}">\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<ul class="lui-tabset qv-cao-section-header-text" ng-if="chartMatches.length > 0">\n\t\t\t\t\t\t\t<li class="lui-tab cao-tab qv-cao-section-header-tab1" ng-class="{\'lui-active\' : chartsToShow.activeTab === \'generated\'}" tabindex="0" ng-click="showGeneratedInsights($event)" ng-keypress="showGeneratedInsights($event)">\n\t\t\t\t\t\t\t  <span class="lui-tab__text qv-cao-section-header-tab1-text">{{numberOfGeneratedInsights}}</span>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li class="lui-tab cao-tab qv-cao-section-header-tab2" ng-class="{\'lui-active\' : chartsToShow.activeTab === \'found\'}" tabindex="0" ng-click="showFoundInsights($event)" ng-keypress="showFoundInsights($event)">\n\t\t\t\t\t\t\t  <span class="lui-tab__text qv-cao-section-header-tab2-text">{{numberOfFoundInsights}}</span>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<div class="results-action-container" ng-class="{\'results-action-container--tabset\': chartMatches.length > 0}">\n\t\t\t\t\t\t\t<button class="lui-button clear-insights-btn" ng-if="isClearResultsVisible()" tid="clear-insights-btn" ng-click="clearInsightResults()" q-translation="cao.insights.clear"></button>\n\t\t\t\t\t\t\t<button class="lui-button lui-button--success refresh-insights-btn" ng-if="caoTweakEnabled && learningPerformed" tid="refresh-insights-btn" ng-click="refreshCharts()" q-translation="cao.insight.results.refreshButton"></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="qv-cao-section-results" ng-if="state === \'LOADED\'">\n\t\t\t\t\t\t<qv-cao-insight class="qv-cao-section-result-item" ng-class-odd="\'qv-cao-section-result-item-odd\'" ng-focus="onGridFocus()" ng-blur="onGridBlur()" ng-repeat="chart in chartsToShow.charts | orderBy : \'-chart.relevance\'" ng-class="{\'cao-insight-focus\': itemAccFocus}"\n\t\t\t\t\t\t\tgrid-screen-reader="gridScreenReader"\n\t\t\t\t\t\t\tindex="$index"\n\t\t\t\t\t\t\tchart="chart"\n\t\t\t\t\t\t\tapp="::app"\n\t\t\t\t\t\t\tsheets="::sheets"\n\t\t\t\t\t\t\tdebug="::debug"\n\t\t\t\t\t\t\tinteractive="::false"\n\t\t\t\t\t\t\tdirection="direction"\n\t\t\t\t\t\t\tscroll-container="scrollContainer"\n\t\t\t\t\t\t\theader-action="zoomChart"\n\t\t\t\t\t\t\theader-icon="lui-icon--expand"\n\t\t\t\t\t\t\tpermissions="permissions"\n\t\t\t\t\t\t\tsend-feedback="sendFeedback(chart, type)"\n\t\t\t\t\t\t\ton-insight-focus="onGridFocus()"\n\t\t\t\t\t\t\ton-insight-blur="onGridBlur()">\n\t\t\t\t\t\t</qv-cao-insight>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="qv-cao-section-footer" ng-if="state === \'LOADED\' && insightFeedback && hiddenCharts.length > 0 && chartsToShow.activeTab !== \'found\' && !caoTweakEnabled">\n\t\t\t\t\t\t<span q-translation="cao.card.section.hidden,{{hiddenCharts.length}}"></span>\n\t\t\t\t\t\t<a class="lui-fade-button show-more-button" ng-click="showHiddenCharts()">\n\t\t\t\t\t\t\t(<span q-translation="{{ showHidden ? \'cao.card.section.hidden.hide\' : \'cao.card.section.hidden.show\' }}"></span>)\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="qv-cao-section-results qv-cao-section-hidden" ng-if="state === \'LOADED\' && showHidden && chartsToShow.activeTab !== \'found\' && !caoTweakEnabled">\n\t\t\t\t\t\t<qv-cao-insight class="qv-cao-section-result-item" ng-class-odd="\'qv-cao-section-result-item-odd\'" ng-focus="onGridFocus()" ng-blur="onGridBlur()" ng-repeat="chart in hiddenCharts | orderBy : \'-chart.relevance\'" ng-class="{\'cao-insight-focus\': itemAccFocus}"\n\t\t\t\t\t\t\tgrid-screen-reader="gridScreenReader"\n\t\t\t\t\t\t\tindex="$index + renderableCharts.length"\n\t\t\t\t\t\t\tchart="chart"\n\t\t\t\t\t\t\tapp="::app"\n\t\t\t\t\t\t\tsheets="::sheets"\n\t\t\t\t\t\t\tdebug="::debug"\n\t\t\t\t\t\t\tinteractive="::false"\n\t\t\t\t\t\t\tdirection="direction"\n\t\t\t\t\t\t\tscroll-container="scrollContainer"\n\t\t\t\t\t\t\theader-action="zoomChart"\n\t\t\t\t\t\t\theader-icon="lui-icon--expand"\n\t\t\t\t\t\t\tpermissions="permissions"\n\t\t\t\t\t\t\tsend-feedback="sendFeedback(chart, type)"\n\t\t\t\t\t\t\ton-insight-focus="onGridFocus()"\n\t\t\t\t\t\t\ton-insight-blur="onGridBlur()">\n\t\t\t\t\t\t</qv-cao-insight>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="qv-cao-footer" ng-if="nluEnabled && (state === \'INTRO\' || state === \'INIT\')">\n\t\t\t<p>{{ introDescriptionGenerateInsights }}</p>\n\t\t\t<button class=\'lui-button lui-button--success\' tid="generate-insights-intro-btn" ng-click="loadGraphs()">\n\t\t\t\t{{ introButton }}\n\t\t\t</button>\n\t\t</div>\n\t\t<qv-cao-refresh-indicator ng-if="isRefreshIndicatorVisible()" />\n\t</div>\n\n\t<qv-cao-insights-context-panel ng-if="isCaoInsightContextPanelVisible()" app="app" hidden-charts="hiddenCharts" class="context-panel cao-height" tid="cao-context-panel" state="state" insight-feedback="insightFeedback" precedents-enabled="appPrecedents.enabled"></qv-cao-insights-context-panel>\n\t<qv-cao-insights-bottom-panel ng-if="caoTweakEnabled" app="app" insight-feedback="insightFeedback"></qv-cao-insights-bottom-panel>\n</div>\n'},911:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t=function t(){};function e(t){if(t){var e=t.filter(function(t){return t.type.startsWith("master_")});var n=t.filter(function(t){return t.type.startsWith("field")});if(e.length)return e[0];if(n.length)return n[0]}}function n(t,e,n){var i=null;if(e.type.startsWith("master_")){i={libId:e.libId};t.libItems.push(i)}else if("field"===e.type){i={name:e.name};t.fields.push(i)}i&&n&&(i.cond=n)}t.buildDataCollection=function(t){var i={fields:[],libItems:[]};if(t.entities){t.entities.filter(function(t){return"model_element"==t.type}).forEach(function(t){var a=e(t.model_elements);null!=a&&n(i,a)});t.entities.filter(function(t){return"data_value"==t.type&&"filter-category"==t.role}).forEach(function(t){if(t.data_values&&t.data_values.length){var e=t.data_values[0];n(i,e.owner,["==",e.value])}})}if(t.intent){var a=t.intent.name.split("-")[1];a&&(i.analysisTypes=[a])}return i};return t}.apply(e,i),void 0!==a&&(t.exports=a))},912:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(54),n(122),n(94),n(322),n(91),n(90),n(128),n(49),n(103),n(97),n(222),n(105),n(95),n(123),n(223),n(913),n(914),n(915),n(916),n(917),n(918),n(919),n(920),n(934),n(374)],a=function(t,e,n,i,a,s,o,r,l,c,u,d,p,h,g,f,v,m,b,S,y,I,x){var q=["$scope","qvCaoService","qvAccessibilityGridService","$element","$timeout","qvContextMenu","$exportDialog","luiPopover","$window","qvCaoSelectionService",function(e,m,q,w,C,P,T,A,D,E){var k=this;var M=null;var $=[];var O;this.id=r.generateId();this.activeSheet=l.getModel();this.viewDataToggled=false;this.chartLoaded=false;this.contextMenuStatus={open:false};this.lightEditing=c.getFlag("INSIGHT_LIGHT_EDITING");this.generatedChartScreenReaderLabel=o.get("generated.insight.card.screen.reader");this.insightFeedback=c.getFlag("CE_PRECEDENTS");this.insightLearning=c.getFlag("CE_PRECEDENTS");this.caoTweakEnabled=c.getFlag("CAO_TWEAK");this.popupOpen=false;this.shouldFadeToast=false;this.onResize=function(){if(k.row>=0&&k.col>=0){var t=k.row;var e=k.col;k.setRowAndColumn();var n=t!==k.row;n=n||e!==k.col;n&&q.updateItem(k.id,"CaoInsight",k.row,k.col)}};this.resetFocusOnMouseup=function(){k.isFocused=false};this.setFocusOnInsight=function(t){C(function(){k.isFocused=t})};this.setRowAndColumn=function(){var t=3;D.innerWidth<=1024?t=1:D.innerWidth<=1920&&(t=2);k.row=Math.floor(k.index/t);k.col=k.index%t;k.hideConfidenceText=w[0].clientWidth<390};var F=w.find("#sr-cell-status-label");e.accCallback=function(t,e){var n=t===this.col&&e===this.row;k.tabIndex=n?0:-1;n||k.onInsightBlur();C(function(){k.isFocused=!!n})};this.getChartAddMenuItems=function(t){var e=k.chart.isFound();if(e&&!k.isHidden()){var n=k.chart.getSheetsThisChartAppearsOn()[0];t.addItem({translation:k.getSheetName(n),icon:"goto",tid:"cao-external-link",select:function t(){k.gotoSheet(n)}})}var i=[];k.sheets.forEach(function(t){t.permissions&&t.permissions.update&&i.push({translation:t.qMeta.title,tid:"cao-add-to-sheet",icon:"sheet",select:function n(){e&&(k.isCopyMenuItemSelected=true);k.addChartToSheet(t.qInfo.qId)}})});if(k.permissions&&k.permissions.createSheet&&!k.isHidden()){i.push({translation:"cao.search.add.createNewSheet",tid:"cao-add-to-new-sheet",icon:"plus",select:function t(){k.addToNewSheet()}});if(i.length>0){var a=t.addItem({translation:e?"cao.resultitem.contextMenu.copyItem":"cao.resultitem.contextMenu.addItem",icon:e?"copy":"plus",tid:"cao-add"});i.forEach(function(t){a.addItem(t)})}}};this.getChartMenuItems=function(t){var e={translation:"contextMenu.export",tid:"export",icon:"export",select:function t(){k.exportData()}};k.chart.isDataViewSupported()&&k.interactive&&!k.isHidden()&&t.addItem({translation:k.chart.isViewDataToggled()?"contextMenu.viewSource":"contextMenu.viewData",tid:"toggle-flip-to-table",icon:k.chart.isViewDataToggled()?"back":"table",select:function t(){k.flipToTable()}});if(k.chart.isViewDataToggled())k.enableShare&&k.chart.getObject().supportExportData()&&t.addItem(e);else if(!k.isHidden()){k.insightLearning?k.insightLearning&&k.chart.isModified()&&!k.interactive&&!k.caoTweakEnabled&&t.addItem({translation:"cao.insight.inlinerefresh.indicator.action",tid:"cao-learn",icon:"lightbulb",select:function t(){k.refreshAndLearn()}}):t.addItem({translation:"cao.resultitem.info",tid:"cao-open-info",icon:"info",select:function t(){k.openInfo()}});this.getChartAddMenuItems(t);if(k.enableShare&&(k.chart.getObject().supportExport()||k.chart.getObject().supportExportData())){var n=t.addItem({translation:"contextMenu.exportGroup",tid:"cao-share",icon:"export"});if(k.chart.getObject().supportExport()){n.addItem({translation:"contextMenu.export.chart.image",tid:"cao-print-object-image",select:function t(){k.exportToImage()}});n.addItem({translation:"contextMenu.export.chart.pdf",tid:"cao-print-object-pdf",select:function t(){k.exportToPdf()}})}k.enableShare&&k.chart.getObject().supportExportData()&&n.addItem({translation:"contextMenu.export",tid:"export",select:function t(){k.exportData()}})}k.caoTweakEnabled&&k.chart.isGenerated()&&t.addItem({translation:k.isSelected()?"cao.resultitem.finishEditInsightProperties":"cao.resultitem.editInsightProperties",tid:"cao-editInsightProperties",icon:k.isSelected()?"tick":"edit",select:function t(){k.editInsightProperties()}})}k.isHidden()||t.addItem({translation:k.interactive?"cao.resultitem.collapse":"cao.resultitem.expand",tid:"cao-expandCollapseChart",icon:k.interactive?"collapse":"expand",select:function t(){k.headerAction(k.chart)}});this.insightFeedback&&k.chart.isGenerated()&&t.addItem({translation:this.getFeedbackText(),tid:"cao-hideSuggestedChart",icon:"view",select:function t(){k.sendUserFeedback()}})};this.setChartBlurHandler=function(){this.chart.getObject().setOnBlurHandler(function(){q.setFocus("CaoInsight",k);k.isFocused=true})};this.editorKeyDownHandler=function(t){switch(t.which){case 27:k.headerAction(k.chart).then(function(){k.tabIndex=0;k.isFocused=true});F.text(o.get("Accessibility.Object.CloseFullScreenMode"))}};this.keyDownHandler=function(t){switch(t.which){case q.RIGHT_KEY:case q.LEFT_KEY:case q.UP_KEY:case q.DOWN_KEY:this.contextMenuStatus.open&&P.close();if(0===k.tabIndex){t.stopPropagation();t.preventDefault();this.interactive||q.key(t,"CaoInsight")}break;case 9:if(!k.caoTweakEnabled){t.shiftKey&&P.close();k.onInsightBlur();k.isFocused=!k.isFocused}break;case 13:case 32:P.close();t.stopImmediatePropagation();t.stopPropagation();t.preventDefault();if(!k.chart.isObjectInvalid()&&!k.isHidden()){if(t.shiftKey){k.isFocused=false;k.headerAction(k.chart).then(function(){k.tabIndex=0;k.isFocused=true});F.text(o.get("Accessibility.Object.FullScreenMode"))}else if(k.viewDataSupported()&&k.interactive)k.chart.toggleDataView().then(function(){k.chart.isViewDataToggled()&&F.text(o.get("Accessibility.Object.ViewDataMode"))});else if(k.chart.isViewDataToggled()&&"function"===typeof this.chart.getObject().dataViewObject.focus){k.isFocused=false;this.chart.getObject().dataViewObject.focus()}else if("function"===typeof this.chart.getObject().focus){k.isFocused=false;this.chart.getObject().focus()}else F.text(o.get("Accessibility.Object.CannotViewData"));F.text("")}break;case 27:if(this.contextMenuStatus.open)P.close();else if(this.chart.isViewDataToggled())this.chart.toggleDataView().then(function(){k.chart.isViewDataToggled()||F.text(o.get("Accessibility.Object.ViewChartMode"))});else if(this.interactive){k.headerAction(k.chart).then(function(){k.tabIndex=0;k.isFocused=true});F.text(o.get("Accessibility.Object.CloseFullScreenMode"))}k.isFocused=true;break;case 121:if(t.shiftKey&&!this.contextMenuStatus.open){var n=w.offset();t.pageY=n.top+w.height()/2;t.pageX=n.left+w.width()/2;e.$broadcast("cao.openContextMenu",{event:t,closeFn:function t(){k.isFocused=true},element:w.find(".result-item-graph-container")})}break}};this.onBlur=function(){this.isFocused=false;this.onInsightBlur()};this.$onInit=function(){if(this.interactive){this.tabIndex=0;this.isFocused=true}this.initializeState();this.setRowAndColumn();if(this.interactive)this.tabIndex=0;else{M=q.addItem(this.id,e.accCallback,"CaoInsight",this.col,this.row);this.tabIndex=M?0:-1}d.on("end",this.onResize)};this.$onChanges=function(){this.permissions&&(this.enableShare=this.permissions.exportData)};this.$doCheck=function(){k.caoTweakEnabled&&(k.isSelected()?k.chart.setChartInteractionState(f.STATIC):k.chart.setChartInteractionState(f.ANALYSIS))};this.$onDestroy=function(){k.interactive||q.removeItem("CaoInsight",k.id);t(".qv-cao-scroll-content").unbind("scroll",k.closePopups);d.off("end",this.onResize);g.unsubscribe("cao/insights/adapt_chart");k.shouldFadeToastTimer&&C.cancel(k.shouldFadeToastTimer)};this.isSelected=function(){var t=E.getSelectedChart();return t&&k.chart&&k.chart===t};this.onChartLoaded=function(){this.chartLoaded=true;if(k.caoTweakEnabled){k.chart.activateSelectionWatch(function(){k.chart.isInSelectionState=true});k.chart.deactivateSelectionWatch(function(){k.chart.isInSelectionState=false})}};this.initializeState=function(){t(".qv-cao-scroll-content").bind("scroll",k.closePopups);this.chartLoaded="LOADED"===this.chart.getState();this.chart.refreshChartType();this.matchDetails=this.chart.getMatchDetails()};this.chartClick=function(){!k.chartLoaded||k.headerActionInProgress||k.interactive||k.contextMenuStatus.open||k.isHidden()||k.caoTweakEnabled?k.closePopups():k.headerAction(k.chart)};this.editInsightProperties=function(e){if(e){e.preventDefault();e.stopPropagation();k.caoTweakEnabled&&C(function(){t("button.cao-edit-field-header-title.lui-button").first().focus()})}if(this.caoTweakEnabled&&this.chartLoaded&&!this.headerActionInProgress){k.closePopups();if(this.isSelected()){E.clearSelection();v.storageObj(k.app.id).contextPanel||g.publish("cao/insight/contextPanelToggled",false);g.publish("cao/insight/editInsightProperties",false)}else{k.isCaoContextPanelVisible||g.publish("cao/insight/contextPanelToggled",true);g.publish("cao/insight/editInsightProperties",true);E.selectChart(k.chart)}}};this.sendUserFeedback=function(){k.chart.setModified(false);k.feedbackInProgress=true;k.isHidden()||u.trackEvent(u.customEvents.INSIGHTS_HIDE_CHART_CLICKED,{chart:k.chart.getAnalysisPrecedentId()});k.sendFeedback({chart:k.chart,type:h.Precedents.PrecedentTypes.Dislike}).then(function(){k.interactive&&k.headerAction(k.chart)}).finally(function(){k.feedbackInProgress=false})};this.adaptChart=function(t){if(k.chart===t){k.chart.getTitle().then(function(t){k.dataMode&&(k.dataMode=false);k.title=t});k.shouldFadeToast=false;k.shouldFadeToastTimer=C(function(){k.shouldFadeToast=true},5e3)}};g.subscribe("cao/insights/adapt_chart",k.adaptChart);this.refreshAndLearn=function(){k.feedbackInProgress=true;k.sendFeedback({chart:k.chart,type:h.Precedents.PrecedentTypes.Like}).then(function(){k.interactive&&k.headerAction(k.chart)}).finally(function(){u.trackEvent(u.customEvents.INSIGHTS_LEARN_CLICKED);k.feedbackInProgress=false;k.chart.setModified(false)})};this.isHidden=function(){return k.chart.isHidden()};this.getFeedbackText=function(){return k.chart.isHidden()?"cao.card.unhide":"cao.card.hide"};this.addChartToSheet=function(t){k.isChartAdded=true;k.chart.addToSheet(t).then(function(t){L(t)})};this.addToNewSheet=function(){k.chart.addToNewSheet().then(function(t){L(t)})};this.exportToPdf=function(){k.setFocusOnInsight(false);u.trackEvent(u.customEvents.INSIGHTS_EXPORT,{type:"PDF",chart:k.chart.getAnalysisPrecedentId()});var t=s.showForObject(k.chart.getObject(),"Pdf","object",640,480);t.closed.then(function(){k.setFocusOnInsight(true)});k.closePopups()};this.exportToImage=function(){k.setFocusOnInsight(false);u.trackEvent(u.customEvents.INSIGHTS_EXPORT,{type:"IMAGE",chart:k.chart.getAnalysisPrecedentId()});var t=s.showForObject(k.chart.getObject(),"Image","object",640,480);t.closed.then(function(){k.setFocusOnInsight(true)});k.closePopups()};this.exportData=function(){k.setFocusOnInsight(false);u.trackEvent(u.customEvents.INSIGHTS_EXPORT,{type:"DATA",chart:k.chart.getAnalysisPrecedentId()});var t=T.show(k.chart.getModel());t.closed.then(function(){k.setFocusOnInsight(true)});k.closePopups()};this.navigateToSheet=function(t){k.closePopups();m.toggleCao();i.goToSheet(t,Object.keys(a.States)[a.state])};this.gotoSheet=function(){if(1===k.chart.getSheetsThisChartAppearsOn().length)k.navigateToSheet(k.chart.getSheetsThisChartAppearsOn()[0]);else{var t=["$scope",function(t){t.appearsOnSheets=k.chart.getSheetsThisChartAppearsOn();t.getSheetName=k.getSheetName;t.gotoSheet=k.navigateToSheet}];N(x,t,w.find(".gotoSheet")[0],"top")}};this.confidenceClosed=function(){k.headerActionInProgress=false};this.confidenceOpened=function(){k.headerActionInProgress=true};this.closeConfidenceRegistration=function(t){O=t};this.closePopups=n.throttle(function(){O&&O();$.forEach(function(t,e){C(function(){t.close();$.splice(e,1)})});k.headerActionInProgress=false},200,{trailing:false});this.openAddPopover=function(){var t=["$scope",function(t){t.sheets=k.sheets;t.addChartToSheet=k.addChartToSheet;t.addToNewSheet=k.addToNewSheet;t.permissions=k.permissions}];N(b,t,w.find(".add-to-button")[0],"bottom")};this.openDebugInformation=function(){var t=["$scope",function(t){t.debugInformation=k.chart.getSearchReport();t.visualization=k.chart.chart.visualization;t.complexity=k.chart.chart.complexity}];N(S,t,w.find(".debug-information")[0],"bottom")};this.openShare=function(){if(k.popupOpen)k.popupOpen=false;else{k.popupOpen=true;var t=["$scope",function(t){if(!k.chart.isViewDataToggled()&&k.chart.getObject().supportExport()){t.exportToPdf=k.exportToPdf;t.exportToImage=k.exportToImage}k.chart.getObject().supportExportData()&&(t.exportData=k.exportData)}];N(y,t,w.find(".share")[0],"bottom")}};this.openInfo=function(){var t=function t(){C(function(){k.isFocused=true})};C(function(){k.isFocused=false});var e=["$scope",function(t){t.type=k.chart.chart.visualization.type;t.title=k.chart.isGenerated()?"cao.search.info.title.generated":"cao.search.info.title.found";t.matches=[];k.matchDetails&&k.matchDetails.forEach(function(e){var n="";var i="";if(k.chart.isGenerated()){switch(e.matchedOn){case"exactMatch":n=o.get("cao.search.generated.exactMatch");break;case"literalMatch":n=o.get("cao.search.generated.literalMatch");break;case"headMatch":n=o.get("cao.search.generated.headMatch");break;case"headSynonymMatch":n=o.get("cao.search.generated.headSynonymMatch");break;case"headStemMatch":n=o.get("cao.search.generated.headStemMatch");break;case"headStemSynonymMatch":n=o.get("cao.search.generated.headStemSynonymMatch");break;case"partialTokenMatch":n=o.get("cao.search.generated.partialTokenMatch");break;case"substrPartialMatch":n=o.get("cao.search.generated.substrPartialMatch");break;case"semanticMatch":n=o.get("cao.search.generated.semanticMatch");break;case"valueMatch":n=o.get("cao.search.generated.valueMatch");break;default:break}n=n.replace(/\{1\}/g,function(t){return"<b>"+t+"</b>"});i=o.get(n,[k.chart.getSearchReport().search.searchPhrase.text,e.matchedField]);t.matches.push(i)}else if(k.chart.isFound()){switch(e.matchedField){case"titleMatch":n=o.get("cao.search.titleMatch");break;case"subTitleMatch":n=o.get("cao.search.subTitleMatch");break;case"footnoteMatch":n=o.get("cao.search.footnoteMatch");break;case"basedOnMatch":n=o.get("cao.search.basedOnMatch");break;default:break}n=n.replace(/\{1\}/g,function(t){return"<b>"+t+"</b>"});i=o.get(n,[k.chart.getSearchReport().search.searchPhrase.text,e.matchedOn]);t.matches.push(i)}});t.formattedSheetLinks=[];var e=o.get("cao.search.info.found.match");e=e.replace(/\{0\}/g,function(t){return"<b>"+t+"</b>"});k.chart.getSheetsThisChartAppearsOn().forEach(function(n){var i=k.getSheetName(n);var a=o.get(e,[i]);t.formattedSheetLinks.push({label:a,sheetId:n})});t.gotoSheet=k.navigateToSheet}];N(I,e,w.find(".info")[0],"bottom",t)};this.getSheetName=function(t){var e=k.sheets.filter(function(e){return e.qInfo.qId===t})[0];if(e)return e.qMeta.title};function N(t,e,n,i,a){var s={template:t,controller:e,dock:i,closeOnResize:true,alignTo:n};var o=A.show(s);$.push(o);o.closed.then(function(){k.headerActionInProgress=false;k.popupOpen=false;"function"===typeof a&&a()});k.headerActionInProgress=true}function L(t){m.scrapeApp();u.trackEvent(u.customEvents.INSIGHTS_ADD_CHART,{chart:k.chart.getAnalysisPrecedentId()});k.closePopups();C(function(){w.find(".result-item-buttons").addClass("animate")});C(function(){k.addedToSheet=true;k.chart.getSheetsThisChartAppearsOn().indexOf(t.id)>-1&&(k.isCopyMenuItemSelected?k.addOrCopySuccessText="cao.insight.copiedToSheet":k.addOrCopySuccessText="cao.search.addedToSheet");p.resizeCharts(D);C(function(){w.find(".result-item-added").addClass("animate")})},500);C(function(){w.find(".goto-sheet").addClass("animate")},2500);C(function(){k.addedToSheet=false;w.find(".goto-sheet").removeClass("animate");w.find(".result-item-added").removeClass("animate");w.find(".result-item-buttons").removeClass("animate")},4e3)}this.flipToTable=function(){var t=k.chart.isDataViewSupported()&&k.interactive;if(t){u.trackEvent(u.customEvents.INSIGHTS_FLIP_TO_TABLE);k.chart.toggleDataView();k.dataMode=!k.dataMode}};this.viewDataSupported=function(){return k.chart.isDataViewSupported()};e.$watch(function(){return t(".qv-contextmenu").length},function(){if(0===t(".qv-contextmenu").length)C(function(){k.chart.setChartInteraction(true);k.contextMenuStatus={open:0!==t(".qv-contextmenu").length}},300);else{k.chart.setChartInteraction(false);k.contextMenuStatus={open:true}}});e.$watch(function(){return k.chart.shouldRedraw},function(){k.chart.getTitle().then(function(t){k.dataMode&&(k.dataMode=false);k.title=t})})}];var w={transclude:true,template:m,bindings:{chart:"<",app:"<",headerAction:"<",headerIcon:"@",interactive:"<",direction:"<",sheets:"<",alwaysShowHeader:"<",scrollContainer:"<",debug:"<",permissions:"<",index:"<",gridScreenReader:"=",onInsightBlur:"&",onInsightFocus:"&",sendFeedback:"&",isCaoContextPanelVisible:"<"},controller:q};return e.nativeComponent("qvCaoInsight",w)}.apply(e,i),void 0!==a&&(t.exports=a))},913:function(t,e){t.exports='<div class="cao-insight">\n\t<div class="cao-insight-in-selection-overlay" ng-if="$ctrl.chart.isInSelectionState && $ctrl.caoTweakEnabled"></div>\n\t<div class="cao-insight-container" ng-class="{\'zoom\': $ctrl.interactive, \'hidden\': $ctrl.isHidden(), \'generated\': $ctrl.chart.isGenerated(), \'lightedit\': $ctrl.lightEditing && !$ctrl.caoTweakEnabled, \'selected\': $ctrl.isSelected()}" tabindex="{{$ctrl.tabIndex}}"\n\t\tng-keydown="$ctrl.keyDownHandler($event)" focus-when="$ctrl.isFocused" ng-focus="$ctrl.onInsightFocus()" dir="{{$ctrl.direction}}" test-chart-loaded="{{$ctrl.chartLoaded}}">\n\t\t<div class="hidden-screen-reader-label" aria-label="{{$ctrl.gridScreenReader}}"></div>\n\t\t<label class="hidden-screen-reader-label" id="sr-cell-status-label" aria-live="assertive"></label>\n\t\t<div class="result-item-title-bar" dir="{{$ctrl.direction}}" ng-class="{ \'interactive\': $ctrl.interactive}">\n\t\t\t<div class="result-item-title" title="{{ $ctrl.title }}" qva-direction x-dir-setting="{{$ctrl.direction}}" x-dir-text="{{$ctrl.title}}" ng-click="$ctrl.editInsightProperties($event)" tid="insight-chart-edit-button">\n\t\t\t\t<span>{{ $ctrl.title }}</span>\n\t\t\t</div>\n\t\t\t<div class="result-item-title-icons" ng-class="{ \'active\': $ctrl.headerActionInProgress || $ctrl.interactive || $ctrl.isSelected() }" q-title-translation="cao.resultitem.info">\n\t\t\t\t<button ng-click="$ctrl.openInfo()" ng-keyup="$event.keyCode == 13 ? $ctrl.openInfo() : null" class="insight-chart-info-button result-item-title-icon" ng-show="!$ctrl.insightLearning && $ctrl.chartLoaded && !$ctrl.isHidden()">\n\t\t\t\t\t<span class="info lui-icon lui-icon--info"></span>\n\t\t\t\t</button>\n\t\t\t\t<button ng-if="$ctrl.caoTweakEnabled && !$ctrl.isSelected() && $ctrl.chart.isGenerated()" class="result-item-title-icon" ng-click="$ctrl.editInsightProperties($event)" ng-keyup="$event.keyCode == 13 ? $ctrl.editInsightProperties($event) : null"\n\t\t\t\t\tq-title-translation="cao.resultitem.editInsightProperties" tid="insight-chart-edit-properties-button" ng-show="$ctrl.chartLoaded && !$ctrl.isHidden()">\n\t\t\t\t\t<span class="lui-icon--edit lui-icon"></span>\n\t\t\t\t</button>\n\t\t\t\t<button ng-if="$ctrl.caoTweakEnabled && $ctrl.isSelected()" class="result-item-title-icon" ng-click="$ctrl.editInsightProperties($event)" ng-keyup="$event.keyCode == 13 ? $ctrl.editInsightProperties($event) : null" q-title-translation="cao.resultitem.finishEditInsightProperties"\n\t\t\t\t\ttid="insight-chart-finish-edit-properties-button" ng-show="$ctrl.chartLoaded">\n\t\t\t\t\t<span class="lui-icon--tick lui-icon result-item-title-icon-checkmark"></span>\n\t\t\t\t</button>\n\t\t\t\t<button ng-click="$ctrl.openShare()" ng-keyup="$event.keyCode == 13 ? $ctrl.openShare() : null" class="result-item-title-icon" ng-if="$ctrl.enableShare" q-title-translation="contextMenu.exportGroup" tid="insight-chart-export-button" ng-show="$ctrl.chartLoaded && !$ctrl.isHidden()">\n\t\t\t\t\t<span class="share lui-icon lui-icon--export"></span>\n\t\t\t\t</button>\n\t\t\t\t<button ng-click="$ctrl.openDebugInformation()" ng-keyup="$event.keyCode == 13 ? $ctrl.openDebugInformation() : null" class="result-item-title-icon" ng-if="$ctrl.debug">\n\t\t\t\t\t<span class="debug-information lui-icon lui-icon--cogwheel"></span>\n\t\t\t\t</button>\n\t\t\t\t<button tabindex="0" ng-if="!$ctrl.interactive" class="result-item-title-icon" ng-click="$ctrl.headerAction($ctrl.chart)" ng-keyup="$event.keyCode == 13 ? $ctrl.headerAction($ctrl.chart) : null" q-title-translation="cao.resultitem.expand" tid="insight-chart-expand-button"\n\t\t\t\t\tng-show="$ctrl.chartLoaded && !$ctrl.isHidden()">\n\t\t\t\t\t<span class="qv-cao-item-expand-icon lui-icon" ng-class="$ctrl.headerIcon"></span>\n\t\t\t\t</button>\n\t\t\t\t<button ng-if="$ctrl.interactive" class="result-item-title-icon" ng-click="$ctrl.headerAction($ctrl.chart)" ng-keyup="$event.keyCode == 13 ? $ctrl.headerAction($ctrl.chart) : null" q-title-translation="cao.resultitem.collapse" tid="zoomed-chart-shrink-button">\n\t\t\t\t\t<span class="lui-icon--remove lui-icon"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="chart-container">\n\t\t\t<div class="insight">\n\t\t\t\t<qv-cao-insight-chart set-blur-handler="$ctrl.setChartBlurHandler()" get-chart-menu-items="$ctrl.getChartMenuItems(menu)" ng-click="$ctrl.chartClick(id)" class="result-item-graph" chart="$ctrl.chart" app="::$ctrl.app" on-chart-loaded="$ctrl.onChartLoaded()"\n\t\t\t\t\tinteractive="$ctrl.interactive" scroll-container="$ctrl.scrollContainer" object="$ctrl.object" ng-class="{\'clickable\': !$ctrl.contextMenuStatus.open}" context-menu-status="$ctrl.contextMenuStatus" index="$ctrl.index" />\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="result-item-footer" dir="{{$ctrl.direction}}">\n\t\t\t<div ng-if="$ctrl.chart.isGenerated()" aria-hidden="true" class="result-item-buttons" ng-show="!$ctrl.addedToSheet">\n\t\t\t\t<div class="footer-left" ng-if="!$ctrl.interactive">\n\t\t\t\t\t<cao-confidence ng-if="!$ctrl.caoTweakEnabled" class="result-item-title-icon" data-chart="$ctrl.chart" button-id="confidence_{{$parent.$parent.$parent.$parent.$index}}" ng-show="$ctrl.insightLearning" close-notification="$ctrl.closeConfidenceRegistration(handler)"\n\t\t\t\t\t\topened="$ctrl.confidenceOpened()" closed="$ctrl.confidenceClosed()" hide-text="$ctrl.hideConfidenceText"></cao-confidence>\n\t\t\t\t\t<span class="title generated-insight-title" ng-show="!$ctrl.insightLearning" q-translation="cao.search.card.generated" aria-label="{{$ctrl.generatedChartScreenReaderLabel}}"></span>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="footer-right">\n\t\t\t\t\t<div class="feedback-button-container" ng-if="$ctrl.insightFeedback && !$ctrl.caoTweakEnabled" qva-direction x-dir-setting="{{$ctrl.direction}}">\n\t\t\t\t\t\t<lui-button tid="insight-feedback-button" ng-click="$ctrl.sendUserFeedback()" ng-disabled="!$ctrl.chartLoaded || $ctrl.feedbackInProgress" tabindex="-1" q-translation="{{$ctrl.getFeedbackText()}}"\n\t\t\t\t\t\t\tng-class="{\'btn-state-unhide\': $ctrl.chart.isHidden(), \'btn-state-hide\': !$ctrl.chart.isHidden()}">\n\t\t\t\t\t\t</lui-button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="lui-buttongroup" tid="cao-add-to-sheet-button" ng-if="$ctrl.activeSheet.layout.permissions.update && $ctrl.permissions.createSheet">\n\t\t\t\t\t\t<lui-button ng-click="$ctrl.addChartToSheet()" tabindex="-1" ng-disabled="!$ctrl.chartLoaded || $ctrl.isChartAdded" q-translation="cao.search.addToSheet">\n\t\t\t\t\t\t</lui-button>\n\t\t\t\t\t\t<lui-button class="add-to-button" tabindex="-1" q-title-translation="cao.search.addToSheetOptions" ng-disabled="!$ctrl.chartLoaded" ng-click="$ctrl.openAddPopover()">\n\t\t\t\t\t\t\t<span class="lui-overlay-button__caret lui-caret"></span>\n\t\t\t\t\t\t</lui-button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="lui-buttongroup" ng-if="!$ctrl.activeSheet.layout.permissions.update && $ctrl.permissions.createSheet">\n\t\t\t\t\t\t<lui-button class="add-to-button" tabindex="-1" q-title-translation="cao.search.addToSheetOptions" ng-disabled="!$ctrl.chartLoaded" ng-click="$ctrl.openAddPopover()">\n\t\t\t\t\t\t\t<span q-translation="cao.search.addToSheet"></span>\n\t\t\t\t\t\t\t<span class="lui-overlay-button__caret lui-caret"></span>\n\t\t\t\t\t\t</lui-button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div ng-if="$ctrl.chart.isFound()" ng-class="{ \'itemAdded\': $ctrl.addedToSheet }" class="result-item-added result-item-buttons">\n\t\t\t\t<span>\n\t\t\t\t\t<div class="goto-sheet" ng-show="$ctrl.addedToSheet">\n\t\t\t\t\t\t<span class="tick-highlight" qva-direction x-dir-setting="{{$ctrl.direction}}">\n\t\t\t\t\t\t\t<span class="lui-icon lui-icon--tick"></span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span q-translation="{{$ctrl.addOrCopySuccessText}}"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</span>\n\t\t\t\t<a ng-click="$ctrl.gotoSheet($ctrl.chart.getSheetsThisChartAppearsOn()[0])" q-title-translation="Storytelling.Sheet.GoToSheet">\n\t\t\t\t\t<span ng-if="$ctrl.chart.getSheetsThisChartAppearsOn().length === 1" x-dir-text="{{ $ctrl.getSheetName($ctrl.chart.getSheetsThisChartAppearsOn()[0]) }}" qva-direction x-dir-setting="{{$ctrl.direction}}">\n\t\t\t\t\t\t{{ $ctrl.getSheetName($ctrl.chart.getSheetsThisChartAppearsOn()[0]) }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span ng-if="$ctrl.chart.getSheetsThisChartAppearsOn().length > 1" q-translation="cao.search.multipleSources">\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class="gotoSheet lui-icon lui-icon--goto" qva-direction x-dir-setting="{{$ctrl.direction}}"></span>\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="editor cao-chart-light-editing" ng-if="$ctrl.lightEditing && $ctrl.interactive && $ctrl.chart.isGenerated() && !$ctrl.caoTweakEnabled" ng-keydown="$ctrl.editorKeyDownHandler($event)">\n\t\t\x3c!-- TODO: move to directive --\x3e\n\t\t<div class=\'qv-panel-properties\' style="overflow: auto;">\n\t\t\t<qv-cao-insight-editor chart="$ctrl.chart" app="$ctrl.app" />\n\t\t</div>\n\t</div>\n\t<div class="cao-chart-refresh-indicator-container" ng-class="{\'visible\': $ctrl.insightLearning && $ctrl.chart.isModified() && !$ctrl.interactive && !$ctrl.shouldFadeToast, \'fade\': $ctrl.shouldFadeToast}" ng-if="$ctrl.insightLearning && $ctrl.chart.isModified() && !$ctrl.interactive" ng-click="$ctrl.adaptChart($ctrl.chart)">\n\t\t<div class="cao-chart-refresh-indicator-content">\n\t\t\t<div class="cao-chart-refresh-top">\n\t\t\t\t<span class="lui-icon lui-icon--close" ng-click="$ctrl.chart.setModified(false)"></span>\n\t\t\t</div>\n\t\t\t<div class="cao-chart-text" ng-class="{\'cao-chart-text-no-refresh\': $ctrl.caoTweakEnabled}">\n\t\t\t\t<div q-translation="cao.insight.inlinerefresh.indicator.body.lineone" />\n\t\t\t\t<div q-translation="cao.insight.inlinerefresh.indicator.body.linetwo" />\n\t\t\t</div>\n\t\t\t<div class="cao-chart-refresh-indicator-action-container">\n\t\t\t\t<div class="cao-chart-refresh-action">\n\t\t\t\t\t<a class="cao-chart-refresh" ng-click="$ctrl.refreshAndLearn()" q-translation="cao.insight.inlinerefresh.indicator.action" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'},914:function(t,e){t.exports='<lui-popover class="cao-add-popover">\n\t<div class="lui-popover__body lui-nopad popover-body">\n\t\t<ul class="lui-list">\n\t\t\t<li class="lui-list__item lui-list__action" ng-click="addChartToSheet(sheet.qInfo.qId)" ng-repeat="sheet in sheets"\n\t\t\t ng-if="sheet.permissions.update">\n\t\t\t\t<span class="lui-list__aside lui-icon lui-icon--sheet"></span>\n\t\t\t\t<span class="lui-list__text">{{ sheet.qMeta.title }}</span>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item lui-list__action" ng-click="addToNewSheet()">\n\t\t\t\t<span class="lui-list__aside lui-icon lui-icon--plus"></span>\n\t\t\t\t<span class="lui-list__text" q-translation="cao.search.add.createNewSheet"></span>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</lui-popover>'},915:function(t,e){t.exports='<lui-popover class="cao-debug-popover">\n\t<lui-popover-body>\n\t\t<div>\n\t\t\t<b>Debug Information</b>\n\t\t\t<pre>{{ debugInformation | json : spacing }}</pre>\n\t\t\t<b ng-if="visualization.type === \'generated\'">Visualization</b>\n\t\t\t<pre ng-if="visualization.type === \'generated\'">{{ visualization | json : spacing }}</pre>\n\t\t\t<b ng-if="visualization.type === \'generated\'">Complexity</b>\n\t\t\t<pre ng-if="visualization.type === \'generated\'">Estimate: {{ complexity }}</pre>\n\n\t\t\t<b ng-if="visualization.type === \'found\'">Chart</b>\n\t\t\t<pre ng-if="visualization.type === \'found\'">\n{\n  chartId: {{ visualization.chartId }},\n  appearsOnSheets: {{ visualization.appearsOnSheets | json : spacing }}}\n\t\t\t</pre>\n\t\t</div>\n\t</lui-popover-body>\n</lui-popover>\n'},916:function(t,e){t.exports='<lui-popover class="cao-share-popover">\n\t<div class="lui-popover__body lui-nopad popover-body">\n\t\t<ul class="lui-list">\n\t\t\t<li class="lui-list__item lui-list__action" ng-if="exportToImage" ng-click="exportToImage()" tid="share-popover-export-image">\n\t\t\t\t<a class="lui-list__text" q-translation="contextMenu.export.chart.image"></a>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item lui-list__action" ng-if="exportToPdf" ng-click="exportToPdf()" tid="share-popover-export-pdf">\n\t\t\t\t<a class="lui-list__text" q-translation="contextMenu.export.chart.pdf"></a>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item lui-list__action" ng-if="exportData" ng-click="exportData()" tid="share-popover-export-data">\n\t\t\t\t<a class="lui-list__text" q-translation="contextMenu.export"></a>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</lui-popover>'},917:function(t,e){t.exports='<lui-popover class="cao-info-popover">\n    <lui-popover-body>\n        <div>\n            <ul>\n                <li class="cao-popover-title" q-translation="{{ title }}"></li>\n                <li ng-repeat="match in matches" ng-bind-html="match"></li>\n                <li ng-if="matches.length === 0 && type === \'generated\'" q-translation="cao.search.info.body.generated"></li>\n                <li ng-repeat="sheet in formattedSheetLinks">\n                    <a class="gotoSheet" ng-click="gotoSheet(sheet.sheetId)">\n                        <span ng-bind-html="sheet.label"></span>\n                        &nbsp; <span class="lui-icon lui-icon--goto"></span>\n                    </a>\n                </li>\n            </ul>\n        </div>\n    </lui-popover-body>\n</lui-popover>\n'},918:function(t,e){t.exports='<lui-popover class="cao-goto-sheet-popover">\n    <div class="lui-popover__body lui-nopad popover-body">\n        <ul class="lui-list">\n            <li class="lui-list__item lui-list__action" ng-repeat="sheet in appearsOnSheets track by $index" ng-click="gotoSheet(sheet)">\n                <span class="lui-list__aside lui-icon lui-icon--goto"></span>\n                <span class="lui-list__text">{{ getSheetName(sheet) }}</span>\n            </li>\n        </ul>\n    </div>\n</lui-popover>'},919:function(t,e,n){"use strict";var i,a;!(i=[n(48)],a=function(t){var e={restrict:"A",scope:{focusWhen:"="},controller:["$scope","$element",function(t,e){t.$watch("focusWhen",function(t){t?e.focus():false===t&&e.blur()})}]};t.directive("focusWhen",function(){return e})}.apply(e,i),void 0!==a&&(t.exports=a))},920:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(91),n(103),n(49),n(196),n(187),n(178),n(921),n(922),n(923),n(924),n(925),n(926),n(927),n(930),n(218),n(932),n(221)],a=function(t,e,n,i,a,s,o,r,l,c,u,d){var p=["qvCaoSearchService","qvCaoService","qvCaoChartService","qvAppDetailsService","luiPopover",function(t,l,p,h,g){var f=this;var v=[];var m;this.insightLearning=a.getFlag("CE_PRECEDENTS");this.caoTweakEnabled=a.getFlag("CAO_TWEAK");this.$onInit=function(){h.get().then(function(t){m=t.model.app.published||!t.model.permissions.update});e.subscribe(s.PUBSUB_TOPIC,I)};this.$onDestroy=function(){e.unsubscribe(s.PUBSUB_TOPIC)};function b(t){f.chart.setModified(f.chart.isModified()||!t&&f.chart.getMatches().filter(function(t){return t.isDirty}).length>0);f.chart.adaptChart(f.chart.isModified()).then(function(){S()});e.publish("cao/insights/adapt_chart",f.chart)}function S(){v.forEach(function(t,e){t.popup.close();v.splice(e,1)})}function y(t){v.forEach(function(e,n){t===e.id&&v.splice(n,1)})}function I(t){var e=f.chart.getMatches();var n=t.slotA;var a=t.slotB;var s,o;e.forEach(function(t,e){t.slot===n?s=e:t.slot===a&&(o=e)});var r=e[o];e[o]=e[s];e[s]=r;e[o].slot=a;e[s].slot=n;i.trackEvent(i.customEvents.INSIGHTS_LIGHT_EDITING_DRAG_AND_DROP,{chart:f.chart.getAnalysisPrecedentId()});b(true)}this.toggleMatchDetails=function(t){t.expanded=!t.expanded};this.getFields=function(){return f.chart.getMatches().filter(function(t){return!t.slotRole})};this.getMeasures=function(){return f.chart.getMatches().filter(function(t){return t.slotRole===s.MEASURE})};this.getDimensions=function(){return f.chart.getMatches().filter(function(t){return t.slotRole===s.DIMENSION})};this.getDimensionCount=function(){return f.getDimensions().length};this.getMeasureCount=function(){return f.getMeasures().length};this.getFieldCount=function(){return f.getFields().length};this.hasMeasures=function(){return f.chart.getMatches().filter(function(t){return t.slotRole===s.MEASURE}).length>0};this.hasDimensions=function(){return f.chart.getMatches().filter(function(t){return t.slotRole===s.DIMENSION}).length>0};this.applyLearning=function(){p.refreshInsights().then(function(t){var n=t.recommendations.filter(function(t){return t.chart.visualization.visualization.analysis.analysis===f.chart.chart.visualization.visualization.analysis.analysis})[0];if(n){f.chart.chart.visualization=n.chart.visualization;delete f.chart.rendered;f.chart.shouldRedraw=true;f.chart.recalculateConfidence=true}else f.chart.invalidFromLearning=true;l.setRefreshIndicatorVisibility(true);e.publish("cao/insight/learning_applied")})};this.changeAggr=function(t,e){f.chart.getMatches().forEach(function(n){if(n.slot===t.slot){n.isDirty=true;n.aggr=e}});i.trackEvent(i.customEvents.INSIGHTS_LIGHT_EDITING_AGGREGATION_CHANGE,{chart:f.chart.getAnalysisPrecedentId()});b()};this.changeField=function(t,e){f.lastAggr=t.aggr||f.lastAggr;f.chart.getMatches().forEach(function(n){if(n.slot===t.slot){n.isDirty=true;f.caoTweakEnabled&&f.toggleMatchDetails(n);if(e.libId){n.libId=e.libId;n.libIdLabel=e.libIdLabel;delete n.field;delete n.aggr}else{n.field=e.name;n.slotRole!==s.MEASURE||n.aggr||(n.aggr=f.lastAggr);delete n.libId;delete n.libIdLabel}}});i.trackEvent(i.customEvents.INSIGHTS_LIGHT_EDITING_FIELD_CHANGE,{chart:f.chart.getAnalysisPrecedentId()});b()};this.showChangeAggr=function(t,e){var n=["$scope",function(t){t.field=e;t.change=f.changeAggr;t.wrappedAggregations=o.COMMON_FUNCTIONS.map(function(t){return{text:r.getFormattedAggregation(t),action:function n(){f.changeAggr(e,r.getFormattedAggregation(t))}}})}];x(c,n,t.currentTarget,"bottom","cao-changeAggregation_"+e.slot)};this.canChangeAggregation=function(t){if(!t.restrictions)return true;var e=t.restrictions.filter(function(t){return"aggregation"===t.name})[0];return!e};this.showChangeField=function(e,n,i){var a=["$scope",function(e){var a=[];var o=[];var r=[];var l=n.restrictions?n.restrictions.filter(function(t){return"candidates"==t.name})[0]:void 0;function c(t){if(!l)return true;return l.types.indexOf(t)>-1}function u(t){a=c("eField")?t.filter(function(t){return!t.masterItem}):[];o=c("eDimLib")?t.filter(function(t){return t.masterItem&&t.classifications.filter(function(t){return t===s.DIMENSION}).length>0}):[];r=c("eMsrLib")?t.filter(function(t){return t.masterItem&&t.classifications.filter(function(t){return t===s.MEASURE}).length>0}):[];e.field=n;e.fields=a;if(i===s.DIMENSION){e.dimensions=o;e.measures=[]}else if(i===s.MEASURE){e.measures=r;e.dimensions=[]}else{e.dimensions=o;e.measures=r}}function d(n){var i=t.getMatchingFields(n,m);e.highlight=n;u(i)}var p=t.getMatchingFields(void 0,m);u(p);e.change=f.changeField;e.filterFields=d}];x(u,a,e.currentTarget,"bottom","cao-changeField_"+n.slot);f.caoTweakEnabled&&f.toggleMatchDetails(n)};this.showAnalysisInfo=function(t){var e=["$scope",function(t){var e=f.chart.chart.visualization.visualization.analysis.analysis;var i=n.get("cao.insight.analysis."+e);t.analysisTitle=n.get("cao.insight.analysis.popover.title",[i]);t.analysisDescription=n.get("cao.insight.analysis."+e+".description")}];x(d,e,t.currentTarget,"left","cao_analysisPopover")};function x(t,e,n,i,a){if(v.filter(function(t){return t.id===a})[0]){S();return}S();var s={template:t,controller:e,dock:i,alignTo:n,closeOnResize:true,outsideIgnore:a};var o=g.show(s);o.closing.then(function(){y(a)});o.closed.then(function(){n.focus()});v.push({id:a,popup:o})}}];var h={transclude:true,template:l,bindings:{chart:"=",app:"="},controller:p};return t.nativeComponent("qvCaoInsightEditor",h)}.apply(e,i),void 0!==a&&(t.exports=a))},921:function(t,e){t.exports='<div class="title" q-translation="cao.card.title.editor.title" ng-if="!$ctrl.caoTweakEnabled" />\n<div class="cao-editor-field-list">\n    <div class="header">\n        <span q-translation="cao.editor.title" />\n        <a ng-click="$ctrl.showAnalysisInfo($event)" id="cao_analysisPopover" qva-outside-ignore-for="cao_analysisPopover">\n            <span class="lui-icon lui-icon--help" />\n        </a>\n    </div>\n    <div class="analysis-type">\n        <span tid="analyis-type-string" q-translation="{{\'cao.insight.analysis.\' + $ctrl.chart.getChartType()}}" />\n    </div>\n\n    \x3c!--- GENERIC FIELDS --\x3e\n    <div class="header" ng-if="!$ctrl.hasDimensions() && !$ctrl.hasMeasures()">\n        <span q-translation="cao.fieldPicker.tab.fields">\n    </div>\n    <div class="cao-edit-field qv-pp-sortable" qv-cao-field-drop-zone data-slot="{{match.slot}}" data-slot-role="{{match.slotRole}}"\n        ng-repeat="match in $ctrl.getFields()">\n        <div class="cao-edit-field-header" ng-class="{\'draggable\': $ctrl.fieldCount > 1}" qv-cao-field-draggable\n            data-slot="{{match.slot}}" data-slot-role="{{match.slotRole}}">\n            \x3c!-- Header title --\x3e\n            <button class="cao-edit-field-header-title lui-button" ng-click="$ctrl.showChangeField($event, match)" qva-outside-ignore-for="{{\'cao-changeField_\' + match.slot}}">\n                <span ng-if="match.field" ng-class="{\'cao-edit-field-span\' : $ctrl.caoTweakEnabled}">\n                    {{ match.field }}\n                </span>\n                <span ng-if="match.libIdLabel" ng-class="{\'cao-edit-field-span\' : $ctrl.caoTweakEnabled}">\n                    {{ match.libIdLabel }}\n\t\t\t\t</span>\n\t\t\t\t<div class="cao-field-caret-container" ng-if="$ctrl.insightLearning && $ctrl.caoTweakEnabled">\n\t\t\t\t\t<span class="lui-icon lui-button__icon cao-edit-expander-span" ng-class="{\'lui-icon--arrow-right\' : !match.expanded, \'lui-icon--arrow-down\': match.expanded}"></span>\n\t\t\t\t</div>\n            </button>\n            \x3c!-- Header icons --\x3e\n            <button class="lui-button cao-edit-expander" ng-if="!$ctrl.caoTweakEnabled" ng-show="$ctrl.insightLearning" ng-click="$ctrl.toggleMatchDetails( match )">\n                <span class="lui-icon lui-button__icon" ng-class="{\'lui-icon--arrow-right\' : !match.expanded, \'lui-icon--arrow-down\': match.expanded}"></span>\n            </button>\n            <i class="lui-icon lui-icon--draggable cao-edit-field-draggable cao-edit-sortable-handle" ng-if="$ctrl.getFieldCount() > 1"\n                q-title-translation="Common.Move"></i>\n        </div>\n\n        <qv-cao-field-details ng-if="$ctrl.insightLearning && !$ctrl.caoTweakEnabled" class="cao-edit-field-details" data-match="match"\n            data-apply-callback="$ctrl.applyLearning" field-id="details_field_{{$index}}" chart="$ctrl.chart" ng-show="match.expanded" />\n    </div>\n\n\n    \x3c!--- DIMENSIONS--\x3e\n    <div class="header" ng-if="$ctrl.hasDimensions()">\n        <span q-translation="cao.fieldPicker.tab.dimensions">\n    </div>\n    <div class="cao-edit-field qv-pp-sortable" qv-cao-field-drop-zone data-slot="{{match.slot}}" data-slot-role="{{match.slotRole}}"\n        ng-repeat="match in $ctrl.getDimensions()">\n        <div class="cao-edit-field-header" ng-class="{\'draggable\': $ctrl.dimensionCount > 1}" qv-cao-field-draggable\n            data-slot="{{match.slot}}" data-slot-role="{{match.slotRole}}">\n            \x3c!-- Header title --\x3e\n            <button class="cao-edit-field-header-title lui-button" ng-click="$ctrl.showChangeField($event, match, \'dimension\')" qva-outside-ignore-for="{{\'cao-changeField_\' + match.slot}}">\n                <span ng-if="match.field" ng-class="{\'cao-edit-field-span\' : $ctrl.caoTweakEnabled}">\n                    {{ match.field }}\n                </span>\n                <span ng-if="match.libIdLabel" ng-class="{\'cao-edit-field-span\' : $ctrl.caoTweakEnabled}">\n                    {{ match.libIdLabel }}\n\t\t\t\t</span>\n\t\t\t\t<div class="cao-field-caret-container" ng-if="$ctrl.insightLearning && $ctrl.caoTweakEnabled">\n\t\t\t\t\t<span class="lui-icon lui-button__icon cao-edit-expander-span" ng-class="{\'lui-icon--arrow-right\' : !match.expanded, \'lui-icon--arrow-down\': match.expanded}"></span>\n\t\t\t\t</div>\n            </button>\n            \x3c!-- Header icons --\x3e\n            <button class="lui-button cao-edit-expander" ng-if="!$ctrl.caoTweakEnabled" ng-show="$ctrl.insightLearning" ng-click="$ctrl.toggleMatchDetails( match )">\n                <span class="lui-icon lui-button__icon" ng-class="{\'lui-icon--arrow-right\' : !match.expanded, \'lui-icon--arrow-down\': match.expanded}"></span>\n            </button>\n            <i class="lui-icon lui-icon--draggable cao-edit-field-draggable cao-edit-sortable-handle" ng-if="$ctrl.getDimensionCount() > 1"\n                q-title-translation="Common.Move"></i>\n        </div>\n\n        <qv-cao-field-details ng-if="$ctrl.insightLearning && !$ctrl.caoTweakEnabled" class="cao-edit-field-details" data-match="match"\n            data-apply-callback="$ctrl.applyLearning" field-id="details_dimension_{{$index}}" chart="$ctrl.chart"\n            ng-show="match.expanded" />\n    </div>\n\n    \x3c!--- MEASURES --\x3e\n    <div class="header cao-msrs-header" ng-if="$ctrl.hasMeasures()">\n        <span q-translation="cao.fieldPicker.tab.measures">\n    </div>\n    <div class="cao-edit-field qv-pp-sortable" qv-cao-field-drop-zone data-slot="{{match.slot}}" data-slot-role="{{match.slotRole}}"\n        ng-repeat="match in $ctrl.chart.getMatches()" ng-if="match.slotRole === \'measure\'">\n        <div class="cao-edit-field-header" ng-class="{\'draggable\': $ctrl.measureCount > 1}" qv-cao-field-draggable\n            data-slot="{{match.slot}}" data-slot-role="{{match.slotRole}}">\n            \x3c!-- Change aggregation dropdown --\x3e\n            <button ng-if="match.aggr" class="lui-button cao-edit-field-header-aggregation" ng-click="$ctrl.showChangeAggr($event, match)"\n                ng-disabled="!$ctrl.canChangeAggregation( match )" qva-outside-ignore-for="{{\'cao-changeAggregation_\' + match.slot}}" >\n                {{ match.aggr.charAt(0).toUpperCase() + match.aggr.substring(1) }}\n            </button>\n            \x3c!-- Header content --\x3e\n\n            \x3c!-- Header title --\x3e\n            <button class="cao-edit-field-header-title lui-button" ng-click="$ctrl.showChangeField($event, match, \'measure\')" qva-outside-ignore-for="{{\'cao-changeField_\' + match.slot}}">\n                <span ng-if="match.field" ng-class="{\'cao-edit-field-span\' : $ctrl.caoTweakEnabled}">\n                    {{ match.field }}\n                </span>\n                <span ng-if="match.libIdLabel" ng-class="{\'cao-edit-field-span\' : $ctrl.caoTweakEnabled}">\n                    {{ match.libIdLabel }}\n\t\t\t\t</span>\n\t\t\t\t<div class="cao-field-caret-container" ng-if="$ctrl.insightLearning && $ctrl.caoTweakEnabled">\n\t\t\t\t\t<span class="lui-icon lui-button__icon cao-edit-expander-span" ng-class="{\'lui-icon--arrow-right\' : !match.expanded, \'lui-icon--arrow-down\': match.expanded}"></span>\n\t\t\t\t</div>\n            </button>\n            \x3c!-- Header icons --\x3e\n            <button class="lui-button cao-edit-expander" ng-if="!$ctrl.caoTweakEnabled" ng-show="$ctrl.insightLearning" ng-click="$ctrl.toggleMatchDetails( match )">\n                <span class="lui-icon lui-button__icon" ng-class="{\'lui-icon--arrow-right\' : !match.expanded, \'lui-icon--arrow-down\': match.expanded}"></span>\n            </button>\n            <i class="lui-icon lui-icon--draggable cao-edit-field-draggable cao-edit-sortable-handle" ng-if="$ctrl.getMeasureCount() > 1"\n                q-title-translation="Common.Move"></i>\n\n        </div>\n        <qv-cao-field-details ng-if="$ctrl.insightLearning && !$ctrl.caoTweakEnabled" class="cao-edit-field-details" data-match="match"\n            data-apply-callback="$ctrl.applyLearning" field-id="details_measure_{{$index}}" chart="$ctrl.chart" ng-show="match.expanded" />\n    </div>\n</div>'},922:function(t,e){t.exports='<lui-popover class="cao-change-aggr-popover cao-popover">\n    <div class="lui-popover__body lui-nopad popover-body">\n            <qv-action-list items="wrappedAggregations"></qv-action-list>\n    </div>\n</lui-popover>\n\n'},923:function(t,e){t.exports='<lui-popover class="cao-change-field-popover cao-popover">\n    <object-add-typeahead>\n        <lui-popover-header>\n            <div class="lui-input-group">\n                <input class="lui-input lui-input-group__input" type="text" autocomplete="off"\n                    ng-model="search.term" qva-focus="autoFocus" ng-change="filterFields(search.term)" maxlength="255"\n                    object-add-typeahead-input />\n            </div>\n        </lui-popover-header>\n        <div class="lui-popover__body lui-nopad popover-body" object-add-typeahead-menu>\n\n            <ul class="lui-list">\n                <div ng-if="dimensions.length > 0" class="object-add-popover-list-header" q-translation="Common.Dimensions"></div>\n\n                <li class="lui-list__item lui-list__action" ng-repeat="d in dimensions" on-select="change(field, d)"\n                    object-add-typeahead-item="d">\n                    <span class="lui-list__text" qve-highlight text="{{ d.libIdLabel }}" query="highlight"></span>\n                </li>\n\n                <div ng-if="measures.length > 0" class="object-add-popover-list-header" q-translation="Common.Measures"></div>\n\n                <li class="lui-list__item lui-list__action" ng-repeat="m in measures" on-select="change(field, m)"\n                    object-add-typeahead-item="m">\n                    <span class="lui-list__text" qve-highlight text="{{ m.libIdLabel }}" query="highlight"></span>\n                </li>\n\n                <div ng-if="fields.length > 0" class="object-add-popover-list-header" q-translation="Common.Fields"></div>\n\n                <li class="lui-list__item lui-list__action" ng-repeat="f in fields" on-select="change(field, f)"\n                    object-add-typeahead-item="f">\n                    <span class="lui-list__text" qve-highlight text="{{ f.displayNameTokens[0].text }}" query="highlight"></span>\n                </li>\n            </ul>\n            <div class="no-hits" ng-if="(fields.length === 0) && (measures.length === 0) && (dimensions.length == 0)">\n                <span><i q-translation="Toolbox.Search.Nohits" /></span>\n            </div>\n        </div>\n\n    </object-add-typeahead>\n</lui-popover>'},924:function(t,e){t.exports='<lui-popover class="cao-popover cao-analysis-info-popover">\n    <lui-popover-body>\n        <div class="popover-body cao-analysis-info-popover-body">\n            <div class="analysis-header">\n                {{analysisTitle}}\n            </div>\n            {{analysisDescription}}\n        </div>\n    </lui-popover-body>\n</lui-popover>\n'},925:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(196)],a=function(t,e,n){t.directive("qvCaoFieldDropZone",function(){return{restrict:"A",replace:true,scope:{},link:function t(i,a){function s(t,e){return e===t}a.droppable({accept:function t(e){var n=e[0].getAttribute("data-slot");var i=e[0].getAttribute("data-slot-role");var o=a[0].getAttribute("data-slot");var r=a[0].getAttribute("data-slot-role");if(n===o)return false;if(s(r,i)&&s(i,r))return true;return false},drop:function t(i,s){var o=s.draggable[0].getAttribute("data-slot");var r=a[0].getAttribute("data-slot");e.publish(n.PUBSUB_TOPIC,{slotA:o,slotB:r})}})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},926:function(t,e,n){"use strict";var i,a;!(i=[n(48)],a=function(t){t.directive("qvCaoFieldDraggable",function(){return{restrict:"A",replace:true,link:function t(e,n){n.draggable({revert:"invalid",axis:"y",handle:".cao-edit-sortable-handle",helper:"clone",revertDuration:250,zIndex:1e3})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},927:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(928),n(929),n(373)],a=function(t,e,n){t.nativeComponent("qvCaoFieldDetails",{bindings:{match:"<",chart:"<",applyCallback:"<",fieldId:"@"},controller:["qvCaoLearningConfidenceService","luiPopover",function(t,e){var i;var a;this.$onInit=function(){this.showExpression=!this.match.libId;this.searchReport=this.chart.getSearchReport();this.matchDetails=this.chart.getMatchDetails()};this.getDisplayExpressionForMatch=function(t){return t.libId?t.libIdLabel:t.aggr?t.aggr+"("+t.field+")":t.field};this.showFieldInfo=function(s){if(i&&a){a.close();return}var o={reasons:t.getReasonForSelectingField(this.match,this.searchReport,this.matchDetails,true)};var r={template:n,input:o,controller:[function(){}],dock:"bottom",alignTo:s.currentTarget,closeOnResize:true,outsideIgnore:this.fieldId+"_why"};i=true;a=e.show(r);a.closed.then(function(){i=false})}}],template:e})}.apply(e,i),void 0!==a&&(t.exports=a))},928:function(t,e){t.exports='<div class="cao-field-details-recommended" ng-hide="$ctrl.match.isDirty">\n    <span q-translation="cao.insight.editor.details.recommendation.why"/>\n    <a tid="{{$ctrl.fieldId}}_why" id="{{$ctrl.fieldId}}_why" ng-click="$ctrl.showFieldInfo($event)" qva-outside-ignore-for="{{$ctrl.fieldId}}_why">\n        <span class="lui-icon lui-icon--help"/>\n    </a>\n</div>\n<div class="cao-field-details-learn">\n    <cao-help-learn data-match="$ctrl.match" data-apply-callback="$ctrl.applyCallback" button-id="{{$ctrl.fieldId}}" chart="$ctrl.chart"></cao-help-learn>\n</div>\n'},929:function(t,e){t.exports='<lui-popover x-arrow="arrow">\n        <div class="cao-confidence-body">\n            <div class="cao-confidence-body-heading" q-translation="cao.confidence.heading"></div>\n            <ul class="cao-confidence-reason-list">\n                <li class="cao-confidence-reason-item" ng-repeat="reason in input.reasons.learned">\n                    <span class="lui-icon  lui-icon--tick lui-text-success" aria-hidden="true" ng-hide="reason.priority === 0"></span>\n                    <div class="cao-confidence-reason-item__text" ng-bind-html="reason.text"></div>\n                </li>\n                <li class="cao-confidence-reason-item" ng-repeat="reason in input.reasons.search">\n                        <span class="lui-icon  lui-icon--tick lui-text-success" aria-hidden="true" ng-hide="reason.priority === 0"></span>\n                        <div class="cao-confidence-reason-item__text" ng-bind-html="reason.text"></div>\n                    </li>\n            </ul>\n        </div>\n</lui-popover>'},930:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91),n(103),n(196),n(931),n(168)],a=function(t,e,n,i,a,s){t.nativeComponent("caoHelpLearn",{bindings:{applyCallback:"<",match:"<",chart:"<",buttonId:"@"},controller:["$element","luiPopover",function(t,o){var r=this;var l;var c=false;var u=false;r.learningOptions=[];var d=new s;var p=void 0;var h=void 0;var g=void 0;r.$onChange=function(){p=void 0;h=void 0;g=void 0};r.$doCheck=function(){if(r.match.field!==p||r.match.libId!==h||r.match.aggr!==g){p=r.match.field;h=r.match.libId;g=r.match.aggr;if(!u){this.searchReport=this.chart.getSearchReport();this.chartType=this.chart.getChartType();u=true}d.getDislikedItems().then(function(t){t&&t.length>0&&(r.dislikedFields=t[0].nodes);r.updateLearningOptions()})}};var f=function t(e){if(r.dislikedFields&&r.dislikedFields.length>0)return r.dislikedFields.filter(function(t){return t.field?t.field.name===e:t.libItem.libId===e})[0]};r.updateLearningOptions=function(){r.learningOptions=[];if(!r.match)return;var t=f(r.match.field||r.match.libId);if(t){r.learningOptions.push({text:e.get("cao.helpuslearn.useagain"),icon:"plus",action:function e(){d.undislikeItem(t.id).then(function(){l.close();r.applyCallback()});n.trackEvent(n.customEvents.INSIGHTS_PROPOSE_FIELD_AGAIN_CLICKED)}});return}r.match.libId||r.match.isDirty||(r.match.slotRole===i.MEASURE?r.learningOptions.push({text:e.get("cao.helpuslearn.not_a_measure"),icon:"unapprove",action:function t(){d.defineDimension({expr:"["+r.match.field+"]"}).then(function(){l.close();r.applyCallback()});n.trackEvent(n.customEvents.INSIGHTS_NOT_A_MEASURE_CLICKED)}}):r.match.slotRole===i.DIMENSION&&r.learningOptions.push({text:e.get("cao.helpuslearn.not_a_dimension"),icon:"unapprove",action:function t(){d.defineMeasure({expr:"unknown(["+r.match.field+"])"}).then(function(){l.close();r.applyCallback()});n.trackEvent(n.customEvents.INSIGHTS_NOT_A_DIMENSION_CLICKED)}}));r.learningOptions.push({text:e.get("cao.helpuslearn.neveruse"),icon:"minus",action:function t(){if(r.match.field){n.trackEvent(n.customEvents.INSIGHTS_NEVER_PROPOSE_FIELD_CLICKED);d.dislikeField({name:r.match.field}).then(function(){l.close();r.applyCallback()})}else if(r.match.libId){n.trackEvent(n.customEvents.INSIGHTS_NEVER_PROPOSE_LIB_CLICKED);d.dislikeLibItem({name:r.match.libId}).then(function(){l.close();r.applyCallback()})}}});r.isDisabled=0===r.learningOptions.length||r.chart.invalidFromLearning};this.displayHelpUsLearn=function(){if(c&&l){l.close();return}var e={template:a,input:r,controller:[function(){}],dock:"bottom",alignTo:t[0],closeOnResize:true,outsideIgnore:r.buttonId};c=true;l=o.show(e);n.trackEvent(n.customEvents.INSIGHTS_HELP_US_LEARN_CLICKED,{chart:r.chart.getAnalysisPrecedentId()});l.closed.then(function(){document.getElementById(r.buttonId).focus();c=false})}}],template:['<button class="lui-button" ng-click="$ctrl.displayHelpUsLearn()" ng-disabled="$ctrl.isDisabled"  tid="{{$ctrl.buttonId}}" id="{{$ctrl.buttonId}}" qva-outside-ignore-for="{{$ctrl.buttonId}}">','<span class="lui-button__icon  lui-icon  lui-icon--lightbulb" ></span><span class="lui-button__text" q-translation="cao.fieldPicker.helpuslearn.button"></span>',"</button>"].join("")})}.apply(e,i),void 0!==a&&(t.exports=a))},931:function(t,e){t.exports='<lui-popover x-arrow="arrow">\n    <div class="cao-help-learn-body">\n        <qv-action-list items="input.learningOptions"></qv-action-list>\n    </div>\n</lui-popover>'},932:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(933),n(167)],a=function(t,e,n){t.nativeComponent("qvActionList",{bindings:{items:"<"},controller:["$element","$timeout",function(t,e){var i=this;i.selectedIndex=-1;var a;this.$postLink=function(){a=t.find(".lui-list");a.on("keydown",o)};this.$onDestroy=function(){a.off("keydown",o)};this.selectItem=function(t){t.action()};function s(t){e(function(){i.selectedIndex=t})}function o(t){if(t.keyCode===n.ARROW_DOWN){t.preventDefault();i.selectedIndex<i.items.length-1?s(i.selectedIndex+1):s(0)}else if(t.keyCode===n.ARROW_UP){t.preventDefault();0===i.selectedIndex?s(i.items.length-1):s(i.selectedIndex-1)}else if(t.keyCode===n.ENTER||t.keyCode===n.TAB){t.preventDefault();e(function(){i.selectItem(i.items[i.selectedIndex])},0)}}}],template:e})}.apply(e,i),void 0!==a&&(t.exports=a))},933:function(t,e){t.exports='\n    <ul class="lui-list" qva-focus="true" tabindex="0">\n        <li ng-repeat="item in $ctrl.items" class="lui-list__item lui-list__action" ng-class="{ \'lui-disabled\': item.disabled, \'lui-active\': $index === $ctrl.selectedIndex }"\n            ng-click="item.disabled || $ctrl.selectItem(item)">\n            <span class="lui-list__aside  lui-icon lui-icon--{{item.icon}}" ng-if="item.icon"></span>\n            <span class="lui-list__text" tid="{{item.tid}}" q-translation="{{item.text}}"></span>\n        </li>\n    </ul>'},934:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91),n(103),n(935),n(373)],a=function(t,e,n,i){t.nativeComponent("caoConfidence",{bindings:{buttonId:"@",chart:"<",hideText:"<",closeNotification:"&",opened:"&",closed:"&"},controller:["luiPopover","qvCaoLearningConfidenceService",function(t,a){var s=this;var o;var r=false;s.$onInit=function(){l();s.closeNotification({handler:function t(){if(o){o.close();r=false}}})};s.$doCheck=function(){if(s.chart.recalculateConfidence){s.chart.recalculateConfidence=false;l()}};function l(){s.confidenceReasons={learned:[],search:[]};s.confidence=a.determineConfidence(s.chart);s.confidenceTitle=e.get("cao.confidence.title_"+s.confidence);if("empty"===s.confidence)s.emptyConfidence=true;else{var t=s.chart.getMatchDetails();s.chart.getMatches().forEach(function(e){var n=a.getReasonForSelectingField(e,s.chart.getSearchReport(),t,false);s.confidenceReasons.learned=s.confidenceReasons.learned.concat(n.learned);s.confidenceReasons.search=s.confidenceReasons.search.concat(n.search)})}}s.displayConfidenceInfo=function(){var e=this;if(e.emptyConfidence)return;if(r&&o){o.close();return}var a={template:i,input:this,controller:[function(){}],dock:"bottom",alignTo:document.getElementById(e.buttonId),closeOnResize:true,outsideIgnore:this.buttonId};r=true;o=t.show(a);o.opened.then(function(){if(e.opened){n.trackEvent(n.customEvents.INSIGHTS_CONFIDENCE_INDICATOR_CLICKED,{chart:e.chart.getAnalysisPrecedentId()});e.opened()}});o.closed.then(function(){e.closed&&e.closed();r=false})}}],template:['<span class="cao-confidence-container" q-title-translation="cao.confidence.title" aria-label="{{$ctrl.confidenceTitle}}"  >','<span class="cao-confidence-{{$ctrl.confidence}}-icon" ng-class="{\'no-reasons\': $ctrl.emptyConfidence}" ng-click="$ctrl.displayConfidenceInfo()" tid="{{$ctrl.buttonId}}" id="{{$ctrl.buttonId}}" qva-outside-ignore-for="{{$ctrl.buttonId}}"></span>',"</span>"].join("")})}.apply(e,i),void 0!==a&&(t.exports=a))},935:function(t,e){t.exports='<lui-popover x-arrow="arrow">\n    <div class="cao-confidence-body">\n        \x3c!-- <div class="cao-confidence-body-heading" q-translation="cao.confidence.heading"></div> --\x3e\n        <div class="cao-confidence-empty" ng-show="input.emptyConfidence" q-translation="cao.confidence.emptyconfidence"></div>\n\n        <div class="cao-confidence-body-heading-small" q-translation="cao.confidence.learnedbycognitive.title" ng-show="input.confidenceReasons.learned.length > 0"></div>\n        <ul class="cao-confidence-reason-list" ng-hide="input.emptyConfidence">\n            <li class="cao-confidence-reason-item" ng-repeat="reason in input.confidenceReasons.learned">\n                <span class="lui-icon  lui-icon--tick lui-text-success" aria-hidden="true"></span>\n                <div class="cao-confidence-reason-item__text" ng-bind-html="reason.field"></div>\n            </li>\n        </ul>\n\n        <div class="cao-confidence-body-heading-small" q-translation="cao.confidence.relevanttoserach.title" ng-show="input.confidenceReasons.search.length > 0"></div>\n        <ul class="cao-confidence-reason-list" ng-hide="input.emptyConfidence">\n            <li class="cao-confidence-reason-item" ng-repeat="reason in input.confidenceReasons.search">\n                <span class="lui-icon  lui-icon--tick lui-text-success" aria-hidden="true"></span>\n                <div class="cao-confidence-reason-item__text" ng-bind-html="reason.field"></div>\n            </li>\n        </ul>\n\n    </div>\n</lui-popover>'},936:function(t,e){t.exports='<div class="cao-refresh-indicator-container">\n    <div class="cao-refresh-indicator-content">\n        <div q-translation="cao.insight.refresh.indicator.body" />\n        <div class="cao-refresh-action">\n            <a class="cao-refresh" ng-click="$ctrl.refresh()" q-translation="cao.insight.refresh.indicator.action" />\n        </div>\n    </div>\n</div>\n'},937:function(t,e,n){"use strict";var i,a;!(i=[n(10),n(11),n(48),n(54),n(938),n(49),n(111)],a=function(t,e,n,i,a,s){var o={transclude:true,template:a,bindings:{chart:"=",app:"<",interactive:"<",scrollContainer:"<",getChartMenuItems:"&",setBlurHandler:"&",onChartLoaded:"&",contextMenuStatus:"=",index:"<"},controller:["$element","$document","$window","$timeout","$scope","qvCaoRenderService",function(a,o,r,l,c,u){var d=this;d.isLoadingCardImageFlag=s.getFlag("LOADING_CARD_IMAGES");d.caoTweakEnabled=s.getFlag("CAO_TWEAK");function p(){return d.interactive?-99:d.chart.getComplexity()?d.chart.getComplexity():d.index}this.$onInit=function(){this.hasBlurHandler=false;this.isDestroyed=false;this.scrollHander=i.debounce(this.renderChartIfInView,300);this.initializeState()};this.$doCheck=function(){if((this.interactive||this.caoTweakEnabled)&&this.chart.shouldRedraw){delete this.chart.shouldRedraw;d.chart.refreshChartType();d.chart.setState("LOADING");u.enqueueForRender(d.loadChart,p(d.chart.chart.visualization))}if(!this.hasBlurHandler&&this.chart.getObject().setOnBlurHandler){this.setBlurHandler();this.hasBlurHandler=true}};this.$postLink=function(){l(function(){if("READY"===d.chart.getState()&&d.isInView()&&!d.isDestroyed){d.chart.setState("LOADING");u.enqueueForRender(d.loadChart,p(d.chart.chart.visualization))}})};this.$onDestroy=function(){this.isDestroyed=true;u.dequeueRender(d.loadChart);t.element(this.scrollContainer).unbind("scroll",d.scrollHander);t.element(r).unbind("resize",d.renderChartIfInView);this.chart.destroyChart()};this.renderChartIfInView=function(){if(!d.isDestroyed&&d.isInView()&&"READY"===d.chart.getState()){d.chart.setState("LOADING");u.enqueueForRender(d.loadChart,p(d.chart.chart.visualization))}};this.isInView=function(){var t=a[0].getBoundingClientRect();var e=!r.innerHeight||o[0].documentElement.clientHeight;var n=t.top<=e;return n};this.loadManually=function(t){t.stopPropagation();d.chart.setState("LOADING");d.chart.allowLongLoad=true;u.enqueueForRender(d.loadChart,p(d.chart.chart.visualization))};this.loadChart=function(){return d.chart.loadChart(d.onChartLoaded)};this.openContextMenu=function(t,i,a,s){if(!this.contextMenuStatus.open&&this.chart.rendered){var o=n.getService("qvContextMenu").menu();o.onOpen=function(){e(".qv-contextmenu lui-popover").css("max-height",400)};d.getChartMenuItems({menu:o});var r=n.getService("qvContextMenu");r.showInline(o,{position:{x:i.pageX,y:i.pageY},onCloseFn:a},s||i.currentTarget)}};c.$on("cao.openContextMenu",function(t,e){d.openContextMenu(null,e.event,e.closeFn,e.element)});this.initializeState=function(){if(this.scrollContainer){t.element(this.scrollContainer).bind("scroll",this.scrollHander);t.element(r).bind("resize",d.renderChartIfInView)}}}]};n.nativeComponent("qvCaoInsightChart",o)}.apply(e,i),void 0!==a&&(t.exports=a))},938:function(t,e){t.exports='<div class="result-item-graph-container" ng-if="!$ctrl.interactive" qva-context-menu="$ctrl.openContextMenu( item, $event, $ctrl.onCloseContextMenu)"\n    qva-radial-context-menu="$ctrl.openContextMenu( item, $event, $ctrl.onCloseContextMenu)">\n    <qv-object ng-if="$ctrl.chart.getState() === \'LOADED\'" model="$ctrl.chart.chart.model" options="$ctrl.chart.options"\n        object="$ctrl.chart.object" />\n</div>\n\n<div class="result-item-graph-container" ng-if="$ctrl.interactive" qva-context-menu="$ctrl.openContextMenu( item, $event, $ctrl.onCloseContextMenu)"\n    qva-radial-context-menu="$ctrl.openContextMenu( item, $event, $ctrl.onCloseContextMenu)">\n    <qv-object ng-if="$ctrl.chart.getState() === \'LOADED\'" model="$ctrl.chart.chart.model" options="$ctrl.chart.zoomedOptions"\n        object="$ctrl.chart.zoomedObject" />\n</div>\n\n<div class="spinner-container" ng-if="($ctrl.chart.getState() === \'LOADING\' && !$ctrl.isLoadingCardImageFlag)">\n    <qv-spinner show="!$ctrl.chartLoaded && !$ctrl.isLoadingCardImageFlag" show-delay="100" center-in-parent="true"></qv-spinner>\n</div>\n<div class="image-container" ng-if="$ctrl.chart.getState() === \'LOADING\' && $ctrl.isLoadingCardImageFlag">\n    <img ng-src="{{$ctrl.chart.chartTypeImageUrl}}" class="loader-image" />\n</div>\n\n<div class="cao-manual-loader" ng-click="$event.stopPropagation()" ng-if="$ctrl.chart.getState() === \'MANUAL_LOAD\'">\n    <ul>\n        <li class="cao-loader-text" q-translation="cao.card.complex">\n        </li>\n        <li>\n            <lui-button ng-click="$ctrl.loadManually($event)" q-translation="cao.card.complex.load"></lui-button>\n        </li>\n    </ul>\n</div>'},939:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(95),n(940),n(105),n(49),n(159),n(91),n(372),n(93),n(103),n(275),n(212)],a=function(t,e,n,i,a,s,o,r,l,c,u){var d={template:i,bindings:{query:"<",disabled:"<",matchingFields:"<",matchingFieldIndex:"<",fieldToRemove:"<",fieldToAdd:"<",updateFieldPicker:"<",isLimited:"<",direction:"<",nluQueryInfoButtonVisible:"<",nluQueryInfoVisible:"<",toggleNluQueryInfo:"<"},controller:["$timeout","qvCaoSearchService","qvCaoService",function(e,i,d){var p=this;this.selectedSuggestion=null;this.nluEnabled=s.getFlag("NLU_INSIGHTS");this.nluQueries=[];this.NLU_QUERIES_LIMIT=10;this.waitingForAppId=false;this.$onInit=function(){this.initializeState()};this.searchInputPlaceHolder=this.nluEnabled?r.get("cao.search.input.nlu.placeHolder")+o.lrm:r.get("cao.search.input.placeHolder")+o.lrm;this.clearSerchButtonIconScreenReader=r.get("clear.serch.button.icon.screen.reader");this.caoSearchInputSearchScreenReader=r.get("cao.search.input.search.reader");this.caoSearchInputScreenReader=r.get("cao.search.input.screen.reader");this.$onChanges=function(t){this.syncFieldPicker=s.getFlag("CAO_FIELD_PICKER_SYNC");this.syncFieldPicker?t.fieldToAdd&&t.fieldToAdd.currentValue?this.toggleFieldPickerField(this.fieldToAdd):t.fieldToRemove&&t.fieldToRemove.currentValue&&this.toggleFieldPickerField(this.fieldToRemove):t.fieldToAdd&&t.fieldToAdd.currentValue&&this.fieldToAdd&&this.addFieldToQuery(this.fieldToAdd,true)};this.$onDestroy=function(){t("#qv-cao-search-container").off("click",p.caoSearchContainerOnclickHandler);t("#cao-search-input").off("click",p.caoSearchInputOnClickHandler);t(window).off("resize",p.searchSuggestionBoxOnResizeHandler);n.unsubscribe("cao/insights/clear");p.nluEnabled&&n.unsubscribe("cao/nlu/new_queries")};this.caoSearchContainerOnclickHandler=function(t){t.stopPropagation()};this.caoSearchInputOnClickHandler=function(t){t.stopPropagation();p.updateCursorPositionState(t)};this.searchSuggestionBoxOnResizeHandler=function(){p.isMatchingFieldPopupVisible&&e(function(){p.updateMatchingFields();p.showMatchingFieldPopup()},300)};this.toggleCao=function(){d.toggleCao()};this.initializeState=function(){this.queryTokens=[];this.cursorPosition=0;t("#qv-cao-search-container").click(p.caoSearchContainerOnclickHandler);t("#cao-search-input").click(p.caoSearchInputOnClickHandler);t(window).on("resize",p.searchSuggestionBoxOnResizeHandler);if(this.nluEnabled){n.subscribe("cao/nlu/new_queries",p.newNluQuery);c.getApp().then(function(t){p.appId=t.id;p.getNluQueries().then(function(){p.waitingForAppId&&e(function(){p.showSearchHistoryPopup()})})})}};this.handleSearchInputBlur=function(){p.matchingField=null;p.hideMatchingFields();p.hideSearchHistoryPopup()};this.updateCursorPositionState=function(t){p.updateCurrentCursorPositionState(t);if(p.query){var n=i.getCurrentToken(p.query,p.cursorPosition).token;p.cursorPosition<p.query.length+1&&n&&n.word?p.showFields(t):p.hideMatchingFields()}else p.nluEnabled&&(p.nluQueries.length||p.appId?p.nluQueries.length&&e(function(){p.positionSearchResultPopup();p.showSearchHistoryPopup()}):p.waitingForAppId=true)};this.showMatchingFieldPopup=function(){this.isMatchingFieldPopupVisible||(this.isMatchingFieldPopupVisible=true)};this.showSearchHistoryPopup=function(){this.isSearchHistoryPopupVisible||(this.isSearchHistoryPopupVisible=true)};this.hideSearchHistoryPopup=function(){this.isSearchHistoryPopupVisible=false};this.setMatchingFieldIndex=function(t){this.matchingFieldIndex=t};this.toggleFieldPickerField=function(t){if(t&&t.selected){this.removeFieldFromQuery(t);this.syncFieldPicker&&i.selectField(t,false)}else if(t&&!t.selected){this.addFieldToQuery(t);this.fieldToAdd=this.syncFieldPicker?this.fieldToAdd:"";this.syncFieldPicker&&i.selectField(t,true)}this.query&&0!==this.query.trim().length?this.updateInsights(this.query):this.clearQuery()};this.updateInsights=function(t){if(t){i.updateInsights(t.trim());this.trimSpacesOnQuery();this.hideMatchingFields();u.trackEvent(u.customEvents.INSIGHTS_TYPED_QUERY,{query:t})}};this.defaultCursorPosition=function(){return this.query?this.query.length+1:0};this.trimSpacesOnQuery=function(){this.query=this.query.trim();this.query+=" "};this.addFieldToQuery=function(e,n,a){a&&a.preventDefault();var s=t("#cao-search-input")[0];var o=this.cursorPosition?this.cursorPosition:this.defaultCursorPosition();var r=i.addFieldToQuery(e,this.query,o,s.selectionStart,s.selectionEnd);this.cursorPosition=r.cursorPosition;this.query=r.query;this.updateMatchingFields();this.positionCursorAtIndex(this.cursorPosition);this.syncFieldsInQueryWithFieldPicker();this.trimSpacesOnQuery();n&&this.updateInsights(this.query)};this.usePreviousQuery=function(t){p.query=t};this.keydown=function(t,e){switch(t.which){case 38:case 40:e&&(this.selectedSuggestion=e.caoFieldId);break;default:this.selectedSuggestion=null}};this.removeFieldFromQuery=function(t){var e=i.getSelectedFields(this.query);var n=this.cursorPosition?this.cursorPosition:this.defaultCursorPosition();this.query=i.removeFieldFromQuery(t,this.query,e);this.positionCursorAtIndex(n);this.syncFieldsInQueryWithFieldPicker()};this.hideMatchingFields=function(){e(function(){p.isMatchingFieldPopupVisible=false;p.navigatingThroughMatchingFields=false;p.matchingFields=[]})};this.clearQuery=function(){p.query="";p.hideMatchingFields();i.clearSelectedFields();p.syncFieldsInQueryWithFieldPicker();i.showIntro(true)};this.showFields=function(t){t&&this.updateCurrentCursorPositionState(t);this.matchingFields=i.getFields();this.clearHighlightedFields();this.updateMatchingFields();this.showMatchingFieldPopup()};this.positionCursorAtIndex=function(n){this.query&&this.query.length>0&&e(function(){var e=document.getElementById("cao-search-input");var i=n;t("#cao-search-input").focus();e.setSelectionRange(i,i)})};this.updateCurrentCursorPositionState=function(t){this.cursorPosition=t.target.selectionStart};this.scrollFieldIntoView=function(t){if(t&&t.caoFieldId){var e=document.getElementById(t.caoFieldId);e&&e.scrollIntoView&&e.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}};this.updateMatchingFields=function(){e(function(){var t=p.cursorPosition?p.cursorPosition:0;var e=i.getCurrentToken(p.query,t);p.currentToken=e;p.setMatchingFieldIndex(-1);if(null!==e.index&&e.token.word){if(e.token){p.matchingFields=i.getMatchingFields(e.token.word,p.isLimited);p.highlightField(p.matchingFieldIndex)}}else p.hideMatchingFields();p.positionSearchResultPopup()})};this.getNluQueries=function(){return l.getQueries(p.NLU_QUERIES_LIMIT,p.appId).then(function(t){p.nluQueries=t})};this.newNluQuery=function(t){p.nluQueries.push(t)};this.positionSearchResultPopup=function(){var e;if(this.query&&this.query.length>0){var n=this.cursorPosition?this.cursorPosition:0;var a=t("#cao-search-input");var s=t("#qv-cao-search-input-container");if(a.position()&&a.position().left){e=a.position().left;p.nluEnabled&&s&&s.position()&&(e+=s.position().left);var o=i.getCurrentToken(this.query,n);o.token&&(n=o.token.indexStart);e+=i.searchResultPositionRelativeToQuery(this.query,n)}}this.searchResultContainerLeft=e+"px"};this.highlightField=function(t){this.clearHighlightedFields();this.matchingFields.length>0&&t>=0&&(this.matchingFields[t].highlight=true)};this.clearHighlightedFields=function(){this.matchingFields=this.matchingFields.map(function(t){t.highlight=false;return t})};this.syncFieldsInQueryWithFieldPicker=function(){if(this.syncFieldPicker){i.syncFieldsInQueryWithFieldPicker(this.query);this.updateFieldPicker()}};this.getMatchingFields=function(t){this.triggerKeyboardBehaviours(t);if(this.query&&this.query.length>0){p.hideSearchHistoryPopup();var e=this.query.replace(/\s{2,}/g," ");var n="keyup"===t.type&&t.which===a.KeyCodes.Enter&&!this.navigatingThroughMatchingFields;if(!this.navigatingThroughMatchingFields){this.updateMatchingFields();t.which!==a.KeyCodes.Enter&&this.showMatchingFieldPopup()}t.which!==a.KeyCodes.Enter&&t.which!==a.KeyCodes.Tab||(this.isMatchingFieldPopupVisible=false);n&&this.updateInsights(e)}};this.navigateMatchingFields=function(t){this.triggerKeyboardBehaviours(t);this.navigatingThroughMatchingFields=t&&t.which===a.KeyCodes.Down||t.which===a.KeyCodes.Up;var e=t&&"keydown"===t.type&&t.keyCode;var n=e&&this.matchingFields&&this.matchingFields.length>0;if(n){this.matchingField=i.matchingField(t.keyCode,this.matchingFieldIndex,this.matchingFields);this.setMatchingFieldIndex(this.matchingFields.indexOf(this.matchingField));this.scrollFieldIntoView(this.matchingField);if(this.matchingFieldIndex>=0){var s=e&&t.keyCode===a.KeyCodes.Tab&&this.matchingField;var o=e&&t.keyCode===a.KeyCodes.Enter&&this.matchingField;if(s){this.addFieldToQuery(this.matchingField);this.hideMatchingFields()}if(o){this.addFieldToQuery(this.matchingField);this.updateInsights(this.query)}this.navigatingThroughMatchingFields&&this.highlightField(this.matchingFieldIndex)}switch(t.which){case 38:case 40:this.matchingField&&(this.selectedSuggestion=this.matchingField.caoFieldId);break}}t&&t.which===a.KeyCodes.Enter&&!this.query&&this.clearQuery()};n.subscribe("cao/insights/clear",p.clearQuery);this.triggerKeyboardBehaviours=function(t){this.updateCurrentCursorPositionState(t);this.syncFieldsInQueryWithFieldPicker();t.which!==a.KeyCodes.Down&&t.which!==a.KeyCodes.Up&&t.which!==a.KeyCodes.Enter||t.preventDefault();e(function(){t.which===a.KeyCodes.Delete&&p.updateMatchingFields();if(t.which===a.KeyCodes.Esc){p.matchingField=null;p.hideMatchingFields()}})}}]};e.nativeComponent("qvCaoSearch",d)}.apply(e,i),void 0!==a&&(t.exports=a))},940:function(t,e){t.exports='<div id="qv-cao-search-container" class="qv-cao-search-container">\n\t<div class="qv-cao-search-input" ng-class="{\'focus\': $ctrl.isInputFocused, \'qv-cao-search-input--nlu\': $ctrl.nluEnabled}" id="qv-cao-search-input-container">\n\t\t<div class="search-cao-field-area">\n\t\t\t<div class="lui-search search-field" qva-direction x-dir-setting="{{$ctrl.direction}}">\n\t\t\t\t<span class="lui-search__search-icon"></span>\n\t\t\t\t<input class="lui-search__input"\n\t\t\t\t\t   ng-model="$ctrl.query"\n\t\t\t\t\t   auto-focus="autoFocus"\n\t\t\t\t\t   aria-autocomplete="list"\n\t\t\t\t\t   autocomplete="off"\n\t\t\t\t\t   ng-disabled="$ctrl.disabled"\n\t\t\t\t\t   type="text"\n\t\t\t\t\t   is-focused="isInputFocused"\n\t\t\t\t\t   placeholder="{{$ctrl.searchInputPlaceHolder}}"\n\t\t\t\t\t   ng-keydown="$ctrl.navigateMatchingFields($event)"\n\t\t\t\t\t   ng-keyup="$ctrl.getMatchingFields($event)"\n\t\t\t\t\t   tid="caoSearch.searchField"\n\t\t\t\t\t   tabindex="0"\n             role="combobox"\n\t\t\t\t\t   aria-label="{{$ctrl.caoSearchInputSearchScreenReader}}"\n\t\t\t\t\t   aria-activedescendant="{{$ctrl.selectedSuggestion}}"\n\t\t\t\t\t   aria-owns="cao_search_suggestions cao_search_history"\n\t\t\t\t\t   id="cao-search-input"\n\t\t\t\t\t   ng-blur="$ctrl.handleSearchInputBlur()"\n        />\n\t\t\t\t<button aria-label="{{$ctrl.clearSerchButtonIconScreenReader}}" class="lui-icon  lui-icon--remove" tid="cao-search-clear-btn" ng-if="$ctrl.query" q-title-translation="cao.search.clear.tooltip" ng-click="$ctrl.clearQuery()"></button>\n\t\t\t</div>\n\t\t</div>\n\t\t<button class="qv-cao-search-info-button" ng-class="{ \'qv-cao-search-info-button--active\': $ctrl.nluQueryInfoVisible }" ng-if="$ctrl.nluEnabled && $ctrl.nluQueryInfoButtonVisible" ng-click="$ctrl.toggleNluQueryInfo()">\n\t\t\t<i class="lui-icon lui-icon--info"></i>\n\t\t</button>\n\t</div>\n\t<div id="cao_search_suggestions" class="qv-cao-search-suggestions" ng-if="$ctrl.isMatchingFieldPopupVisible"\n\t\t ng-style="{ \'left\': $ctrl.searchResultContainerLeft }">\n\t\t<ul class="lui-list">\n\t\t\t<li class="lui-list__item fields"\n\t\t\t\ttid="caoSearchSuggestionField"\n\t\t\t\tng-class="{\'highlight\': field.highlight}"\n\t\t\t\tng-repeat="field in $ctrl.matchingFields"\n\t\t\t\tng-mousedown="$ctrl.addFieldToQuery(field, true, $event)"\n\t\t\t\tid="{{field.caoFieldId}}"\n\t\t\t\taria-labelledby="{{field.caoFieldId+\'Name\' + \' \' + field.caoFieldId+\'Origin\'}}"\n\t\t\t\t>\n\t\t\t\t<span aria-hidden="true" class="lui-list__text" q-title-translation={{field.qName}} tid="caoSearchSuggestionFieldName" >\n\t\t\t\t\t<span aria-hidden="true" qve-highlight text="{{ field.qName }}" query="$ctrl.currentToken.token.word" ></span>\n\t\t\t\t</span>\n\t\t\t\t<span aria-hidden="true" ng-if="!field.masterItem" class="lui-list__aside field-name" q-title-translation={{field.tablesTooltip}}>{{field.tablesAssociated}}</span></span>\n\t\t\t\t<span aria-hidden="true" ng-if="field.masterItem" class="lui-list__aside field-name">{{field.masterItemTitle}}</span></span>\n\t\t\t\t<p id="{{field.caoFieldId+\'Name\'}}" class="sr-only" >{{ field.qName }}</p>\n\t\t\t\t<p id="{{field.caoFieldId+\'Origin\'}}" class="sr-only" ng-if="!field.masterItem" class="lui-list__aside field-name" q-title-translation={{field.tablesTooltip}}>{{field.tablesAssociated}}</p>\n\t\t\t\t<p id="{{field.caoFieldId+\'Origin\'}}" class="sr-only" ng-if="field.masterItem" class="lui-list__aside field-name">{{field.masterItemTitle}}</p>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n\t<div id="cao_search_history" class="qv-cao-search-history qv-cao-search-suggestions" ng-if="$ctrl.isSearchHistoryPopupVisible"\n\t\tng-style="{ \'left\': $ctrl.searchResultContainerLeft }">\n\t\t<ul class="lui-list">\n\t\t\t<li class="lui-list__item fields"\n\t\t\t\ttid="caoSearchHistoryField"\n\t\t\t\tng-repeat="query in $ctrl.nluQueries"\n\t\t\t\tng-mousedown="$ctrl.usePreviousQuery(query.text)"\n\t\t\t\tid="{{query.id}}"\n\t\t\t\taria-labelledby="{{query.id}}"\n\t\t\t\t>\n\t\t\t\t<span aria-hidden="true" class="lui-list__text" q-title-translation={{query.text}} tid="caoSearchHistoryFieldName">\n\t\t\t\t\t<span aria-hidden="true" qve-highlight text="{{ query.text }}"></span>\n\t\t\t\t</span>\n\t\t\t\t<p id="{{query.id}}" class="sr-only" >{{ query.text }}</p>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</div>\n'},941:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91),n(103),n(95),n(942),n(168),n(49),n(943),n(944)],a=function(t,e,n,i,a,s,o){var r={template:a,bindings:{isLimited:"<",insightsLoaded:"<",items:"<",activeTab:"<",selectField:"<",showFieldPicker:"<",toggleFieldPicker:"&"},controller:["qvCaoService",function(t){var a=this;var r=new s;this.activeTab=null;this.fieldPickerTabDimensions=e.get("cao.fieldPicker.tab.dimensions");this.fieldPickerTabMeasures=e.get("cao.fieldPicker.tab.measures");this.fieldPickerTabFields=e.get("cao.fieldPicker.fields.title");this.fieldPickerTabFieldsScreenReader=e.get("cao.fieldPicker.fields.title");this.fieldPickerTabMasterItemsScreenReader=e.get("cao.fieldPicker.masterItems.title");this.insightLearning=o.getFlag("CE_PRECEDENTS");this.caoTweakEnabled=o.getFlag("CAO_TWEAK");this.useAgainString=e.get("cao.helpuslearn.useagain");this.dislikedFields=[];this.$onInit=function(){this.init()};this.$onDestroy=function(){i.unsubscribe("cao/insight/learning_applied")};this.$onChanges=function(t){if(t.items&&t.items.currentValue){this.items=t.items.currentValue;this.masterItemDimensions=[];this.masterItemMeasures=[];this.fields=[];this.items.forEach(function(t){t.masterItemDimension?a.masterItemDimensions.push(t):t.masterItemMeasures?a.masterItemMeasures.push(t):a.fields.push(t)})}t.isLimited&&t.isLimited.currentValue&&t.isLimited!==t.isLimited.currentValue?this.init():t.isLimited&&false===t.isLimited.currentValue&&this.init();l()};var l=function t(){if(a.insightLearning){if(a.items&&0!==a.items.length)return r.getDislikedItems().then(function(t){t&&t.length>0&&(a.dislikedFields=t[0].nodes)});a.dislikedFields=[]}else a.dislikedFields=[]};this.isDislikedField=function(t){return a.dislikedFields.filter(function(e){return e.field&&e.field.name===t.qName})[0]};this.isDislikedMasterItem=function(t){return a.dislikedFields.filter(function(e){return e.libItem&&e.libItem.libId===t.libId})[0]};this.useFieldAgain=function(e){n.trackEvent(n.customEvents.INSIGHTS_PROPOSE_FIELD_AGAIN_CLICKED);r.undislikeItem(e.id).then(function(){t.setRefreshIndicatorVisibility(true);i.publish("cao/insight/learning_applied")})};this.init=function(){true===this.isLimited?this.setActiveTab("masterItems"):false===this.isLimited&&this.setActiveTab("fields");i.subscribe("cao/insight/learning_applied",l)};this.setActiveTab=function(t){if("fields"===t)if("fields"!==this.activeTab){this.activeTab="fields";this.title=e.get("cao.fieldPicker.fields.title");this.showFieldPicker||this.toggleFieldPicker()}else this.toggleFieldPicker();else if("masterItems"===t)if("masterItems"!==this.activeTab){this.activeTab="masterItems";this.title=e.get("cao.fieldPicker.masterItems.title");this.setMasterItemsSection("measures");this.showFieldPicker||this.toggleFieldPicker()}else this.toggleFieldPicker()};this.setMasterItemsSection=function(t){"measures"===t?this.activeMasterItemSection="measures":"dimensions"===t&&"dimensions"===this.activeMasterItemSection?this.activeMasterItemSection="measures":"dimensions"===t&&"dimensions"!==this.activeMasterItemSection&&(this.activeMasterItemSection="dimensions")}}]};t.nativeComponent("qvCaoFieldPicker",r)}.apply(e,i),void 0!==a&&(t.exports=a))},942:function(t,e){t.exports='<div class="field-picker">\n\t<div class="tabs">\n\t\t<div qva-cao-acc-field-items x-items-type="fieldPickerCategories">\n\t\t\t<div tid="caoFieldPickerFieldTabButton" class="tab" cao-acc-field-item="{\'type\': \'fieldPickerCategories\', \'index\': 0}"\n\t\t\t ng-class="{\'hide-tab\': $ctrl.activeTab === null, \'selected\': $ctrl.activeTab === \'fields\', \'cao-acc-focus\': $ctrl.itemAccFocus}"\n\t\t\t ng-show="!$ctrl.isLimited" aria-label="{{$ctrl.fieldPickerTabFieldsScreenReader}}" ng-click="$ctrl.setActiveTab(\'fields\')"\n\t\t\t q-title-translation="cao.fieldPicker.fields.title">\n\t\t\t\t<span class="lui-icon  lui-icon--database"></span>\n\t\t\t</div>\n\t\t</div>\n\t\t<div qva-cao-acc-field-items x-items-type="fieldPickerCategories">\n\t\t\t<div tid="caoFieldPickerMasterItemsTabButton" class="tab" cao-acc-field-item="{\'type\': \'fieldPickerCategories\', \'index\': 1}"\n\t\t\t ng-class="{\'hide-tab\': $ctrl.activeTab === null, \'selected\': $ctrl.activeTab === \'masterItems\', \'cao-acc-focus\': $ctrl.itemAccFocus}"\n\t\t\t ng-click="$ctrl.setActiveTab(\'masterItems\')" aria-label="{{$ctrl.fieldPickerTabMasterItemsScreenReader}}"\n\t\t\t q-title-translation="cao.fieldPicker.masterItems.title">\n\t\t\t\t<span class="lui-icon  lui-icon--link"></span>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class="tab-content" tid="caoFieldPickerContentContainer">\n\t\t<qv-spinner class="spinner" show="!$ctrl.items" show-delay="500" center-in-parent="true"></qv-spinner>\n\n\t\t<div ng-if="$ctrl.activeTab === \'fields\' && !$ctrl.isLimited && $ctrl.insightsLoaded" class="fields">\n\t\t\t<button class="field-item-header" ng-class="{\'selected\': true}" tabindex="0" tid="caoFieldPickerFieldSectionButton"\n\t\t\t\taria-labelledby="{{caoFieldPickerFieldText}}">\n\t\t\t\t   <span ng-class="{\'cao-acc-focus\': $ctrl.itemAccFocus}" tid="caoFieldPickerFieldText" class="group-name">\n\t\t\t\t\t   {{$ctrl.fieldPickerTabFields}}</span>\n\t\t\t  </button>\n\t\t\t<div class="no-items" ng-if="$ctrl.showFieldPicker && !$ctrl.fields.length" q-translation="cao.fieldPicker.noItems"></div>\n\t\t\t<ul class="lui-list" ng-if="$ctrl.fields.length" qva-cao-acc-field-items x-items-type="fieldItem">\n\t\t\t\t<div ng-repeat="field in $ctrl.fields" class="field-container">\n\t\t\t\t\t<li class="lui-list__item field" tid="caoFieldPickerField" cao-acc-field-item="{\'type\': \'fieldItem\', \'index\': $index}"\n\t\t\t\t\t ng-click="$ctrl.selectField(field)" aria-label="{{field.qName}}" q-title-translation={{field.qName}} ng-class="{\'selected\': field.selected, \'cao-acc-focus\': $ctrl.itemAccFocus, \'disliked\': $ctrl.isDislikedField(field)}">\n\t\t\t\t\t\t<span class="lui-list__aside  lui-icon {{field.classificationIcon}}" ng-if="field.classificationIcon"></span>\n\t\t\t\t\t\t<span class="lui-list__text">{{field.qName}}</span>\n\t\t\t\t\t</li>\n\t\t\t\t\t<div class="field-picker-propose" ng-if="!$ctrl.caoTweakEnabled && $ctrl.isDislikedField(field)" ng-click="$event.stopPropagation(); $ctrl.useFieldAgain($ctrl.isDislikedField(field))"\n\t\t\t\t\t lui-title-tooltip title="{{$ctrl.useAgainString}}" x-dock="top" x-close-on-click="true">\n\t\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--plus"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</ul>\n\t\t</div>\n\n\t\t<div ng-if="$ctrl.activeTab === \'masterItems\' && $ctrl.insightsLoaded" class="master-items" tid="caoFieldPickerMasterItemsContainer">\n\t\t\t<div class="dimensions" ng-class="{\'selected\': $ctrl.activeMasterItemSection === \'dimensions\'}">\n\t\t\t\t<button class="master-item-header" ng-class="{\'selected\': $ctrl.activeMasterItemSection === \'dimensions\'}" ng-keyup="$ctrl.itemAccFocus=true"\n\t\t\t\t ng-mouseup="$ctrl.itemAccFocus=false" tabindex="0" aria-controls="cao-field-picker-dimensions-fields" tid="caoFieldPickerMasterItemsDimensionSectionButton"\n\t\t\t\t ng-click="$ctrl.setMasterItemsSection(\'dimensions\')" aria-labelledby="{{caoFieldPickerMasterItemDimensionText}}">\n\t\t\t\t\t<span ng-class="{\'cao-acc-focus\': $ctrl.itemAccFocus}" tid="caoFieldPickerMasterItemDimensionText" class="group-name">\n\t\t\t\t\t\t{{$ctrl.fieldPickerTabDimensions}}</span>\n\t\t\t\t</button>\n\t\t\t\t<div class="no-items" ng-if="$ctrl.showFieldPicker && !$ctrl.masterItemDimensions.length && $ctrl.activeMasterItemSection === \'dimensions\'"\n\t\t\t\t q-translation="cao.fieldPicker.noItems"></div>\n\t\t\t\t<ul id="cao-field-picker-dimensions-fields" class="lui-list master-item-fields" qva-cao-acc-field-items\n\t\t\t\t x-items-type="masterItemDimension" aria-expanded="$ctrl.activeMasterItemSection === \'dimensions\'">\n\t\t\t\t\t<div ng-repeat="field in $ctrl.masterItemDimensions" class="field-container">\n\t\t\t\t\t\t<li class="lui-list__item field" tid="caoFieldPickerMasterItemDimension" cao-acc-field-item="{\'type\': \'masterItemDimension\', \'index\': $index}"\n\t\t\t\t\t\t aria-label="{{field.qName}}" ng-click="$ctrl.selectField(field)"\n\t\t\t\t\t\t q-title-translation={{field.qName}} ng-class="{\'selected\': field.selected, \'cao-acc-focus\': $ctrl.itemAccFocus, \'disliked\': $ctrl.isDislikedMasterItem(field) }">\n\t\t\t\t\t\t\t<span class="lui-list__text caoFieldPickerMasterItemDimensionText">{{field.qName}}</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<div class="field-picker-propose" ng-if="!$ctrl.caoTweakEnabled && $ctrl.isDislikedMasterItem(field)" ng-click="$event.stopPropagation(); $ctrl.useFieldAgain($ctrl.isDislikedMasterItem(field))"\n\t\t\t\t\t\t lui-title-tooltip title="{{$ctrl.useAgainString}}" x-dock="top" x-close-on-click="true">\n\t\t\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--plus"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</ul>\n\t\t\t</div>\n\n\t\t\t<div class="measures">\n\t\t\t\t<button class="master-item-header measures" ng-class="{\'selected\': $ctrl.activeMasterItemSection === \'measures\'}"\n\t\t\t\t ng-keyup="$ctrl.itemAccFocus=true" ng-mouseup="$ctrl.itemAccFocus=false" tabindex="0" aria-controls="cao-field-picker-measures-fields"\n\t\t\t\t tid="caoFieldPickerMasterItemsMeasureSectionButton" ng-click="$ctrl.setMasterItemsSection(\'measures\')"\n\t\t\t\t aria-labelledby="{{caoFieldPickerMasterItemMeasuresText}}">\n\t\t\t\t\t<span ng-class="{\'cao-acc-focus\': $ctrl.itemAccFocus}" tid="caoFieldPickerMasterItemMeasuresText" class="group-name">{{$ctrl.fieldPickerTabMeasures}}</span>\n\t\t\t\t</button>\n\t\t\t\t<div class="no-items" ng-if="$ctrl.showFieldPicker && $ctrl.showFieldPicker && !$ctrl.masterItemMeasures.length && $ctrl.activeMasterItemSection === \'measures\'"\n\t\t\t\t q-translation="cao.fieldPicker.noItems"></div>\n\t\t\t\t<ul id="cao-field-picker-measures-fields" class="lui-list master-item-fields" qva-cao-acc-field-items x-items-type="masterItemMeasure"\n\t\t\t\t aria-expanded="$ctrl.activeMasterItemSection === \'measures\'">\n\t\t\t\t\t<div ng-repeat="field in $ctrl.masterItemMeasures" class="field-container">\n\t\t\t\t\t\t<li class="lui-list__item field" tid="caoFieldPickerMasterItemMeasure" cao-acc-field-item="{\'type\': \'masterItemMeasure\', \'index\': $index}"\n\t\t\t\t\t\t ng-click="$ctrl.selectField(field)" q-title-translation={{field.qName}}\n\t\t\t\t\t\t aria-label="{{field.qName}}" ng-class="{\'selected\': field.selected, \'cao-acc-focus\': $ctrl.itemAccFocus, \'disliked\': $ctrl.isDislikedMasterItem(field) }">\n\t\t\t\t\t\t\t<span class="lui-list__text">{{field.qName}}</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<div class="field-picker-propose" ng-if="!$ctrl.caoTweakEnabled && $ctrl.isDislikedMasterItem(field)" ng-click="$event.stopPropagation(); $ctrl.useFieldAgain($ctrl.isDislikedMasterItem(field))"\n\t\t\t\t\t\t lui-title-tooltip title="{{$ctrl.useAgainString}}" x-dock="top" x-close-on-click="true">\n\t\t\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--plus"></span>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t</div>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n</div>'},943:function(t,e,n){"use strict";var i,a;!(i=[n(48)],a=function(t){t.directive("qvaCaoAccFieldItems",["qvAccessibilityGridService",function(t){return{restrict:"A",link:function e(n,i,a){n.$on("$destroy",function(){var e=a["itemsType"];t.removeAllItems(e)})}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},944:function(t,e,n){"use strict";var i,a;!(i=[n(48)],a=function(t){t.directive("caoAccFieldItem",["$timeout","qvAccessibilityGridService",function(t,e){return{restrict:"A",scope:{caoAccFieldItem:"="},link:function n(i,a){var s=function e(n,i){var s=n===this.col&&i===this.row;t(function(){a.attr("tabindex",s?0:-1);if(s){a.focus();a.addClass("cao-acc-focus")}else a.removeClass("cao-acc-focus")})};var o=e.addItem(i.caoAccFieldItem.index,s,i.caoAccFieldItem.type,0,i.caoAccFieldItem.index);o&&a.attr("tabindex",0);var r=function t(e){switch(e.which){case 9:case 16:"0"===a.attr("tabindex")&&a.addClass("cao-acc-focus");break}};var l=function n(s){switch(s.which){case e.RIGHT_KEY:case e.LEFT_KEY:case e.UP_KEY:case e.DOWN_KEY:s.stopPropagation();s.preventDefault();t(function(){"0"===a.attr("tabindex")&&e.key(s,i.caoAccFieldItem.type)});break}};a.on("mouseup",function(){a.removeClass("cao-acc-focus")});a.on("keyup",r);a.on("keydown",l)}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},945:function(t,e,n){"use strict";var i,a;!(i=[n(48)],a=function(t){t.service("qvCaoRenderService",[function(){var t;var e=[];var n=false;function i(){e.sort(function(t,e){return t.priority>e.priority});var t=e[0];t.renderFunction().finally(function(){n=false;e.shift();e.length>0&&i()})}var a=function t(a,s){e.push({renderFunction:a,priority:s});if(!n){n=true;i()}};var s=function t(n){e=e.filter(function(t){return t.renderFunction!==n})};var o=function t(){e=[];n=false};t={enqueueForRender:a,dequeueRender:s,clearRenderQueue:o};return t}])}.apply(e,i),void 0!==a&&(t.exports=a))},946:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(103),n(168),n(221),n(212)],a=function(t,e,n){t.service("qvCaoLearningService",[function(){var t;var i=new n;function a(t){e.trackEvent(e.customEvents.INSIGHTS_NOT_A_MEASURE_CLICKED);return i.defineDimension({expr:"["+t+"]"})}function s(t){e.trackEvent(e.customEvents.INSIGHTS_NOT_A_DIMENSION_CLICKED);return i.defineMeasure({expr:"["+t+"]"})}function o(t){return i.dislikeLibItem({name:t})}function r(t){return i.dislikeField({name:t})}function l(t){var n=t.getAnalysis();return i.dislikeAnalysis(n).then(function(i){n.precedents={id:i.nodes[0].id,disliked:true};e.trackEvent(e.customEvents.INSIGHTS_HIDE_CHART_CLICKED,{chart:t.getAnalysisPrecedentId()})})}function c(t){var e=t.getAnalysis();return i.undislikeAnalysis(e).then(function(){delete e.precedents})}function u(t,e){return t.filter(function(t){return t.field?t.field.name===e:t.libItem.name===e})[0]}function d(t){return i.getDislikedItems().then(function(n){var a=n[0].nodes;e.trackEvent(e.customEvents.INSIGHTS_PROPOSE_FIELD_AGAIN_CLICKED);var s=u(a,t);return i.undislikeItem(s.id)})}function p(t){return i.dislikeAnalysis(t).then(function(e){t.precedents={id:e.nodes[0].id,disliked:true};return true})}function h(t){return i.undislikeAnalysis(t).then(function(){delete t.precedents;return false})}function g(){return i.getLearnedItems()}function f(){return i.getDislikedItems()}function v(t){return i.removeDefinedItem(t)}function m(t){return i.undislikeItem(t)}t={applyDimensionLearning:a,applyMeasureLearning:s,dislikeLibItem:o,dislikeField:r,hideChart:l,unHideChart:c,unDislikeItem:d,dislikeAnalysis:p,unDislikeAnalysis:h,getDislikedItems:f,getLearnedItems:g,removeDefinedItem:v,unDislikeField:m};return t}])}.apply(e,i),void 0!==a&&(t.exports=a))},947:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(91),n(113),n(948),n(949),n(950),n(952),n(954),n(956),n(961)],a=function(t,e,n,i,a,s){var o=["$scope","$timeout","qvCaoSelectionService","qvCaoLearningConfidenceService","qvCaoLearningService",function(a,o,r,l,c){var u=this;var d=null;u.hiddenCharts=[];u.fieldRules=[];u.initState=true;u.isCustomPreferences=true;a.customPreferencesToggleOn=i.CAO_DEBUG;a.customPreferencesToggle={value:true};a.$watch("customPreferencesToggle.value",function(t){u.isCustomPreferences=t;u.precedentsEnabled=t});function p(t){var e=[];var n=u.chart.getSearchReport();var i=u.chart.getMatchDetails();t&&t.forEach(function(t){var a=l.getReasonForSelectingField(t,n,i,true);e=e.concat(a.learned);e=e.concat(a.search)});return e}this.handleHiddenCharts=function(t){if(t){var e=t.getAnalysis();return e.precedents&&e.precedents.disliked?c.unDislikeAnalysis(e):c.dislikeAnalysis(e)}};this.noLearningFound=function(){return!u.isFieldRulesSet()};this.isFieldRulesSet=function(){return u.fieldRules&&u.fieldRules.length>0};this.isFieldRulesEnabled=function(){return u.isFieldRulesSet()&&u.isCustomPreferences};this.viewHiddenCharts=function(){e.publish("cao/insight/open_hidden_charts_panel",u.hiddenCharts)};this.refreshPerformed=function(){u.populateFieldRules()};function h(t){return t.replace(/\{0\}/g,function(t){return"<b>"+t+"</b>"})}function g(t){var e=t.nodes;var i=[];e&&e.length>0&&e.forEach(function(t){var e;e=t&&t.libItem&&t.libItem.name?t.libItem.name:t.field.name;var a=h(n.get("cao.insight.contextPanel.customPreferences.dislikedField"));i.push({label:n.get(a,[e]),field:t,valid:true})});return i}function f(t){var e=t.nodes;var i=[];e&&e.length>0&&e.forEach(function(t){var e=h(n.get("cao.insight.contextPanel.customPreferences.definedItems"));i.push({label:n.get(e,[t[t.type].field,t.type]),field:t,valid:true})});return i}var v=5e3;this.updateListTimer=function(){o.cancel(u.cancelStartTimer);this.cancelStartTimer=o(function(){u.populateFieldRules()},v)};this.populateFieldRules=function(){c.getLearnedItems().then(function(t){var e=[];function n(t){return"define"===t.relation}function i(t){return"dislike"===t.relation}var a=t.filter(i)[0];var s=t.filter(n)[0];a&&(e=e.concat(g(a)));s&&(e=e.concat(f(s)));u.fieldRules=e})};this.removeFieldPreference=function(t){if(t.type)return c.removeDefinedItem(t.id);return c.unDislikeField(t.id)};this.reApplyDefinedField=function(t){if("dimension"===t.type)return c.applyDimensionLearning(t.dimension.field);return c.applyMeasureLearning(t.measure.field)};this.reApplyFieldPreference=function(t){if(t.type)return u.reApplyDefinedField(t);if(t.field)return c.dislikeField(t.field.name);if(t.libId)return c.dislikeLibItem(t.libId.name)};this.openGlobalModeSummaryDialog=function(){d=t.getService("luiDialog").show({template:s,input:{title:"cao.insight.contextPanel.HelpTitle",html:s,closeDialog:function t(){d.close();d=null}}})};this.isHiddenCharts=function(){return u.hiddenCharts&&"INTRO"!==u.state&&"INIT"!==u.state};function m(){return{type:"hide",isHiddenChartLearningOption:true,text:n.get("cao.insight.contextPanel.details.hideChart"),subText:n.get("cao.insight.contextPanel.details.hideChart.subtext"),chart:u.chart}}this.getDetailsForSelectedChart=function(){if(this.chart){var t=[];t=t.concat(p(this.chart.getFields()));t=t.concat(p(this.chart.getMeasures()));t=t.concat(p(this.chart.getDimensions()));t.push(m());u.detailsForChart=t}};this.hiddenChartsTitle=function(){return n.get("cao.insight.contextPanel.hiddenCharts",[u.hiddenCharts.length])};this.updateChart=function(t){u.chart=t;u.initState=true;u.hiddenCharts=[];u.chart?u.getDetailsForSelectedChart():u.populateFieldRules()};u.updateChart(r.getSelectedChart());function b(){u.getDetailsForSelectedChart()}this.openDetailsOption=function(t){u.currentDetailsOption&&u.currentDetailsOption===t?u.currentDetailsOption=null:u.currentDetailsOption=t};e.subscribe("cao/insight/selectedChartChanged",this.updateChart);e.subscribe("cao/insight/light_editing",b);e.subscribe("cao/insight/refreshPerformed",u.refreshPerformed);this.$onDestroy=function(){e.unsubscribe("cao/insight/selectedChartChanged");e.unsubscribe("cao/insight/light_editing");e.unsubscribe("cao/insight/refreshPerformed",u.refreshPerformed);u.cancelStartTimer&&o.cancel(u.cancelStartTimer)}}];var r={transclude:true,template:a,bindings:{app:"<",hiddenCharts:"<",state:"<",insightFeedback:"<",precedentsEnabled:"="},controller:o};return t.nativeComponent("qvCaoInsightsContextPanel",r)}.apply(e,i),void 0!==a&&(t.exports=a))},948:function(t,e){t.exports='<div class="cao-insights-context-panel editor">\n\t<div class="cao-insight-context-panel-header">\n\t\t<div class="title" q-translation="{{ $ctrl.chart ? \'cao.insight.contextPanel.header\' : \'cao.insight.contextPanel.global.header\' }}"></div>\n\t\t<span ng-if="!$ctrl.chart" class="lui-icon lui-icon--help lui-icon--small help-icon" ng-click="$ctrl.openGlobalModeSummaryDialog()"></span>\n\t</div>\n\t\n\t<div class="context-panel-content">\n\t\n\t\t<div ng-if="!$ctrl.chart" class="global-mode">\n\t\t\t<div ng-if="$ctrl.isHiddenCharts()" class="hidden-charts">\n\t\t\t\t<button class="hidden-charts-button" ng-click="$ctrl.viewHiddenCharts()">\n\t\t\t\t\t<span class="lui-list__aside">\n\t\t\t\t\t\t<span class="lui-icon hidden-chart-icon"></span>\t\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class="lui-list__aside text-wrapper">\n\t\t\t\t\t\t<span class="lui-list__text title" tid="cao-hidden-charts-title">{{$ctrl.hiddenChartsTitle()}}</span>\t\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class="lui-list__aside ng-scope">\n\t\t\t\t\t\t<span class="lui-icon lui-icon--small lui-icon--arrow-right icon-arrow"></span>\n\t\t\t\t\t</span>\n\t\t\t\t</button>\n\t\t\t\t<qv-cao-hidden-charts-panel on-panel-hide-action="$ctrl.handleHiddenCharts(chart)" hidden-charts="$ctrl.hiddenCharts" hidden-charts-title="$ctrl.hiddenChartsTitle()" />\n\t\t\t</div>\n\t\t\t<div ng-if="$ctrl.noLearningFound()" class="global-mode-no-learning-applied">\n\t\t\t\t<div class="no-learning-icon" />\n\t\t\t\t<p q-translation="cao.insight.contextPanel.noLearningApplied" class="no-learning-text"></p>\n\t\t\t</div>\n\t\t\t<div ng-if="$ctrl.isFieldRulesSet()" class="custom-preferences">\n\t\t\t\t<span class="lui-list__aside">\n\t\t\t\t\t<span class="lui-icon lui-icon--approve"></span>\n\t\t\t\t</span>\n\n\t\t\t\t<div class="spacing">\n\t\t\t\t\t<div class="preferences-header-title">\n\t\t\t\t\t\t<div class="title" q-translation="cao.insight.contextPanel.customPreferences.title"></div>\n\t\t\t\t\t\t<div class="sub-title" ng-if="customPreferencesToggleOn" q-translation="{{ $ctrl.isCustomPreferences ? \'properties.on\' : \'properties.off\' }}"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="switch-toggle" ng-if="customPreferencesToggleOn">\n\t\t\t\t\t\t<lui-switch x-model="customPreferencesToggle.value" tid="cao-custom-preferences-switch" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div ng-if="$ctrl.isFieldRulesEnabled()">\n\t\t\t\t<qv-cao-field-preferences ng-repeat="fieldRule in $ctrl.fieldRules" delete-rule="$ctrl.removeFieldPreference(fieldPref)" re-apply-rule="$ctrl.reApplyFieldPreference(fieldPref)" field-rule="fieldRule" update-list="$ctrl.updateListTimer()" />\n\t\t\t</div>\n\t\t</div>\n\t\t\n\t\t<div ng-if="$ctrl.chart" class="chart-mode">\n\t\t\t<div class=\'qv-panel-properties\' style="overflow: auto;">\n\t\t\t\t<qv-cao-insight-editor ng-if="$ctrl.chart" chart="$ctrl.chart" app="$ctrl.app" />\n\t\t\t</div>\n\n\t\t\t<div class="cao-accordion-panel">\n\t\t\t\t<cao-accordion-control label="cao.insight.contextPanel.details">\n\t\t\t\t\t<qv-cao-details-option ng-repeat="detail in $ctrl.detailsForChart" detail="detail" open-learning-options="$ctrl.openDetailsOption" is-learning-option-open="detail === $ctrl.currentDetailsOption" insight-feedback="$ctrl.insightFeedback"></qv-cao-details-option>\n\t\t\t\t</cao-accordion-control>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'},949:function(t,e){t.exports='<lui-dialog class="selection-insights-dialog" x-variant="{{::variant}}">\n\t<lui-dialog-header>\n\t\t<lui-dialog-title\n\t\t\tq-translation="cao.insight.contextPanel.HelpTitle"\n\t\t></lui-dialog-title>\n\t</lui-dialog-header>\n\t<lui-dialog-body class="q-modal-loading">\n\t\t<p q-translation="cao.insight.contextPanel.HelpText"></p>\n\t</lui-dialog-body>\n\t<lui-dialog-footer>\n\t\t<button\n\t\t\tclass="lui-button close-button"\n\t\t\tng-click="closeDialog();"\n\t\t\tq-translation="Common.Close"\n\t\t\ttid="selection-insights-dialog-help-button"\n\t\t></button>\n\t</lui-dialog-footer>\n</lui-dialog>'},950:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(951)],a=function(t,e){var n=[function(){var t=this;t.expanded=true;this.toggleExpanded=function(){t.expanded=!t.expanded}}];var i={transclude:true,template:e,bindings:{label:"@"},controller:n};return t.nativeComponent("caoAccordionControl",i)}.apply(e,i),void 0!==a&&(t.exports=a))},951:function(t,e){t.exports='<div ng-click="$ctrl.toggleExpanded()"  class="cao-accordion-control" ng-class="{ \'expanded\': $ctrl.expanded }">\n\t<span class="cao-accordion-control-label" q-title-translation="{{$ctrl.label}}" q-translation="{{$ctrl.label}}" />\n\t<span class="cao-accordion-expander lui-icon lui-icon--small lui-icon--arrow-right" ng-class="{ \'expanded\': $ctrl.expanded }"></span>\n</div>\n<div ng-show="$ctrl.expanded">\n\t<ng-transclude></ng-transclude>\n</div>'},952:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(953)],a=function(t,e,n){var i=["$element","$timeout",function(e,n){this.$onChanges=function(i){i.isLearningOptionOpen&&i.isLearningOptionOpen.currentValue&&n(function(){var n=t(".context-panel-content");if(n.length){var i=e.offset().top-n.offset().top;var a=e.find(".cao-details-option").height();n.scrollTop(i+a)}})}}];var a={transclude:true,template:n,bindings:{detail:"<",openLearningOptions:"<",isLearningOptionOpen:"<",insightFeedback:"<"},controller:i};return e.nativeComponent("qvCaoDetailsOption",a)}.apply(e,i),void 0!==a&&(t.exports=a))},953:function(t,e){t.exports='<div class="cao-details-option" ng-if="(!$ctrl.detail.searchMatch && $ctrl.insightFeedback) || $ctrl.detail.searchMatch">\n\t<button class="details-option-button" ng-class="{\'cao-learning-option-open\': $ctrl.isLearningOptionOpen}" ng-click="$ctrl.openLearningOptions($ctrl.detail)" ng-if="!$ctrl.detail.searchMatch && $ctrl.insightFeedback">\n\t\t<div class="detail-icon">\n\t\t\t<span class="lui-list__aside">\n\t\t\t\t<span class="lui-icon {{ !$ctrl.detail.userMatch ? \'lui-icon--analyze\' : \'lui-icon--approve\' }}"></span>\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="label-title" ng-bind-html="$ctrl.detail.text"></div>\n\t\t<div class="learning-options-toggle">\n\t\t\t<span class="lui-list__aside">\n\t\t\t\t<span class="lui-icon lui-icon--small lui-icon--more more-option" ng-class="{\'panelNotOpened\' : !$ctrl.isLearningOptionOpen}"></span>\n\t\t\t</span>\n\t\t</div>\n\t</button>\n\t<div class="details-option-item no-hover" ng-if="$ctrl.detail.searchMatch">\n\t\t<div class="detail-icon">\n\t\t\t<span class="lui-list__aside">\n\t\t\t\t<span class="lui-icon {{ !$ctrl.detail.userMatch ? \'lui-icon--analyze\' : \'lui-icon--approve\' }}"></span>\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="label-title" ng-bind-html="$ctrl.detail.text"></div>\n\t</div>\n\t<div ng-show="$ctrl.isLearningOptionOpen">\n\t\t<qv-cao-learning-option detail="$ctrl.detail" />\n\t</div>\n</div>'},954:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(196),n(955)],a=function(t,e,n,i){var a=["qvCaoLearningService",function(t){var i=this;i.learningPerformed=false;var a="field";var s="propose";var o="hide";this.getOppositeLearningOptionActionText=function(){if(i.detail&&i.detail.type)return i.detail.type===n.MEASURE?"cao.insight.contextPanel.details.learningOption.dimension":"cao.insight.contextPanel.details.learningOption.measure";return null};function r(){return i.detail.type===n.MEASURE&&!i.learningPerformed||i.detail.type===n.DIMENSION&&i.learningPerformed?t.applyDimensionLearning(i.detail.field):t.applyMeasureLearning(i.detail.field)}function l(){return i.detail.isLibItem?t.dislikeLibItem(i.detail.libItemId):t.dislikeField(i.detail.field)}function c(t){i.learningPerformed=t;e.publish("cao/insight/learningPerformed",!!t)}this.applyLearning=function(){r().then(function(t){t&&t.nodes[0]&&(i.learningQuad=t.nodes[0].id);c(a)})};this.hideChart=function(){t.hideChart(i.detail.chart).then(function(){c(o)})};this.handleNeverPropose=function(){l().then(function(){c(s)})};this.removeFieldPreference=function(e){if(e.type)return t.removeDefinedItem(e.id);return t.unDislikeField(e.id)};this.revertLearningAction=function(){if(i.detail.type&&i.detail.field&&i.learningQuad&&i.learningPerformed==a){t.removeDefinedItem(i.learningQuad);c()}else i.learningPerformed==s?t.unDislikeItem(i.detail.field).then(function(){c()}):t.unHideChart(i.detail.chart).then(function(){c()})}}];var s={template:i,bindings:{detail:"<"},controller:a};return t.nativeComponent("qvCaoLearningOption",s)}.apply(e,i),void 0!==a&&(t.exports=a))},955:function(t,e){t.exports='<div class="cao-learning-option">\n\t<p q-translation="cao.insight.contextPanel.details.learning" />\n\n\t<div ng-if="!$ctrl.detail.isHiddenChartLearningOption && !$ctrl.learningPerformed">\n\t\t<button class="lui-button learning-button" ng-click="$ctrl.applyLearning()" \n\t\t\tq-translation="{{$ctrl.getOppositeLearningOptionActionText()}}" ng-if="$ctrl.getOppositeLearningOptionActionText() && !$ctrl.detail.isLibItem"/>\n\t\t<button class="lui-button learning-button" ng-click="$ctrl.handleNeverPropose()" \n\t\t\tq-translation="cao.insight.contextPanel.details.learningOption.neverPropose" />\n\t</div>\n\n\t<div ng-if="$ctrl.detail.isHiddenChartLearningOption && !$ctrl.learningPerformed">\n\t\t<button class="lui-button learning-button" ng-click="$ctrl.hideChart()" \n\t\t\tq-translation="cao.insight.contextPanel.details.learningOption.hidechart" tid="hide-chart-button" />\n\t\t<p class="hide-subtext" q-translation="{{$ctrl.detail.subText}}" />\n\t</div>\n\n\t<div ng-if="$ctrl.learningPerformed">\n\t\t<button class="lui-button learning-button undo" ng-click="$ctrl.revertLearningAction()" \n\t\t\tq-translation="cao.insight.contextPanel.details.learningOption.undo" />\n\t</div>\n</div>'},956:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(957),n(958)],a=function(t,e,n){var i=[function(){var t=this;this.openPanel=function(){t.isPanelOpened=true};this.closePanel=function(){t.isPanelOpened=false};this.handleHiddenChart=function(n){e.publish("cao/insight/learningPerformed",!!n);return t.onPanelHideAction({chart:n})};e.subscribe("cao/insight/open_hidden_charts_panel",this.openPanel);this.$onDestroy=function(){e.unsubscribe("cao/insight/open_hidden_charts_panel")}}];var a={template:n,controller:i,bindings:{onPanelHideAction:"&",hiddenCharts:"<",hiddenChartsTitle:"<"}};return t.nativeComponent("qvCaoHiddenChartsPanel",a)}.apply(e,i),void 0!==a&&(t.exports=a))},957:function(t,e){t.exports='<div class="hidden-charts-panel" ng-class="{ \'open-panel\': $ctrl.isPanelOpened }">\n\t\t<div class="header" ng-click="$ctrl.closePanel()">\n\t\t\t<div class="header-wrapper">\n\t\t\t\t<div class="back-navigation">\n\t\t\t\t\t<span class="lui-icon back-icon  lui-icon--previous  lui-icon--small" />\n\t\t\t\t</div>\n\t\t\t\t<div class="text-wrapper">\n\t\t\t\t\t<div class="navigation-title" q-translation="cao.insight.hiddenCharts.panel.goBackTitle"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\n\t\t<div class="hidden-charts-content">\n\t\t\t<div class="spacing title">{{$ctrl.hiddenChartsTitle}}</div>\n\t\t\t<div class="spacing sub-title" q-translation="cao.insight.hiddenCharts.panel.subTitle" ng-if="$ctrl.hiddenCharts.length > 0"></div>\n\t\t\t<div class="spacing sub-title" q-translation="cao.insight.hiddenCharts.panel.subTitleNoHiddenCharts" ng-if="$ctrl.hiddenCharts.length === 0"></div>\n\t\t\t<qv-cao-hidden-charts-view chart="chart" index="$index" ng-repeat="chart in $ctrl.hiddenCharts | orderBy : \'-chart.relevance\'"\n\t\t\t\ton-hide-action="$ctrl.handleHiddenChart(chart)"></cao-hidden-charts-view>\n\t\t</div>\n\t</div>\n</div>'},958:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91),n(959),n(264),n(960)],a=function(t,e,n,i,a){var s=["$element","qvCaoRenderService","luiTooltip","luiPopover",function(t,n,s,o){var r=this;var l=[];r.popupOpen=false;r.actionIcon="view";var c=null;var u={template:i.template,controller:i.controller,input:{item:"",style:{width:"150px"}},alignTo:t.find(".hide-action-button")[0],dock:"left"};var d=500;function p(t){var e=[];t&&t.length>0&&(e=t.map(function(t){return t.field||t.libIdLabel}));return e}this.toTitleCase=function(t){if(t)return t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})};this.setFields=function(){if(r.chart){var t=[];var e=[];var n=[];t=t.concat(p(r.chart.getDimensions()));e=e.concat(p(r.chart.getMeasures()));n=n.concat(p(r.chart.getFields()));r.dimensions=t.toString();r.measures=e.toString();r.fields=n.toString()}};function h(){return r.chart.getComplexity()?r.chart.getComplexity():r.index}this.loadChart=function(){return r.chart.loadChart()};function g(t,e,n,i,a){var s={template:t,controller:e,dock:i,closeOnResize:true,alignTo:n};var c=o.show(s);l.push(c);c.closed.then(function(){r.popupOpen=false;"function"===typeof a&&a()})}this.openChartInfoPopover=function(){if(r.popupOpen){r.popupOpen=false;l=[]}else{r.popupOpen=true;var e=["$scope",function(t){t.dimensions=r.dimensions;t.measures=r.measures;t.fields=r.fields}];g(a,e,t.find(".open-chart-info-popover")[0],"bottom")}};this.$onChanges=function(){if(r.chart){n.enqueueForRender(r.loadChart,h());r.chart.refreshChartType();r.setFields()}};this.$onDestroy=function(){r.chart&&this.chart.destroyChart()};this.openTooltip=function(){setTimeout(function(){var t=r.chart.isHidden()?"cao.insight.hiddenCharts.view.unhide":"cao.insight.hiddenCharts.view.hide";u.input.item=e.get(t);c=s.show(u)},d)};this.closeTooltip=function(){setTimeout(function(){c&&c.close()},d)};this.handleHideChartAction=function(){r.closeTooltip();r.onHideAction({chart:r.chart})}}];var o={template:n,bindings:{chart:"<",index:"<",onHideAction:"&"},controller:s};return t.nativeComponent("qvCaoHiddenChartsView",o)}.apply(e,i),void 0!==a&&(t.exports=a))},959:function(t,e){t.exports='<div class="hidden-charts-view" ng-class="{ \'hidden\': !$ctrl.chart.isHidden() }">\n\t\t<div class="title-container spacing">\n\t\t\t<div class="header-title">\n\t\t\t\t<div class="title">\n\t\t\t\t\t{{ $ctrl.toTitleCase($ctrl.chart.chartType) }}\n\t\t\t\t</div>\n\t\t\t\t<div class="open-chart-info-popover" ng-click="$ctrl.openChartInfoPopover()"><span class="lui-icon lui-icon--info" /></div>\n\t\t\t</div>\n\t\t\t<div class="cao-hide-action" >\n\t\t\t\t<span class="lui-list__aside action-button-container">\n\t\t\t\t\t<span \n\t\t\t\t\t\tclass="hide-action-button" \n\t\t\t\t\t\tng-class="$ctrl.chart.isHidden() ? \'icon--view\': \'lui-icon lui-icon--back\'"\n\t\t\t\t\t\tng-click="$ctrl.handleHideChartAction()" \n\t\t\t\t\t\tng-mouseover="$ctrl.openTooltip()" \n\t\t\t\t\t\tng-mouseleave="$ctrl.closeTooltip()"\n\t\t\t\t\t/>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t\n\t\t<div class="spacing content-view">\n\t\t\t<div class="wrapper">\n\t\t\t\t<div class="image-container" ng-if="$ctrl.chart && $ctrl.chart.getState() === \'LOADING\'">\n\t\t\t\t\t<img ng-src="{{$ctrl.chart.chartTypeImageUrl}}" class="loader-image" />\n\t\t\t\t</div>\n\t\t\t\t<qv-object ng-if="$ctrl.chart && $ctrl.chart.getState() === \'LOADED\'" model="$ctrl.chart.chart.model" options="$ctrl.chart.options" object="$ctrl.chart.object" />\n\t\t\t</div>\n\t\t</div>\n</div>'},960:function(t,e){t.exports='<lui-popover class="cao-hidden-charts-popover">\n\t<div class="cao-hidden-charts-popover-body">\n\t\t<ul class="lui-list cao-hidden-charts-popover-list">\n\t\t\t<li class="lui-list__item cao-hidden-charts-popover-list__item" ng-if="dimensions">\n\t\t\t\t<div>\n\t\t\t\t\t<strong q-translation="Common.Dimensions"></strong>:<span>&nbsp;{{ dimensions }}</span>\n\t\t\t\t</div>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item cao-hidden-charts-popover-list__item" ng-if="measures">\n\t\t\t\t<div>\n\t\t\t\t\t<strong q-translation="Common.Measures"></strong>:<span>&nbsp;{{ measures }}</span>\n\t\t\t\t</div>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item cao-hidden-charts-popover-list__item" ng-if="fields">\n\t\t\t\t<div>\n\t\t\t\t\t<strong q-translation="Common.Fields"></strong>:<span>&nbsp;{{ fields }}</span>\n\t\t\t\t</div>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</lui-popover>'},961:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(91),n(962),n(264)],a=function(t,e,n,i,a){var s=["luiTooltip","$element",function(t,i){var s=this;var o=null;var r={template:a.template,controller:a.controller,input:{item:"",style:{width:"150px"}},alignTo:i.find(".field-rule-action-button")[0],dock:"left"};this.toggleFieldRule=function(){s.fieldRule.valid=!s.fieldRule.valid;e.publish("cao/insight/learningPerformed",true)};this.handleFieldRuleAction=function(){s.closeTooltip();s.fieldRule.valid?s.deleteRule({fieldPref:s.fieldRule.field}).then(function(){s.toggleFieldRule();s.updateList()}):s.reApplyRule({fieldPref:s.fieldRule.field}).then(function(){s.toggleFieldRule()})};this.openTooltip=function(){var e=s.fieldRule.valid?"cao.insight.contextPanel.customPreferences.remove":"cao.insight.contextPanel.customPreferences.restore";r.input.item=n.get(e);o=t.show(r)};this.closeTooltip=function(){o&&o.close()}}];var o={template:i,bindings:{fieldRule:"<",deleteRule:"&",reApplyRule:"&",updateList:"&"},controller:s};return t.nativeComponent("qvCaoFieldPreferences",o)}.apply(e,i),void 0!==a&&(t.exports=a))},962:function(t,e){t.exports='<div class="cao-field-preferences" ng-class="{ \'hidden\': !$ctrl.fieldRule.valid }">\t\n\t<div class="label-title" ng-bind-html="$ctrl.fieldRule.label" />\n\t<div class="field-rule-action-container" >\n\t\t<span class="lui-list__aside action-button-container">\n\t\t\t<span \n\t\t\t\tclass="lui-icon field-rule-action-button" \n\t\t\t\tng-class="$ctrl.fieldRule.valid ? \'lui-icon--bin\': \'lui-icon--back\'"\n\t\t\t\tng-click="$ctrl.handleFieldRuleAction()" \n\t\t\t\tng-mouseover="$ctrl.openTooltip()" \n\t\t\t\tng-mouseleave="$ctrl.closeTooltip()"\n\t\t\t/>\n\t\t</span>\n\t</div>\n</div>'},963:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(10),n(95),n(964),n(223),n(222)],a=function(t,e,n,i,a,s){var o=["$window",function(t){var i=this;i.app=null;i.isToggleContextDisabled=false;this.$onInit=function(){e.element(t).bind("resize",i.autoHidePanels);i.autoHidePanels()};this.$onChanges=function(t){i.app=t.app.currentValue;i.isContextPanelVisible=a.storageObj(i.app.id).contextPanel;i.isAssetsPanelVisible=a.storageObj(i.app.id).assetsPanel};this.autoHidePanels=function(n){var a="string"!==typeof n;var s=e.element(t).innerWidth();s<1200&&(i.isContextPanelVisible&&i.isAssetsPanelVisible&&a?i.toggleContextPanel():i.isAssetsPanelVisible&&i.isContextPanelVisible&&"assets"===n?i.toggleContextPanel():i.isAssetsPanelVisible&&i.isContextPanelVisible&&"context"===n&&i.toggleAssetsPanel())};this.getContextPanelToggleButtonTitle=function(){return i.isContextPanelVisible?"cao.insight.hideContextPanel":"cao.insight.showContextPanel"};this.getHideAssetsButtonTitle=function(){return i.isAssetsPanelVisible?"cao.insight.hideAssetsPanel":"cao.insight.showAssetsPanel"};this.contextPanelToggled=function(){i.autoHidePanels("context");s.resizeCharts(t)};this.toggleContextPanel=function(){if(!i.isToggleContextDisabled){i.isContextPanelVisible=!i.isContextPanelVisible;a.toggleContextPanel(i.app.id);n.publish("cao/insight/contextPanelToggled",i.isContextPanelVisible)}};this.disableToggleContext=function(t){i.isToggleContextDisabled=t};this.assetsPanelToggled=function(e){i.isAssetsPanelVisible=e;i.autoHidePanels("assets");s.resizeCharts(t)};this.toggleAssetsPanel=function(){i.isAssetsPanelVisible=!i.isAssetsPanelVisible;a.toggleAssetsPanel(i.app.id);n.publish("cao/insight/assetsPanelToggled",i.isAssetsPanelVisible)};n.subscribe("cao/insight/contextPanelToggled",this.contextPanelToggled);n.subscribe("cao/insight/assetsPanelToggled",this.assetsPanelToggled);n.subscribe("cao/insight/editInsightProperties",i.disableToggleContext);this.$onDestroy=function(){n.unsubscribe("cao/insight/contextPanelToggled");n.unsubscribe("cao/insight/assetsPanelToggled");n.unsubscribe("cao/insight/editInsightProperties")}}];var r={transclude:true,template:i,bindings:{app:"<",insightFeedback:"<"},controller:o};return t.nativeComponent("qvCaoInsightsBottomPanel",r)}.apply(e,i),void 0!==a&&(t.exports=a))},964:function(t,e){t.exports='\n<div class="cao-insights-bottom-panel">\n\t<div class="hide-assets-panel-container">\n\t\t<button class="bottom-panel-button" ng-class="{ \'lui-active\': $ctrl.isAssetsPanelVisible }" q-title-translation="{{$ctrl.getHideAssetsButtonTitle()}}" tid="bottom-panel-button-left"\n\t\t\tng-click="$ctrl.toggleAssetsPanel()" tabindex="0">\n\t\t\t<span class="lui-icon lui-icon--toggle-left" />\n\t\t\t<span class="label" q-translation="{{$ctrl.getHideAssetsButtonTitle()}}" />\n\t\t</button>\n\t</div>\n\t<div class="hide-insight-properties-container" ng-if="$ctrl.insightFeedback">\n\t\t<button class="bottom-panel-button" ng-class="{ \'lui-active\': $ctrl.isContextPanelVisible, \'disabled\': $ctrl.isToggleContextDisabled }" q-title-translation="{{$ctrl.getContextPanelToggleButtonTitle()}}" tid="bottom-panel-button-right" \n\t\t\tng-click="$ctrl.toggleContextPanel()" tabindex="0" ng-attr-tabindex="{{$ctrl.isToggleContextDisabled ? \'-1\' : \'0\'}}">\n\t\t\t<span class="label" q-translation="{{$ctrl.getContextPanelToggleButtonTitle()}}" />\n\t\t\t<span class="lui-icon lui-icon--toggle-right" />\n\t\t</button>\n\t</div>\n</div>'},965:function(t,e,n){"use strict";var i,a;!(i=[n(966),n(48),n(90),n(967),n(11),n(167),n(277)],a=function(t,e,n,i,a,s){e.service("qvMultiStatePopoverService",["luiPopover",function(e){var o;function r(t,e){var n=t.which;n=t.shiftKey&&s.TAB===n?"SHIFT_TAB":n;switch(n){case s.ARROW_LEFT:case s.ARROW_UP:case"SHIFT_TAB":case s.ESCAPE:a(e).focus();t.preventDefault();break}}return{show:function a(s){var l={handleBtnKeyDown:r,getItems:function t(){return[]},autoFocus:false};s=n.extend(true,{},l,s);o=e.show({template:t,controller:i.controller,alignTo:s.alignToElement,autoFocus:s.autoFocus,input:{title:s.title,getItems:s.getItems,clear:s.clear,click:s.click,onClose:s.onClose,brightCurSel:s.brightCurSel,openTooltip:s.openTooltip,closeTooltip:s.closeTooltip,handleKeyDown:s.handleKeyDown,handleBtnKeyDown:s.handleBtnKeyDown,handlePopoverKeyDown:s.handlePopoverKeyDown,alignToElement:s.alignToElement},closeOnResize:true,dock:"top"});return o},close:function t(){o&&o.close();o=null}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},966:function(t,e){t.exports='<lui-popover class="lui-popover qv-multi-state-popover" ng-class="{ bright: input.brightCurSel }" tid="qv-multi-state-popover">\n\t<lui-popover-header class="lui-popover__header">\n\t\t<div class="lui-popover__title">\n\t\t\t<span ng-if="input.title && input.title.length">{{ input.title }}</span>\n\t\t\t<div class="btn-clearall">\n\t\t\t\t<lui-button \n\t\t\t\t\ttid="qv-multi-state-popover-btn-clear"\n\t\t\t\t\tclass="clear-all-btn lui-button--block"\n\t\t\t\t\tng-keydown="handleBtnKeyDown($event, input.alignToElement)" \n\t\t\t\t\tng-click="input.clear(input.getItems()[0].qField, null, $event)" \n\t\t\t\t\tng-disabled="allItemsNonClearable( input.getItems() )" \n\t\t\t\t\tq-title-translation="AlternateState.Popover.ClearAllStates">\n\t\t\t\t\t<span class="lui-button__text" q-translation="AlternateState.Popover.ClearAllStates"></span>\n\t\t\t\t</lui-button>\n\t\t\t</div>\n\t\t</div>\n\t</lui-popover-header>\t\n\t<lui-popover-body class="lui-popover__body">\n\t\t<ul class="lui-list" qva-direction x-dir-setting="{{input.direction}}">\n\t\t\t<li class="item" ng-repeat="item in input.getItems()" ng-click="input.click($event)" ng-mousemove="input.openTooltip($event, item)" ng-mouseleave="input.closeTooltip()"\n\t\t\t\ttabindex="0" ng-keydown="handleKeyDown($event, item)" aria-label="{{item.screenReaderLabel}}" ng-class="{ \'item-locked\' : item.qLocked }">\n\t\t\t\t<div class="item-container">\n\t\t\t\t\t<div ng-if="item.qLocked" class="icon-lock">\n\t\t\t\t\t\t<span class="lui-icon lui-icon--lock">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="item-component text-container" qva-direction x-dir-text="{{item.displayStateName}}">\n\t\t\t\t\t\t<div class="text">{{ item.displayStateName }}</div>\n\t\t\t\t\t\t<div class="values">{{ item.translation }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div ng-if="!( item.qLocked || item.qOneAndOnlyOne )" class="item-component remove" ng-click="input.clear(item.qField, item.stateName, $event)" q-title-translation="CurrentSelections.Remove">\n\t\t\t\t\t\t<span class="lui-icon lui-icon--remove"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<qv-state-count-bar ng-if="!item.isPlaceHolder && item.isSingleState" state-counts="item.qStateCounts"></qv-state-count-bar>\n\t\t\t</li>\n\t\t</ul>\n\t</lui-popover-body>\n</lui-popover>'},967:function(t,e,n){"use strict";var i,a;!(i=[n(277)],a=function(){var t={template:null,controller:["$scope","$element","$timeout",function(t,e,n){this.close=function(){i()};function i(){n(function(){t.destroyComponent();e.remove()})}t.closingDeferred.promise.then(function(e){t.input.onClose(e);i()});t.allItemsNonClearable=function(t){return!t.some(function(t){var e=!(t.qLocked||t.qOneAndOnlyOne);return e})}}]};return t}.apply(e,i),void 0!==a&&(t.exports=a))},968:function(t,e){t.exports='<div class="current-selections-item" data-tid="current-selections-item"\n\tng-mousemove="openTooltip($event, item)" ng-mouseleave="closeTooltip()" \n\tng-class="{\n\t\t\'active\' : item.qField === activeFieldName,\n\t\t\'dim\' : $parent.itemSelected && !item.active,\n\t\t\'item-locked\' : item.qLocked,\n\t\t\'locked-feedback item-animate-in\' : item.feedbackActive && item.qLocked,\n\t\t\'item-animate-out\' : (!item.feedbackActive && item.qLocked) || (!item.feedbackActive && item.qOneAndOnlyOne),\n\t\t\'single-select-feedback item-animate-in\' : item.feedbackActive && item.qOneAndOnlyOne,\n\t\t\'single-icon\': item.qOneAndOnlyOne || item.qLocked\n\t}">\n\t<div ng-class="{locked:item.qLocked}" class="text">\n\t\t<div class="text-wrap">\n\t\t\t<span ng-class="{ \'lui-icon lui-icon--lock\': item.qLocked }"></span>\n\t\t\t<span class="name" tid="selection-name">{{item.name}}</span>\n\t\t</div>\n\t\t<span class="values">\n\t\t\t<span ng-if="!item.isDefaultState">{{item.displayStateName}}:</span>\n\t\t\t<span tid="current-selection-item-text">{{item.translation}}</span>\n\t\t</span>\n\t</div>\n\t<div class="options" title=" "> \x3c!-- The empty title attribute is neeeded for screen reader not to read anchor title: \'clear selections\' --\x3e\n\t\t<div ng-if="!item.isDefaultState" class="item-component count" title="">\n\t\t\t<span class="field-states-indicator"></span>\n\t\t</div>\n\t\t<a ng-if="!currentSelectionDisabled && (!item.qLocked && !item.isPlaceHolder && !item.qOneAndOnlyOne)" ng-click="clear(item.qField, item.stateName)" class="remove" q-title-translation="CurrentSelections.Remove">\n\t\t\t<span class="lui-clear-all lui-icon lui-icon--remove"></span>\n\t\t</a>\n\t</div>\n\n\t<qv-state-count-bar ng-if="!item.isPlaceHolder && item.isSingleState" state-counts="item.qStateCounts"></qv-state-count-bar>\n</div>'},969:function(t,e){t.exports='<div class="qv-odag-bar" ng-class="{\'inEditMode\': inEditMode, \'inAnalysisMode\': !inEditMode, \'standAlone\': standAlone }">\n\t<div class="leftOdag" qv-pager qv-sortable-list="sortableNavPoints"> \n\t\t<div ng-if="odagNavPoints.items.length === 0" class="drag-help" ng-class="{\'inEditMode\': inEditMode}">{{waterMarkText}}</div>\n\t\t<ul class="list">\n\t\t\t<li ng-repeat="item in odagNavPoints.items track by item.id" class="odag-nav-point" ng-class="item.classList">\n\t\t\t\t<div class="nav-point-container" ng-class="{\'invalid\': item.invalid }">\n\t\t\t\t\t<div ng-if="inEditMode" class="dropArea"></div>\n\t\t\t\t\t<qv-odag-toolbar-navpoint item="item" in-edit-mode="inEditMode"></qv-odag-toolbar-navpoint>\n\t\t\t\t</div>\n\t\t\t</li> \n\t\t</ul>\n\t\t<a class="qv-pager-nav qv-pager-previous" ng-click="prevPage()" q-title-translation="Tooltip.Previous"><i class="lui-icon lui-icon--arrow-left"></i></a>\n\t\t<a class="qv-pager-nav qv-pager-next" ng-click="nextPage()" q-title-translation="Tooltip.Next"><i class="lui-icon lui-icon--arrow-right"></i></a>\t\t\n\t</div>\n </div>\t\n'},970:function(t,e,n){"use strict";var i,a;!(i=[n(89),n(92),n(54),n(102),n(219),n(90)],a=function(t,e,n,i,a,s){var o=e.extend("ODAGNavPoint",{properties:null,parent:null,init:function t(e){i.mixin(this);this.notification("Invalidated");this.parent=e.parent;this.properties={qInfo:{qType:"odagNavPoint"}};this.properties=s.extend(this.properties,e.properties);var a=this;this._sheetInvalidated=function(){a.parent.getProperties().then(function(t){for(var e=0;e<t.navPoints.length;e++){var i=t.navPoints[e];if(i.info.id===a.properties.info.id){if(!n.isEqual(i,n.omit(a.properties,["qInfo"]))){a.properties=s.extend(a.properties,i);a.Invalidated.emit()}break}}})};this.parent.Invalidated.bind(this._sheetInvalidated)},getLayout:function t(){var e=this;this.properties.odagLinkName=null;return a.getList(this.parent.app).then(function(t){if(t.filter(function(t){return t.properties.data.id===e.properties.odagLinkRefID}).length>0)return a.get(e.properties.odagLinkRefID,e.parent.app).then(function(t){e.properties.odagLinkName=t.properties.data.name;return e.properties});e.properties.odagLinkName="";return e.properties})},getProperties:function e(){return t.resolve(this.properties)},getEffectiveProperties:function e(){return t.resolve(this.properties)},clearSoftPatches:function t(){return},removeObject:function t(){this.parent.removeNavPoint(this.properties.info.id)},setProperties:function t(e){var n=this;this.properties=s.extend(this.properties,e);return this.parent.getProperties().then(function(t){for(var e=0;e<t.navPoints.length;e++){var i=t.navPoints[e];if(i.info.id===n.properties.info.id){var a=s.extend({},n.properties);delete a["qInfo"];t.navPoints[e]=a;break}}return n.parent.setProperties(t)})},destroy:function t(){this.parent.Invalidated.unbind(this._sheetInvalidated)}});return o}.apply(e,i),void 0!==a&&(t.exports=a))},971:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={type:"items",component:"accordion",items:{navPointProps:{type:"items",translation:"properties.odagNavProperties",items:{general:{type:"items",grouped:true,items:{title:{type:"string",ref:"title",translation:"Common.Name",minlength:1,readOnly:function t(e,n,i){var a=i.layout;return a&&(a.permissions&&!a.permissions.update||a.qMeta&&a.qMeta.sourceObject&&a.qMeta.sourceObject.length>0)},rollbackInvalid:true}}},odagLinkInfo:{type:"items",items:{odagLinkName:{type:"string",ref:"odagLinkName",translation:"properties.odag.link.name",minlength:1,readOnly:function t(){return true},rollbackInvalid:true}}}}}}};return t}.apply(e,i),void 0!==a&&(t.exports=a))},972:function(t,e){t.exports='<div class="drag-odag-navpoint">\n\t<div class="odag-nav-point-cell" ng-class="{\'active\': item.id === selObject.id, \'popoverOpen\': popover, \'invalid\': item.invalid }" ng-style="item.style" ng-click="onODAGNavPointClicked(item)">\n\t\t<qv-progress-circle ng-if="!inEditMode && !item.invalid" class=" odag-progress-circle" percentage="rowCountPercentage"></qv-progress-circle>\n\t\t<div class="cell-name" ng-if="inEditMode || !item.invalid" title="{{item.data.title}}">{{item.data.title}}</div>\n\t\t<div class="cell-name" ng-if="!inEditMode && item.invalid " q-title-translation="odag.toolbar.navpoint.invalid" q-translation="odag.toolbar.navpoint.invalid"></div>\n\t\t<div ng-if="!inEditMode && !item.invalid" class="arrow lui-icon lui-icon--triangle-bottom"></div>\n\t\t<button ng-if="inEditMode && item.invalid" class="lui-fade-button delete-invalid-navpoint" ng-click="deleteInvalidNavPoint($event, item)">\n\t\t\t<span class="lui-fade-button__icon  lui-icon lui-icon--bin"></span>\n\t\t</button>\n\t</div>\n</div>'},973:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91),n(49),n(135),n(295),n(138),n(974),n(323),n(976),n(484)],a=function(t,e,i,a,s,o,r){var l={template:r,controller:["$scope","$element","$timeout","odagNavpointService",function(r,l,c,u){var d;var p=t.getService("qvLoader");r.odagNavpointService=u;r.loadingContent={value:true};r.showInfoPopup=false;r.generatedApps=[];r.bindings=[];r.expandedItem={item:null};r.generateAppInProgress=false;r.bindingsPass=true;r.maxGeneratedAppLimitReached=false;r.dismissedMaxGenAppMsg=false;r.dismissMaxGenAppMsgClicked=function(){r.dismissedMaxGenAppMsg=true};r.isGenerateBtnDisabled=function(){r.bindingsPass=r.bindings.filter(function(t){return false===t.bindingPassesConstraint}).length>0;return r.header.invalid||r.maxGeneratedAppLimitReached||r.bindingsPass||!r.item.rowCountPercentage||100!==r.item.rowCountPercentage||a.isSuffixInUse("noData")||r.generateAppInProgress};r.canApplySelectionsForReload=function(){r.bindingsFailed=r.bindings.filter(function(t){return false===t.bindingPassesConstraint}).length>0;return!(r.header.invalid||r.bindingsFailed||!r.item.rowCountPercentage||100!==r.item.rowCountPercentage||a.isSuffixInUse("noData")||r.generateAppInProgress)};r.infoHeader=e.get("odag.toolbar.navpoint.popup.info.header");r.circleModel={chartValue:r.item.rowCountPercentage?r.item.rowCountPercentage:0};r.$watchCollection("item.rowCountPercentageNumber",function(t){r.item.rowCountPercentage=-1===t?NaN:t;r.circleModel.chartValue=r.item.rowCountPercentage?r.item.rowCountPercentage:0});r.header={invalid:false,templateThumbnail:n.p+"img/core/static/Default_thumbnail_app.png",templateName:e.get("Common.Loading"),templateDescription:e.get("Common.Loading")};function h(){return u.updateItemHeader(r.item,r.header)}r.setSelectionState=function(){var t=r.expandedItem.item;i.getFlag("ODAG_SAAS_ENABLED")&&t&&u.getSelections(t.parentContext.app,t.requestId).then(function(t){r.expandedItemSelectionState=u.getSelectedValuesDisplayString(t,{value:false})})};r.loadGeneratedApps=function(){u.loadGeneratedApps(r.item,r.generatedApps).then(function(){r.loadingContent.value=false;r.expandedItem.item&&(r.generatedApps.some(function(t){return r.expandedItem.item.requestId===t.requestId})?r.setSelectionState():r.expandedItem.item=null);r.maxGeneratedAppLimitReached=r.generatedApps.length>=r.item.maxNumberOfApps;f()})};u.initializeBindings(r.item,r.bindings);g().then(function(){r.item.initialized.promise.then(function(){r.actualRowEstFormatted="NaN"===r.item.actualRowEst?e.get("odag.toolbar.navpoint.popup.invalid"):o.format.number(r.item.actualRowEst,{});r.maxRowExpressionCountFormatted=o.format.number(r.item.maxRowExpressionCount,{});h().finally(function(){r.loadGeneratedApps()})})});function g(){d=c(function(){p.close(true).then(function(){p.show({template:s,hugeLoader:false,mediumLoader:true,appendTo:l.find(".odag-popup-body")[0]})})},0,false);return d}function f(){c.cancel(d);d=null;p.close()}r.onApplySelections=function(){u.initializeBindings(r.item,r.bindings)};r.onNavPointInfoClicked=function(t){t.preventDefault();t.stopPropagation();r.showInfoPopup=!r.showInfoPopup};r.deleteGenAppClicked=function(t,e){t.preventDefault();t.stopPropagation();r.showInfoPopup&&(r.showInfoPopup=!r.showInfoPopup);if(e.deleteIcon&&!e.actionInProgress){e.actionInProgress=true;u.deleteGeneratedApp(e).then(function(){r.loadGeneratedApps();r.expandedItem.item&&e.requestId===r.expandedItem.item.requestId&&(r.expandedItem.item=null);e.actionInProgress=false}).catch(function(t){e.actionInProgress=false;throw t})}};r.reloadApp=function(t,e){r.generateAppInProgress=true;u.reloadApp(r.item,t.requestId,e).then(function(){2===e&&(r.expandedItem.item=null);r.loadGeneratedApps();r.generateAppInProgress=false}).catch(function(t){r.generateAppInProgress=false;throw t})};r.onGenerateAppClicked=function(){r.generateAppInProgress=true;r.showInfoPopup=false;u.generateApp(r.item).then(function(){r.generateAppInProgress=false;r.loadGeneratedApps()}).catch(function(t){r.generateAppInProgress=false;throw t})};r.$on("$destroy",function(){u.stopLoadGeneratedApps(r.item);f()})}]};return l}.apply(e,i),void 0!==a&&(t.exports=a))},974:function(t,e){t.exports='<lui-popover id="odag-toolbar-navpoint-popover" ng-class="expandedItem.item? \' request-expanded\' : \'\'" class="odag-toolbar-navpoint-popover"\n x-arrow="arrow">\n\t<lui-popover-header ng-class="{\'invalid\': header.invalid}">\n\t\t<img qva-prevent-drag ng-src="{{ header.imgSrc }}" class="app-thumbnail-img" />\n\t\t<div class="title-description-container">\n\t\t\t<lui-popover-title title="{{header.templateName}}">{{header.templateName}}</lui-popover-title>\n\t\t\t<lui-popover-title ng-if="!header.invalid" class="desciption" title="{{header.templateDescription}}">{{header.templateDescription}}</lui-popover-title>\n\t\t</div>\n\t</lui-popover-header>\n\n\t<lui-popover-body class="odag-popup-body" qva-outside-ignore-for="odag-request-menu">\n\t\t<odag-app-list2 class="odag-app-list-container" applist="generatedApps" reload-app="reloadApp" load-generated-apps="loadGeneratedApps" set-selection-state="setSelectionState"\n\t\t generate-app-in-progress="generateAppInProgress" expanded-item="expandedItem" is-header-invalid="header.invalid" is-generate-btn-disabled="isGenerateBtnDisabled"\n\t\t can-apply-selections-for-reload="canApplySelectionsForReload" expanded-item-selection-state="expandedItemSelectionState"\n\t\t loading="loadingContent.value" delete-clicked="deleteGenAppClicked" on-apply-selections-callback="onApplySelections" open-app-callback="item.openAppCallback"></odag-app-list2>\n\t\t<div ng-if="maxGeneratedAppLimitReached && !dismissedMaxGenAppMsg && !expandedItem.item" class="odag-max-app-limit-reached">\n\t\t\t<div class="max-app-text" q-translation="odag.toolbar.napvoint.popup.maxAppLimitReached"></div>\n\t\t\t<button class="lui-fade-button close-button" q-title-translation="Common.Close" ng-click="dismissMaxGenAppMsgClicked()">\n\t\t\t\t<span class="lui-button__icon  lui-icon lui-icon--small  lui-icon--close"></span>\n\t\t\t</button>\n\t\t</div>\n\t</lui-popover-body>\n\t<div ng-if="showInfoPopup" class="infoPopup">\n\t\t<div class="info-constraints-header">{{infoHeader}}</div>\n\t\t<div class="info-row-count-container">\n\t\t\t<div class="info-section" q-translation="odag.toolbar.navpoint.popup.info.row.count.header"></div>\n\t\t\t<div class="info-row-count-content">\n\t\t\t\t<div class="info-row-count-progress-circle">\n\t\t\t\t\t<circle-chart model=\'circleModel\'></circle-chart>\n\t\t\t\t</div>\n\t\t\t\t<div class="info-row-count-current">\n\t\t\t\t\t<div class="info-row-count-header" q-translation="odag.toolbar.navpoint.popup.info.row.count.current.header"></div>\n\t\t\t\t\t<div class="">{{actualRowEstFormatted}}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="info-row-count-constraint">\n\t\t\t\t\t<div class="info-row-count-header" q-translation="odag.toolbar.navpoint.popup.info.row.count.constraint.header"></div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t< {{maxRowExpressionCountFormatted}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="info-section" q-translation="odag.toolbar.navpoint.popup.info.field.header"></div>\n\t\t\t<div class="info-field-header">\n\t\t\t\t<div class="info-field" q-translation="odag.toolbar.navpoint.popup.info.field.table.header"></div>\n\t\t\t\t<div class="info-value" q-translation="odag.toolbar.navpoint.popup.info.current.table.header"></div>\n\t\t\t\t<div class="info-constraint" q-translation="odag.toolbar.navpoint.popup.info.constraint.table.header"></div>\n\t\t\t</div>\n\t\t\t<div class="info-field-values">\n\t\t\t\t<div ng-repeat="binding in bindings | orderBy: \'-hasConstraint\' " class="info-field-row" ng-if="bindings.length">\n\t\t\t\t\t<div class="info-field-data">{{binding.fieldName}}</div>\n\t\t\t\t\t\n\t\t\t\t\t<div class="info-value-data">\n\t\t\t\t\t\t<div class="info-field-checkmark" ng-if="binding.bindingPassesConstraint">\n\t\t\t\t\t\t\t<span class="lui-icon  lui-icon--tick" aria-hidden="true"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="info-field-warning" ng-if="!binding.bindingPassesConstraint">\n\t\t\t\t\t\t\t<span class="lui-icon  lui-icon--warning-triangle" aria-hidden="true"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-if="binding.hasConstraint">{{binding.values.length}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<div class="info-constraint-data">{{binding.constraint}}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<lui-popover-footer>\n\t\t<lui-button ng-if="!expandedItem.item" class="info-button" ng-class="{\'lui-button--danger\': bindingsPass, \'lui-active\': showInfoPopup}"\n\t\t x-variant="fade" ng-click="onNavPointInfoClicked($event)">\n\t\t\t<span class="lui-icon  lui-button__icon lui-icon--info"></span>\n\t\t</lui-button>\n\t\t<lui-button ng-if="!expandedItem.item" tid="odag-toolbar-navpoint-popover_generate_app_button" ng-disabled="isGenerateBtnDisabled()"\n\t\t ng-click="onGenerateAppClicked()" q-translation="odag.toolbar.navpoint.popup.generate.app"></lui-button>\n\t</lui-popover-footer>\n</lui-popover>'},975:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(380),n(138),n(460),n(91),n(49)],a=function(t,e,n,i,a,s){t.service("odagNavpointServiceUI",["$timeout",function(t){var o;function r(t,e){e.value=true;for(var n=0;n<t.length;n++){var i="";var s=t[n];if(s.selectedSize>1e4){e.value=false;i=a.get("odag.toolbar.navpoint.popup.request.tab.xNumSelectedValues",s.selectedSize);s.valuesDisplayString=i}else{var o=0;for(;o<s.values.length&&o<5;o++){o>0&&(i+=", ");i+=s.values[o].strValue}5===o&&s.values.length>5&&(i+=a.get("odag.toolbar.navpoint.popup.request.tab.moreSelectedValues",[s.values.length-5+""]));s.valuesDisplayString=i}}return t}function l(t,i){var o=new Date(t.modifiedDate);var l=s.getFlag("ODAG_SAAS_ENABLED");function c(t){var e="";if(Intl&&Intl.DateTimeFormat){var i={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"};e=Intl.DateTimeFormat(n.locale.get(),i).format(t)}else e=n.format.date(t,{datetime:"medium"});return e}var u=c(o);var d=null;if(t.loadState&&t.loadState.finishedAt&&"pending"!==t.loadState.status){var p=new Date(t.loadState.finishedAt);d=c(p)}var h="";var g=false;var f="";var v="lui-icon--bin";var m=a.get("odag.toolbar.navpoint.popup.tooltip.delete");var b=[];var S=[];var y=[];f=t.generatedAppOrigName?t.generatedAppOrigName:"";t.generatedApp&&t.generatedApp.name&&(f=t.generatedApp.name);t.validation&&t.validation.contents&&t.validation.contents.forEach(function(t){b.push({id:b.length,message:t});S.push({id:S.length,message:t})});if(!l&&t.loadState&&t.loadState.messages&&t.loadState.messages.progressData){t.loadState.messages.progressData.persistentProgressMessages&&t.loadState.messages.progressData.persistentProgressMessages.forEach(function(t){S.push({id:S.length,message:e.translateMessage(t)})});t.loadState.messages.progressData.transientProgressMessage&&S.push({id:S.length,message:e.translateMessage(t.loadState.messages.progressData.transientProgressMessage)});t.loadState.messages.progressData.errorData&&t.loadState.messages.progressData.errorData.forEach(function(t){y.push({id:y.length,message:t.qErrorString})})}l&&y.push({id:S.length,message:t.errorMessage});switch(t.state){case"validating":case"queued":case"loading":case"canceling":g=true;h="";f=f||a.get("odag.toolbar.navpoint.popup.status.generating");v="lui-icon--remove";m=a.get("odag.toolbar.navpoint.popup.tooltip.cancel");if("canceling"==t.state){v="";u=a.get("odag.toolbar.navpoint.popup.status.canceling");d=u;m=""}break;case"failed":h="warning";f=f||a.get("odag.toolbar.navpoint.popup.status.failed");v="lui-icon--remove";m=a.get("odag.toolbar.navpoint.popup.tooltip.remove");break;case"canceled":h="";v="lui-icon--remove";m=a.get("odag.toolbar.navpoint.popup.tooltip.remove");break;case"succeeded":h="";f=t.generatedApp?t.generatedApp.name:"";v="lui-icon--bin";m=a.get("odag.toolbar.navpoint.popup.tooltip.delete");break}var I={value:false};t.selectionState&&r(t.selectionState,I);var x={name:f,createdDate:t.createdDate,requestId:t.id,owner:t.owner,lastLoadedTime:d,generatedAppId:t.generatedApp?t.generatedApp.id:null,published:!!t.generatedApp&&t.generatedApp.published,publishToStreamName:t.publishToStreamName?t.publishToStreamName:a.get("odag.toolbar.navpoint.popup.request.tab.info.notPublished"),targetSheet:t.targetSheet,timestamp:u,status:h,state:t.state,loading:g,parentContext:i,deleteIcon:v,deleteIconTooltip:m,actionInProgress:false,statusMessageArray:S,selectionsState:t.selectionState,canApplySelections:I.value,progressErrors:y};return x}function c(e){var n=new Image;var a=e.templateThumbnail;if(a){n.src=a;n.onerror=function(){e.imgSrc=i.staticSrc().staticApp()};n.onload=function(){t(function(){e.imgSrc=a})}}}o={createGeneratedAppWrapper:l,updateImageOnItemHeader:c,getSelectedValuesDisplayString:r};return o}])}.apply(e,i),void 0!==a&&(t.exports=a))},976:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(11),n(91),n(49),n(13),n(316),n(977),n(978),n(979),n(323)],a=function(t,e,n,i,a,s,o,r,l){t.nativeComponent("odagAppList2",{bindings:{applist:"<",loading:"<",deleteClicked:"<",isGenerateBtnDisabled:"<",canApplySelectionsForReload:"<",isHeaderInvalid:"<",loadGeneratedApps:"<",setSelectionState:"<",expandedItemSelectionState:"<",onApplySelectionsCallback:"<",openAppCallback:"<",reloadApp:"<",generateAppInProgress:"=",expandedItem:"=",variant:"@"},controller:["$element","$timeout","luiPopover","odagNavpointService",function(t,l,c,u){var d=this;d.helpTextNoGeneratedApps=n.get("odag.toolbar.navpoint.popup.noApps");d.selectedTab="info";d.moreMenuPopup=null;d.moreMenuPopupItem=null;d.reloadMenuPopup=null;d.inputName="";d.appNameValid=true;d.applyInProgress=false;d.isOdagSaas=i.getFlag("ODAG_SAAS_ENABLED");d.openAppClicked=function(t,n,i){n.preventDefault();n.stopPropagation();if(t.openAppCallback&&e.isFunction(t.openAppCallback))t.openAppCallback(i.generatedAppId,i.targetSheet?i.targetSheet:null);else if(i.generatedAppId&&u.ODAG_TERMINAL_STATES.indexOf(i.state)>-1){var s;s=i.targetSheet?a.rootPath+"sense/app/"+i.generatedAppId+"/sheet/"+i.targetSheet:a.rootPath+"sense/app/"+i.generatedAppId;window.open(s)}};d.renameGenApp=function(t,e){u.renameGenApp(d.expandedItem.item.parentContext.app,t,e).then(function(){d.loadGeneratedApps()})};d.applySelectionsClicked=function(t){d.applyInProgress=true;u.applySelections(t).then(function(){d.onApplySelectionsCallback&&d.onApplySelectionsCallback();d.applyInProgress=false})};d.$doCheck=function(){var t=this;if(this.applist&&this.expandedItem.item){var e=this.applist.filter(function(e){return e.requestId===t.expandedItem.item.requestId})[0];if(e){this.expandedItem.item=e;if(this.expandedItemSelectionState&&this.isOdagSaas){this.expandedItem.item.selectionsState=this.expandedItemSelectionState;this.expandedItem.item.canApplySelections=true}}else this.expandedItem.item=null}d.expandedItem&&d.expandedItem.item&&d.requestInProgress(this.expandedItem.item)&&d.applist.some(function(t){if(t.requestId===d.expandedItem.item.requestId&&t.name===d.expandedItem.item.name&&d.inputName!==t.name){d.inputName=t.name;return true}return false})};d.moreMenuClicked=function(t,e){t.preventDefault();t.stopPropagation();if(d.moreMenuPopup)d.moreMenuPopup.close();else{d.moreMenuPopupItem=e;d.moreMenuPopup=c.show({template:o,alignTo:t.target,variant:null,controller:["$scope",function(t){t.canOpenApp=function(){return e.generatedAppId&&u.ODAG_TERMINAL_STATES.indexOf(e.state)>-1};t.openApp=function(n){if(t.canOpenApp()){d.moreMenuPopup.close();d.openAppClicked(d,n,e)}};t.canReloadApp=function(){return d.canReloadApp(e)};t.reloadApp=function(n){n.preventDefault();n.stopPropagation();if(t.canReloadApp()){d.moreMenuPopup.close();return d.reloadApp(e)}};t.deleteApp=function(t){t.preventDefault();t.stopPropagation();d.moreMenuPopup.close();d.deleteClicked(t,e)}}],closeOnResize:true,closeOnEscape:true});d.moreMenuPopup.closed.then(function(){d.moreMenuPopup=null;d.moreMenuPopupItem=null})}};d.onOutsideClick=function(){d.expandedItem.item=null};d.rowClicked=function(t){d.moreMenuPopup&&d.moreMenuPopup.close();d.reloadMenuPopup&&d.reloadMenuPopup.close();d.expandedItem.item=t;if(d.expandedItem.item){d.inputName=d.expandedItem.item.name;d.setSelectionState()}};d.reloadClicked=function(t,e){t.preventDefault();t.stopPropagation();d.reloadApp(e)};d.requestInProgress=function(t){var e=false;switch(t.state){case u.ODAG_STATE.VALIDATING:case u.ODAG_STATE.QUEUED:case u.ODAG_STATE.LOADING:case u.ODAG_STATE.CANCELING:e=true;break}return e};d.canReloadApp=function(t){var e=true;e=t&&!d.isHeaderInvalid&&!d.generateAppInProgress&&!d.requestInProgress(t);return e};d.validateAppName=function(){var t=true;d.inputName&&s.allowedChars(d.inputName)||(t=false);d.appNameValid=t};d.statusClicked=function(t,e){t.preventDefault();t.stopPropagation();d.moreMenuPopup&&d.moreMenuPopup.close();d.reloadMenuPopup&&d.reloadMenuPopup.close();if(d.expandedItem.item===e)d.expandedItem.item=null;else{d.selectedTab="status";d.expandedItem.item=e;d.scrollIfNecessary()}};d.selectTab=function(t){d.selectedTab=t;d.scrollIfNecessary()};d.inputKeyEnter=function(t){var e=t.target;e.blur()};d.onBlurGenAppName=function(){if(d.appNameValid)d.renameGenApp(d.expandedItem.item.requestId,d.inputName);else{d.inputName=d.expandedItem.item.name;d.validateAppName()}};d.scrollIfNecessary=function(){"status"===d.selectedTab&&l(function(){var n=e(t.find(".tab-contents"));n.scrollTop(n[0].scrollHeight)})};d.onReloadMenuClicked=function(t,e){t.preventDefault();t.stopPropagation();if(d.reloadMenuPopup)d.reloadMenuPopup.close();else{d.reloadMenuPopup=c.show({template:r,alignTo:t.target,variant:null,controller:["$scope",function(t){t.canReloadApp=function(){return d.canReloadApp(e)};t.reloadApp=function(n){n.preventDefault();n.stopPropagation();if(t.canReloadApp()){d.reloadMenuPopup.close();return d.reloadApp(e)}};t.canApplySelectionsReloadApp=function(){return d.canApplySelectionsForReload()};t.canCopyApplySelectionsReloadApp=function(){return!d.isGenerateBtnDisabled()};t.applySelectionsReloadApp=function(n){n.preventDefault();n.stopPropagation();if(t.canApplySelectionsReloadApp()){d.reloadMenuPopup.close();d.reloadApp(e,1)}};t.copyApplySelectionsReloadApp=function(n){n.preventDefault();n.stopPropagation();if(t.canApplySelectionsReloadApp()){d.reloadMenuPopup.close();d.reloadApp(e,2)}}}],closeOnResize:true,closeOnEscape:true});d.reloadMenuPopup.closed.then(function(){d.reloadMenuPopup=null})}}}],template:l})}.apply(e,i),void 0!==a&&(t.exports=a))},977:function(t,e){t.exports='<lui-popover x-variant="{{::variant}}" x-arrow="arrow" qva-outside-ignore-for="allOutside">\n\t<lui-popover-body class="lui-nopad">\n\t\t<ul class="lui-list odag-request-menu" tid="odag-request-menu">\n\t\t\t<li class="lui-list__item" style="cursor: pointer" ng-disabled="!canOpenApp()" ng-click="openApp( $event )" tid="openAppFromMenu">\n\t\t\t\t<span class="lui-list__text lui-list__action"\n\t\t\t\t\tq-translation="odag.toolbar.navpoint.popup.request.menu.openApp">\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item" style="cursor: pointer" ng-disabled="!canReloadApp()" ng-click="reloadApp( $event )" tid="reloadFromRequestMenu">\n\t\t\t\t<span class="lui-list__text lui-list__action"\n\t\t\t\t\tq-translation="odag.toolbar.navpoint.popup.request.reload">\n\t\t\t\t</span>\n\t\t\t</li>\t\t\t\n\t\t\t<li class="lui-list__item" style="cursor: pointer" ng-click="deleteApp( $event )" tid="deleteAppFromMenu">\n\t\t\t\t<span class="lui-list__text lui-list__action"\n\t\t\t\t\tq-translation="odag.toolbar.navpoint.popup.request.menu.deleteApp">\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t</ul>\n\t</lui-popover-body>\n</lui-popover>'},978:function(t,e){t.exports='<lui-popover x-variant="{{::variant}}" x-arrow="arrow" qva-outside-ignore-for="allOutside">\n\t<lui-popover-body class="lui-nopad">\n\t\t<ul class="lui-list odag-request-menu" tid="odag-request-reload-menu">\n\t\t\t<li class="lui-list__item" style="cursor: pointer" ng-disabled="!canReloadApp()" ng-click="reloadApp( $event )" tid="reloadFromMenu">\n\t\t\t\t<span class="lui-list__text lui-list__action"\n\t\t\t\t\tq-translation="odag.toolbar.navpoint.popup.request.reload">\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item" style="cursor: pointer" ng-disabled="!canApplySelectionsReloadApp()" ng-click="applySelectionsReloadApp( $event )" tid="applySelectionsReloadFromMenu">\n\t\t\t\t<span class="lui-list__text lui-list__action"\n\t\t\t\t\tq-translation="odag.toolbar.navpoint.popup.request.applySelections.reload">\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item" style="cursor: pointer" ng-disabled="!canCopyApplySelectionsReloadApp()" ng-click="copyApplySelectionsReloadApp( $event )" tid="copyApplySelectionsReloadFromMenu">\n\t\t\t\t<span class="lui-list__text lui-list__action"\n\t\t\t\t\tq-translation="odag.toolbar.navpoint.popup.request.copyAndApplySelections.reload">\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t</ul>\n\t</lui-popover-body>\n</lui-popover>'},979:function(t,e){t.exports='<div class="odag-app-list2" ng-class="$ctrl.variant">\n\t<div ng-if="$ctrl.applist.length === 0 && !$ctrl.loading" class="description">{{$ctrl.helpTextNoGeneratedApps}}</div>\n\t<ul ng-if="$ctrl.applist.length && !$ctrl.loading && !$ctrl.expandedItem.item" class="generated-apps-list">\n\t\t<li ng-repeat="genAppitem in $ctrl.applist" class="list-item" ng-click="$ctrl.rowClicked(genAppitem)">\n\t\t\t<div class="generated-app-item request-header">\n\t\t\t\t<div class="request-first">\n\t\t\t\t\t<div class="expander lui-icon lui-icon--triangle-right"></div>\n\t\t\t\t\t<div class="request-name-timestamp-area">\n\t\t\t\t\t\t<div class="request-first-top-line">\t\t\t\t\t\t\n\t\t\t\t\t\t\t<div class="name" title="{{genAppitem.name}}" ng-class="{\'generating\': genAppitem.state === \'validating\' || genAppitem.state === \'queued\' || genAppitem.state === \'loading\' || genAppitem.state === \'canceling\'}">{{genAppitem.name}}</div>\n\t\t\t\t\t\t</div>\t\n\t\t\t\t\t\t<div class="request-first-bottom-line timestamp">{{genAppitem.lastLoadedTime ? genAppitem.lastLoadedTime : genAppitem.timestamp }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="request-second">\n\t\t\t\t\t<button class="status-button lui-fade-button" qva-outside-ignore-for="allOutside" ng-click="$ctrl.statusClicked($event, genAppitem)">\n\t\t\t\t\t\t<span ng-hide="genAppitem.loading" class="lui-fade-button__icon lui-icon lui-icon--{{genAppitem.status}}"></span>\n\t\t\t\t\t\t<div ng-if="genAppitem.loading" class="genAppLoading qv-loader"></div>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button ng-if="genAppitem.state === \'validating\' || genAppitem.state === \'queued\' || genAppitem.state === \'loading\'" class="lui-fade-button" title={{genAppitem.deleteIconTooltip}} ng-click="$ctrl.deleteClicked($event, genAppitem)">\n\t\t\t\t\t  <span class="lui-fade-button__icon  lui-icon lui-icon--remove"></span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button ng-if="!$ctrl.requestInProgress( genAppitem )" class="lui-fade-button" q-title-translation="odag.toolbar.navpoint.popup.request.moreMenu.tooltip" ng-click="$ctrl.moreMenuClicked($event, genAppitem)" ng-class="{\'lui-active\': $ctrl.moreMenuPopupItem === genAppitem}">\n\t\t\t\t\t  <span class="lui-fade-button__icon  lui-icon lui-icon--more"></span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button ng-if="!$ctrl.requestInProgress( genAppitem )" ng-disabled="!(genAppitem.state === \'succeeded\' || genAppitem.state === \'failed\' || genAppitem.state === \'canceled\') || !genAppitem.generatedAppId" class="lui-fade-button" q-title-translation="{{ $ctrl.openAppCallback ? \'odag.toolbar.navpoint.popup.request.openApp.generic.tooltip\' : \'odag.toolbar.navpoint.popup.request.openApp.tooltip\'}}" ng-click="$ctrl.openAppClicked($ctrl, $event, genAppitem)">\n\t\t\t\t\t  <span class="lui-fade-button__icon  lui-icon lui-icon--new-tab"></span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\t\t\t\n\t\t</li>\n\t</ul>\n\t<div ng-if="$ctrl.expandedItem.item" class="gen-item-expand" qva-outside="$ctrl.onOutsideClick( $event )">\n\t\t<div class="details-container">\n\t\t\t<div class="request-header" ng-click="$ctrl.rowClicked(null)">\n\t\t\t\t<div class="request-first">\n\t\t\t\t\t<div class="expander lui-icon lui-icon--triangle-bottom" tid="odag-applist-expand"></div>\n\t\t\t\t\t<div class="request-name-timestamp-area">\n\t\t\t\t\t\t<div class="request-first-top-line">\n\t\t\t\t\t\t\t<div class="name" title="{{$ctrl.expandedItem.item.name}}" ng-class="{\'generating\': $ctrl.expandedItem.item.state === \'validating\' || $ctrl.expandedItem.item.state === \'queued\' || $ctrl.expandedItem.item.state === \'loading\' || $ctrl.expandedItem.item.state === \'canceling\'}">{{$ctrl.expandedItem.item.name}}</div>\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="request-first-bottom-line timestamp" >{{$ctrl.expandedItem.item.lastLoadedTime ? $ctrl.expandedItem.item.lastLoadedTime : $ctrl.expandedItem.item.timestamp }}</div>\n\t\t\t\t\t</div>\t\t\t\t\n\t\t\t\t</div>\n\t\t\t\t<div class="request-second">\n\t\t\t\t\t<button class="status-button lui-fade-button" qva-outside-ignore-for="allOutside" ng-click="$ctrl.statusClicked($event, $ctrl.expandedItem.item)">\n\t\t\t\t\t\t<span ng-if="!$ctrl.expandedItem.item.loading" class="lui-fade-button__icon lui-icon lui-icon--{{$ctrl.expandedItem.item.status}}"></span>\n\t\t\t\t\t\t<div ng-if="$ctrl.expandedItem.item.loading" class="genAppLoading qv-loader"></div>\n\t\t\t\t\t</button>\t\t\t\t\t\t\t\t\n\t\t\t\t\t<button ng-if="$ctrl.expandedItem.item.state === \'validating\' || $ctrl.expandedItem.item.state === \'queued\' || $ctrl.expandedItem.item.state === \'loading\'" class="lui-fade-button" title={{$ctrl.expandedItem.item.deleteIconTooltip}} ng-click="$ctrl.deleteClicked($event, $ctrl.expandedItem.item)">\n\t\t\t\t\t  <span class="lui-fade-button__icon  lui-icon lui-icon--remove"></span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button ng-if="$ctrl.expandedItem.item.state === \'succeeded\' || $ctrl.expandedItem.item.state === \'failed\' || $ctrl.expandedItem.item.state === \'canceled\'" class="lui-fade-button" q-title-translation="{{ $ctrl.openAppCallback ? \'odag.toolbar.navpoint.popup.request.openApp.generic.tooltip\' : \'odag.toolbar.navpoint.popup.request.openApp.tooltip\'}}" ng-disabled="!($ctrl.expandedItem.item.state === \'succeeded\' || $ctrl.expandedItem.item.state === \'failed\' || $ctrl.expandedItem.item.state === \'canceled\') || !$ctrl.expandedItem.item.generatedAppId" ng-click="$ctrl.openAppClicked($ctrl, $event, $ctrl.expandedItem.item)">\n\t\t\t\t\t  <span class="lui-fade-button__icon  lui-icon lui-icon--new-tab"></span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\t\n\t\t\t</div>\n\t\t\t<div class="generateAppInput">\n\t\t\t\t<input class="lui-input" ng-disabled="$ctrl.generateAppInProgress || !$ctrl.expandedItem.item.generatedAppId || $ctrl.expandedItem.item.state === \'queued\' || $ctrl.expandedItem.item.state === \'loading\' || $ctrl.expandedItem.item.state === \'validating\' || $ctrl.expandedItem.item.state === \'canceling\'" ng-model="$ctrl.inputName" type="text" name="name" maxlength="255" ng-blur="$ctrl.onBlurGenAppName()" ng-change="$ctrl.validateAppName()" qv-enter="$ctrl.inputKeyEnter($event)" ng-class="{ \'lui-invalid\': !$ctrl.appNameValid }"/>\n\t\t\t</div>\n\t\t\t<div class="action-button-section">\n\t\t\t\t<div class="lui-buttongroup reload-button">\n\t\t\t\t\t<lui-button ng-disabled="!$ctrl.canReloadApp( $ctrl.expandedItem.item )" ng-click="$ctrl.reloadClicked($event, $ctrl.expandedItem.item)" q-translation="odag.toolbar.navpoint.popup.request.reload"></lui-button>\n\t\t\t\t\t<lui-button ng-disabled="!$ctrl.canReloadApp( $ctrl.expandedItem.item ) " class= "reload-drop" tid="odag-reload-dropdown"\n ng-click="$ctrl.onReloadMenuClicked( $event, $ctrl.expandedItem.item )">\n\t\t\t\t\t\t<span class="lui-icon lui-caret"></span>\t\t\t\t\t\t\n\t\t\t\t\t</lui-button>\n\t\t\t\t</div>\n\t\t\t\t<lui-button ng-disabled="$ctrl.expandedItem.item.state !== \'succeeded\' && $ctrl.expandedItem.item.state !== \'failed\' && $ctrl.expandedItem.item.state !== \'canceled\' " tid="odag-applist-delete-app" class="delete-button" ng-click="$ctrl.deleteClicked($event, $ctrl.expandedItem.item)" ><span class="lui-icon  lui-button__icon lui-icon--bin"></span></lui-button>\n\t\t\t</div>\n\n\t\t\t<div class="tab-section">\n\t\t\t\t<div class="tab-header">\n\t\t\t\t\t<ul class="lui-tabset lui-tabset--fill">\n\t\t\t\t\t\t<li class="lui-tab" tabindex="0" ng-class="{\'lui-active\': $ctrl.selectedTab === \'info\' }" ng-click="$ctrl.selectTab(\'info\')">\n\t\t\t\t\t\t\t<span class="lui-tab__text tab-label" q-translation="odag.toolbar.navpoint.popup.request.tab.info"></span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class="lui-tab" tabindex="0" ng-class="{\'lui-active\': $ctrl.selectedTab === \'selections\' }" ng-click="$ctrl.selectTab(\'selections\')">\n\t\t\t\t\t\t\t<span class="lui-tab__text tab-label" q-translation="odag.toolbar.navpoint.popup.request.tab.selections"></span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class="lui-tab" tabindex="0" ng-class="{\'lui-active\': $ctrl.selectedTab === \'status\' }" ng-click="$ctrl.selectTab(\'status\')">\n\t\t\t\t\t\t\t<span class="lui-tab__text tab-label" q-translation="odag.toolbar.navpoint.popup.request.tab.status"></span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t\t<div class="tab-contents">\n\t\t\t\t\t<div class="tab-content selection-tab" ng-if="$ctrl.selectedTab === \'selections\'">\n\t\t\t\t\t\t<div class="info-section selection-tab-top">\n\t\t\t\t\t\t\t<div class="info-text" q-translation="odag.toolbar.navpoint.popup.request.tab.selections.helpText"></div>\n\t\t\t\t\t\t\t<div class="apply-selections-button">\n\t\t\t\t\t\t\t\t<lui-button ng-disabled="($ctrl.expandedItem.item.state !== \'succeeded\' && $ctrl.expandedItem.item.state !== \'failed\' && $ctrl.expandedItem.item.state !== \'canceled\') || $ctrl.applyInProgress" ng-if="$ctrl.expandedItem.item.canApplySelections" ng-click="$ctrl.applySelectionsClicked($ctrl.expandedItem.item)" q-translation="Common.Apply"></lui-button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="selections-field-header">\n\t\t\t\t\t\t\t<div class="selections-field" q-translation="odag.toolbar.navpoint.popup.request.tab.selections.field"></div>\n\t\t\t\t\t\t\t<div class="selections-value" q-translation="odag.toolbar.navpoint.popup.request.tab.selections.values"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="selections-field-values">\n\t\t\t\t\t\t\t<div ng-if="$ctrl.expandedItem.item.selectionsState && $ctrl.expandedItem.item.selectionsState.length" ng-repeat="selection in $ctrl.expandedItem.item.selectionsState" class="selections-field-row">\n\t\t\t\t\t\t\t\t<div class="selections-field-data">{{selection.selectionAppParamName}}</div>\n\t\t\t\t\t\t\t\t<div class="selections-value-data">{{selection.valuesDisplayString}}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div ng-if="!$ctrl.expandedItem.item.selectionsState" q-translation="odag.toolbar.navpoint.popup.request.tab.noSelectedValues"> </div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="selections-no-selections" ng-if="$ctrl.expandedItem.item.selectionsState && $ctrl.expandedItem.item.selectionsState.length === 0" q-translation="odag.toolbar.navpoint.popup.request.tab.selections.noselections" >\n\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="tab-content" ng-if="$ctrl.selectedTab === \'info\'">\n\t\t\t\t\t\t<div class="info-section">\n\t\t\t\t\t\t\t<div class="info-section-label" q-translation="odag.toolbar.navpoint.popup.request.tab.info.status"></div>\n\t\t\t\t\t\t\t<div class="info-section-value" q-translation="odag.toolbar.navpoint.popup.request.tab.status.{{$ctrl.expandedItem.item.state}}"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="info-section">\n\t\t\t\t\t\t\t<div class="info-section-label" q-translation="odag.toolbar.navpoint.popup.request.tab.info.appOwner"></div>\n\t\t\t\t\t\t\t<div ng-if="!$ctrl.isOdagSaas" class="info-section-value">{{$ctrl.expandedItem.item.owner.userDirectory}}\\{{$ctrl.expandedItem.item.owner.userId}} ({{$ctrl.expandedItem.item.owner.name}})</div>\n\t\t\t\t\t\t\t<div ng-if="$ctrl.isOdagSaas" class="info-section-value">({{$ctrl.expandedItem.item.owner.name}})</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="info-section" ng-if="!$ctrl.isOdagSaas">\n\t\t\t\t\t\t\t<div class="info-section-label" q-translation="odag.toolbar.navpoint.popup.request.tab.info.publishToStream"></div>\n\t\t\t\t\t\t\t<div class="info-section-value"> {{$ctrl.expandedItem.item.publishToStreamName}} </div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="tab-content odag-request-status-content" ng-if="$ctrl.selectedTab === \'status\'">\n\t\t\t\t\t\t<div class="info-section">\n\t\t\t\t\t\t\t<div class="info-section-label" q-translation="odag.toolbar.navpoint.popup.request.tab.info.lastCompletedRun"></div>\n\t\t\t\t\t\t\t<div class="info-section-value">{{$ctrl.expandedItem.item.lastLoadedTime ? $ctrl.expandedItem.item.lastLoadedTime : \'Common.None\' | translate }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-repeat="message in $ctrl.expandedItem.item.statusMessageArray" class="info-field-row" ng-if="$ctrl.expandedItem.item.statusMessageArray.length" ng-bind="message.message"></div>\n\t\t\t\t\t\t<div ng-repeat="error in $ctrl.expandedItem.item.progressErrors" class="info-field-row info-field-row-error" ng-if="$ctrl.expandedItem.item.progressErrors.length" ng-bind="error.message"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'},980:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(981)],a=function(t,e){t.directive("qvProgressCircle",function(){return{scope:{percentage:"="},restrict:"E",template:e,link:function t(e,n){function i(){var t=e.percentage;var i=n.find(".progress-circle-svg .bar");var a=i.attr("r");var s=Math.PI*(2*a);if(Number.isNaN(+t)){t=100;i.css({strokeDashoffset:s,fill:"#CCCCCC"})}else{t<0&&(t=0);t>100&&(t=100);var o=(100-t)/100*s;i.css({strokeDashoffset:o});100===e.percentage?i.css({fill:"#61a729"}):i.css({fill:"transparent"})}}e.$watch("percentage",i)},controller:["$scope",function(t){t.$on("$destroy",function(){})}]}})}.apply(e,i),void 0!==a&&(t.exports=a))},981:function(t,e){t.exports='<div class="progress-circle-container" ng-class="{\'full\': percentage === 100}">\n\t<svg class="progress-circle-svg" viewPort="0 0 0 0">\n\t\t<circle class="baseCircle" r="6" cx="8px" cy="8px" fill="transparent" stroke-dasharray="37.699" stroke-dashoffset="0"></circle>\n\t\t<circle class="whiteBar" r="6" cx="8px" cy="8px" fill="transparent" stroke-dasharray="37.699" stroke-dashoffset="0"></circle>\n\t\t<circle class="bar" r="6" cx="8px" cy="8px" fill="transparent" stroke-dasharray="37.699" stroke-dashoffset="0"></circle>\n\t</svg>\n</div>\n'}}]);