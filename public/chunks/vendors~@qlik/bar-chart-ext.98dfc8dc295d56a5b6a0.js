/*!
 * sense-client@6.105.4
 * 
 * Copyright(C) 2019 Qlik International AB
 * All Rights Reserved
 * 
 */
(window["qJsonp"]=window["qJsonp"]||[]).push([[72],{1164:function(e,t,n){!function(t,r){var i,o;true;e.exports=r(n(98),n(171),n(412),n(189),n(1124),n(1125),n(91),n(48),n(1301),n(448))}(window,function(e,t,n,r,i,o,a,u,s,l){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=26)}([function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=Object.prototype.hasOwnProperty,o=Object.prototype.toString,a=Object.defineProperty,u=Object.getOwnPropertyDescriptor,s=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===o.call(e)},l=function(e){if(!e||"[object Object]"!==o.call(e))return!1;var t,n=i.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&i.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!r)return!1;for(t in e);return void 0===t||i.call(e,t)},c=function(e,t){a&&"__proto__"===t.name?a(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},f=function(e,t){if("__proto__"===t){if(!i.call(e,t))return;if(u)return u(e,t).value}return e[t]};e.exports=function e(){var t,n,i,o,a,u,d=arguments[0],m=1,h=arguments.length,p=!1;for("boolean"==typeof d&&(p=d,d=arguments[1]||{},m=2),(null==d||"object"!==r(d)&&"function"!=typeof d)&&(d={});m<h;++m)if(null!=(t=arguments[m]))for(n in t)i=f(d,n),d!==(o=f(t,n))&&(p&&o&&(l(o)||(a=s(o)))?(a?(a=!1,u=i&&s(i)?i:[]):u=i&&l(i)?i:{},c(d,{name:n,newValue:e(p,u,o)})):void 0!==o&&c(d,{name:n,newValue:o}));return d}},function(e,t,n){e.exports=n(29)()},function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t){e.exports=i},function(e,t){e.exports=o},function(e,t){e.exports=a},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r={};function i(){i.init.call(this)}r.isObject=function(e){return"object"===n(e)&&null!==e},r.isNumber=function(e){return"number"==typeof e},r.isUndefined=function(e){return void 0===e},r.isFunction=function(e){return"function"==typeof e},e.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.init=function(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if(!r.isNumber(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,n,i,o,a,u;if(this._events||(this._events={}),"error"===e&&!this._events.error)throw(t=arguments[1])instanceof Error?t:Error('Uncaught, unspecified "error" event.');if(n=this._events[e],r.isUndefined(n))return!1;if(r.isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,o=new Array(i-1),a=1;a<i;a++)o[a-1]=arguments[a];n.apply(this,o)}else if(r.isObject(n)){for(i=arguments.length,o=new Array(i-1),a=1;a<i;a++)o[a-1]=arguments[a];for(i=(u=n.slice()).length,a=0;a<i;a++)u[a].apply(this,o)}return!0},i.prototype.addListener=function(e,t){var n;if(!r.isFunction(t))throw TypeError("listener must be a function");(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r.isFunction(t.listener)?t.listener:t),this._events[e]?r.isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,r.isObject(this._events[e])&&!this._events[e].warned)&&(n=r.isUndefined(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,r.isFunction(console.error)&&console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),r.isFunction(console.trace)&&console.trace());return this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){if(!r.isFunction(t))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},i.prototype.removeListener=function(e,t){var n,i,o,a;if(!r.isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(o=(n=this._events[e]).length,i=-1,n===t||r.isFunction(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(r.isObject(n)){for(a=o;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){i=a;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r.isFunction(n))this.removeListener(e,n);else if(Array.isArray(n))for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){return this._events&&this._events[e]?r.isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.listenerCount=function(e,t){return e._events&&e._events[t]?r.isFunction(e._events[t])?1:e._events[t].length:0}},,,function(e,t){e.exports=u},,,,function(e,t){e.exports=s},,,,,,,,,,function(e,t,n){n(27),e.exports=n(31)},function(e,t){Math.sign||(Math.sign=function(e){return(e>0)-(e<0)||+e}),Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),n=t.length,r=new Array(n);n--;)r[n]=[t[n],e[t[n]]];return r}),Number.isNaN||(Number.isNaN=function(e){return e!=e}),void 0===Number.isFinite&&(Number.isFinite=function(e){return"number"==typeof e&&isFinite(e)})},function(e,t){e.exports=l},function(e,t,n){"use strict";var r=n(30);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,o,a){if(a!==r){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"tap",function(){return fc}),n.d(r,"pan",function(){return mc}),n.d(r,"native",function(){return hc}),n.d(r,"resize",function(){return gc});var i={};function o(e){var t=e.qDef;!0===t.autoSort&&t.qSortCriterias.forEach(function(e){e.qSortByNumeric=1,e.qSortByAscii=1})}n.r(i),n.d(i,"TYPES",function(){return xc}),n.d(i,"isMaxOutOfBounds",function(){return wc}),n.d(i,"isMinOutOfBounds",function(){return qc}),n.d(i,"isOutOfBounds",function(){return Sc}),n.d(i,"hasHat",function(){return kc});var a={MINI_CHART:{value:"miniChart",translation:"properties.scrollbar.miniChart"},BAR:{value:"bar",translation:"properties.scrollbar.bar"},NONE:{value:"none",translation:"properties.scrollbar.none"}},u={OPTIONS:a,DEFAULT:a.MINI_CHART};var s=n(9),l=n.n(s);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var d=function(e){var t=function(e){return Object.keys(l.a.prototype).forEach(function(t){e[t]=l.a.prototype[t]}),l.a.init(e),e};if(!e.backendApi.model.resetMadeSelections)return t({begin:function(){},clear:function(){},confirm:function(){},cancel:function(){},select:function(){},isActive:function(){}});var n={begin:function(){e.selectionsApi.activated(),e.backendApi.beginSelections(),n.emit("activated")},clear:function(){e.backendApi.model.resetMadeSelections()},confirm:function(){e.selectionsApi.confirm()},cancel:function(){e.selectionsApi.cancel()},select:function(t){var n,r=this;"resetMadeSelections"===t.method||e.selectionsApi.selectionsMade||e.backendApi.beginSelections(),(n=e.backendApi.model)[t.method].apply(n,f(t.params)).then(function(t){t||(e.selectionsApi.selectionsMade=!1,r.clear())}),e.selectionsApi.selectionsMade="resetMadeSelections"!==t.method},isLocked:function(t){var n=[],r=t.filter(function(e){return"object"===c(e.data)&&Array.isArray(e.data.fields)}).every(function(e){return e.data.fields.every(function(e){return!!e.raw().qLocked&&(n.push(e.raw()),!0)})});return r&&e.selectionsApi.notifyLockedSelections(n),r},isActive:function(){return e.selectionsApi.active},refreshToolbar:function(){e.selectionsApi.refreshToolbar()}};return t(n),e.selectionsApi.confirm=function(){e.backendApi.endSelections(!0).then(function(){e.selectionsApi.deactivated(),n.emit("deactivated")})},e.selectionsApi.clear=function(){e.backendApi.clearSelections(),e.selectionsApi.selectionsMade=!1,n.emit("cleared")},e.selectionsApi.cancel=function(){e.backendApi.endSelections(!1),e.selectionsApi.deactivated(),n.emit("canceled")},n},m={STATIC:0,ANALYSIS:1,EDIT:2};var h=function(e,t){var n=[];return function(e){return!!e.tooltips||e.interactionState===m.ANALYSIS&&!1!==e.tooltips}(e)&&n.push("passive"),e.interactionState===m.ANALYSIS&&!1!==e.tooltips&&!0!==e.limitedInteraction&&n.push("interact"),t.isSnapshot||(!1!==e.selections&&n.push("select"),n.push("fetch")),n},p=(n(28),n(0)),g=n.n(p);function y(e,t){var n,r,i,o=0;return function(){n=this;for(var a=arguments.length,u=new Array(a),s=0;s<a;s++)u[s]=arguments[s];r=u;var l=Date.now()-o,c=function(){o=Date.now(),i=0,e.apply(n,r)};i||(l>=t?c():i=setTimeout(c,t-l))}}var v=/^[A-Z][A-z0-9_]*$/i,b={setValue:function(e,t,n){if(!t)return!1;var r,i=t.split("."),o=i[i.length-1],a=e;for(r=0;r<i.length-1;++r)void 0===a[i[r]]&&(a[i[r]]=Number.isNaN(+i[r+1])?{}:[]),a=a[i[r]];if(void 0!==n){var u=a[o];return a[o]=n,{updated:n,previous:u}}return delete a[o],!1},getValue:function(e,t,n){var r,i=t.split("."),o=e;if(void 0===o)return n;for(r=0;r<i.length;++r){if(void 0===o[i[r]])return n;o=o[i[r]]}return o},moveArrayElement:function(e,t,n){if(n>=e.length)for(var r=n-e.length;1+r--;)e.push(void 0);e.splice(n,0,e.splice(t,1)[0])},escapeField:function(e){return!e||"]"===e||v.test(e)?e:"[".concat(e.replace(/\]/g,"]]"),"]")},deleteUndefinedProperties:function(e){Object.keys(e).forEach(function(t){void 0===e[t]&&delete e[t]})}},M="REJECTED",x=function(){},w={MULTIPLIER:2,MINIMUM:20,MAXIMUM:200,ROOF:1e4},q=600,S=50,k=10,D=100;var O={cache:function(){var e={page:{}};return{get:function(){return e.page},set:function(t){e.page=t||{}},empty:function(){e.page={}},isEmpty:function(){return!Object.keys(e.page).length},contains:function(t){var n=e.page.qArea;return!!n&&n.qLeft<=t.qLeft&&n.qLeft+n.qWidth>=t.qLeft+t.qWidth&&n.qTop<=t.qTop&&n.qTop+n.qHeight>=t.qTop+t.qHeight}}},patcher:function(e){var t=e.layoutModel,n=function(e){e.qArea.qHeight=e.qMatrix.length,e.qArea.qWidth=t.meta.size.x};return n.should=function(e){return 0===e.qArea.qHeight&&0===e.qArea.qWidth&&!!e.qMatrix.length},n},slicer:function(e,t){for(var n=Math.max(0,t.qHeight)-Math.abs(Math.min(0,t.qTop-e.qArea.qTop)),r=Math.max(0,t.qWidth)-Math.abs(Math.min(0,t.qLeft-e.qArea.qLeft)),i=Math.max(t.qTop,e.qArea.qTop),o=Math.max(t.qLeft,e.qArea.qLeft),a=Math.max(0,i-e.qArea.qTop),u=Math.min(i+n-e.qArea.qTop,e.qArea.qHeight),s=Math.max(0,o-e.qArea.qLeft),l=Math.min(o+r-e.qArea.qLeft,e.qArea.qWidth),c={qArea:{qHeight:u-a,qWidth:l-s,qTop:i,qLeft:o},qMatrix:[]},f=a;f<u;f++)c.qMatrix.push(e.qMatrix[f].slice(s,l));return c},cacheWarden:function(e){var t=e.bounds,n=void 0===t?{width:0,height:0}:t;return{release:function(e,t){var r=t.qTop-k<=e.qTop,i=t.qLeft+t.qWidth+k>=e.qLeft+e.qWidth,o=t.qTop+t.qHeight+k>=e.qTop+e.qHeight,a=t.qLeft-k<=e.qLeft;return r&&e.qTop>0||i&&e.qLeft+e.qWidth<n.width||o&&e.qTop+e.qHeight<n.height||a&&e.qLeft>0}}},request:function(){return function(e){return{method:"getHyperCubeData",args:["/qHyperCubeDef",[e]]}}}};var A={cache:function(){var e={page:{}};return{get:function(){return e.page},set:function(t){e.page=t||{}},empty:function(){e.page={}},isEmpty:function(){return!Object.keys(e.page).length},contains:function(t){var n=e.page.qArea;return!!n&&n.qTop<=t.qTop&&n.qTop+n.qHeight>=t.qTop+t.qHeight}}},patcher:function(e){var t=e.layoutModel,n=function(e){e.qArea.qHeight=e.qData[0].qSubNodes.length,e.qArea.qWidth=t.meta.size.x};return n.should=function(e){return 0===e.qArea.qHeight&&0===e.qArea.qWidth&&!!e.qData.length},n},slicer:function(e,t){for(var n=Math.max(0,t.qHeight)-Math.abs(Math.min(0,t.qTop-e.qArea.qTop)),r=Math.max(t.qTop,e.qArea.qTop),i=Math.max(t.qLeft,e.qArea.qLeft),o=Math.max(0,r-e.qArea.qTop),a=Math.min(r+n-e.qArea.qTop,e.qArea.qHeight),u=e.qData[0].qUp+e.qArea.qHeight+e.qData[0].qDown-r-(a-o),s={qArea:{qHeight:a-o,qWidth:e.qArea.qWidth,qTop:r,qLeft:i},qData:[Object.assign({},e.qData[0],{qUp:r,qDown:u,qSubNodes:[]})]},l=o;l<a;l++)s.qData[0].qSubNodes.push(e.qData[0].qSubNodes[l]);return s},cacheWarden:function(e){var t=e.bounds,n=void 0===t?{height:0}:t;return{release:function(e,t){var r=t.qTop-k<=e.qTop,i=t.qTop+t.qHeight+k>=e.qTop+e.qHeight;return r&&e.qTop>0||i&&e.qTop+e.qHeight<n.height}}},request:function(e){var t=e.layoutModel.getLayoutValue("dimensionAxis.axisDisplayMode","auto");return function(e){var n={method:"getHyperCubeStackData",args:["/qHyperCubeDef",[e]]};return"auto"===t&&n.args.push(q),n}}};var C={cache:function(){var e={page:{}};return{get:function(){return e.page},set:function(t){e.page=t||{}},empty:function(){e.page={}},isEmpty:function(){return!Object.keys(e.page).length},contains:function(){return!1}}},patcher:function(){var e=function(e){return e};return e.should=function(){return!1},e},slicer:function(e){return e},cacheWarden:function(){return{release:function(){return!0}}},request:function(){return function(e){return{method:"getHyperCubeTreeData",args:["/qHyperCubeDef",[e]]}}}};function T(e){var t=e.layoutModel,n=function(e){var t=e.layoutModel,n=Math.floor(w.ROOF/(t.meta.dimensionCount+t.meta.measureCount));return function(e){var t=e.width,r=e.height,i=Math.min(n,Math.max(w.MAXIMUM,r));return{width:t,height:Math.max(w.MINIMUM,Math.min(r*w.MULTIPLIER,i))}}}({layoutModel:t}),r={width:t.meta.size.x,height:t.meta.size.y};return function(e){var t=n({width:e.qWidth,height:e.qHeight}),i=t.width,o=t.height,a=o?Math.ceil((o-e.qHeight)/2):0,u=i?Math.ceil((i-e.qWidth)/2):0;return{qHeight:o?Math.min(o,r.height):e.qHeight,qWidth:i?Math.min(i,r.width):e.qWidth,qTop:o?Math.max(0,Math.min(e.qTop-a,r.height-o)):e.qTop,qLeft:i?Math.max(0,Math.min(e.qLeft-u,r.width-i)):e.qLeft}}}function P(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function N(e,t){var n,r,i=function(i){return new t(function(t,o){var a={request:i,resolve:t,reject:o,canceled:!1,cancel:function(){a.canceled=!0}};n?function(e){r&&r.reject(M),r=e}(a):function t(i){var o=(n=i).request,a=o.method,u=o.args;e[a].apply(e,P(u)).then(function(e){if(n.canceled||r)return n.reject(M),n=null,void(r&&(t(r),r=null));n.resolve(e[0]),n=null})}(a)})};return i.isProcessing=function(){return!!n},i.hasQueued=function(){return!!r},i.cancel=function(){i.isProcessing()&&n.cancel(),i.hasQueued()&&(r.reject(M),r=null)},i}function L(e){var t=e.enigmaModel,n=e.layoutModel,r=e.Promise,i=function(e){switch(e.qMode){case"S":default:return O;case"K":return A;case"T":return C}}({qMode:n.getLayoutValue("qHyperCube.qMode")}),o=i.patcher,a=i.cache,u=i.slicer,s=i.cacheWarden,l=i.request,c=o({layoutModel:n}),f=a(),d=n.getDataPages()[0];d&&(c.should(d)&&c(d),f.set(d));var m=function(e){var t=e.cache,n=e.slice,r=e.warden,i=e.expand,o=e.request,a=e.process,u=e.connectionless,s=e.Promise;return function(e){var l=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).onProcessing;if(t.contains(e)){var c=t.get();if(u)return s.resolve(n(c,e));var f=r.release(c.qArea,e),d=a.isProcessing();if(!f&&d&&a.cancel(),!f||d)return s.resolve(n(c,e))}if(u)return s.resolve();a.isProcessing()&&l&&l();var m=i(e);return a(o(m)).then(function(r){return t.set(r),n(r,e)})}}({cache:f,slice:u,warden:s({bounds:{width:n.meta.size.x,height:n.meta.size.y}}),expand:T({layoutModel:n}),request:l({layoutModel:n}),process:N(t,r),connectionless:n.meta.isSnapshot,Promise:r}),h=y(function(e,t){var n=t.onProcessing,r=t.onData;m(e,{onProcessing:n}).then(function(e){return r(e)}).catch(function(e){if(e!==M)throw e})},S);return{getCachedDataPages:function(){return f.get()},setDataPages:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.onProcessing,i=void 0===r?x:r,o=t.onDataPage,a=void 0===o?x:o;h(e,{onProcessing:i,onData:function(e){n.setDataPages(e?[e]:[]),a(e)}})},setSnapshotData:function(e){var t=b.getValue(e,n.refs.dataPages);t.length=0,t.push(f.get())}}}function j(){var e={};return{get:function(t){return e[t]},set:function(t,n){return e[t]=n,n},has:function(t){return t in e},remove:function(t){delete e[t]},empty:function(){e={}}}}var E={inTotal:function(e){return e.layoutModel.meta.size.x},area:function(e){return{qTop:0,qHeight:1,qLeft:0,qWidth:e.layoutModel.meta.size.x}},scaleRange:function(e){var t=e.layoutModel,n=e.offsets,r=e.items,i=e.viewSize,o=n.pixel,a=t.getDataPages()[0],u=o/i;return[u,r.inView>=r.inTotal?u+1:u+a.qArea.qWidth/r.inView]}};var I={inTotal:function(e){return e.layoutModel.meta.size.y},area:function(e){var t=e.layoutModel,n=e.itemOffset,r=e.inView,i=Math.max(0,Math.floor(n));return{qTop:i,qHeight:Math.min(t.meta.size.y-i,Math.max(0,Math.ceil(r+1))),qLeft:0,qWidth:t.meta.size.x}},scaleRange:function(e){var t=e.layoutModel,n=e.offsets,r=e.items,i=e.viewSize,o=n.pixel,a=t.getDataPages()[0],u=i/r.inView,s=(o+a.qArea.qTop*u)/i;return[s,r.inView>=r.inTotal?s+1:s+a.qArea.qHeight/r.inView]}};function R(e,t){for(var n=[],r=0;r<e.length;r++){var i=t(e[r]);-1===n.indexOf(i)&&n.push(i)}return n.length}function H(e){return R(e.qMatrix,function(e){return e[0].qElemNumber})-1}var B={inTotal:function(e){var t=e.layoutModel,n=t.meta.measureCount;return t.meta.size.y*n*(1+1/n)-1},area:function(e){var t=e.layoutModel,n=e.itemOffset,r=e.inView,i=t.meta.measureCount,o=n/(i+1),a=Math.max(0,Math.floor((n-o)/i));return{qTop:a,qHeight:Math.min(t.meta.size.y-a,Math.max(0,Math.ceil(r/i+1))),qLeft:0,qWidth:t.meta.size.x}},scaleRange:function(e){var t=e.layoutModel,n=e.offsets,r=e.items,i=e.viewSize,o=t.meta.measureCount,a=t.getDataPages()[0],u=i/r.inView,s=n.pixel,l=H(a),c=a.qArea.qHeight*o+l,f=(s+(a.qArea.qTop*o+a.qArea.qTop)*u)/i;return[f,r.inView>=r.inTotal?f+1:f+c/r.inView]}};function z(e){var t=e.getLayoutValue("qHyperCube.qDimensionInfo.0.qCardinalities.qHypercubeCardinal",void 0),n=e.getLayoutValue("qHyperCube.qDimensionInfo.0.qStateCounts"),r=n.qLocked,i=n.qOption,o=n.qSelected;return t||r+i+o}var F=function(e,t){return t/(e.meta.size.y/z(e)+1)},_=function(e,t){for(var n={successful:!0,count:0},r=Math.abs(Math.floor(t)),i=[],o=0;o<=r;o++){if(!e[o])return n.successful=!1,n;var a=e[o][0].qElemNumber;-1===i.indexOf(a)&&(i.push(a),r--)}return n.count=i.length-1,n};function V(e){return{itemOffset:function(t,n){if(0!==t.qArea.qTop)return F(e,n);var r=_(t.qMatrix,n);return r.successful?r.count:F(e,n)},area:function(t,n,r){return 0!==t.qArea.qTop?F(e,n):R(t.qMatrix.slice(0,r.qTop+1),function(e){return e[0].qElemNumber})-1}}}var U={inTotal:function(e){var t=e.layoutModel;return t.meta.size.y+z(t)-1},area:function(e){var t=e.getDataPages,n=e.layoutModel,r=e.itemOffset,i=e.inView,o=V(n).itemOffset(t(),r),a=Math.max(0,Math.floor(r-o));return{qTop:a,qHeight:Math.min(n.meta.size.y-a,Math.max(0,Math.ceil(i+1))),qLeft:0,qWidth:n.meta.size.x}},scaleRange:function(e){var t=e.getDataPages,n=e.layoutModel,r=e.offsets,i=e.items,o=e.viewSize,a=e.upperBound,u=n.getDataPages()[0],s=o/i.inView,l=r.item,c=r.pixel,f=V(n).area(t(),l,u.qArea),d=H(u),m=u.qArea.qHeight+d,h=c===a?(i.inView-m)*s/o:(c+(u.qArea.qTop+f)*s)/o;return[h,i.inView>=i.inTotal?h+1:h+m/i.inView]}};function W(e){var t=e.getRect,n=e.getDataPages,r=e.layoutModel,i=e.dockModel,o=e.itemWidths,a=e.maxDataRows,u=e.rtl,s=function(e){var t=e.layoutModel.meta,n=t.isDimensionless,r=t.isGrouped,i=t.isGroupedByMeasure;return n?E:r?i?B:U:I}({layoutModel:r}),l=s.inTotal,c=s.area,f=s.scaleRange,d=function(){return"vertical"===i.major.orientation?t().width:t().height},m=function(e){return e?d()/e:0},h=function(e,t){return-(e-t)*m(t)};return{getItems:function(){var e=r.getLayoutValue("dimensionAxis"),n=r.meta,u=n.dimensionCount,s=n.measureCount,c=l({layoutModel:r});return{inTotal:c,inView:function(e){var t=e.rect,n=e.dockModel,r=e.itemWidths,i=e.dimensionAxis,o=e.inTotal,a=e.isMajorLabelless,u=e.maxDataRows,s=r[n.mode],l=s.DEFAULT,c=s.SQUEEZE,f=s.LABELLESS,d=i.axisDisplayMode,m=void 0===d?"auto":d,h=i.maxVisibleItems,p=void 0===h?10:h,g="vertical"===n.major.orientation?t.width:t.height,y=g/o>=c;switch(m){case"max":return Math.min(o,u);case"custom":return Math.min(p,u);case"auto":default:return a?g/f:y?o:g/l}}({rect:t(),dockModel:i,itemWidths:o,dimensionAxis:e,inTotal:c,isMajorLabelless:"none"===e.show||"title"===e.show,maxDataRows:a(u,s)})}},getItemSize:function(e){var t=e.items.inView;return m(t)},getOffsets:function(e){var t=e.pixelOffset,n=e.items,r=n.inTotal,i=n.inView,o=Math.min(0,Math.max(t,h(r,i)));return{pixel:o,item:i?Math.abs(i*o/d()):0}},getUpperBound:function(e){var t=e.items,n=t.inTotal,r=t.inView;return h(n,r)},getViewRange:function(e){var t=e.pixelOffset,n=e.items,r=n.inTotal,i=n.inView;return function(e){var t=e.viewSize,n=e.inTotal,r=e.inView,i=e.pixelOffset,o=t/r*n,a=Math.abs(i)/o;return[a,a+t/o]}({viewSize:d(),inTotal:r,inView:i,pixelOffset:t})},getArea:function(e){var t=e.itemOffset,i=e.items;return c({getDataPages:n,layoutModel:r,itemOffset:t,inView:i.inView})},getScaleRange:function(e){var t=e.offsets,o=e.items,a=f({getDataPages:n,layoutModel:r,offsets:t,items:o,viewSize:d(),upperBound:h(o.inTotal,o.inView)});return"vertical"===i.major.orientation&&u?function(e){return[1-e[1],1-e[0]]}(a):a},validate:{offset:function(e){var t=e.pixelOffset,n=e.items,r=n.inTotal,i=n.inView;return t<=0&&t>=h(r,i)}},convert:{itemToPixelOffset:function(e){var t=e.itemOffset,n=e.items.inView,r=t*m(n);return Number.isFinite(r)?-r:0},relativeToPixelOffset:function(e){var t=e.relativeOffset,n=e.items,r=n.inTotal,i=n.inView;return-t*(m(i)*r)}}}}function K(e){var t=e.chart,n=e.componentKey,r=e.discreteModel,i=e.layoutModel,o=e.dockModel,a=e.itemWidths,u=e.maxDataRows,s=e.viewState,l=e.rtl,c=e.Promise,f=j();f.set("rect",{width:0,height:0}),f.set("itemSize",0),f.set("items",{}),f.set("offsets",{}),f.set("area",{}),f.set("scaleRange",[0,1]);var d=W({getRect:function(){return f.get("rect")},getDataPages:r.getCachedDataPages,layoutModel:i,dockModel:o,itemWidths:a,maxDataRows:u,rtl:l}),m=function(){var e=d.getItems();return f.set("items",e),e},h=function(e){var t=e.pixelOffset,n=e.items,r=d.getOffsets({pixelOffset:t,items:n});return f.set("offsets",r),r},p=function(e){var t=m(),n=h({pixelOffset:e,items:t}),i=d.getArea({itemOffset:n.item,items:t});if(function(e){var t=f.get("area");return!!t&&Object.keys(e).every(function(n){return e[n]===t[n]})}(i))(d.validate.offset({pixelOffset:e,items:t})||s.get("scrollOffset")!==n.item)&&(f.set("scaleRange",d.getScaleRange({offsets:n,items:t})),s.preventSet("viewRange",d.getViewRange({pixelOffset:n.pixel,items:t})),s.set("scrollOffset",n.item));else{s.preventSet("viewRange",d.getViewRange({pixelOffset:n.pixel,items:t}));var o=function(){f.set("area",i),f.set("scaleRange",d.getScaleRange({offsets:n,items:t})),s.set("scrollOffset",n.item)};r.setDataPages(i,{onProcessing:o,onDataPage:o})}};return{enabled:function(){var e=f.get("items");return e.inTotal>e.inView},itemSize:function(){return f.get("itemSize")},scaleRange:function(){return f.get("scaleRange")},initialize:function(){f.set("rect",t.component(n).rect);var e=m();f.set("itemSize",d.getItemSize({items:e}));var o=void 0===s.get("scrollOffset")?function(e){var t=e.items;return 1===i.getLayoutValue("scrollStartPos")?d.getUpperBound({items:t}):0}({items:e}):d.convert.itemToPixelOffset({itemOffset:s.get("scrollOffset"),items:e}),a=h({pixelOffset:o,items:e});s.preventSet("viewRange",d.getViewRange({pixelOffset:a.pixel,items:e}));var u=d.getArea({itemOffset:a.item,items:e});return new c(function(t){r.setDataPages(u,{onDataPage:function(){f.set("scaleRange",d.getScaleRange({offsets:a,items:e})),s.preventSet("scrollOffset",a.item),t()}})})},scroll:function(e){var t=f.get("offsets").pixel+e;p(t)},scrollToRelative:function(e){var t=f.get("items"),n=d.convert.relativeToPixelOffset({relativeOffset:e,items:t});p(n)}}}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Y="discretePan",X=10;function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Z(e){var t=e.chart,n=e.actions,r=e.componentKey,i=e.dockModel,o=e.rtl,a=e.scroller;return{gestures:[function(e){var t,n=e.chart,r=e.actions,i=e.componentKey,o=e.dockModel,a=e.rtl,u=e.scroller;return{type:"Pan",key:"discrete:pan",options:{event:Y,pointers:1,threshold:X,enable:function(e,t){return this.started===Y||!t||!!r.scroll.enabled()&&n.componentsFromPoint({x:t.center.x,y:t.center.y}).some(function(e){return e.key===i})}},events:(t={},G(t,"".concat(Y,"start"),function(e){e.preventDefault(),this.started=Y;var t="vertical"===o.major.orientation?e.deltaX:e.deltaY;this.previousTotalDelta=t<0?-X:X}),G(t,"".concat(Y,"move"),function(e){e.preventDefault();var t="vertical"===o.major.orientation,n=t?e.deltaX:e.deltaY,r=t&&a?-1:1,i=(n-this.previousTotalDelta)*r;this.previousTotalDelta=n,u.scroll(i)}),G(t,"".concat(Y,"end"),function(e){e.preventDefault(),this.started=!1}),G(t,"".concat(Y,"cancel"),function(e){e.preventDefault(),this.started=!1}),t)}}({chart:t,actions:n,componentKey:r,dockModel:i,rtl:o,scroller:a})],native:{type:"native",events:{wheel:function(e){var t=e.chart,n=e.componentKey,r=e.actions,i=e.scroller;return function(e){if(r.scroll.enabled()&&J(t.componentsFromPoint({x:e.clientX,y:e.clientY}).filter(function(e){return e.key===n}),1)[0]){e.preventDefault();var o=Math.abs(e.deltaY)>Math.abs(e.deltaX)?e.deltaY:e.deltaX,a=Math.sign(-o)*D;i.scroll(a)}}}({chart:t,actions:n,componentKey:r,scroller:a})}}}}var $=12,Q=2e3;function ee(e){var t=e.model,n=e.layoutModel;return{fetch:function(e,n){var r={qStart:e,qEnd:n,qNbrPoints:this.computeNbrOfBins(),qMaxNbrTicks:300,qMaxNumberLines:this.computeMaxNumberLines()};return t.getHyperCubeContinuousData("/qHyperCubeDef",r,!1)},shouldFetchReduced:function(){var e=n.getLayout().qHyperCube;return e.qSize.qcy*e.qMeasureInfo.length>=Q},computeDimensionSize:function(){var e=n.getLayout().qHyperCube.qDimensionInfo[1].qStateCounts;return e.qLocked+e.qOption+e.qSelected},computeNbrOfBins:function(){var e=n.getLayout().qHyperCube;if(!this.shouldFetchReduced())return Q;var t=e.qMeasureInfo.length||1,r=4+2*(t-1);return e.qDimensionInfo.length>1&&(t=Math.max(1,Math.min($,this.computeDimensionSize())),r=4),Math.ceil(Q/(t*r))},computeMaxNumberLines:function(){return n.getLayout().qHyperCube.qDimensionInfo.length>1&&!this.shouldFetchReduced()?this.computeDimensionSize()+1:$}}}function te(e){var t=e.Promise,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).cache,r=void 0===n?{}:n;return{fetch:function(){return t.resolve(r.merged)}}}function ne(e){var t=e.layoutModel,n=e.viewCache,r=e.Promise;return{fetch:function(){var e=t.getLayoutValue("qHyperCube"),n=e.qAxisData,i=e.qDataPages;return r.resolve({qAxisData:n,qDataPages:i})},getSnapshotData:function(){var e,r,i,o,a,u,s,l,c=t.getLayoutValue("snapshotData.content.chartData",{});return"zoom"in c&&"min"in c.zoom&&"max"in c.zoom?{zoom:c.zoom}:(e=c,r=n.get("continuousMin"),i=e.scrollOffset,o=void 0===i?0:i,a=e.viewRange,l=(s=r+o)+(u=void 0===a?0:a),1===u&&0===o&&(s=r-.5,l=r+.5),{zoom:{min:s,max:l}})}}}function re(e,t){return Object.assign({},e,{qWidth:t[0]?t[0].length:0,qHeight:t.length})}function ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oe(e,t,n){var r={qDataPages:(n.qDataPages||[]).map(function(n){var r=function(e,t,n){return n.filter(function(n){return n[0].qNum>=e&&n[0].qNum<=t})}(e,t,n.qMatrix);return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){ie(e,t,n[t])})}return e}({},n,{qArea:re(n.qArea,r),qMatrix:r})})};return n.qAxisData&&n.qAxisData.qAxis&&(r.qAxisData=function(e,t,n){return{qAxis:n.qAxis.map(function(n){return{qName:n.qName,qTags:n.qTags,qTicks:n.qTicks.reduce(function(n,r){return r.qStart>=e&&r.qStart<=t?n.push(r):r.qEnd>=e&&r.qEnd<=t?n.push(r):r.qStart<e&&r.qEnd>t&&n.push(r),n},[])}})}}(e,t,n.qAxisData)),r}function ae(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ue(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function le(e,t){var n={};return n.qDataPages=(e.qDataPages||[]).map(function(e,n){var r=function(e,t){if(!t||!t.length||!t[0].length)return e;for(var n=t[0][0].qNum,r=t[t.length-1][0].qNum,i=[],o=[],a=0,u=e.length;a<u;a++){var s=e[a][0];s.qNum<n?i.push(e[a]):s.qNum>r&&o.push(e[a])}return[].concat(i,ae(t),o)}(e.qMatrix,t.qDataPages[n].qMatrix);return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){se(e,t,n[t])})}return e}({},e,{qArea:re(e.qArea,r),qMatrix:r})}),e.qAxisData&&e.qAxisData.qAxis&&(n.qAxisData=function(e,t){if(!t||!t.qAxis.length||t.qAxis.every(function(e){return!e.qTicks.length}))return e;for(var n=t.qAxis.map(function(e){return e.qName}),r=t.qAxis.map(function(e){return{start:e.qTicks[0].qStart,end:e.qTicks[e.qTicks.length-1].qStart}}),i=t.qAxis.map(function(e){return{qName:e.qName,qTags:ue(e.qTags),qTicks:ue(e.qTicks)}}),o=0,a=e.qAxis.length;o<a;o++){var u=e.qAxis[o],s=n.indexOf(u.qName),l=[],c=[];if(s>-1){for(var f=r[s],d=f.start,m=f.end,h=0,p=u.qTicks.length;h<p;h++){var g=u.qTicks[h];g.qStart<d?l.push(g):g.qStart>m&&c.push(g)}i[s].qTicks=[].concat(l,ue(i[s].qTicks),c)}}return{qAxis:i}}(e.qAxisData,t.qAxisData)),n}function ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fe(e){return{qDataPages:e.qDataPages.map(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){ce(e,t,n[t])})}return e}({},e,{qArea:re(e.qArea,e.qMatrix)})}),qAxisData:e.qAxisData}}var de=Math.pow(2,.5),me=1/de,he=1e-6,pe=Math.pow(me,44);function ge(e){return e.qIsOtherCell}function ye(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).qDataPages,t=void 0===e?[]:e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.length?t[0].qMatrix:[];return n.isStackedByDimension?function(e){var t={};return e.forEach(function(e){if(!e.some(ge)){var n=e[0].qElemNumber;t[n]=void 0}}),Object.keys(t).length}(r):function(e){var t=0;return e.forEach(function(e){e.some(ge)||t++}),t}(r)}function ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function be(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Me={created:function(){this.state={}},beforeUpdate:function(){this.state={}},beforeRender:function(e){var t=e.size;this.state.ticks=this.scale.ticks({distance:t.width}).filter(function(e){return!e.isMinor}),"linear"===this.scale.type&&function(e,t){for(var n=be(e.domain(),2)[1],r=0;r<t.length;r++){var i=t[r],o=t[r+1];i.data={},o||1===i.end?o?(i.data.start=i.value,i.data.end=o.value,i.end=o.position):(i.data.start=i.value,i.data.end=i.value):(i.data.start=i.value,i.data.end=n,i.end=1)}}(this.scale,this.state.ticks)},render:function(){var e=this,t=this.scale.data().fields.length?this.scale.data().fields[0].id():"",n=this.state.ticks,r=n.map(function(n){return{type:"rect",fill:"none",data:{source:{field:t},value:[n.data.start,n.data.end]},x:n.start*e.rect.width,y:0,width:(n.end-n.start)*e.rect.width,height:e.rect.height}});if(n.length&&n[0].start>0){var i=n[0];r.unshift({type:"rect",fill:"none",data:{source:{field:t},value:[this.scale.domain()[0],i.data.start]},x:0,y:0,width:i.start*this.rect.width,height:this.rect.height})}return r}},xe="…";function we(e){if((arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)%2==0)return e;var t=Math.round(e);return e-t>0?t+=.5:t-=.5,t}function qe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Se(e,t){var n=t.localProps.size,r=t.props.anchor,i=function(e){var t=e.props,n=e.localProps.size,r=e.style,i=e.renderer,o=t.label.padding,a=Math.max(0,Math.min(t.label.justify,1)),u=Math.max(0,Math.min(t.label.align,1)),s=function(e){return i.measureText({text:e,fontSize:r.label.fontSize,fontFamily:r.label.fontFamily})};return{resolve:function(e,t){var i="string"==typeof e.label?e.label:"",l=s(i),c=t.x,f=t.width;e.start===e.end&&(f=l.width+2*o,1===e.end&&(c-=f));var d={x:c+o,y:o,width:f-2*o,height:n.height-2*o},m=s("".concat(i[0]).concat(xe)).width,h=Math.max(0,d.width-l.width),p=Math.max(0,d.height-l.height),g=a*h,y=u*p;return{show:d.width>=Math.min(m,l.width),text:i,dx:g,dy:y,rect:d,style:r.label,segment:{x:c+g,width:l.width+2*o}}}}}(t),o=function(e){var t=e.localProps.size,n=e.style,r=e.scale,i=e.props,o=qe(r.domain(),2),a=o[0],u=o[1],s=Math.max(0,Math.min(1,i.guideLine.major.justify));return{resolve:function(e,r){var i=s*r.width,o=we(r.x+i,n.majorGuideLine.strokeWidth);return{show:e.value>=a&&e.value<=u,x1:o,y1:0,x2:o,y2:we(t.height,n.majorGuideLine.strokeWidth),style:n.majorGuideLine}}}}(t),a=e.map(function(e){var t=function(e,t,n){var r=Math.abs(Math.max(e.start,0)-Math.min(e.end,1))*t.width;return{x:Math.max(e[n],0)*t.width,y:0,width:r,height:t.height}}(e,n,r);return{rect:t,label:i.resolve(e,t),guideLine:o.resolve(e,t)}});return function(e,t){var n=e.length;if(!(n<2)){var r,i,o=e[n-1],a=t[n-1].label;if(o&&o.start===o.end)for(var u=n-2;u>-1;u--){var s=t[u].label;s.show=s.show&&(r=s.segment,i=a.segment,!(r.x<i.x?r.x+r.width>=i.x:i.x+i.width>=r.x))}}}(e,a),a}function ke(e,t){var n,r,i,o,a=(r=(n=t).localProps.size,i=n.props,o=n.style,{resolve:function(e){var t=Math.max(r.height-i.guideLine.minor.size,0)*Math.max(0,Math.min(i.guideLine.minor.align,1)),n=we(e.position*r.width,o.minorGuideLine.strokeWidth);return{guideLine:{show:!0,x1:n,y1:we(t,o.minorGuideLine.strokeWidth),x2:n,y2:we(i.guideLine.minor.size+t,o.minorGuideLine.strokeWidth),style:o.minorGuideLine}}}});return t.props.guideLine.minor.show?e.map(a.resolve):[]}function De(e){return e.filter(function(e){return e.show}).map(function(e){return g()({strokeWidth:1},e.style,{type:"line",x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2})})}function Oe(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Ae={require:["renderer"],defaultSettings:{layout:{displayOrder:0,prioOrder:0},settings:{anchor:"start",label:{show:!0,padding:4,align:0,justify:0},guideLine:{major:{justify:0},minor:{show:!0,size:4,align:0}}},style:{label:"$label",majorGuideLine:"$guide-line",minorGuideLine:"$guide-line"}},preferredSize:function(){return{size:30,edgeBleed:{left:1,right:1}}},init:function(){this.props=this.settings.settings,this.localProps={},this.state={major:[],minor:[]}},created:function(){this.init()},beforeUpdate:function(){this.init()},beforeRender:function(e){var t=e.size;this.localProps.size=t;var n=this.scale.ticks({distance:t.width}),r=n.filter(function(e){return!e.isMinor}),i=n.filter(function(e){return e.isMinor});this.state.major=Se(r,this),this.state.minor=ke(i,this)},render:function(){return[].concat(Oe(this.state.major.map(function(e){return e.label}).filter(function(e){return e.show}).map(function(e){return g()({},e.style,{type:"text",x:e.rect.x,y:e.rect.y,dx:e.dx,dy:e.dy,maxWidth:e.rect.width,text:e.text,title:e.text,baseline:"text-before-edge"})})),Oe(De(this.state.major.map(function(e){return e.guideLine}))),Oe(De(this.state.minor.map(function(e){return e.guideLine}))))}},Ce=Math.sqrt(50),Te=Math.sqrt(10),Pe=Math.sqrt(2),Ne=function(e,t,n){var r,i,o,a,u=-1;if(n=+n,(e=+e)===(t=+t)&&n>0)return[e];if((r=t<e)&&(i=e,e=t,t=i),0===(a=Le(e,t,n))||!isFinite(a))return[];if(a>0)for(e=Math.ceil(e/a),t=Math.floor(t/a),o=new Array(i=Math.ceil(t-e+1));++u<i;)o[u]=(e+u)*a;else for(e=Math.floor(e*a),t=Math.ceil(t*a),o=new Array(i=Math.ceil(e-t+1));++u<i;)o[u]=(e-u)/a;return r&&o.reverse(),o};function Le(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=Ce?10:o>=Te?5:o>=Pe?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=Ce?10:o>=Te?5:o>=Pe?2:1)}function je(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=Ce?i*=10:o>=Te?i*=5:o>=Pe&&(i*=2),t<e?-i:i}var Ee=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},Ie=function(e){var t;return 1===e.length&&(t=e,e=function(e,n){return Ee(t(e),n)}),{left:function(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var o=r+i>>>1;e(t[o],n)<0?r=o+1:i=o}return r},right:function(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var o=r+i>>>1;e(t[o],n)>0?i=o:r=o+1}return r}}};var Re=Ie(Ee),He=Re.right,Be=(Re.left,He),ze=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e};function Fe(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function _e(){}var Ve="\\s*([+-]?\\d+)\\s*",Ue="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",We="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ke=/^#([0-9a-f]{3})$/,Ge=/^#([0-9a-f]{6})$/,Ye=new RegExp("^rgb\\("+[Ve,Ve,Ve]+"\\)$"),Xe=new RegExp("^rgb\\("+[We,We,We]+"\\)$"),Je=new RegExp("^rgba\\("+[Ve,Ve,Ve,Ue]+"\\)$"),Ze=new RegExp("^rgba\\("+[We,We,We,Ue]+"\\)$"),$e=new RegExp("^hsl\\("+[Ue,We,We]+"\\)$"),Qe=new RegExp("^hsla\\("+[Ue,We,We,Ue]+"\\)$"),et={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function tt(e){var t;return e=(e+"").trim().toLowerCase(),(t=Ke.exec(e))?new at((t=parseInt(t[1],16))>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):(t=Ge.exec(e))?nt(parseInt(t[1],16)):(t=Ye.exec(e))?new at(t[1],t[2],t[3],1):(t=Xe.exec(e))?new at(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Je.exec(e))?rt(t[1],t[2],t[3],t[4]):(t=Ze.exec(e))?rt(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=$e.exec(e))?st(t[1],t[2]/100,t[3]/100,1):(t=Qe.exec(e))?st(t[1],t[2]/100,t[3]/100,t[4]):et.hasOwnProperty(e)?nt(et[e]):"transparent"===e?new at(NaN,NaN,NaN,0):null}function nt(e){return new at(e>>16&255,e>>8&255,255&e,1)}function rt(e,t,n,r){return r<=0&&(e=t=n=NaN),new at(e,t,n,r)}function it(e){return e instanceof _e||(e=tt(e)),e?new at((e=e.rgb()).r,e.g,e.b,e.opacity):new at}function ot(e,t,n,r){return 1===arguments.length?it(e):new at(e,t,n,null==r?1:r)}function at(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function ut(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function st(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new lt(e,t,n,r)}function lt(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function ct(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function ft(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}ze(_e,tt,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),ze(at,ot,Fe(_e,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new at(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new at(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},hex:function(){return"#"+ut(this.r)+ut(this.g)+ut(this.b)},toString:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}})),ze(lt,function(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof lt)return new lt(e.h,e.s,e.l,e.opacity);if(e instanceof _e||(e=tt(e)),!e)return new lt;if(e instanceof lt)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,u=o-i,s=(o+i)/2;return u?(a=t===o?(n-r)/u+6*(n<r):n===o?(r-t)/u+2:(t-n)/u+4,u/=s<.5?o+i:2-o-i,a*=60):u=s>0&&s<1?0:a,new lt(a,u,s,e.opacity)}(e):new lt(e,t,n,null==r?1:r)},Fe(_e,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new lt(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new lt(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new at(ct(e>=240?e-240:e+120,i,r),ct(e,i,r),ct(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var dt=function(e){return function(){return e}};function mt(e,t){return function(n){return e+n*t}}function ht(e){return 1==(e=+e)?pt:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):dt(isNaN(t)?n:t)}}function pt(e,t){var n=t-e;return n?mt(e,n):dt(isNaN(e)?t:e)}var gt=function e(t){var n=ht(t);function r(e,t){var r=n((e=ot(e)).r,(t=ot(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),a=pt(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function yt(e){return function(t){var n,r,i=t.length,o=new Array(i),a=new Array(i),u=new Array(i);for(n=0;n<i;++n)r=ot(t[n]),o[n]=r.r||0,a[n]=r.g||0,u[n]=r.b||0;return o=e(o),a=e(a),u=e(u),r.opacity=1,function(e){return r.r=o(e),r.g=a(e),r.b=u(e),r+""}}}yt(function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,u=r<t-1?e[r+2]:2*o-i;return ft((n-r/t)*t,a,i,o,u)}}),yt(function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],a=e[(r+1)%t],u=e[(r+2)%t];return ft((n-r/t)*t,i,o,a,u)}});var vt=function(e,t){return t-=e=+e,function(n){return e+t*n}};function bt(e){return(bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Mt=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,xt=new RegExp(Mt.source,"g");function wt(e){return(wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var qt=function(e,t){var n,r=wt(t);return null==t||"boolean"===r?dt(t):("number"===r?vt:"string"===r?(n=tt(t))?(t=n,gt):function(e,t){var n,r,i,o=Mt.lastIndex=xt.lastIndex=0,a=-1,u=[],s=[];for(e+="",t+="";(n=Mt.exec(e))&&(r=xt.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),u[a]?u[a]+=i:u[++a]=i),(n=n[0])===(r=r[0])?u[a]?u[a]+=r:u[++a]=r:(u[++a]=null,s.push({i:a,x:vt(n,r)})),o=xt.lastIndex;return o<t.length&&(i=t.slice(o),u[a]?u[a]+=i:u[++a]=i),u.length<2?s[0]?function(e){return function(t){return e(t)+""}}(s[0].x):function(e){return function(){return e}}(t):(t=s.length,function(e){for(var n,r=0;r<t;++r)u[(n=s[r]).i]=n.x(e);return u.join("")})}:t instanceof tt?gt:t instanceof Date?function(e,t){var n=new Date;return t-=e=+e,function(r){return n.setTime(e+t*r),n}}:Array.isArray(t)?function(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=qt(e[n],t[n]);for(;n<r;++n)a[n]=t[n];return function(e){for(n=0;n<i;++n)a[n]=o[n](e);return a}}:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?function(e,t){var n,r={},i={};for(n in null!==e&&"object"===bt(e)||(e={}),null!==t&&"object"===bt(t)||(t={}),t)n in e?r[n]=qt(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}:vt)(e,t)},St=function(e,t){return t-=e=+e,function(n){return Math.round(e+t*n)}},kt=Array.prototype,Dt=kt.map,Ot=kt.slice,At=function(e){return function(){return e}},Ct=function(e){return+e},Tt=[0,1];function Pt(e){return e}function Nt(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:At(isNaN(t)?NaN:.5)}function Lt(e){var t,n=e[0],r=e[e.length-1];return n>r&&(t=n,n=r,r=t),function(e){return Math.max(n,Math.min(r,e))}}function jt(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=Nt(i,r),o=n(a,o)):(r=Nt(r,i),o=n(o,a)),function(e){return o(r(e))}}function Et(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=Nt(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(t){var n=Be(e,t,1,r)-1;return o[n](i[n](t))}}function It(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Rt(e,t){return function(){var e,t,n,r,i,o,a=Tt,u=Tt,s=qt,l=Pt;function c(){return r=Math.min(a.length,u.length)>2?Et:jt,i=o=null,f}function f(t){return isNaN(t=+t)?n:(i||(i=r(a.map(e),u,s)))(e(l(t)))}return f.invert=function(n){return l(t((o||(o=r(u,a.map(e),vt)))(n)))},f.domain=function(e){return arguments.length?(a=Dt.call(e,Ct),l===Pt||(l=Lt(a)),c()):a.slice()},f.range=function(e){return arguments.length?(u=Ot.call(e),c()):u.slice()},f.rangeRound=function(e){return u=Ot.call(e),s=St,c()},f.clamp=function(e){return arguments.length?(l=e?Lt(a):Pt,f):l!==Pt},f.interpolate=function(e){return arguments.length?(s=e,c()):s},f.unknown=function(e){return arguments.length?(n=e,f):n},function(n,r){return e=n,t=r,c()}}()(e,t)}function Ht(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}var Bt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function zt(e){return new Ft(e)}function Ft(e){if(!(t=Bt.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}zt.prototype=Ft.prototype,Ft.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var _t,Vt,Ut,Wt,Kt=function(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]},Gt=function(e){return(e=Kt(Math.abs(e)))?e[1]:NaN},Yt=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(i>0){if(!+e[r])break e;i=0}}return i>0?e.slice(0,i)+e.slice(t+1):e},Xt=function(e,t){var n=Kt(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},Jt={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return Xt(100*e,t)},r:Xt,s:function(e,t){var n=Kt(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(_t=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Kt(e,Math.max(0,t+o-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}},Zt=function(e){return e},$t=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];Vt=function(e){var t,n,r=e.grouping&&e.thousands?(t=e.grouping,n=e.thousands,function(e,r){for(var i=e.length,o=[],a=0,u=t[0],s=0;i>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),o.push(e.substring(i-=u,i+u)),!((s+=u+1)>r));)u=t[a=(a+1)%t.length];return o.reverse().join(n)}):Zt,i=e.currency,o=e.decimal,a=e.numerals?function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}(e.numerals):Zt,u=e.percent||"%";function s(e){var t=(e=zt(e)).fill,n=e.align,s=e.sign,l=e.symbol,c=e.zero,f=e.width,d=e.comma,m=e.precision,h=e.trim,p=e.type;"n"===p?(d=!0,p="g"):Jt[p]||(null==m&&(m=12),h=!0,p="g"),(c||"0"===t&&"="===n)&&(c=!0,t="0",n="=");var g="$"===l?i[0]:"#"===l&&/[boxX]/.test(p)?"0"+p.toLowerCase():"",y="$"===l?i[1]:/[%p]/.test(p)?u:"",v=Jt[p],b=/[defgprs%]/.test(p);function M(e){var i,u,l,M=g,x=y;if("c"===p)x=v(e)+x,e="";else{var w=(e=+e)<0;if(e=v(Math.abs(e),m),h&&(e=Yt(e)),w&&0==+e&&(w=!1),M=(w?"("===s?s:"-":"-"===s||"("===s?"":s)+M,x=("s"===p?$t[8+_t/3]:"")+x+(w&&"("===s?")":""),b)for(i=-1,u=e.length;++i<u;)if(48>(l=e.charCodeAt(i))||l>57){x=(46===l?o+e.slice(i+1):e.slice(i))+x,e=e.slice(0,i);break}}d&&!c&&(e=r(e,1/0));var q=M.length+e.length+x.length,S=q<f?new Array(f-q+1).join(t):"";switch(d&&c&&(e=r(S+e,S.length?f-x.length:1/0),S=""),n){case"<":e=M+e+x+S;break;case"=":e=M+S+e+x;break;case"^":e=S.slice(0,q=S.length>>1)+M+e+x+S.slice(q);break;default:e=S+M+e+x}return a(e)}return m=null==m?6:/[gprs]/.test(p)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),M.toString=function(){return e+""},M}return{format:s,formatPrefix:function(e,t){var n=s(((e=zt(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(Gt(t)/3))),i=Math.pow(10,-r),o=$t[8+r/3];return function(e){return n(i*e)+o}}}}({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),Ut=Vt.format,Wt=Vt.formatPrefix;var Qt=function(e,t,n,r){var i,o=je(e,t,n);switch((r=zt(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Gt(t)/3)))-Gt(Math.abs(e)))}(o,a))||(r.precision=i),Wt(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Gt(t)-Gt(e))+1}(o,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(e){return Math.max(0,-Gt(Math.abs(e)))}(o))||(r.precision=i-2*("%"===r.type))}return Ut(r)};function en(){var e=Rt(Pt,Pt);return e.copy=function(){return It(e,en())},Ht.apply(e,arguments),function(e){var t=e.domain;return e.ticks=function(e){var n=t();return Ne(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return Qt(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i=t(),o=0,a=i.length-1,u=i[o],s=i[a];return s<u&&(r=u,u=s,s=r,r=o,o=a,a=r),(r=Le(u,s,n))>0?r=Le(u=Math.floor(u/r)*r,s=Math.ceil(s/r)*r,n):r<0&&(r=Le(u=Math.ceil(u*r)/r,s=Math.floor(s*r)/r,n)),r>0?(i[o]=Math.floor(u/r)*r,i[a]=Math.ceil(s/r)*r,t(i)):r<0&&(i[o]=Math.ceil(u*r)/r,i[a]=Math.floor(s*r)/r,t(i)),e},e}(e)}function tn(e,t){return e&&t&&e.qTicks.length===t.qTicks.length&&e.qTicks.every(function(e,n){return e.qStart===t.qTicks[n].qStart&&e.qEnd===t.qTicks[n].qEnd})}function nn(e){for(var t=e.qAxis,n=[],r=[],i=0;i<t.length;i++){var o=i+1,a=t[i],u=t[o];tn(a,u)?(u.qTags.indexOf("$qualified")>-1?(n.push(o),r.push(i)):(n.push(i),r.push(o)),i++):(n.push(i),r.push(i))}return{qualified:n,nonQualified:r}}function rn(e){var t=e.qualifiedMeta,n=e.nonQualifiedMeta;return{resolve:function(e){for(var r,i=NaN,o=NaN,a=NaN,u=!1,s=t.length-1;s>=0;s--){var l=t[s];if(l.queries.outer(e)){var c=n[s+1];if(i=l.index,r=s,l.attrs.isDayOrShorter()&&l.queries.canFitHalfDayTicks(e)){o="auto",u=!0;break}if(c&&c.queries.inner(e)){o=c.index;var f=n[s+2];f&&f.queries.minor(e)&&(a=f.index);break}}}if(!Number.isNaN(i)&&Number.isNaN(o)&&"auto"!==o){o=i,i=NaN;var d=n[r+1];d&&d.queries.minor(e)&&(a=d.index)}else Number.isNaN(i)&&(i="auto",o="auto");return{outer:i,inner:o,minor:a,isDayOrShorter:u}}}}function on(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var an=16;function un(e){var t=e.qTicks,n=e.measureText,r=void 0===n?function(){return{width:0}}:n,i=e.cache,o=void 0===i?{}:i,a=e.scale,u=o;return{isDayOrShorter:function(){return u.isDayOrShorter=t.length>0&&Math.abs(t[0].qStart-t[0].qEnd)<=1,u.isDayOrShorter},count:function(){return t.length},maxRange:function(){return u.maxRange=t.length?Math.max.apply(Math,on(t.map(function(e){return Math.abs(a(e.qStart)-a(e.qEnd))}))):0,u.maxRange},rangeAndWidth:function(){var e=a.clamp();return a.clamp(!1),u.rangeAndWidth=t.map(function(e){return{range:Math.abs(a(e.qStart)-a(e.qEnd)),width:r("".concat(e.qText)).width+an}}),a.clamp(e),u.rangeAndWidth}}}var sn=6;function ln(e){var t=e.attrs,n=e.reqAutoFitWidth;return{outer:function(e){return!t.rangeAndWidth().some(function(t){return t.width>t.range*e})},inner:function(e){return!t.rangeAndWidth().some(function(t){return t.width>t.range*e})},minor:function(e){return t.maxRange()*e>=sn},canFitHalfDayTicks:function(e){return e>=n*t.count()}}}function cn(e){var t=e.qualified,n=e.nonQualified,r=e.qAxis,i=e.measureText,o=e.reqAutoFitWidth,a=e.scale,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{attributesFactory:un,queryFactory:ln},s=u.attributesFactory,l=void 0===s?un:s,c=u.queryFactory,f=void 0===c?ln:c;var d=r.map(function(e,t){return function(e,t){var n=e.qTicks,r=l({qTicks:n,measureText:i,scale:a});return{data:e,index:t,attrs:r,queries:f({attrs:r,reqAutoFitWidth:o})}}(e,t)}),m=t.map(function(e){return d[e]}),h=n.map(function(e){return d[e]});return{qAxisMeta:d,qualifiedMeta:m,nonQualifiedMeta:h}}function fn(e){var t=e.qAxis,n=void 0===t?[]:t,r=e.measureText,i=void 0===r?function(){return{width:0}}:r,o=e.cache,a=void 0===o?{}:o,u=e.reqAutoFitWidth,s=void 0===u?0:u,l=e.scale,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{metaFactory:cn,mapper:nn,resolver:rn},f=c.metaFactory,d=void 0===f?cn:f,m=c.mapper,h=void 0===m?nn:m,p=c.resolver,g=void 0===p?rn:p,y=h({qAxis:n}),v=y.qualified,b=y.nonQualified,M=d({qAxis:n,qualified:v,nonQualified:b,measureText:i,reqAutoFitWidth:s,scale:l}),x=g({qualifiedMeta:M.qualifiedMeta,nonQualifiedMeta:M.nonQualifiedMeta});return{resolve:function(e){var t=a.key({distance:e});if(a.get(t))return a.get(t);if(function(e){return!Array.isArray(e)||0===e.length||e.every(function(e){return 0===e.qTicks.length})}(n))return{outer:"auto",inner:"auto",minor:NaN,isDayOrShorter:!1};var r=x.resolve(e);return a.set(t,r),r}}}var dn=new Date,mn=new Date;function hn(e,t,n,r){function i(t){return e(t=new Date(+t)),t}return i.floor=i,i.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},i.round=function(e){var t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},i.range=function(n,r,o){var a,u=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return u;do{u.push(a=new Date(+n)),t(n,o),e(n)}while(a<n&&n<r);return u},i.filter=function(n){return hn(function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})},n&&(i.count=function(t,r){return dn.setTime(+t),mn.setTime(+r),e(dn),e(mn),Math.floor(n(dn,mn))},i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?function(t){return r(t)%e==0}:function(t){return i.count(0,t)%e==0}):i:null}),i}var pn=hn(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});pn.every=function(e){return isFinite(e=Math.floor(e))&&e>0?hn(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)}):null};var gn=pn,yn=(pn.range,hn(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()})),vn=(yn.range,6e4),bn=6048e5;function Mn(e){return hn(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*vn)/bn})}var xn=Mn(0),wn=Mn(1),qn=Mn(2),Sn=Mn(3),kn=Mn(4),Dn=Mn(5),On=Mn(6),An=(xn.range,wn.range,qn.range,Sn.range,kn.range,Dn.range,On.range,hn(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*vn)/864e5},function(e){return e.getDate()-1})),Cn=An,Tn=(An.range,hn(function(e){var t=e.getTimezoneOffset()*vn%36e5;t<0&&(t+=36e5),e.setTime(36e5*Math.floor((+e-t)/36e5)+t)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getHours()})),Pn=(Tn.range,hn(function(e){e.setTime(Math.floor(e/vn)*vn)},function(e,t){e.setTime(+e+t*vn)},function(e,t){return(t-e)/vn},function(e){return e.getMinutes()})),Nn=(Pn.range,hn(function(e){e.setTime(1e3*Math.floor(e/1e3))},function(e,t){e.setTime(+e+1e3*t)},function(e,t){return(t-e)/1e3},function(e){return e.getUTCSeconds()})),Ln=Nn,jn=(Nn.range,hn(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e}));jn.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?hn(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):jn:null};var En=jn;jn.range;function In(e){return hn(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/bn})}var Rn=In(0),Hn=In(1),Bn=In(2),zn=In(3),Fn=In(4),_n=In(5),Vn=In(6),Un=(Rn.range,Hn.range,Bn.range,zn.range,Fn.range,_n.range,Vn.range,hn(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/864e5},function(e){return e.getUTCDate()-1})),Wn=Un,Kn=(Un.range,hn(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()}));Kn.every=function(e){return isFinite(e=Math.floor(e))&&e>0?hn(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null};var Gn=Kn;Kn.range;function Yn(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Xn(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Jn(e){return{y:e,m:0,d:1,H:0,M:0,S:0,L:0}}var Zn,$n,Qn={"-":"",_:" ",0:"0"},er=/^\s*\d+/,tr=/^%/,nr=/[\\^$*+?|[\]().{}]/g;function rr(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function ir(e){return e.replace(nr,"\\$&")}function or(e){return new RegExp("^(?:"+e.map(ir).join("|")+")","i")}function ar(e){for(var t={},n=-1,r=e.length;++n<r;)t[e[n].toLowerCase()]=n;return t}function ur(e,t,n){var r=er.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function sr(e,t,n){var r=er.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function lr(e,t,n){var r=er.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function cr(e,t,n){var r=er.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function fr(e,t,n){var r=er.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function dr(e,t,n){var r=er.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function mr(e,t,n){var r=er.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function hr(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function pr(e,t,n){var r=er.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function gr(e,t,n){var r=er.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function yr(e,t,n){var r=er.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function vr(e,t,n){var r=er.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function br(e,t,n){var r=er.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Mr(e,t,n){var r=er.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function xr(e,t,n){var r=er.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function wr(e,t,n){var r=er.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function qr(e,t,n){var r=tr.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Sr(e,t,n){var r=er.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function kr(e,t,n){var r=er.exec(t.slice(n));return r?(e.Q=1e3*+r[0],n+r[0].length):-1}function Dr(e,t){return rr(e.getDate(),t,2)}function Or(e,t){return rr(e.getHours(),t,2)}function Ar(e,t){return rr(e.getHours()%12||12,t,2)}function Cr(e,t){return rr(1+Cn.count(gn(e),e),t,3)}function Tr(e,t){return rr(e.getMilliseconds(),t,3)}function Pr(e,t){return Tr(e,t)+"000"}function Nr(e,t){return rr(e.getMonth()+1,t,2)}function Lr(e,t){return rr(e.getMinutes(),t,2)}function jr(e,t){return rr(e.getSeconds(),t,2)}function Er(e){var t=e.getDay();return 0===t?7:t}function Ir(e,t){return rr(xn.count(gn(e),e),t,2)}function Rr(e,t){var n=e.getDay();return e=n>=4||0===n?kn(e):kn.ceil(e),rr(kn.count(gn(e),e)+(4===gn(e).getDay()),t,2)}function Hr(e){return e.getDay()}function Br(e,t){return rr(wn.count(gn(e),e),t,2)}function zr(e,t){return rr(e.getFullYear()%100,t,2)}function Fr(e,t){return rr(e.getFullYear()%1e4,t,4)}function _r(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+rr(t/60|0,"0",2)+rr(t%60,"0",2)}function Vr(e,t){return rr(e.getUTCDate(),t,2)}function Ur(e,t){return rr(e.getUTCHours(),t,2)}function Wr(e,t){return rr(e.getUTCHours()%12||12,t,2)}function Kr(e,t){return rr(1+Wn.count(Gn(e),e),t,3)}function Gr(e,t){return rr(e.getUTCMilliseconds(),t,3)}function Yr(e,t){return Gr(e,t)+"000"}function Xr(e,t){return rr(e.getUTCMonth()+1,t,2)}function Jr(e,t){return rr(e.getUTCMinutes(),t,2)}function Zr(e,t){return rr(e.getUTCSeconds(),t,2)}function $r(e){var t=e.getUTCDay();return 0===t?7:t}function Qr(e,t){return rr(Rn.count(Gn(e),e),t,2)}function ei(e,t){var n=e.getUTCDay();return e=n>=4||0===n?Fn(e):Fn.ceil(e),rr(Fn.count(Gn(e),e)+(4===Gn(e).getUTCDay()),t,2)}function ti(e){return e.getUTCDay()}function ni(e,t){return rr(Hn.count(Gn(e),e),t,2)}function ri(e,t){return rr(e.getUTCFullYear()%100,t,2)}function ii(e,t){return rr(e.getUTCFullYear()%1e4,t,4)}function oi(){return"+0000"}function ai(){return"%"}function ui(e){return+e}function si(e){return Math.floor(+e/1e3)}!function(e){Zn=function(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,u=e.months,s=e.shortMonths,l=or(i),c=ar(i),f=or(o),d=ar(o),m=or(a),h=ar(a),p=or(u),g=ar(u),y=or(s),v=ar(s),b={a:function(e){return a[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return s[e.getMonth()]},B:function(e){return u[e.getMonth()]},c:null,d:Dr,e:Dr,f:Pr,H:Or,I:Ar,j:Cr,L:Tr,m:Nr,M:Lr,p:function(e){return i[+(e.getHours()>=12)]},Q:ui,s:si,S:jr,u:Er,U:Ir,V:Rr,w:Hr,W:Br,x:null,X:null,y:zr,Y:Fr,Z:_r,"%":ai},M={a:function(e){return a[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return s[e.getUTCMonth()]},B:function(e){return u[e.getUTCMonth()]},c:null,d:Vr,e:Vr,f:Yr,H:Ur,I:Wr,j:Kr,L:Gr,m:Xr,M:Jr,p:function(e){return i[+(e.getUTCHours()>=12)]},Q:ui,s:si,S:Zr,u:$r,U:Qr,V:ei,w:ti,W:ni,x:null,X:null,y:ri,Y:ii,Z:oi,"%":ai},x={a:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.w=h[r[0].toLowerCase()],n+r[0].length):-1},A:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=d[r[0].toLowerCase()],n+r[0].length):-1},b:function(e,t,n){var r=y.exec(t.slice(n));return r?(e.m=v[r[0].toLowerCase()],n+r[0].length):-1},B:function(e,t,n){var r=p.exec(t.slice(n));return r?(e.m=g[r[0].toLowerCase()],n+r[0].length):-1},c:function(e,n,r){return S(e,t,n,r)},d:gr,e:gr,f:wr,H:vr,I:vr,j:yr,L:xr,m:pr,M:br,p:function(e,t,n){var r=l.exec(t.slice(n));return r?(e.p=c[r[0].toLowerCase()],n+r[0].length):-1},Q:Sr,s:kr,S:Mr,u:sr,U:lr,V:cr,w:ur,W:fr,x:function(e,t,r){return S(e,n,t,r)},X:function(e,t,n){return S(e,r,t,n)},y:mr,Y:dr,Z:hr,"%":qr};function w(e,t){return function(n){var r,i,o,a=[],u=-1,s=0,l=e.length;for(n instanceof Date||(n=new Date(+n));++u<l;)37===e.charCodeAt(u)&&(a.push(e.slice(s,u)),null!=(i=Qn[r=e.charAt(++u)])?r=e.charAt(++u):i="e"===r?" ":"0",(o=t[r])&&(r=o(n,i)),a.push(r),s=u+1);return a.push(e.slice(s,u)),a.join("")}}function q(e,t){return function(n){var r,i,o=Jn(1900);if(S(o,e,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("p"in o&&(o.H=o.H%12+12*o.p),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=Xn(Jn(o.y))).getUTCDay(),r=i>4||0===i?Hn.ceil(r):Hn(r),r=Wn.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=t(Jn(o.y))).getDay(),r=i>4||0===i?wn.ceil(r):wn(r),r=Cn.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?Xn(Jn(o.y)).getUTCDay():t(Jn(o.y)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,Xn(o)):t(o)}}function S(e,t,n,r){for(var i,o,a=0,u=t.length,s=n.length;a<u;){if(r>=s)return-1;if(37===(i=t.charCodeAt(a++))){if(i=t.charAt(a++),!(o=x[i in Qn?t.charAt(a++):i])||(r=o(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=w(n,b),b.X=w(r,b),b.c=w(t,b),M.x=w(n,M),M.X=w(r,M),M.c=w(t,M),{format:function(e){var t=w(e+="",b);return t.toString=function(){return e},t},parse:function(e){var t=q(e+="",Yn);return t.toString=function(){return e},t},utcFormat:function(e){var t=w(e+="",M);return t.toString=function(){return e},t},utcParse:function(e){var t=q(e,Xn);return t.toString=function(){return e},t}}}(e),Zn.format,Zn.parse,$n=Zn.utcFormat,Zn.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var li=function(e,t){var n,r=0,i=(e=e.slice()).length-1,o=e[r],a=e[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),e[r]=t.floor(o),e[i]=t.ceil(a),e},ci=1e3,fi=60*ci,di=60*fi,mi=24*di,hi=7*mi,pi=30*mi,gi=365*mi;function yi(e){return new Date(e)}function vi(e){return e instanceof Date?+e:+new Date(+e)}function bi(e,t,n,r,i,o,a,u,s){var l=Rt(Pt,Pt),c=l.invert,f=l.domain,d=s(".%L"),m=s(":%S"),h=s("%I:%M"),p=s("%I %p"),g=s("%a %d"),y=s("%b %d"),v=s("%B"),b=s("%Y"),M=[[a,1,ci],[a,5,5*ci],[a,15,15*ci],[a,30,30*ci],[o,1,fi],[o,5,5*fi],[o,15,15*fi],[o,30,30*fi],[i,1,di],[i,3,3*di],[i,6,6*di],[i,12,12*di],[r,1,mi],[r,2,2*mi],[n,1,hi],[t,1,pi],[t,3,3*pi],[e,1,gi]];function x(u){return(a(u)<u?d:o(u)<u?m:i(u)<u?h:r(u)<u?p:t(u)<u?n(u)<u?g:y:e(u)<u?v:b)(u)}function w(t,n,r,i){if(null==t&&(t=10),"number"==typeof t){var o=Math.abs(r-n)/t,a=Ie(function(e){return e[2]}).right(M,o);a===M.length?(i=je(n/gi,r/gi,t),t=e):a?(i=(a=M[o/M[a-1][2]<M[a][2]/o?a-1:a])[1],t=a[0]):(i=Math.max(je(n,r,t),1),t=u)}return null==i?t:t.every(i)}return l.invert=function(e){return new Date(c(e))},l.domain=function(e){return arguments.length?f(Dt.call(e,vi)):f().map(yi)},l.ticks=function(e,t){var n,r=f(),i=r[0],o=r[r.length-1],a=o<i;return a&&(n=i,i=o,o=n),n=(n=w(e,i,o,t))?n.range(i,o+1):[],a?n.reverse():n},l.tickFormat=function(e,t){return null==t?x:s(t)},l.nice=function(e,t){var n=f();return(e=w(e,n[0],n[n.length-1],t))?f(li(n,e)):l},l.copy=function(){return It(l,bi(e,t,n,r,i,o,a,u,s))},l}var Mi=hn(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}),xi=Mi,wi=(Mi.range,hn(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getUTCHours()})),qi=wi,Si=(wi.range,hn(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*vn)},function(e,t){return(t-e)/vn},function(e){return e.getUTCMinutes()})),ki=Si,Di=(Si.range,function(){return Ht.apply(bi(Gn,xi,Rn,Wn,qi,ki,Ln,En,$n).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),Oi=86400,Ai=864e5;function Ci(e){return new Date(Date.UTC(1899,11,30+Math.floor(e),0,0,0,Math.round(Ai*(e-Math.floor(e)))))}var Ti=Ci(0).getTime();function Pi(e){return(e.getTime()-Ti)/Oi/1e3}var Ni=new Date,Li=new Date;function ji(e,t,n,r){function i(t){return e(t=new Date(+t)),t}return i.floor=i,i.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},i.round=function(e){var t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},i.range=function(n,r,o){var a,u=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return u;do{u.push(a=new Date(+n)),t(n,o),e(n)}while(a<n&&n<r);return u},i.filter=function(n){return ji(function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})},n&&(i.count=function(t,r){return Ni.setTime(+t),Li.setTime(+r),e(Ni),e(Li),Math.floor(n(Ni,Li))},i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?function(t){return r(t)%e==0}:function(t){return i.count(0,t)%e==0}):i:null}),i}var Ei=6048e5,Ii=ji(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/864e5},function(e){return e.getUTCDate()-1}),Ri=Ii,Hi=(Ii.range,ji(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+1e3*t)},function(e,t){return(t-e)/1e3},function(e){return e.getUTCSeconds()})),Bi=Hi,zi=(Hi.range,ji(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+6e4*t)},function(e,t){return(t-e)/6e4},function(e){return e.getUTCMinutes()})),Fi=zi,_i=(zi.range,ji(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getUTCHours()})),Vi=_i;_i.range;function Ui(e){return ji(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/Ei})}var Wi=Ui(0),Ki=Ui(1),Gi=Ui(2),Yi=Ui(3),Xi=Ui(4),Ji=Ui(5),Zi=Ui(6),$i=(Wi.range,Ki.range,Gi.range,Yi.range,Xi.range,Ji.range,Zi.range,ji(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()})),Qi=$i,eo=($i.range,ji(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()}));eo.every=function(e){return isFinite(e=Math.floor(e))&&e>0?ji(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null};var to=eo,no=(eo.range,{second:1,minute:2,hour:3,day:4,month:5,year:6});function ro(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function io(e){var t,n=e.timeScale,r=e.labels,i=e.distance,o=e.isDayOrShorter,a=e.cache,u=ro(n.domain(),2),s=u[0],l=u[1],c=a.key({distance:i});a.get(c,1)?t=a.get(c,1):(t=function(e,t,n,r,i){var o=Bi.count(e,t),a=Fi.count(e,t),u=Vi.count(e,t),s=Ri.count(e,t),l=Wi.count(e,t),c=Qi.count(e,t),f=to.count(e,t),d=n/r.second.width-1,m=n/r.minute.width-1,h=n/r.date.width-1,p=n/r.year.width-1,g={type:"year",desc:"year",count:f,interval:to.every(1),formatter:r.year.formatter};return o<=d?(g.type=no.second,g.desc="second",g.count=o,g.interval=Bi.every(1),g.formatter=r.second.formatter):o/2<=d?(g.type=no.second,g.desc="every other second",g.count=o/2,g.interval=Bi.every(2),g.formatter=r.second.formatter):o/5<=d?(g.type=no.second,g.desc="every 5 second",g.count=o/5,g.interval=Bi.every(5),g.formatter=r.second.formatter):o/15<=d?(g.type=no.second,g.desc="every 15 second",g.count=o/15,g.interval=Bi.every(15),g.formatter=r.second.formatter):o/30<=d?(g.type=no.second,g.desc="every 30 second",g.count=o/30,g.interval=Bi.every(30),g.formatter=r.second.formatter):a<=m?(g.type=no.minute,g.desc="minute",g.count=a,g.interval=Fi.every(1),g.formatter=r.minute.formatter):a/2<=m?(g.type=no.minute,g.desc="every 2 minute",g.count=a/2,g.interval=Fi.every(2),g.formatter=r.minute.formatter):a/5<=m?(g.type=no.minute,g.desc="every 5 minute",g.count=a/5,g.interval=Fi.every(5),g.formatter=r.minute.formatter):a/10<=m?(g.type=no.minute,g.desc="every 10 minute",g.count=a/10,g.interval=Fi.every(10),g.formatter=r.minute.formatter):a/15<=m?(g.type=no.minute,g.desc="every 15 minute",g.count=a/15,g.interval=Fi.every(15),g.formatter=r.minute.formatter):a/30<=m?(g.type=no.minute,g.desc="every 30 minute",g.count=a/30,g.interval=Fi.every(30),g.formatter=r.minute.formatter):u<=m?(g.type=no.hour,g.desc="hour",g.count=u,g.interval=Vi.every(1),g.formatter=r.minute.formatter):u/2<=m?(g.type=no.hour,g.desc="every 2 hour",g.count=u/2,g.interval=Vi.every(2),g.formatter=r.minute.formatter):u/3<=m?(g.type=no.hour,g.desc="every 3 hour",g.count=u/3,g.interval=Vi.every(3),g.formatter=r.minute.formatter):u/6<=m?(g.type=no.hour,g.desc="every 6 hour",g.count=u/6,g.interval=Vi.every(6),g.formatter=r.minute.formatter):u/12<=m||i?(g.type=no.hour,g.desc="every 12 hour",g.count=u/12,g.interval=Vi.every(12),g.formatter=r.minute.formatter):s<=h?(g.type=no.day,g.desc="day",g.count=s,g.interval=Ri.every(1),g.formatter=r.date.formatter):s/2<=h?(g.type=no.day,g.desc="every 2 day",g.count=s/2,g.interval=Ri.every(2),g.formatter=r.date.formatter):s/3<=h?(g.type=no.day,g.desc="every 3 day",g.count=s/3,g.interval=Ri.every(3),g.formatter=r.date.formatter):l<=h?(g.type=no.day,g.desc="week",g.count=l,g.interval=Wi.every(1),g.formatter=r.date.formatter):l/2<=h?(g.type=no.day,g.desc="every 2 week",g.count=l/2,g.interval=Wi.every(2),g.formatter=r.date.formatter):c<=h?(g.type=no.month,g.desc="month",g.count=c,g.interval=Qi.every(1),g.formatter=r.date.formatter):c/3<=h?(g.type=no.month,g.desc="quarter",g.count=c/3,g.interval=Qi.every(3),g.formatter=r.date.formatter):c/6<=h?(g.type=no.month,g.desc="half year",g.count=c/6,g.interval=Qi.every(6),g.formatter=r.date.formatter):f<=p?(g.type=no.year,g.desc="year",g.count=f,g.interval=to.every(1),g.formatter=r.year.formatter):f/2<=p?(g.type=no.year,g.desc="every 2 year",g.count=f/2,g.interval=to.every(2),g.formatter=r.year.formatter):f/5<=p?(g.type=no.year,g.desc="every 5 year",g.count=f/5,g.interval=to.every(5),g.formatter=r.year.formatter):f/10<=p?(g.type=no.year,g.desc="every 10 year",g.count=f/10,g.interval=to.every(10),g.formatter=r.year.formatter):(g.type=no.year,g.desc="every nth year",g.count=Math.floor(f/p),g.interval=to.every(Math.floor(f/p)),g.formatter=r.year.formatter),g}(s,l,i,r.all(),o),a.set(c,t,1));var f=n.ticks(t.interval).map(function(e,n,r){var i=r[n+1]?r[n+1]-e:l-e;return{start:e,end:new Date(e.getTime()+i),formatter:t.formatter}}),d=[];if(t.type<=no.hour){var m=r.getFormat("date"),h=n.ticks(Ri.every(1));d=(h.length?h:[s]).map(function(e,t,n){var r=n[t+1]?n[t+1]-e:l-e;return{start:e,end:new Date(e.getTime()+r),formatter:m.formatter}})}return{inner:f,outer:d}}function oo(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var ao=86400,uo=1440,so={};function lo(e,t,n,r){return{type:e,start:new Date(Date.UTC.apply(Date,oo(t))),end:new Date(Date.UTC.apply(Date,oo(n))),formatter:r}}function co(e){return(co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function mo(e,t,n){var r=t.ticks,i=r.generator,o=r.anchor,a=r.clamp,u=r.level,s=t.formatter.qNumFormat,l=fo(e.domain(),2),c=l[0],f=l[1],d=Di().domain([Ci(c),Ci(f)]);d.clamp(a),d.range(t.invert?[1,0]:[0,1]);var m,h="object"===co(i)?i.type:i;m="d3"===h?function(e,r){return io({timeScale:d,labels:n,distance:e,isDayOrShorter:r,cache:t.cache})}:function(e){return function(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(so[[t,n,r,r,o]])return so[[t,n,r,r,o]];var a,u,s,l={year:e.getFormat("year"),date:e.getFormat("date"),minute:e.getFormat("minute"),second:e.getFormat("second")},c=Ci(n),f=c.getFullYear(),d=c.getMonth(),m=c.getDate(),h=r-n,p=t/(i-r),g=p/1440,y=p/ao,v=366*p,b=3*p*30,M=l.second.width/y,x=l.minute.width/g,w=l.date.width/b,q=l.year.width/v,S=0,k=0,D=null,O=null,A=null,C=null,T=null,P=null,N={outer:[],inner:[]};for(M<1?(D=1,k=1/ao):M<2?(D=2,k=1/ao*2):M<5?(D=5,k=1/ao*5):M<10?(D=10,k=1/ao*10):M<30?(D=30,k=1/ao*30):x<1?(O=1,k=1/uo):x<2?(O=2,k=1/uo*2):x<5?(O=5,k=1/uo*5):x<10?(O=10,k=1/uo*10):x<30?(O=30,k=1/uo*30):x<60?(A=1,k=1/24):x<120?(A=2,k=2/24):x<360?(A=6,k=.25):x<720?(A=12,k=.5):w<1/90?(k=1,C=1):w<2/90?(k=2,C=2):w<7/90?(k=7,C=7):w<31/90?(T=1,k=31):w<1?(T=3,k=90):q<1?(P=1,k=366):q<2?(P=2,k=732):q<5?(P=5,k=1826.25):(P=10,k=3652.5),u=Math.floor((h+n%1)/k);S<i;){s=u+1,S=Pi((a=P?lo("year",[f+u*P,0,1],[f+s*P,0,1],l.year.formatter):T?lo("month",[f,d+u*T,1],[f,d+s*T,1],l.date.formatter):C?lo("day",[f,d,m+u*C],[f,d,m+s*C],l.date.formatter):A?lo("hour",[f,d,m,0+u*A],[f,d,m,0+s*A],l.minute.formatter):O?lo("minute",[f,d,m,0,0+u*O],[f,d,m,0,0+s*O],l.minute.formatter):lo("second",[f,d,m,0,0,0+u*D],[f,d,m,0,0,0+s*D],l.second.formatter)).start),N.inner.push(a);var L=Math.floor(S);if(!(o||P||T||C)){var j={type:"day",start:Ci(L),end:Ci(L+1),formatter:l.date.formatter,qStart:L};N.outer[N.outer.length-1]&&N.outer[N.outer.length-1].qStart===j.qStart||N.outer.push(j)}u++}return N.min=r,N.max=i,so[[t,n,r,r,o]]=N,N}(n,e,i.min,c,f,"T"===s.qType)};var p={transform:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).isMinor,r=void 0!==n&&n;return t.map(function(t){var n;n="start"===o?t.qStart:"end"===o?t.qEnd:(t.qStart+t.qEnd)/2;var i=e.clamp();r&&e.clamp(!1);var a=e(n),u=e(t.qStart),s=e(t.qEnd);return e.clamp(i),{value:n,position:a,start:u,end:s,label:t.qText,isMinor:r,data:r?void 0:{start:t.qStart,end:t.qEnd,scaleStart:e.domain()[0]}}}).filter(function(e){return e.position>=0&&e.position<=1})},generate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1?arguments[1]:void 0;return m(t,n)[u].map(function(t){var n;return n="start"===o?Pi(t.start):"end"===o?Pi(t.end):(Pi(t.start)+Pi(t.end))/2,{position:d(t.start),start:d(t.start),end:d(t.end),value:n,label:t.formatter(n),isMinor:!1,data:{start:Pi(t.start),end:Pi(t.end),scaleStart:e.domain()[0]}}}).filter(function(e){return e.position>=0&&e.position<=1})}};return p}var ho=41000.2343433,po=/t+/i,go=16,yo=60;function vo(e){return(vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bo(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Mo={min:NaN,max:NaN,invert:!1,qAxis:[],field:void 0,formatter:{fn:function(){return function(e){return e}},measureText:function(){return{width:0,height:0}},localeInfo:{},qNumFormat:{}},ticks:{generator:"d3",level:"outer",anchor:void 0,clamp:!1},cache:{get:function(){return!1},set:function(){},key:function(){return""}}};function xo(e,t){e.instance||(e.instance=t.copy(),e.instance.domain(t.domain()),e.instance.clamp(!0),e.instance.range(e.invert?[1,0]:[0,1]))}var wo={model:function(e){var t,n,r,i=e.model,o=e.layoutModel,a=e.viewCache,u=e.viewState,s=e.resources.Promise,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=l.engineFetcherFactory,f=void 0===c?ee:c,d=l.snapshotFetcherFactory,m=void 0===d?ne:d,h=l.cacheFetcherFactory,p=void 0===h?te:h,y=l.cache,v=void 0===y?{initial:{},merged:{}}:y,b=f({model:i,layoutModel:o}),M=m({layoutModel:o,viewCache:a,Promise:s}),x=p({Promise:s},{cache:v});return{update:function(e){var i,s,l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.qMin,n=e.qMax;return{initialMin:t=Number.isNaN(+t)?0:t,initialMax:n=Number.isNaN(+n)?0:n}}(e.qHyperCube.qDimensionInfo[0]);if(n=l.initialMin,r=l.initialMax,a.set("continuousMin",n),a.set("continuousMax",r),a.set("minimiumZoomSpan",(i=n,s=r,Math.max(he,(s-i)*pe))),t=o.meta.isSnapshot?M:b,o.meta.isSnapshot){var c=M.getSnapshotData().zoom;n=c.min,r=c.max}u.preventSet("zoom",{min:n,max:r})},updateLayout:function(e){var t=e.qDataPages,n=e.qAxisData;return o.setLayoutValue("qHyperCube.qDataPages",t),o.setLayoutValue("qHyperCube.qAxisData",n),o.setLayoutValue("qHyperCube.qMode","S"),e},initialFetch:function(){var e=this;return t.fetch(n,r).then(function(e){var t=fe(e);return v.initial=t,v.merged=t,e}).then(function(e){return oe(n,r,e)}).then(function(t){return e.updateLayout(t)})},fetch:function(e,n){return t.fetch(e,n).then(function(e){return le(v.initial,e)}).then(function(e){return v.merged=e,e}).then(function(t){return oe(e,n,t)})},fetchFromCache:function(e,t){return x.fetch(e,t).then(function(n){return oe(e,t,n)})},fetchMinMaxData:function(){return s.resolve(v.initial.qDataPages)},getInitialCube:function(){var e=o.getLayoutValue("qHyperCube");return g()({},e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){ve(e,t,n[t])})}return e}({},v.initial))},getInitialLayout:function(){var e=this.getInitialCube();return g()({},o.getLayout(),{qHyperCube:e})},getDimensionCardinality:function(){return ye(v.initial,o.meta)},setSnapshotData:function(e){var t=e.qHyperCube;t.qDataPages=v.merged.qDataPages,t.qAxisData=v.merged.qAxisData}}},event:{onZoomChange:function(e,t){var n=e.layoutModel,r=e.continuousDataModel,i=e.resources;function o(e,n,i){return r[e](n,i).then(function(e){return r.updateLayout(e),t(),e})}var a,u,s,l=(a=function(e,t){return o("fetch",e,t)},u=50,function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];clearTimeout(s),s=setTimeout(function(){return a.apply(e,n)},u)});return function(e,t){var r=e.min,a=e.max,u=t.min,s=t.max;return!n.meta.isContinuous||r===u&&a===s?i.Promise.resolve(null):o("fetchFromCache",r,a).then(function(e){return l(r,a),e})}},onZoomIntercept:function(e){var t=e.viewCache,n=NaN,r=NaN,i=NaN;return function(e,o){return n=t.get("continuousMin"),r=t.get("continuousMax"),i=t.get("minimiumZoomSpan"),Math.abs(e.max-e.min)<i?o:{min:Math.min(e.max,Math.max(n,e.min)),max:Math.max(e.min,Math.min(r,e.max))}}},onZoom:function(e,t){var n=e.viewCache,r=e.viewState,i=e.chart,o=t.threshold,a=void 0===o?50:o,u=t.rtl,s=void 0!==u&&u,l=t.targetKey,c=n.get("continuousMin"),f=n.get("continuousMax");return y(function(e,t){var n=function(e){return i.componentsFromPoint(e).filter(function(e){return e.key===l})[0]}(e);if(n){var o=function(e,t,n){var r=e.x;return r-=t.element.getBoundingClientRect().left,r-=n.rect.x,Math.max(0,Math.min(1,r/n.rect.width))}(e,i,n),a=s?1-o:o,u=r.get("zoom"),d=u.min,m=u.max,h=Math.abs(m-d),p=h-(t>0?me:de)*h,g=d+p*a,y=m-p*(1-a),v=g<c?c-g:0,b=y>f?y-f:0;r.set("zoom",{min:Math.max(g-b,c),max:Math.min(y+v,f)})}},a)}},picassoComponents:{axisOverlay:Me,timeAxis:Ae},picassoScales:{time:function e(t){var n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=function(e,t,n){var r={};return Object.keys(t).forEach(function(i){var o=e[i],a=vo(o);"function"===a?r[i]=o(n):"object"!==a||Array.isArray(o)?r[i]="undefined"===a?t[i]:o:r[i]=g()(!0,{},t[i],o)}),r}(t,Mo,i),a=o.qAxis,u=en(),s={instance:null,invert:!1},l=function(e,t){var n=+e.min,r=+e.max;return Number.isNaN(n)&&Number.isNaN(r)&&Array.isArray(t)&&t.length&&(n=Math.min.apply(Math,bo(t[t.length-1].qTicks.map(function(e){return e.qStart}))),r=Math.max.apply(Math,bo(t[t.length-1].qTicks.map(function(e){return e.qEnd})))),n===r&&(n-=.5,r+=.5),{min:Number.isNaN(+n)?0:n,max:Number.isNaN(+r)?1:r}}(o,a),c=l.min,f=l.max,d=[],m=function(e){return Number.isNaN(+e)?NaN:u(e)};m.ticks=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.distance,i=e.resolve,u=(void 0===i?n.resolve:i)(t),s=u[o.ticks.level];if(Number.isNaN(+s)||(d=r.transform(a[s].qTicks,{isMinor:!1})),!Number.isNaN(+u.minor)){var l=r.transform(a[u.minor].qTicks,{isMinor:!0});d=d.concat(l)}return"auto"===s&&(d=r.generate(t,u.isDayOrShorter)),d},m.invert=function(e){return u.invert(e)},m.domain=function(e){return Array.isArray(e)?u.domain(e):u.domain()},m.range=function(e){return Array.isArray(e)?u.range(e):u.range()},m.norm=function(e){return xo(s,m),s.instance(e)},m.normInvert=function(e){return xo(s,m),s.instance.invert(e)},m.copy=function(){return e(t,i)},m.clamp=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return u.clamp(e),u.clamp()},m.min=function(){return Math.min(c,f)},m.max=function(){return Math.max(c,f)},u.range(o.invert?[1,0]:[0,1]),u.domain([c,f]),u.clamp(o.ticks.clamp),s.invert=o.invert;var h=function(e){var t={},n=e.formatter,r=n.measureText,i=n.fn,o=n.localeInfo,a={second:{type:"second",pattern:"hh:mm:ss",width:yo,formatter:void 0},minute:{type:"minute",pattern:"hh:mm",width:yo,formatter:void 0},date:{type:"date",pattern:"YYYY-MM-DD",width:yo,formatter:void 0},year:{type:"year",pattern:"YYYY",width:yo,formatter:void 0}};return o&&po.test(o.qTimestampFmt)&&(a.minute.pattern+=" tt",a.second.pattern+=" tt"),a.date.pattern=o&&o.qDateFmt?o.qDateFmt:a.date.pattern,Object.keys(a).forEach(function(e){a[e].formatter=i(a[e].pattern),a[e].width=Math.max(a[e].width,r(a[e].formatter(ho)).width+go)}),t.getFormat=function(e){return a[e]},t.all=function(){return a},t.getFormatFromTicks=function(e){var t=e.filter(function(e){return!e.isMinor}),n=t.length;if(!n)return a.date;var r=Ci(t[0].data.start),i=Ci(t[n-1].data.start);return Ri.count(r,i)/n>=1?a.date:Vi.count(r,i)/n>0?a.minute:Fi.count(r,i)/n>0?a.second:a.date},t}(o);return r=mo(u,o,h),n=fn({qAxis:a,measureText:o.formatter.measureText,reqAutoFitWidth:2*h.getFormat("minute").width,cache:o.cache,scale:m}),m.data=function(){return{fields:[{formatter:m.formatter,id:function(){return"qHyperCube/".concat(o.field)},key:function(){return o.field}}]}},m.formatter=function(){return h.getFormatFromTicks(d).formatter},m}}};var qo=function(e){var t=b.getValue(e,"qHyperCube.qDimensionInfo.0.qCardinalities.qHypercubeCardinal",void 0);if(t)return t;var n=b.getValue(e,"qHyperCube.qDimensionInfo.0.qStateCounts");return n.qLocked+n.qOption+n.qSelected};function So(e){switch(e.qHyperCube.qMode){case"S":default:return function(e){return{refs:{dataPages:"qHyperCube.qDataPages"},size:{x:b.getValue(e,"qHyperCube.qSize.qcx"),y:b.getValue(e,"qHyperCube.qSize.qcy")}}}(e);case"K":return function(e){return{refs:{dataPages:"qHyperCube.qStackedDataPages"},size:{x:b.getValue(e,"qHyperCube.qSize.qcx"),y:qo(e)}}}(e);case"T":return{refs:{dataPages:"qHyperCube.qTreeDataPages"},size:{x:0,y:0}}}}function ko(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Do(e){var t=e.layout,n=e.additionsFn,r=void 0===n?function(){return{}}:n,i=e.additionsProps,o=void 0===i?{}:i,a=t.qHyperCube,u=a.qDimensionInfo.length,s=a.qMeasureInfo.length;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){ko(e,t,n[t])})}return e}({dimensionCount:u,measureCount:s,hasMultipleDimensions:u>1,hasMultipleMeasures:s>1},r(t),o)}function Oo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Ao(e,t,n[t])})}return e}function Ao(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Co={getDockValue:function(e){return"near"===e||"left"===e||"top"===e?0:1},getOppositeDock:function(e){switch(e){case"left":return"right";case"right":return"left";case"top":return"bottom";case"bottom":return"top";case"near":return"far";case"far":return"near";default:return"far"}},getHorizontalDock:function(e){return"near"===e||"left"===e?"left":"right"},getVerticalDock:function(e){return"near"===e||"bottom"===e?"bottom":"top"},getDock:function(e,t,n){return"vertical"===e||"y"===e?Co.getVerticalDock(t):n?Co.getOppositeDock(Co.getHorizontalDock(t)):Co.getHorizontalDock(t)},getInvertedOrientation:function(e){return"vertical"===e?"horizontal":"vertical"},getMinorScaleAxis:function(e){return"vertical"===e?"y":"x"},getMajorScaleAxis:function(e){return"vertical"===e?"x":"y"},getAlignment:function(e,t){switch(e){case"vertical":return"near"===t||"bottom"===t?1:0;default:return"near"===t||"left"===t?0:1}},getMeasureScaleInvert:function(e,t){return"vertical"===e||t},getDimensionScaleInvert:function(e,t){return"horizontal"===e&&t},getSize:function(e,t){var n=t.width,r=t.height;return"vertical"===e?n:r}},To=Co;function Po(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var No=[["FULL",{width:550,height:450}],["MEDIUM",{width:400,height:220}],["SMALL",{width:300,height:150}],["XSMALL",{width:150,height:75}],["SPARK",{width:0,height:0}]],Lo={};No.forEach(function(e){var t=Po(e,2),n=t[0],r=t[1],i=r.width,o=r.height;Lo[n]={width:i,height:o}});var jo={getLayoutModes:function(){return Lo},getLayoutMode:function(e,t){var n;for(n=0;n<No.length;++n)if(e>=No[n][1].width&&t>=No[n][1].height)return No[n][0];return"SPARK"}};function Eo(e,t){if(t)return t;var n=e?e.element.getBoundingClientRect():{};return{width:n.width,height:n.height}}var Io=["$date","$timestamp","$time"],Ro=["D","TS","T"],Ho={hasTimeTag:function(e){return!!(e&&e.qTags&&e.qTags.some(function(e){return Io.some(function(t){return t===e})}))},hasTimeFormat:function(e){return!!(e&&e.qNumFormat&&Ro.some(function(t){return t===e.qNumFormat.qType}))},isTimeDimension:function(e,t){return!(!e||!t||!Ho.hasTimeTag(t)&&!Ho.hasTimeFormat(t))},isTime:function(e,t){return!!(t&&t.qHyperCube.qDimensionInfo&&t.qHyperCube.qDimensionInfo.length)&&e&&Ho.isTimeDimension(e,t.qHyperCube.qDimensionInfo[0])},canBeContinuousDimension:function(e){if(!e)return!1;var t=e.qTags||[];return!(!e.qContinuousAxes||!t.some(function(e){return"$numeric"===e}))},canBeContinuous:function(e){return!(!(e&&e.qHyperCube&&e.qHyperCube.qDimensionInfo)||e.qHyperCube.qDimensionInfo.length<1)&&Ho.canBeContinuousDimension(e.qHyperCube.qDimensionInfo[0])},maxNumberOfLines:12},Bo=Ho,zo={continuous:function(e){return!!Bo.canBeContinuous(e)&&(!e.dimensionAxis||!e.dimensionAxis.continuousAuto)&&!!e.preferContinuousAxis},dimensionless:function(e){return!e.qHyperCube.qDimensionInfo.length},grouped:function(e){return!this.dimensionless(e)&&e.barGrouping&&"grouped"===e.barGrouping.grouping&&(e.qHyperCube.qDimensionInfo.length>1||e.qHyperCube.qMeasureInfo.length>1)&&!this.continuous(e)},groupedByDimension:function(e){return this.grouped(e)&&e.qHyperCube.qDimensionInfo.length>1&&1===e.qHyperCube.qMeasureInfo.length},groupedByMeasure:function(e){return this.grouped(e)&&1===e.qHyperCube.qDimensionInfo.length&&e.qHyperCube.qMeasureInfo.length>1},stacked:function(e){return(!this.dimensionless(e)&&e.barGrouping&&"grouped"!==e.barGrouping.grouping||this.continuous(e))&&(e.qHyperCube.qDimensionInfo.length>1||e.qHyperCube.qMeasureInfo.length>1)},stackedByDimension:function(e){return this.stacked(e)&&e.qHyperCube.qDimensionInfo.length>1&&1===e.qHyperCube.qMeasureInfo.length},stackedByMeasure:function(e){return this.stacked(e)&&1===e.qHyperCube.qDimensionInfo.length&&e.qHyperCube.qMeasureInfo.length>1},simple:function(e){return 0===e.qHyperCube.qDimensionInfo.length||1===e.qHyperCube.qDimensionInfo.length&&1===e.qHyperCube.qMeasureInfo.length},snapshot:function(e){return!(!e||!e.snapshotData)}};function Fo(e){return(Fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _o(e){return e.filter(function(e){return"object"===Fo(e.data)&&Array.isArray(e.data.fields)}).every(function(e){return e.data.fields.every(function(e){return!!e.raw().qLocked})})}var Vo=function(e,t){var n=e.component(t);return n&&n._DO_NOT_USE_getInfo&&n._DO_NOT_USE_getInfo().offset},Uo={SPARK:{DEFAULT:7,SQUEEZE:7,LABELLESS:7},XSMALL:{DEFAULT:28,SQUEEZE:24,LABELLESS:20},SMALL:{DEFAULT:28,SQUEEZE:24,LABELLESS:20},MEDIUM:{DEFAULT:28,SQUEEZE:24,LABELLESS:20},FULL:{DEFAULT:28,SQUEEZE:24,LABELLESS:20}},Wo={COMPONENT:{BAR:"bar",STACK:"stack",BAR_AXIS:"bar-axis",GROUP_AXIS:"group-axis",BAR_OOB_MAX:"bar-oob-max",BAR_OOB_MIN:"bar-oob-min",STACK_TOTAL_BAR:"stack-total-bar",BASE_TOOLTIP:"tooltip",LEGEND_CAT_TOOLTIP:"legend-cat-tooltip",LEGEND_COLOR_CAT:"legend-color-cat"},COLLECTION:{MAIN:"main-collection",MINI:"mini-collection",MINI_STACK:"mini-stack-collection",MINI_CONTINUOUS:"mini-continuous-collection",STACK_SEGMENT:"stack-segment-collection",STACK_TOTAL:"stack-total-collection"}};function Ko(e,t){return{range:function(e){var n=e.resources,r=e.data,i=n.theme.palette("categorical",t);return r.items.map(function(e){return i[e.value%i.length]})},valueAccessor:e.value}}function Go(e,t){return{range:function(e){var n=e.resources,r=e.data,i=n.theme.palette("categorical",t);return r.items.map(function(e){return i[e.row.value%i.length]})},valueAccessor:e.value}}function Yo(e,t,n,r,i){var o=i.byRow,a=i.byElemNo;if(r&&(t.input.persistent||e.hc.qDimensionInfo.length>1||void 0===n.activeDimensionIndex&&e.hc.qSize.qcy>e.hc.qDataPages[0].qArea.qHeight))return a(r,r.raw().qCardinal);if(r){var u=t.pic.extract({field:r.key(),trackBy:r.value}).length;return o(r,u)}return{}}function Xo(e,t){var n=e.hc.qDimensionInfo,r=t.input.byDimDef||{activeDimensionIndex:n.length-1};if(r.activeDimensionIndex>=0){var i=n[r.activeDimensionIndex];r=i.coloring&&i.coloring.colorMapRef?{type:"libraryItem",key:i.coloring.colorMapRef,activeDimensionIndex:r.activeDimensionIndex}:{activeDimensionIndex:r.activeDimensionIndex}}return r}function Jo(e,t){var n;return t.activeDimensionIndex>=0?n=e.pic.fields().filter(function(e){return"dimension"===e.type()})[t.activeDimensionIndex]:"libraryItem"===t.type?n=t.key?e.pic.field(function(e){return e.raw().colorMapRef===t.key}):void 0:"expression"===t.type&&(n=e.pic.field(function(e){return"colorByAlternative"===e.raw().id})),n}var Zo=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r.getCDef,o=void 0===i?Xo:i,a=r.getCByField,u=void 0===a?Jo:a,s=r.getPersistence,l=void 0===s?Yo:s,c=o(t,n),f=u(n,c),d=f?f.raw():{},m=n&&n.pic?n.pic.raw():{};if(d.qError||d.qSize&&0===d.qSize.qcy&&!m.qHasOtherValues)return{invalid:!0};var h={mode:"field",fieldType:"dimension",type:"categorical",field:f?f.key():void 0};return("expression"===c.type||c.activeDimensionIndex<0)&&(h.label=c.label,"color.altLabel"===d.labelExpRef&&(h.label=n.input.altLabel)),!h.label&&f&&(h.label=f.title()),n.input.dimensionScheme&&(h.palettes={categorical:n.input.dimensionScheme}),n.input.useDimColVal&&"libraryItem"===c.type&&(h.auxiliary=c),g()(h,l(t,n,c,f,{byRow:Go,byElemNo:Ko})),h};function $o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Qo=/^class(-pyramid)?/,ea=function(e,t,n,r){var i=void 0!==n.min?n.min:r.min(),o=void 0!==n.max?n.max:r.max(),a=i,u=o,s=t.limits,l={},c="percent"===t.limitType?s.map(function(e){return i+(o-i)*e}):s,f=t.colors.map(function(t){return e.resolveUIColor(t)});if(i=Math.min.apply(Math,[i].concat($o(c))),o=Math.max.apply(Math,[o].concat($o(c))),l.min=i,l.max=o,t.breakTypes&&-1===t.breakTypes.indexOf(!0))l.type="categorical",Object.assign(l,function(e){var t=e.min,n=e.max,r=e.limits,i=e.range,o=[],a=[];if(r[r.length-1]<t)a.push(t,n),o.push(i[i.length-1],i[i.length-1],i[i.length-1]);else if(r[0]>n)a.push(t,n),o.push(i[0],i[0],i[0]);else{if(r[0]>t)a.push(t),o.push(i[0]);else{a.push(t);for(var u=0;u<r.length;u++)if(t<r[u]){o.push(i[u]);break}}for(var s=0;s<r.length;s++)t<r[s]&&r[s]<n&&(a.push(r[s]),o.push(i[s]));if(r[r.length-1]<n)a.push(n),o.push(i[r.length]),o.push(i[r.length]);else{a.push(n);for(var l=0;l<r.length;l++)if(r[l]>n){o.push(i[l]),o.push(i[l]);break}}}return{min:t,max:n,range:o,domain:a}}({min:"percent"===t.limitType?i:a,max:"percent"===t.limitType?o:u,range:f,limits:"percent"===t.limitType?c:s}));else if(t.breakTypes){var d=t.breakTypes;l.type="continuous",l.domain=[i],l.range=[f[0]];for(var m=0;m<c.length;m+=1)if(d[m]){var h=f[m],p=f[m+1],g=gt(h,p)(.5);l.range.push(g),l.domain.push(c[m]),m<c.length-1&&d[m+1]&&(l.range.push(f[m+1]),l.domain.push((c[m]+c[m+1])/2))}else l.range.push(f[m]),l.range.push(f[m+1]),l.domain.push(c[m]),l.domain.push(c[m]+Math.min(1e-6,(o-i)/1e6));l.range.push(f[f.length-1]),l.domain.push(o)}else l.domain=c,l.range=f;return l};var ta=function(e,t,n,r){var i,o,a=t.senseTheme,u=t.hc,s=r.f,l={mode:"field",fieldType:"measure",field:s?s.key():void 0,reverse:n.input.reverseScheme||!1,type:"continuous",range:function(e){return e.resources.theme.palette("quant")}},c=[],f=!0;if(s){if(Number.isNaN(+s.min())||Number.isNaN(+s.max()))return{invalid:!0};(f=!("S"===(i=n.pic.raw()).qMode&&i.qDataPages[0]&&i.qSize.qcy>i.qDataPages[0].qArea.qHeight||"K"===i.qMode&&i.qStackedDataPages[0]&&i.qSize.qcy>i.qStackedDataPages[0].qArea.qHeight))&&(c=n.pic.extract({field:0,props:{num:{field:s.key()},exclude:{fields:u.qDimensionInfo.map(function(e,t){return{field:"qDimensionInfo/".concat(t)}}),value:function(e){return Math.min.apply(Math,$o(e))<0}}}}).filter(function(e){return e.value>=0&&!e.exclude.value}).map(function(e){return e.num.value}).filter(function(e){return"number"==typeof e}))}if(!1===n.input.autoMinMax){if(l.min=n.input.measureMin,l.max=n.input.measureMax,l.max<l.min)return{invalid:!0}}else if(s&&!f)l.min=s.min(),l.max=s.max();else if(s){if(!c.length)return{invalid:!0};l.min=Math.min.apply(Math,$o(c)),l.max=Math.max.apply(Math,$o(c))}if(n.input.measureScheme&&(l.palettes={quant:n.input.measureScheme}),a&&a.properties.scales){var d=a.properties.scales.filter(function(e){return e.propertyValue===n.input.measureScheme})[0];l.type=d&&Qo.test(d.type)?"categorical":"continuous","categorical"===l.type&&(o=Math.max.apply(Math,$o(d.scale.map(function(e){return e?e.length:0}))))}if("categorical"===l.type){for(var m=f?function e(t,n,r,i,o){var a,u,s,l=0,c=[],f=(t-n)/(i+1);if(0===f)return 1;for(a=0;a<r.length;a+=1)u=.99*(r[a]-n),s=r[a]>t?Math.floor(t/f):r[a]<n?0:Math.floor(u/f),Number.isNaN(s)||(c[s]?c[s]+=1:c[s]=1);for(a=0;a<c.length;a+=1)c[a]&&(l+=1);return l<=i||l>=o?Math.max(l,i):e(t,n,r,i+1,o)}(l.max,l.min,c,1,o):o,h=(l.max-l.min)/m,p=[],g=0;g<m+1;g+=1)p.push(l.min+h*g);l.domain=p,l.range=function(e){for(var t=e.resources.theme.palette("quant",m),n=Math.max(1,Math.floor(t.length/m)),r=[],i=0;i<m;i+=1)r.push(t[i*n]);return[r[0]].concat(r,[r[r.length-1]])}}return l};function na(e,t){var n;return t.activeMeasureIndex>=0?n=e.pic.fields().filter(function(e){return"measure"===e.type()})[t.activeMeasureIndex]:"libraryItem"===t.type?n=e.pic.field(function(e){return e.raw().colorMapRef===t.key&&void 0!==t.key}):"expression"===t.type&&(n=e.pic.field(function(e){return"colorByAlternative"===e.raw().id})),n||(n=e.pic.field(function(e){return void 0!==e.raw().matchMeasure}))&&(n=e.pic.fields().filter(function(e){return"measure"===e.type()})[n.raw().matchMeasure]),n}var ra=function(e,t,n){var r=t.senseTheme,i=t.hc,o=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).getCField,a=void 0===o?na:o,u=n.input.byMeasureDef||{activeMeasureIndex:0},s=a(n,u),l=ta(0,{senseTheme:r,hc:i},n,{f:s});if(l.invalid)return l;("expression"===u.type||u.activeMeasureIndex<0)&&(l.label=u.label,s&&"color.altLabel"===s.raw().labelExpRef&&(l.label=n.input.altLabel)),!l.label&&s&&(l.label=s.title());var c=u.activeMeasureIndex>=0?s:null;if(!c&&s&&void 0!==s.raw().matchMeasure&&s.raw().matchMeasure>-1&&(c=n.pic.fields().filter(function(e){return"measure"===e.type()})[s.raw().matchMeasure],l.field=c.key()),n.input.useMeasureGradient&&"libraryItem"===u.type)if(c){var f=c.raw().coloring;f&&f.gradient&&g()(l,ea(e,f.gradient,l,c))}else l.auxiliary=u;return l},ia=function(e,t,n,r){var i=t.hc,o=t.senseTheme,a=t.translator,u=n.pic.field(function(e){return"colorByExpression"===e.raw().id});if(!(u&&u.raw().qFallbackTitle&&Number.isFinite(u.raw().qMin)&&Number.isFinite(u.raw().qMax))&&!n.input.expressionIsColor)return{mode:"constant",type:"constant",primary:r.nil};if(n.input.expressionIsColor)return{mode:"field",fieldType:"expression",field:u?u.key():void 0,type:"color"};var s=ta(0,{hc:i,senseTheme:o},n,{f:u});return s.invalid?s:(s.label=n.input.expressionLabel||a.get("Object.ChartTooltip.ColorExpression"),s)},oa=function(e,t,n,r){var i=t.hc,o=t.senseTheme,a=t.translator,u=n.input.useBaseColors;if(("byMultiple"===n.input.mode||"primary"===n.input.mode&&"measure"===n.input.useBaseColors)&&i.qMeasureInfo.length>1&&(u="measure"),"measure"===u){var s=[],l=[];"measure"===n.input.useBaseColors&&i.qMeasureInfo.forEach(function(t,n){if(t.baseColor||t.coloring&&t.coloring.baseColor){s.push(n);var i=e.resolveUIColor(t.baseColor||t.coloring.baseColor);"none"===i?l.push(r.primary):l.push(i)}});var c=n.input.dimensionScheme?{categorical:n.input.dimensionScheme}:void 0;return"measure"===n.input.useBaseColors&&o&&o.properties.palettes&&o.properties.palettes.data[0]&&(c={categorical:o.properties.palettes.data[0].propertyValue}),{mode:"measure",type:"categorical",palettes:c,label:a?a.get("Common.Measures"):void 0,explicit:s.length?{domain:s,range:l}:void 0}}if("dimension"===u){var f=[],d=[];return i.qDimensionInfo.forEach(function(t,n){if(t.baseColor||t.coloring&&t.coloring.baseColor){f.push(n);var i=e.resolveUIColor(t.baseColor||t.coloring.baseColor);"none"===i?d.push(r.primary):d.push(i)}}),{mode:"dimension",type:"categorical",field:f.length?f[0]:void 0,explicit:f.length?{domain:f,range:d}:void 0}}var m=r.primary;return void 0!==n.input.paletteColor?n.input.paletteColor&&(m=e.resolveUIColor(n.input.paletteColor)):void 0!==n.input.singleColor&&void 0!==n.input.singleColor&&(m=e.resolveUIColor({index:n.input.singleColor})),{mode:"constant",type:"constant",primary:m}};function aa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ua=function(e,t,n,r){var i=r.external,o=r.field,a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){aa(e,t,n[t])})}return e}({},e);if(g()(a,Ko(o,o.raw().qCardinal)),t.nul&&(a.nil=n.resolveUIColor(t.nul)),t.oth&&(a.others=n.resolveUIColor(t.oth)),t.usePal){a.palettes={categorical:t.pal};var u=i.senseTheme&&i.senseTheme.properties.palettes;u&&!t.pal&&u.data&&u.data[0]&&(a.palettes.categorical=u.data[0].propertyValue,g()(a,Ko(o)))}else if(!1===t.autoFill&&t.single)a.range=[n.resolveUIColor(t.single)];else if(t.autoFill){var s=i.senseTheme&&i.senseTheme.properties.palettes;s&&s.data&&s.data[0]&&(a.palettes={categorical:s.data[0].propertyValue}),g()(a,Ko(o))}return t.colors&&t.colors.length&&(a.explicit=function(e,t,n){for(var r={},i=0;i<e.length;i+=1)r[e[i].value]=e[i].baseColor;var o=[];return{domain:function(e){var i=e.data,a=[];o=[];for(var u=0;u<i.items.length;u++){var s=i.items[u],l=(s.text||s).label;r[l]&&-1===a.indexOf(s.value)&&(a.push(s.value),o.push(t.resolveUIColor(r[l])))}return a.push(-3,-2),o.push(n.others),o.push(n.nil),a},range:function(){return o}}}(t.colors,n,a)),a};function sa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var la=function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){sa(e,t,n[t])})}return e}({hc:null,colorProps:null,layout:null,senseTheme:null},e),n={},r={auto:function(){return{mode:"primary"}},getDimensionColorMap:function(){return Promise.reject()},getMeasure:function(){return Promise.reject()},getAttributeDimension:function(){return Promise.reject()}},i={auto:function(e){return e?(r.auto=e,i):r.auto},getDimensionColorMap:function(e){return e?(r.getDimensionColorMap=e,i):r.getDimensionColorMap},getAttributeDimension:function(e){return e?(r.getAttributeDimension=e,i):r.getAttributeDimension},getMeasure:function(e){return e?(r.getMeasure=e,i):r.getMeasure},set:function(e){if(!e.colorProps)throw new Error('Missing "colorProps"');if(g()(t,e),(n={pic:t.picasso.data("q")({data:t.hc,config:{localeInfo:t.localeInfo}}),input:t.colorProps}).input.auto){var i=r.auto(e.layout);n.input=g()(!0,{},n.input,i,{auto:!1});var o=t.senseTheme&&t.senseTheme.properties.palettes;o&&o.data&&(n.input.dimensionScheme=o.data[0].propertyValue);var a=0;n.input.byDimDef&&+n.input.byDimDef.activeDimensionIndex>=0&&(a=+n.input.byDimDef.activeDimensionIndex),t.hc&&t.hc.qDimensionInfo[a]&&t.hc.qDimensionInfo[a].coloring&&t.hc.qDimensionInfo[a].coloring.colorMapRef&&n.input.byDimDef&&(n.input.byDimDef.type="libraryItem",n.input.byDimDef.key=t.hc.qDimensionInfo[a].coloring.colorMapRef)}},palettes:function(){if(!n.palettes){var e=t.senseTheme;if(!e)return n.palettes=[],n.palettes;var r=[];Object.keys(e.properties.dataColors||{}).forEach(function(t){r.push({key:t.replace("Color",""),colors:[e.properties.dataColors[t]]})}),(e.properties.palettes.ui||[]).forEach(function(e){r.push({key:"ui",colors:e.colors})}),n.palettes=r}return n.palettes},getAuxiliaryData:function(e){if(!e.auxiliary&&!/qAttrDimInfo/.test(e.field))return Promise.resolve();var n=(e.auxiliary||{}).key;if("measure"===e.fieldType)return r.getMeasure(n,t).catch(function(){});if("dimension"===e.fieldType){var i="/qHyperCubeDef/".concat(e.field).replace("qDimensionInfo","qDimensions").replace("qAttrDimInfo","qAttributeDimensions");return Promise.all([/qAttrDimInfo/.test(e.field)?r.getAttributeDimension(i,t).catch(function(){}):Promise.resolve(),n?r.getDimensionColorMap(n,t).catch(function(){}):Promise.resolve()])}return Promise.resolve()},getAuxiliarySettings:function(e){var r=this;return e.auxiliary||/qAttrDimInfo/.test(e.field)?(this.palettes(),this.getAuxiliaryData(e).then(function(i){if(!i)return{};if("measure"===e.fieldType){if(i.coloring&&i.coloring.gradient){var o=n.pic.field(e.field);return ea(r,i.coloring.gradient,e,o)}return{}}if("dimension"===e.fieldType){var a={nil:e.nil,others:e.others},u=i[0],s=i[1]?i[1].colorMap:null;if(u){var l=t.picasso.data("q")({data:{qDimensionInfo:[n.pic.field(e.field).raw(),n.pic.field(e.field).raw()],qMeasureInfo:[],qDataPages:u,qInterColumnSortOrder:[0,1],qMode:"S"}});a.legendDataset=l}return s?ua(a,s,r,{external:t,field:n.pic.field(e.field)}):a}return{}})):Promise.resolve()},resolveUIColor:function(e){if(e.index<0||void 0===e.index)return e.color;if(void 0===n.uiPalette&&(n.uiPalette=this.palettes().filter(function(e){return"ui"===e.key})[0]||!1),!n.uiPalette)return e.color;var t="none"===n.uiPalette.colors[0]?e.index:e.index-1;return void 0===n.uiPalette.colors[t]?e.color:n.uiPalette.colors[t]},settings:function(){var e=this;if(this.palettes(),!n.settings){var r={primary:"steelblue",others:"#aaa",nil:"#ddd"},i=t.senseTheme;i&&i.properties.dataColors&&(i.properties.dataColors.primaryColor&&(r.primary=i.properties.dataColors.primaryColor),i.properties.dataColors.othersColor&&(r.others=i.properties.dataColors.othersColor),i.properties.dataColors.nullColor&&(r.nil=i.properties.dataColors.nullColor)),n.settings=g()(r,function(){if(n.input&&!n.input.auto){if("byMeasure"===n.input.mode)return ra(e,t,n);if("byDimension"===n.input.mode)return Zo(e,t,n);if("byExpression"===n.input.mode)return ia(e,t,n,r);if("byMultiple"===n.input.mode)return oa(e,t,n,r);if("primary"===n.input.mode)return oa(e,t,n,r)}return{}}())}return n.settings}};return i},ca=function(e,t){var n=e.fieldType,r={};if(t)if("measure"===n){var i=t.coloring;i&&(r.measureGradient=i.gradient)}else if("dimension"===n){var o=t[0],a=t[1];o&&(r.legendDataPage=o),a&&(r.dimValsData=a.colorMap)}return r},fa=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.auto,n=e.resources,r=la(n).auto(t||function(){return{mode:"byDimension",persistent:!1,useDimColVal:!0,byDimDef:{activeDimensionIndex:0,type:"expression",label:""}}}).getDimensionColorMap(function(e,t){return function(e,t,n){var r=t.layout,i=t.app;return r&&r.snapshotData?r.snapshotData.content&&r.snapshotData.content.chartData&&r.snapshotData.content.chartData.dimValsData?n.Promise.resolve({colorMap:r.snapshotData.content.chartData.dimValsData}):n.Promise.reject():i&&i.getObject?i.getObject("ColorMapModel_".concat(e)).then(function(e){return e.getLayout()}):n.Promise.reject()}(e,{layout:t.layout,app:t.app},n)}).getMeasure(function(e,t){return function(e,t,n){var r=t.layout,i=t.app;return r&&r.snapshotData?r.snapshotData.content&&r.snapshotData.content.chartData&&r.snapshotData.content.chartData.measureGradient?n.Promise.resolve({coloring:{gradient:r.snapshotData.content.chartData.measureGradient}}):n.Promise.reject():i&&i.getMeasure?i.getMeasure(e).then(function(e){return e.getMeasure()}):n.Promise.reject()}(e,{layout:t.layout,app:t.app},n)}).getAttributeDimension(function(e,t){return function(e,t,n){var r=t.layout,i=t.model,o=t.app;if(r&&r.snapshotData)return r.snapshotData.content&&r.snapshotData.content.chartData&&r.snapshotData.content.chartData.legendDataPage?n.Promise.resolve(r.snapshotData.content.chartData.legendDataPage):n.Promise.reject();if(i&&i.session&&o)return i.getHyperCubeData(e,[{qHeight:100,qLeft:0,qTop:0,qWidth:2}]);return n.Promise.reject()}(e,{layout:t.layout,model:t.model,app:t.app},n)});return r.getSnapshotData=ca,r};function da(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ma(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ha(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function pa(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.hc,n=e.coloring,r=e.rtl,i=e.key,o=e.source,a=e.picasso,u={},s=i;if(n){var l={override:!0,domain:n.explicit&&"function"==typeof n.explicit.domain?n.explicit.domain:[].concat(ha((n.explicit||{}).domain||[]),[-3,-2]),range:n.explicit&&"function"==typeof n.explicit.range?n.explicit.range:[].concat(ha((n.explicit||{}).range||[]),[n.others,n.nil])};if("field"===n.mode){if("dimension"===n.fieldType){var c,f=function(e){var t=e.hc,n=e.source,r=e.coloring,i={data:{extract:[{source:"dummy",field:0,filter:function(){return i.expando=t.qDataPages[0]?t.qDataPages[0].qArea.qTop:0,!1}},{source:n,field:r.field,trackBy:r.valueAccessor,reduce:"first",props:{row:{reduce:function(){return i.expando++}},text:{value:function(e){return e.qText},reduce:"first"}}}]},expando:0};return i}({hc:t,source:o,coloring:n}).data;if(n.legendDataset){var d=0,m={};a.data("q")({data:t}).extract({field:n.field,trackBy:n.valueAccessor,reduce:function(e){var t=e[0];return m[t]=d++,e[0]}}),c={source:"attrDim",extract:{field:"qDimensionInfo/0",filter:function(e){return e.qElemNumber>=0},props:{row:{value:function(e){return m[e.qElemNumber]}}}}}}var h={data:f,range:n.range,domain:n.domain,explicit:l,type:"categorical-color",label:function(e){return e.datum.text&&e.datum.text.value?e.datum.text.value:e.datum.label}};u[s]=h,c&&(u["".concat(s,"Legend")]=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){ma(e,t,n[t])})}return e}({},h,{data:c})),t&&t.qHasOtherValues&&c&&((c||h.data).amend=[{label:t.qDimensionInfo[0].othersLabel,source:{key:"qHyperCube",field:"qDimensionInfo/0"},row:{value:-3},value:-3}])}else if("measure"===n.fieldType){var p={data:{field:n.field},min:n.min,max:n.max};u[s]=g()({},p,{type:"categorical"===n.type?"threshold-color":"sequential-color",range:n.range,domain:n.domain,invert:n.reverse}),"sequential-color"===u[s].type&&(u["".concat(s,"Range")]=g()({},p,{invert:!!r}))}else if("color"!==n.type)throw new Error("UNUSED FIELD")}else if("dimension"===n.mode){var y={data:t.qDimensionInfo.map(function(e,t){return t}),label:function(e){return t.qDimensionInfo[e.datum.value].qFallbackTitle},explicit:l,type:"categorical-color"};u[s]=y}else if("measure"===n.mode){var v={data:t.qMeasureInfo.map(function(e,t){return t}),label:function(e){return t.qMeasureInfo[e.datum.value].qFallbackTitle},explicit:l,type:"categorical-color"};u[s]=v}}return u}function ga(e){return(ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ya(e){return function(t){return"object"===ga(t.datum[e])?t.datum[e].value:void 0}}function va(e){return-2===e.datum.value}function ba(e){return-3===e.datum.value}var Ma=function(e){var t,n=e.coloring,r=e.scales,i=e.key,o=n.nil,a=n.others,u=n.primary,s=i,l=ya(i),c=ya("".concat(i,"IsAnOther"));return n.invalid?t=function(e){return ba(e)||c(e)?a:o}:r[s]?t=function(e){return ba(e)?a:va(e)||-2===l(e)&&"dimension"===n.fieldType||"NaN"===l(e)?o:c(e)?a:e.resources.scale(s)(l(e))||a}:"constant"===n.mode?t=function(e){return ba(e)||c(e)?a:va(e)?o:u}:"color"===n.type&&(t=function(e){return ba(e)||c(e)?a:va(e)?o:l(e)||a}),t},xa=function(e,t,n){var r=e&&e.dock||void 0;if("auto"!==r)return r||"right";if(t){var i=t.element.getBoundingClientRect();if(i.height>i.width)return"bottom"}return n?"left":"right"},wa=function(e,t,n){return!(n.invalid||"color"===n.type||"measure"===n.mode&&t.qMeasureInfo.length<=1||"dimension"===n.mode)&&!1!==e.show};function qa(e,t){var n=e.styleReference,r=e.chart,i=e.rtl,o=t.legendProps,a=t.coloring,u=t.senseTheme,s=t.hc;return{layout:{minimumLayoutMode:"MEDIUM",dock:xa(o,r,i)},show:wa(o,s,a),renderer:"svg",mounted:function(e){e.childNodes[0].style.pointerEvents="none",e.style.overflow="hidden"},settings:{title:{show:!1!==o.showTitle,wordBreak:"break-word",maxLines:2,lineHeight:1.2,text:a.label||"",fill:u?u.getStyle(n,"legend.title","color"):void 0,fontSize:u?u.getStyle(n,"legend.title","fontSize"):"16px"}}}}function Sa(e,t,n){return"categorical"===t.coloring.type?function(e,t,n){var r=qa(e,t);if(!r.show)return!1;var i=e.key,o=e.styleReference,a=e.viewState,u=e.rtl,s=t.scaleKey,l=t.senseTheme,c=t.scales,f={up:"top",down:"bottom",left:"left",right:"right"},d="".concat(s,"Legend");return g()(!0,r,{type:"legend-cat",key:"".concat(i,"-cat"),scale:d in c?d:s,settings:{layout:{scrollOffset:function(){return a?a.get("legendScrollOffset"):void 0},size:-1!==["top","bottom"].indexOf(r.layout.dock)?2:1,direction:u?"rtl":"ltr"},item:{show:function(e){return-2!==e.datum.value},label:{fill:l?l.getStyle(o,"legend.label","color"):void 0,fontSize:l?l.getStyle(o,"legend.label","fontSize"):void 0}},navigation:{disabled:n,button:{class:{"lui-fade-button":!0},content:function(e,t){var n=t.direction;return e("span",{style:{"pointer-events":"none"},class:"lui-button__icon lui-icon lui-icon--triangle-".concat(f[n])})}}}},brush:{consume:[{context:"selection",data:["",i],style:{inactive:{opacity:.3}}}]}})}(e,t,n):"continuous"===t.coloring.type&&function(e,t){var n=e.key,r=e.styleReference,i=e.rtl,o=t.scaleKey,a=t.senseTheme,u=qa(e,t);return!!u.show&&g()(!0,u,{type:"legend-seq",key:"".concat(n,"-seq"),settings:{fill:o,major:"".concat(o,"Range"),length:1,tick:{fill:a?a.getStyle(r,"legend.label","color"):void 0,fontSize:a?a.getStyle(r,"legend.label","fontSize"):void 0},title:{anchor:!i||"top"!==u.layout.dock&&"bottom"!==u.layout.dock?void 0:"right",padding:parseFloat(u.settings.title.fontSize)||16}}})}(e,t)}function ka(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Da=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.eventName,r=t.key,i=t.requireFailure,o=t.recognizeWith,a=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).actions;return{key:"event:pan-".concat(r),type:"Pan",requireFailure:i,recognizeWith:o,options:{event:n,pointers:1,threshold:10,enable:function(e,t){return this.started===n||!t||!(a&&a.interact&&!a.interact.enabled())&&this.chart.componentsFromPoint({x:t.center.x,y:t.center.y}).some(function(e){return e.key==="".concat(r,"-cat")})}},events:(e={},ka(e,"".concat(n,"start"),function(e){e.preventDefault(),this.started!==n&&(this.started=n,this.chart.component("".concat(r,"-cat")).emit("panstart",e))}),ka(e,"".concat(n,"move"),function(e){e.preventDefault(),this.chart.component("".concat(r,"-cat")).emit("panmove",e)}),ka(e,"".concat(n,"end"),function(e){e.preventDefault(),this.chart.component("".concat(r,"-cat")).emit("panend",e),this.started=!1}),e)}},Oa=function(e){var t=e.key,n=e.requireFailure,r=e.recognizeWith,i=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).actions;return{key:"event:tap-".concat(t),type:"Tap",requireFailure:n,recognizeWith:r,options:{event:"legendtap",interval:10,pointers:1,enable:function(e,n){if(!n)return!0;if(i&&i.interact&&!i.interact.enabled())return!1;if(!this.chart.componentsFromPoint({x:n.center.x,y:n.center.y}).some(function(e){return e.key==="".concat(t,"-cat")}))return!1;var r=n.srcEvent.target;return!!(r&&r.hasAttribute("data-action")&&r.hasAttribute("data-component-key"))||!(!r||!r.childNodes[0]||"BUTTON"!==r.childNodes[0].nodeName)}},events:{legendtap:function(e){e.preventDefault();var t=e.srcEvent.target;t&&t.hasAttribute("data-action")&&t.hasAttribute("data-component-key")&&this.chart.component(t.getAttribute("data-component-key")).emit(t.getAttribute("data-action"))}}}},Aa=function(e,t,n){var r=[],i=[],o=Sa(e,t,n&&n.navigationDisabled);return r.push(o),o&&"legend-cat"===o.type&&(i.push(Oa(e,n)),i.push(Da(e,n))),{interactions:i,components:r}};var Ca=function(e){var t,n,r=e.hc,i=e.coloring,o=e.scales,a=e.key,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=a,l=i.nil;o[a]&&"field"===i.mode?t=o[a].data.field||i.field:"field"===i.mode&&i.field&&(t=i.field),t?(n={field:t,reduce:"first"},"color"===i.type&&(n.value=function(e){return"NaN"!==e.qNum?(t=e.qNum,"rgba(".concat([(16711680&t)>>16,(65280&t)>>8,255&t,((4278190080&t)>>>24)/255].join(","),")")):e.qText&&tt(e.qText)?e.qText:l;var t})):"dimension"===i.mode?n=void 0!==i.field?i.field:r.qDimensionInfo.length-1:"measure"===i.mode&&(n=u);var c=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},s,n);return r.qDimensionInfo.length>1&&(c["".concat(s,"IsAnOther")]={fields:r.qDimensionInfo.map(function(e,t){return{field:"qDimensionInfo/".concat(t)}}),value:function(e){return-1!==e.indexOf(-3)}}),c};function Ta(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Pa(e,t,n[t])})}return e}function Pa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Na(e){var t=fa({resources:e}),n={},r={},i=function(e){return r.settings||(e||console.warn("settings() called before auxiliarySettings()"),r.settings=t.settings()),r.settings},o={config:function(i){if(n=Ta({},i),r={},!n.key)throw new Error("Missing key");t.set(Ta({},e,n))},auto:function(e){return e?(t.auto(e),o):t.auto()},getAuxiliarySettings:function(){return r.auxiliarySettings?Promise.resolve(r.auxiliarySettings):t.getAuxiliarySettings(i(!0)).then(function(e){return r.auxiliarySettings=e,r.settings=Ta({},r.settings,r.auxiliarySettings),e})},getAuxiliaryData:function(){return t.getAuxiliaryData(i())},getSnapshotData:function(){var e=i();return t.getAuxiliaryData(e).then(function(n){return t.getSnapshotData(e,n)})},resolveUIColor:function(e){return t.resolveUIColor(e)},settings:function(){var e=i();return{mode:e.mode,type:e.type,label:e.label,field:e.field,fieldType:e.fieldType,nil:e.nil,others:e.others,primary:e.primary}},palettes:function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.colorProps,n=e.coloring,r=e.theme,i=[];if(n&&n.palettes&&r){var o=n.palettes.categorical||t.dimensionScheme,a=r.properties.palettes.data.filter(function(e){return e.propertyValue===o})[0]||r.properties.palettes.data[0];o&&a&&i.push({key:"categorical",colors:a.scale});var u=n.palettes.metric||t.measureScheme,s=r.properties.scales.filter(function(e){return e.propertyValue===u})[0];if(s){var l=s.scale[0]?s.scale:[[]].concat(da(s.scale.slice(1)));l=Array.isArray(l[0])?l.map(function(e){return e.slice().reverse()}):l.slice().reverse(),i.push({key:"quant",colors:l})}}return i}({coloring:i(),colorProps:n.colorProps,theme:n.senseTheme})},scales:function(){return r.scales=r.scales||pa({hc:n.hc,coloring:i(),key:n.key,source:n.source,picasso:e.picasso}),r.scales},color:function(){return r.color=r.color||Ma({coloring:i(),scales:this.scales(),key:n.key}),r.color},datumProps:function(e){return Ca({coloring:i(),scales:this.scales(),key:n.key,hc:n.hc},e)},data:function(){var e=i(),t={key:"dummy",data:[["field"],["a"]]};return e.legendDataset?[t,{type:"q",key:"attrDim",data:e.legendDataset.raw(),config:{localeInfo:n.localeInfo}}]:[t]},legend:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.eventName,r=e.key,o=e.viewState,a=e.chart,u=e.rtl,s=e.styleReference,l=void 0===s?"object.legend":s,c=arguments.length>1?arguments[1]:void 0;return Aa({eventName:t,key:r,rtl:u,viewState:o,chart:a,styleReference:l},{legendProps:n.legendProps,scaleKey:n.key,coloring:i(),senseTheme:n.senseTheme,hc:n.hc,scales:this.scales()},c)}};return o}function La(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){ja(e,t,n[t])})}return e}function ja(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ea=function(e){var t=e.color.useBaseColors,n=e.qHyperCube.qDimensionInfo.filter(function(e){return e.baseColor||e.coloring&&e.coloring.baseColor}).length>0,r=e.qHyperCube.qMeasureInfo.filter(function(e){return e.baseColor||e.coloring&&e.coloring.baseColor}).length>0;return"measure"===t&&!r||"dimension"===t&&!n?"off":t},Ia=function(e){if(e.qHyperCube.qDimensionInfo.length>1)return{mode:"byDimension",useDimColVal:!0,useBaseColors:"dimension",byDimDef:{activeDimensionIndex:1}};if(e.qHyperCube.qMeasureInfo.length>1)return{mode:"primary",useBaseColors:"measure",paletteColor:null};var t=e.qHyperCube.qDimensionInfo.filter(function(e){return e.baseColor||e.coloring&&e.coloring.baseColor}).length>0,n=e.qHyperCube.qMeasureInfo.filter(function(e){return e.baseColor||e.coloring&&e.coloring.baseColor}).length>0;return{mode:"primary",useBaseColors:t?"dimension":n?"measure":"off",paletteColor:null}};var Ra=n(6),Ha=n.n(Ra),Ba=n(7),za=n.n(Ba),Fa=n(16),_a=n.n(Fa),Va=new RegExp("[A-Za-zªµºÀ-ÖØ-öø-ʸʻ-ˁː-ˑˠ-ˤˮͰ-ͳͶ-ͽΆΈ-ϵϷ-҂Ҋ-։ः-हऻऽ-ीॉ-ौॎ-ॐक़-ॡ।-ॿং-হঽ-ীে-ৌৎ-ৡ০-ৱ৴-৺ਃ-ਹਾ-ੀਖ਼-੯ੲ-ੴઃ-હઽ-ીૉ-ૌૐ-ૡ૦-૯ଂ-ହଽ-ାୀେ-ୌୗ-ୡ୦-୷ஃ-ிு-ௌௐ-௲ఁ-ఽు-ౄౘ-ౡ౦-౯౿-ಹಽ-ೋೕ-ೡ೦-ീെ-ൌൎ-ൡ൦-ෆා-ෑෘ-ะา-ำเ-ๆ๏-ະາ-ຳຽ-ໆ໐-༗༚-༴༶༸༾-ཬཿ྅ྈ-ྌ྾-࿅࿇-ာေးျ-ြဿ-ၗၚ-ၝၡ-ၰၵ-ႁႃ-ႄႇ-ႌႎ-ႜ႞-ፚ፠-ᎏᎠ-Ᏼᐁ-ᙿᚁ-ᚚᚠ-ᜑᜠ-ᜱ᜵-ᝑᝠ-ᝰក-ាើ-ៅះ-ៈ។-៚ៜ០-៩᠐-ᢨᢪ-ᤜᤣ-ᤦᤩ-ᤱᤳ-ᤸ᥆-᧚ᨀ-ᨖᨙ-ᩕᩗᩡᩣ-ᩤᩭ-ᩲ᪀-᪭ᬄ-ᬳᬵᬻᬽ-ᭁᭃ-᭪᭴-᭼ᮂ-ᮡᮦ-ᮧ᮪-ᯥᯧᯪ-ᯬᯮ᯲-ᰫᰴ-ᰵ᰻-᱿᳓᳡ᳩ-ᳬᳮ-ᶿḀ-ᾼιῂ-ῌῐ-Ίῠ-Ῥῲ-ῼ‎ⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎ-⅏Ⅰ-ↈ⌶-⍺⎕⒜-ⓩ⚬⠀-⣿Ⰰ-ⳤⳫ-ⳮⴀ-⵰ⶀ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ㆺㇰ-㈜㈠-㉏㉠-㉻㉿-㊰㋀-㋋㋐-㍶㍻-㏝㏠-㏾㐀-䶵一-ꒌꓐ-ꘌꘐ-ꙮꚀ-ꛯ꛲-꛷Ꜣ-ꞇ꞉-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠤꠧ꠰-꠷ꡀ-ꡳꢀ-ꣃ꣎-꣙ꣲ-ꤥ꤮-ꥆꥒ-ꥼꦃ-ꦲꦴ-ꦵꦺ-ꦻꦽ-ꨨꨯ-ꨰꨳ-ꨴꩀ-ꩂꩄ-ꩋꩍ-ꪯꪱꪵ-ꪶꪹ-ꪽꫀꫂ-ꯤꯦ-ꯧꯩ-꯬꯰-ﬗＡ-Ｚａ-ｚｦ-ￜ]"),Ua=new RegExp("[־׀׃׆א-״߀-ߪߴ-ߵߺ-ࠕࠚࠤࠨ࠰-ࡘ࡞‏יִײַ-ﬨשׁ-ﭏ]"),Wa=new RegExp("[؈؋؍؛-ي٭-ٯٱ-ەۥ-ۦۮ-ۯۺ-܍ܐܒ-ܯݍ-ޥޱﭐ-ﴽﵐ-﷼ﹰ-ﻼ]"),Ka={lrm:String.fromCharCode(8206),rlm:String.fromCharCode(8207),isLtrChar:function(e){return Va.test(e)},isRtlChar:function(e){return Ua.test(e)||Wa.test(e)},detectTextDirection:function(e){var t,n,r=e?e.length:0;for(t=0;t<r;t++){if(n=e[t],Ka.isLtrChar(n))return"ltr";if(Ka.isRtlChar(n))return"rtl"}return"ltr"}},Ga=Ka,Ya=n(2),Xa=n.n(Ya),Ja=n(1),Za=n.n(Ja),$a=n(3);function Qa(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function eu(e){return(eu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var tu=g.a.bind(null,!0),nu={},ru=Array.isArray;function iu(e){return null!=e&&!Array.isArray(e)&&"object"===eu(e)}function ou(e){return void 0===e}function au(e,t){return"function"==typeof e[t]||"$$"===t.substring(0,2)||"_"===t.substring(0,1)}function uu(e,t){var n,r=t.substring(1).split("/").slice(0,-1);return r.forEach(function(t,i){if(i!==r.length){n=+t;var o=isNaN(n)?{}:[];e[n||t]=ou(e[n||t])?o:e[t],e=e[n||t]}}),e}function su(e,t){var n=!0;if(iu(e)&&iu(t))return Object.keys(e).length===Object.keys(t).length&&(Object.keys(e).forEach(function(r){su(e[r],t[r])||(n=!1)}),n);if(ru(e)&&ru(t)){if(e.length!==t.length)return!1;for(var r=0,i=e.length;r<i;r+=1)if(!su(e[r],t[r]))return!1;return!0}return e===t}nu.generate=function(e,t,n){n=n||"";var r=[];return Object.keys(t).forEach(function(i){var o=function(e){return e?tu({},{val:e}).val:e}(t[i]),a=e[i],u="".concat(n,"/").concat(i);su(o,a)||au(t,i)||(ou(a)?r.push({op:"add",path:u,value:o}):iu(o)&&iu(a)?r=r.concat(nu.generate(a,o,u)):ru(o)&&ru(a)?r=r.concat(function(e,t,n){var r=[],i=e.slice(),o=-1;function a(e,t,n){if(e[n]&&ou(e[n].qInfo))return null;if(e[n]&&e[n].qInfo.qId===t)return n;for(var r=0,i=e.length;r<i;r+=1)if(e[r]&&e[r].qInfo.qId===t)return r;return-1}if(su(t,i))return r;if(!ou(t[0])&&ou(t[0].qInfo))return r.push({op:"replace",path:n,value:t}),r;for(var u=i.length-1;u>=0;u-=1)-1===(o=a(t,i[u].qInfo&&i[u].qInfo.qId,u))?(r.push({op:"remove",path:"".concat(n,"/").concat(u)}),i.splice(u,1)):r=r.concat(nu.generate(i[u],t[o],"".concat(n,"/").concat(u)));for(var s=0,l=t.length;s<l;s+=1)-1===(o=a(i,t[s].qInfo&&t[s].qInfo.qId))?(r.push({op:"add",path:"".concat(n,"/").concat(s),value:t[s]}),i.splice(s,0,t[s])):o!==s&&(r.push({op:"move",path:"".concat(n,"/").concat(s),from:"".concat(n,"/").concat(o)}),i.splice(s,0,i.splice(o,1)[0]));return r}(a,o,u)):r.push({op:"replace",path:"".concat(n,"/").concat(i),value:o}))}),Object.keys(e).forEach(function(i){ou(t[i])&&!au(e,i)&&r.push({op:"remove",path:"".concat(n,"/").concat(i)})}),r},nu.apply=function(e,t){t.forEach(function(t){var n,r=uu(e,t.path),i=t.path.split("/").splice(-1)[0],o=i&&isNaN(+i)?r[i]:r[+i]||r,a=t.from?t.from.split("/").splice(-1)[0]:null;if("/"===t.path&&(r=null,o=e),"add"===t.op||"replace"===t.op)if(ru(r))"-"===i&&(i=r.length),r.splice(+i,"add"===t.op?0:1,t.value);else if(ru(o)&&ru(t.value)){var u,s=t.value.slice();o.length=0,(u=o).push.apply(u,Qa(s))}else if(iu(o)&&iu(t.value))n=o,Object.keys(n).forEach(function(e){Object.getOwnPropertyDescriptor(n,e).configurable&&!au(n,e)&&delete n[e]}),tu(o,t.value);else{if(!r)throw new Error("Patchee is not an object we can patch");r[i]=t.value}else if("move"===t.op){var l=uu(e,t.from);ru(r)?r.splice(+i,0,l.splice(+a,1)[0]):(r[i]=l[a],delete l[a])}else"remove"===t.op&&(ru(r)?r.splice(+i,1):delete r[i])})},nu.clone=function(e){return tu({},e)},nu.createPatch=function(e,t,n){var r={op:e.toLowerCase(),path:n};return"move"===r.op?r.from=t:void 0!==t&&(r.value=t),r},nu.updateObject=function(e,t){Object.keys(e).length?nu.apply(e,nu.generate(e,t)):tu(e,t)};var lu=nu;function cu(e,t,n,r){e.getEffectiveProperties().then(function(i){var o=g()(!0,{},i),a=o.qHyperCubeDef[r][t],u=o.qHyperCubeDef.qLayoutExclude.qHyperCubeDef[r][n];u.qAttributeDimensions=a.qAttributeDimensions,u.qAttributeExpressions=a.qAttributeExpressions,a.qAttributeDimensions=[],a.qAttributeExpressions=[],o.qHyperCubeDef[r][t]=u,o.qHyperCubeDef.qLayoutExclude.qHyperCubeDef[r][n]=a,function(e,t,n){var r=lu.generate(t,n);r&&r.length&&(r=r.map(function(e){return{qOp:e.op,qValue:JSON.stringify(e.value),qPath:e.path}}),e.applyPatches(r,!0))}(e,i,o)})}function fu(e){var t=e.dir,n=e.dock,r=e.altList,i=e.model,o=e.Promise,a=e.translator,u=e.app;return 0===r.length?null:{dir:t,dock:n,getAlternatives:function(){var e=r.map(function(e){return function(e,t,n,r){if(e.qLibraryId)return t.getDimension(e.qLibraryId).then(function(e){return e.getLayout()}).catch(function(){return null}).then(function(e){return e?"H"!==e.qDim.qGrouping&&e.qDim.qLabelExpression?e.qDim.qLabelExpression:e.qDim.title:r.get("Object.ErrorMessage.MissingDimension")});var i=e.qDef.qLabelExpression;if(i)return t.evaluate(i);var o=e.qDef.qFieldLabels[0]||e.qDef.qFieldDefs[0];return n.resolve(o)}(e,u,o,a).then(function(t){return{id:e.qDef.cId,selected:!1,title:t}})});return o.all(e)},changeTo:function(e,t){cu(i,e,t,"qDimensions")}}}function du(e,t,n){return{breadcrumbs:e.qGroupFallbackTitles.slice(0,e.qGroupPos),drilldown:"H"===e.qGrouping,index:t,locked:!!e.qLocked,text:"H"===e.qGrouping?e.qGroupFallbackTitles[e.qGroupPos]:e.qFallbackTitle,popoverText:(r=e,"H"===r.qGrouping?r.title||"":r.qFallbackTitle||""),drillUp:function(e){var r=t;n.drillUp("/qHyperCubeDef",r,e)}};var r}function mu(e){var t=e.dir,n=e.dock,r=e.altList,i=e.model,o=e.Promise,a=e.translator,u=e.app;return 0===r.length?null:{dir:t,dock:n,getAlternatives:function(){var e=r.map(function(e){return function(e,t,n,r){if(e.qLibraryId)return t.getMeasure(e.qLibraryId).then(function(e){return e.getLayout()}).catch(function(){return null}).then(function(e){return e?e.qMeasure.qLabelExpression?e.qMeasure.qLabelExpression:e.qMeasure.qLabel||e.qMeasure.qDef:r.get("Object.ErrorMessage.MissingMeasure")});var i=e.qDef.qLabelExpression;if(i)return t.evaluate(i);var o=e.qDef.qLabel||e.qDef.qDef;return n.resolve(o)}(e,u,o,a).then(function(t){return{id:e.qDef.cId,selected:!1,title:t}})});return o.all(e)},changeTo:function(e,t){cu(i,e,t,"qMeasures")}}}function hu(e,t){return{breadcrumbs:[],drilldown:!1,index:t,locked:!1,text:e.qFallbackTitle,popoverText:e.qFallbackTitle}}function pu(e){return(pu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vu(e){return(vu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mu(e,t){return(Mu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xu=function(){function e(e){var t=e.title,n=e.selected,r=e.onClick,i=Ga.detectTextDirection(t);return Xa.a.createElement($a.List.Item,{onClick:r},Xa.a.createElement($a.List.Aside,{style:{width:16}},Xa.a.createElement($a.Icon,{name:n?"tick":""})),Xa.a.createElement($a.List.Text,{className:"lui-list__text--ellipsis",title:t,dir:i},t))}function t(t){var n=t.alignTo,r=t.changeTo,i=t.current,o=t.dir,a=t.dock,u=t.list,s=t.onClose,l=t.show,c=u.map(function(t,n){return Xa.a.createElement(e,{key:t.id,title:t.title,onClick:function(){return r(n)}})});return Xa.a.createElement($a.Popover,{variant:"inverse",alignTo:n,dock:a,show:l,onOutside:s,onEscape:s},Xa.a.createElement($a.List,{variant:"inverse",dir:o,style:{maxHeight:"300px",overflowY:"auto"}},Xa.a.createElement(e,{title:i,selected:!0,onClick:s}),c))}e.propTypes={title:Za.a.string.isRequired,selected:Za.a.bool,onClick:Za.a.func.isRequired},e.defaultProps={selected:!1},t.propTypes={alignTo:Za.a.any,changeTo:Za.a.func.isRequired,current:Za.a.string.isRequired,dir:Za.a.string.isRequired,dock:Za.a.string.isRequired,list:Za.a.array,onClose:Za.a.func.isRequired,show:Za.a.bool.isRequired},t.defaultProps={list:[],alignTo:null};var n=function(e){function n(e){var t,r,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),r=this,(t=!(i=vu(n).call(this,e))||"object"!==pu(i)&&"function"!=typeof i?bu(r):i).state={open:!1,inSelection:e.selections&&e.selections.isActive()},t.openPopover=t.openPopover.bind(bu(t)),t.closePopover=t.closePopover.bind(bu(t)),t.changeTo=t.changeTo.bind(bu(t)),t.alignToRef=Xa.a.createRef(),t}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mu(e,t)}(n,Xa.a.Component),r=n,(i=[{key:"componentDidMount",value:function(){var e=this,t=this.props.selections;t&&(this.onSelectionsActivated=function(){return e.setState({inSelection:!0})},this.onSelectionsDeactivated=function(){return e.setState({inSelection:!1})},t.addListener("activated",this.onSelectionsActivated),t.addListener("deactivated",this.onSelectionsDeactivated),t.addListener("canceled",this.onSelectionsDeactivated))}},{key:"componentWillUnmount",value:function(){var e=this.props.selections;e&&(e.removeListener("activated",this.onSelectionsActivated),e.removeListener("deactivated",this.onSelectionsDeactivated),e.removeListener("canceled",this.onSelectionsDeactivated))}},{key:"changeTo",value:function(e){this.props.popover.changeTo(this.props.titleData.index,e),this.closePopover()}},{key:"openPopover",value:function(){var e=this;this.state.closeTime&&Date.now()-this.state.closeTime<20||this.props.popover.getAlternatives().then(function(t){e.setState({open:!0,alternatives:t})})}},{key:"closePopover",value:function(){this.setState({open:!1,closeTime:Date.now()})}},{key:"render",value:function(){var e=this.props,n=e.titleData,r=e.popover,i=e.translator,o=e.disabled,a=e.isDimension,u=e.padding,s=e.minWidth,l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){gu(e,t,n[t])})}return e}({flex:"1 1 auto",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:"normal"},this.props.style),c=n.breadcrumbs.length,f=o||this.state.inSelection,d=n.breadcrumbs.map(function(e,t){return Xa.a.createElement($a.FadeButton,{style:{display:"flex",color:f&&"rgba(89, 89, 89, 0.8)"},key:t,onClick:function(){return n.drillUp(c-t)},title:e,disabled:f},Xa.a.createElement($a.FadeButton.Text,{style:l},e),Xa.a.createElement($a.FadeButton.Icon,{name:"triangle-right",size:"small"}))}),m=r&&!this.state.open?this.openPopover:this.closePopover,h=!r||o||this.state.inSelection,p={display:"flex",width:"100%",color:h&&"rgba(89, 89, 89, 0.8)",height:!a&&h&&"20px",lineHeight:!a&&h&&"20px",border:!a&&h&&"none"};u&&(p.padding=u),s&&(p.minWidth=s);var g=Ga.detectTextDirection(n.text),y=Xa.a.createElement($a.FadeButton,{style:p,onClick:m,active:this.state.open,disabled:h,title:n.text},n.locked&&Xa.a.createElement($a.FadeButton.Icon,{name:"lock",size:"small",title:i.get("Tooltip.selections.locked")}),Xa.a.createElement($a.FadeButton.Text,{style:l,dir:g},n.text),r&&Xa.a.createElement($a.FadeButton.Caret,null));return Xa.a.createElement(Xa.a.Fragment,null,n.drilldown&&Xa.a.createElement($a.Icon,{name:"drill-down",size:"small",title:i.get("Tooltip.dimensions.drilldown"),style:{margin:"0 4px 0 0"}}),d,Xa.a.createElement("div",{ref:this.alignToRef,style:{overflow:"hidden"}},y),r&&Xa.a.createElement(t,{dock:r.dock,dir:r.dir,current:n.popoverText,alignTo:this.alignToRef.current,show:this.state.open,list:this.state.alternatives,onClose:this.closePopover,changeTo:this.changeTo}))}}])&&yu(r.prototype,i),o&&yu(r,o),n}();return n.propTypes={disabled:Za.a.bool.isRequired,padding:Za.a.string,minWidth:Za.a.string,titleData:Za.a.shape({breadcrumbs:Za.a.arrayOf(Za.a.string).isRequired,drilldown:Za.a.bool.isRequired,index:Za.a.number.isRequired,locked:Za.a.bool.isRequired,text:Za.a.string.isRequired,popoverText:Za.a.string.isRequired,drillUp:Za.a.func}).isRequired,popover:Za.a.shape({dir:Za.a.string.isRequired,dock:Za.a.string.isRequired,changeTo:Za.a.func.isRequired,getAlternatives:Za.a.func.isRequired}),translator:Za.a.shape({get:Za.a.func.isRequired}).isRequired,selections:Za.a.shape({isActive:Za.a.func,addListener:Za.a.func,removeListener:Za.a.func}),style:Za.a.shape({fontSize:Za.a.string,color:Za.a.string,fontFamily:Za.a.string}).isRequired,isDimension:Za.a.bool.isRequired},n.defaultProps={popover:null,selections:null,padding:"",minWidth:""},{renderer:"react",disableTriggers:!0,preferredSize:function(){return this.settings.settings.isDimension||!(e=this.settings.settings).isDimension&&b.getValue(e,"hyperCubeDef.qLayoutExclude.qHyperCubeDef.qMeasures.length")>0?28:20;var e},render:function(){var e=this,t=this.settings,r=t.settings,i=r.hyperCube,o=r.hyperCubeDef,a=r.disabled,u=r.isDimension,s=r.model,l=r.translator,c=r.rtl,f=r.selections,d=r.app,m=r.padding,h=r.minWidth,p=t.layout.dock,g="top"!==p&&"bottom"!==p||!c?"ltr":"rtl",y=function(e,t){var n={pointerEvents:"auto",display:"flex",justifyContent:"center",alignItems:"center"};return"left"===e?(n.width="".concat(t.height,"px"),n.transform="rotate(-90deg) translate(-".concat(t.height,"px, 0)"),n.transformOrigin="top left"):"right"===e&&(n.width="".concat(t.height,"px"),n.transform="rotate(90deg) translate(0, -".concat(t.width,"px)"),n.transformOrigin="top left"),n}(p,this.rect),v=o&&o.qLayoutExclude&&o.qLayoutExclude.qHyperCubeDef,b=v&&v[u?"qDimensions":"qMeasures"]||[],M=i[u?"qDimensionInfo":"qMeasureInfo"],x=u?du:hu,w=(u?fu:mu)({dir:c?"rtl":"ltr",dock:function(e){return{top:"bottom",bottom:"top",left:"right",right:"left"}[e]}(p),altList:b,model:s,Promise:Promise,translator:l,app:d}),q=M.map(function(t,r){var i=x(t,r,s),o=r===M.length-1;return Xa.a.createElement(Xa.a.Fragment,{key:t.cId},Xa.a.createElement(n,{popover:w,titleData:i,model:s,translator:l,selections:f,disabled:a(),style:e.style,isDimension:u,padding:m,minWidth:h}),!o&&Xa.a.createElement("span",null,", "))});return Xa.a.createElement("div",{style:y,dir:g},q)}}};function wu(e){return(wu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Su(e,t){return!t||"object"!==wu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ku(e){return(ku=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Du(e,t){return(Du=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ou(){var e=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Su(this,ku(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Du(e,t)}(t,Xa.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.label,n=e.spanStyle;return Xa.a.createElement(Xa.a.Fragment,null,Xa.a.createElement("span",{ref:this.alignToRef,style:n,title:t},t))}}])&&qu(n.prototype,r),i&&qu(n,i),t}();return e.propTypes={label:Za.a.string.isRequired,spanStyle:Za.a.shape().isRequired},{renderer:"react",disableTriggers:!0,preferredSize:function(){return 22},render:function(){var t=this.settings,n=t.settings,r=n.label,i=n.rtl,o=t.layout.dock,a="top"!==o&&"bottom"!==o||!i?"ltr":"rtl",u=function(e,t){var n={pointerEvents:"auto",display:"flex",justifyContent:"center",alignItems:"center",color:"#7b7a78",fontStyle:"italic",fontSize:"13px"};switch(e){case"left":n.width="".concat(t.height,"px"),n.transform="rotate(-90deg) translate(-".concat(t.height,"px, 0)"),n.transformOrigin="top left";break;case"right":n.width="".concat(t.height,"px"),n.transform="rotate(90deg) translate(0, -".concat(t.width,"px)"),n.transformOrigin="top left";break;case"center":n.width="".concat(t.width,"px"),n.height="".concat(t.height,"px"),n.color="#595959",n.fontStyle="normal",n.fontSize="1.2em",n.textAlign="center";break;default:case"top":case"bottom":n.justifyContent="flex-start",n.alignItems="flex-start"}return n}(o,this.rect),s="center"===o?r:"* ".concat(r),l="center"!==o?{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}:{};return Xa.a.createElement("div",{style:u,dir:a},Xa.a.createElement(Xa.a.Fragment,null,Xa.a.createElement(e,{label:s,spanStyle:l})))}}}var Au=n(4),Cu=n.n(Au);function Tu(){return function(e){e.renderer("react",function(){function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.x,n=e.y,r=e.width,i=e.height,o=e.scaleRatio,a=e.margin,u={x:0,y:0,width:0,height:0,scaleRatio:{x:1,y:1},margin:{left:0,top:0}};return u.x=Number.isNaN(t)?u.x:t,u.y=Number.isNaN(n)?u.y:n,u.width=Number.isNaN(r)?u.width:r,u.height=Number.isNaN(i)?u.height:i,void 0!==o&&(u.scaleRatio.x=Number.isNaN(o.x)?u.scaleRatio.x:o.x,u.scaleRatio.y=Number.isNaN(o.y)?u.scaleRatio.y:o.y),void 0!==a&&(u.margin.left=Number.isNaN(a.left)?0:a.left,u.margin.top=Number.isNaN(a.top)?0:a.top),u}return function(){var t,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).createElement,r=void 0===n?document.createElement.bind(document):n,i=e(),o={element:function(){return t},root:function(){return t},appendTo:function(e){return t||((t=r("div")).style.position="absolute",t.style["-webkit-font-smoothing"]="antialiased",t.style["-moz-osx-font-smoothing"]="antialiased",t.style.pointerEvents="none"),e.appendChild(t),t},render:function(e){if(!t)return!1;var n=i.scaleRatio.x,r=i.scaleRatio.y;return t.style.left="".concat(Math.round(i.margin.left+i.x*n),"px"),t.style.top="".concat(Math.round(i.margin.top+i.y*r),"px"),t.style.width="".concat(Math.round(i.width),"px"),t.style.height="".concat(Math.round(i.height),"px"),t.style.transform="scale(".concat(n,", ").concat(r,")"),t.style.transformOrigin="top left",Cu.a.render(e,t),!0},itemsAt:function(){return[]},findShapes:function(){return[]},clear:function(){return t&&Cu.a.unmountComponentAtNode(t),o},destroy:function(){t&&t.parentElement&&(Cu.a.unmountComponentAtNode(t),t.parentElement.removeChild(t)),t=null},size:function(t){return t&&(i=e(t)),i}};return o}}()),e.component("data-title",xu()),e.component("disclaimer",Ou())}}var Pu={background:"rgba(0, 0, 0, 0.1)"},Nu={top:-1,bottom:-1,width:6},Lu={width:2,background:"#595959"},ju={before:Pu,after:Pu,thumb:{background:"transparent",border:"1px solid rgba(68, 68, 68, 0.4)"},startHandle:Nu,endHandle:Nu,startHandleBorder:Lu,endHandleBorder:Lu},Eu={background:"rgba(0, 0, 0, 0.1)"},Iu={top:-1,bottom:-1,width:6},Ru={width:2,background:"#595959"},Hu={before:Eu,after:Eu,thumb:{background:"#B0AFAE",border:"transparent"},startHandle:Iu,endHandle:Iu,startHandleBorder:Ru,endHandleBorder:Ru},Bu={position:"absolute",top:0,right:0,bottom:0,left:0,boxSizing:"border-box"},zu={pointerEvents:"initial"},Fu={pointerEvents:"none"};var _u="data-scroll-area-handle";function Vu(e){return(e.srcEvent||e).srcElement.getAttribute(_u)||""}function Uu(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Wu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ku={RESIZE:"ew-resize",DEFAULT:"default"};function Gu(){var e=this.rect,t=this.settings.settings,n="vertical"===t.orientation,r=n?e.computedInner.width:e.computedInner.height,i=t.range(),o=n&&t.rtl;return{size:r,start:(o?1-i[1]:i[0])*r,end:(o?1-i[0]:i[1])*r}}function Yu(){var e=this.state.hover.start||this.state.hover.end||this.state.drag.start||this.state.drag.end;this.renderer.element().ownerDocument.body.style.cursor=e?Ku.RESIZE:Ku.DEFAULT}function Xu(e,t,n){var r=this.settings.settings.size.thumb.min;if(n-t<r){var i=(r-(n-t))/2,o=Math.max(0,0-(t-i))-Math.max(0,n+i-e);return{size:e,start:t-i+o,end:n+i+o}}return{size:e,start:t,end:n}}function Ju(){var e=Gu.call(this),t=e.size,n=e.start,r=e.end;this.renderer.render(this.elements(this.h,Xu.call(this,t,n,r)))}function Zu(){var e=this.state,t=this.settings,n=this.style,r=t.settings.style;return e.style[r]||(e.style[r]=function(e,t){var n="slim"===e?Hu:ju;return{container:Object.assign({},Bu),before:Object.assign({},Bu,n.before,t.before),after:Object.assign({},Bu,n.after,t.after),thumb:Object.assign({},Bu,n.thumb,t.thumb),startHandle:Object.assign({},Bu,zu,n.startHandle),endHandle:Object.assign({},Bu,zu,n.endHandle),startHandleBorder:Object.assign({},Bu,Fu,n.startHandleBorder),endHandleBorder:Object.assign({},Bu,Fu,n.endHandleBorder)}}(t.settings.style,n[r])),e.style[r]}var $u={require:["renderer"],defaultSettings:{settings:{style:"standard",size:{area:{min:30,max:40,ratio:1/8},thumb:{min:4}},orientation:"vertical",rtl:!1,isContinuous:!1,range:function(){return[0,1]},injections:function(){return[]}},style:{standard:{before:{},thumb:{},after:{}},slim:{before:{},thumb:{},after:{}}}},renderer:"dom",state:{style:{},locked:!1,hover:{start:!1,end:!1,reset:function(){this.start=!1,this.end=!1},isPristine:function(){return!this.start&&!this.end}},drag:{start:!1,end:!1,reset:function(){this.start=!1,this.end=!1}}},on:{render:function(){Ju.call(this)},lockState:function(){this.state.locked=!0},unlockState:function(){this.state.locked=!1},hover:function(e){if(!(this.state.locked||this.state.drag.start||this.state.drag.end||!function(e){var t=(e.srcEvent||e).srcElement;return this.renderer.element().contains(t)}.call(this,e)&&this.state.hover.isPristine())){this.state.hover.reset();var t=Vu(e);t&&(this.state.hover[t]=!0),Yu.call(this),Ju.call(this)}},leave:function(){this.state.locked||(this.state.hover.reset(),Yu.call(this),Ju.call(this))},dragStart:function(e){if(!this.state.locked){this.state.drag.reset();var t=Vu(e);t&&(this.state.drag[t]=!0),Yu.call(this)}},dragEnd:function(){this.state.locked||(this.state.drag.reset(),Yu.call(this),Ju.call(this))}},preferredSize:function(e){var t=e.outer,n=this.settings.settings.size.area,r=n.min,i=n.max,o=n.ratio,a="vertical"===this.settings.settings.orientation?"height":"width";return Math.max(r,Math.min(i,t[a]*o))},render:function(e){this.h=e;var t=Gu.call(this),n=t.size,r=t.start,i=t.end;return this.elements(e,Xu.call(this,n,r,i))},properties:function(){return"vertical"===this.settings.settings.orientation?{start:"left",end:"right"}:{start:"top",end:"bottom"}},elements:function(e,t){var n=this,r=t.size,i=t.start,o=t.end,a=this.settings.settings,u=a.injections().map(function(t){return t({h:e,rect:n.rect,orientation:a.orientation,minThumbSize:a.size.thumb.min})});return function(e){var t,n=e.h,r=e.size,i=e.start,o=e.end,a=e.properties,u=e.startHandleActive,s=e.endHandleActive,l=e.style,c=e.continuous,f=e.invert,d=e.injections,m={before:Wu({},a.end,r-i),after:Wu({},a.start,o),startHandle:{left:-3},startHandleBorder:{left:1},endHandle:{right:-3,left:"auto"},endHandleBorder:{left:3}},h=n("div",{style:Object.assign({},l.before,f?m.after:m.before),class:"scroll-area--before"}),p=n("div",{style:Object.assign({},l.after,f?m.before:m.after),class:"scroll-area--after"}),g=[];if(c){var y=n("div",Wu({style:Object.assign({},l.startHandle,f?m.endHandle:m.startHandle),class:"scroll-area--start-handle"},_u,"start"),u?n("div",{style:Object.assign({},l.startHandleBorder,f?m.endHandleBorder:m.startHandleBorder)}):void 0);g.push(y);var v=n("div",Wu({style:Object.assign({},l.endHandle,f?m.startHandle:m.endHandle),class:"scroll-area--end-handle"},_u,"end"),s?n("div",{style:Object.assign({},l.endHandleBorder,f?m.startHandleBorder:m.endHandleBorder)}):void 0);g.push(v)}var b=n("div",{style:Object.assign({},l.thumb,(t={},Wu(t,a.start,i),Wu(t,a.end,r-o),t)),class:"scroll-area--thumb"},g);return n("div",{style:Object.assign({},l.container)},[h,b,p].concat(Uu(d)))}({h:e,size:r,start:i,end:o,properties:this.properties(),startHandleActive:this.state.hover.start||this.state.drag.start,endHandleActive:this.state.hover.end||this.state.drag.end,style:Zu.call(this),continuous:a.isContinuous,invert:"vertical"===a.orientation&&a.rtl,injections:u})}};function Qu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function es(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ts,ns={vertical:{major:"width",minor:"height",start:"left",end:"right",shadow:{startOffset:"12px 0",endOffset:"-12px 0"}},horizontal:{major:"height",minor:"width",start:"top",end:"bottom",shadow:{startOffset:"0 12px",endOffset:"0 -12px"}}},rs=function(e){return"".concat(e," 12px -12px inset rgba(0, 0, 0, ").concat(.0625,")")},is={defaultSettings:{settings:{orientation:"vertical",rtl:!1,range:function(){return[0,1]}}},renderer:"dom",render:function(e){var t=this.settings.settings,n=t.range,r=t.orientation,i=t.rtl,o=Qu(n(),2),a=0===o[0],u=1===o[1],s=function(e){var t,n,r,i=ns[e];return{base:(t={position:"absolute"},es(t,i.major,12),es(t,i.minor,"100%"),t),towardsStart:(n={},es(n,i.start,0),es(n,i.end,"auto"),es(n,"boxShadow",rs(i.shadow.startOffset)),n),towardsEnd:(r={},es(r,i.start,"auto"),es(r,i.end,0),es(r,"boxShadow",rs(i.shadow.endOffset)),r)}}(r),l="vertical"===r&&i,c=[];return a||c.push(e("div",{style:Object.assign({},s.base,l?s.towardsEnd:s.towardsStart),class:"scroll-hint--towards-start"})),u||c.push(e("div",{style:Object.assign({},s.base,l?s.towardsStart:s.towardsEnd),class:"scroll-hint--towards-end"})),c}},os={isInside:function(e,t,n){var r=e.position-e.radius,i=e.position+e.radius;return r>=t&&i<=n},getCenterDistance:function(e,t){return Math.abs(e.center-t.center)},getGap:function(e,t){var n=e.position<t.position?e:t,r=e.position<t.position?t:e;return r.position-r.radius-(n.position+n.radius)},findSegmentPositionMeetMax:function(e,t){var n=Math.max(0,e.max-t);return e.center-n},findSegmentPositionMeetMin:function(e,t){var n=Math.max(0,t-e.min);return e.center+n},findSegmentPositionMeetMinThenMax:function(e,t,n){var r=os.findSegmentPositionMeetMin(e,t);return os.findSegmentPositionMeetMax({center:r,max:r+e.radius},n)},findSegmentPositionMeetMaxThenMin:function(e,t,n){var r=os.findSegmentPositionMeetMax(e,n);return os.findSegmentPositionMeetMin({center:r,min:r-e.radius},t)},layoutPositionFromMin:function(e,t,n){for(var r,i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=e.length-1,u=t,s=0;s<a;s++)r=e[s],i=e[s+1],r.position=os.findSegmentPositionMeetMaxThenMin(r,u,(r.center+i.center-o)/2),u=r.position+r.radius+o/2;i.position=os.findSegmentPositionMeetMaxThenMin(i,u,n)},adjustPositionFromMax:function(e,t,n){var r,i,o,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=e.length-1,s=Math.max(0,e[u].position+e[u].radius-n);if(0!==s){var l,c=0;for(r=u;r>0&&(i=e[r],o=e[r-1],l=Math.max(0,os.getGap(o,i)-a),c+=l-=Math.max(0,c+l-s),i.move=l,!(c>=s));r--);for(c<s&&(l=Math.max(0,o.position-o.radius-t),c+=l-=Math.max(0,c+l-s),o.move=l),c=0,r=0;r<=u;r++)c+=(i=e[r]).move||0,i.move=c,i.position-=c}},layout:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=e.length-1;if(!(i<0))if(0!==i)os.layoutPositionFromMin(e,t,n,r),os.adjustPositionFromMax(e,t,n,r);else{var o=e[0];o.position=os.findSegmentPositionMeetMaxThenMin(o,t,n)}}},as=os;function us(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ss(){ts=ts||document.createElement("canvas").getContext("2d")}var ls={measureTextWidth:function(e){return ss(),ts.measureText(e).width},lineWrap:function(e,t,n,r){var i,o;ss();var a,u,s=e?e.split(/\n+|\r+|\r\n/):[],l=[],c=e?e.split(/\s+/):[],f=s[0];if("number"!=typeof t||t<=0)return[e];if("number"==typeof r&&s.length>=r)return s.slice(0,r);for(n&&(ts.font=n),o=0;o<s.length;o++){for(f=us(c=(s[o]||"").split(/\s+/),1)[0],u="",i=1;i<c.length;i++)if(a="".concat(f," ").concat(c[i]),ls.measureTextWidth(a)>t&&("number"!=typeof r||r>l.length)?(l.push(f),f=c[i]):f=a,"number"==typeof r&&l.length>=r){u=c.slice(i+1).join(" ");break}"number"!=typeof r||l.length<r?l.push(f):l[Math.max(0,l.length-1)]="".concat(l[Math.max(0,l.length-1)]||""," ").concat(f," ").concat(u)}return l},wordWrap:function(e,t,n,r,i){if(ss(),!e||!e.length)return[];n&&(ts.font=n);var o,a,u,s,l=[],c=e.slice();if(c.filter(function(e){return!!e}),"number"!=typeof t||t<0)return e.slice();for(s=0;s<c.length;s++)a=null,(u=c[s])&&(u.length<=1||ls.measureTextWidth(u)<=t?l.push(u):(o=ls.splitWord(u,t,void 0,r-l.length)).length<=1?l.push(o[0]):(a=o.pop(),l=l.concat(o),c[s+1]?ls.measureTextWidth("".concat(a," ").concat(c[s+1]))>t&&l.length+c.length-s<=r?c.splice(s+1,0,a):c[s+1]="".concat(a," ").concat(c[s+1]):c.push(a)));return l.forEach(function(e,t,n){n[t]=e?e.trim():e}),l.length>r?(l=l.splice(0,r))[l.length-1]=ls.truncate(l[l.length-1],t,n,i).text:(u=l[l.length-1])&&u.length>1&&ls.measureTextWidth(u)>t&&(l[l.length-1]=ls.truncate(u,t,n,i).text),l},truncate:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"…";ss();var i,o,a,u=e,s=ls.measureTextWidth("i"),l=Math.ceil(t/s);if(n&&(ts.font=n),e&&t){if(ls.measureTextWidth(u)>t){for(i=Math.min(l,u.length);i>0;i--)if(o=u.substring(0,i-1).trim()+r,ls.measureTextWidth(o)<=t){a=u.substring(i-1),u=o;break}i||(a=u,u="…")}}else a=void 0;return{text:u,rest:a}},isNumber:function(e){return"number"==typeof e&&Number.isFinite(e)},explodeWord:function(e,t,n,r){var i;ss();var o=e,a="",u=[];if(ls.isNumber(n)&&n<=1)return[e];var s=Math.ceil(t/r);for(i=Math.min(e.length,s);i>0&&(o=e.substring(0,i)," "===e.substring(i-1,i)?o=e.substring(0,i-1):o+="-",a=e.substring(i),!(ls.measureTextWidth(o)<=t));i--);return(!i&&!o||ls.measureTextWidth(o)>t)&&(o=e.substring(0,1),a=e.substring(1)),u.push(o),a?(ls.measureTextWidth(a)>t?(a=ls.explodeWord(a,t,n-1,r),u=u.concat(a)):u.push(a),u.filter(function(e){return""!==e.trim()})):u},splitWord:function(e,t,n,r){return ss(),e&&t?(n&&(ts.font=n),ls.explodeWord(e,t,r,Math.max(1,ls.measureTextWidth("i")))):[]},wrapText:function(e,t,n,r,i){var o;return Number.isNaN(t)?[e]:(o=r>1?ls.lineWrap(e,t,n,r):[e],o=ls.wordWrap(o,t,n,r,i))},getFontHeight:function(e){return ss(),e&&(ts.font=e),1.5*ls.measureTextWidth("m")},tokenize:function(e,t,n,r,i,o){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;ss(),t&&(ts.font=t);var u=ls.getFontHeight(),s=a*u,l=[],c=0,f=[];if(o<u)return[];var d=o?Math.max(1,Math.floor(o/s)):r||1;return Array.isArray(r)?(r.forEach(function(e){c+=Number.isNaN(e)||e<=0?0:e}),r.forEach(function(e){l.push(Number.isNaN(e)||e<=0?d-c:e)})):l=[Number.isNaN(r)||r<=0?d:Math.min(d,r)],Array.isArray(e)?e.forEach(function(e,n){f.length<d&&(f=f.concat(ls.wrapText(e,i,t,l[n])))}):f=ls.wrapText(e,i,t,l[0],n),f}},cs=ls,fs="…";function ds(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:70,r=0;r<e.length;r++){var i=e[r];i.lines=cs.tokenize(i.title,t,"".concat(fs," ").concat(i.valueString),3,n),i.maxNumLines=i.lines.length}}function ms(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function hs(e){var t=e.title,n=e.font,r=e.ellipsis,i=e.maxNumLines,o=void 0===i?5:i,a=e.maxWidth,u=void 0===a?200:a,s=cs.tokenize(t,n,r,o,u),l=s.length,c="";if(l){c=ms(s,1)[0];for(var f=1;f<l;f++)c="".concat(c,"\n").concat(s[f])}return c}function ps(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";e.sort(function(e,n){return e[t]-n[t]})}function gs(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ys(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var vs={calculateLabelPositions:function(e,t,n){for(var r=0;r<e.length;r++){var i=e[r];i.center=t(i.value)*n}},addLabelTitles:function(e,t){for(var n,r=0;r<e.length;r++){var i=e[r];n=t?t(i.value):i.value,i.valueString="".concat(Ga.lrm,"(").concat(n,")").concat(Ga.lrm),i.title="".concat(i.text," ").concat(i.valueString)}},measureLabelsWidth:function(e,t){for(var n=0;n<e.length;n++){var r=e[n];r.totalWidth=t(r.title).width}},measureLabelMaxLineWidth:function(e,t){return Math.max.apply(Math,ys(e.lines.map(function(e){return t(e).width})))},getMaxTextWidth:function(e){var t=e.map(function(e){return e.totalWidth});return Math.max.apply(Math,ys(t))},addLabelsNeighborInfo:function(e,t,n){var r,i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=e.length-1;if(!(a<0))if((r=gs(e,1)[0]).cMin=t,0!==a){for(var u=0;u<a;u++)r=e[u],i=e[u+1],r.cMax=(r.center+i.center-o)/2,i.cMin=r.cMax+o;i.cMax=n}else r.cMax=n},getTotalNumLines:function(e){var t=0;return e.forEach(function(e){t+=e.maxNumLines}),t},reduceLabelsHavingMaxNumLines:function(e,t,n){for(var r=t-1,i=e.filter(function(e){return e.maxNumLines===t}),o=Math.min(n,i.length),a=i.length-1;a>=i.length-o;a--)i[a].maxNumLines=r},reduceTotalMaxNumLines:function(e,t,n){var r=Math.floor(n/t),i=3;do{var o=vs.getTotalNumLines(e)-r;if(o<=0)return;vs.reduceLabelsHavingMaxNumLines(e,i,o),i--}while(i>1)},reduceMaxNumLines:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=0;r<e.length;r++){var i=e[r];i.maxNumLines=Math.max(1,Math.min(i.maxNumLines,Math.floor((Math.max(0,i.cMax-i.cMin)+n)/t)))}},addLabelsSize:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15,r=arguments.length>3?arguments[3]:void 0,i=0;i<e.length;i++){var o=e[i];o.width=Math.min(t,vs.measureLabelMaxLineWidth(o,r)),o.height=o.lines.length*n}},addLabelSegments:function(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=r.center,o=r[t],a=o/2;r.segment={center:i,range:o,min:i-a,max:i+a,radius:a}}},addLabelsInfo:function(e){var t=e.labels,n=e.scale,r=e.majorSize,i=e.lowerLimit,o=e.upperLimit,a=e.gap,u=e.font,s=e.maxLabelWidth,l=e.lineHeight,c=e.majorDimension,f=e.orientation,d=e.measureText,m=t.map(function(e){return e});vs.calculateLabelPositions(t,n,r),ps(t,"center"),vs.addLabelsNeighborInfo(t,i,o,a),ds(t,u,s),vs.reduceTotalMaxNumLines(m,l,o-(m.length-1)*a),"vertical"===f&&(vs.reduceMaxNumLines(t,l,.05*a),function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:70,r=0;r<e.length;r++){var i=e[r];i.lines.length>i.maxNumLines&&(i.lines=cs.tokenize(i.title,t,"".concat(fs," ").concat(i.valueString),i.maxNumLines,n))}}(t,u,s)),vs.addLabelsSize(t,s,l,d),vs.addLabelSegments(t,c)},createLabels:function(e){var t=e.labels,n=e.style,r=e.maxLabelWidth,i=e.areaProps,o=e.area,a=e.lineHeigth,u=void 0===a?15:a,s=e.font,l=i.majorAxis,c=i.minorAxis,f=o.minorCenter,d=[];return t.forEach(function(e){var t=e.lines,i=t.length,o=t.map(function(t,o){var a={type:"text",text:t,title:hs({title:e.title,font:s,ellipsis:"".concat("…"," ").concat(e.valueString)}),dx:0,dy:0,maxWidth:r,width:r,fontSize:n.fontSize,fontFamily:n.fontFamily,fill:e.fill,baseline:"central",anchor:"middle"};return a[c]=f,a[l]=e.segment.position,a.y+=(o-(i-1)/2)*u,a});d=d.concat(o)}),d}},bs=vs;function Ms(e){return(Ms="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xs(e,t,n){var r,i=Ms(t);if("string"===i||"object"===i)r=e.formatter(t);else if(void 0!==n&&n.data){var o=n.data()&&n.data().fields;r=o&&o[0]?o[0].formatter():null}return r}function ws(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var qs=function(e){return{dock:e,orientation:"vertical",majorAxis:"y",minorAxis:"x",majorDimension:"height",minorDimension:"width",flipXY:!1}},Ss=function(e){return{dock:e,orientation:"horizontal",majorAxis:"x",minorAxis:"y",majorDimension:"width",minorDimension:"height",flipXY:!0}};function ks(e,t,n){return"top"===e||"bottom"===e?function(e,t){var n=t.font,r=t.lineHeight,i=t.top,o=t.bottom,a=t.maxLabelWidth,u=1;return bs.getMaxTextWidth(e)>a&&(ds(e,n,a),u=Math.max.apply(Math,ws(e.map(function(e){return e.lines.length})))),u*r+i+o}(t,n):function(e,t){var n=t.left,r=t.right,i=t.maxLabelWidth;return Math.min(i,bs.getMaxTextWidth(e))+n+r}(t,n)}function Ds(e){return e.domain()}function Os(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var As={getDefaultSettings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.size,n=void 0===t?10:t,r=e.fill;return{show:!0,type:"n-polygon",fill:void 0===r?"#999":r,stroke:"#000",strokeWidth:0,size:n,sides:3,startAngle:-90,alignment:e.alignment}},createOob:function(e){var t,n=e.oob,r=e.dockValue,i=e.boxCenter,o=e.rendWidth,a=e.rendHeight,u="x",s="y",l=o,c=a,f=r<.5?90:-90;return e.flipXY&&(u="y",s="x",l=a,c=o,f=r<.5?180:0),(0,e.symbol)(g()({},n,(Os(t={},u,i*l),Os(t,s,Math.max(n.size/2,Math.min(r*c,c-n.size/2))),Os(t,"startAngle",f),t)))}},Cs="…";function Ts(e,t,n){var r=e.filter(function(e){return e.value>=t});r=r.filter(function(e){return e.value<=n});var i=e.filter(function(e){return e.value<t}),o=e.filter(function(e){return e.value>n});return{filteredLabels:r,minOobs:i,maxOobs:o,numMinOobs:i.length,numMaxOobs:o.length}}function Ps(e){for(var t,n=0,r=1;r<10;r++)t=e(r),n=Math.max(n,Math.sqrt(t.width*t.width+t.height*t.height));return t=e("9+"),[n,Math.max(n,Math.sqrt(t.width*t.width+t.height*t.height))]}function Ns(e,t){return e>9?t[1]:t[0]}function Ls(e){var t=e.alignment,n=e.dockValue,r=e.oobs,i=e.style,o=e.rect,a=e.symbol,u=e.position,s=e.areaProps,l=e.radius,c=e.font,f=r?r.length:0;if(f<1)return[];var d=s.flipXY,m=s.majorAxis,h=s.minorAxis,p=o[s.minorDimension],g=As.createOob({oob:As.getDefaultSettings({size:i.size,fill:i.fill,alignment:t}),dockValue:n,boxCenter:.5,rendWidth:o.width,rendHeight:o.height,flipXY:d,symbol:a}),y="c".concat(m),v="c".concat(h),b={type:"circle",r:l,stroke:"transparent",fill:i.text.background.fill,strokeWidth:0};b[v]=p/2,b[y]=u;var M={type:"text",text:f>9?"9+":f,title:function(e){var t=e.oobs,n=e.font,r=e.ellipsis,i=e.maxNumLines,o=void 0===i?5:i,a=e.maxWidth,u=void 0===a?200:a,s=t.map(function(e){return hs({title:e.title,font:n,ellipsis:"".concat(r," ").concat(e.valueString),maxNumLines:o,maxWidth:u})}),l=s.length,c="";if(l){c=ms(s,1)[0];for(var f=1;f<l;f++)c="".concat(c,"\n\n").concat(s[f])}return c}({oobs:r,font:c,ellipsis:Cs}),dx:0,dy:0,maxWidth:p,width:p,fontSize:i.text.fontSize,fontFamily:i.text.fontFamily,fill:i.text.fill,baseline:"central",anchor:"middle"};return M[h]=p/2,M[m]=u,[g,b,M]}var js=function(e){var t="normal ".concat(e.fontSize," '").concat(e.fontFamily,"'");return{font:t,lineHeight:cs.getFontHeight(t)*(e.lineHeightMultiplicator||1),gap:e.gap||12,maxLabelWidth:e.maxWidth||75,top:e.padding.top||0,bottom:e.padding.bottom||0,left:e.padding.left||0,right:e.padding.right||0}};function Es(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Is(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Rs={require:["renderer","chart","symbol"],defaultSettings:{layout:{displayOrder:0,prioOrder:0}},preferredSize:function(){var e=this,t=this.settings,n=t.labels,r=t.style,i=xs(this.chart,this.settings.formatter,this.scale);bs.addLabelTitles(n,i);var o=Is(Ds(this.scale),2),a=Ts(n,o[0],o[1]),u=a.numMaxOobs,s=a.numMinOobs,l=a.filteredLabels;if(this.measureText=function(t){return e.renderer.measureText({text:t,fontSize:r.label.fontSize,fontFamily:r.label.fontFamily})},l&&l.length){var c=js(r.label),f=this.settings.layout.dock;return bs.measureLabelsWidth(l,this.measureText),ks(f,l,c)}var d=Ps(this.measureText),m=u?Ns(u,d):0,h=s?Ns(s,d):0;return Math.max(m,h)},render:function(){var e=this.symbol,t=this.settings,n=t.labels,r=t.style,i=this.settings.layout,o=i.dock,a=i.rtl,u=r.label.padding,s=function(e){return"left"===e||"right"===e?qs(e):Ss(e)}(o),l=function(e,t,n){var r=e[t.minorDimension];return{minorSize:r,majorSize:e[t.majorDimension],minorCenter:"vertical"===t.orientation?(r-n.right-n.left)/2+n.left:(r-n.top-n.bottom)/2+n.top}}(this.rect,s,u),c=s.orientation,f=s.majorDimension,d=l.majorSize,m=js(r.label),h=m.font,p=m.lineHeight,g=m.gap,y=m.maxLabelWidth,v=xs(this.chart,this.settings.formatter,this.scale);bs.addLabelTitles(n,v);var b=Is(Ds(this.scale),2),M=function(e){var t=e.labels,n=e.minValue,r=e.maxValue,i=e.orientation,o=e.rtl,a=e.style,u=e.padding,s=e.measureText,l=Ts(t,n,r),c=l.maxOobs,f=l.minOobs,d=l.filteredLabels,m=function(e,t,n,r){return"horizontal"!==e||t?r:n}(i,o,f,c),h=function(e,t,n,r){return"horizontal"!==e||t?n:r}(i,o,f,c),p=m.length,g=h.length,y=Ps(s),v=Ns(p,y),b=Ns(g,y);return{filteredLabels:d,lowerOobs:m,upperOobs:h,lowerCircleSize:v,upperCircleSize:b,lowerOobSpace:function(e,t,n,r,i){return("vertical"===r?i.top:i.left)+(e>0?t+n:0)}(p,a.oob.size,v,i,u),upperOobSpace:function(e,t,n,r,i){return("vertical"===r?i.bottom:i.right)+(e>0?t+n:0)}(g,a.oob.size,b,i,u)}}({labels:n,minValue:b[0],maxValue:b[1],orientation:c,rtl:a,style:r,padding:u,measureText:this.measureText}),x=M.filteredLabels,w=M.lowerOobs,q=M.upperOobs,S=M.lowerCircleSize,k=M.upperCircleSize,D=M.lowerOobSpace,O=M.upperOobSpace,A=D,C=d-O;ps(w),ps(q);var T=Ls({alignment:0,dockValue:0,oobs:w,style:r.oob,rect:this.rect,symbol:e,position:r.oob.size+S/2,areaProps:s,radius:S/2,font:h}),P=Ls({alignment:1,dockValue:1,oobs:q,style:r.oob,rect:this.rect,symbol:e,position:d-(r.oob.size+k/2),areaProps:s,radius:k/2,font:h});bs.addLabelsInfo({labels:x,scale:this.scale,majorSize:d,lowerLimit:A,upperLimit:C,font:h,lineHeight:p,gap:g,maxLabelWidth:y,majorDimension:f,orientation:c,measureText:this.measureText}),as.layout(x.map(function(e){return e.segment}),A,C,r.label.gap);var N=x.filter(function(e){return as.isInside(e.segment,A,C)});return bs.createLabels({labels:N,style:r.label,maxLabelWidth:y,areaProps:s,area:l,lineHeigth:p,font:h}).concat([].concat(Es(T),Es(P)))}};var Hs=function(e){var t=e.scale("band");e.scale("group-by-measure",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=t(e,n,r),o=i.domain(),a=i.ticks(),u=[],s=e.measureCount;return o.forEach(function(e,t){for(var n=0;n<s;++n)u.push(String([e,n]));u.push("SPACER_".concat(t,"_SPACER"))}),u.splice(-1),i.domain(u),function e(t,n,r,i){var o=function(e){var n=String(e);return t(n)};return o.ticks=function(){return n.map(function(e){var n=o([e.data.value,i?r-1:0]),a=o([e.data.value,i?0:r-1])+t.bandwidth();return{position:(n+a)/2,label:e.label,data:e.data,start:n,end:a}})},o.bandwidth=function(){return t.bandwidth()},o.data=function(){return t.data()},o.domain=function(){return t.domain()},o.pxScale=function(i){var o=t.pxScale(i);return o===t?this:e(o,n,r)},o}(i,a,s,e.invert)})};function Bs(e){var t,n=e.i,r=e.width,i=e.height,o=e.resolved,a=e.keys,u=e.flipXY,s=e.calcKey,l=void 0===s?"box":s,c=null,f=null;void 0!==o.major.settings.binStart?(c=o.major.items[n].binStart,f=o.major.items[n].binEnd,t=o.major.settings.binStart.scale):c=(t=o.major.settings.major.scale)?o.major.items[n].major:0;var d=0;t?t.bandwidth?c-=(d=t.bandwidth())/2:d=f-c:d=1;var m=g()({},{major:c,majorEnd:f},o.minor.items[n]);a.forEach(function(e){m[e]=o[e].items[n]});var h=u?i:r,p=function(e){var t=e.bandwidth,n=e.width,r=e.minWidthPx,i=e.maxWidthPx,o=e.maxMajorWidth,a=t>=0?1:-1,u=Math.min(a*t*n,Number.isNaN(Number(i))?o:i/o);return(u=Number.isNaN(Number(r))?u:Math.max(r/o,u))*a}({bandwidth:d,width:m[l].width,minWidthPx:m[l].minWidthPx,maxWidthPx:m[l].maxWidthPx,maxMajorWidth:h}),y=(d-p)/2,v=y+m.major+p/2;return{item:m,boxCenter:v,boxWidth:p,boxPadding:y,rendWidth:r,rendHeight:i}}function zs(e){return(zs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fs(e){var t,n=e.keys,r=e.data,i=e.defaultSettings,o=e.style,a=e.settings,u=e.width,s=e.height,l=e.resolver,c=g()(!0,{},i||{},o||{}),f={major:"horizontal"===a.orientation?s:u,minor:"horizontal"===a.orientation?u:s},d=a.major;t="object"===zs(d)&&"object"===zs(d.ref)&&void 0!==d.ref.start&&void 0!==d.ref.end?l.resolve({data:r,defaults:{start:0,end:1},scaled:f,settings:g()(!0,{},{binStart:{scale:a.major.scale,ref:a.major.ref.start},binEnd:{scale:a.major.scale,ref:a.major.ref.end}})}):"object"===zs(d)&&void 0!==d.binStart&&void 0!==d.binEnd?l.resolve({data:r,defaults:{start:0,end:1},scaled:f,settings:g()(!0,{},{binStart:{scale:a.major.scale,ref:"binStart"},binEnd:{scale:a.major.scale,ref:"binEnd"}},a.major)}):l.resolve({data:r,scaled:f,defaults:{major:.5},settings:{major:a.major}});for(var m,h=a.minor||{},p={major:t,minor:l.resolve({data:r,defaults:{start:0,end:1},scaled:f,settings:g()(!0,{},{start:{scale:h.scale,ref:"start"},end:{scale:h.scale,ref:"end"},min:{scale:h.scale,ref:"min"},max:{scale:h.scale,ref:"max"},med:{scale:h.scale,ref:"med"}},h)})},y=0,v=n.length;y<v;y++)p[m=n[y]]=l.resolve({data:r,defaults:c[m],settings:a[m],scaled:f});return p}function _s(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Vs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Us={size:25,hat:{show:!0,fill:"#999",stroke:"#000",strokeWidth:0,strokeLinejoin:"miter",width:1,maxWidthPx:void 0,minWidthPx:1,minHeightPx:1,alignment:0}},Ws=["hat"];function Ks(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="",r=0;r<e.length;r++){var i=e[r];n+=0===r?"M".concat(i.x," ").concat(i.y):"L".concat(i.x," ").concat(i.y),n+=" "}return t&&(n+="Z"),n}function Gs(e){var t,n,r,i,o,a,u,s,l,c,f=e.item,d=e.boxWidth,m=e.boxPadding,h=e.rendWidth,p=e.rendHeight,y=e.flipXY,v="x",b="y",M=h,x=p,w=f.hat.alignment||0;y&&(v="y",b="x",M=p,x=h,w=1-w);var q=(m+f.major)*M,S=[(t={},Vs(t,v,q),Vs(t,b,0+x),t),(n={},Vs(n,v,q+d*w*M),Vs(n,b,8),n),(r={},Vs(r,v,q+d*M),Vs(r,b,0+x),r),(i={},Vs(i,v,q+d*M),Vs(i,b,0+x+10),i),(o={},Vs(o,v,q),Vs(o,b,0+x+10),o)],k=g()({},f.hat,{type:"path",d:Ks(S)});return S=[(a={},Vs(a,v,q),Vs(a,b,0),a),(u={},Vs(u,v,q+d*(1-w)*M),Vs(u,b,0+x-8),u),(s={},Vs(s,v,q+d*M),Vs(s,b,0),s),(l={},Vs(l,v,q+d*M),Vs(l,b,-10),l),(c={},Vs(c,v,q),Vs(c,b,-10),c)],[k,g()({},f.hat,{type:"path",d:Ks(S)})]}var Ys={require:["chart","resolver","symbol"],defaultSettings:{settings:{size:25},data:{},style:{hat:"$shape"}},created:function(){this.state={}},preferredSize:function(){return this.settings.settings.size},render:function(){var e=this.rect,t=e.width,n=e.height,r="horizontal"===this.settings.settings.orientation,i=this.data,o=this.style,a=this.resolver,u=Fs({keys:Ws,data:i,defaultSettings:Us,style:o,settings:this.settings.settings,width:t,height:n,resolver:a}),s=u.settings;return function(e){for(var t=e.width,n=e.height,r=e.flipXY,i=e.resolved,o=e.keys,a=e._calcItemRenderingOpts,u=void 0===a?Bs:a,s=[],l=i.major.items,c=0,f=l.length;c<f;c++){var d=u({i:c,width:t,height:n,resolved:i,keys:o,flipXY:r,calcKey:"hat"}),m=d.item,h=d.boxWidth,p=d.boxPadding,g=d.rendWidth,y=d.rendHeight,v=l[c].data,b=[];m.hat.show&&b.push.apply(b,_s(Gs({item:m,boxWidth:h,boxPadding:p,rendWidth:g,rendHeight:y,flipXY:r})));var M={type:"container",data:v,collider:{type:"bounds"},children:b};s.push(M)}return s}({items:u.items,settings:s,width:t,height:n,flipXY:r,resolved:u,keys:Ws})}},Xs=["oob"];var Js={require:["chart","resolver","symbol"],defaultSettings:{settings:{size:10},data:{},style:{}},created:function(){this.state={}},preferredSize:function(){return this.settings.settings.size},render:function(){var e=this.rect,t=e.width,n=e.height,r=this.settings.settings.dockValue,i="horizontal"===this.settings.settings.orientation,o=this.data,a=this.style,u=this.resolver,s=this.symbol,l=Fs({keys:Xs,data:o,defaultSettings:{oob:As.getDefaultSettings()},style:a,settings:this.settings.settings,width:t,height:n,resolver:u}),c=l.settings;return function(e){for(var t=e.width,n=e.height,r=e.flipXY,i=e.resolved,o=e.keys,a=e.symbol,u=e.dockValue,s=e._calcItemRenderingOpts,l=void 0===s?Bs:s,c=[],f=i.major.items,d=0,m=f.length;d<m;d++){var h=l({i:d,width:t,height:n,resolved:i,keys:o,flipXY:r,calcKey:"oob"}),p=h.item,g=h.boxCenter,y=h.rendWidth,v=h.rendHeight,b=f[d].data,M=[];if(p.oob.show){M.push(As.createOob({oob:p.oob,dockValue:u,boxCenter:g,rendWidth:y,rendHeight:v,flipXY:r,symbol:a}));var x={type:"container",data:b,collider:{type:"bounds"},children:M};c.push(x)}}return c}({items:l.items,settings:c,width:t,height:n,flipXY:i,resolved:l,keys:Xs,symbol:s,dockValue:r})}};var Zs={BAR:{WIDTH:.7,STROKE:{COLOR:"#205891",WIDTH:{NONE:0,SMALL:1,MEDIUM:2,LARGE:4}}}},$s=function(e){var t={qHyperCubeDef:{qDimensions:[],qMeasures:[],qInitialDataFetch:[{qWidth:17,qHeight:500}],qSuppressZero:!1,qSuppressMissing:!0},showTitles:!0,title:"",subtitle:"",footnote:"",showDetails:!1,refLine:{refLines:[]},barGrouping:{grouping:"grouped"},orientation:"vertical",scrollStartPos:0,gridLine:{auto:!0,spacing:2},dataPoint:{showLabels:!1,showSegmentLabels:!1,showTotalLabels:!0},color:{auto:!0,mode:"primary",singleColor:void 0,paletteColor:{index:void 0,color:void 0},persistent:!1,useDimColVal:!0,expressionLabel:"",expressionIsColor:!0,measureScheme:"sg",reverseScheme:!1,dimensionScheme:"12",dimensionId:void 0,autoMinMax:!0,measureMin:void 0,measureMax:void 0,useBaseColors:"off"},legend:{show:!0,dock:"auto",showTitle:!0},dimensionAxis:{show:"all",label:"auto",dock:"near",continuousAuto:!0},measureAxis:{show:"all",dock:"near",spacing:1,autoMinMax:!0,minMax:"min",min:0,max:10},preferContinuousAxis:!0,showMiniChartForContinuousAxis:!0};return e&&e.getFlag("BC_STYLE_EDITOR")&&(t.components=[{key:"bar",style:{width:Zs.BAR.WIDTH,strokeColor:{index:-1,color:Zs.BAR.STROKE.COLOR},strokeWidth:"none"}}]),t},Qs={dimensions:{min:0,max:function(e){return e>1?1:2}},measures:{min:1,max:function(e){return e>1?1:15}}};function el(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tl(e){return{properties:$s(e),data:{targets:[function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){el(e,t,n[t])})}return e}({path:"/qHyperCubeDef"},Qs)]}}}function nl(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var rl=1e4;function il(e,t){return Math.floor(rl/(e+t))}var ol=function(e){var t=e.getLayoutValue("trendLines"),n=e.getLayoutValue("qHyperCube.qDimensionInfo.0"),r=[];return(t||[]).forEach(function(e,t){r=r.concat(function(e,t,n){return e&&t?function(e,t,n,r,i){var o=e*n+r;return[{x:e,y:o,index:i},{x:t,y:o+n*(t-e),index:i}]}(e.qMin,e.qMax,t.slope,t.offset,n):null}(n,e,t))}),r};function al(e){var t=zo.continuous(e);return{isDiscrete:!t,isContinuous:t,isTime:Bo.isTime(t,e),isDimensionless:zo.dimensionless(e),isSimple:zo.simple(e),isGrouped:zo.grouped(e),isGroupedByMeasure:zo.groupedByMeasure(e),isGroupedByDimension:zo.groupedByDimension(e),isStacked:zo.stacked(e),isStackedByDimension:zo.stackedByDimension(e),isStackedByMeasure:zo.stackedByMeasure(e),isSnapshot:zo.snapshot(e)}}function ul(e){var t=e.layout;return!(!t||!t.snapshotData)&&{width:t.snapshotData.content.size.w,height:t.snapshotData.content.size.h}}function sl(e){return e.qIsOtherCell||-3===e.qElemNumber||-3===e.qElemNo}function ll(e){return e.some(sl)}function cl(e,t){var n=NaN,r=NaN;return e.forEach(function(e){ll(e)||e.slice(-t).forEach(function(e){n=Number.isNaN(n)?e.qNum:Math.min(e.qNum,n),r=Number.isNaN(r)?e.qNum:Math.max(e.qNum,r)})}),{min:n,max:r}}function fl(e){var t=NaN,n=NaN,r=!1,i=!1;if(!e.getLayoutValue("measureAxis.autoMinMax",!1)){var o=e.getLayoutValue("measureAxis.minMax");"min"!==o&&"minMax"!==o||(t=e.getLayoutValue("measureAxis.min"),r=!0),"max"!==o&&"minMax"!==o||(n=e.getLayoutValue("measureAxis.max"),i=!0)}return{min:t,max:n,isExplicitMin:r,isExplicitMax:i}}function dl(e,t){var n=NaN,r=NaN;return e.forEach(function(e){if(!ll(e)){var i=0,o=0;e.slice(-t).forEach(function(e){"NaN"!==e.qNum&&(e.qNum>=0?o+=e.qNum:i+=e.qNum)}),n=Number.isNaN(n)?i:Math.min(i,n),r=Number.isNaN(r)?o:Math.max(o,r)}}),{min:n,max:r}}function ml(e,t){var n={};e.forEach(function(e){if(!ll(e)){var r=e[0].qElemNumber;n[r]=n[r]?n[r]:{min:0,max:0,cId:r},e.slice(t).forEach(function(e){"NaN"!==e.qNum&&(e.qNum>=0?n[r].max+=e.qNum:n[r].min+=e.qNum)})}});var r=NaN,i=NaN;return Object.keys(n).forEach(function(e){r=Number.isNaN(r)?n[e].min:Math.min(n[e].min,r),i=Number.isNaN(i)?n[e].max:Math.max(n[e].max,i)}),{min:r,max:i}}function hl(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function pl(e){return"number"==typeof e&&!Number.isNaN(e)}function gl(e){var t=e.getLayoutValue("qHyperCube.qMeasureInfo");return{min:Math.min.apply(Math,hl(t.filter(function(e){return pl(e.qMin)}).map(function(e){return e.qMin}))),max:Math.max.apply(Math,hl(t.filter(function(e){return pl(e.qMax)}).map(function(e){return e.qMax})))}}function yl(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function vl(e,t,n){for(var r=e.length-1;r>-1;r--)if(t(e[r]))return e[r];return n}function bl(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ml(e){return!Number.isNaN(+e.qNum)}function xl(e){return e.qNum}function wl(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ql(e){return!Number.isNaN(+e.qNum)}function Sl(e){return e.qNum}function kl(e,t){return e.push.apply(e,wl(t)),e}function Dl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ol=5;function Al(e,t){return Math.abs(e/t)<Ol||0===t}function Cl(e){var t=e.layoutModel,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.stackedByMeasureExtractor,i=void 0===r?dl:r,o=n.stackedByDimensionExtractor,a=void 0===o?ml:o,u=n.straightExtractor,s=void 0===u?cl:u,l=n.measureInfoExtractor,c=void 0===l?gl:l,f=n.explicitExtractor,d=void 0===f?fl:f,m=t.meta;return{extract:function(e){var t,n,r=e.qDataPages,i=e.qStackedDataPages,o=e.others,a=e.count;if(Array.isArray(i)){var u=this.extractFromStacked(i);t=u.min,n=u.max}else{var s=this.extractFromStraight(r,a);t=s.min,n=s.max}var l=this.extractOthers(o),c=l.min,f=l.max,d=this.extractExplicit(),m=Math.min(0,t||0),h=Math.max(0,n||0);return m=Al(c,m)?Math.min(m,c):m,h=Al(f,h)?Math.max(h,f):h,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Dl(e,t,n[t])})}return e}({min:t=Number.isNaN(d.explicitMin)?m:d.explicitMin,max:n=Number.isNaN(d.explicitMax)?h:d.explicitMax,implicitMin:m,implicitMax:h,otherMin:c,otherMax:f,hasOtherMin:c<t,hasOtherMax:f>n},d)},extractExplicit:function(){var e=d(t),n=e.min,r=e.max,i=e.isExplicitMin,o=e.isExplicitMax;return{hasExplicitMinMax:i||o,hasExplicitMin:i,hasExplicitMax:o,explicitMin:n,explicitMax:r}},extractFromStacked:function(e){var t,n=e.length?e[0].qData:[];return(t=n).length?{min:Math.min.apply(Math,yl(t[0].qSubNodes.map(function(e){return e.qMinNeg}))),max:Math.max.apply(Math,yl(t[0].qSubNodes.map(function(e){return e.qMaxPos})))}:{min:0,max:0}},extractFromStraight:function(e,n){var r=e.length?e[0].qMatrix:[];return m.isStackedByMeasure?i(r,n):m.isStackedByDimension?a(r,n):t.getLayoutValue("qHyperCube.qHasOtherValues")?s(r,n):c(t)},extractOthers:function(e){return m.isStackedByDimension?(t=e,{min:(n=vl(b.getValue(t,"0.qData.0.qSubNodes",[]),sl,{qMaxPos:0,qMinNeg:0})).qMinNeg,max:n.qMaxPos}):m.isGroupedByDimension?(r=e,i=b.getValue(r,"0.qMatrix",[]).filter(ll).reduce(kl,[]).filter(ql).map(Sl),{min:Math.min.apply(Math,[0].concat(wl(i))),max:Math.max.apply(Math,[0].concat(wl(i)))}):function(e){var t=vl(b.getValue(e,"0.qMatrix",[]),ll,[]).filter(Ml).map(xl);return{min:Math.min.apply(Math,[0].concat(bl(t))),max:Math.max.apply(Math,[0].concat(bl(t)))}}(e);var t,n,r,i}}}function Tl(e){return e.layoutModel.meta.isContinuous?function(e){var t=e.viewState.get("zoom"),n=e.viewCache.get("continuousMin"),r=e.viewCache.get("continuousMax");return[(t.min-n)/(r-n),(t.max-n)/(r-n)]}(e):function(e){return e.viewState.get("viewRange")}(e)}var Pl=function(e){return{miniChart:e===u.OPTIONS.MINI_CHART.value,bar:e===u.OPTIONS.BAR.value,none:e===u.OPTIONS.NONE.value}};function Nl(e){var t=e.layoutModel,n=t.getLayoutValue("scrollbar");if(n)return Pl(n);var r=t.getLayoutValue("showMiniChartForContinuousAxis");return Pl(void 0===r?u.DEFAULT.value:r?u.OPTIONS.MINI_CHART.value:u.OPTIONS.NONE.value)}var Ll={refLines:{minimumLayoutMode:"SPARK"},measureAxisTitle:{minimumLayoutMode:"XSMALL"},dimensionAxisTitle:{minimumLayoutMode:"XSMALL"},measureAxis:{minimumLayoutMode:"XSMALL"},dimensionAxis:{minimumLayoutMode:"XSMALL"},gridLines:{minimumLayoutMode:"XSMALL"},scrollArea:{minimumLayoutMode:"XSMALL"},refLinesLabels:{minimumLayoutMode:"SMALL"},verticalDimensionAxis:{minimumLayoutMode:{width:"XSMALL",height:"SMALL"}},horizontalDimensionAxis:{minimumLayoutMode:{width:"SMALL",height:"XSMALL"}},verticalDimensionAxisTitle:{minimumLayoutMode:{width:"XSMALL",height:"MEDIUM"}},horizontalDimensionAxisTitle:{minimumLayoutMode:{width:"MEDIUM",height:"XSMALL"}}};function jl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function El(e){var t=e.layoutModel,n=e.discrete;return function(e){var r=e.h,i=e.rect,o=e.orientation,a=e.minThumbSize,u=n.query.getCachedDataPages(),s=t.meta.size.y,l="vertical"===o,c=i[l?"width":"height"],f=u.qArea.qTop/s*c,d=u.qArea.qHeight/s*c;if(d<a){var m=(a-d)/2;f=f-m+(Math.max(0,0-(f-m))-Math.max(0,f+d+m-c)),d=a}return r("div",{style:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){jl(e,t,n[t])})}return e}({position:"absolute",right:0,bottom:0,background:"red",opacity:.2},l?{top:0,left:f,width:d}:{top:f,left:0,height:d})})}}function Il(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rl(e,t){return{layoutModes:jo.getLayoutModes(),center:void 0!==t.minCenterRatio?{minWidthRatio:t.minCenterRatio,minHeightRatio:t.minCenterRatio}:void 0,logicalSize:t.logicalSize?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Il(e,t,n[t])})}return e}({align:.5,preserveAspectRatio:!0},t.logicalSize):void 0}}var Hl=function(e,t){var n=e.key,r=e.requireFailure,i=e.recognizeWith,o=e.eventName,a=void 0===o?"tap":o;return{prio:1,key:"event:".concat(n,"-tap"),type:"Tap",requireFailure:r,recognizeWith:i,options:{event:"".concat(a,"-").concat(n,"-tap"),interval:10,pointers:1,enable:function(e,r){return!!(r&&t.actions.select.enabled()&&(r.target&&"INPUT"===r.target.nodeName||r.target&&r.target.hasAttribute("data-other-value")&&(r.target.getAttribute("data-key")||"").split("-")[0]===n))}},events:function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},"".concat(a,"-").concat(n,"-tap"),function(e){(e.target.getAttribute("data-key")||"").split("-")[0]&&(e.preventDefault(),this.chart.component(n).emit("bubbleStart",e))})}};function Bl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zl=function(e,t,n){var r,i=e.eventName,o=e.key,a=e.fillTargets,u=void 0===a?[]:a,s=e.requireFailure,l=e.recognizeWith;return{key:"event:".concat(o),type:"Pan",requireFailure:s,recognizeWith:l,options:{event:i,enable:function(e,n){if(this.started===i||!n)return!0;if(!t.actions.select.enabled())return!1;var r=this.chart.componentsFromPoint({x:n.center.x,y:n.center.y}).filter(function(e){return-1!==u.indexOf(e.key)});return 0===r.length&&function(e,t){var n=e.srcEvent.target;return!(!n||0!==(n.getAttribute("data-key")||"").indexOf("".concat(t,"-")))}(n,o)?(this.started=i,!0):r.length>0}},events:(r={},Bl(r,"".concat(i,"start"),function(e){e.preventDefault(),t.actions.select.emit("start",i),this.chart.component(o).emit("".concat(n,"Start"),e),this.started=i}),Bl(r,"".concat(i,"move"),function(e){e.preventDefault(),this.chart.component(o).emit("".concat(n,"Move"),e)}),Bl(r,"".concat(i,"end"),function(e){e.preventDefault(),this.chart.component(o).emit("".concat(n,"End"),e),t.actions.select.emit("end",i),this.started=!1}),r)}},Fl=function(e,t){var n=function(e){var t=e.key,n=e.targets,r=e.fillTargets,i=e.targetSelector,o=e.targetFillSelector,a=e.dock,u=e.scale,s=e.bubblesPlacement,l=void 0===s?"inside":s,c=e.observeBrush,f=void 0!==c&&c,d=e.multiple,m=void 0!==d&&d,h=e.toLabel,p=e.onEdited;return{key:t,type:"brush-range",layout:{dock:n.map(function(e){return"@".concat(e)}).join(",")},on:p?{bubbleEnd:function(){p()}}:{},settings:{brush:f?{context:"selection",observe:!0}:"selection",scale:u,multiple:m,direction:"left"===a||"right"===a?"vertical":"horizontal",bubbles:{align:"left"===a||"top"===a?"end":"start",placement:l,label:h},target:{components:r,selector:i,fillSelector:o,fill:"rgba(82,204,82,0.2)"}}}}(e),r=zl(e,t,"range");return{interactions:[e.onEdited?Hl(e,t):null,r].filter(Boolean),components:[n]}},_l={MAJOR:"major",MAJOR_INNER:"majorInner",MAJOR_NUM:"majorNum",MINOR:"minor"},Vl="inner-time-axis",Ul="outer-time-axis";var Wl={getMaxGlyphCount:function(e,t){return e.qDimensionInfo[t].qApprMaxGlyphCount},getDimensionSize:function(e){return e.qCardinalities.qHypercubeCardinal}},Kl={stringWidthOverMWidth:function(e){return(12*Math.min(e,3)+Math.max(e-3,0)*(166/26))/11},getCharacterRatios:function(e){if(!e)return{latin:0,cjk:0};var t=e.match(/[\u4E00-\u9FFF]/g),n=e.match(/[\u3040-\u309F]/g),r=e.match(/[\u30A0-\u30FF]/g),i=(t=t?t.length:0)+(n=n?n.length:0)+(r=r?r.length:0);return{latin:e.length-i,cjk:i}},getTotalCharacterRatios:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"qText";if(!e)return{latinRatio:1,cjkRatio:0};var r,i={latin:0,cjk:0};void 0===t?e.forEach(function(e){r=Kl.getCharacterRatios(e[n]),i.latin+=r.latin,i.cjk+=r.cjk}):e.forEach(function(e){r=Kl.getCharacterRatios(e[t][n]),i.latin+=r.latin,i.cjk+=r.cjk});var o=Math.max(1,i.latin+i.cjk);return i.latinRatio=i.latin/o,i.cjkRatio=i.cjk/o,i},getAdjustedMaxGlyphCount:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"qText",i=Kl.getTotalCharacterRatios(t,n,r),o=i.latinRatio*e,a=i.cjkRatio*e;return Math.ceil(Kl.stringWidthOverMWidth(o)+a*(12/11))}},Gl=Kl,Yl={getMajorAxisMaxGlyphCount:function(e,t){var n=0;if(e.qDimensionInfo.length){var r=t?0:e.qDimensionInfo.length-1;n=Wl.getMaxGlyphCount(e,r)}else e.qMeasureInfo.forEach(function(e){n=Math.max(n,e.qFallbackTitle.length)});return n},getAxisData:function(e,t){return e.qDimensionInfo.length?b.getValue(e,t?"qStackedDataPages.0.qData.0.qSubNodes":"qDataPages.0.qMatrix"):e.qMeasureInfo},getBarAxisMaxGlyphCount:function(e,t){if(e){var n=Yl.getAxisData(e,t),r=!e.qDimensionInfo.length,i=r||t?void 0:e.qDimensionInfo.length-1,o=Yl.getMajorAxisMaxGlyphCount(e,t),a=r?"qFallbackTitle":"qText";return Gl.getAdjustedMaxGlyphCount(o,n,i,a)}},getGroupAxisMaxGlyphCount:function(e){if(e){var t=Yl.getAxisData(e),n=Wl.getMaxGlyphCount(e,0);return Gl.getAdjustedMaxGlyphCount(n,t,0)}}},Xl=Yl,Jl={LOWERGLYPHCOUNT:3,UPPERGLYPHCOUNT:13};function Zl(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function $l(e,t,n,r){var i=t.layoutModel.meta,o=[],a=!("none"===e.measureAxis.show),u=!("title"===e.measureAxis.show);return i.isContinuous?o.push.apply(o,Zl(function(e,t,n,r){var i=t.layoutModel.meta,o=t.themeModel,a=o.axis,u=o.grid,s=[],l="none"!==e.dimensionAxis.show&&"title"!==e.dimensionAxis.show,c=Ll["".concat(t.dockModel.major.orientation,"DimensionAxis")].minimumLayoutMode,f={type:"grid-line",x:{},layout:{minimumLayoutMode:Ll.gridLines.minimumLayoutMode},ticks:{stroke:u.line.major.color},minorTicks:{show:!1,stroke:u.line.minor.color}},d=!!e.showMiniChartForContinuousAxis&&{type:"range",key:"range-brush-highlighter",layout:{dock:"@scroll-area"},settings:{scale:t.reducedDataModel.scales.major,brush:"selection",fill:"#6CB33F",opacity:.2}};if(i.isTime){if(l){var m=n.rtl?"end":"start",h=n.rtl?1:0,p="bottom"===t.dockModel.major.dock?0:1,y={label:{fill:a.label.name.color,fontSize:a.label.name.fontSize,fontFamily:a.label.name.fontFamily},majorGuideLine:{stroke:a.line.major.color},minorGuideLine:{stroke:a.line.minor.color}},v={type:"time-axis",renderer:"svg",layout:{dock:t.dockModel.major.dock,minimumLayoutMode:c},preferredSize:function(){return{size:2*parseFloat(a.label.name.fontSize),edgeBleed:{left:1,right:1}}},settings:{anchor:m,label:{align:p,justify:h},guideLine:{major:{justify:h},minor:{align:p}}},style:y};s.push(g()(!0,{},v,{key:Vl,scale:_l.MAJOR_INNER,settings:{guideLine:{minor:{show:!0}}},style:g()(!0,{},y,{majorGuideLine:{stroke:a.line.minor.color},minorGuideLine:{stroke:a.line.major.color}})})),s.push(g()(!0,{},v,{key:Ul,scale:_l.MAJOR,settings:{guideLine:{minor:{show:!1}}}})),s.push({type:"axis-overlay",key:"outer-axis-overlay",scale:_l.MAJOR,layout:{dock:"@".concat(Ul),minimumLayoutMode:c}}),s.push({type:"axis-overlay",key:"inner-axis-overlay",scale:_l.MAJOR_INNER,layout:{dock:"@".concat(Vl),minimumLayoutMode:c}}),s.push(d)}return s.push(g()(!0,{},f,{key:"inner-time-grid",x:{scale:_l.MAJOR_INNER},ticks:{stroke:u.line.minor.color}})),s.push(g()(!0,{},f,{key:"outer-time-grid",x:{scale:_l.MAJOR}})),s}i.isContinuous&&(l&&(s.push({type:"axis",key:"continuous-axis",scale:_l.MAJOR,layout:{dock:t.dockModel.major.dock,minimumLayoutMode:c},settings:{labels:{align:0,offset:4,fill:a.label.name.color,fontSize:a.label.name.fontSize,fontFamily:a.label.name.fontFamily},ticks:{show:!0,stroke:a.line.major.color},line:{show:!r},minorTicks:{show:!1}}}),s.push({type:"axis-overlay",key:"inner-axis-overlay",scale:_l.MAJOR,layout:{dock:"@".concat("continuous-axis"),minimumLayoutMode:c}}),s.push(d)),s.push(g()(!0,{},f,{key:"continuous-grid",x:{scale:_l.MAJOR},minorTicks:{show:!0}})));return s}(e,t,n,r))):o.push.apply(o,Zl(function(e,t,n,r){if("none"===e.dimensionAxis.show)return[];var i=t.layoutModel.meta,o=t.dockModel.minor.containerSize/4,a=[],u=function(e,t){return!t.layoutModel.meta.isGroupedByDimension||!e.legend.show||t.colorModel.settings().field!==t.viewModel.fields.major}(e,t),s=function(e,t){return!(!t.layoutModel.meta.isGroupedByDimension||e.legend.show&&t.colorModel.settings().field===t.viewModel.fields.majorGroup)}(e,t),l="vertical"===t.dockModel.major.orientation,c={type:"axis",layout:{dock:t.dockModel.major.dock,minimumLayoutMode:Ll["".concat(t.dockModel.major.orientation,"DimensionAxis")].minimumLayoutMode},settings:{labels:{show:!("title"===e.dimensionAxis.show),mode:l?e.dimensionAxis.label:"auto",tiltAngle:n.rtl?-40:40,maxEdgeBleed:50,maxLengthPx:o,fill:t.themeModel.axis.label.name.color,fontSize:t.themeModel.axis.label.name.fontSize,fontFamily:t.themeModel.axis.label.name.fontFamily},line:{show:!r,stroke:t.themeModel.axis.line.major.color}},brush:{consume:[{context:"selection",data:["selectionDimension"],style:{inactive:{opacity:.3}}}]}};s&&a.push(g()(!0,{},c,{key:"group-axis",scale:_l.MAJOR_INNER,settings:{paddingEnd:u?10:4,labels:{mode:u?"horizontal":c.settings.labels.mode,maxGlyphCount:Xl.getGroupAxisMaxGlyphCount(e.qHyperCube),maxLengthPx:o},line:{show:(l||!u)&&c.settings.line.show}}}));var f=Xl.getBarAxisMaxGlyphCount(e.qHyperCube,i.isStackedByDimension);return u&&a.push(g()(!0,{},c,{key:Wo.COMPONENT.BAR_AXIS,scale:_l.MAJOR,settings:{paddingEnd:4,labels:{maxGlyphCount:f,maxLengthPx:o,tiltThreshold:f>Jl.LOWERGLYPHCOUNT&&f<Jl.UPPERGLYPHCOUNT?1:void 0},line:{show:!(l&&s)&&c.settings.line.show}}})),l||2!==a.length?a:[a[1],a[0]]}(e,t,n,r))),a&&o.push({type:"axis",key:"y-axis",formatter:"bar",layout:{dock:t.dockModel.minor.dock,minimumLayoutMode:Ll.measureAxis.minimumLayoutMode},scale:_l.MINOR,settings:{labels:{show:u,fill:t.themeModel.axis.label.name.color,fontSize:t.themeModel.axis.label.name.fontSize,fontFamily:t.themeModel.axis.label.name.fontFamily},line:{stroke:t.themeModel.axis.line.major.color},ticks:{stroke:t.themeModel.axis.line.major.color},minorTicks:{stroke:t.themeModel.axis.line.minor.color}}}),o}var Ql=.7,ec=.9;var tc=2,nc={FULL:16,MEDIUM:14,SMALL:12,XSMALL:8,SPARK:4};function rc(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(r){var i=r.data,o=e.chart.component(t).rect;if(!i.items.length||!o)return tc;var a=e.viewState.get("zoom"),u=a.min,s=a.max;if(n[[u,s]])return n[[u,s]];var l=nc[jo.getLayoutMode(o.width,Number.MAX_VALUE)];n={};var c=Math.abs(s-u),f=Math.abs(e.viewCache.get("continuousMax")-e.viewCache.get("continuousMin"));if(0===f)return l;var d,m=Math.min(c/f/.2,1),h=tc*(1-(d=1-m))+l*d;return n[[u,s]]=Math.max(tc,Math.min(l,h)),n[[u,s]]}}var ic=function(e,t){var n,r,i=t.componentKey,o=t.collectionKey,a=e.layoutModel.meta;a.isGroupedByDimension?n=function(e){var t=e.scale,n=e.datum;return t([n.group.value,n.value])+t.bandwidth([n.group.value,n.value])/2}:a.isGroupedByMeasure&&(n=function(e){var t=e.scale,n=e.datum;return t([n.value,n.measureIndex.value])+t.bandwidth()/2});var u=tc;a.isContinuous?(r={start:"timeStart",end:"timeEnd"},u=rc(e,i)):a.isStacked&&(r="stack");var s=a.isStackedByDimension&&e.layoutModel.getLayoutValue("qHyperCube.qStackedDataPages.0.qArea.qHeight",NaN)>1;var l=e.layoutModel.getLayoutValue("components",null),c=l?l.filter(function(e){return e.key===i})[0]:null;return{key:i,type:"box",data:{collection:o},preferredSize:a.isContinuous?function(){return{size:0,edgeBleed:{left:1,right:1}}}:void 0,brush:{consume:[{context:"selection",data:["selectionDimension","end","fill","timeEnd"],style:{active:{strokeWidth:a.isContinuous||s?0:2,stroke:"#000"},inactive:{opacity:.3}}}]},settings:{major:{scale:_l.MAJOR,fn:n,ref:r},minor:{scale:_l.MINOR},orientation:e.dockModel.major.orientation,box:{width:function(e){var t=e.layoutModel,n=e.discrete,r=e.componentKey,i=t.meta,o=i.isContinuous,a=i.isGrouped;if(o)return 1;var u=t.getLayoutValue("components",[]).filter(function(e){return e.key===r})[0];if(u){var s=u.style;return s.strokeWidth&&"none"!==s.strokeWidth?function(){var e=Zs.BAR.STROKE.WIDTH[s.strokeWidth.toUpperCase()]/n.query.getItemSize(),t=s.width+e;return t>1?s.width-(t-1):s.width}:s.width}return a?ec:Ql}({layoutModel:e.layoutModel,discrete:e.discrete,componentKey:i}),minWidthPx:u,fill:e.colorModel.color(),minHeightPx:function(e){return a.isStacked?0:0===e.datum.end.value&&"-"===e.datum.end.label?0:.3},strokeWidth:c?Zs.BAR.STROKE.WIDTH[c.style.strokeWidth.toUpperCase()]:Zs.BAR.STROKE.WIDTH.NONE,stroke:c?c.style.strokeColor.color:Zs.BAR.STROKE.COLOR},oob:{show:!1},whisker:{show:!1},median:{show:!1},line:{show:!1}}}};function oc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ac(e){var t=e.key,n=e.opts,r=e.rtl;return function(e){var i=e.center,o=i.x,a=i.y,u=n.chart.element.getBoundingClientRect(),s=n.chart.component(t),l="vertical"===n.dockModel.major.orientation,c=l?o-u.left-s.rect.computedInner.x:a-u.top-s.rect.computedInner.y,f=l?s.rect.computedInner.width:s.rect.computedInner.height,d=l&&r?f-c:c,m=Math.max(0,Math.min(d/f,1)),h=oc(Tl(n),2),p=h[0],g=m<p,y=m>h[1],v=!g&&!y;return{pixel:d,relative:m,thumb:v?d-p*f:0,beforeThumb:g,afterThumb:y,onThumb:v}}}function uc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function sc(e){var t=e.key,n=e.opts;return function(){var e=n.chart.component(t),r=n.dockModel.major.orientation,i=e.rect.computedInner,o=i.width,a=i.height,u="vertical"===r?o:a,s=uc(Tl(n),2),l=s[0];return{size:u,thumbSize:(s[1]-l)*u}}}function lc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function cc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fc(e,t){var n=e.key,r=e.rtl,i=ac({key:n,opts:t,rtl:r}),o=sc({key:n,opts:t});return{type:"Tap",options:{event:"scrollAreaTap",enable:function(e,r){return!r||!!t.actions.scroll.enabled()&&t.chart.componentsFromPoint({x:r.center.x,y:r.center.y}).some(function(e){return e.key===n})}},events:{scrollAreaTap:function(e){e.preventDefault();var r=i(e);if(t.layoutModel.meta.isContinuous){var a=t.viewState.get("zoom"),u=a.max-a.min,s=t.viewCache.get("continuousMin"),l=t.viewCache.get("continuousMax"),c=s+(l-s)*r.relative;t.viewState.set("zoom",{min:Math.min(c-u/2,l-u),max:Math.max(c+u/2,s+u)})}else{var f=o(),d=r.pixel-f.thumbSize/2,m=Math.max(0,d/f.size);t.discrete.command.scrollTo(m)}t.chart.component(n).emit("render")}}}}var dc="scrollAreaPan";function mc(e,t){var n,r=e.key,i=e.rtl,o=ac({key:r,opts:t,rtl:i}),a=sc({key:r,opts:t});return{type:"Pan",key:"event:".concat(dc),options:{event:dc,threshold:0,enable:function(e,n){return this[dc]=this[dc]||{},!(n&&!this[dc].isPanning)||!!t.actions.scroll.enabled()&&(!n||n.target===t.chart.element)&&t.chart.componentsFromPoint({x:n.center.x,y:n.center.y}).some(function(e){return e.key===r})}},events:(n={},cc(n,"".concat(dc,"start"),function(e){e.preventDefault();var n=o(e);if(this[dc]=this[dc]||{},this[dc].isPanning=!0,t.chart.component(r).emit("lockState"),t.layoutModel.meta.isContinuous){var i=t.viewState.get("zoom"),u=i.max-i.min,s=t.viewCache.get("continuousMin"),l=t.viewCache.get("continuousMax"),c=s+(l-s)*n.relative;c<i.min?t.viewState.set("zoom",{min:Math.min(c,l-u),max:Math.max(c+u,s+u)}):c>i.max&&t.viewState.set("zoom",{min:Math.min(c-u,l-u),max:Math.max(c,s+u)}),this[dc].relative=n.relative,this[dc].zoom=t.viewState.get("zoom"),this[dc].zoom.span=this[dc].zoom.max-this[dc].zoom.min,this[dc].zoom.fullSpan=l-s}else if(n.onThumb)this[dc].offset=n.thumb;else{var f=a();this[dc].offset=n.beforeThumb?0:f.thumbSize}}),cc(n,"".concat(dc,"move"),function(e){e.preventDefault();var n=o(e);if(this[dc]=this[dc]||{},t.layoutModel.meta.isContinuous){var i=n.relative-this[dc].relative,u=this[dc].zoom,s=u.fullSpan,l=u.span,c=u.min,f=u.max,d=t.viewCache.get("continuousMin"),m=t.viewCache.get("continuousMax");t.viewState.set("zoom",{min:Math.min(c+i*s,m-l),max:Math.max(f+i*s,d+l)})}else{var h=n.pixel-(this[dc].offset||0),p=a(),g=Math.max(0,h/p.size);t.discrete.command.scrollTo(g)}t.chart.component(r).emit("render")}),cc(n,"".concat(dc,"end"),function(e){e.preventDefault(),this[dc]=this[dc]||{},this[dc].isPanning=!1,t.chart.component(r).emit("unlockState")}),cc(n,"".concat(dc,"cancel"),function(e){e.preventDefault(),this[dc]=this[dc]||{},this[dc].isPanning=!1,t.chart.component(r).emit("unlockState")}),n)}}function hc(e,t){var n=e.key;function r(e,r){if(t.layoutModel.meta.isContinuous){var i=t.chart.component(n);i&&i.emit&&t.actions.scroll.enabled()&&i.emit(e,r)}}return{type:"native",events:{mousemove:function(e){return r("hover",e)},mouseleave:function(){return r("leave")}}}}var pc="scrollAreaResize";function gc(e,t){var n,r=e.key,i=e.rtl,o=ac({key:r,opts:t,rtl:i});return{type:"Pan",key:"event:".concat(pc),options:{event:pc,threshold:0,enable:function(e,n){return!(!t.layoutModel.meta.isContinuous||!t.actions.scroll.enabled())&&(!n||(this[pc]=this[pc]||{},function(e){var t=lc(e.changedPointers,1)[0];return t&&("pointerdown"===t.type||"mousedown"===t.type)}(n)&&Vu(n)&&(this[pc].panningEvent=n.srcEvent),!!this[pc].panningEvent))}},events:(n={},cc(n,"".concat(pc,"start"),function(e){e.preventDefault(),this[pc]=this[pc]||{},this[pc].panningEvent&&t.chart.component(r).emit("dragStart",this[pc].panningEvent)}),cc(n,"".concat(pc,"move"),function(e){if(e.preventDefault(),this[pc]=this[pc]||{},this[pc].panningEvent){var n=t.viewState.get("zoom"),i=t.viewCache.get("continuousMin"),a=t.viewCache.get("continuousMax"),u=t.viewCache.get("minimiumZoomSpan"),s=(a-i)*o(e).relative+i,l=Vu(this[pc].panningEvent),c="start"===l?Math.min(s,n.max):n.min,f="end"===l?Math.max(s,n.min):n.max;c===f&&(c-="start"===l?u:0,f+="end"===l?u:0),t.viewState.set("zoom",{min:c,max:f}),t.chart.component(r).emit("render")}}),cc(n,"".concat(pc,"end"),function(e){e.preventDefault(),this[pc]=this[pc]||{},delete this[pc].panningEvent,t.chart.component(r).emit("dragEnd")}),cc(n,"".concat(pc,"cancel"),function(e){e.preventDefault(),this[pc]=this[pc]||{},delete this[pc].panningEvent,t.chart.component(r).emit("dragEnd")}),n)}}function yc(e,t){var n=t.hasExplicitMax,r=t.explicitMax;return!!n&&e>r&&r<=0}function vc(e,t){var n=t.hasExplicitMin,r=t.explicitMin;return!!n&&e<r&&r>=0}function bc(e,t){var n=t.hasExplicitMax,r=t.explicitMax;return!!n&&e>r&&r>0}function Mc(e,t){var n=t.hasExplicitMin,r=t.explicitMin;return!!n&&e<r&&r<0}var xc={MAX:"max",MIN:"min"};function wc(e,t){return yc(e,t)}function qc(e,t){return vc(e,t)}function Sc(e,t,n){return void 0===n?yc(e,t)||vc(e,t):n===xc.MAX?yc(e,t):vc(e,t)}function kc(e,t,n){return void 0===n?bc(e,t)||Mc(e,t):n===xc.MAX?bc(e,t):Mc(e,t)}function Dc(e,t){var n=t.barComponent,r=t.type,o=t.isStacked,a=e.viewCache,u=e.dockModel,s=a.get("minorMinMax");if(!s.hasExplicitMinMax)return!1;var l=r===i.TYPES.MAX?s.implicitMax:s.implicitMin,c=Number(l.toFixed(13));if(!i.isOutOfBounds(c,s,r))return!1;var f=r===i.TYPES.MAX?u.minor.maxDock:u.minor.minDock,d="end";return o&&(d=r===i.TYPES.MAX?"sumOfPositives":"sumOfNegatives"),{type:"box-oob",key:"bar-oob-".concat(r),layout:{dock:f},data:n.data,brush:n.brush,settings:{orientation:n.settings.orientation,major:n.settings.major,minor:n.settings.minor,dockValue:To.getDockValue(f),oob:g()({},n.settings.box,{fill:e.themeModel.outOfRange.color,alignment:1,opacity:1,show:function(e){return(!o||0!==e.datum[d].value)&&i.isOutOfBounds(e.datum[d].value,s,r)}})}}}var Oc=Math.PI/180,Ac=180/Math.PI,Cc=.96422,Tc=1,Pc=.82521,Nc=4/29,Lc=6/29,jc=3*Lc*Lc,Ec=Lc*Lc*Lc;function Ic(e){if(e instanceof Rc)return new Rc(e.l,e.a,e.b,e.opacity);if(e instanceof Uc){if(isNaN(e.h))return new Rc(e.l,0,0,e.opacity);var t=e.h*Oc;return new Rc(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}e instanceof at||(e=it(e));var n,r,i=Fc(e.r),o=Fc(e.g),a=Fc(e.b),u=Hc((.2225045*i+.7168786*o+.0606169*a)/Tc);return i===o&&o===a?n=r=u:(n=Hc((.4360747*i+.3850649*o+.1430804*a)/Cc),r=Hc((.0139322*i+.0971045*o+.7141733*a)/Pc)),new Rc(116*u-16,500*(n-u),200*(u-r),e.opacity)}function Rc(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function Hc(e){return e>Ec?Math.pow(e,1/3):e/jc+Nc}function Bc(e){return e>Lc?e*e*e:jc*(e-Nc)}function zc(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Fc(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function _c(e){if(e instanceof Uc)return new Uc(e.h,e.c,e.l,e.opacity);if(e instanceof Rc||(e=Ic(e)),0===e.a&&0===e.b)return new Uc(NaN,0,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Ac;return new Uc(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function Vc(e,t,n,r){return 1===arguments.length?_c(e):new Uc(e,t,n,null==r?1:r)}function Uc(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}ze(Rc,function(e,t,n,r){return 1===arguments.length?Ic(e):new Rc(e,t,n,null==r?1:r)},Fe(_e,{brighter:function(e){return new Rc(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new Rc(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new at(zc(3.1338561*(t=Cc*Bc(t))-1.6168667*(e=Tc*Bc(e))-.4906146*(n=Pc*Bc(n))),zc(-.9787684*t+1.9161415*e+.033454*n),zc(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),ze(Uc,Vc,Fe(_e,{brighter:function(e){return new Uc(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new Uc(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return Ic(this).rgb()}}));var Wc={isDark:function(e){return Vc(e).l<70}};function Kc(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i="inside"!==e.position||r?0:2,o=e.padding||{left:n?i:4,right:n?i:4,top:n?4:i,bottom:n?4:i};return{position:e.position,justify:e.justify,fill:e.onBackground?t.color:function(e){return function(t){return Wc.isDark(t.node.attrs.fill)?e.lightColor:e.darkColor}}(t),overflow:e.overflow,background:e.background,padding:o}}function Gc(e){var t="vertical"===e.dockModel.major.orientation;return{placements:e.simplifiedPlacements.map(function(n){return Kc(n,e.style,t,e.layoutModel.meta.isContinuous)}),label:e.label}}var Yc="vertical",Xc="horizontal";function Jc(e,t,n,r){var i=function(e,t){if(t){if(wc(e,t))return-1;if(qc(e,t))return 1}return function(e,t){if(t&&0===e){var n=t.min,r=t.max;return 0===r&&0===n?1:r<=0?-1:n>=0?1:r>=-n?1:-1}return e>=0?1:-1}(e,t)}(e,r),o="up";return t===Yc&&i<0?o="down":t===Xc&&(o=i>=0&&!n||i<0&&n?"right":"left"),o}function Zc(e,t){var n=e.dataPoint;if(!n.showLabels)return!1;var r=t.layoutModel.meta,i=r.isStacked,o=r.isContinuous;return!i||!o&&!!n.showSegmentLabels}var $c="#la-vie-tooltip";function Qc(){if(!document.querySelector($c)){var e=document.createElement("div");e.id="la-vie-tooltip",e.style.overflow="hidden",e.style.position="fixed",e.style.pointerEvents="none",e.style.left="0px",e.style.top="0px",e.style.width="100%",e.style.height="100%",e.style.zIndex=1020,document.body.appendChild(e)}}function ef(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{show:!0,key:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"tooltip",type:"tooltip",layout:{displayOrder:3},beforeMount:function(){Qc()},beforeUpdate:function(){Qc()},destroyed:function(){var e;(e=document.querySelector($c))&&e.parentElement&&e.childElementCount<1&&e.parentElement.removeChild(e)},settings:{appendTo:function(){return document.querySelector($c)},content:function(e){var t=e.h,n=e.data,r=e.style;return n[0].map(function(e){return t("tr",{},function(e,t){var n=t.h,r=t.style;return e.map(function(e){var t={style:Object.assign({},r.cell||{},e.style||{}),class:e.class};return e.colspan&&(t.colspan=e.colspan),n("td",t,e.content)})}(e,{h:t,style:r}))})},direction:t.rtl?"rtl":"ltr"},style:{arrow:{color:"#404040"},content:{display:"table","border-spacing":"4px",backgroundColor:"#404040",fontSize:"14px",fontFamily:"QlikView Sans, sans-serif","empty-cells":"show"},cell:{"max-width":"180px","word-break":"break-word","word-wrap":"break-word","overflow-wrap":"break-word",hyphens:"auto"}}}}var tf={getColorSymbol:function(e,t){return e.h("div",{style:{display:"inline-block",width:"10px",height:"10px","background-color":t.color.fill,margin:"0 8px"}})},getNodeFillColor:function(e){return e.attrs&&void 0!==e.attrs.fill?e.attrs.fill:e.children&&e.children[0]&&e.children[0].attrs&&void 0!==e.children[0].attrs.fill?e.children[0].attrs.fill:void 0},getColor:function(e,t,n){var r=t.data,i=e.resources.formatter,o=e.resources.dataset,a={};if(n.coloring.label&&(a.label="".concat(n.coloring.label)),"color"!==n.coloring.type&&r.fillTooltip){var u=i("fill"),s="measure"===n.coloring.fieldType;if(a.value=s&&u?u(r.fillTooltip.value):r.fillTooltip.label?r.fillTooltip.label:r.fillTooltip.value,!n.coloring.label){var l=o(r.fillTooltip.source.key).field(r.fillTooltip.source.field).title();a.label="".concat(l)}}return a.fill=void 0===r._fillColor?tf.getNodeFillColor(t):r._fillColor,a},getMeasure:function(e,t){var n=e(t.source.key).field(t.source.field).title();return{label:"".concat(n),value:""===t.label||"NaN"===t.label?"-":t.label,field:t.source.field}},hideColorRow:function(e,t){return void 0===e.color.value||e.measures.some(function(e){return e.field===t.coloring.field})},getTitleRow:function(e,t){var n=Ga.detectTextDirection(e.title);return[{content:e.title,style:{"font-weight":"bold","text-align":t.rtl?"right":"left",direction:n},colspan:2},{}]},getNMoreRow:function(e,t,n){var r=t?t.get("Object.ChartTooltip.NMore",e):"+".concat(e," more"),i=Ga.detectTextDirection(r);return[{content:r,style:{"font-weight":"bold","text-align":n.rtl?"right":"left",direction:i},colspan:2},{}]},getSeparatorRow:function(){return[{content:"",style:{"background-image":"linear-gradient(transparent 8px, rgba(255, 255, 255, 0.4) 8px, rgba(255, 255, 255, 0.4) 9.2px, transparent 9.2px)",height:"17px"},colspan:2},{}]},getColorRow:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Ga.detectTextDirection(t.color.label),i=n.rtl?[":",t.color.label]:[t.color.label,":"],o=Ga.detectTextDirection(t.color.value),a=n.rtl?[t.color.value,tf.getColorSymbol(e,t)]:[tf.getColorSymbol(e,t),t.color.value];return[{content:i,style:{"text-align":n.rtl?"right":"left",direction:r}},{content:a,style:{"text-align":n.rtl?"left":"right",direction:o,"vertical-align":"middle"}}]},getMeasureRow:function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=Ga.detectTextDirection(e.label),u=i.rtl?[":",e.label]:[e.label,":"],s=Ga.detectTextDirection(e.value);return r=o?i.rtl?[e.value,tf.getColorSymbol(t,n)]:[tf.getColorSymbol(t,n),e.value]:[e.value],[{content:u,style:{"text-align":i.rtl?"right":"left",direction:a}},{content:r,style:{"text-align":i.rtl?"left":"right",direction:s,"vertical-align":"middle"}}]}},nf=tf,rf={combineBounds:function(e){var t=Number.MAX_VALUE,n=-Number.MAX_VALUE,r=Number.MAX_VALUE,i=-Number.MAX_VALUE;return e.forEach(function(e){e&&(t=Math.min(t,e.x,e.x+e.width),n=Math.max(n,e.x,e.x+e.width),r=Math.min(r,e.y,e.y+e.height),i=Math.max(i,e.y,e.y+e.height))}),{x:t,y:r,width:n-t,height:i-r}}};function of(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var af={isSameMeasureAndColorRow:function(e,t,n){return t&&e&&t[0].content[0]===e[0].content[0]&&t[0].content[1]===e[0].content[1]&&t[1].content[n.rtl?0:1]===e[1].content[0]},getTitle:function(e,t){var n,r=e.data;return t.isStackedByDimension?n=r.stack?r.stack.label:void 0:t.isGroupedByDimension&&(n=r.group?r.group.label:void 0),void 0!==n?"".concat(r.label,", ").concat(n):r.label},getMeasure:function(e,t,n,r,i){if(n.isStacked&&("bar-oob-max"===t.key||"bar-oob-min"===t.key))return!1;var o=t.data,a=n.isStacked?r.viewModel.fields.minor[n.isStackedByDimension?0:o.measureIndex.value]:void 0,u=n.isStacked?{source:{key:o.source.key,field:a},label:n.isStackedByDimension&&i?i(o.segment.value):o.segment.label}:o.end;return nf.getMeasure(e,u)},getMeasures:function(e,t,n,r,i){var o=e.resources.dataset;return t.map(function(e){return af.getMeasure(o,e,n,r,i)}).filter(Boolean)},extractBarTooltipData:function(e,t,n,r,i){return{title:af.getTitle(t,n),color:nf.getColor(e,t,r),measures:af.getMeasures(e,t.childrenNodes?t.childrenNodes:[t],n,r,i)}},getTotalStackTitle:function(e,t){return e>0?t?t.get("Object.ChartTooltip.sumOfPositives"):"Sum of positives":e<0?t?t.get("Object.ChartTooltip.sumOfNegatives"):"Sum of negatives":""},extractStackTotalBarTooltipData:function(e,t,n){return{title:e.data.label,measures:[e.data.sumOfPositives.value,e.data.sumOfNegatives.value].filter(function(e){return 0!==e}).map(function(e){return{label:"".concat(af.getTotalStackTitle(e,t)),value:n?n(e):e}})}},extractTooltipData:function(e,t){var n=t.chart.formatter("bar"),r=t.layoutModel.meta,i=e.node.childrenNodes?e.node.childrenNodes:[e.node],o=Math.max(0,i.length-6);i.length=Math.min(i.length,6);var a=e.node.stackTotalBarNodes,u=a&&a.length?a.map(function(e){return af.extractStackTotalBarTooltipData(e,t.translator,n)}):[];return{barTooltipData:i.map(function(i){return af.extractBarTooltipData(e,i,r,t,n)}),stackTotalBarTooltipData:u,numInvisibleNodesPhase1:o}},extractBarNodeData:function(e,t,n,r,i,o,a){var u=!i&&nf.getTitleRow(t,r),s=nf.hideColorRow(t,n),l=!o&&!s&&nf.getColorRow(e,t,r),c=t.measures.map(function(i){return!a&&nf.getMeasureRow(i,e,t,r,s&&i.field===n.coloring.field)}).filter(function(e){return!af.isSameMeasureAndColorRow(e,l,r)});return[u,l].concat(of(c)).filter(Boolean)},extractStackTotalBarNodeData:function(e,t,n){var r=!!t.measures.length&&nf.getTitleRow(t,n),i=t.measures.map(function(r){return nf.getMeasureRow(r,e,t,n,!1)});return[r].concat(of(i)).filter(Boolean)},shouldIgnoreTitleRow:function(e,t){return e.isDimensionless||t>0&&!e.isGroupedByDimension&&!e.isStackedByDimension},shouldIgnoreColorRow:function(e,t){return t>0&&(e.isGroupedByMeasure||e.isStackedByMeasure)},shouldIgnoreMeasureRow:function(e,t,n){return e&&t.measures.some(function(e){return e.field===n.coloring.field})},extractBarsData:function(e,t,n,r){var i,o,a=t.layoutModel.meta,u=r.length,s=[];for(i=0;i<u;i++){o=r[i];var l=af.shouldIgnoreTitleRow(a,i),c=af.shouldIgnoreColorRow(a,i),f=af.shouldIgnoreMeasureRow(c,o,t);if((s=s.concat(af.extractBarNodeData(e,o,t,n,l,c,f))).length>=6)return{barsData:s,numInvisibleNodesPhase2:u-(i+1)}}return{barsData:s,numInvisibleNodesPhase2:0}},extractStackTotalBarsData:function(e,t,n){var r=[];return n.some(function(e){return e.measures.length})&&n.forEach(function(n){r=r.concat(af.extractStackTotalBarNodeData(e,n,t))}),r},extractData:function(e,t,n){var r=af.extractTooltipData(e,t),i=r.barTooltipData,o=r.numInvisibleNodesPhase1,a=r.stackTotalBarTooltipData,u=af.extractStackTotalBarsData(e,n,a);u.length&&u.push(nf.getSeparatorRow());var s=af.extractBarsData(e,t,n,i),l=s.barsData,c=s.numInvisibleNodesPhase2,f=u.concat(l),d=o+c;return d&&f.push(nf.getNMoreRow(d,t.translator,n)),f},calculateBoundsFromBars:function(e){var t=e.filter(function(e){var t=e.bounds;return t.width>0&&t.height>0}),n=t.length?t:e;return rf.combineBounds(n.map(function(e){return e.bounds}))},calculateBoundsFromScale:function(e){var t,n,r,i=e.opts,o=e.barKey,a=e.scale,u=e.majorScale,s=e.data,l=e.groupProp,c=i.chart.component(o).rect,f=i.dockModel.major.orientation,d="vertical"===f?"width":"height",m=i.chart.scale(a).pxScale(c[d]);if(i.layoutModel.meta.isGroupedByMeasure){var h=i.viewModel.fields.minor.length;t=s.value,n=a===u&&void 0!==t?(m([t,0])+m([t,h-1]))/2:0,r=a===u&&void 0!==t?m.bandwidth([t,0]):0}else{var p=s.value;t=s[l]?s[l].value:void 0,n=m(a===u&&void 0!==t?[t,p]:p),r=a===u&&void 0!==t?m.bandwidth([t,p]):m.bandwidth(p)}var g=(n+r/2)*c[d],y={width:0,height:0};return"vertical"===f?(y.x=g,y.y=c.height):(y.y=g,y.x=0),y},calculateTotalBounds:function(e){var t=e.opts,n=e.labels,r=e.bars,i=e.barKey,o=e.barAxisKey,a=e.majorScale,u=e.majorInnerScale,s=e.groupProp,l=r.filter(function(e){return e.children&&e.children.length});return l.length?af.calculateBoundsFromBars(l):af.calculateBoundsFromScale({opts:t,barKey:i,scale:n[0].key===o?a:u,majorScale:a,data:n[0].data,groupProp:s})},filterNodesOnKeys:function(e,t){return e.filter(function(e){return e.data&&t.indexOf(e.key)>-1})},isBarMatchingLabel:function(e,t){return t.data.value===e.data.value},isBarMatchingLabelOnProp:function(e,t,n){return t.data.value===(e.data[n]?e.data[n].value:e.data.value)},findBarsMatchingLabels:function(e,t,n,r){return e.filter(function(e){return t.some(function(t){return n(e,t,r)})})},findBarsFromGroupLabelsInGroupedByDim:function(e,t,n){var r=af.isBarMatchingLabelOnProp;return af.findBarsMatchingLabels(e,t,r,n)},findBarsFromBarLabelsInGroupedByDim:function(e,t,n){return e.filter(function(e){return t.some(function(t){return t.data.group&&t.data.group.value===e.data[n].value&&t.data.value===e.data.value})})},findBarsFromLabelsInSingleDim:function(e,t){var n=af.isBarMatchingLabel;return af.findBarsMatchingLabels(e,t,n)},findBarsFromLabelsInGroupedByDim:function(e,t,n,r){var i=t.filter(function(e){return e.key===n}),o=t.filter(function(e){return e.key!==n}),a=af.findBarsFromBarLabelsInGroupedByDim(e,i,r),u=af.findBarsFromGroupLabelsInGroupedByDim(e,o,r);return a.concat(u)},findStackTotalBarsFromLabelsInStackedByDim:function(e,t){var n=af.isBarMatchingLabel;return af.findBarsMatchingLabels(e,t,n)},findStackTotalBarsFromLabelsInStackedByMeasure:function(e,t){var n=af.isBarMatchingLabel;return af.findBarsMatchingLabels(e,t,n)},findBarsFromLabelsInStackedByDim:function(e,t,n){var r=af.isBarMatchingLabelOnProp;return af.findBarsMatchingLabels(e,t,r,n)},findBarsFromLabelsInStackedByMeasure:function(e,t){return af.findBarsFromLabelsInSingleDim(e,t)},findBarsFromLabels:function(e){var t=e.labels,n=e.opts,r=e.filterKeys,i=e.barAxisKey,o=e.groupProp,a=e.stackProp,u=n.layoutModel.meta,s=af.filterNodesOnKeys(n.chart.findShapes("container"),r);return u.isStackedByDimension?af.findBarsFromLabelsInStackedByDim(s,t,a):u.isStackedByMeasure?af.findBarsFromLabelsInStackedByMeasure(s,t):u.isGroupedByDimension?af.findBarsFromLabelsInGroupedByDim(s,t,i,o):af.findBarsFromLabelsInSingleDim(s,t)},findStackTotalBarsFromLabels:function(e){var t=e.labels,n=e.opts,r=e.stackTotalBarKey,i=n.layoutModel.meta;if(i.isStacked){var o=af.filterNodesOnKeys(n.chart.findShapes("container"),[r]);return i.isStackedByDimension?af.findStackTotalBarsFromLabelsInStackedByDim(o,t):af.findStackTotalBarsFromLabelsInStackedByMeasure(o,t)}return[]},isSingleBarMode:function(e,t){var n=e.isSimple||1===t.length;return n&&t[0].children&&t[0].children.length},filterNodesOnLabels:function(e){var t=e.labels,n=e.opts,r=e.barKey,i=e.stackTotalBarKey,o=e.barAxisKey,a=e.barOobMaxKey,u=e.barOobMinKey,s=e.groupProp,l=e.stackProp,c=e.majorScale,f=e.majorInnerScale,d=e.filterFn,m=n.layoutModel.meta;if(t.length){var h=af.findBarsFromLabels({labels:t,opts:n,filterKeys:[r],stackTotalBarKey:i,barAxisKey:o,barOobMaxKey:a,barOobMinKey:u,groupProp:s,stackProp:l});if(d&&(h=h.filter(d)),af.isSingleBarMode(m,h))return[h[0]];if(h.length){var p=af.findBarsFromLabels({labels:t,opts:n,filterKeys:[r,a,u],stackTotalBarKey:i,barAxisKey:o,barOobMaxKey:a,barOobMinKey:u,groupProp:s,stackProp:l});d&&(p=p.filter(d));var g=af.calculateTotalBounds({opts:n,labels:t,bars:p,barKey:r,barAxisKey:o,groupProp:s,majorScale:c,majorInnerScale:f}),y=af.findStackTotalBarsFromLabels({labels:t,opts:n,stackTotalBarKey:i});return[{key:r,bounds:g,childrenNodes:h,data:h.map(function(e){return e.data}),stackTotalBarNodes:y}]}return[]}return[]},filterNodesForOob:function(e,t,n){return e.key===t&&0===e.children.length||e.key===n},filterNodes:function(e){var t=e.nodes,n=e.opts,r=e.barKey,i=e.stackTotalBarKey,o=e.barAxisKey,a=e.groupAxisKey,u=e.barOobMaxKey,s=e.barOobMinKey,l=e.groupProp,c=e.stackProp,f=e.majorScale,d=e.majorInnerScale,m=af.filterNodesOnKeys(t,[o,a]),h=m&&m.length?[m[0]]:[],p=af.filterNodesOnLabels({labels:h,opts:n,barKey:r,stackTotalBarKey:i,barAxisKey:o,barOobMaxKey:u,barOobMinKey:s,groupProp:l,stackProp:c,majorScale:f,majorInnerScale:d});if(p&&p.length)return p;var g=n.layoutModel.meta;if(g.isStackedByMeasure){h=(m=af.filterNodesOnKeys(t,[u,s]))&&m.length?[m[0]]:[];var y=af.filterNodesOnLabels({labels:m,opts:n,barKey:r,stackTotalBarKey:i,barAxisKey:o,barOobMaxKey:u,barOobMinKey:s,groupProp:l,stackProp:c,majorScale:f,majorInnerScale:d,filterFn:function(e){return af.filterNodesForOob(e,r,u)}});if(y&&y.length)return y[0].stackTotalBarNodes=void 0,y}if(g.isStackedByDimension){h=(m=af.filterNodesOnKeys(t,[u,s]))&&m.length?[m[0]]:[];var v=af.filterNodesOnLabels({labels:m,opts:n,barKey:r,stackTotalBarKey:i,barAxisKey:o,barOobMaxKey:u,barOobMinKey:s,groupProp:l,stackProp:c,majorScale:f,majorInnerScale:d,filterFn:function(e){return af.filterNodesForOob(e,r,u)}});if(v&&v.length)return v[0].stackTotalBarNodes=void 0,v}var b=af.filterNodesOnKeys(t,[r,u,s]);return b.length?[b[0]]:[]}},uf=af;var sf={extractData:function(e,t){return[nf.getTitleRow({title:e.node.data.label},t)]},filterNodes:function(e,t){var n=e.filter(function(e){return e.data&&e.key===t});return n.length?[n[0]]:[]}};var lf="center",cf="bottom",ff={NoDataExist:{label:"NoDataExist",alignment:lf,default:!0},OnlyNanData:{label:"OnlyNanData",alignment:lf,default:!0},OnlyNegativeOrZeroValues:{label:"OnlyNegativeOrZeroValues",alignment:lf,default:!1},LimitedData:{label:"LimitedData",alignment:cf,default:!1},OnlyNanColor:{label:"OnlyNanColor",alignment:cf,default:!1},NegativeOrZeroValues:{label:"NegativeOrZeroValues",alignment:cf,default:!1},DataRangeIncludingZero:{label:"DataRangeIncludingZero",alignment:cf,default:!1}},df=function(e,t,n){if(!e)return!1;var r=t.translator,i=n.rtl;return{key:"disclaimer",type:"disclaimer",layout:{dock:ff[e].alignment},settings:{label:r.get("Object.Disclaimer.".concat(e)),rtl:i}}};function mf(e,t,n){var r=function(e,t){if(e.qHyperCube.qSize.qcx*e.qHyperCube.qSize.qcy==0)return"NoDataExist";var n=!1;if(t.layoutModel.meta.isContinuous&&2===e.qHyperCube.qDimensionInfo.length){var r=e.qHyperCube.qDimensionInfo[1];n=Wl.getDimensionSize(r)>Bo.maxNumberOfLines}return!!n&&"LimitedData"}(e.layout,t);return df(r,t,n)}var hf={NONE:0,WIDE:1,MEDIUM:2,NARROW:3};function pf(e){return e.getLayoutValue("gridLine.auto")}var gf=function(e,t){var n=t.themeModel,r=t.layoutModel,i=t.dockModel;if(!pf(r)&&function(e){return!e.getLayoutValue("gridLine.spacing")}(r))return!1;var o=n.grid,a={key:"grid-line",type:"grid-line",layout:{minimumLayoutMode:Ll.measureAxis.minimumLayoutMode},preferredSize:function(){return{size:0,edgeBleed:{left:1,right:1,top:1,bottom:1}}},ticks:{show:!function(e){return!pf(e)&&e.getLayoutValue("gridLine.spacing")===hf.WIDE}(r)||function(e,t){return t%2==0},stroke:o.line.major.color},minorTicks:{show:function(e){return!pf(e)&&e.getLayoutValue("gridLine.spacing")===hf.NARROW}(r),stroke:o.line.minor.color}};return a[To.getMinorScaleAxis(i.major.orientation)]=_l.MINOR,a},yf=function(e){var t=e.dockModel,n=e.themeModel,r=e.viewCache.get("minorMinMax");if(r.min>0||r.max<0)return!1;var i={};return i["vertical"===t.minor.orientation?"x":"y"]=[{value:0,scale:_l.MINOR,line:{stroke:n.grid.line.highContrast.color}}],{key:"high-contrast-grid-line",type:"ref-line",scale:_l.MINOR,lines:i}};var vf=function(e){return{type:"Pan",key:"panorama",options:{event:"areaPan",pointers:1,threshold:10,enable:function(t,n){return"areaPan"===this.started||!n||!!e.actions.scroll.enabled()&&e.chart.componentsFromPoint({x:n.center.x,y:n.center.y}).some(function(e){return e.key===Wo.COMPONENT.BAR})}},events:{areaPanstart:function(t){t.preventDefault(),this.started="areaPan";var n=e.viewState.get("zoom");this.areaPan={min:n.min,max:n.max,size:e.chart.component(Wo.COMPONENT.BAR).rect.computedInner.width,span:n.max-n.min}},areaPanmove:function(t){t.preventDefault();var n=this.areaPan,r=n.span,i=n.min,o=n.max,a=n.size,u=-t.deltaX/a;e.viewState.set("zoom",{min:Math.min(i+u*r,e.viewCache.get("continuousMax")-r),max:Math.max(o+u*r,e.viewCache.get("continuousMin")+r)})},areaPanend:function(e){e.preventDefault(),this.started=!1},areaPancancel:function(e){e.preventDefault(),this.started=!1}}}};function bf(e,t){if(e.layoutModel.meta.isDiscrete)return{};var n=e.viewCache,r=e.viewState,i=e.chart,o=t.rtl,a=wo.event.onZoom({viewCache:n,viewState:r,chart:i},{threshold:100,rtl:o,targetKey:Wo.COMPONENT.BAR}),u={last:0,diff:0};return{type:"Pinch",key:"continuous-pinch-zoom",options:{event:"zoom",pointers:2,threshold:0,enable:function(t,n){return!n||!!e.actions.scroll.enabled()&&e.chart.componentsFromPoint({x:n.center.x,y:n.center.y}).some(function(e){return e.key===Wo.COMPONENT.BAR})}},events:{zoomstart:function(e){u.last=e.scale,e.preventDefault()},zoommove:function(e){var t=e.scale-u.last;(function(e){return Math.abs(e)>.01})(t)&&a(e.center,t>0?1:-1),e.preventDefault(),u.last=e.scale}}}}function Mf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function xf(e){var t=e.chart,n=t.component(Wo.COMPONENT.BASE_TOOLTIP);n&&n.show&&n.emit("hide");var r=t.component(Wo.COMPONENT.LEGEND_CAT_TOOLTIP);r&&r.show&&r.emit("hide")}function wf(e,t){var n=e.viewCache,r=e.viewState,i=e.chart,o=t.rtl,a=e.layoutModel.meta.isContinuous?wo.event.onZoom({viewCache:n,viewState:r,chart:i},{rtl:o,threshold:50,targetKey:Wo.COMPONENT.BAR}):void 0,u=[Wo.COMPONENT.BAR,Wo.COMPONENT.BAR_AXIS,Wo.COMPONENT.GROUP_AXIS,Wo.COMPONENT.BAR_OOB_MAX,Wo.COMPONENT.BAR_OOB_MIN];return{type:"native",events:{wheel:function(t){var n,r=!1;if(e.actions.scroll.enabled()){var i={x:t.clientX,y:t.clientY};(n=Mf(e.chart.componentsFromPoint(i).filter(function(e){return e.key===Wo.COMPONENT.BAR}),1)[0])&&(e.layoutModel.meta.isContinuous&&a(i,Math.sign(-t.deltaY)),r=!0)}!r&&e.actions.interact.enabled()&&(n=Mf(e.chart.componentsFromPoint(t).filter(function(e){return e.key===Wo.COMPONENT.LEGEND_COLOR_CAT}),1)[0])&&(r=!0,function(e,t){var n=(Math.abs(e.deltaX)>Math.abs(e.deltaY)?e.deltaX:e.deltaY)>=0?"next":"prev";t.emit(n)}(t,n));r&&t.preventDefault(),xf(e)},mousemove:function(t){if(e.actions.tooltip.enabled()){var n=this.chart.componentsFromPoint({x:t.clientX,y:t.clientY}),r=this.chart.component(Wo.COMPONENT.BASE_TOOLTIP);r&&r.show&&n.some(function(e){return u.indexOf(e.key)>-1})?r.emit("show",t):r&&r.show&&r.emit("hide");var i=this.chart.component(Wo.COMPONENT.LEGEND_CAT_TOOLTIP);i&&i.show&&n.some(function(e){return e.key===Wo.COMPONENT.LEGEND_COLOR_CAT})?i.emit("show",t):i&&i.show&&i.emit("hide")}},mouseup:function(e){2===e.button&&xf(this)},mouseleave:function(){xf(this)}}}}function qf(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Sf=function(e,t){return{type:"hammer",enable:!0,gestures:[].concat(qf((t.hammer||{}).gestures||[]),[r.tap({key:"scroll-area",rtl:t.rtl},e),r.resize({key:"scroll-area",rtl:t.rtl},e),r.pan({key:"scroll-area",rtl:t.rtl},e)],qf(e.layoutModel.meta.isDiscrete?e.discrete.interactions.gestures:[vf(e,t.rtl),bf(e,t)]))}};var kf=function(e,t){var n=[Sf(e,t),wf(e,t),r.native({key:"scroll-area"},e)];return e.layoutModel.meta.isDiscrete&&n.push(e.discrete.interactions.native),n},Df=function(e,t,n,r,i){var o=i.ds,a=i.colorModel;if("measure"===a.settings().mode||"field"===a.settings().mode||/qAttrDimInfo/.test(a.settings().field))return r.map(function(r){return i=r.label,e.measureText({text:i,fontSize:t,fontFamily:n});var i}).reduce(function(e,t){return t&&t.width>e.width?t:e},{width:0});var u=o.field(a.settings().field).raw().qApprMaxGlyphCount;u=Gl.getAdjustedMaxGlyphCount(u,r,void 0,"label");var s=new Array(u+1).join("m");return e.measureText({text:s,fontSize:t,fontFamily:n})},Of=function(e,t){if(["top","bottom"].indexOf(e.layout.dock)>-1)return!1;var n,r,i,o,a,u,s=t.chart.theme().style("$font-family"),l=t.picasso.renderer(e.renderer)(),c=function(e,t,n,r){return e.measureText({text:r,fontSize:t,fontFamily:n})}(l,b.getValue(e,"settings.title.fontSize","16px"),s,t.colorModel.settings().label),f=Math.min(134,c.width),d=(n=e.scale,i=(r=t).ds,o=r.picasso,a=r.colorModel,u=a.data().map(function(e){return e.key}).indexOf("attrDim"),"field"===a.settings().mode&&"measure"===a.settings().fieldType?function(e,t){for(var n=[],r=e.field(t.data.field).formatter(),i=t.domain,o=1;o<i.length;o++)n.push({label:"".concat(r(i[o-1])," - < ").concat(r(i[o]))});return n}(i,a.scales()[n]):"measure"===a.settings().mode?i.fields().filter(function(e){return"measure"===e.type()}).map(function(e){return{label:e.title()}}):u>-1?o.data("q")({data:a.data()[u].data}).extract({field:"qDimensionInfo/0"}):i.field(a.settings().field).items()),m=Df(l,b.getValue(e,"settings.item.label.fontSize","12px"),s,d,t),h=Math.min(114,m.width),p=Math.min(150,Math.max(f+16,h+24+12));return{key:e.key,preferredSize:function(){return p},settings:{title:{maxWidth:function(){return p-16}},item:{label:{maxWidth:function(){return p-12-24},wordBreak:"break-word",maxLines:2}}}}};var Af=function(e,t,n){var r=n.collectionKey;if(!Nl({layoutModel:t.layoutModel}).miniChart)return!1;if(t.reducedDataModel.mode.isContinuous)return function(e,t,n){var r=t.reducedDataModel,i=t.miniColorModel,o=t.continuousDataModel;return{type:"box",key:"mini-marker",layout:{dock:"@scroll-area"},show:function(){return o.getDimensionCardinality()>1},data:{collection:n.collectionKey},settings:{box:g()(!0,{},e.settings.box,{minWidthPx:2,fill:i.color(),strokeWidth:0}),major:g()(!0,{},e.settings.major,{scale:r.scales.major}),minor:e.settings.minor,orientation:e.settings.orientation,oob:{show:!1},whisker:{show:!1},median:{show:!1},line:{show:!1}}}}(e,t,{collectionKey:r});var i,o=t.reducedDataModel,a=o.mode,u=o.scales;return a.isGroupedByDimension&&!a.isReduced?i=function(e){var t=e.scale,n=e.datum;return t([n.group.value,n.value])+t.bandwidth([n.group.value,n.value])/2}:a.isGroupedByMeasure&&(i=function(e){var t=e.scale,n=e.datum;return t([n.value,n.measureIndex.value])+t.bandwidth()/2}),{type:"box",key:"mini-marker",layout:{dock:"@scroll-area"},show:function(){return t.discrete.query.getCanScroll()},data:{collection:r},settings:{box:Object.assign({},e.settings.box,{fill:a.isReduced||a.isStackedByDimension?t.colorModel.settings().others:t.colorModel.color(),strokeWidth:0}),major:{scale:u.major,fn:i},minor:{scale:u.minor},orientation:e.settings.orientation,oob:{show:!1},whisker:{show:!1},median:{show:!1},line:{show:!1}}}},Cf=Ha.a.renderer("svg")().measureText;function Tf(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Pf(e,t,n){return{reducedMinor:function(e){var t=g()(!0,{},e);return delete t.data,t}(t.minor),reducedMajor:function(e,t,n){var r=n.majorScaleInvert,i=n.maxPxStep,o=n.align,a=n.getProp,u={invert:r,data:{extract:e.mode.isDimensionless?e.fields.minor.map(function(e,t){return{field:e,value:t}}):{source:"miniCube",field:"qDimensionInfo/0"}},type:e.mode.isDimensionless?"band":void 0,maxPxStep:i,align:o};return e.mode.isStackedByDimension?u.data.extract.field="qDimensionInfo/1":e.mode.isGroupedByDimension?e.mode.isReduced||(u.data={source:"miniCube",hierarchy:{value:function(e){return e.qElemNumber}}}):e.mode.isGroupedByMeasure?(u=g()(!0,{},t)).data.extract.source="miniCube":e.mode.isContinuous&&(u=g()(!0,{},t,{min:function(){return a("continuousMin")},max:function(){return a("continuousMax")}})),u}(e,t.major,n)}}var Nf=125,Lf={NARROW:50,MEDIUM:100,WIDE:200};function jf(e,t){var n=function(e){var t=e.getLayoutValue("measureAxis.spacing",1);switch(t){case.5:return Lf.NARROW;case 1:return Lf.MEDIUM;case 2:return Lf.WIDE;default:return t*Nf}}(t);return Math.max(1,Math.round(e/n))}function Ef(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function If(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Rf=10;function Hf(e,t,n){return 0===t||t===Math.floor((n.length-1)/2)||t===n.length-1}function Bf(e,t,n){return 0===t||0===e||t===n.length-1}function zf(e,t,n,r){e.domain([t,n]),e.nice(Rf);var i=If(e.domain(),2),o=i[0],a=i[1],u=e.ticks(Rf),s=function(e){return e.length%2==0}(u),l=function(e){var t=Math.round(.3*e.length),n=t,r=e.length-t;return e.slice(n,r).some(function(e){return 0===e})}(u),c=l?Bf:Hf;return u=u.filter(c),s&&!l&&!r&&u.length>1&&(u=[u[0],(u[0]+u[u.length-1])/2,u[u.length-1]]),{roundedMin:o,roundedMax:a,ticks:u}}function Ff(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var _f=function(e,t){return e.value-t.value},Vf=function(e){return{value:e,isMinor:!1}},Uf=function(e){return{value:e,isMinor:!0}};function Wf(e,t,n){var r=Number.isNaN(t)&&Number.isNaN(n)?3:2;return e.filter(function(e){return function(e){return Number.isNaN(t)||e>=t}(e)&&function(e){return Number.isNaN(n)||e<=n}(e)}).length<=r}function Kf(e){var t=e.chart,n=e.viewCache,r=e.dockModel,i=e.layoutModel,o=e.themeModel,a=n.get("minorMinMax"),u=a.explicitMin,s=a.explicitMax,l=a.hasExplicitMin,c=a.hasExplicitMax,f=function(e){var t=e.get("minorMinMax"),n=t.min,r=t.max;return n===r&&0===n&&(n-=1,r+=1),{min:n,max:r}}(n),d=f.min,m=f.max,h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e},n=j();return function(r){var i=t(r);return n.has(i)?n.get(i):n.set(i,e(r))}}(function(){var e,a,f=function(e,t,n){var r;return r=e?n.chartSize:t.component(Wo.COMPONENT.BAR).rect,"vertical"===n.major.orientation?r.height:r.width}(n.get("isPreRender"),t,r),h=jf(f,i),p=function(e,t,n){var r=en().domain([e,t]);return r.nice(n),r}(d,m,h),g=[];if("SPARK"===r.mode){var y=function(e,t){return{roundedMin:e,roundedMax:t}}(d,m);e=y.roundedMin,a=y.roundedMax}else{var v=function(e,t,n,r,i,o,a,u){for(var s,l=o.formatter("bar"),c="vertical"===a.major.orientation?"height":"width",f=function(e){return Cf({text:e,fontSize:u.axis.label.name.fontSize,fontFamily:u.axis.label.name.fontFamily})[c]},d=If(e.domain(),2),m=d[0],h=d[1],p=e.ticks(r),g=r-1;g>0&&(s=void 0,s=i/p.length,!(Math.max.apply(Math,Ef(p.map(l).map(f)))<=s));g--){e.domain([t,n]),e.nice(g);var y=If(e.domain(),2);m=y[0],h=y[1],p=e.ticks(g)}return{roundedMin:m,roundedMax:h,ticks:p}}(p,d,m,h,f,t,r,o);if(e=v.roundedMin,a=v.roundedMax,Wf(g=v.ticks,u,s)){var b=zf(p,d,m,l||c);e=b.roundedMin,a=b.roundedMax,g=b.ticks}}var M=function(e,t){for(var n=[],r=0;r<e.length-1;r++)for(var i=e[r],o=(e[r+1]-i)/(t+1),a=1;a<=t;a++)n.push(i+o*a);return n}(g,1);return g=function(e,t,n){return e&&n.length&&!n.some(function(e){return e===t})?(n.unshift(t),n.filter(function(e){return e>=t})):n}(l,u,g),{roundedMin:e,roundedMax:a,ticks:function(e,t){return[].concat(Ff(e.map(Vf)),Ff(t.map(Uf))).sort(_f)}(g=function(e,t,n){return e&&n.length&&!n.some(function(e){return e===t})?(n.push(t),n.filter(function(e){return e<=t})):n}(c,s,g),M)}},function(){return n.get("isPreRender")});return{values:function(){return h().ticks},min:function(){return l?u:h().roundedMin},max:function(){return c?s:h().roundedMax}}}function Gf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Yf(e,t,n[t])})}return e}function Yf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xf(e,t,n){var r=t.picasso,i=t.discrete,o=t.layoutModel,a=t.dockModel,u=t.viewModel,s=t.viewCache,l=t.reducedDataModel,c=t.colorModel,f=t.miniColorModel,d=t.themeModel,m=t.trendData,h=t.viewState,p=t.chart,g=n.localeInfo,y=n.rtl,v=o.meta,b=u.fields,M=function(){if("custom"!==o.getLayoutValue("dimensionAxis.axisDisplayMode"))return Math.min(200,a.chartSize["vertical"===a.major.orientation?"height":"width"]/4)},x="none"===o.getLayoutValue("measureAxis.show")?.5:To.getAlignment(a.minor.orientation,a.minor.dock),w={},q=To.getDimensionScaleInvert(a.minor.orientation,y),S=c.scales(),k=f.scales();if(Object.assign(w,S,{reducedFill:k.reducedFill}),w[_l.MINOR]=function(e,t){var n=e.chart,r=e.viewModel.fields,i=e.dockModel,o=e.viewCache,a=e.layoutModel,u=e.themeModel,s=t.rtl,l=Kf({chart:n,dockModel:i,viewCache:o,layoutModel:a,themeModel:u}),c={invert:To.getMeasureScaleInvert(i.major.orientation,s),ticks:{values:l.values},minorTicks:{count:1},min:l.min,max:l.max};return a.meta.isStacked||(c.data={source:"qHyperCube",fields:r.minor}),c}({chart:p,viewModel:u,dockModel:a,viewCache:s,layoutModel:o,themeModel:d},{rtl:y}),v.isGroupedByDimension)[_l.MAJOR_INNER,_l.MAJOR].forEach(function(e,t){w[e]={invert:q,data:{source:"qHyperCube",hierarchy:{label:function(e){return e.qText?e.qText:""},value:function(e){return e.qElemNumber},props:Gf({},u.selectionDimensionProp(t),{group:v.isGroupedByDimension?{field:b.majorGroup}:void 0})}},label:function(e){return e.datum.label},ticks:{depth:t+1},maxPxStep:M,align:x}});else if(v.isGroupedByMeasure)w[_l.MAJOR]={type:"group-by-measure",invert:q,data:{extract:{source:"qHyperCube",field:"qDimensionInfo/0",props:Gf({},u.selectionDimensionProp(0))}},measureCount:e.qHyperCube.qMeasureInfo.length,maxPxStep:M,align:x};else if(v.isTime){var D=function(e,t){var n=e.layoutModel,r=e.viewModel,i=e.viewCache,o=e.picasso,a=e.viewState,u=e.localeInfo,s=e.themeModel,l=function(){return n.getLayoutValue("qHyperCube.qAxisData.qAxis",[])},c=o.formatter("q-time"),f=function(e){return Cf({text:e,fontSize:s.axis.label.name.fontSize,fontFamily:s.axis.label.name.fontFamily})};i.set("qTimeAxisCache",[]);var d={get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=i.get("qTimeAxisCache");return n[t]&&n[t][0]===e?n[t][1]:void 0},set:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;i.get("qTimeAxisCache")[n]=[e,t]},key:function(e){var t=e.distance,n=a.get("zoom"),r=n.min,o=(n.max-r)/(i.get("continuousMax")-i.get("continuousMin")),u=l().map(function(e){return e.qName});return[t,o.toString().length>12?o.toPrecision(12):o].concat(Tf(u)).toString()}};return{innerTime:{type:"q-time-axis",qAxis:l,field:r.fields.majorNumeric,min:function(){return a.get("zoom").min},max:function(){return a.get("zoom").max},invert:!!t,formatter:{fn:c,localeInfo:u,qNumFormat:n.getLayoutValue("qHyperCube.qDimensionInfo",[{}]).qNumFormat,measureText:f},ticks:{generator:{type:"d3"},level:"inner",anchor:"start",clamp:!0},cache:d},outerTime:{type:"q-time-axis",qAxis:l,field:r.fields.majorNumeric,min:function(){return a.get("zoom").min},max:function(){return a.get("zoom").max},invert:!!t,formatter:{fn:c,localeInfo:u,qNumFormat:n.getLayoutValue("qHyperCube.qDimensionInfo",[{}]).qNumFormat,measureText:f},ticks:{generator:{type:"d3"},level:"outer",anchor:"start",clamp:!0},cache:d}}}({picasso:r,localeInfo:g,viewState:h,viewModel:u,viewCache:s,themeModel:d,layoutModel:o},y),O=D.innerTime,A=D.outerTime;w[_l.MAJOR_INNER]=O,w[_l.MAJOR]=A}else v.isContinuous?w[_l.MAJOR]={type:"linear",invert:q,data:{extract:{key:"qHyperCube",field:b.majorNumeric}},ticks:{forceBounds:!0,count:h.get("zoom").min===h.get("zoom").max?1:void 0},minorTicks:{count:1},min:function(){return h.get("zoom").min},max:function(){return h.get("zoom").max}}:(w[_l.MAJOR]={invert:q,data:{extract:v.isDimensionless?b.minor.map(function(t,n){return{field:t,label:function(){return e.qHyperCube.qMeasureInfo[n].qFallbackTitle},value:n}}):{source:"qHyperCube",field:"qDimensionInfo/0",props:Gf({},u.selectionDimensionProp(0))}},type:v.isDimensionless?"band":void 0,maxPxStep:M,align:x},Array.isArray(m)&&m.length&&(w[_l.MAJOR_NUM]={data:{extract:{source:"qHyperCube",field:"qDimensionInfo/0",value:function(e){return e.qNum}}},maxPxStep:M,align:x}));var C=Pf(l,{major:w[_l.MAJOR],minor:w[_l.MINOR]},{majorScaleInvert:q,maxPxStep:M,align:x,getProp:s.get}),T=C.reducedMinor,P=C.reducedMajor;return v.isDiscrete&&(w[_l.MAJOR].range=i.query.getScaleRange,v.isGroupedByDimension&&(w[_l.MAJOR_INNER].range=i.query.getScaleRange)),w[l.scales.major]=P,w[l.scales.minor]=T,w}var Jf=function(e,t){var n,r,i,o,a=e.targets,u=e.requireFailure,s=e.recognizeWith,l=e.components,c=e.eventName,f=void 0===c?"tap":c;return{key:"event:tap",type:"Tap",requireFailure:u,recognizeWith:s,options:{event:f,interval:10,pointers:1,enable:function(e,r){return!r||!(!t.actions.select.enabled()&&!t.actions.tooltip.enabled())&&(n=this.chart.componentsFromPoint({x:r.center.x,y:r.center.y}).filter(function(e){return-1!==a.indexOf(e.key)})).length>0}},events:(r={},i=f,o=function(e){e.preventDefault();var r,i,o,u,s,c=(r=e,i=this.chart,s=i.element.getBoundingClientRect(),r.center?(o=r.center.x,u=r.center.y):(o=r.clientX,u=r.clientY),{x:o-s.left,y:u-s.top}),d=this.chart.shapesAt(c,{components:a.map(function(e){return{key:e,propagation:"stop"}}),propagation:"stop"}),m=this.chart.component("tooltip"),h="mouse"!==e.pointerType&&m&&m.show;if(!t.isLocked(n)&&!t.tooltipOnly&&t.actions.select.enabled()){var p=this.chart.componentsFromPoint({x:e.center.x,y:e.center.y}),g=p.some(function(e){return"legend-cat"===e.type});if(!d.length&&g||t.actions.select.emit("start",f,p),d.length&&l){var y="function"==typeof l?l(e,d):l;this.chart.brushFromShapes(d,{components:y}),t.actions.select.emit("end",f)}}t.actions.tooltip.enabled()&&(d.length?m.emit("show",e,{nodes:d}):h&&m.emit("hide"))},i in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o,r)}},Zf=function(e,t){if(!e.targets)throw new Error("Missing 'targets' property");return{interactions:[Jf(e,t)],components:[]}},$f=function(e){return{key:e.key,type:"brush-lasso",layout:{displayOrder:99},settings:{brush:{components:e.components},lasso:{fill:"rgba(0, 0, 0, 0)",stroke:"black",strokeWidth:2,opacity:.7,strokeDasharray:[]},snapIndicator:{threshold:75,strokeDasharray:"5, 5",stroke:"black",strokeWidth:2,opacity:.7},startPoint:{r:10,stroke:"rgba(77, 192, 78, 1)",strokeWidth:0,opacity:1}}}},Qf=function(e,t){var n=e.key,r=e.componentTargetKey,i=e.requireFailure,o=e.recognizeWith;return{key:"event:".concat(n),type:"Pan",requireFailure:i,recognizeWith:o,options:{event:"lasso",enable:function(e,n){return"lasso"===this.started||!n||!!(t.actions.select.enabled()&&t.actions.lasso.enabled()&&t.actions.lasso.active())&&this.chart.componentsFromPoint({x:n.center.x,y:n.center.y}).filter(function(e){return e.key===r}).length>0}},events:{lassostart:function(e){e.preventDefault(),"lasso"!==this.started&&(t.actions.select.emit("start","lasso"),this.chart.component(n).emit("lassoStart",e),this.started="lasso")},lassomove:function(e){e.preventDefault(),this.chart.component(n).emit("lassoMove",e)},lassoend:function(e){e.preventDefault(),this.started=!1,this.chart.component(n).emit("lassoEnd",e),t.actions.select.emit("end","lasso")}}}},ed=function(e,t){if(!e.componentTargetKey)throw new Error("Missing 'componentTargetKey' property");var n=Object.assign({key:"lasso"},e,{}),r=$f(n,t);return{interactions:[Qf(n,t)],components:[r]}};var td=function(e,t){var n=function(e){var t=e.key,n=e.targets,r=e.components,i=e.fillTargets,o=e.dock;return{key:t,type:"brush-area-dir",layout:{dock:n.map(function(e){return"@".concat(e)}).join(",")},settings:{multiple:!0,brush:{components:r},direction:"left"===o||"right"===o?"vertical":"horizontal",bubbles:{align:"left"===o||"top"===o?"end":"start",placement:"inside"},target:{components:i,fill:"rgba(82,204,82,0.2)"}}}}(e);return{interactions:[zl(e,t,"area")],components:[n]}};function nd(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function rd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function id(e){var t=e.layoutModel.meta.isStackedByDimension&&e.layoutModel.getLayoutValue("qHyperCube.qStackedDataPages.0.qArea.qHeight",NaN)>1;return Zf({targets:[t?Wo.COMPONENT.STACK_TOTAL_BAR:Wo.COMPONENT.BAR,"bar-axis","group-axis","outer-axis-overlay","inner-axis-overlay"]},function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){rd(e,t,n[t])})}return e}({},e,{tooltipOnly:!0}))}function od(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ad(e,t){if(void 0===t){var n=function(e){var t=e.colorModel.settings();if("field"===t.mode&&"dimension"===t.fieldType&&t.legendDataset&&!t.legendDataset.field(0).raw().qLocked){var n=Zf({targets:["legend-color-cat"],components:function(e,t){return[{key:t[0].key,action:e.srcEvent.ctrlKey?"set":"toggle",contexts:["selection"]}]}},e);return{gestures:n.interactions,components:n.components}}return{gestures:[],components:[]}}(e),r=id(e);return{components:[].concat(od(n.components),od(r.components)),gestures:[].concat(od(n.gestures),od(r.interactions))}}var i=function(e){var t=e.colorModel.settings(),n=function(e,t){return"field"===e.mode&&("dimension"===e.fieldType&&!t.field(e.field).raw().qLocked||"measure"===e.fieldType&&"categorical"===e.type)}(t,e.ds),r=e.layoutModel.meta.isStackedByDimension&&e.layoutModel.getLayoutValue("qHyperCube.qStackedDataPages.0.qArea.qHeight",NaN)>1;return Zf({targets:[r?Wo.COMPONENT.STACK_TOTAL_BAR:Wo.COMPONENT.BAR,Wo.COMPONENT.BAR_AXIS,"group-axis","outer-axis-overlay","inner-axis-overlay",!("field"!==t.mode||!n)&&"legend-color-cat"].filter(Boolean),components:function(e,t){return-1!==[Wo.COMPONENT.BAR,Wo.COMPONENT.BAR_AXIS,"group-axis"].indexOf(t[0].key)?[{key:t[0].key,action:e.srcEvent.ctrlKey?"set":"toggle",contexts:["selection"],data:["selectionDimension"]}]:[{key:t[0].key,action:e.srcEvent.ctrlKey?"set":"toggle",contexts:["selection"]}]}},e)}(e),o=function(e){var t=e.layoutModel.meta.isStackedByDimension&&e.layoutModel.getLayoutValue("qHyperCube.qStackedDataPages.0.qArea.qHeight",NaN)>1;return ed({key:"lasso",componentTargetKey:Wo.COMPONENT.BAR,components:[t?{key:Wo.COMPONENT.STACK_TOTAL_BAR,contexts:["selection"],action:"add"}:{key:Wo.COMPONENT.BAR,contexts:["selection"],action:"add",data:["selectionDimension"]}]},e)}(e),a=function(e){return e.layoutModel.meta.isStacked?{components:[],interactions:[]}:Fl({eventName:"measureRange",key:"measureRangeBrush",targets:["y-axis",Wo.COMPONENT.BAR],fillTargets:["y-axis"],dock:e.dockModel.minor.dock,scale:_l.MINOR,onEdited:function(){e.actions.select.emit("end","measureRange")}},e)}(e),u=function(e){return e.layoutModel.meta.isContinuous?Fl({eventName:"continuousRange",key:"continuousRangeBrush",targets:e.layoutModel.meta.isTime?["outer-time-axis","inner-time-axis",Wo.COMPONENT.BAR]:["continuous-axis",Wo.COMPONENT.BAR],fillTargets:e.layoutModel.meta.isTime?["outer-time-axis","inner-time-axis"]:["continuous-axis"],observeBrush:!0,multiple:!0,dock:e.dockModel.major.dock,scale:e.layoutModel.meta.isTime?_l.MAJOR_INNER:_l.MAJOR,toLabel:function(t){var n=t.datum,r=t.data,i=t.scale,o=e.layoutModel.meta.isTime?i.formatter():e.chart.formatter("bar");return"".concat(n===Math.max.apply(Math,nd(r))?"<":"").concat(o(n))}},e):{components:[],interactions:[]}}(e),s=function(e){return td({eventName:"discreteRange",components:[{key:Wo.COMPONENT.BAR,contexts:["selection"],action:"set",data:["selectionDimension"]}],key:"discreteRangeBrush",targets:["group-axis",Wo.COMPONENT.BAR_AXIS,Wo.COMPONENT.BAR],fillTargets:["group-axis",Wo.COMPONENT.BAR_AXIS],dock:e.dockModel.major.dock},e)}(e);return{components:[].concat(od(i.components),od(o.components),od(a.components),od(s.components),od(u.components)),gestures:[].concat(od(o.interactions),od(i.interactions),od(a.interactions),od(s.interactions),od(u.interactions))}}var ud=function(e){return e.map(function(e){return e.qMaxPos}).reduce(function(e,t){return e+t},0)},sd=function(e){return e.map(function(e){return e.qMinNeg}).reduce(function(e,t){return e+t},0)};var ld={min:"Min",max:"Max"};function cd(e,t){var n=t.barComponent,r=t.type,o=t.isStacked,a=e.viewCache,u=e.layoutModel,s=e.dockModel,l=a.get("minorMinMax"),c=r===i.TYPES.MAX;if(function(e,t){return!e["hasOther".concat(ld[t])]}(l,r)){if(function(e,t){return!e["hasExplicit".concat(ld[t])]}(l,r))return!1;if(function(e,t,n){var r=n?e.implicitMax:e.implicitMin,o=Number(r.toFixed(13));return!i.hasHat(o,e,t)}(l,r,c))return!1}if(function(e,t,n){var r=n?function(e){return e<0}:function(e){return e>0};return e["hasExplicit".concat(ld[t])]&&r(e["explicit".concat(ld[t])])}(l,r,c))return!1;var f="end";o&&(f=c?"sumOfPositives":"sumOfNegatives");var d,m,h=(d=function(){return e.chart.scale(_l.MINOR)[r]()},function(){return void 0===m&&(m=d()),m}),p=c?function(e){return e.datum[f].value>h()}:function(e){return e.datum[f].value<h()};return{type:"box-hat",key:"sliced-hat-".concat(r),layout:{dock:c?s.minor.maxDock:s.minor.minDock},data:n.data,brush:n.brush,settings:{orientation:n.settings.orientation,major:n.settings.major,minor:n.settings.minor,hat:g()({},n.settings.box,{fill:u.meta.isStacked?"#999":n.settings.box.fill,alignment:1,opacity:1,show:p})}}}var fd=.7;var dd=function(e,t){var n=t.componentKey,r=t.collectionKey,i=e.layoutModel.meta;if(!i.isStacked)return!1;var o=2;i.isContinuous&&(o=rc(e,n));var a=e.layoutModel.getLayoutValue("components",null),u=a?a.filter(function(e){return e.key===n})[0]:null,s={key:n,type:"box",data:{collection:r},settings:{major:{scale:_l.MAJOR},minor:{scale:_l.MINOR,start:{ref:"sumOfNegatives"},end:{ref:"sumOfPositives"}},orientation:e.dockModel.major.orientation,box:{width:function(e,t){var n;return n=e.isContinuous?1:fd,!e.isContinuous&&t&&t.style.width>0?t.style.width:n}(i,u),minWidthPx:o,opacity:0,fill:"none"},oob:{show:!1},whisker:{show:!1},median:{show:!1},line:{show:!1}}};return i.isStackedByDimension&&(s.brush={consume:[{context:"selection",data:[""],style:{active:{strokeWidth:2,stroke:"#000",opacity:1},inactive:{opacity:.3}}}]}),i.isContinuous&&(s.settings.major.ref={start:"timeStart",end:"timeEnd"}),s};function md(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hd(e){return void 0!==e.qNum&&"NaN"!==e.qNum?e.qNum:0}function pd(e,t,n){var r=t.collectionKey,i=e.layoutModel.meta,o=e.viewModel.fields;function a(t){var n=e.ds.field(t).raw(),r=e.ds.field(t).formatter(),o=!n.isCustomFormatted&&(n.qIsAutoFormat||"U"===n.qNumFormat.qType);var a={field:t,reduceLabel:"none"};return i.isStackedByDimension||(a.value=hd,a.label=function(e){return o?function(e){return void 0!==e.qNum&&"NaN"!==e.qNum?r(e.qNum):"-"}(e):e.qText}),a}var u={key:r,data:{extract:o.minor.map(function(t,r){var u=e.colorModel.datumProps(r),s=e.miniColorModel.datumProps(r),l=u[Object.keys(u)[0]],c=l&&l.field?l.field:void 0,f=c?{field:c,reduceLabel:"none",value:function(e){return void 0!==e.qNum&&"NaN"!==e.qNum?e.qNum:e.qText||"-"}}:void 0,d={field:i.isDimensionless?t:o.major,props:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){md(e,t,n[t])})}return e}({},e.viewModel.selectionDimensionProp(),{start:0,end:a(t),segment:i.isStacked?a(t):void 0,group:i.isGroupedByDimension?{field:o.majorGroup}:void 0,stack:i.isStacked?{field:o.majorStack}:void 0,measureIndex:i.isGroupedByDimension||i.isStackedByDimension?void 0:r,timeStart:i.isContinuous?{field:o.majorNumeric}:void 0,timeEnd:i.isContinuous?{field:o.majorNumeric}:void 0,fillTooltip:f},u,s,{id:{value:function(e){return"r".concat(e.qRow,"e").concat(e.qElemNumber,"m").concat(r)}}})};return i.isDimensionless&&(d.value=r),void 0!==n&&(d.source=n),b.deleteUndefinedProperties(d.props),d})}};return i.isStacked&&(u.data.stack={stackKey:function(e){return e.stack.value},value:function(e){return e.end.value},offset:"diverging"}),u}var gd="main-collection",yd="stack-total-collection",vd=function(e){var t,n,r,i,o,a,u,s=[pd(e,{collectionKey:gd})];return e.layoutModel.meta.isStacked&&s.push((n={collectionKey:yd},r=(t=e).layoutModel,i=t.viewModel,o=n.collectionKey,a=r.meta,u=i.fields,!!a.isStacked&&{key:o,data:{extract:a.isStackedByMeasure?function(e,t){var n={field:0,props:{sumOfPositives:{fields:t.minor.map(function(e){return{field:e}}),value:function(e){return e.reduce(function(e,t){return t>0?e+t:e},0)},reduceLabel:"none"},sumOfNegatives:{fields:t.minor.map(function(e){return{field:e}}),value:function(e){return e.reduce(function(e,t){return t<0?e+t:e},0)},reduceLabel:"none"}}};if(e.isContinuous){var r={field:t.major,value:function(e){return e.qNum},reduceLabel:"none"};n.props.timeStart=r,n.props.timeEnd=r,n.value=function(e){return e.qNum}}return n}(a,u):function(e,t){if(!e.isContinuous)return{field:t.majorStack,reduceLabel:"none",props:{sumOfPositives:{value:function(e){return e.qMaxPos}},sumOfNegatives:{value:function(e){return e.qMinNeg}}}};var n={field:t.majors[0],value:function(e){return e.qNum},reduceLabel:"none"};return{field:t.majorStack,trackBy:function(e){return e.qNum},reduce:function(e){return e[0]},props:{sumOfPositives:{field:t.minor[0],reduceLabel:"none",reduce:function(e){return e.reduce(function(e,t){return t>0?e+t:e},0)}},sumOfNegatives:{field:t.minor[0],reduceLabel:"none",reduce:function(e){return e.reduce(function(e,t){return t<0?e+t:e},0)}},timeStart:n,timeEnd:n}}}(a,u)}})),s};function bd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Md(e,t){var n=t.collectionKey,r=e.colorModel,i=e.reducedDataModel,o=i.fields,a=i.mode;return{key:n,data:{extract:o.minor.map(function(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){bd(e,t,n[t])})}return e}({end:{field:e,reduceLabel:"none"}},a.isStackedByMeasure&&!a.isReduced?r.datumProps(t):{});return a.isContinuous&&(n.timeStart={field:o.major,value:function(e){return e.qNum}},n.timeEnd=n.timeStart),{source:"miniCube",field:o.major,props:n}}),stack:{stackKey:function(e){return e.value},value:function(e){return e.end.value},offset:"diverging"}}}}function xd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wd(e,t){var n=t.collectionKey,r=e.colorModel,i=e.reducedDataModel,o=i.fields,a=i.mode;return{key:n,data:{extract:o.minor.map(function(e,t){var n=a.isReduced?{}:r.datumProps(t),i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){xd(e,t,n[t])})}return e}({end:{field:e},start:0,group:{field:o.majorGroup},measureIndex:t},n),u={source:"miniCube",field:a.isDimensionless?e:o.major,props:i};return a.isDimensionless&&(u.value=t),u})}}}var qd="mini-collection",Sd="mini-stack-collection",kd="mini-continuous-collection",Dd="miniCube",Od=function(e,t){var n=[];return Nl({layoutModel:t.layoutModel}).miniChart&&(t.reducedDataModel.mode.isContinuous?n.push(pd(t,{collectionKey:kd},Dd)):t.layoutModel.meta.isStacked?n.push(Md(t,{collectionKey:Sd})):n.push(wd(t,{collectionKey:qd}))),n},Ad=function(e,t){var n=vd(t),r=Od(e,t);return n.concat(r)};function Cd(e,t,n){var r=[{position:e,onBackground:!0,justify:0,overflow:n}];return t&&r.push({position:"inside",onBackground:!1,justify:"outside"===e?1:0,background:{fill:"#e6e6e6",padding:{left:2,right:2,top:2,bottom:2}}}),r}function Td(e,t){var n=e.layout,r=e.component,o=e.type,a=t.layoutModel,u=t.viewCache,s=a.meta;if(!Zc(n,t))return!1;var l=u.get("minorMinMax");if(!l.hasExplicitMinMax||o===i.TYPES.MAX&&0===l.max||o===i.TYPES.MIN&&0===l.min)return!1;var c=o===i.TYPES.MAX?l.implicitMax:l.implicitMin;if(!i.isOutOfBounds(c,l,o))return!1;var f,d,m,h=function(e){return e.data.end.label};s.isStacked&&(h=o===i.TYPES.MAX?function(e){if(i.isOutOfBounds(e.data.sumOfNegatives.value,l,o)){var n=0===e.data.sumOfNegatives.value?e.data.sumOfPositives.value:e.data.sumOfNegatives.value,r=t.chart.formatter("bar");return r?r(n):n}return""}:function(e){if(i.isOutOfBounds(e.data.sumOfPositives.value,l,o)){var n=0===e.data.sumOfPositives.value?e.data.sumOfNegatives.value:e.data.sumOfPositives.value,r=t.chart.formatter("bar");return r?r(n):n}return""}),"vertical"===t.dockModel.major.orientation?(f=o===i.TYPES.MAX?0:1,d=o===i.TYPES.MAX?-2:4,m=-2):(f=o===i.TYPES.MAX?1:0,d=-2,m=o===i.TYPES.MAX?4:-2);var p={label:h,simplifiedPlacements:function(e,t){return[{position:"outside",onBackground:!0,justify:e,overflow:!1,padding:t}]}(f,{top:d,bottom:d,left:m,right:m}),style:t.themeModel.label.value},y=[{component:r,selector:"path",strategy:{type:"bar",settings:{direction:"vertical"===t.dockModel.major.orientation?"down":"right",labels:[Gc(g()(t,p))],fontSize:t.themeModel.label.value.fontSize,fontFamily:t.themeModel.label.value.fontFamily}}}];return{key:"bar-oob-labels-".concat(o),type:"labels",layout:{minimumLayoutMode:"XSMALL"},settings:{sources:y}}}function Pd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Nd(e,t){if(!e||!Object.keys(e).length)return t;var n=g()(!0,{},e);return Array.isArray(t.consume)&&(n.consume=function(e,t){if(!Array.isArray(e))return t;var n=g()(!0,[],e);return t.forEach(function(e){var t=Pd(n.filter(function(t){return t.context===e.context}),1)[0];t?g()(!0,t,e):n.push(e)}),n}(e.consume,t.consume)),n}var Ld={extend:function(e,t){var n=e;return t.filter(Boolean).forEach(function(t){var r=e.filter(function(e){return e.key&&e.key===t.key})[0];if(r){var i=g()(!0,{},r.brush);g()(!0,r,t),t.brush&&(r.brush=Nd(i,t.brush))}else n.push(t)}),n}};function jd(e){return"all"===e||"title"===e}var Ed=function(e,t){return{dir:t.measureAxis,line:{stroke:e.paletteColor?e.paletteColor.color:t.colorModel.resolveUIColor({index:e.color})},scale:t.scale,value:e.refLineExpr.value}};function Id(e){return e.filter(function(e){return e.show})}function Rd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Hd(e,t,n[t])})}return e}function Hd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bd(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var zd=function(e,t,n){var r=t.extendComponents.slice(),i=mf({layout:e},t,n);if(i&&"center"===i.layout.dock)return{components:[i]};var o=Xf(e,t,n),a=t.actions,u=!(!a||!a.interact||a.interact.enabled()),s=t.colorModel.legend({eventName:"legend-c",key:"legend-color",viewState:t.viewState,chart:t.chart,styleReference:"object.barChart",rtl:n.rtl},{actions:a,navigationDisabled:u});if(s.components[0]){var l=s.components[0];if(o.fillRange&&("right"===l.layout.dock||"left"===l.layout.dock||n.rtl)&&(o.fillRange.invert=!0),"legend-seq"===l.type&&void 0!==t.viewModel.selectionDimensionIdx&&o.fillRange&&o.fillRange.min<o.fillRange.max){var c,f,d=Fl({eventName:"legendRange",key:"legendRangeBrush",targets:[l.key],fillTargets:[l.key],targetSelector:'[id="legend-seq-target"]',targetFillSelector:'[id="legend-seq-ticks"]',dock:l.layout.dock,scale:"fillRange",bubblesPlacement:"outside",onEdited:function(){t.actions.select.emit("end","legendRange")}},t);(c=s.components).push.apply(c,Bd(d.components)),(f=s.interactions).unshift.apply(f,Bd(d.interactions))}if("legend-cat"===l.type){var m=Of(l,t);r.unshift(m)}}else o.fillRange&&n.rtl&&(o.fillRange.invert=!0);var h,p=ic(t,{componentKey:Wo.COMPONENT.BAR,collectionKey:Wo.COLLECTION.MAIN}),y=dd(t,{componentKey:Wo.COMPONENT.STACK_TOTAL_BAR,collectionKey:Wo.COLLECTION.STACK_TOTAL}),v=ad(t,t.viewModel.selectionDimensionIdx),b=t.layoutModel.meta.isStacked;h=t.reducedDataModel.mode.isContinuous?Wo.COLLECTION.MINI_CONTINUOUS:b?Wo.COLLECTION.MINI_STACK:Wo.COLLECTION.MINI;var M=b?y:p,x=function(e,t){var n=[gf(e,t)];return n[0]&&n.push(yf(t)),n}(e,t),w=Ld.extend([].concat(Bd(x),[function(e,t){var n=Id(e.refLine.refLines);if(!n.length)return!1;var r=To.getMinorScaleAxis(t.dockModel.major.orientation),i=n.map(function(e){return Ed(e,{scale:_l.MINOR,measureAxis:r,colorModel:t.colorModel})}),o=g()({key:"ref-line-y",type:"ref-line",lines:{y:[],x:[]},style:{oob:{show:!1}},preferredSize:function(){return{size:0,edgeBleed:{left:1,right:1,top:1,bottom:1}}}},Ll.refLines);return o.lines[r]=i,o}(e,t),function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{scale:"minor"}).scale,r=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{formatter:"bar"}).formatter,i=arguments.length>4?arguments[4]:void 0,o=e.refLine.refLines.filter(function(e){return e.show});if(!o.length)return!1;var a=t.dockModel.minor.opposite;return{key:"ref-line-labels",type:"ref-line-labels",renderer:"svg",labels:o.map(function(e){return{value:e.refLineExpr.value,text:e.label,fill:e.paletteColor?e.paletteColor.color:t.colorModel.resolveUIColor({index:e.color})}}),formatter:r,scale:n,layout:{dock:a,rtl:i.rtl},style:{label:{fontSize:t.themeModel.referenceLine.label.name.fontSize,fontFamily:t.themeModel.referenceLine.label.name.fontFamily,padding:{top:2,bottom:2,left:i.rtl?0:4,right:i.rtl?4:0},maxWidth:100,gap:"left"===a||"right"===a?10:16},oob:{size:8,fill:t.themeModel.referenceLine.outOfBounds.backgroundColor,text:{fill:t.themeModel.referenceLine.outOfBounds.color,fontSize:t.themeModel.referenceLine.outOfBounds.fontSize,fontFamily:t.themeModel.referenceLine.outOfBounds.fontFamily,background:{fill:t.themeModel.referenceLine.outOfBounds.backgroundColor}}}}}}(e,t,{scale:"minor"},{formatter:"bar"},n),cd(t,{barComponent:M,type:"max",isStacked:b}),cd(t,{barComponent:M,type:"min",isStacked:b}),Dc(t,{barComponent:M,type:"max",isStacked:b}),Dc(t,{barComponent:M,type:"min",isStacked:b})],Bd($l(e,t,n,!!x[0])),[p,y,function(e){var t=e.layoutModel,n=e.viewModel,r=e.dockModel,i=t.meta;if(!i.isStackedByDimension||i.isContinuous)return!1;var o=n.fields,a=t.getLayoutValue("components",null),u=a?a.filter(function(e){return"bar"===e.key})[0]:null;return{key:"shadow-bar",type:"box",data:{extract:[{field:o.majorStack,filter:function(e){return 0!==e.qDown||0!==e.qUp},props:{start:{value:function(e){return ud(e.qSubNodes)}},end:{value:function(e){return e.qMaxPos}}}},{field:o.majorStack,filter:function(e){return 0!==e.qDown||0!==e.qUp},props:{start:{value:function(e){return sd(e.qSubNodes)}},end:{value:function(e){return e.qMinNeg}}}}]},settings:{major:{scale:_l.MAJOR},minor:{scale:_l.MINOR},orientation:r.major.orientation,box:{width:u&&u.style.width>0?u.style.width:.7,fill:function(){return{type:"pattern",fill:"rgba(165, 165, 165, 0.8)",width:4,height:4,shapes:[{type:"rect",x:0,y:3,width:1,height:1},{type:"rect",x:1,y:2,width:1,height:1},{type:"rect",x:2,y:1,width:1,height:1},{type:"rect",x:3,y:0,width:1,height:1}]}}},oob:{show:!1},whisker:{show:!1},median:{show:!1},line:{show:!1}}}}({layoutModel:t.layoutModel,viewModel:t.viewModel,layout:e,dockModel:t.dockModel}),function(e,t,n){if(!jd(e.dimensionAxis.show)||t.layoutModel.meta.isDimensionless)return!1;var r=t.properties,i={hyperCube:e.qHyperCube,hyperCubeDef:r&&r.qHyperCubeDef,isDimension:!0,disabled:function(){return!(-1!==n.permissions.indexOf("fetch")&&-1!==n.permissions.indexOf("interact"))},model:t.model,app:t.app,translator:t.translator,rtl:n.rtl,selections:t.selections};return t.layoutModel.meta.hasMultipleDimensions&&(i.padding="0",i.minWidth="fit-content"),{key:"dimension-title",type:"data-title",layout:{minimumLayoutMode:Ll["".concat(t.dockModel.major.orientation,"DimensionAxisTitle")].minimumLayoutMode,dock:t.dockModel.major.dock},settings:i,style:{fontFamily:t.themeModel.axis.title.fontFamily,fontSize:t.themeModel.axis.title.fontSize,color:t.themeModel.axis.title.color}}}(e,t,n),function(e,t,n){if(!jd(e.measureAxis.show))return!1;var r=t.properties,i={hyperCube:e.qHyperCube,hyperCubeDef:r&&r.qHyperCubeDef,isDimension:!1,disabled:function(){return!t.actions.select.enabled()},model:t.model,app:t.app,translator:t.translator,rtl:n.rtl,selections:t.selections};return t.layoutModel.meta.hasMultipleMeasures&&(i.padding="0",i.minWidth="fit-content"),{key:"measure-title",type:"data-title",layout:{minimumLayoutMode:"SMALL",dock:t.dockModel.minor.dock},settings:i,style:{fontFamily:t.themeModel.axis.title.fontFamily,fontSize:t.themeModel.axis.title.fontSize,color:t.themeModel.axis.title.color}}}(e,t,n),function(e){var t=e.opts,n=e.rtl;return!t.layoutModel.meta.isSnapshot&&{key:"scroll-hint",type:"scroll-hint",settings:{orientation:t.dockModel.major.orientation,rtl:n,range:function(){return Tl(t)}}}}({opts:t,rtl:n.rtl}),Af(p,t,{collectionKey:h}),function(e){var t=e.opts,n=e.rtl,r=e.visualizeCache,i=void 0!==r&&r,o=t.layoutModel,a=Nl({layoutModel:o});if(a.none)return!1;var u=t.dockModel,s=t.themeModel,l=t.continuousDataModel,c=t.discrete,f={key:"scroll-area",type:"scroll-area",layout:{dock:"vertical"===u.major.orientation?u.minor.minDock:u.minor.maxDock,minimumLayoutMode:Ll.scrollArea.minimumLayoutMode},show:function(){return o.meta.isContinuous?l.getDimensionCardinality()>1:c.query.getCanScroll()},settings:{orientation:u.major.orientation,rtl:n,isContinuous:o.meta.isContinuous,range:function(){return Tl(t)}}};return a.bar&&(f.settings.style="slim",f.settings.size={area:{max:8,min:8}},o.meta.isContinuous||(f.settings.size.thumb={min:4})),s.color&&(f.style={standard:{thumb:{"border-color":s.color,opacity:.4},before:{background:s.color,opacity:.1},after:{background:s.color,opacity:.1}}}),o.meta.isDiscrete&&i&&(f.settings.injections=function(){return[El({layoutModel:o,discrete:c})]}),f}({opts:t,rtl:n.rtl})],Bd(s.components),[function(e,t,n){var r=e.layout,i=e.component,o=e.minorScale;if(!Zc(r,t))return!1;var a,u=t.viewModel,s=t.ds,l=t.viewCache,c=t.layoutModel,f=t.dockModel,d=t.themeModel,m=c.meta,h=l.get("minorMinMax");!m.isStacked&&(a=m.isStacked?1:0);var p=0===a?1:0,y=m.isStacked?.5:1,v=u.fields.minor[0],b=void 0===v?void 0:s.field(v).formatter(),M=-1,x={label:m.isStacked?m.isStackedByMeasure||!b?function(e){return e.data.segment.label}:function(e){return Math.abs(e.data.segment.value)>M?b(e.data.segment.value):""}:function(e){return e.data.end.label},simplifiedPlacements:function(e,t,n,r){var i=[];return void 0!==e&&(i[e]={position:"outside",onBackground:!0,justify:0,overflow:r}),void 0!==t&&(i[t]={position:"inside",onBackground:!1,justify:n}),i}(a,p,y,m.isContinuous),style:d.label.value},w=[Gc(g()(t,x))],q={key:"bar-labels",type:"labels",layout:{minimumLayoutMode:"XSMALL"},settings:{sources:[{component:i,selector:"rect",strategy:{type:"bar",settings:{direction:function(e){return Jc(e.data.end.value,f.major.orientation,n.rtl,h)},labels:w,fontSize:d.label.value.fontSize,fontFamily:d.label.value.fontFamily}}}]}};return m.isStackedByDimension&&b&&(q.beforeRender=function(){M=function(e,t,n){var r="horizontal"===t.dockModel.minor.orientation?"height":"width",i=t.chart.component(e),o=i&&i.rect?i.rect[r]:1,a=n?n.min():0;return 9.999*((n?n.max():0)-a)/o}(i,t,o)}),q}({layout:e,component:Wo.COMPONENT.BAR,minorScale:o.minor},t,n),function(e,t){var n=e.layout,r=e.component,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!function(e,t){var n=e.dataPoint;if(!n.showLabels)return!1;var r=t.layoutModel.meta,i=r.isStacked,o=r.isContinuous;return!(!i||!o&&!1===n.showTotalLabels)}(n,t))return!1;var o=t.layoutModel.meta,a=!Zc(n,t);function u(e){if(0===e)return"";var n=t.chart.formatter("bar");return n?n(e):e}var s={label:function(e){return u(e.data.sumOfPositives.value)},simplifiedPlacements:Cd("outside",a,o.isContinuous),style:t.themeModel.label.value},l={label:function(e){return u(e.data.sumOfNegatives.value)},simplifiedPlacements:Cd("opposite",a,o.isContinuous),style:t.themeModel.label.value};return{key:"stack-total-labels",type:"labels",layout:{displayOrder:2,minimumLayoutMode:"XSMALL"},settings:{sources:[{component:r,selector:"rect",strategy:{type:"bar",settings:{direction:function(e){return Jc(e.data.sumOfPositives.value,t.dockModel.major.orientation,i.rtl)},labels:[Gc(g()(t,s)),Gc(g()(t,l))],fontSize:t.themeModel.label.value.fontSize,fontFamily:t.themeModel.label.value.fontFamily}}}]}}}({layout:e,component:Wo.COMPONENT.STACK_TOTAL_BAR},t,n),Td({layout:e,component:"bar-oob-max",type:"max"},t),Td({layout:e,component:"bar-oob-min",type:"min"},t)],Bd(v.components),[function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=ef(e,t,Wo.COMPONENT.BASE_TOOLTIP);return g()(!0,r,{scale:"fill",settings:{filter:function(e){return uf.filterNodes({nodes:e,opts:t,barKey:Wo.COMPONENT.BAR,stackTotalBarKey:Wo.COMPONENT.STACK_TOTAL_BAR,barAxisKey:Wo.COMPONENT.BAR_AXIS,groupAxisKey:Wo.COMPONENT.GROUP_AXIS,barOobMaxKey:Wo.COMPONENT.BAR_OOB_MAX,barOobMinKey:Wo.COMPONENT.BAR_OOB_MIN,groupProp:"group",stackProp:"stack",majorScale:"major",majorInnerScale:"majorInner"})},extract:function(e){return uf.extractData(e,t,n)},placement:"bounds",direction:n.rtl?"rtl":"ltr"}})}({layout:e},Rd({},t,{coloring:t.colorModel.settings()}),n),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("categorical"!==t.colorModel.settings().type)return!1;var r=ef(e,t,Wo.COMPONENT.LEGEND_CAT_TOOLTIP);return g()(!0,r,{scale:"fill",settings:{filter:function(e){return sf.filterNodes(e,Wo.COMPONENT.LEGEND_COLOR_CAT)},extract:function(e){return sf.extractData(e,n)},placement:"pointer",direction:n.rtl?"rtl":"ltr"}})}({layout:e},Rd({},t,{coloring:t.colorModel.settings()}),n),i]).filter(Boolean),r);!function(e){if(e&&0!==e.length)for(var t=0;t<e.length;t++)e[t].layout=e[t].layout||{},e[t].layout.displayOrder=t}(w);var q=[].concat(Bd(s.interactions),Bd(v.gestures)).sort(function(e,t){return(t.prio||0)-(e.prio||0)});return{interactions:kf(t,{scroller:t.scroller,rtl:n.rtl,hammer:{gestures:q}}),scales:o,palettes:t.colorModel.palettes(),components:w,strategy:Rl(0,{logicalSize:n.logicalSize,minCenterRatio:0}),formatters:function(e,t){var n=t.fill;return{bar:{data:{fields:e.viewModel.fields.minor}},fill:n&&n.data&&n.data.field?{data:{field:n.data.field}}:{}}}(t,o),collections:Ad(e,t)}};function Fd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _d(e,t){return{fetch:function(){var n=t.getLayoutValue("qHyperCube"),r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Fd(e,t,n[t])})}return e}({},n,{qDataPages:n.qDataPages.slice()});return e.resolve({reducedCube:r})}}}function Vd(e){var t=e.enigma,n=e.layoutModel,r=e.viewModel,i=e.Promise,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=function(e,t){return{fetch:function(){return function(e,t,n){return e.getHyperCubeReducedData(n.path,[n.rect],n.zoomLevel,n.filter).then(function(e){var n=t.getLayoutValue("qHyperCube.qMode"),r=t.getLayoutValue("qHyperCube.qDimensionInfo"),i="K"===n&&r.length>1&&e[0].qIsReduced,o=e.slice(),a=t.getLayoutValue("qHyperCube.qMeasureInfo");return{reducedCube:{qDataPages:o,qDimensionInfo:r.slice(),qEffectiveInterColumnSortOrder:[1,0],qMeasureInfo:i?[a[0],a[0]]:a.slice(),qStackedDataPages:[],qMode:"S",qHasOtherValues:t.getLayoutValue("qHyperCube.qHasOtherValues"),qSize:t.getLayoutValue("qHyperCube.qSize")}}})}(e,t,this.settings())},settings:function(){var e=t.getLayoutValue("qHyperCube.qDimensionInfo"),n=t.meta.isStacked&&e.length>1?1:0,r=t.getLayoutValue("qHyperCube.qMeasureInfo");return{path:"/qHyperCubeDef",rect:{qTop:0,qLeft:n,qWidth:e.length+r.length+n,qHeight:Math.min(2e3,1e4/(r.length+1))},zoomLevel:-1,filter:"D1"}}}}(t,n),u=function(e,t){return{fetch:function(){return e.resolve({reducedCube:t.getLayoutValue("reducedHyperCube")||t.getLayoutValue("qHyperCube")})}}}(i,n),s=_d(i,n),l=function(e){var t=e.layoutModel.meta,n=t.isSnapshot,r=t.isStackedByDimension,i=function(e){e.qDimensionInfo.unshift({key:"dummy-patch-dimension"})};return i.should=function(e){return n&&r&&1===e.qDimensionInfo.length},i}({layoutModel:n}),c={mode:{isReduced:!1}};return{fetch:function(){if(n.meta.isSnapshot)return u.fetch();if(n.meta.isContinuous)return s.fetch();if(!n.meta.isStacked&&n.getLayoutValue("qHyperCube.qSize.qcy",NaN)===n.getLayoutValue("qHyperCube.qDataPages.0.qArea.qHeight",NaN))return s.fetch();return a.fetch()},model:function(){return c},update:function(e){var t;l.should(e)&&l(e),c.mode=g()(c.mode,n.meta),c.mode.isReduced=e.qDataPages[0]&&e.qDataPages[0].qIsReduced,c.mode.isStackedByDimension=c.mode.isStacked&&2===(t=e).qDimensionInfo.length&&2===t.qMeasureInfo.length,c.mode.isStackedByMeasure=c.mode.isStacked&&function(e){return e.qMeasureInfo.length>1&&1===e.qDimensionInfo.length}(e),c.fields={major:c.mode.isStackedByDimension?"qDimensionInfo/".concat(e.qDimensionInfo.length-1):r.fields.major,majorGroup:r.fields.majorGroup,minor:c.mode.isStackedByDimension?e.qMeasureInfo.map(function(e,t){return"qMeasureInfo/".concat(t)}):r.fields.minor},c.scales={major:"miniMajor",minor:"miniMinor"},c.cube=e,o.qDataPages=e.qDataPages},fetchMinMaxData:function(){if(o.qDataPages)return i.resolve(o.qDataPages);var e=a.settings(),r="K"===n.getLayoutValue("qHyperCube.qMode")?1:e.rect.qHeight;return e=g()(!0,{},e,{rect:{qHeight:r}}),t.getHyperCubeReducedData(e.path,[e.rect],e.zoomLevel,e.filter).then(function(e){return e})},setSnapshotData:function(e){e.reducedHyperCube=c.cube}}}var Ud="Enter",Wd="Escape",Kd="Esc",Gd=[],Yd=0,Xd=function(e){var t=Gd.filter(function(e){return e.selections&&e.selections.isActive()});t.length&&(e.key===Ud?t.forEach(function(e){return e.selections.confirm()}):e.key!==Wd&&e.key!==Kd||t.forEach(function(e){return e.selections.cancel()}))},Jd=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.selections,n=e.brush,r=e.actions,i=e.picassoQ,o=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).path,a=void 0===o?"/qHyperCubeDef":o;if(!t)return{release:function(){}};var u=++Yd,s=null,l=[];t.on=t.on.bind(t),t.isActive=t.isActive.bind(t),t.addListener=t.addListener.bind(t),t.removeListener=t.removeListener.bind(t);var c=function(e){return n.brushes().forEach(function(t){"range"===t.type?n.clear([]):e[0]&&e[0].key!==t.id&&n.clear([])}),e.filter(function(e){return-2!==e.value})},f=function(e){return n.brushes().filter(function(e){return"value"===e.type}).length?(n.clear([]),e):(n.brushes().forEach(function(t){var r=t.id===e[0].key||-1!==l.indexOf(t.id)&&-1!==l.indexOf(e[0].key);"range"!==t.type||r||n.clear([])}),e)};n.intercept("set-ranges",f),n.intercept("toggle-ranges",f),n.intercept("toggle-values",c),n.intercept("set-values",c),n.intercept("add-values",c),n.on("start",function(){return t.begin(a)});var d,m,h={activate:function(){},deactivated:function(){return n.end()},cleared:function(){return n.clear()},canceled:function(){return n.end()}};return d=t,m=h,Object.keys(m).forEach(function(e){d.on(e,m[e])}),r&&r.select?(r.select.on("start",function(){n.start()}),r.select.on("end",function(){i.selections(n,{},s).forEach(function(e){return t.select(e)})})):n.on("update",function(){i.selections(n,{},s).forEach(function(e){return t.select(e)})}),0===Gd.length&&document.addEventListener("keyup",Xd),Gd.push({key:u,selections:t}),{layout:function(e){s=e},allowSimultaneous:function(e){l=e},release:function(){s=null;var e,n,r=Gd.indexOf(Gd.filter(function(e){return e.key===u})[0]);-1!==r&&Gd.splice(r,1),Gd.length||document.removeEventListener("keyup",Xd),e=t,n=h,Object.keys(n).forEach(function(t){e.removeListener(t,n[t])})}}},Zd={ENTER:"Enter",ESCAPE:"Escape",IE11_ESC:"Esc",SHIFT:"Shift"};function $d(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Qd="QlikView Sans";function em(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function tm(){var e,t,n,r={};return{update:function(r){var i;e={object:[["","","color"],["object.barChart","outOfRange","color","#999"],["object.barChart","axis.title","color"],["object.barChart","axis.title","fontSize","13px"],["object.barChart","axis.title","fontFamily",Qd],["object.barChart","axis.label.name","color","#595959"],["object.barChart","axis.label.name","fontSize","12px"],["object.barChart","axis.label.name","fontFamily",Qd],["object.barChart","axis.line.major","color","#cccccc"],["object.barChart","axis.line.minor","color","#e6e6e6"],["object","grid.line.major","color","#cccccc"],["object","grid.line.minor","color","#e6e6e6"],["object","grid.line.highContrast","color","#e6e6e6"],["object","referenceLine.label.name","color","#333333"],["object","referenceLine.label.name","fontSize","12px"],["object","referenceLine.label.name","fontFamily",Qd],["object","referenceLine.outOfBounds","color","#e6e6e6"],["object","referenceLine.outOfBounds","backgroundColor","#737373"],["object","referenceLine.outOfBounds","fontFamily",Qd],["object","referenceLine.outOfBounds","fontSize","12px"],["object.barChart","label.value","color","#333333"],[!1,"label.value","lightColor","#E6E6E6"],[!1,"label.value","darkColor","#595959"],["object.barChart","label.value","fontSize","11px",function(e){return parseInt(e,10)}],["object.barChart","label.value","fontFamily",Qd]]},i=t=r||t,n={resolve:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;if(!1===e||!i)return r;var o=i.getStyle(e,t,n);return void 0===o?r:o}}},model:function(){return e.object.forEach(function(e){var i=em(e,5),o=i[0],a=i[1],u=i[2],s=i[3],l=i[4],c=(void 0===l?function(e){return e}:l)(n.resolve(o,a,u,s),t);g()(!0,r,function(e,t,n){var r=e.split(".").filter(function(e){return e.length}),i={},o=i;return r.forEach(function(e){o[e]={},o=o[e]}),void 0!==n&&(o[t]=n),i}(a,u,c))}),r}}}var nm=function(e){for(var t=0;t<e.qDimensionInfo.length;t++){var n=e.qDimensionInfo[t];if(!(n.qLocked||n.qStateCounts.qOption+n.qStateCounts.qSelected<=1))return t}};function rm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){im(e,t,n[t])})}return e}function im(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function om(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var am=function(e){var t,n=function(){var e=Ha()();return e.use(za.a),e.use(_a.a),e.use(Tu),e.use(Hs),e.use(Tu((Xa.a,Cu.a,Za.a))),e.component("box-hat",Ys),e.component("box-oob",Js),e.component("scroll-area",$u),e.component("scroll-hint",is),e.component("ref-line-labels",Rs),e.component("axis-overlay",wo.picassoComponents.axisOverlay),e.component("time-axis",wo.picassoComponents.timeAxis),e.scale("q-time-axis",wo.picassoScales.time),e}(),r=(t=[{key:"interact",isEnabled:!0,enabled:function(){return this.isEnabled},update:function(e){this.isEnabled=-1!==e.indexOf("interact")}},{key:"tooltip",isActive:!0,isEnabled:!0,action:function(e){this.isActive=!!e},active:function(){return this.isActive},enabled:function(){return this.isEnabled},update:function(e){this.isEnabled=-1!==e.indexOf("passive")}},{key:"scroll",isActive:!0,isEnabled:!0,action:function(){this.isActive=!this.isActive},active:function(){return this.isActive},enabled:function(e){var t=e.layoutModel,n=e.discrete;return this.isEnabled&&(t.meta.isContinuous||n.query.getCanScroll())},update:function(e){this.isEnabled=-1!==e.indexOf("interact")&&-1!==e.indexOf("fetch")}},{key:"select",isActive:!1,isEnabled:!0,action:function(){this.isActive=!this.isActive},active:function(){return this.isActive},enabled:function(){return this.isEnabled},update:function(e){this.isEnabled=-1!==e.indexOf("interact")&&-1!==e.indexOf("select")}}],{get:function(){return t},update:function(e,n){return t.forEach(function(t){return e[t.key].update(n)})}});return{qae:tl(e.flags),selectionToolbar:{items:[{key:"lasso",label:"Lasso",icon:"lasso",activated:!1,action:function(){this.activated=!this.activated},enabled:function(){return!0},active:function(){return this.activated}}]},actions:r.get(),logicalSize:ul,component:{created:function(t){var r,i,o,a,u,s,l,c,f,d=t.options;this.resources=e,this.picasso=n({renderer:{prio:[d.renderer||"canvas"]},style:{"$font-family":"QlikView Sans"}}),this.color=(r={picasso:this.picasso,model:this.model,app:this.app,translator:e.translator,Promise:e.Promise},i=Na(r).auto(Ia),o={scales:function(){return{}},color:function(){return function(e){return e}},datumProps:function(){return{}},getAuxiliarySettings:function(){}},{update:function(e){i.config(La({colorProps:La({},e.layout.color,{useBaseColors:Ea(e.layout)}),legendProps:e.layout.legend},e,{key:"fill",source:e.source}))},settings:function(){return i.settings()},model:function(){return i},mini:{update:function(e){(o=Na(r).auto(Ia)).config(La({colorProps:La({},e.layout.color,{useBaseColors:Ea(e.layout)})},e,{key:"reducedFill",source:e.source}))},model:function(){return o}}}),this.viewState=(a={scrollOffset:void 0,viewRange:[0,1],zoom:{min:0,max:0},legendScrollOffset:0},u=g()({},a),s={},l={},f=!1,(c={}).set=function(e,t){var n=u[e];!f&&l[e]?u[e]=l[e](t,n):u[e]=t,!f&&s[e]&&s[e](u[e],n)},c.preventSet=function(e,t){f=!0,c.set(e,t),f=!1},c.get=function(e){return u[e]},c.onChanged=function(e,t){s[e]=t},c.intercept=function(e,t){l[e]=t},c),this.viewCache=j()},mounted:function(e){this.element=e,this.chart=this.picasso.chart({element:e,data:[],settings:{}}),this.selectionsSetup=function(e){var t=e.chart,n=e.actions,r=e.selections,i=e.document,o=Jd({selections:r,brush:t.brush("selection"),actions:n,picassoQ:za.a});t.brush("selection").configure({ranges:[{key:"qHyperCube/qDimensionInfo/0:numeric",includeMax:!1}]}),o.allowSimultaneous($d(Array(15)).map(function(e,t){return"qHyperCube/qMeasureInfo/".concat(t)}));var a=!1,u=function(e){e.key===Zd.SHIFT&&e.shiftKey!==a&&(a=e.shiftKey,n.lasso.action())};i.addEventListener("keydown",u),i.addEventListener("keyup",u);var s=function(e,n){var r=t.component("measureRangeBrush"),o=t.component("legendRangeBrush"),a=t.component("discreteRangeBrush"),u=t.component("continuousRangeBrush"),s="tap"===e&&n.some(function(e){return"inner-time-axis"===e.key||"outer-time-axis"===e.key||"continuous-axis"});if("measureRange"!==e&&r&&i.querySelector("[data-key='measureRangeBrush-edge-0']")){r.emit("rangeClear");var l=r.settings.settings,c=l.scale,f=l.brush,d=t.scale(c).data().fields.map(function(e){return e.id()}),m=t.brush(f),h=m.brushes().filter(function(e){return"range"===e.type&&d.some(function(t){return t===e.id})});m&&h.length&&h.forEach(function(e){m.removeRanges(e.brush.ranges().map(function(t){return{key:e.id,range:t}}))})}if("legendRange"!==e&&o&&i.querySelector("[data-key='legendRangeBrush-edge-0']")){o.emit("rangeClear");var p=t.scale(o.settings.settings.scale).data().fields[0].id(),g=t.brush(o.settings.settings.brush).brushes().filter(function(e){return"range"===e.type&&e.id===p})[0];g&&g.brush.clear()}if("discreteRange"!==e&&a&&a.emit("areaClear"),"continuousRange"!==e&&u&&!s){u.emit("rangeClear");var y=u.settings.settings,v=y.scale,b=y.brush,M=t.scale(v).data().fields.map(function(e){return e.id()}),x=t.brush(b.context),w=x.brushes().filter(function(e){return"range"===e.type&&M.some(function(t){return t===e.id})});x&&w.length&&w.forEach(function(e){x.removeRanges(e.brush.ranges().map(function(t){return{key:e.id,range:t}}))})}};n.select.on("start",s);var l=function(){n.lasso.active()&&n.lasso.action()},c=function(){var e=t.component("measureRangeBrush"),n=t.component("discreteRangeBrush"),r=t.component("legendRangeBrush"),i=t.component("continuousRangeBrush");e&&e.emit&&e.emit("rangeClear"),n&&n.emit&&n.emit("areaClear"),r&&r.emit&&r.emit("rangeClear"),i&&i.emit&&i.emit("rangeClear")};return r&&(r.on("deactivated",l),r.on("canceled",l),r.on("cleared",c),r.on("canceled",c)),{update:function(e){o.layout(e)},release:function(){i.removeEventListener("keydown",u),i.removeEventListener("keyup",u),o.release(),n.select.removeListener("start",s),r&&(r.removeListener("deactivated",l),r.removeListener("canceled",l),r.removeListener("cleared",c),r.removeListener("canceled",c))}}}({chart:this.chart,actions:this.actions,selections:this.selections,document:document})},render:function(t){var i,o,a=this,u=t.layout,s=t.context,l=t.opts,c=void 0===l?{}:l;Array.isArray(c.registerComponents)&&c.registerComponents.forEach(function(e){return n.component(e.type,e.component)}),r.update(this.actions,s.permissions),this.context=s,this.extendComponents=c.components||[],this.layoutModel=function(e){var t=e.source,n=e.metaAdditionsFn,r=g()(!0,{},t),i=function(e){return{isQMode:function(t){return e.qHyperCube.qMode===t}}}(r),o=So(r),a=function(){return Do({layout:r,additionsFn:n,additionsProps:{size:o.size}})},u={refs:Oo({},o.refs),meta:a(),query:Oo({},i),getLayout:function(){return r},getLayoutValue:function(e,t){return b.getValue(r,e,t)},setLayoutValue:function(e,t){b.setValue(r,e,t),o=So(r),u.meta=a()},getDataPages:function(){return b.getValue(r,o.refs.dataPages)},setDataPages:function(e){b.setValue(r,o.refs.dataPages,e),u.meta=a()}};return u.query=Oo({},i),u}({source:u,metaAdditionsFn:al}),this.viewModel=(i=this.layoutModel,(o={}).fields=function(e){var t=e.meta,n={majorGroup:t.isGroupedByDimension?"qDimensionInfo/0":void 0,majorStack:t.isStacked?"qDimensionInfo/0":void 0,major:t.isDimensionless?void 0:"qDimensionInfo/".concat(t.dimensionCount-1),majors:e.getLayoutValue("qHyperCube.qDimensionInfo").map(function(e,t){return"qDimensionInfo/".concat(t)}),minor:e.getLayoutValue("qHyperCube.qMeasureInfo").map(function(e,t){return"qMeasureInfo/".concat(t)})};return n.majorNumeric="".concat(t.isStackedByDimension?n.majorStack:n.major,":numeric"),n}(i),o.selectionDimensionIdx=nm(i.getLayoutValue("qHyperCube")),o.selectionDimensionProp=function(e){return void 0===o.selectionDimensionIdx||void 0!==e&&o.selectionDimensionIdx!==e?{}:{selectionDimension:{field:o.selectionDimensionIdx}}},o),this.dockModel=function(){var e=To.getInvertedOrientation,t=To.getDock,n=To.getOppositeDock,r=To.getSize,i={update:function(o,a){var u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=u.width,l=u.height,c=o.meta.isContinuous?"vertical":o.getLayoutValue("orientation");return i.chartSize={width:s,height:l},i.major={dock:"bottom",opposite:"top",orientation:c},i.minor={dock:a?"right":"left",opposite:a?"left":"right",orientation:e(c),maxDock:"top",minDock:"bottom"},i.major.dock=t(i.major.orientation,o.getLayoutValue("dimensionAxis.dock"),a),i.major.opposite=n(i.major.dock),i.major.containerSize=r(i.major.orientation,{width:s,height:l}),i.minor.dock=t(i.minor.orientation,o.getLayoutValue("measureAxis.dock"),a),i.minor.opposite=n(i.minor.dock),i.minor.maxDock=t(i.major.orientation,"far",a),i.minor.minDock=t(i.major.orientation,"near",a),i.minor.containerSize=r(i.minor.orientation,{width:s,height:l}),i.mode=jo.getLayoutMode(s,l),i}};return i}(),this.dockModel.update(this.layoutModel,s.rtl,Eo(this.chart,s.logicalSize)),this.themeModel=tm(),this.themeModel.update(s.theme,this.dockModel.mode),this.layoutModel.meta.isDiscrete&&(this.discrete=function(e){var t=e.chart,n=e.actions,r=e.componentKey,i=e.enigmaModel,o=e.layoutModel,a=e.dockModel,u=e.itemWidths,s=e.maxDataRows,l=e.viewState,c=e.rtl,f=e.Promise,d=L({enigmaModel:i,layoutModel:o,Promise:f}),m=K({chart:t,componentKey:r,discreteModel:d,layoutModel:o,dockModel:a,itemWidths:u,maxDataRows:s,viewState:l,rtl:c,Promise:f});return{interactions:Z({chart:t,actions:n,componentKey:r,dockModel:a,rtl:c,scroller:m}),query:{getCanScroll:function(){return m.enabled()},getItemSize:function(){return m.itemSize()},getScaleRange:function(){return m.scaleRange()},getCachedDataPages:function(){return d.getCachedDataPages()}},command:{initialize:function(){return m.initialize()},scrollTo:function(e){return m.scrollToRelative(e)},setSnapshotData:function(e){return d.setSnapshotData(e)}}}}({chart:this.chart,actions:this.actions,componentKey:Wo.COMPONENT.BAR,enigmaModel:this.model,layoutModel:this.layoutModel,dockModel:this.dockModel,itemWidths:Uo,maxDataRows:il,viewState:this.viewState,scrollEnabled:this.actions.scroll.enabled,rtl:this.context.rtl,Promise:e.Promise})),this.continuousDataModel=wo.model(this),this.reducedDataModel=Vd({enigma:this.model,layoutModel:this.layoutModel,viewModel:this.viewModel,Promise:e.Promise});var f=function(){return a.chart.update({partialData:!0,excludeFromUpdate:["mini-marker","dim-title","measure-title","ref-line","grid-line"]})};this.viewState.onChanged("scrollOffset",f),this.viewState.onChanged("legendScrollOffset",f),this.viewState.intercept("zoom",wo.event.onZoomIntercept(this)),this.viewState.onChanged("zoom",wo.event.onZoomChange(this,f)),this.selectionsSetup.update(this.layoutModel.getLayout()),function(e){var t=e.layoutModel,n=e.viewState,r=e.viewStateOptions,i=void 0===r?{}:r,o=t.meta.isSnapshot?t.getLayoutValue("snapshotData.content.chartData",{}):i;n.preventSet("scrollOffset",o.scrollOffset),n.preventSet("legendScrollOffset",o.legendScrollOffset||0)}({layoutModel:this.layoutModel,viewState:this.viewState,viewStateOptions:c.viewStateOptions});var d=[];this.layoutModel.meta.isContinuous&&(this.continuousDataModel.update(this.layoutModel.getLayout()),d.push(this.continuousDataModel.initialFetch())),d.push(this.reducedDataModel.fetch().then(function(e){var t=e.reducedCube;a.reducedDataModel.update(t)})),d.push(function(e){var t=e.layout,n=e.model,r=e.env;return zo.snapshot(t)?r.Promise.resolve(null):n.getEffectiveProperties().then(function(e){return{properties:e}})}({layout:this.layoutModel.getLayout(),model:this.model,env:e}));var m={trendData:ol(this.layoutModel),localeInfo:s.localeInfo};return e.Promise.all(d).then(function(t){var n=a.layoutModel.meta.isContinuous||a.reducedDataModel.model().mode.isReduced||a.layoutModel.meta.isStacked;return a.color.update({senseTheme:s.theme,hc:n?a.layoutModel.getLayoutValue("qHyperCube"):a.reducedDataModel.model().cube,layout:a.layoutModel.getLayout(),source:n?void 0:"miniCube",localeInfo:s.localeInfo}),a.layoutModel.meta.isContinuous&&a.color.mini.update({senseTheme:s.theme,hc:a.continuousDataModel.getInitialCube(),layout:a.continuousDataModel.getInitialLayout(),source:"miniCube"}),e.Promise.all([a.color.model().getAuxiliarySettings(),a.color.mini.model().getAuxiliarySettings()]).then(function(){return t})}).then(function(e){return(t=a,r=(n=t).reducedDataModel,i=n.layoutModel,o=n.continuousDataModel,u=n.resources.Promise,s=i.meta,l=i.query,c=i.getLayoutValue,f=function(e){return!e.length&&l.isQMode("K")},d=function(e){var t=c("qHyperCube.qStackedDataPages",[]);return{qStackedDataPages:t,others:e?t:[]}},m={resolve:function(){var e=c("qHyperCube.qMeasureInfo").length,t=c("qHyperCube.qDimensionInfo").length,n=c("qHyperCube.qHasOtherValues");if(!s.isStacked&&!n)return u.resolve({qDataPages:[{}],count:e});if(s.isContinuous){var i=s.isStackedByDimension?t:e;return o.fetchMinMaxData().then(function(e){return{qDataPages:e,count:i}})}var a=s.isStackedByDimension?1:e;return r.fetchMinMaxData().then(function(e){if(f(e))return d(n);var t=[];return n&&(t=l.isQMode("K")?c("qHyperCube.qStackedDataPages",[]):c("qHyperCube.qDataPages",[])),{qDataPages:e,count:a,others:t}})}},h=Cl(t),m.resolve().then(function(e){return h.extract(e)})).then(function(t){return a.viewCache.set("minorMinMax",t),e});var t,n,r,i,o,u,s,l,c,f,d,m,h}).then(function(e){var t=g.a.apply(void 0,[{}].concat(om(e),[m])),n=a.color.model().settings();!function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).colorField;/qAttrDimInfo/.test(t)&&(e.removeKeyAlias("attrDim/qDimensionInfo/0"),e.addKeyAlias("attrDim/qDimensionInfo/0","qHyperCube/".concat(t))),e.addKeyAlias("miniCube/qDimensionInfo/0","qHyperCube/qDimensionInfo/0"),e.addKeyAlias("miniCube/qDimensionInfo/1","qHyperCube/qDimensionInfo/1")}(a.chart.brush("selection"),{colorField:n.field});var r=a.layoutModel.getLayoutValue("qHyperCube"),i=a.layoutModel.meta.isContinuous?a.continuousDataModel.getInitialCube():a.reducedDataModel.model().cube;return a.dataPreparator=function(e,t,n,r,i){var o=r.refs.dataPages.split(".").pop(),a=[],u=[],s=r.meta.isContinuous?[{key:i.fields.majorNumeric,from:r.meta.isStackedByDimension?i.fields.majorStack:i.fields.major,override:{value:function(e){return e.qNum}}}]:void 0;return{prepPicassoDataSet:function(){return{key:"qHyperCube",data:e,config:{localeInfo:n.localeInfo,virtualFields:s}}},prepPicassoData:function(r){var i=[{type:"q",key:"qHyperCube",data:e,config:{localeInfo:n.localeInfo,virtualFields:s}},{type:"q",key:"miniCube",data:t,config:{localeInfo:n.localeInfo,virtualFields:s}}].concat(nl(r));return n.trendData.length&&i.push({key:"trend",data:n.trendData}),i},extractDataPages:function(){a=e[o],u=t.qDataPages,e[o]=[],t.qDataPages=[]},insertDataPages:function(){e[o]=a,t.qDataPages=u}}}(r,i,t,a.layoutModel,a.viewModel),a.paint(t)})},resize:function(t){var n=this,i=t.context;if(this.context=rm({},this.context,i),r.update(this.actions,this.context.permissions),this.dockModel.update(this.layoutModel,this.context.rtl,Eo(this.chart,this.context.logicalSize)),this.themeModel.update(i.theme),this.chart){this.dataPreparator.extractDataPages(),this.viewCache.set("isPreRender",!0),this.chart.update(),this.viewCache.set("isPreRender",!1),this.dataPreparator.insertDataPages();var o=[];this.layoutModel.meta.isDiscrete&&o.push(this.discrete.command.initialize()),e.Promise.all(o).then(function(){return n.chart.update({settings:n.generate()})})}},paint:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.picasso.data("q")(this.dataPreparator.prepPicassoDataSet()),i=this.dataPreparator.prepPicassoData(this.color.model().data()),o=this.selections;this.generate=function(){var i=g()({picasso:t.picasso,ds:r,localeInfo:t.context.localeInfo,model:t.model,app:t.app,chart:t.chart,actions:t.actions,selections:o,isLocked:o&&o.isLocked?o.isLocked:_o,translator:e.translator,viewCache:t.viewCache,viewState:t.viewState,layoutModel:t.layoutModel,scroller:t.scroller,dockModel:t.dockModel,viewModel:t.viewModel,colorModel:t.color.model(),miniColorModel:t.color.mini.model(),themeModel:t.themeModel.model(),discrete:t.discrete,continuousDataModel:t.continuousDataModel,reducedDataModel:t.reducedDataModel.model(),extendComponents:t.extendComponents},n);return zd(t.layoutModel.getLayout(),i,t.context)},this.viewCache.set("isPreRender",!0);var a=this.generate();this.dataPreparator.extractDataPages(),this.chart.update({data:i,settings:a}),this.viewCache.set("isPreRender",!1),this.dataPreparator.insertDataPages();var u=[];return 1!==a.components.length&&this.layoutModel.meta.isDiscrete&&u.push(this.discrete.command.initialize()),e.Promise.all(u).then(function(){t.chart.update()})},setSnapshotData:function(e){var t=this.dockModel.chartSize,n=t.width,r=t.height;return e.snapshotData.content={size:{w:n,h:r}},this.layoutModel.meta.isSnapshot?this.resources.Promise.resolve():(e.snapshotData.content.chartData={scrollOffset:this.viewState.get("scrollOffset"),zoom:this.viewState.get("zoom"),legendScrollOffset:Vo(this.chart,"legend-color-cat")},this.layoutModel.meta.isDiscrete?(this.discrete.command.setSnapshotData(e),this.reducedDataModel.setSnapshotData(e)):this.continuousDataModel.setSnapshotData(e),this.color.model().getSnapshotData().then(function(t){e.snapshotData.content.chartData=rm({},e.snapshotData.content.chartData,t)}).catch(function(){}))},getViewState:function(){return{scrollOffset:this.viewState.get("scrollOffset"),legendScrollOffset:Vo(this.chart,"legend-color-cat")}},willUnmount:function(){this.selectionsSetup.release()},destroy:function(){this.chart.destroy()}}}};function um(e){return(um="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sm(e){return(sm="function"==typeof Symbol&&"symbol"===um(Symbol.iterator)?function(e){return um(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":um(e)})(e)}function lm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){lm(e,t,n[t])})}return e}var fm=Object.prototype.hasOwnProperty,dm=Object.prototype.toString,mm=Object.defineProperty,hm=Object.getOwnPropertyDescriptor,pm=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===dm.call(e)},gm=function(e){if(!e||"[object Object]"!==dm.call(e))return!1;var t,n=fm.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&fm.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!r)return!1;for(t in e);return void 0===t||fm.call(e,t)},ym=function(e,t){mm&&"__proto__"===t.name?mm(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},vm=function(e,t){if("__proto__"===t){if(!fm.call(e,t))return;if(hm)return hm(e,t).value}return e[t]},bm=function e(){var t,n,r,i,o,a,u=arguments[0],s=1,l=arguments.length,c=!1;for("boolean"==typeof u&&(c=u,u=arguments[1]||{},s=2),(null==u||"object"!==sm(u)&&"function"!=typeof u)&&(u={});s<l;++s)if(null!=(t=arguments[s]))for(n in t)r=vm(u,n),u!==(i=vm(t,n))&&(c&&i&&(gm(i)||(o=pm(i)))?(o?(o=!1,a=r&&pm(r)?r:[]):a=r&&gm(r)?r:{},ym(u,{name:n,newValue:e(c,a,i)})):void 0!==i&&ym(u,{name:n,newValue:i}));return u},Mm={};function xm(){xm.init.call(this)}Mm.isObject=function(e){return"object"===sm(e)&&null!==e},Mm.isNumber=function(e){return"number"==typeof e},Mm.isUndefined=function(e){return void 0===e},Mm.isFunction=function(e){return"function"==typeof e};var wm=xm;xm.EventEmitter=xm,xm.prototype._events=void 0,xm.prototype._maxListeners=void 0,xm.defaultMaxListeners=10,xm.init=function(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0},xm.prototype.setMaxListeners=function(e){if(!Mm.isNumber(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},xm.prototype.emit=function(e){var t,n,r,i,o,a;if(this._events||(this._events={}),"error"===e&&!this._events.error)throw(t=arguments[1])instanceof Error?t:Error('Uncaught, unspecified "error" event.');if(n=this._events[e],Mm.isUndefined(n))return!1;if(Mm.isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];n.apply(this,i)}else if(Mm.isObject(n)){for(r=arguments.length,i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];for(r=(a=n.slice()).length,o=0;o<r;o++)a[o].apply(this,i)}return!0},xm.prototype.addListener=function(e,t){var n;if(!Mm.isFunction(t))throw TypeError("listener must be a function");(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,Mm.isFunction(t.listener)?t.listener:t),this._events[e]?Mm.isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,Mm.isObject(this._events[e])&&!this._events[e].warned)&&(n=Mm.isUndefined(this._maxListeners)?xm.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,Mm.isFunction(console.error)&&console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),Mm.isFunction(console.trace)&&console.trace());return this},xm.prototype.on=xm.prototype.addListener,xm.prototype.once=function(e,t){if(!Mm.isFunction(t))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}return r.listener=t,this.on(e,r),this},xm.prototype.removeListener=function(e,t){var n,r,i,o;if(!Mm.isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=(n=this._events[e]).length,r=-1,n===t||Mm.isFunction(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(Mm.isObject(n)){for(o=i;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){r=o;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},xm.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],Mm.isFunction(n))this.removeListener(e,n);else if(Array.isArray(n))for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},xm.prototype.listeners=function(e){return this._events&&this._events[e]?Mm.isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},xm.listenerCount=function(e,t){return e._events&&e._events[t]?Mm.isFunction(e._events[t])?1:e._events[t].length:0};var qm=function(e){return function(t){var n,r=(n=bm(!0,{},t,{action:function(){"function"==typeof t.action&&t.action.call(r,e),r.emit("changed")},enabled:function(){return"function"!=typeof t.enabled||t.enabled.call(r,e)},active:"function"==typeof t.active?function(){return t.active.call(r,e)}:void 0}),Object.keys(wm.prototype).forEach(function(e){n[e]=wm.prototype[e]}),wm.init(n),n);return r}};var Sm={app:null,model:null,actions:null,selections:null,created:function(){},mounted:function(){},render:function(){},resize:function(){},willUnmount:function(){},destroy:function(){},emit:function(){},getViewState:function(){},setSnapshotData:function(e){return Promise.resolve(e)}},km=Object.keys(Sm),Dm=function(e){return Object.keys(wm.prototype).forEach(function(t){e[t]=wm.prototype[t]}),wm.init(e),e};function Om(e,t){var n=cm({},Sm);Dm(n);var r={emit:function(){n.emit.apply(n,arguments)}};Object.keys(e.component||{}).forEach(function(t){-1!==km.indexOf(t)?n[t]=e.component[t].bind(r):r[t]=e.component[t]});var i=function(e){var t=e.sn,n=e.component,r={},i=[],o=qm(n);return((t.definition.selectionToolbar||{}).items||[]).forEach(function(e){var t=o(e);r[e.key]=t,i.push(t)}),(t.definition.actions||[]).forEach(function(e){var t=o(e);r[e.key]=t}),{actions:r,selectionToolbarItems:i,destroy:function(){i.length=0}}}({sn:e,component:r});return bm(r,{model:t.model,app:t.app,selections:t.selections,actions:i.actions}),bm(n,{actions:i.actions,model:t.model,app:t.app,selections:t.selections}),{generator:e,component:n,selectionToolbar:{items:i.selectionToolbarItems},logicalSize:e.definition.logicalSize||function(){return!1}}}var Am={get:function(e){return"$$$".concat(e,"$$$")}},Cm=function(){};function Tm(e,t){return void 0===e?function(){return t}:function(){return e}}function Pm(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{min:"function"==typeof e.min?e.min:Tm(e.min,0),max:"function"==typeof e.max?e.max:Tm(e.max,1e3),add:e.add||Cm,description:e.description||Cm,move:e.move||Cm,remove:e.remove||Cm,replace:e.replace||Cm}}function Nm(e){return{path:e.path||"/qHyperCubeDef",dimensions:Pm(e.dimensions),measures:Pm(e.measures)}}var Lm=function(e,t){var n,r=cm({translator:Am,Promise:Promise},t),i={qae:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{properties:cm({},e.properties),data:{targets:((e.data||{}).targets||[]).map(Nm)}}}((n="function"==typeof e?e(r):e).qae),component:n.component||{},create:function(e){return Om(i,e)},definition:{}};return Object.keys(n).forEach(function(e){i[e]||(i.definition[e]=n[e])}),i},jm=n(8),Em=n.n(jm),Im=n(5),Rm=n.n(Im),Hm=n(12),Bm=n.n(Hm),zm=function(e,t){if("function"==typeof t.defaultValue)return t.defaultValue();if(void 0!==t.defaultValue)return t.defaultValue;if(Array.isArray(t.options))return t.options[0].value;switch(e){case"array":return[];case"string":return"";case"integer":case"number":return 0;case"boolean":return!1;default:return null}},Fm=10;var _m=function(e){if("custom"===e.dimensionAxis.axisDisplayMode){var t=e.qHyperCubeDef.qMeasures.length,n=e.qHyperCubeDef.qDimensions.length,r=e.dimensionAxis.maxVisibleItems;r<1?e.dimensionAxis.maxVisibleItems=Fm:r>1e4/(n+t)&&(e.dimensionAxis.maxVisibleItems=Math.min(r,Math.floor(1e4/(n+t))))}},Vm=function(e){return{get:function(t,n,r){return zo.continuous(r.layout)?e:t(n.type)},set:function(e,t,n){var r=zm(n.type,n);t(n.type,e,r)}}},Um=function(e){return e&&!zo.continuous(e)&&zo.stacked(e)},Wm=function(e,t){var n={uses:"settings",items:{presentation:{type:"items",translation:"properties.presentation",grouped:!0,items:{grouping:{ref:"barGrouping.grouping",type:"string",component:"item-selection-list",defaultValue:"grouped",horizontal:!0,items:[{icon:"grouped",component:"icon-item",labelPlacement:"bottom",translation:"properties.grouping.grouped",value:"grouped"},{icon:"stacked",component:"icon-item",labelPlacement:"bottom",translation:"properties.grouping.stacked",value:"stacked"}],show:function(e){var t=e.qHyperCubeDef.qMeasures.length,n=e.qHyperCubeDef.qDimensions.length;return n>0&&t+n>2},change:function(e,t){t.getDimensions().length>1&&"stacked"===e.barGrouping.grouping?(e.qHyperCubeDef.qMode="K",e.qHyperCubeDef.qAlwaysFullyExpanded=!0):e.qHyperCubeDef.qMode="S"},readOnly:function(e,t,n){return zo.continuous(n.layout)},convertFunctions:Vm("stacked")},orientation:{ref:"orientation",type:"string",component:"item-selection-list",defaultValue:"vertical",horizontal:!0,items:[{component:"icon-item",icon:"bars_vertical",labelPlacement:"bottom",translation:"properties.orientation.vertical",value:"vertical"},{icon:"bars_horizontal",component:"icon-item",labelPlacement:"bottom",translation:"Common.Horizontal",value:"horizontal"}],readOnly:function(e,t,n){return zo.continuous(n.layout)},convertFunctions:Vm("vertical")},scroll:{type:"items",items:{scrollbar:{type:"string",component:"dropdown",ref:"scrollbar",translation:"properties.scrollbar",options:Object.keys(u.OPTIONS).map(function(e){return u.OPTIONS[e]}),defaultValue:u.DEFAULT.value},scrollStartPos:{ref:"scrollStartPos",type:"number",translation:"properties.ScrollAlignment",component:"dropdown",defaultValue:0,options:[{value:0,translation:"properties.ScrollAlignStart"},{value:1,translation:"properties.ScrollAlignEnd"}],show:function(e,t,n){return!zo.continuous(n.layout)}}}},gridLines:{type:"items",snapshot:{tid:"property-gridLines"},items:{showGridLines:{ref:"gridLine.auto",type:"boolean",translation:"properties.gridLine.spacing",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}]},gridSpacing:{ref:"gridLine.spacing",type:"number",component:"dropdown",defaultValue:2,options:[{value:0,translation:"properties.gridLine.noLines"},{value:1,translation:"properties.gridLine.wide"},{value:2,translation:"properties.gridLine.medium"},{value:3,translation:"properties.gridLine.narrow"}],show:function(e){return e.gridLine&&!e.gridLine.auto}}}},valueLabels:{type:"items",snapshot:{tid:"property-valueLabels"},items:{showLabels:{ref:"dataPoint.showLabels",type:"boolean",translation:"properties.dataPoints.labelmode",component:"switch",defaultValue:!1,options:[{value:!0,label:function(t,n){return function(e,t,n){return n&&n.get(Um(t.layout)?"properties.on":"Common.Auto")}(0,n,e)}},{value:!1,translation:"properties.off"}]},showSegmentLabels:{ref:"dataPoint.showSegmentLabels",type:"boolean",translation:"properties.dataPoints.segmentLabelMode",component:"switch",defaultValue:!1,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],show:function(e,t,n){return e.dataPoint.showLabels&&Um(n.layout)}},showTotalLabels:{ref:"dataPoint.showTotalLabels",type:"boolean",translation:"properties.dataPoints.totalLabelMode",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],show:function(e,t,n){return e.dataPoint.showLabels&&Um(n.layout)}}}}}},colorsAndLegend:{uses:"colorsAndLegend",items:{legend:{items:{show:{snapshot:{tid:"property-legend"}}}}}},dimensionAxis:{uses:"axis.dimensionAxis",items:{axisDisplaySettings:{components:"items",type:"items",show:function(e,n,r){return t&&t.getFlag("BC_XAXIS_MODE")&&!zo.continuous(r.layout)},items:{axisDisplayMode:{ref:"dimensionAxis.axisDisplayMode",type:"string",translation:"properties.axis.displaymode",component:"dropdown",defaultValue:"auto",options:[{value:"auto",translation:"properties.axis.displaymode.auto"},{value:"max",translation:"properties.axis.displaymode.max"},{value:"custom",translation:"properties.axis.displaymode.custom"}]},maxVisibleItems:{ref:"dimensionAxis.maxVisibleItems",translation:"properties.axis.maxvisiblebars",expression:"optional",type:"integer",invalid:function(e){var t=e.qHyperCubeDef.qMeasures.length,n=e.qHyperCubeDef.qDimensions.length,r=e.dimensionAxis.maxVisibleItems;return r<0||r>1e4/(n+t)},globalChange:_m,defaultValue:10,show:function(e){return"custom"===e.dimensionAxis.axisDisplayMode}},hint:{component:"text",translation:"properties.axis.maxvisiblebars.hint",style:"hint",show:function(e){return["custom","max"].indexOf(e.dimensionAxis.axisDisplayMode)>-1}}}},continuousGroup:{items:{miniChart:null}}}},measureAxis:{uses:"axis.flippableMeasureAxis"}}};return t&&t.getFlag("BC_STYLE_EDITOR")&&(n.items.presentation.items.boxStyling={component:"style-editor",translation:"LayerStyleEditor.component.styling",subtitle:"LayerStyleEditor.component.styling",resetBtnTranslation:"LayerStyleEditor.component.resetAll",key:"bar",ref:"components",defaultValues:{key:"bar",style:{width:.7,strokeColor:{index:-1,color:"#205891"},strokeWidth:"none"}},items:{bar:{components:"items",type:"items",uses:"styling.box",items:{strokeWidth:{show:!0,component:"dropdown",type:"string",options:[{value:"none",translation:"LayerStyleEditor.style.strokeWidth.none"},{value:"small",translation:"LayerStyleEditor.style.strokeWidth.small"},{value:"medium",translation:"LayerStyleEditor.style.strokeWidth.medium"},{value:"large",translation:"LayerStyleEditor.style.strokeWidth.large"}],defaultValue:"none"},strokeColor:{show:function(e){return"none"!==e.style.strokeWidth}},width:{show:function(e,t,n){return!zo.continuous(n.layout)},component:"slider",min:.01,max:1,step:.01,defaultValue:.7}}}}}),n},Km={type:"items",translation:"properties.sorting",items:{noContinuousSortingMessage:{component:"text",translation:"properties.sorting.noContinuousSortingMessage",show:function(e,t,n){return zo.continuous(n.layout)}},defaultSorting:{show:function(e,t,n){return!zo.continuous(n.layout)},uses:"sorting",items:{dimensions:{locked:function(e,t,n){return 1===n.getMeasures().length&&2===n.getDimensions().length&&0===e},items:{autoSort:{change:function(e){o(e)}}}}}}}},Gm={type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling",items:{calcCond:{uses:"calcCond"}}},refLines:{uses:"reflines"}}},Ym={uses:"data",items:{dimensions:{items:{nullSuppression:{show:function(e,t,n){var r=function(e,t){return t.properties&&t.properties.qHyperCubeDef.qDimensions[0]===e}(e,t),i=zo.continuous(n.layout);return!(r&&i)}}}}}},Xm=function(e,t){return{type:"items",component:"accordion",items:{data:Ym,sorting:Km,addons:Gm,settings:Wm(e,t)}}},Jm={type:"items",component:"accordion",items:{data:{uses:"data"},sort:{uses:"sort",show:function(e,t){return!zo.continuous(t)},items:{dimensions:{locked:function(e,t){var n=t.qHyperCubeDef.qMeasures.length,r=t.qHyperCubeDef.qDimensions.length;return 1===n&&2===r&&0===e}}}},presentation:{uses:"presentation",items:{showLabels:{ref:"dataPoint.showLabels",type:"boolean",translation:"properties.dataPoints.labelmode",component:"switch",options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}]},grouping:{ref:"barGrouping.grouping",type:"string",component:"item-selection-list",horizontal:!0,items:[{icon:"grouped",component:"icon-item",labelPlacement:"bottom",translation:"properties.grouping.grouped",value:"grouped"},{icon:"stacked",component:"icon-item",labelPlacement:"bottom",translation:"properties.grouping.stacked",value:"stacked"}],show:function(e,t){return e.qHyperCubeDef.qMeasures.length+e.qHyperCubeDef.qDimensions.length>2&&!zo.continuous(t)},change:function(e){e.qHyperCubeDef.qDimensions.length>1&&"stacked"===e.barGrouping.grouping?(e.qHyperCubeDef.qMode="K",e.qHyperCubeDef.qAlwaysFullyExpanded=!0):e.qHyperCubeDef.qMode="S"}},orientation:{ref:"orientation",type:"string",component:"item-selection-list",horizontal:!0,items:[{component:"icon-item",icon:"bars_vertical",labelPlacement:"bottom",translation:"properties.orientation.vertical",value:"vertical"},{icon:"bars_horizontal",component:"icon-item",labelPlacement:"bottom",translation:"Common.Horizontal",value:"horizontal"}],show:function(e,t){return!zo.continuous(t)}}}},color:{uses:"color"}}},Zm=function(e){if(e.qHyperCubeDef.qDimensions.length>1&&1===e.qHyperCubeDef.qMeasures.length){var t=e.qHyperCubeDef.qInterColumnSortOrder.indexOf(0);0!==t&&b.moveArrayElement(e.qHyperCubeDef.qInterColumnSortOrder,t,0)}},$m=function(e,t){t>10?1!==e.qHyperCubeDef.qInterColumnSortOrder[0]&&b.moveArrayElement(e.qHyperCubeDef.qInterColumnSortOrder,1,0):0!==e.qHyperCubeDef.qInterColumnSortOrder[0]&&b.moveArrayElement(e.qHyperCubeDef.qInterColumnSortOrder,1,0)},Qm=function(e,t,n){var r=e.qHyperCubeDef.qDimensions,i=e.qHyperCubeDef.qMeasures;if(1===r.length&&1===i.length){var o=r[0];return o.qLibraryId?t.getDimension(o.qLibraryId).then(function(e){return e.getLayout()}).then(function(t){if(t&&t.qDimInfos&&t.qDimInfos[0]){var n=t.qDimInfos[0].qCardinal;$m(e,n)}return o}):t.getField(o.qDef.qFieldDefs[0]).then(function(t){return t.getCardinal().then(function(t){return $m(e,t),o})},function(){return o})}return Zm(e),n.resolve()};function eh(e){var t=e.qHyperCubeDef.qDimensions,n=e.qHyperCubeDef.qMeasures,r=e.color.mode;t.length>1&&e.color?b.setValue(e,"color.persistent",!0):"byDimension"===r&&n.length>1?b.setValue(e,"color.mode","byMultiple"):"byExpression"===r&&0===n.length?b.setValue(e,"color.mode","primary"):0===t.length&&n.length>0&&(b.setValue(e,"color.byMeasureDef",void 0),b.setValue(e,"color.byDimDef",void 0),1===n.length&&b.setValue(e,"color.mode","primary"))}var th=function(e){var t=e.translator,n=e.Promise;return{dimensions:{description:function(e,n,r){var i,o=e.qHyperCubeDef.qDimensions.length;return r.isAutoChart&&n>o-1?i="Visualizations.Descriptions.Color":o>1&&0===n?"stacked"===e.barGrouping.grouping?i="Visualizations.Descriptions.Stack":(i="Visualizations.Descriptions.Group",e.qHyperCubeDef.qColumnOrder=[0,1,2]):i="Visualizations.Descriptions.Bar",t.get(i)},add:function(e,t,r){return t.qHyperCubeDef.qDimensions.length>1&&"stacked"===t.barGrouping.grouping&&(t.qHyperCubeDef.qMode="K",t.qHyperCubeDef.qAlwaysFullyExpanded=!0),Qm(t,r.app,n).then(function(){return eh(t),o(e),e})},move:function(e,t){t.qHyperCubeDef.qDimensions.length>1&&"stacked"===t.barGrouping.grouping&&(t.qHyperCubeDef.qMode="K",t.qHyperCubeDef.qAlwaysFullyExpanded=!0),Zm(t),eh(t)},remove:function(e,t){var n=t.qHyperCubeDef.qDimensions;eh(t),1===n.length&&(t.qHyperCubeDef.qMode="S")}},measures:{description:function(e){var n="vertical"===e.orientation?"Visualizations.Descriptions.Height":"Visualizations.Descriptions.Width";return t.get(n)},add:function(e,t,r){return Qm(t,r.app,n).then(function(){return e.qSortBy.qSortByNumeric=-1,eh(t),e})},move:function(e,t){Zm(t),eh(t)},remove:function(e,t){var n=t.qHyperCubeDef.qDimensions;eh(t),n.length>1&&"stacked"===t.barGrouping.grouping?(t.qHyperCubeDef.qMode="K",t.qHyperCubeDef.qAlwaysFullyExpanded=!0):1===n.length&&(t.qHyperCubeDef.qMode="S")}}}};var nh={getDataPoints:function(e,t){var n=[],r=e;return zo.groupedByMeasure(t)&&(r=r.slice().sort(function(e,t){return e.value-t.value})),r.forEach(function(e,r){var i,o,a;if(zo.groupedByMeasure(t)){var u=e.measureIndex,s=e.end.source;a=n.find(function(e){return e.index===u.value}),i=b.getValue(t,"".concat(s.key,"/").concat(s.field,".qFallbackTitle").replace(/\//g,"."),""),o=u.value}else if(zo.groupedByDimension(t))a=n.find(function(t){return t.index===e.value}),i=e.label,o=e.value;else{var l=e.label,c=e.source;i=zo.dimensionless(t)?b.getValue(t,"".concat(c.key,"/").concat(c.field,".qFallbackTitle").replace(/\//g,"."),""):l}a?t.effectProperties.selectedIndex===r&&(a.value=r):n.push({text:function(e){var t=e;return t&&t.length>35&&(t="".concat(t.substr(0,32),"...")),t||""}(i),value:r,index:o})}),n},getVisibleItems:function(e,t){var n=e.component("bar"),r=n.data.items;if(zo.continuous(t))return r;var i=e.scale(n.settings.settings.major.scale),o=n.settings.settings.major.fn;return r.filter(function(e){var t=o?o({scale:i,datum:e})-i.bandwidth()/2:i(e.value);return-t<i.bandwidth()&&t<1})},getGroupedItems:function(e,t){var n=[];return e.forEach(function(r){var i;zo.groupedByMeasure(t)&&n.every(function(e){return e[0].value!==r.value})?(i=e.filter(function(e){return e.value===r.value})).length===t.qHyperCube.qMeasureInfo.length&&n.push(i):zo.groupedByDimension(t)&&n.every(function(e){return e[0].group.value!==r.group.value})?(i=e.filter(function(e){return e.group.value===r.group.value}),n.push(i)):zo.groupedByMeasure(t)||zo.groupedByDimension(t)||n.push(r)}),n},getShapeIndex:function(e,t,n){var r=this.getVisibleItems(t,n);return zo.groupedByMeasure(n)&&(r=r.slice().sort(function(e,t){return e.value-t.value})),r.map(function(e){return e.id.value}).indexOf(e.data.id.value)}};function rh(e){return e.reduce(function(e,t){return t&&t.end.value<e.end.value?t:e},{end:{value:1/0}})}function ih(e){return e.reduce(function(e,t){return t&&t.end.value>e.end.value?t:e},{end:{value:-1/0}})}function oh(e,t){var n,r=[];return e.forEach(function(e){(n=t(e))&&r.push(n.id)}),r}var ah={applyHighlight:function(e,t){t.length&&e.brush("highlight").setValues(t.map(function(e){return{key:"".concat(e.source.key,"/").concat(e.source.field),value:e.value}}))},highlightSelectedIndex:function(e,t,n){var r=t.effectProperties.selectedIndex,i=nh.getGroupedItems(n,t),o=[],a=r>-1&&r<n.length;if(Array.isArray(i[0])&&a){if(zo.groupedByMeasure(t)){var u=n.slice().sort(function(e,t){return e.value-t.value})[r].measureIndex.value;o=oh(i,function(e){return e.find(function(e){return e.measureIndex.value===u})})}else if(zo.groupedByDimension(t)){var s=n[r].value;o=oh(i,function(e){return e.find(function(e){return e.value===s})})}}else a&&o.push(n[r].id);this.applyHighlight(e,o)},highlightMaxMin:function(e,t,n){var r=nh.getGroupedItems(n,t),i=[],o=t.effectProperties.max;Array.isArray(r[0])?i=oh(r,o?ih:rh):i.push((o?ih:rh)(n).id),this.applyHighlight(e,i)}};function uh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var sh=function(){function e(t){var n=t.element,r=t.properties,i=t.effectHelper,o=t.Promise;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.element=n,this.Promise=o,i.initFade(this.element);var a=n.find(".effectLayer");a.length>0&&a.remove(),n.append('<div class="effectLayer"></div>'),this.effectLayer=n.find(".effectLayer"),this._effectProperties=r,this.selectedIndex=r.selectedIndex,this.hasPropertiesPanel=!1,this.effectApplied=!0,i.fadeIn(this.element)}var t,n,r;return t=e,(n=[{key:"init",value:function(e,t,n,r){var i=this;return e.options=g()(!0,e.options,{effect:this}),t.layout.effectProperties&&t.layout.effectPath===n&&JSON.stringify(t.layout.effectProperties)===JSON.stringify(r)?this.Promise.resolve():t.getProperties().then(function(e){if(!e.originalModelSettings){var o=g()(!0,{},e);e.originalModelSettings=i.updateOrigSettings(o)}return e.effectProperties=r,e.effectPath=n,e.measureAxis.show="none",e.dimensionAxis.show="labels",e.gridLine.auto=!1,e.gridLine.spacing=0,e.legend.show=!1,e.dataPoint.showLabels=!1,e.refLine.refLines.forEach(function(e){e.show=!1}),t.setProperties(e)})}},{key:"getComponentDefs",value:function(e){return this.layout=e,[{key:"bar",brush:{consume:[{context:"highlight",data:["id"],mode:"and",style:{inactive:{fill:"#BFDAD9"},active:{fill:"#68B2AF"}}}]}},{type:"flag",key:"flag",effectInstance:this,extendsComponentWithKey:"bar"}]}},{key:"updated",value:function(e){this.chart=e;var t="".concat(window.innerWidth/110||12,"px");this.effectLayer[0].style.fontSize=t}},{key:"updateOrigSettings",value:function(e){return{measureAxis:e.measureAxis,dimensionAxis:e.dimensionAxis,gridLine:e.gridLine,legend:e.legend,dataPoint:e.dataPoint,refLine:e.refLine}}},{key:"remove",value:function(e,t,n){return e.options=g()(e.options,{effect:null}),n?t.getProperties().then(function(e){return g()(e,{effectProperties:null,effectPath:null,measureAxis:g()(!0,{},e.originalModelSettings.measureAxis),dimensionAxis:g()(!0,{},e.originalModelSettings.dimensionAxis),gridLine:g()(!0,{},e.originalModelSettings.gridLine),legend:g()(!0,{},e.originalModelSettings.legend),dataPoint:g()(!0,{},e.originalModelSettings.dataPoint),refLine:g()(!0,{},e.originalModelSettings.refLine)})}):this.Promise.resolve()}}])&&uh(t.prototype,n),r&&uh(t,r),e}();function lh(e){return(lh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ch(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fh(e,t){return!t||"object"!==lh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dh(e,t,n){return(dh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mh(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function mh(e){return(mh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hh(e,t){return(hh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ph=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=fh(this,mh(t).call(this,e))).hasPropertiesPanel=!0,n.propsTemplate=e.highlightValuePropsTemplate,n.effectHelper=e.effectHelper,n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hh(e,t)}(t,sh),n=t,(r=[{key:"updated",value:function(e){dh(mh(t.prototype),"updated",this).call(this,e);var n=nh.getVisibleItems(e,this.layout);n.length&&(ah.highlightSelectedIndex(e,this.layout,n),this.dataPoints=nh.getDataPoints(n,this.layout))}},{key:"onClick",value:function(e){if(this.chart){var t,n,r,i=this.chart.shapesAt((t=e,n=this.chart,r=n.element.getBoundingClientRect(),{x:t.clientX-r.left,y:t.clientY-r.top}),{propagation:"stop"});if(1===i.length){var o=i[0],a=nh.getShapeIndex(o,this.chart,this.layout);-1!==a&&(this.selectedIndex=a,this.effectHelper.updateSelectedPointIndex(this))}}}}])&&ch(n.prototype,r),i&&ch(n,i),t}();function gh(e){return(gh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vh(e,t){return!t||"object"!==gh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bh(e,t,n){return(bh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Mh(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Mh(e){return(Mh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xh(e,t){return(xh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wh=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),vh(this,Mh(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xh(e,t)}(t,sh),n=t,(r=[{key:"updated",value:function(e){bh(Mh(t.prototype),"updated",this).call(this,e);var n=nh.getVisibleItems(e,this.layout);n.length&&ah.highlightMaxMin(e,this.layout,n)}}])&&yh(n.prototype,r),i&&yh(n,i),t}(),qh={isCompatible:function(e){var t=e.layout,n=e.effectPath;return("/effects/maxmin"===n||"/effects/highlight-value"===n)&&!zo.stacked(t)},create:function(e){return"/effects/maxmin"===e.effectPath?new wh(e):"/effects/highlight-value"===e.effectPath?new ph(e):null}};var Sh={generateFlags:function(e,t,n,r){var i=function(e,t,n){return e.map(function(e){var r=e.data.end.label,i=function(e,t,n){var r=e.bounds,i=e.data.end.value,o=e.boundsRelativeTo(n[0]);return"horizontal"===t?{x:i>0?o.x+r.width:o.x,y:o.y+r.height/2}:{x:o.x+r.width/2,y:i>0?o.y:o.y+r.height}}(e,t,n);return{position:i,label:r,orientation:function(e,t,n){var r=e.data.end.value,i=e.element;return"horizontal"===n?r>0?"horizontalright":"horizontalleft":(r>=0?"top":"bottom")+(t.x>i.width/2?"left":"right")}(e,i,t)}})}(t,n,r),o=[];return i.forEach(function(t){var n,r,i,a=e("div",{class:"qv-flag-label"},t.label),u=e("div",{class:"qv-flag-content"},a),s=e("div",{class:"qv-flag-post"});o.push(e("div",{style:(i=t.position,{position:"absolute",top:"".concat(i.y,"px"),left:"".concat(i.x,"px")}),class:"qv-story-effect-flag ".concat((n=t.orientation,r=[],/top/.exec(n)&&r.push("v-top"),/bottom/.exec(n)&&r.push("v-bottom"),/horizontal/.exec(n)&&r.push("v-center"),/left/.exec(n)&&r.push("h-left"),/right/.exec(n)&&r.push("h-right"),(r=r.map(function(e){return"qv-flag-".concat(e)})).join(" ")))},u,s))}),o}},kh={require:["chart","renderer"],renderer:"dom",render:function(e){return this.h=e,[]},appendTo:function(){var e=this.settings.effectInstance.effectLayer,t=e[0].getBoundingClientRect(),n={width:t.width,height:t.height,scaleRatio:this.renderer.size().scaleRatio};this.renderer.destroy(),this.renderer.size(n),this.renderer.appendTo(e[0])},updated:function(){var e=this.settings.effectInstance,t=e.layout,n=e.effectLayer;if(t.effectProperties){e.updated(this.chart),this.appendTo();var r=this.chart.getAffectedShapes("highlight").filter(function(e){return"rect"===e.type});this.renderer.render(Sh.generateFlags(this.h,r,t.orientation,n))}}};var Dh=function(e){var t={},n=b.getValue(e,"components"),r=b.getValue(e,"dimensionAxis.axisDisplayMode"),i=b.getValue(e,"dimensionAxis.maxVisibleItems"),o=n?n.filter(function(e){return"bar"===e.key})[0].style:void 0,a=r||i?{axisDisplayMode:r,maxVisibleItems:i}:void 0;return o&&(t.style=o),a&&(t.dimensionAxis=a),t};n.d(t,"default",function(){return Ah});var Oh=function(e){return!!(e&&e.qHyperCube.qSize.qcy>0)};function Ah(e){var t=Bm.a.getService("$q"),n=e.flags,r=e.theme,i=Lm(am,{translator:Em.a,Promise:t,qvangular:Bm.a,flags:n});return{initialProperties:i.qae.properties,definition:Xm(Em.a,n),softDefinition:Jm,data:g()(!0,{},i.qae.data.targets[0],th({translator:Em.a,Promise:t})),support:{snapshot:Oh,export:Oh,exportData:!0,sharing:Oh,viewData:!0,effects:!0},effects:qh,extendMetrics:Dh,mounted:function(e){var t=d(this.$scope);this.chart=i.create({model:this.backendApi.model,app:this.backendApi.model.app,selections:t}).component,this.chart.created({options:{renderer:this.options.renderer}}),this.chart.mounted(e[0]),this.chart.actions.lasso.on("changed",function(){t.refreshToolbar()})},updateData:function(){return this.doPaint=!0,t.resolve()},resize:function(e,t){this.doPaint?this.paint(e,t):this.chart.resize({layout:t,context:{permissions:h(this.options,this.backendApi),logicalSize:!(!t.snapshotData||this.options.freeResize)&&{width:t.snapshotData.content.size.w,height:t.snapshotData.content.size.h}},opts:{effect:this.options.effect}})},paint:function(e,t){var n=this;return this.doPaint=!1,r.getApplied().then(function(e){var r,i;return n.options.effect&&(i=[{type:"flag",component:kh}],r=n.options.effect.getComponentDefs(t,kh)),n.chart.render({layout:t,context:{rtl:"rtl"===n.options.direction,localeInfo:n.backendApi.localeInfo,theme:e,permissions:h(n.options,n.backendApi),logicalSize:t.snapshotData&&!n.options.freeResize?{width:t.snapshotData.content.size.w,height:t.snapshotData.content.size.h}:void 0},opts:{viewStateOptions:n.options.viewState,registerComponents:i,components:r}})})},setSnapshotData:function(e){return this.chart.setSnapshotData(e)},getViewState:function(){return this.chart.getViewState()},getSelectionToolbar:function(){var e=this.chart.actions.lasso;return[{name:"Tooltip.ToggleOnLassoSelection",tid:"selection-toolbar.toggleLasso",isIcon:!0,buttonClass:"sel-toolbar-icon-toggle",iconClass:"lui-icon lui-icon--lasso",action:function(){e.action()},isActive:function(){return this.name=e.active()?"Tooltip.ToggleOffLassoSelection":"Tooltip.ToggleOnLassoSelection",e.active()},isDisabled:function(){return!e.enabled()}},{name:"Tooltip.clearSelection",tid:"selection-toolbar.clear",isIcon:!0,buttonClass:"clear",iconClass:"lui-icon lui-icon--clear-selections",action:function(){this.selectionsApi.clear()},isDisabled:function(){return!this.selectionsApi.selectionsMade}}]},destroy:function(){this.chart&&(this.chart.willUnmount(),this.chart.destroy())},migrate:{properties:function(e){return e.qExtendsId||(function(e){e.qHyperCubeDef.qDimensions.forEach(o)}(e),function(e){e.scrollbar||!1!==e.showMiniChartForContinuousAxis||(e.scrollbar=u.OPTIONS.NONE.value)}(e)),e}},importProperties:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=(e=Rm.a.axisChart.importProperties).call.apply(e,[Rm.a].concat(n)),o=i.qProperty;return o.qHyperCubeDef.qDimensions.length>1&&"stacked"===o.barGrouping.grouping&&(o.qHyperCubeDef.qMode="K"),i},exportProperties:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=Rm.a.axisChart.exportProperties).call.apply(e,[Rm.a].concat(n))}}}}])})}}]);