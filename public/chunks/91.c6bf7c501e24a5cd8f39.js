/*!
 * sense-client@6.105.4
 * 
 * Copyright(C) 2019 Qlik International AB
 * All Rights Reserved
 * 
 */
(window["qJsonp"]=window["qJsonp"]||[]).push([[91,15,18],{1003:function(e,t,n){"use strict";var i,o;function r(e){r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return r(e)}!(i=[n(48),n(91),n(109),n(208),n(160),n(1264),n(110)],o=function(e,t,n,i,o,a,s){var l=new n(255,255,255,1);function u(e,t,n,i){if(!Array.isArray(e))return false;if(!i)return true;return e.length===t.length+n.length}function c(e){var t=a.getColumnOrder(e),n=e.qDimensionInfo||[],i=e.qMeasureInfo||[];if(u(t,n,i,false))return t;return d(n,i)}function d(e,t){var n,i=[],o=e.length,r=t.length;for(n=0;n<o;++n)i.push(n);for(n=0;n<r;++n)i.push(o+n);return i}function p(e){var t=e.qDimensionInfo,n=e.qMeasureInfo,i=t.concat(n),o=c(e),r=[],a,s;for(a=0;a<o.length;++a){s=o[a];ie(i[s])||r.push(s)}return r}function f(e,t){var n=[],i,o,r,a;o=e.rows.length;for(i=0;i<o;++i){a=e.rows[i];r=a.cells.length;t<r&&t>=0&&n.push(a.cells[t])}return n}function h(e,t,n,i){var o=g(e,t,n),r=o.length,a,s=[],l;for(l=0;l<r;++l){a=o[l];a.dataValue===i&&s.push(a)}return s}function g(e,t,n){var i,o,r,a=e.getRowsByCellType(t),s=a.length,l=null,u=[],c;for(i=0;i<s;++i){r=a[i];c=r.cells.length;for(o=0;o<c;++o){l=r.cells[o];l.type===t&&l.dataColIx===n&&u.push(l)}}return u}function m(e,t,n){var i,o,r,a,s=e.getRowsByCellType(t),l=s.length,u,c=[];for(i=0;i<l;++i){r=s[i];u=r.cells.length;for(o=0;o<u;++o){a=r.cells[o];a.type===t&&a.dataRowIx===n&&c.push(a)}}return c}function v(e,t,n,i){var o,r,a,s=e.getRowsByCellType(t),l=s.length,u=null,c;for(o=0;o<l;++o){a=s[o];c=a.cells.length;for(r=0;r<c;++r){u=a.cells[r];if(u.dataColIx===n&&u.dataRowIx===i)return u}}return null}function b(e,t,n){var i=n.isIndentMode?1:e.leftTreeDepth;return e.getHeaderCell(e.topTreeDepth,t+i)}function x(e,t){if(t.type===e.CELL_TYPE_LEFT||t.type===e.CELL_TYPE_DATA)return g(e,t.type,t.dataColIx);return m(e,t.type,t.dataRowIx)}function y(e,t,n){var i=x(e,t),o=i.length,r=[],a,s;for(s=0;s<o;++s){a=i[s];a.dataValue===n&&r.push(a)}return r}function C(e,t){var n=p(t),i=n[e]||0,o=t.qDimensionInfo.concat(t.qMeasureInfo),r=o[i],a=o.filter(oe);return{colInfo:r,dataColIx:i,effectiveDataColIx:a.indexOf(r)}}function q(e){return e.qDimensionInfo.filter(oe).length}function D(e,t){var n=t.qGrandTotalRow[e-q(t)];n&&n.qText||(n={qText:""});return n}function w(e){if(!e)return;return"qDimensionType"in e}function I(e){return void 0===e.textAlign||e.textAlign.auto}function S(e){return e.textAlign&&e.textAlign.align}function L(e){var t=e&&e.representation;if(!t)return{};if("object"!==r(t))return{type:t};return t}function E(e){return[{qText:e.qFallbackTitle,qSubNodes:[],qType:"P",qUp:0,qDown:0,qElemNo:0,qValue:"NaN"}]}function M(e,t,n,i,o,r,a,s,l){var u,c,d,p,f,h,g,m,v;for(u=0;u<r.length;++u){c=r[u];v=k(c)||!!l;m=s.getDimInfo(s.leftDimCnt,i);d=o.getHeaderRow(e);p=d.getNextCell();p.type=o.CELL_TYPE_TOP;p.locked=!V(c)&&m.qLocked;p.isDimensionValue=!V(c)&&!A(c)&&!v&&!T(c);f=c.qText;if(A(c)){h=s.leftCellCnt+t;h>=s.pseudoDimIndex&&h--;f=s.layout.qHyperCube.qDimensionInfo[h].othersLabel}p.setTopHeader(f,c.qElemNo,1,1,t,a+n,P(c),v);if(v||c.qCanCollapse||c.qCanExpand){p.addClass("bold");p.setCollapseExpandClass(c);d.addClass("bold")}if(c.qSubNodes.length){g=M(e+1,t+1,n,i+1,o,c.qSubNodes,a,s,v);p.colspan=g-n;n=g}else n++}return n}function _(e,t,n,i){if(i.dataColumnsInfo.cnt<=0)return;M(1,0,0,0,e,t,n,i);var o=e.topTreeDepth+1;if(!i.isIndentMode&&0===e.topTreeDepth){o=2;e.headerRows[0].addClass("last-top-row")}e.setNextHeaderIx(o);e.headerRows[o-1].addClass("last-top-row")}function A(e){return-3===e.qElemNo}function P(e){return-2===e.qElemNo}function k(e){return-1===e.qElemNo}function T(e){return-4===e.qElemNo}function O(e){return k(e)||T(e)}function V(e){return"P"===e.qType}function H(e){return e.qCanCollapse||e.qCanExpand||e.qSubNodes.length&&!V(e.qSubNodes[0])}function R(e,t){return 0===e&&(k(t)||V(t))||!O(t)&&!V(t)}function $(e,t,n,i,o,r,a,s){var l,u=0,c=o.getRow(e),d=a.getDimInfo(n),p=!V(i)&&!A(i)&&!k(i)&&!P(i),f=!!d&&d.qLocked,h=k(i);if(n>0){l=c.addEmptyHeaderCell(r+e,t,1,n,"left",P(i));l.type=o.CELL_TYPE_LEFT;l.isDimensionValue=p;l.locked=f;l.dataValue=i.qElemNo}if(i.qCanCollapse||i.qCanExpand){l=c.addLeftCollapseExpandCell(r+e,t,i,P(i),h);l.type=o.CELL_TYPE_LEFT;l.isDimensionValue=p;l.locked=f;l.dataValue=i.qElemNo;u=-1}l=c.getNextCell();l.type=o.CELL_TYPE_LEFT;l.isDimensionValue=p;l.locked=f;s=s||i.qText;A(i)&&(s=d.othersLabel);l.setLeftHeader(s,i.qElemNo,1,a.leftCellCnt-n+u,r+e,t,P(i),h);if(h||H(i)){l.addClass("bold");c.addClass("bold")}return l}function F(e,t,n,i,o,r,a,s,l,u,c){var d,p,f,h;for(d=0;d<o.length;++d){p=o[d];if(R(t,p)){r=p;a=t;s=n}t>0&&V(p)&&(l=p);if(p.qSubNodes.length){h=n+(t>0&&V(p)?0:1);e=F(e,t+1,h,i,p.qSubNodes,r,a,s,l,u,c)}else{f=r.qText;if(l){f+=P(r)?" ":" - "+l.qText;l=null}$(e,a,s,r,i,u,c,f);++e}}return e}function N(e,t,n,i,o,r,a){var s,l,u,c,d,p,f,h=0,g,m,v,b;for(s=0;s<i.length;++s){l=i[s];b=k(l)||!!a;g=r.getDimInfo(t);m=!V(l)&&!A(l)&&!b;v=!!g&&g.qLocked;u=n.getRow(e);if(T(l)){c=u.getNextCell();c.type=n.CELL_TYPE_LEFT;c.dataValue=l.qElemNo;c.isDimensionValue=m;c.locked=v;c.setLeftHeader("",-4,1,2)}else{c=u.getNextCell();c.type=n.CELL_TYPE_LEFT;c.isDimensionValue=m;c.locked=v;if(l.qCanCollapse||l.qCanExpand){d=c;d.setLeftHeader("",l.qElemNo,1,1,o+e,t,P(l),b);d.setCollapseExpandClass(l);c=u.getNextCell();c.type=n.CELL_TYPE_LEFT;c.isDimensionValue=m;c.locked=v;h=1}f=l.qText;A(l)&&(f=g.othersLabel);c.setLeftHeader(f,l.qElemNo,1,2-h,o+e,t,P(l),b);if(b){c.addClass("bold");u.addClass("bold")}}if(l.qSubNodes.length){p=N(e,t+1,n,l.qSubNodes,o,r,b);c.rowspan=p-e;d&&(d.rowspan=c.rowspan);e=p}else{var x=r.leftCellCnt-2*(t+1);if(x>0){c=u.getNextCell();c.type=n.CELL_TYPE_LEFT;c.dataValue=l.qElemNo;c.isDimensionValue=m;c.locked=v;c.setLeftHeader("",-4,1,x)}++e}}return e}function z(e,t,n,i){i.isIndentMode?F(0,0,0,e,t,null,-1,-1,null,n,i):N(0,0,e,t,n,i)}function B(e,t){var i,o;e.style.backgroundColor="";e.color.bgByExpression=false;e.color.bgIsDark=false;if("U"!==t.qType&&t.qAttrExps&&t.qAttrExps.qValues&&t.qAttrExps.qValues.length){e.color.bgByExpression=true;o="NaN"!==t.qAttrExps.qValues[0].qNum?t.qAttrExps.qValues[0].qNum:t.qAttrExps.qValues[0].qText;i=new n(o,"argb");if(!i.isInvalid()){1!==i.getAlpha()&&(i=n.getBlend(l,new n(i._r,i._g,i._b,1),i.getAlpha()));e.style.backgroundColor=i.toHex();e.color.bgIsDark=i.isDark()&&i.getAlpha()>.5;e.addClass(e.color.bgIsDark?"color-light":"color-dark")}}e.style.color="";if(t.qAttrExps&&t.qAttrExps.qValues&&t.qAttrExps.qValues.length>1){o="NaN"!==t.qAttrExps.qValues[1].qNum?t.qAttrExps.qValues[1].qNum:t.qAttrExps.qValues[1].qText;i=new n(o,"argb");i.isInvalid()||(e.style.color=i.toRGBA())}}function W(e,t,n,i,o){var r,a,s,l,u,c,d;for(r=0,s=t.length;r<s;++r){c=e.getNextRow();0===e.leftTreeDepth&&c.addEmptyHeaderCell(n+r,i,1,1);l=Math.min(o.dataColumnsInfo.cnt,t[r].length);0===l&&0===r&&c.cells[0].addClass("first-data-cell");for(a=0;a<l;++a){d=c.getNextCell();d.type=e.CELL_TYPE_DATA;u=t[r][a];d.setData(u.qText,1,1,n+r,i+a);d.addClass("data");0===r&&0===a&&d.addClass("first-data-cell");"U"===u.qType&&d.setNullClass(true);Number.isNaN(+u.qNum)||d.addClass("numeric");(c.hasClass("bold")||b(e,a,o).isTotal)&&d.addClass("bold");B(d,u)}}}function G(e,t,n,i,o,r,a,s){var l,u,c,d,p,f;for(l=0;l<a;++l){c=t.getRow(n+l);p=r&&r[l]?r[l].length:1;for(u=0;u<p;++u){d=c.getCell(i+u);d.rowspan=1;d.colspan=1;d.style.backgroundColor="";d.style.color="";d.color.bgByExpression=false;d.color.bgIsDark=false;d.isFillColumn=false;f=r&&r[l]&&r[l][u];if(f)Y(t,d,f,e,o,l,u,s);else{d.setDefaults();d.isFillColumn=true}}c.setNextCellIx(i+u)}t.setNextRowIx(n+l)}function j(e,t,i,r){var a=o.getIndexById(t.qAttrExprInfo,i);if(-1!==a){var s="NaN"!==e.qAttrExps.qValues[a].qNum?e.qAttrExps.qValues[a].qNum:e.qAttrExps.qValues[a].qText,u=new n(s,"argb");if(r&&1!==u.getAlpha())return n.getBlend(l,new n(u._r,u._g,u._b,1),u.getAlpha());return u}return false}function U(e){return e&&e.length>2048?e.substring(0,2048)+"â€¦":e}function Y(e,t,n,r,a,s,l,u){l=a?a.qLeft+l:null;var c=C(l,r.qHyperCube),d=c.colInfo,p=c.dataColIx,f=c.effectiveDataColIx,h,g,m,v=L(d);t.colspan=w(d)?2:1;t.type=e.CELL_TYPE_DATA;t.isOtherCell=n.qIsOtherCell;t.isTotalCell=n.qIsTotalCell;t.representation=t.REPRESENTATION_TEXT;t.isNumeric=!Number.isNaN(+n.qNum);if("url"===v.type){var b=o.getIndexById(d.qAttrExprInfo,o.IDMAP.CELL_URL_LABEL),x;if(b>-1&&n.qAttrExps.qValues){x=n.qAttrExps.qValues;m="NaN"!==x[b].qNum||x[b].qText?x[b].qText||x[b].qNum:" "}else m=""===v.urlLabel?n.qText:v.urlLabel;if(n.qText&&!n.qIsNull)try{t.url=i.encodeForHref(n.qText);t.representation=t.REPRESENTATION_URL}catch(e){t.url=""}}else m=n.qText;var y=U(m);t.setText(y);t.setTextAlign(I(d),S(d));if(t.isOtherCell){t.setText(d.othersLabel);t.setTextAlign(I(d),S(d))}t.locked=d.qLocked;t.dataValue=n.qElemNumber;t.dataColIx=p;t.effectiveDataColIx=f;t.dataRowIx=u?a.qTop+a.qHeight-s-1:a.qTop+s;t.isNumeric=!Number.isNaN(+n.qNum);t.isNullValue=t.isDimensionValue?-2===t.dataValue:n.qIsNull;t.isDimensionValue=!t.isNullValue&&w(d);t.selected=false;t.selectedHighlighted=false;if(!t.isNullValue){h=j(n,d,o.IDMAP.CELL_BACKGROUND_COLOR,true);if(h&&!h.isInvalid()){t.color.bgByExpression=true;t.style.backgroundColor=h.toHex();t.color.bgIsDark=h.isDark()&&h.getAlpha()>.5;if(1===e.headerRows.length){g=e.getHeaderRow(0).cells.filter(function(e){return e.dataColIx===t.dataColIx})[0];g.color.bgIsDark=h.isDark()}}}h=j(n,d,o.IDMAP.CELL_FOREGROUND_COLOR);h&&!h.isInvalid()&&(t.style.color=h.toRGBA())}function K(e,t){var n,i,o,r;n=e.getHeaderRow(0);i=e.getHeaderRow(e.topTreeDepth);var a=0===e.topTreeDepth&&!t.isIndentMode;a&&(i=e.getHeaderRow(1));if(t.dataColumnsInfo.cnt>0&&t.leftCellCnt>0){o=n.addEmptyMetaCell(e.topTreeDepth,t.leftCellCnt,"left-meta");o.templateSrc="pt-meta-left.ng.html";o.addClass("meta");n===i&&o.addClass("bottom-meta")}if(t.dataColumnsInfo.cnt>0){var s=a?2:1;r=n.addEmptyMetaCell(s,t.dataColumnsInfo.cnt);r.addClass("top-meta").addClass("meta");r.templateSrc="pt-meta-top.ng.html"}if(i!==n)for(var l=0;l<t.leftColumns.length;l++){o=i.addEmptyMetaCell(1,t.leftColumns[l].length,"left-meta");o.addClass("bottom-meta");o.text="Â "}}function X(e,t){return t.length?X(e+1,t[0].qSubNodes):e}function J(e,n){var i,o,r,a,s,l,u=e.headerRows[0].getCellSize();function c(){return n.qHyperCube.qMeasureInfo.length>0&&n.qHyperCube.qGrandTotalRow.length>0}function d(){return 0===n.qHyperCube.qDimensionInfo.length}function p(){return n.totals&&true===n.totals.show}function f(){if(p()&&d())return false;return c()&&n.totals&&(n.totals.show||"noTotals"!==n.totals.position)}function h(){return!(f()&&n.totals&&!n.totals.show&&"bottom"===n.totals.position)}if(f()&&h())o=e.getNextHeaderRow();else{if(!f())return;o=e.getNextFooterRow()}for(i=0;i<u;++i){s=e.getHeaderCell(0,i);if(s.isSearchIcon)continue;a=o.getNextCell();a.type=e.CELL_TYPE_TOP;a.tid=s.isSearchIcon?"st.total.search":"st.total";a.style={};a.colspan=s.isDimension?2:1;a.isDimension=!h()&&s.isDimension;a.isMeasure=s.isMeasure;a.isFillColumn=s.isFillColumn;a.dataColIx=s.dataColIx;if(s.isMeasure){r=D(s.effectiveDataColIx,n.qHyperCube);l=r.qText;a.isNumeric=true}else{l=0===i?void 0!==n.totals.label?n.totals.label:t.get("Object.Table.Totals"):"Â ";a.isNumeric=false}a.setText(l);s.info&&a.setTextAlign(I(s.info),S(s.info));a.isTotal=true}}function Z(e,t){var n,i=t.length,o,r;o=e.getNextHeaderRow();for(n=0;n<i;++n){r=o.getNextCell();r.type=e.CELL_TYPE_TOP;r.setFromMetaHeader(t[n])}}function Q(e,t,n){e.tid="st.header";e.qvaOutsideIgnoreFor="";e.isSearchIcon=false;e.open=false;e.canCollapse=false;e.canExpand=false;e.rowspan=1;e.colspan=1;e.color={};if(t){e.isFillColumn=true;e.text="";e.sortable=false;e.isDimension=false;e.isSorted=false;e.reversed=false;e.style={width:"auto"}}else{e.isNumeric="N"===e.info.qDimensionType||void 0===e.info.qDimensionType;e.locked=e.info.qLocked;e.text=e.info.qFallbackTitle;e.sortable=true;e.isDimension=!!e.info.qDimensionType;e.fieldName=e.isDimension?e.info.qGroupFieldDefs[e.info.qGroupPos]:"";e.isMeasure=!e.isDimension;e.isSorted=e.dataColIx===n[0];e.reversed=!!e.info.qReverseSort;e.sortIndicator=e.info.qSortIndicator;e.autoAlignText=I(e.info);e.explicitTextAlign=S(e.info);e.color={}}}function ee(){var e={glyphCntRange:{min:0,ok:0,max:1e5}};Q(e,true,[]);return e}function te(e,t,n,i,o){var r=o.column.glyphWidth,a=Math.ceil(o.column.minColWidth/r),s=Math.ceil(o.column.maxColWidth/r),l=n.info,u=[],c=[],d=[],p,f,h,g=Math.ceil(o.column.paddingWidth/r),m=Math.floor(e/r),v=5,b=t>0?Math.round(t/r*10)/10:NaN,x=3,y=Math.max(x,l.qApprMaxGlyphCount),C=Math.max(x,l.qFallbackTitle.length),q=0;u.push(x);if(n.isMeasure){var D=n.grandTotal;c.push(D.qText.length)}else{var w=L(l);"url"===w.type&&w.urlLabel&&(y=w.urlLabel.length);c.push(y);q=Math.ceil(o.column.minSearchWidth/r)}u.push(s);u.push(m-g-q);c.push(C+q);d.push(C+q);p=Math.min.apply(null,u);c.push(p);f=Math.max.apply(null,c);d.push(f);h=Math.max.apply(null,d);return{min:Math.max(a+q,p)+g,ok:Math.min(s,f)+g,optimal:h+g+v,explicit:b,search:q}}function ne(e,t,n,i,o){var r=o.column.glyphWidth,a=Math.floor(e/r),s=4,l=n.info,u=Math.max(s,Math.ceil(o.column.minColWidth/r)),c=Math.min(Math.ceil(o.column.maxColWidth/r),.8*a),d=Math.ceil(o.column.paddingWidth/r),p=5,f=t>0?Math.min(Math.round(t/r*10)/10,.8*a):NaN,h=Math.max(s,l.qApprMaxGlyphCount),g=Math.max(s,l.qFallbackTitle.length),m=Math.ceil(o.column.minSearchWidth/r);var v=u;var b=u;var x=u;if(n.isMeasure){var y=n.grandTotal;x=Math.min(c,Math.max(x,y.qText.length))}else{var C=L(l);"url"===C.type&&C.urlLabel&&(h=C.urlLabel.length);x=Math.min(c,Math.max(x,h));v+=m;g+=m}var q=.4+.6/(1+Math.exp((x-48)/12));return{min:Math.max(v,b,x*q)+d,ok:Math.min(c,Math.max(g,x))+d,optimal:Math.min(c,Math.max(g,x))+d+p,explicit:f,search:n.isMeasure?0:m}}function ie(e){return!e||e.qError&&e.qError.qErrorCode===s.NxLocalizedErrorCode.LOCERR_CALC_EVAL_CONDITION_FAILED}function oe(e){return!ie(e)}function re(e,t,n,i,o,r){var a,s=e.qDimensionInfo,l=e.qMeasureInfo,u=s.concat(l),c=p(e),d=Math.floor(i/o.column.glyphWidth),f,h;r||(r=[]);r=n.map(function(e){var t,n;for(t=0;t<r.length;++t)if(r[t].dataColIx===e){n=r[t];break}return n||{style:{}}});for(f=0;f<n.length;++f){h=n[f];a=r[f];if(ie(u[h])){a.isHidden=true;continue}var g=C(c.indexOf(h),e);a.info=g.colInfo;a.isDimension=h<s.length;a.isMeasure=h>=s.length;a.grandTotal=D(g.effectiveDataColIx,e);a.dataColIx=h;a.effectiveDataColIx=g.effectiveDataColIx;a.qLeft=h;Q(a,false,e.qEffectiveInterColumnSortOrder);if(o.horizontalScroll.enabled)a.glyphCntRange=ne(i,t[h],a,e,o);else{a.glyphCntRange=te(i,t[h],a,e,o);d-=a.glyphCntRange.explicit||a.glyphCntRange.min;if(d<0){r.splice(Math.max(1,f));break}}}r=r.filter(function(e){return!e.isHidden});return r}function ae(e,t){var n,i;e=e.slice();for(n=e.length-1;~n;--n){i=e[n];i.isDimension||i.isMeasure||e.splice(n,1)}while(e.length>t)e.pop();return e}function se(e,t,n,i,o,r){var a=n.horizontalScroll.enabled?n.width:n.width-n.columnPicker.width,s=c(e.qHyperCube),l=p(e.qHyperCube),u=n.column.glyphWidth,d,f,h=u/a,g,m=1,v;o&&(o=ae(o,s.length));n.columnPicker.show=false;o=re(e.qHyperCube,t,s,a,n,o);n.columnCount=o.length;n.columnPicker.show=!n.horizontalScroll.enabled&&o.length<l.length;f=o.length;for(d=0;d<f;d++){g=o[d];g.widthFactor=g.glyphCntRange.min*u/a;m-=g.widthFactor}if(m>0){var b;v=m;if(n.useAllSpace){var x=(v-.015)/f;o.forEach(function(e){e.widthFactor+=x;m=0})}else{b=o.reduce(function(e,t){return e+Math.max(0,t.glyphCntRange.ok-t.glyphCntRange.min)},0);o.forEach(function(e){var t=Math.max(0,e.glyphCntRange.ok-e.glyphCntRange.min),n=t/b,i=Math.min(t*u/a,n*v);if(t>0)if(i>m){e.widthFactor+=m;m=0}else{e.widthFactor+=i;m-=i}})}}if(m>0){var y;y=o.concat().sort(function(e,t){return e.glyphCntRange.optimal-e.glyphCntRange.ok-(t.glyphCntRange.optimal-t.glyphCntRange.ok)});y.forEach(function(e){var t=e.glyphCntRange.optimal-e.glyphCntRange.ok,n=Math.min(m,t*h);if(t>0)if(n>m){e.widthFactor+=m;m=0}else{e.widthFactor+=n;m-=n}})}m=pe(o,n);ue(o,a,n.column.minSearchWidth/a,i);le(o,a,r,n);return o}function le(e,t,n,i){var o,r,a,s;var l=ce(e,t,i);for(r=0;r<e.length;++r){o=e[r];if(o.isFillColumn)continue;a=i.horizontalScroll.enabled&&i.horizontalScroll.keepFirstColumnInView&&0===r;s=Math.round(t*o.widthFactor);o.isDimension&&!a?s=Math.min(s,l-i.column.minSearchWidth):o.isMeasure&&!a&&(s=Math.min(s,l));o.calculatedWidth=s;i.horizontalScroll.enabled&&o.calculatedWidth<i.column.minColWidth&&(o.calculatedWidth=i.column.minColWidth);n&&o.isSearchIcon&&(o.calculatedWidth=1);o.style.width=o.calculatedWidth+"px"}}function ue(e,t,n,i){var o,r,a=0,s,l=Math.round(t*n);for(o=0,r=e.length;o<a+r;++o){s=e[o];if(s.isDimension){e.splice(o+1,0,de(s,l,n,i));s.widthFactor=Math.max(0,s.widthFactor-n);++a}}}function ce(e,t,n){var i=t;if(n.horizontalScroll.enabled&&n.horizontalScroll.keepFirstColumnInView){var o=e[0];var r=0;if(o){r=o.widthFactor*t;r+=o.isDimension?n.column.minSearchWidth:0}i=Math.floor(t-r)}return i}function de(e,t,n,i){return{isSearchIcon:true,qvaOutsideIgnoreFor:"qv-st-header-cell-search-"+i,tid:"st.header.search",widthFactor:e.shouldBeRemoved?0:n,calculatedWidth:e.shouldBeRemoved?0:t,style:{width:t+"px"},fieldName:e.fieldName,dataColIx:e.dataColIx,colspan:1}}function pe(e,t){var n=1,i,o,r=t.width,a=t.column.glyphWidth,s=t.column.minSearchWidth/r,l=.01,u=false;e.forEach(function(e){e.shouldBeRemoved=false;if(u){e.widthFactor=0;e.shouldBeRemoved=true;return}if(e.glyphCntRange.explicit){i=e.glyphCntRange.explicit*a/r;e.isDimension&&(i+=s);if(n-i>=0||t.horizontalScroll.enabled){e.widthFactor=i;n-=e.widthFactor}else{o=e.glyphCntRange.min*a/r;if(n-o>-l){e.widthFactor=n;n-=e.widthFactor}else{e.widthFactor=n;e.shouldBeRemoved=true;u=true}}}else{o=e.glyphCntRange.min*a/r;if(n>=e.widthFactor||t.horizontalScroll.enabled)n-=e.widthFactor;else if(n-o>-l){e.widthFactor=n;n-=e.widthFactor}else{e.widthFactor=n;e.shouldBeRemoved=true;u=true}}});var c=t.columnCount;e.forEach(function(t,n){if(t.shouldBeRemoved){c--;n>0&&(e[n-1].widthFactor+=t.widthFactor);t.widthFactor=0}});t.horizontalScroll.enabled||t.columnPicker.show||c===t.columnCount||(t.columnPicker.show=true);if(!t.horizontalScroll.enabled&&!t.columnPicker.show){var d=e.reduceRight(function(e,t){return e||t.widthFactor>0&&!t.glyphCntRange.explicit&&t},false);d&&(d.widthFactor+=t.columnPicker.width/r)}t.columnCount=c;e.push(ee());return n}e.service("qvGridObjectDataService",function(){return{getTopTreeDepth:function e(t){return X(0,t.qTop)},getLeftTreeDepth:function e(t){var n=t?t.qLeft:[];return X(0,n)},updatePivotItems:function e(t,n,i,o){var r=t.layout,a=t.grid,s=n[0].qTop,l=n[0].qLeft,u=n[0].qData,c=X(0,s),d=X(0,l),p=i[0],f=t.metaGhostHeaders,h=r.qHyperCube.qIndentMode,g=this.getPseudoDimIndex(r);if(0===s.length){var m=r.qHyperCube.qMeasureInfo.filter(oe);if(1===m.length){s=E(m[0]);c=X(0,s)}}a.reset(false,o,g,h);a.setTopTreeDepth(c);a.setLeftTreeDepth(d);K(a,f);_(a,s,p.qLeft,f);z(a,l,p.qTop,f);W(a,u,p.qTop,p.qLeft,f);a.removeUnused()},updateStraightItems:function e(t,n,i,o,r,a){var s=t.layout,l=t.grid,u,c,d=n.length+1,p,f,h;o||l.reset(a);if(!a){Z(l,i);J(l,s)}u=l.getNextRowIx();for(h=0;h<d;++h){if(n[h]){p=n[h].qMatrix;f=n[h].qArea;c=p.length}else{p=null;f=null}G(s,l,u,h,f,p,c,r)}o&&l.setNextRowIx(l.rows.length);l.removeUnused()},getPseudoDimIndex:function e(t){var n=t.qHyperCube.qEffectiveInterColumnSortOrder.indexOf(-1);return~n?n:t.qHyperCube.qEffectiveInterColumnSortOrder.length},getColumnInfo:C,getColumnCells:f,getCellsInColumnWithValue:h,getCellsInColumn:g,getCellsInRow:m,getSiblingCells:x,getSiblingCellsWithValue:y,getCellInColumnWithRowIndex:v,columnOrder:{get:c,create:d,isValid:u,getVisible:p},getStraightMetaHeaders:se}})}.apply(t,i),void 0!==o&&(e.exports=o))},1053:function(e,t,n){"use strict";var i,o;!(i=[n(11),n(48),n(90),n(89),n(1570),n(1571),n(1572),n(153),n(156),n(1573),n(205),n(447),n(189),n(91),n(113),n(167),n(1574),n(1575),n(1577),n(1578)],o=function(e,t,n,i,o,r,a,s,l,u,c,d,p,f,h,g){var m=1e3,v=1;var b=0;function x(){return"filterpane-"+ ++b}function y(e){return e.columns.some(function(e){return e.items.some(function(e){return e.expand&&(!e.object||1!==e.object.renderState)})})}var C=c.extend({size:{},columns:[],expandable:false,init:function t(n,i,o,r,a){this.$scope=n;this.$element=i;this.$timeout=o;this.filterpaneLayout=r;this.updateDeferred;n.object.throbberApi.off();this.showThrobberTimeout=o(function(){n.object.throbberApi.show()},1e3);n.outsideIgnoreName=x();n.columns=[];n.ext.expandable=function(){return this.expandable}.bind(this);n.options||(n.options={});n.navService=a;n.accessibleFilterpane=h.ACCESSIBLE_FILTERPANE;n.fullscreenButtonLabel=f.get("Accessibility.Filterpane.SpaceForFullScreen");function s(e){if(h.ACCESSIBLE_FILTERPANE){n.focus&&n.focus.item&&!e||a.init(n,e);n.focus.item.focus();n.focus.focusInListbox=false}}n.setFocus=s;n.object.setOnFocusHandler(s);n.handleKeyDown=function(e){if(h.ACCESSIBLE_FILTERPANE){if(n.focus.focusInListbox)return;if(e.which===g.ESCAPE){if(n.object.expanded){n.$emit("zoomOut");n.focus.shouldResetFocus=true}else"function"===typeof n.object.blur&&n.object.blur();e.preventDefault()}else if(e.which===g.ENTER||e.which===g.SPACE)if(n.focus.isFullscreenBtn){n.triggerFullScreen();n.focus.shouldResetFocus=true}else if(n.focus.item.expand){n.focus.item.object.focus();n.focus.focusInListbox=true}else n.$broadcast("openPopover",{target:e.target});else if(g.isArrow(e.which)){e.preventDefault();e.stopPropagation();a.handleNavigation(n,e.which)}}};n.setFocusInListbox=function(){if(h.ACCESSIBLE_FILTERPANE){n.focus||(n.focus={});n.focus.focusInListbox=true}};n.hasFocus=function(){return i[0].contains(document.activeElement)};n.triggerFullScreen=function(){if(n.object.inAnalysisState()){e(".embedded-sheet-toolbar").length>0&&e(".embedded-sheet-toolbar").css("display","none");n.$emit("zoomOnCell")}};n.$on("objectRenderStateChange",function(e,t){e.stopPropagation();t&&!y(n)&&this.renderStateDfd.resolve()}.bind(this));i.on("focusout",function(t){if(null===t.target.getAttribute("tabIndex"))return;var n=e(t.target);var i=n.scope().item;!i&&n.closest(".qv-filterpane-column").scope().column&&(i=n.closest(".qv-filterpane-column").scope().column.fullscreen);i&&"function"===typeof i.blur&&i.blur()});n.$on("$destroy",function(){i.off("focusout")})},onPaint:function e(){this.renderStateDfd=i();this.update(this.$scope.layout).then(function(){y(this.$scope)||this.renderStateDfd.resolve()}.bind(this));return this.renderStateDfd.promise},onResize:function e(){this.renderStateDfd=i();this.update(this.$scope.layout).then(function(){y(this.$scope)||this.renderStateDfd.resolve()}.bind(this));return this.renderStateDfd.promise},update:function e(t){this.updateDeferred&&this.updateDeferred.reject();this.updateDeferred=new i;var o=this.size,r=this.$scope,a=this.columns,s=this.$element,l=r.focus,u=r.object.model.app,c=this.filterpaneLayout,d=c.getSize(s,t),p=c.getResolveModelFunction(u),f,h;if(c.sizeChanged(o,d)){l&&(h=l.item?l.item.id:"fullscreen");o=d;this.size=d;a=this.getColumns(o);this.columns=a}if(!c.isValid(t)){a=[];r.columns=a;return i.resolve()}f=c.getDimensions(t);f=c.sortDimensions(t,f);this.dimensions=f;this.preferredSizeDeferred&&this.preferredSizeDeferred.resolve();a=c.mergeColumnsAndDimensions(a,f);c.resolveAllModels(r,a,p,i).then(function(){this.updateDeferred.resolve()}.bind(this));this.updateDeferred.promise.then(function(){c.calculateExpandPriority(a,o);c.patchScope(r,a,n);this.$timeout.cancel(this.showThrobberTimeout);r.object.throbberApi.hide();this.expandable=!r.columns.some(function(e){return e.items.some(function(e){var t=e.model;return t&&t.layout&&t.layout.qSelectionInfo&&t.layout.qSelectionInfo.qInSelections})});r.hasExpanded=r.columns.some(function(e){return e.expand});r.navService.updateFocus(r,h)}.bind(this));return this.updateDeferred.promise},getColumns:function e(t){var n=[];this.filterpaneLayout.calculateColumns(t,n,this.$scope.options.zoomEnabled);return this.filterpaneLayout.balanceColumns(t,n)},setInteractionState:function e(t){this.$scope.interactive=this.$scope.object&&this.$scope.object.inAnalysisState()&&false!==this.$scope.options.navigation&&false!==this.$scope.options.selections;this.$scope.columns.forEach(function(e){e.items.forEach(function(e){e.expand&&e.object.setInteractionState(t)})})},setDirection:function e(t){this.$scope.options&&(this.$scope.options.direction=t);this.$scope.columns.forEach(function(e){e.items.forEach(function(e){e.expand&&e.object.setDirection(t)})})},getPreferredSize:function e(){var t=i();this.preferredSizeDeferred&&this.preferredSizeDeferred.reject();this.preferredSizeDeferred=i();var n=this;this.preferredSizeDeferred.promise.then(function(){n.preferredSizeDeferred=null;t.resolve({w:n.$element.width(),h:n.filterpaneLayout.getHeightOf(n.dimensions.length)})});this.dimensions&&this.preferredSizeDeferred.resolve();return t.promise}});C.$inject=["$scope","$element","$timeout","qvFilterpaneLayout","qvFilterPaneKeyboardNavigationService"];var q={type:"filterpane",template:u,BackendApi:o,controller:C,definition:r,initialProperties:{qChildListDef:{qData:{info:"/qInfo"}}},data:{dimensions:{min:1,max:1e3,description:function e(){return f.get("Visualizations.Descriptions.Pane")}}},expandable:function e(){return false},mapProperties:function e(){this.mappedDefinition=l.mapDefinition(this.definition,this.type);this.dimensionDefinition={min:1}},getCreatePropertyHandler:function e(t){return new a({app:t,dimensionDefinition:this.dimensionDefinition})},addFieldDimension:function e(n,i){return i.model.getProperties().then(function(e){var o=i.getCreatePropertyHandler();o.setProperties(e);o.setModel(i.model);return o.addFieldDimension(n.value,n.displayName).then(function(e){t.$rootScope.$broadcast("pp-open-path","data."+e.qDef.cId)})})},addLibraryDimension:function e(n,i){return i.model.getProperties().then(function(e){var o=i.getCreatePropertyHandler();o.setProperties(e);o.setModel(i.model);return o.addLibraryDimension(n.libraryId).then(function(e){t.$rootScope.$broadcast("pp-open-path","data."+e.qDef.cId)})})},getDropFieldOptions:function e(n,i,o){if(i.getDimensions().length<i.maxDimensions()){i.setModel(o);i.addFieldDimension(n.item.name,n.item.displayName).then(function(e){o.setProperties(i.properties);t.$rootScope.$broadcast("pp-open-path","data."+e.qDef.cId)})}},getDropDimensionOptions:function e(n,i,o){if(i.getDimensions().length<i.maxDimensions()){i.setModel(o);i.addLibraryDimension(n.item.id).then(function(e){o.setProperties(i.properties);t.$rootScope.$broadcast("pp-open-path","data."+e.qDef.cId)})}},getDropMeasureOptions:function e(t,n,i,o){o()},getExportRawDataOptions:function e(n,o){return o.model.getLayout().then(function(e){if(1===e.qChildList.qItems.length){n.addItem({translation:"contextMenu.export",tid:"export",select:function n(){o.model.app.getObject(e.qChildList.qItems[0].qInfo.qId).then(function(e){t.getService("$exportDialog").show(e)})}});return}var r=[];n.addItem({translation:"Export.AllDimensions",tid:"export-all-dimensions",select:function e(){t.getService("$exportDialog").show(o.model)}});e.qChildList.qItems.forEach(function(e){r.push(o.model.app.getObject(e.qInfo.qId).then(function(e){return e.getLayout().then(function(i){n.addItem({translation:i.title,tid:"export",select:function n(){t.getService("$exportDialog").show(e)}})})}))});return i.all(r)})},exportProperties:function e(t){var n=new d,i=t.qProperty,o=n.data[0],r,a,s,l,u;if(t.qChildren)for(a=0;a<t.qChildren.length;++a){r=t.qChildren[a].qProperty;o.dimensions.push({qDef:r.qListObjectDef.qDef,qLibraryId:r.qListObjectDef.qLibraryId,qOtherTotalSpec:r.qListObjectDef.qOtherTotalSpec||{qOtherMode:"OTHER_OFF",qOtherCounted:{qv:"10"}},title:r.title})}if(i.qLayoutExclude&&i.qLayoutExclude.qHyperCubeDef){if(i.qLayoutExclude.qHyperCubeDef.qDimensions)for(a=0;a<i.qLayoutExclude.qHyperCubeDef.qDimensions.length;++a)o.excludedDimensions.push(i.qLayoutExclude.qHyperCubeDef.qDimensions[a]);if(i.qLayoutExclude.qHyperCubeDef.qMeasures)for(a=0;a<i.qLayoutExclude.qHyperCubeDef.qMeasures.length;++a)o.excludedMeasures.push(i.qLayoutExclude.qHyperCubeDef.qMeasures[a]);if(i.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder)for(a=0;a<i.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder.length;++a)o.interColumnSortOrder.push(i.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder[a])}for(l in i)"qChildListDef"!==l&&(n.properties[l]=i[l]);i.qLayoutExclude||(i.qLayoutExclude={});if(i.qLayoutExclude.disabled){for(l in i.qLayoutExclude.disabled){u=l;n.properties.hasOwnProperty(u)||(n.properties[u]=i.qLayoutExclude.disabled[l])}i.qLayoutExclude.disabled.previousShowTitles&&(n.properties.showTitles=true)}delete i.qLayoutExclude;for(a=0;a<o.dimensions.length;++a)for(s=0;s<o.dimensions[a].qDef.qSortCriterias.length;++s){o.dimensions[0].qDef.qSortCriterias[s].qSortByFrequency=0;o.dimensions[0].qDef.qSortCriterias[s].qSortByState=0}return n},importProperties:function e(t,i){var o={qChildren:[]},r={},a=t.data[0],l,u;r.qLayoutExclude||(r.qLayoutExclude={});r.qLayoutExclude.disabled={};for(l in t.properties)"qLayoutExclude"===l?t.properties[l].quarantine&&(r.qLayoutExclude.quarantine=n.extend(true,{},t.properties[l].quarantine)):i.hasOwnProperty(l)||p.isMasterItemProp(l)?r[l]=t.properties[l]:r.qLayoutExclude.disabled[l]=t.properties[l];r=n.extend(true,{},i,r);for(u=0;u<a.dimensions.length;++u)if(o.qChildren.length<m)o.qChildren.push({qProperty:s.createDefaultListBox(a.dimensions[u],a.dimensions[u].title),qChildren:[]});else{r.qLayoutExclude||(r.qLayoutExclude={});r.qLayoutExclude.qHyperCubeDef||(r.qLayoutExclude.qHyperCubeDef={});r.qLayoutExclude.qHyperCubeDef.qDimensions||(r.qLayoutExclude.qHyperCubeDef.qDimensions=[]);r.qLayoutExclude.qHyperCubeDef.qDimensions.push(a.dimensions[u])}if(a.measures.length){r.qLayoutExclude.qHyperCubeDef||(r.qLayoutExclude.qHyperCubeDef={});r.qLayoutExclude.qHyperCubeDef.qMeasures||(r.qLayoutExclude.qHyperCubeDef.qMeasures=[]);for(u=0;u<a.measures.length;++u)r.qLayoutExclude.qHyperCubeDef.qMeasures.push(a.measures[u])}for(u=0;u<a.excludedDimensions.length;++u)if(o.qChildren.length<v)o.qChildren.push({qProperty:s.createDefaultListBox(a.excludedDimensions[u],a.excludedDimensions[u].title),qChildren:[]});else{r.qLayoutExclude.qHyperCubeDef||(r.qLayoutExclude.qHyperCubeDef={});r.qLayoutExclude.qHyperCubeDef.qDimensions||(r.qLayoutExclude.qHyperCubeDef.qDimensions=[]);r.qLayoutExclude.qHyperCubeDef.qDimensions.push(a.excludedDimensions[u])}for(u=0;u<a.excludedMeasures.length;++u){r.qLayoutExclude.qHyperCubeDef||(r.qLayoutExclude.qHyperCubeDef={});r.qLayoutExclude.qHyperCubeDef.qMeasures||(r.qLayoutExclude.qHyperCubeDef.qMeasures=[]);r.qLayoutExclude.qHyperCubeDef.qMeasures.push(a.excludedMeasures[u])}for(u=0;u<a.interColumnSortOrder.length;++u)if(r.qLayoutExclude.qHyperCubeDef){r.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder||(r.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder=[]);r.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder.push(a.interColumnSortOrder[u])}p.importCommonProperties(r,t,i);if(r.showTitles){r.qLayoutExclude.disabled.previousShowTitles=true;r.showTitles=false}o.qProperty=r;return o}};return q}.apply(t,i),void 0!==o&&(e.exports=o))},1054:function(e,t,n){"use strict";var i,o;!(i=[n(11),n(91),n(1127),n(89),n(1579),n(1582),n(1583),n(180),n(410),n(299),n(1584),n(1585),n(189),n(1586)],o=function(e,t,n,i,o,r,a,s,l,u,c,d,p){var f;function h(){var e,t,n;e=-Math.PI*(this._data.angle+.5);t=Math.PI*(this._data.angle-.5);t+=e<0?2*Math.PI:0;e+=e<0?2*Math.PI:0;n=this.yMirrorMode&&"radial"!==this._type;this.components.axis.setRadial("radial"===this._type,n?{start:t,end:e}:{start:e,end:t})}f=n.extend("Gauge",{namespace:".gauge",init:function n(i,u,c,d){var p=this;c=e.extend(true,c||{},{providers:{},components:{axis:{show:true,order:0,dock:"center",showFlag:s.prototype.ShowFlags.SPARK,clazz:l},dataArea:{show:true,order:1,dock:"center",clazz:o,showFlag:s.prototype.ShowFlags.SPARK},gaugeRefLines:{sortKey:5,show:true,dock:"center",showFlag:s.prototype.ShowFlags.XSMALL},gaugeRefLineLabels:{show:true,dock:"center",order:3,showFlag:s.prototype.ShowFlags.XSMALL}}});this._type="vertical";this._orientation="horizontal";this._super(i,u,c,d);this.components.dataArea.setAxis(this.components.axis);this.components.axis.setAlignment("near");this.components.axis.setDataRangeTransition(true);this.components.axis.setShowLine(false);this.components.gaugeRefLines=new r(this.container);this.components.gaugeRefLines.showFlag=s.prototype.ShowFlags.XSMALL;this.components.gaugeRefLines.setUseTransition(true);this.components.dataArea.setRefLines(this.components.gaugeRefLines);this.layoutEngine.addComponent(this.components.gaugeRefLines);this.components.gaugeRefLineLabels=new a(this.container);this.components.gaugeRefLineLabels.showFlag=s.prototype.ShowFlags.SMALL;this.components.gaugeRefLineLabels.setUseTransition(true);this.components.dataArea.setRefLineLabels(this.components.gaugeRefLineLabels);this.layoutEngine.addComponent(this.components.gaugeRefLineLabels);this.$scope.dataAttributes.popupDisclaimer={show:false,message:t.get("Object.Gauge.RangeIsDefault"),title:t.get("Object.Gauge.RangeIsDefaultTitle"),onPopClose:function e(){p.$scope.backendApi.model.getProperties().then(function(e){e.disclaimerClosed=true;p.$scope.backendApi.model.setProperties(e)})}}},_updateData:function e(t){this._type=t.gaugetype;this._orientation=t.autoOrientation&&"bar"===t.gaugetype?this.components.dataArea.rect.height>this.components.dataArea.rect.width?"vertical":"horizontal":t.orientation;if(t.refLine){var n={axes:{axis:{component:this.components.axis,data:t.axis,dataIndices:t.qHyperCube.qMeasureInfo.map(function(e,t){return t})}},refLineLabels:{labels:{data:t.refLine.refLines,component:this.components.gaugeRefLineLabels,axis:this.components.axis}},refLines:{component:this.components.gaugeRefLines}};this._super(t,n);this.components.dataArea.setData(t);this.updateAxis(t,this.options);this.updateRefLines(t,n)}else{this.components.dataArea.setData(t);this.updateAxis(t,this.options);this._super(t)}},updateRefLines:function e(t,n){var i,o=n.refLineLabels,r=[],a=[];for(i in o){if(!o[i].component)continue;o[i].component.setData(o[i].data);o[i].component.setAxis(o[i].axis);o[i].component.setDock(o[i].axis.getOppositeDock());a.push(o[i].axis);r.push(o[i].data)}if(n.refLines&&n.refLines.component){n.refLines.component.setAxes([n.axes.axis.component]);n.refLines.component.setData([t.refLine.refLines])}},isValid:function e(t){var n=this.isDataValid(t),i;for(i in this.components)this.components[i].setHasValidData(n);return n},isDataValid:function e(t){var n=!!t&&!!t.qHyperCube&&t.qHyperCube.qMeasureInfo.length&&!t.qHyperCube.qMeasureInfo.some(function(e){return!!e.qError});return n},updateAxis:function e(t){var n=t.measureAxis,i=this.components.axis,o,r,a,s;o=Math.min.apply(this,t.qHyperCube.qMeasureInfo.filter(function(e){return!Number.isNaN(+e.qMin)}).map(function(e){return e.qMin}));r=Math.max.apply(this,t.qHyperCube.qMeasureInfo.filter(function(e){return!Number.isNaN(+e.qMax)}).map(function(e){return e.qMax}));a=t.qHyperCube.qMeasureInfo.map(function(e){return e.qFallbackTitle}).join(", ");i.setData(t);i.setTitle(a);i.setShowStrategy(n.show);i.setLabelMode(n.label);i.setOrientation("bar"===this._type?this._orientation:"horizontal");if(i.setPlotMin){s=this.getAxisOptions(n);i.setPlotMin(s.min);i.setPlotMax(s.max);i.setTickMultiplier(n.spacing);i.setLogScale(n.logarithmic)}if(o===r&&0===r){r=1;o=0}r=Math.max(0,r);o=Math.min(0,o);this.setAxisDataRange(i,r,o,s.max,s.min,1);h.call(this)},getAxisOptions:function e(t){if(!t)return;return{min:Number(t.min),max:Number(t.max)}},setAxisDataRange:function e(t,n,i,o,r,a){null!==o&&null!==r||null===o&&null===r?t.setDataRange(i,n):null!==o&&o<=i?t.setDataRange(o-a,n):null!==r&&r>=n?t.setDataRange(i,r+a):t.setDataRange(i,n)},_paint:function e(){var t;var n=[];if(!this.isValid(this._data))return this.clear();this._super();h.call(this);this.layout();if(this.$scope.dataAttributes.popupDisclaimer){var o=this._data.disclaimerClosed||this._data.maxMinChanged;!this.inEditState()||this._layoutMode<7||o?this.$scope.dataAttributes.popupDisclaimer.show=false:this.$scope.dataAttributes.popupDisclaimer.show=true}for(t in this.components)n.push(this.components[t].invalidateDisplay());return i.all(n)},layout:function e(){var t=this.components.axis;var n=t.updateSize;t.updateSize=function(){};this.layoutEngine.layout(this.rect,this._layoutMode,this.containerRect);t.updateSize=n;if(this._data&&this._data.autoOrientation&&"bar"===this._data.gaugetype){this._orientation=this.components.dataArea.rect.height>this.components.dataArea.rect.width?"vertical":"horizontal";this.components.axis.setOrientation(this._orientation)}t.preRelevantSizeCalculation();t.calculatePreliminaryRelevantSize(this.components.dataArea.rect,this.components.dataArea.rect);t.calculateRelevantSize(this.components.dataArea.rect,this.components.dataArea.rect);this.components.axis.isRadial()||g.call(this);t.updateSize()},getPreferredSize:function e(){return this._super()}});function g(){var t=this.components.dataArea,n=t.rect,i=80,o=e.extend({},n),r=this.components.axis,a=r.relevantSize,s=t.getGaugeWidth(t.rect,"vertical"===this._orientation)/2;r.setAlignment("near");if("vertical"===this._orientation){if(this.yMirrorMode){o.x=n.width/2+s;r.setAlignment("far")}else o.x=n.width/2-s-a;if(o.x<0){o.width=a+o.x;o.x=0}else o.width=a}else{o.y=n.height/2-s-a;if(o.y<0){o.height=a+o.y;o.y=0}else o.height=a}(n.width<i||n.height<i)&&(o["vertical"===this._orientation?"width":"height"]=0);r.rect=o}return{type:"gauge",BackendApi:u,template:c,View:f,definition:d,initialProperties:{qHyperCubeDef:{qDimensions:[],qMeasures:[],qInitialDataFetch:[{qWidth:1,qHeight:1}],qSuppressMissing:true},segmentInfo:{limits:[],colors:[{color:3}]}},data:{measures:{min:1,max:1,description:function e(){return t.get("Visualizations.Descriptions.Gauge.Measure")}}},support:{cssScaling:false,snapshot:true,export:true,exportData:true,sharing:true,viewData:true},getDropFieldOptions:function e(t,n,i,o,r){t.AddFieldAsMeasure(i,n,r);o()},getDropDimensionOptions:function e(t,n,i,o){o()},importProperties:p.axisChart.importProperties.bind(p),exportProperties:p.axisChart.exportProperties.bind(p)}}.apply(t,i),void 0!==o&&(e.exports=o))},1055:function(e,t,n){"use strict";var i,o;!(i=[n(11),n(48),n(91),n(108),n(420),n(299),n(1591),n(1592),n(1170),n(89),n(1593),n(122),n(94),n(120),n(189),n(106),n(1594),n(1595),n(297)],o=function(e,t,n,i,o,r,a,s,l,u,c,d,p,f,h,g,m){var v;function b(e){var t=this.$scope,i=this;f.get(e).then(function(e){t.sheet=e;g(t,"sheet",function(e){var n=e&&e.labelExpression,o=e&&e.qMeta&&e.qMeta.title;t.sheetLinkTitle=n||o||"";t.sheetIsMissing=false;i.updateStyles()})}).catch(function(){t.sheetLinkTitle=n.get("Bookmarks.SheetMissingDialogTitle");t.sheetIsMissing=true;i.updateStyles()})}v=o.extend("kpi",{namespace:".kpi",init:function e(i,o,r,a){var s=this,l,u=t.getService("$timeout"),f=function e(){t.$apply(i,function(){i.showVerifyDialog=false})};this._super(i,o,r,a);var h=o.find(".qv-viz");this._$element=h;this.$scope.mainValueStyle={};this.$scope.measureTitleStyle={};this.$scope.viz={};this.$scope.secondaryValues=[];this.$scope.secondaryLayouts=[];this.$scope.showSecondaryValues=false;this.$scope.mainValue={formattedValue:"",value:null,style:null};i.showVerifyDialog=false;i.onShowVerifyDialog=function(){if(!i.linkInteractionOn)return;t.$apply(i,function(){i.showVerifyDialog=true;i.updateVerifyDialogFontSize()});l=u(f,3e3)};i.linkToSheet=function(){if(!i.linkInteractionOn||i.sheetIsMissing||!i.showVerifyDialog)return;var e=d.getUrlForSheet(i.layout.sheetLink,"analysis");i.layout.openUrlInNewTab||void 0===i.layout.openUrlInNewTab?window.open(e):d.goToSheet(i.layout.sheetLink,p.States.ANALYSIS);u.cancel(l);f()};i.updateVerifyDialogFontSize=function(){if(i.showVerifyDialog){var e=i.verifyDialogLayoutInfo.components[0];c.checkLayout(i.verifyDialogLayoutInfo);c.sizeComponent(e,i.verifyDialogLayoutInfo,i.verifyDialogLayoutInfo.boundingBox.width,i.verifyDialogLayoutInfo.boundingBox.height,c.TextScaleMode.SCALE,c.ElementScaleMode.NONE);i.verifyDialogStyle={fontSize:e.fontSizes.fontSize}}};this.$scope.baseLayoutInfo={direction:c.Direction.COLUMN,ratio:1e9,boundingBox:{width:h.width(),height:h.height()},components:[{size:{min:.5,treshold:{width:50,height:12}},getText:function e(){return i.measureTitle},fontSizes:{maxNrChars:15,min:{fontSize:10,height:12},max:{fontSize:40,height:80}},isVisible:function e(){return i.showMeasureTitle}},{size:{min:.8,stretch:true},ratio:1,components:[{size:{min:.5,stretch:true},getText:function e(){return s.$scope.mainValue.formattedValue+(s.$scope.mainValue.glyph?s.$scope.mainValue.glyph:"")},fontSizes:{maxNrChars:4,min:{fontSize:10,height:10},max:{fontSize:500,height:500}}},{size:.5,components:this.$scope.secondaryLayouts,isVisible:function e(){return s.$scope.secondaryLayouts.length>0}}]}]};this.$scope.secondaryLayoutInfo={size:{min:1,treshold:{width:50,height:30}},direction:c.Direction.COLUMN,components:[{size:{min:.6,stretch:true},fontSizes:{maxNrChars:8,min:{fontSize:10,height:20},max:{fontSize:500,height:500}}},{size:{min:.4},fontSizes:{maxNrChars:15,min:{fontSize:10,height:20},max:{fontSize:30,height:500}}}]};this.$scope.verifyDialogLayoutInfo={size:{min:1,width:20,height:20},boundingBox:{width:0,height:0},components:[{size:{min:.2,treshold:{width:100,height:100}},getText:function e(){return n.get("properties.kpi.verifyToGoSheet")},fontSizes:{maxNrChars:16,min:{fontSize:10,height:20},max:{fontSize:13,height:50}}}]};i.$on("$destroy",function(){l&&u.cancel(l)})},isValid:function e(t){return!!t&&!!t.qHyperCube&&t.qHyperCube.qMeasureInfo.length&&!t.qHyperCube.qMeasureInfo.some(function(e){return!!e.qError})},updateData:function e(t){if(this._destroyed)return u.reject();if(!this.isValid(t))return u.resolve();this._data=t;var n=t.qHyperCube.qDataPages[0].qMatrix[0],o=t.qHyperCube.qMeasureInfo.length,r=i.inClient(),a=o-1,s=this.getFormatterForMeasures(t.qHyperCube.qMeasureInfo.length),l=this.$scope.secondaryValues,c,d=this.$scope.secondaryLayouts,p,f,h,g,m,v=this.$scope.sheet&&this.$scope.sheet.qMetaDef&&this.$scope.sheet.qMetaDef.title?this.$scope.sheet.qMetaDef.title:null,x=function e(){return h},y=function e(){return m},C;this.$scope.showMeasureTitle=t.showMeasureTitle;this.$scope.textAlign=t.textAlign;this.$scope.baseLayoutInfo.components[1].components[0].fontSizes.maxNrChars=0;var q=7/3;this.$scope.baseLayoutInfo.components[1].components[0].fontSizes.scale="S"===t.fontSize?q:"L"===t.fontSize?1:Math.sqrt(q);this.$scope.baseLayoutInfo.components[1].components[0].fontSizes;this.$scope.useLink=t.useLink;r&&this.$scope.useLink&&t.sheetLink&&(!v||t.sheetLink!==v)&&b.call(this,t.sheetLink);this.$scope.mainValue.value=t.qHyperCube.qDataPages[0].qMatrix[0][0].qNum;this.$scope.mainValue.formattedValue=s[0]&&"U"===s[0].type&&!Number.isNaN(+t.qHyperCube.qDataPages[0].qMatrix[0][0].qNum)?s[0].formatValue(this.$scope.mainValue.value):t.qHyperCube.qDataPages[0].qMatrix[0][0].qText;this.$scope.mainValue.formatter=s[0];for(C=0;C<a;C++){f=n[C+1].qText;g=n[C+1].qNum;h=!s[C+1]||"U"!==s[C+1].type||Number.isNaN(+g)?f:s[C+1].formatValue(g);m=t.qHyperCube.qMeasureInfo[C+1].qFallbackTitle;if(!l[C]){p=this.createSecondaryValue(x,y);c={style:p.layoutInfo.components[0].fontSizes.value,titleStyle:p.layoutInfo.components[1].fontSizes.value};l.push(c);d.push(p.layoutInfo)}c=l[C];c.value=g;c.formattedValue=h;c.formatter=s[C+1];c.measureTitle=m;d[C].components[0].fontSizes.maxNrChars="S"===t.fontSize?14:"L"===t.fontSize?6:8}if(l.length>a){d.splice(a,l.length-a);l.splice(a,l.length-a)}this.$scope.measureTitle=t.qHyperCube.qMeasureInfo[0].qFallbackTitle;this.$scope.showSecondaryValues=l.length>0;return u.resolve()},updateStyles:function e(){if(!this._data)return u.resolve();var n=this,o=this._data,r=i.inClient(),a,s;this.$scope.linkInteractionOn=r&&this._navigation&&this.$scope.layout.useLink&&!!this.$scope.layout.sheetLink;this.$scope.verifyDialogLayoutInfo.boundingBox.width=this._$element.width();this.$scope.verifyDialogLayoutInfo.boundingBox.height=this._$element.height();this.$scope.baseLayoutInfo.boundingBox=this.getBoundingBox();c.checkLayout(this.$scope.baseLayoutInfo);this.$scope.baseLayoutInfo.components.forEach(function(e){var t=n.backendApi.isSnapshot&&n._data&&!n.options.freeResize;var i=t?n._data.snapshotData.isZoomed:n.options.isZoomed;c.sizeComponent(e,n.$scope.baseLayoutInfo,n.$scope.baseLayoutInfo.boundingBox.width,n.$scope.baseLayoutInfo.boundingBox.height,0===n.$scope.secondaryValues.length&&i?c.TextScaleMode.MAX:c.TextScaleMode.SCALE,0===n.$scope.secondaryValues.length&&i?c.ElementScaleMode.ADJUSTTOTEXT:c.ElementScaleMode.NONE)});var l=t.getService("qvGlyphService");s=m.getValueInfo(this.$scope.mainValue.value,0,o);this.$scope.mainValue.cssClass=l.getIconClass(s.icon);this.$scope.mainValue.showGlyph=s.useCondColor&&s.icon&&""!==s.icon;a=this.$scope.baseLayoutInfo.components[1].components[0];var d=a.fontSizes.fontSizeScale;this.$scope.mainValue.style={color:s.color,fontSize:a.fontSizes.fontSize};a=this.$scope.baseLayoutInfo.components[0];this.$scope.measureTitleStyle={fontSize:a.fontSizes.fontSize};for(var p=1;p<o.qHyperCube.qMeasureInfo.length;p++){a=this.$scope.baseLayoutInfo.components[1].components[1].components[p-1].components[0];s=m.getValueInfo(this.$scope.secondaryValues[p-1].value,p,o);this.$scope.secondaryValues[p-1].style={color:s.color,fontSize:10*Math.min(d/2,a.fontSizes.fontSizeScale)+"%"};a=this.$scope.baseLayoutInfo.components[1].components[1].components[p-1].components[1];this.$scope.secondaryValues[p-1].titleStyle={fontSize:10*Math.min(d/2,a.fontSizes.fontSizeScale)+"%"};this.$scope.secondaryValues[p-1].cssClass=l.getIconClass(s.icon);this.$scope.secondaryValues[p-1].showGlyph=s.useCondColor&&s.icon&&""!==s.icon}this.$scope.updateVerifyDialogFontSize();var f=u();var h=t.getService("$timeout");h(function(){f.resolve()},0,false);return f.promise},createSecondaryValue:function t(n,i){var o=e.extend({},this.$scope.secondaryLayoutInfo);o.components[0].getText=n;o.components[1].getText=i;return{layoutInfo:o,text:n()}},paint:function e(){return this.updateStyles()},resize:function e(t,n){return this.paint(t,n)},getFormatterForMeasures:function e(t){var n=this._data,i,o=new l(this.backendApi.localeInfo,n.qHyperCube.qMeasureInfo),r,a=[];for(var s=0;s<t;s++){i=n.qHyperCube.qMeasureInfo[s];r=o.getMeasureFormatter(s);if(r&&"U"===r.type){r.pattern=r.createPatternFromRange(i.qMax,i.qMax,true);if(Math.floor(Math.log(Math.abs(i.qMax))/Math.log(10))%3===2){r.pattern=r.pattern.substr(0,r.pattern.length-2);r.pattern+="A"}r.prepare()}a.push(r)}return a},on:function e(){this.options.navigation&&(this._navigation=true);this._super();this.updateStyles()},off:function e(){this.options.navigation&&(this._navigation=false);this._super();this.updateStyles()},getBoundingBox:function e(){var t=this.backendApi.isSnapshot&&this._data&&!this.options.freeResize;return t&&this._data.snapshotData.elementRatio?{width:this._data.snapshotData.object.size.w,height:this._data.snapshotData.object.size.w*this._data.snapshotData.elementRatio}:{width:this._$element.width(),height:this._$element.height()}},setSnapshotData:function e(t){this._super();t.snapshotData.isZoomed=this.options.isZoomed;t.snapshotData.elementRatio=this._$element.height()/this._$element.width()},getPreferredSize:function e(){var t=u();t.resolve({w:this._$element.width(),h:c.FixedMobileHeight});return t.promise}});return{type:"kpi",BackendApi:r,template:a,View:v,definition:s,initialProperties:{qHyperCubeDef:{qDimensions:[],qMeasures:[],qInitialDataFetch:[{qWidth:500,qHeight:10}],qSuppressMissing:true},showTitles:false},data:{measures:{min:1,max:2,description:function e(t,i){var o=0===i?"Visualizations.Descriptions.KPI.FirstMeasure":"Visualizations.Descriptions.KPI.SecondMeasure";return n.get(o)}}},support:{cssScaling:false,snapshot:true,export:true,exportData:true,sharing:false},getDropFieldOptions:function e(t,n,i,o,r){t.AddFieldAsMeasure(i,n,r);o()},getDropDimensionOptions:function e(t,n,i,o){o()},importProperties:function e(t,n,i){var o=h.hypercube.importProperties.apply(h,[t,n,i]),r=o.qProperty.qHyperCubeDef.qMeasures,a,s,l;if(r)for(s=0,a=r.length;s<a;s++){l=r[s].qDef;l.conditionalColoring||(l.conditionalColoring={useConditionalColoring:false,singleColor:3,segments:{limits:[],colors:[{color:2}],paletteColors:[{index:6}]}})}return o},exportProperties:h.hypercube.exportProperties.bind(h)}}.apply(t,i),void 0!==o&&(e.exports=o))},1057:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(11),n(1603),n(1604),n(1605),n(1607),n(156),n(1608),n(1609),n(1610),n(1611),n(1612),n(1613),n(1614),n(99),n(89),n(225),n(100),n(142),n(50),n(986),n(91),n(101),n(393),n(90),n(290),n(1615),n(1616),n(1617),n(1619),n(1621),n(1622),n(244),n(1003),n(1265),n(1623),n(1266),n(289)],o=function(e,t,n,i,o,r,a,s,l,u,c,d,p,f,h,g,m,v,b,x,y,C,q,D,w){e.directive("qvPivotTableInclude",["$compile","$animate",function(t,n){return{link:function i(o,r,a){n.enabled(r,false);o.$watch(a.qvPivotTableInclude,function(){var n=o.$eval(a.qvPivotTableInclude);var i=e.getService("$templateCache");var s=i.get(n);r.html(s);t(r.contents())(o)})}}}]);e.directive("onFinishRender",["$timeout",function(e){return{restrict:"A",link:function t(n){true===n.$last&&e(function(){n.$emit("ngRepeatFinished")})}}}]);function I(e,t){e.themeStyle={header:{"font-size":t.getStyle("header","fontSize"),color:t.getStyle("header","color")},content:{"font-size":t.getStyle("content","fontSize"),color:t.getStyle("content","color")}}}function S(e){return true===e.capturedOnDesktop||h.treatAsDesktop()&&false!==e.capturedOnDesktop}function L(e){var t=e.treatAsDesktop;var n;var i=parseInt(e.themeStyle.content["font-size"]);var o=1.23076923;n=t?i?i/13*21-o:21:i?i/13*31-o:31;return n||(t?21:31)}function E(e,t){e.currentPopover.header===t?t.open=false:e.currentPopover.header&&(e.currentPopover.header.open=false);e.currentPopover.header=void 0;e.pivoting.update(e.metaGhostHeaders.dataColumnsInfo.cnt)}function M(e,t,n,i,o){var r=null;n.layout&&n.layout.qStateName&&(r={qStateName:n.layout.qStateName});return e.showField(t,n.backendApi.model.app,{$alignToElement:i,qvaOutsideIgnoreFor:"qv-pt-meta-header-"+n.$id,collision:"flipfit",direction:n.options.direction},r,function(){n.currentPopover.header=void 0;o.on();n.processPaint()})}function _(e,t){t.on();e.processPaint()}function A(e){return q.getValue(e,"layout.qHyperCube.qDimensionInfo.0.qIsOneAndOnlyOne",false)}function P(n,i,o,r,a,y,C,q,P,k){var T=e.getService("$templateCache");T.put("pt-cell-item.ng.html",l);T.put("pt-header-cell-item.ng.html",u);T.put("pt-meta-left.ng.html",c);T.put("pt-meta-top.ng.html",d);T.put("pt-meta-list.ng.html",p);T.put("pt-meta-item.ng.html",f);function O(e,s,l,u){var c,d,p,f,T,O,V,H,R=[],$;var F=v.initializeService("object.pivotTable");$=function t(){I(e,F);e.viewport&&(e.viewport.minRowHeight=L(e))};v.ThemeChanged.bind($);I(e,F);e.currentPopover={header:void 0};e.nonMouseViewportScrolling={scrollbarSize:36,className:"show-non-mouse-scrollbars"};e.grid=n("pivot");e.treatAsDesktop=S(e.layout.snapshotData||{});e.viewport=y(s,L(e),".qv-grid-object-scroll-area",".scroll-content","table",".first-data-cell","th.top:nth-child(2)",e.layout.snapshotData,e.options);c=e.viewport.getVirtualScrollController();d=e.viewport.getSortableListController();p=e.viewport.getMultiSelectController();e.metaGhostHeaders=a({},e.layout,e.viewport.rect);e.pivoting=r(e.backendApi,e.grid,e.metaGhostHeaders,e.layout,e.$id,e.currentPopover,c,p);var N=function e(t,n){if("%"===t.substring(t.length-1,t.length))return parseFloat(t)*n/100;return parseFloat(t)};var z=function e(t){var n=H[t].getBoundingClientRect();var i=H.position();R[t]||(R[t]={});R[t].top=i.top;R[t].left=i.left;R[t].width=n.width;R[t].height=n.height};var B=function e(t,n,i){if(i)return R[n].width;var o=t.metaGhostHeaders.leftColumns[n];return o.reduce(function(e,n){return e+Math.max(0,N(n.style.width,t.viewport.rect.width))},0)};var W=function e(t,n){if(!t.columns[n].definedTopHeight){Object.defineProperties(t.columns[n],{top:{get:function e(){return this._top||0}},height:{get:function e(){return this._height||40}}});t.columns[n].definedTopHeight=true}};var G=function e(t,n){t.explicitColumnWidths||(t.explicitColumnWidths=t.metaGhostHeaders.explicitColumnWidths);t.columns||(t.columns=[]);t.columns.length>n&&t.columns.splice(n,t.columns.length-n);t.explicitColumnWidths.length>n&&t.explicitColumnWidths.splice(n,t.explicitColumnWidths.length-n)};var j=function e(t,n,i,o){t.explicitColumnWidths[i]>0&&(t.explicitColumnWidths[i]=n);t.columns[i]||(t.columns[i]={});t.columns[i].index=i;t.columns[i].width=n;t.columns[i].isLastColumn=o;if(R[i]){t.columns[i]._top=o?0:R[i].top;t.columns[i]._height=o?R[i].top+R[i].height:R[i].height}else{t.columns[i]._top=0;t.columns[i]._height=40}W(t,i)};var U=function e(t,n){var i,o,r,a=[],s=t.metaGhostHeaders.leftColumns.length;if(n){H=t.viewport.getEmptyMetaCellsOfLastHeaderRow();if(!H||H.length!==s)return;for(i=0;i<s;i++)z(i)}else t.changingColumnIndex>=0&&z(t.changingColumnIndex);G(t,s);for(i=0;i<s;i++){o=B(t,i,n&&H);r=i===s-1;j(t,o,i,r);a[i]=0===i?o:a[i-1]+o}for(i=0;i<s;i++)t.columns[i].left=t.rtl?t.viewport.rect.width-a[i]:a[i];n&&(t.changingColumnIndex=-1)};e.$on("onExplicitColumnStarted",function(t){var n=t.targetScope.column.index,i=0,o,r,a=e.metaGhostHeaders.opts.topTree.minGlyphCnt*e.metaGhostHeaders.opts.glyphWidth;V=e.explicitColumnWidths[n]?e.explicitColumnWidths[n]:e.columns[n].width;o=e.metaGhostHeaders.dataHeaders;for(r=0;r<o.length;r++){o[r].oldWidth=o[r].width;i+=o[r].width}O=V+i-a});e.$on("onExplicitColumnChanging",function(t){if(0===e.layout.qHyperCube.qNoOfLeftDims)return;var n=t.targetScope.column.index,i=e.metaGhostHeaders.leftColumns[n],o=0,r,a,s;e.changingColumnIndex=n;if(t.targetScope.explicitColumnWidth>O){t.targetScope.explicitColumnWidth=O;e.explicitColumnWidths[n]=O}if(1===e.metaGhostHeaders.leftColumns.length&&t.targetScope.explicitColumnWidth<70){t.targetScope.explicitColumnWidth=70;e.explicitColumnWidths[n]=70}if(e.metaGhostHeaders.leftColumns.length>1&&t.targetScope.explicitColumnWidth<40){t.targetScope.explicitColumnWidth=40;e.explicitColumnWidths[n]=40}for(s=0;s<i.length;s++)i[s].isCollapseExpandIcon&&(o+=i[s].width);i[i.length-1].width=e.explicitColumnWidths[n]-o;i[i.length-1].style.width=i[i.length-1].width+"px";r=e.metaGhostHeaders.dataHeaders;a=(e.explicitColumnWidths[n]-V)/r.length;for(s=0;s<r.length;s++){r[s].width=Math.max(r[s].oldWidth-a,r[s].minWidth);r[s].style.width=r[s].width+"px"}U(e)});e.$on("onExplicitColumnChanged",function(){e.metaGhostHeaders.update(0,i.getLeftTreeDepth(e.layout.qHyperCube.qPivotDataPages[0]),e.explicitColumnWidths);U(e);e.applyColumnWidthSoftPatch(e.explicitColumnWidths)});e.$on("$destroy",function(){$&&v.ThemeChanged.unbind($);P.cancel(f);P.cancel(T)});e.applyColumnWidthSoftPatch=function(t){var n=e.layout.qHyperCube,i=n.columnWidths?"replace":"add",o=n.qIndentMode?1:0,r=n.columnWidths,a=e.metaGhostHeaders.leftColumns?e.metaGhostHeaders.leftColumns.length:0,s,l;r&&Array.isArray(r[0])||(r=[[],[]]);if(o)r[0]=t;else{s=n.qEffectiveInterColumnSortOrder;for(l=0;l<a;l++)r[1][s[l]]=t[l]}var u=[{qPath:"/qHyperCubeDef/columnWidths",qOp:i.toString(),qValue:JSON.stringify(r)}];e.backendApi.applyPatches(u,true)};e.selections=q(e,e.selectionsApi,e.backendApi,e.grid,e.layout,d);e.virtualScroll=C(e.viewport,e.metaGhostHeaders.dataColumnsInfo,e.layout.qHyperCube.qSize);e.virtualScroll.onGetData(function(t){return e.getData(t,true).then(function(){P.cancel(f);f=P(function(){return e.virtualScroll.setScrollViewport()},100);return f}).catch(function(e){false})});e.getData=function(t,n){var i=g();e.backendApi.getData([t]).then(function(o){e.onUpdateData(o,t,n).then(function(){i.resolve()})}).catch(function(e){false});return i.promise};e.onUpdateData=function(t,n,o){i.updatePivotItems(e,t,[n],o);e.selections.updateSelections();return P(function(){},0,false)};e.onClick=function(e){t(e.target).closest(".cell-content").focus()};e.process=function(t){t&&e.virtualScroll.setPage(t);if(e.options.viewState){t.qLeft=e.options.viewState.page.qLeft;t.qTop=e.options.viewState.page.qTop;return e.getData(t)}return e.getData(e.virtualScroll.page).then(function(){e.virtualScroll.setVirtualSize();P.cancel(T);T=P(function(){U(e,true)},100);return T}).catch(function(e){false})};e.processPaint=function(){return e.updateMetaInfo().then(function(t){var n=e.layout.qHyperCube.qLastExpandedPos,i=n&&void 0!==e.expandedPosDiffX&&void 0!==e.expandedPosDiffY,o=e.viewport.getVisibleRowCount();var r={qLeft:Math.max(0,i?n.qx-e.expandedPosDiffX:0),qTop:Math.max(0,i?n.qy-e.expandedPosDiffY:0),qWidth:t.qWidth,qHeight:t.qHeight};n&&r.qLeft+r.qWidth>e.layout.qHyperCube.qSize.qcx&&(r.qLeft=Math.max(0,e.layout.qHyperCube.qSize.qcx-t.qWidth));n&&r.qTop+r.qHeight>=e.layout.qHyperCube.qSize.qcy&&(r.qTop=Math.max(0,e.layout.qHyperCube.qSize.qcy-t.qHeight));if(n&&e.collapsed&&r.qTop+o>e.layout.qHyperCube.qSize.qcy){e.viewport.collapsedRowCount=o;r.qTop=Math.max(0,e.layout.qHyperCube.qSize.qcy-o);r.qHeight=o}delete e.expandedPosDiffX;delete e.expandedPosDiffY;delete e.collapsed;return e.process(r)})};e.processResize=function(){return e.updateMetaInfo().then(function(t){var n=e.layout.qHyperCube.qSize,i={qLeft:e.virtualScroll.page.qLeft,qTop:e.virtualScroll.page.qTop,qWidth:t.qWidth,qHeight:t.qHeight};i.qTop+i.qHeight>n.qcy&&(i.qTop=Math.max(0,n.qcy-i.qHeight));i.qLeft+i.qWidth>n.qcx&&(i.qLeft=Math.max(0,n.qcx-i.qWidth));e.$emit("ngRepeatFinished");return e.process(i)})};u.setDirection=function(){e.viewport.direction=e.options.direction;e.rtl="rtl"===e.options.direction;e.processPaint()};u.getSelectionToolbar=function(){var t=[];A(e)||t.push({name:"Tooltip.clearSelection",tid:"selection-toolbar.clear",isIcon:true,buttonClass:"clear",iconClass:"lui-icon lui-icon--clear-selections",action:function e(){this.selectionsApi.clear()},isDisabled:function e(){return!this.selectionsApi.selectionsMade}});return new m(u.$scope.backendApi,u.$scope.selectionsApi,false,false,t,[])};e.updateMetaInfo=function(){return e.viewport.updateRect().then(function(){var t=e.metaGhostHeaders.explicitColumnWidths;e.metaGhostHeaders.update(0,i.getLeftTreeDepth(e.layout.qHyperCube.qPivotDataPages[0]),t);e.pivoting.update(e.metaGhostHeaders.dataColumnsInfo.cnt);U(e);return{qWidth:Math.max(1,e.metaGhostHeaders.dataColumnsInfo.cnt),qHeight:Math.max(1,e.viewport.rowCount)}})};e.collapseExpand=function(n){var i=t(n.target),o;o=i.scope().cell;if(!o)return;e.expandedPosDiffX=o.dataColIx-e.virtualScroll.page.qLeft;e.expandedPosDiffY=o.dataRowIx-e.virtualScroll.page.qTop;if("lui-icon--plus"===o.collapseExpandClass)o.hasClass("top")?e.backendApi.expandTop(o.dataRowIx,o.dataColIx,false):o.hasClass("left")&&e.backendApi.expandLeft(o.dataRowIx,o.dataColIx,false);else if("lui-icon--minus"===o.collapseExpandClass){e.collapsed=true;o.hasClass("top")?e.backendApi.collapseTop(o.dataRowIx,o.dataColIx,false):o.hasClass("left")&&e.backendApi.collapseLeft(o.dataRowIx,o.dataColIx,false)}};e.showDimension=function(n,i){var r=t(n.target).closest(".qv-pt-meta-button");d.off();if(e.currentPopover.header===i){i.open=false;e.currentPopover.header=void 0;o.close();_(e,d);return}if(e.currentPopover.header){e.currentPopover.header.open=false;e.currentPopover.header=void 0}x.isSmallDevice?M(k,i.fieldName,e,r,d):M(o,i.fieldName,e,r,d).then(function(n){var o;n.closing.then(function(n){if(n&&!t(n.target).closest(".qv-pt-meta-button").length>0){E(e,i);_(e,d)}o=n});n.closed.then(function(){if(!o){E(e,i);_(e,d)}n=null})});i.open=true;e.currentPopover.header=i};function Y(t,n,i){e.interactive=t&&n;e.navigatable=t&&i;if(t){if(i){c.on();d.on()}}else if(!t){c.off();d.off()}}u.setInteractionState=function(){var t=e.object.inAnalysisState(),n=false!==e.options.navigation,i=false!==e.options.selections;Y(t,i,n)};u.getContextMenu=function(n,i,o){if(o.target){var r=t(o.target).closest(".qv-pt");if(r){var a=o.target.innerText;a&&""!==a&&i.addItem({icon:"lui-icon lui-icon--copy",translation:"contextMenu.copyCellValue",tid:"copy-cell-context-item",select:function e(){D.copyToClipboard(a)}})}}var s=this.$scope.metaGhostHeaders,l=s.leftDimCnt-(s.pseudoInLeftTree?1:0),u=s.topDimCnt-(s.pseudoInTopTree?1:0);if(l>1||u>1)return n.model.getEffectiveProperties().then(function(t){if(t.qHyperCubeDef.qAlwaysFullyExpanded||n.viewDataToggled)return;var o=i.addItem({translation:"Object.PivotTable.ContextMenu.ExpandCollapse",tid:"expand-collapse-group"});o.addItem({icon:"lui-icon lui-icon--plus",translation:"Object.PivotTable.ContextMenu.ExpandAll",tid:"expand-all",select:function t(){e.backendApi.expandTop(0,0,true);e.backendApi.expandLeft(0,0,true)}});o.addItem({icon:"lui-icon lui-icon--minus",translation:"Object.PivotTable.ContextMenu.CollapseAll",tid:"collapse-all",select:function t(){e.backendApi.collapseTop(0,0,true);e.backendApi.collapseLeft(0,0,true)}})})};u.suppressOnPaint=function(e){if(this.$scope.object._forcePaint){this.$scope.object._forcePaint=false;return false}return b.isInSelection(e)};u.onPaint=function(){this.setInteractionState(e.options.interactionState);if(!this.suppressOnPaint(this.$scope.layout)&&void 0===this.$scope.currentPopover.header){d.cancel();b.isModalSelectionModel(this.$scope.object.model)&&this.$scope.selectionsApi.confirm();return e.processPaint()}this.$scope.currentPopover.header&&e.pivoting.update(e.metaGhostHeaders.dataColumnsInfo.cnt);return g.resolve()};u.onResize=function(){return e.processResize()};u.setSnapshotData=function(t){var n=e.virtualScroll.page;return e.backendApi.getData([n]).then(function(n){if(!e.backendApi.isSnapshot){n[0].qArea.qTop=0;n[0].qArea.qLeft=0}t.qHyperCube.qPivotDataPages=n;t.qHyperCube.qSize.qcx=n[0].qArea.qWidth;t.snapshotData.capturedOnDesktop=h.treatAsDesktop();return t}).catch(function(e){false})};u.getPreferredSize=function(){var e=g();var t=this.$scope.$on("ngRepeatFinished",function(){e.resolve({w:s.width(),h:s.find("table").height()+5});t()});return e.promise};u.getViewState=function(){var t=w.extend({},e.virtualScroll.page);return{page:t}}}return{restrict:"E",replace:true,template:s,require:"qvObjectContent",link:O}}e.directive("qvPivotTable",["qvDataGrid","qvGridObjectDataService","qvListboxPopoverService","qvPivotTablePivoting","qvPivotTableMetaGhostHeadersProvider","qvPivotTableViewportProvider","qvPivotTableVirtualScrollProvider","qvPivotTableSelectionsProvider","$timeout","qvListboxPopoverServiceMobile",P]);return{initialProperties:{qHyperCubeDef:{qDimensions:[],qMeasures:[],qSuppressMissing:true,qMode:"P",qShowTotalsAbove:true,qInitialDataFetch:[{qTop:0,qLeft:0,qWidth:50,qHeight:50}],qIndentMode:true,columnWidths:[]}},data:{dimensions:{min:1,max:1e3,description:function e(t,n,i){var o=i&&"rows"===i.type?"Visualizations.Descriptions.Row":"Visualizations.Descriptions.Column";return C.get(o)}},measures:{min:1,max:1e3,description:function e(){return C.get("Visualizations.Descriptions.Values")}}},getCreatePropertyHandler:function e(t){var n=a.mapProperties(this.mappedDefinition.items.data.items.dimensions);var i=a.mapProperties(this.mappedDefinition.items.data.items.measures);return new o({app:t,dimensionDefinition:this.dimensionDefinition,measureDefinition:this.measureDefinition,dimensionProperties:n,measureProperties:i})},support:{cssScaling:true,snapshot:true,export:true,exportData:true,sharing:false,viewData:true},migrate:{properties:function e(t){return y.migrateProperties(t)}},type:"pivot-table",template:"<qv-pivot-table></qv-pivot-table>",BackendApi:n,definition:i,importProperties:r.importProperties,exportProperties:r.exportProperties}}.apply(t,i),void 0!==o&&(e.exports=o))},1058:function(e,t,n){"use strict";var i,o;!(i=[n(125)],o=function(e){function t(e){var t=e.qDimensions;function i(){var n=[];for(var i=0;i<t.length;i++)n.push(i);var o=e.qMeasures.length>=2;o&&n.push(-1);return n}n(t,e.qInterColumnSortOrder)&&(e.qInterColumnSortOrder=i())}function n(e,t){var n={},i=[],o=false,r=-1!==t.indexOf(-1);t.forEach(function(e){n[e]?o=true:n[e]=true});o=r?o||e.length+1!==Object.keys(n).length:o||e.length!==Object.keys(n).length;Object.keys(n).forEach(function(e){"-1"!==e&&i.push(parseInt(e,10))});i=i.sort(function(e,t){return e-t});for(var a=0;a<i.length;++a)o=o||i[a]!==a;return o}function i(e){return e&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1])}function o(n){t(n);var i=n.qDimensions,o=n.qInterColumnSortOrder,r;r=o.filter(function(e){return-1!==e});function a(){for(var t=0;t<r.length;t++)if(-1!==r[t]&&r[t]!==t){var n=r[t];var a=r.indexOf(t);var s=r[a];e.swap(r,t,a);e.swap(i,t,a);e.swap(o,o.indexOf(n),o.indexOf(s))}}a()}function r(e,t){var n=e.qDimensions,i=e.qInterColumnSortOrder,o=[];var r=t.indexOf(-1);t.forEach(function(e){-1!==e&&o.push(n[e])});o.forEach(function(e,t){n[t]=e});i.splice(0,i.length);for(var s=0;s<o.length;s++)i.push(s);r>-1&&i.splice(r,0,-1);a(e,t)}function a(e,t){if(!i(e.columnWidths))return;var n=e.columnWidths[1],o=[];t.forEach(function(e){-1!==e&&o.push(n[e])});o.forEach(function(e,t){n[t]=e})}function s(e,t){var n=e.qMeasures,i=[];t.forEach(function(e){i.push(n[e])});n.splice(0,n.length);i.forEach(function(e){n.push(e)})}function l(e,t,n,i){var o=i.qInterColumnSortOrder.slice();var r=i.qNoOfLeftDims;var a=o.indexOf(e)<=r-1;var s=o.indexOf(e);o.splice(s,1);var l=t.concat(n);var u=l.indexOf(e);var c;var d;var p=t[0]===e&&1===t.length;var f=n[0]===e&&1===n.length;if(p||f)c=r-(a?1:0);else if(u>0){d=l[u-1];c=o.indexOf(d)+1}else{d=l[0];c=Math.max(0,o.indexOf(d)-1)}o.splice(c,0,e);return o}function u(e,t,n,i){var o=n.qEffectiveInterColumnSortOrder;var r=n.qNoOfLeftDims;var a=i.qNoOfLeftDims;var s=o.indexOf(e)<=r-1;var l=-1!==t.indexOf(e);if(l&&!s)return a+1;if(!l&&s)return a-1;return a}return{validatePivotHyperCube:t,fixPivotHypercubeOrders:o,reorderPivotDimensions:r,reorderMeasures:s,isInvalidOrderArray:n,isValidColumnWidths:i,reorderColumnOrderDef:l,getNoLeftDimsDef:u}}.apply(t,i),void 0!==o&&(e.exports=o))},1059:function(e,t,n){"use strict";var i,o;!(i=[n(11),n(10),n(48),n(91),n(89),n(299),n(1629),n(1630),n(205),n(189),n(125),n(1631),n(1632),n(243),n(164),n(1263),n(104),n(100),n(113),n(142),n(50),n(101),n(1633),n(99),n(1264),n(986),n(424),n(167),n(90),n(393),n(1003),n(1634),n(1265),n(1636),n(1638),n(1640),n(1642),n(1644),n(1325),n(1653),n(1266),n(290),n(289)],o=function(e,t,n,i,o,r,a,s,l,u,c,d,p,f,h,g,m,v,b,x,y,C,q,D,w,I,S,L,E,M){var _,A;var P=23;var k=13;function T(e,t){e.tableStyles={header:{"font-size":t.getStyle("header","fontSize"),color:t.getStyle("header","color")},content:{"font-size":t.getStyle("content","fontSize"),color:t.getStyle("content","color")}};if(e.scrollApi){e.scrollApi.settings.minRowHeight=O(e);e.scrollApi.settings.maxRowHeight=3*O(e)}}function O(e){var t=parseInt(e.tableStyles.content["font-size"]);var n=t?P*(t/k):P;return n||P}function V(e,t,n,i){var o=null;n.layout&&n.layout.qStateName&&(o={qStateName:n.layout.qStateName});return e.showField(t,n.backendApi.model.app,{$alignToElement:i,qvaOutsideIgnoreFor:"qv-st-header-cell-search-"+n.$id,collision:"flipfit",direction:n.options.direction},o,function(){n.currentHeaderSearch&&(n.currentHeaderSearch.open=false);n.currentHeaderSearch=null})}function H(e,t,n){return e<t.length?t[e]:n[e-t.length]}A=f.extend({init:function e(t){this.visualizationCtrl=t},getRows:function e(){return this.visualizationCtrl.getRows()},getRowCount:function e(){return this.visualizationCtrl.getRowCount()},getFirstElementIndex:function e(){return this.visualizationCtrl.getFirstElementIndex()},getLastElementIndex:function e(){return this.visualizationCtrl.getLastElementIndex()},onVirtualScroll:function e(t,n,i,o,r,a){return this.visualizationCtrl.onVirtualScroll(t,n,i,o,r,a)},onInitialNativeScroll:function e(t,n){return this.visualizationCtrl.onInitialNativeScroll(t,n)},onGotoNextBlock:function e(t,n){return this.visualizationCtrl.onGotoNextBlock(t,n)},onGotoPreviousBlock:function e(t,n){return this.visualizationCtrl.onGotoPreviousBlock(t,n)}});function R(e,t,n,i){var o=e.getCellsInColumn(t,"data",n);o.forEach(function(e){e.hidden=i})}_=l.extend({init:function e(t,n,i,o,r){this.appliedSoftPatch=false;this._paintWatches=[];this._resizeWatches=[];this.$element=n;this.dataService=o;this.selectionService=r;this.$timeout=i;this.metaHeaders=[];this._super.apply(this,arguments);this._pendingUpdate=null;t.backendApi.setCacheOptions({width:1});t.options.navigation=false!==t.options.navigation;t.interactive=false;t.linksInteractive=false;t.isLoadPrevVisible=false;t.direction=t.options.direction;t.rtl="rtl"===t.options.direction;t.watchResize=this.watchResize.bind(this);this.styleService=v.initializeService("object.straightTable");var a=this;T(this.$scope,this.styleService);t.themeChangedCallback=function(){T(a.$scope,a.styleService)};v.ThemeChanged.bind(t.themeChangedCallback);var s=t.layout.qHyperCube;w.updatePropertiesOnRefresh(t.backendApi,s);this.attachColumnResizeEvents(t);this.attachColumnReorderEvents(t)},attachColumnResizeEvents:function e(t){var n=null;t.$on("onExplicitColumnChanged",function(){n=null;this.metaHeaders.filter(function(e){return!e.isSearchIcon&&!e.isFillColumn}).forEach(function(e,n){t.explicitColumnWidths[e.dataColIx]=t.visibleExplicitColumnWidths[n]});t.applyColumnWidthSoftPatch(false,t.explicitColumnWidths)}.bind(this));t.$on("onExplicitColumnChanging",function(){n||(n={initialTableWidth:this.$scope.appliedTableWidth});this.metaHeaders.filter(function(e){return!e.isSearchIcon&&!e.isFillColumn}).forEach(function(e,n){t.explicitColumnWidths[e.dataColIx]=t.visibleExplicitColumnWidths[n]});this.metaHeaders=this.dataService.getStraightMetaHeaders(t.layout,t.explicitColumnWidths,t.scrollApi.settings,t.$id,this.metaHeaders,this.$scope.options.customHeader);this.$scope.scrollApi.updateMetaHeaders(this.metaHeaders,{lockScrollPosition:true});this.$scope.scrollApi.updateVirtualViewport();this.metaHeaders.filter(function(e){return e.isFillColumn}).forEach(function(e){e.style.width="auto"});this.updateColumnInfo(this.metaHeaders);this.applyTableWidth(Math.max(n.initialTableWidth+10,this.getTableWidth()))}.bind(this))},attachColumnReorderEvents:function e(t){var n=null;var i=null;t.$on("onStopReorderingColumns",function(){n=null;i=null;t.reorderingColumn=void 0;t.$digest()});t.$on("onStartReorderingColumns",function(e,o){n=this.$scope.layout.qHyperCube.qColumnOrder;i=this.metaHeaders.reduce(function(e,t){t.isFillColumn||(t.isSearchIcon?e.length>0&&(e[e.length-1].width+=t.calculatedWidth):e.push({dataColIx:t.dataColIx,width:t.calculatedWidth}));return e},[]);t.reorderingColumn=i.filter(function(e){return e.dataColIx===o.dataColIx})[0];t.$digest()}.bind(this));t.$on("onReorderingColumns",function(e,o){if(!n||!t.reorderingColumn)return;var r=t.reorderingColumn;var a=0,s=0;var l=r.width/2;var u=o.offset+l;var c,d,p;for(c=0;c<i.length;++c){if(i[c].dataColIx===r.dataColIx)continue;d=s+l;p=s+i[c].width+l;if(Math.abs(d-u)<Math.abs(p-u))break;a+=1;s+=i[c].width}var f=i.indexOf(r);var h,g,m;if(f!==a){h=i.map(function(e){return n.indexOf(e.dataColIx)});g=h.slice();g.splice(a,0,g.splice(f,1)[0]);i.splice(a,0,i.splice(f,1)[0]);m=n.slice();g.forEach(function(e,t){m[h[t]]=n[e]});n=m;t.applyColumnOrderSoftPatch("replace",n)}})},setDirection:function e(t){this._super(t);this.$scope.direction=this.$scope.options.direction;this.$scope.rtl="rtl"===this.$scope.options.direction;this.$scope.scrollApi.setDirection(this.$scope.direction);this.processResize()},watchPaint:function e(t){var n=this;n._paintWatches.push(t);return function(){var e=n._paintWatches.indexOf(t);n._paintWatches.splice(e,1)}},watchResize:function e(t){var n=this;n._resizeWatches.push(t);return function(){var e=n._resizeWatches.indexOf(t);n._resizeWatches.splice(e,1)}},suppressOnPaint:function e(t){if(this.$scope.object._forcePaint){this.$scope.object._forcePaint=false;return false}return x.isInSelection(t)},_restrictColumnsToSnapshotData:function e(t){if(t.snapshotData){var n=t.snapshotData.object.origDataPages||t.qHyperCube.qDataPages;var i=this.dataService.columnOrder.getVisible(t.qHyperCube);var o=n.filter(function(e){return e&&e.qArea});var r=o.map(function(e){return i[e.qArea.qLeft]});this.metaHeaders=this.metaHeaders.filter(function(e){return e.isFillColumn||r.indexOf(e.dataColIx)>-1})}},update:function e(t,n,i,o,r){var a,s,l=this;if(this.$scope.options.viewState){t=this.$scope.options.viewState.qTop;s=this.$scope.options.viewState.qLeft}if(!r){var u=this.$scope.layout.qHyperCube.columnWidths.map(function(e){return"number"===typeof e?e:-1});this.$scope.explicitColumnWidths=u;this.metaHeaders=this.dataService.getStraightMetaHeaders(this.$scope.layout,this.$scope.explicitColumnWidths,this.$scope.scrollApi.settings,this.$scope.$id,this.metaHeaders,this.$scope.options.customHeader);this._restrictColumnsToSnapshotData(this.$scope.layout);this.$scope.scrollApi.updateMetaHeaders(this.metaHeaders,{},s);this.$scope.visibleExplicitColumnWidths=this.metaHeaders.filter(function(e){return!e.isSearchIcon&&!e.isFillColumn}).map(function(e){return u[e.dataColIx]})}a=this.getDataInfo(t,n,this.metaHeaders,this.$scope.layout);this._pendingUpdate=this.$scope.backendApi.getData(a.rects).then(function(e){var t={dataPages:e,dataInfo:a};return l.onUpdateData(t,i,o,r).then(function(){var t;if(l.$scope.hasFocus()||l.$scope.focus&&l.$scope.focus.forceRealign){t=l.$scope.focus;l.$scope.focus=l.$scope.navService.realignFocus(l.$scope.grid,l.$scope.focus,l.$scope.scrollApi);t&&t.cell&&"function"===typeof t.cell.blur&&t.cell.blur();if(l.$scope&&l.$scope.focus){l.$scope.focus.cell&&l.$scope.focus.cell.focus();l.$scope.focus.forceRealign=false}}return e}).finally(function(){l._pendingUpdate=null})});return this._pendingUpdate},whenUpdated:function e(){if(this._pendingUpdate)return this._pendingUpdate;return o.resolve()},updateLocked:function e(t){var n=this.dataService,i=this.selectionService,o=this.$scope.selections,r=o.activationCell,a,s,l,u=[],c,d,p,f;if(!r)return;a=t.getRowsByCellType(t.CELL_TYPE_DATA);d=n.getSiblingCells(t,r);s=a.length;for(f=0;f<s;++f)u=u.concat(a[f].cells);c=u.length;for(f=0;f<c;++f){l=u[f];p=-1!==d.indexOf(l);p&&!l.isDimensionValue||!p&&!l.isMeta?i[r&&o.active?"lockCell":"unlockCell"](t,l):i[r&&o.active?"removeCellStyle":"restoreCellStyle"](l)}},getDataInfo:function e(t,n,i,o){var r=this.dataService.columnOrder.getVisible(o.qHyperCube);var a,s,l=i.length,u=[];for(a=0;a<l;++a){s=i[a];if(s.isSearchIcon||s.isFillColumn)continue;u.push({qLeft:w.getLeftOfDataArea(s,r.indexOf(s.dataColIx),o),qTop:t||0,qWidth:1,qHeight:n})}u.length||u.push({qTop:0,qLeft:0,qWidth:0,qHeight:0});return{rects:u,metaHeaders:i}},updateColumnInfo:function e(t){var n=this.$scope;n.columns||(n.columns=[]);var i,o=0,r,a,s=0;for(a=0,r=t.length;a<r;a++){i=t[a];R(this.dataService,n.grid,i.dataColIx,i.shouldBeRemoved);if(i.isFillColumn)continue;if(i.isDimension){this.$scope.options.customHeader?o+=a>0?i.calculatedWidth+1:i.calculatedWidth:o+=i.calculatedWidth+t[a+1].calculatedWidth;a++}else o+=i.calculatedWidth;n.columns[s]||(n.columns[s]={});n.columns[s].width=i.calculatedWidth;n.columns[s].left=n.rtl?-o:o;n.columns[s].hidden=i.shouldBeRemoved;s++}},getTableWidth:function e(){var t=this.$scope.scrollApi.settings;var n=t.horizontalScroll.enabled?t.width:t.width-t.columnPicker.width;return Math.max(n,this.$scope.columns.map(function(e){return e.width}).reduce(function(e,t){return e+t},0))},applyTableWidth:function e(t){this.$scope.tableStyles=this.$scope.tableStyles||{header:{},content:{}};this.$scope.tableStyles.header.width=t+"px";this.$scope.tableStyles.content.width=t+"px";this.$scope.appliedTableWidth=t},onUpdateData:function e(t,n,i,o){i&&t.dataPages.forEach(function(e){e.qMatrix.reverse()});this.dataService.updateStraightItems(this.$scope,t.dataPages,t.dataInfo.metaHeaders,n,i,o);this.$scope.columns=[];this.updateColumnInfo(t.dataInfo.metaHeaders);this.applyTableWidth(this.getTableWidth());this.$scope.scrollApi.updateHorizontalScroll();i&&this.$scope.grid.rows.reverse();if(this.$scope.selections.active){this.selectionService.updateStraight(this.$scope.grid,this.$scope.selections,this.$scope.selections.activationCell);this.updateLocked(this.$scope.grid)}return this.$timeout(function(){},0,false)},getColumnIndexNativeScrolling:function e(t){var n=0;var i=this.$scope.scrollApi.domApi.getNativeScrollOffsetLeft();for(var o=0;o<t.length;o++){i-=t[o].calculatedWidth||t[o].left;if(!(i>0))break;n++}t[n].isSearchIcon&&n--;return n},setSnapshotData:function e(t){var n,i,o=!!t.sourceObjectId,r=this.$scope,a=r.scrollApi.domApi,s=a.getScrollAreaBoundingBox(),l=t.qHyperCube;o||(l.qColumnOrder=this.$scope.layout.qHyperCube.qColumnOrder);l.columnOrder=l.qColumnOrder;var u=a.$scrollArea.find(".qv-st-data-row");n=d.getIndexHeightAndWidth(u,l.qColumnOrder.length,s,t.totals&&t.totals.show);if(this.$scope.scrollApi.settings.horizontalScroll.useNativeScroll){var c=this.metaHeaders.slice(this.getColumnIndexNativeScrolling(this.metaHeaders));i=this.getDataInfo(n.index,n.height,c,this.$scope.layout)}else i=this.getDataInfo(n.index,n.height,this.metaHeaders,this.$scope.layout);return r.backendApi.getData(i.rects).then(function(e){t.qHyperCube.qDataPages=e;return t})},getViewState:function e(){var t,n;if(this.$scope.scrollApi.settings.horizontalScroll.useNativeScroll){var i=this.$scope.scrollApi.domApi.getScrollAreaBoundingBox();var o=this.$scope.scrollApi.domApi.$scrollArea.find(".qv-st-data-row");var r=d.getIndexHeightAndWidth(o,this.$scope.layout.qHyperCube.qColumnOrder.length,i,true);t=r.index;n=this.getColumnIndexNativeScrolling(this.$scope.columns)}else{var a=this.$scope.grid.rows.length;t=a?this.$scope.grid.rows[0].getIndex():0;var s=this.getDataInfo(t,a,this.metaHeaders,this.$scope.layout);n=s.rects[0].qLeft}return{qTop:t,qLeft:n}},process:function(e){function t(t,n,i){return e.apply(this,arguments)}t.toString=function(){return e.toString()};return t}(function(e,t,n){return this.update(e,t,false,false,false).then(function(){if(this.$scope.layout.qHyperCube){var e=this.$scope.scrollApi.settings.horizontalScroll.enabled;var t=e?this.$scope.layout.qHyperCube.qSize.qcx:this.$scope.scrollApi.getVisibleColumnCount();this.$scope.scrollApi.setTotalRows(this.$scope.layout.qHyperCube.qSize.qcy);this.$scope.scrollApi.setTotalColumns(t);return this.$scope.scrollApi.setVirtualSize(n)}}.bind(this)).catch(function(e){false})}),processPaint:function e(){this.$scope.scrollApi.updateViewport();var t=0,n=this.$scope.scrollApi.settings.viewportRowCount,i;i=this.$scope.scrollApi.resetNativeScroll();return this.process(t,n,false).then(function(){i()}).catch(function(e){false})},processResize:function e(){var t=this.$scope.grid.rows.length,n=t?this.$scope.grid.rows[0].getIndex():0,i=this.$scope.scrollApi.settings.viewportRowCount,o;if(this.$scope.scrollApi.totalRows&&n+i>this.$scope.scrollApi.totalRows){o=Math.min(n,n+i-this.$scope.scrollApi.totalRows);n-=o}i<t&&(i=t);return this.process(n,i,true)},onVirtualScroll:function e(t,n,i,o,r){this.$scope.options.externalInterface&&this.$scope.options.externalInterface.straightTableId&&this.$scope.$broadcast("straight-table-virtual-scroll",{id:this.$scope.options.externalInterface.straightTableId,grid:this.$scope.grid,headers:this.metaHeaders,scrollApi:this.$scope.scrollApi});return this.update(t,n,false,false,0===r)},gotoBlock:function e(t,n,i){var o=this.$scope.scrollApi.getSpliceArgs(),r=this.$scope.grid.rows,a=this.$scope.grid.getNextRowIx();i&&r.reverse();r.splice.apply(r,o);a-=o[1];this.$scope.grid.setNextRowIx(a);return this.update(t,n,true,i,true)},onGotoNextBlock:function e(t,n){return this.gotoBlock(t,n,false)},onGotoPreviousBlock:function e(t,n){return this.gotoBlock(t,n,true)},getRows:function e(){return this.$scope.grid.rows},getRowCount:function e(){return this.$scope.grid.rows.length},getFirstElementIndex:function e(){return this.$scope.grid.rows[0].getIndex()},getLastElementIndex:function e(){return this.$scope.grid.rows[this.$scope.grid.rows.length-1].getIndex()},getPreferredSize:function e(){var t=o(),n=function(){return this.$element.find(".qv-st-data")[0].offsetHeight}.bind(this);var i=this.$scope.$watch(n,function(e){if(e&&e>0){var n=this.$element.find(".qv-st-header")[0].offsetHeight,o=this.$element.find(".qv-st-bottom-header")[0].offsetHeight;t.resolve({w:this.$element.width(),h:e+n+o});i()}}.bind(this));return t.promise}});_.$inject=["$scope","$element","$timeout","qvGridObjectDataService","qvGridObjectSelectionService"];function $(e){var t=D.treatAsDesktop(),n=C.getValue(e,"layout.scrolling.horizontal",true),i={enabled:e.options.useHorizontalScroll||b.ST_HSCROLL&&n,useNativeScroll:e.options.useHorizontalScroll&&!e.options.virtualHorizontalScroll,useVirtualScroll:e.options.virtualHorizontalScroll||b.ST_HSCROLL&&!e.options.useHorizontalScroll,keepFirstColumnInView:e.options.keepFirstColumnInView||e.layout.scrolling&&e.layout.scrolling.keepFirstColumnInView};if(!t&&i.enabled){i.useNativeScroll=true;i.useVirtualScroll=false}return i}function F(e,t){e&&e[t]&&""===e[t].qExpression&&""===e[t].qLibraryId&&e.splice(t,1)}function N(e){var t=e.qAttributeExpressions;F(t,1);F(t,0)}n.directive("qvStraightTable",["$timeout","qvGridObjectDataService","qvGridObjectSelectionService","qvGridKeyboardNavigationService","qvListboxPopoverService","qvListboxPopoverServiceMobile","$window",function(n,r,a,l,u,d,f){return{restrict:"E",replace:true,template:s,require:"qvObjectContent",link:function s(D,w,I,_){var P=w.find(".qv-grid-object-scroll-area"),k=P.controller("qvScrollArea"),T=w.find(".qv-scroll-loader:not(.qv-scroll-row-loader)").controller("qvScrollLoader"),R=P.find(".qv-scroll-row-loader").controller("qvScrollLoader"),F="."+D.id+"-straight-table",N,z,B,W={alignToBottom:"reduce",minRowHeight:O(D),maxRowHeight:3*O(D),columnCount:0,horizontalScroll:$(D),useAllSpace:D.options.useAllSpace,column:{glyphWidth:8,paddingWidth:14,minSearchWidth:D.options.customHeader?1:35,minColWidth:D.options.minColumnWidth||34,maxColWidth:384},columnPicker:{show:false,width:21},blockSize:50},G=new q(n,W),j=new A(_);D.scrollApi=G;var U=p.create(D,w,P,G.settings);D.grid=new g("straight");D.selections=a.$new();D.objectId=D.layout.qInfo.qId;D.getSRLabelForTotals=function(e){var t=C.getValue(D,"layout.totals.label")||i.get("Object.Table.Totals");return e.isNumeric||"Â "===e.text?e.isNumeric?t+" "+e.text:i.get("Object.Table.Totals.NotApplicable"):e.text};D.TABLE_AREA=l.TABLE_AREA;D.navService=l;function Y(){D.focus?D.focus=l.realignFocus(D.grid,D.focus,D.scrollApi):D.focus=l.init(D.grid);D.focus.cell.focus()}D.setFocus=Y;D.object.setOnFocusHandler(Y);var K;function X(e){z.text("");n.cancel(K);K=n(function(){z.text(i.get(e))},100)}D.onClick=function(e){var n=t.element(e.target).scope();var i=n.cell||n.header;var o=n.area;i&&D.selections.active&&i.dataColIx!==D.selections.currentDataColIx&&D.selectionsApi.confirm();if(i&&o){D.focus={area:o,cell:i};i.focus()}};D.handleKeyUp=function(e){if(e.which===L.ENTER&&D.preventEnterKeyUpBubbling){e.originalEvent.stopPropagation();e.preventDefault()}if(event.which===L.SHIFT&&D.selections.active){B=void 0;D.multiselect()}D.preventEnterKeyUpBubbling=false};D.hasFocus=function(){return w[0].contains(document.activeElement)};D.handleKeyDown=function(e){var n;var o;z=z||w.find("#st-cell-selection-status-label-"+D.objectId);n=t.element(e.target).scope();o=n.cell||n.header;if(e.which===L.ESCAPE){if(!D.selections.active&&"function"===typeof D.object.blur){D.object.blur();e.preventDefault();e.stopPropagation();return}X("Accessibility.Table.SelectionsCanceled")}var r=function t(n,i){if(n.isNullValue||!n.isDimensionValue||e.which===L.ENTER&&D.selections.active){if(e.which===L.ENTER&&D.selections.active){D.focus.forceRealign=true;X("Accessibility.Table.SelectionsConfirmed")}}else{var o=D.selections.active,r=a.isSelected(D.selections,n),s=!r||i?"Accessibility.Table.ValueSelected":"Accessibility.Table.ValueDeselected";X(s);if(i){o||D.activateSelections(B);D.multiselectDimensionValues(B,n,n.dataColIx)}else D.selectDimensionValue(n,e);if(!o){X("Accessibility.Table.SelectionMode");D.preventEnterKeyUpBubbling=true}}};var s=function t(){var s={cell:o,area:n.area};try{var u,c=D.interactive&&e.shiftKey&&(e.which===L.ARROW_UP||e.which===L.ARROW_DOWN);if(D.selections.active){u=l.moveFocusWhileSelecting(D.grid,e.which,s,G);if(!c){var d=a.isSelected(D.selections,u.cell)?i.get("Accessibility.Table.SelectedStatusTrue"):i.get("Accessibility.Table.SelectedStatusFalse");X(d)}}else u=l.moveFocus(D.grid,e.which,s,D.rtl,G);if(!u.deferFocus){if(c){B||(B=E.extend({},o));_.whenUpdated().then(function(){r(u.cell,true)})}u.cell.focus()}D.focus=u;e.stopPropagation();e.preventDefault()}catch(e){}};switch(e.which){case L.TAB:D.selections.active&&D.selectionsApi.confirm();break;case L.ENTER:case L.SPACE:e.stopImmediatePropagation();e.preventDefault();e.originalEvent.repeat||(D.interactive&&n.cell?r(o,false):D.navigatable&&n.header&&!o.isSearchIcon&&!o.isTotal&&D.sort(o));break;case L.ARROW_LEFT:case L.ARROW_RIGHT:case L.ARROW_UP:case L.ARROW_DOWN:case L.PAGE_UP:case L.PAGE_DOWN:case L.HOME:case L.END:s();break}};b.ST_HSCROLL?D.multiline={wrapTextInHeaders:!D.layout.multiline||D.layout.multiline.wrapTextInHeaders,wrapTextInCells:!D.layout.multiline||D.layout.multiline.wrapTextInCells}:D.multiline={wrapTextInHeaders:true,wrapTextInCells:true};D.$on("$destroy",function(){G.destroy();w.off(F);D.themeChangedCallback&&v.ThemeChanged.unbind(D.themeChangedCallback)});w.on("contextmenu"+F,function(e){D.selections.active&&e.preventDefault()});w.on("focusout"+F,function(e){if(null===e.target.getAttribute("tabIndex"))return;var n=t.element(e.target).scope();var i=n.cell||n.header;i&&i.blur()});function J(e){G.lockHorizontalScrollPosition(e)}function Z(e,t){S.begin();return _[e]().then(function(){t.forEach(function(e){e()})}).catch(function(){}).finally(S.end)}function Q(e,t){var n=w.find(e),i,o,r;if(n.length){i=n[0].getBoundingClientRect();o=new m(t.left,t.top,t.width,t.height);r=new m(i.left,i.top,i.width,i.height);return r.intersectsWith(o)}return false}var ee=G.initialize(U,j,k,T,_).then(function(){G.setDirection(D.direction);_.setInteractionState=function(){var e=D.object.inAnalysisState(),t=e&&false!==D.options.navigation,n=e&&false!==D.options.selections;D.interactive=n;D.linksInteractive=e&&(D.options.navigation||D.options.limitedInteraction);if(t&&!D.navigatable){D.navigatable=true;D.scrollApi.activate()}else if(!t&&D.navigatable){D.navigatable=false;D.scrollApi.deactivate()}e||(D.isLoadPrevVisible=Q(".qv-st-load-prev",G.domApi.getScrollAreaBoundingBox()))};_.getContextMenu=function(t,n,i){if(i.target){var o=e(i.target).closest(".qv-st");if(o){var r=i.target.innerText;r&&""!==r&&n.addItem({icon:"lui-icon lui-icon--copy",translation:"contextMenu.copyCellValue",tid:"copy-cell-context-item",select:function e(){M.copyToClipboard(r)}})}}};_.onPaint=function(){if(this.suppressOnPaint(D.layout))return o.resolve();x.isModalSelectionModel(D.object.model)&&D.selectionsApi.confirm();if(b.ST_HSCROLL){var e=true;D.layout.scrolling&&(e=void 0===D.layout.scrolling.horizontal||D.layout.scrolling.horizontal);if(e!==G.settings.horizontalScroll.enabled){G.settings.horizontalScroll=$(D);var t=p.create(D,w,P,G.settings);G.initialize(t,j,k,T,_)}if(D.layout.scrolling&&D.layout.scrolling.keepFirstColumnInView!==G.settings.horizontalScroll.keepFirstColumnInView){G.settings.horizontalScroll.keepFirstColumnInView=D.layout.scrolling.keepFirstColumnInView;D.scrollApi.updateViewport()}if(D.layout.multiline&&(D.layout.multiline.wrapTextInHeaders!==D.multiline.wrapTextInHeaders||D.layout.multiline.wrapTextInCells!==D.multiline.wrapTextInCells)){D.multiline.wrapTextInHeaders=D.layout.multiline.wrapTextInHeaders;D.multiline.wrapTextInCells=D.layout.multiline.wrapTextInCells;D.scrollApi.updateViewport()}}return Z("processPaint",_._paintWatches)};_.onResize=function(){D.scrollApi.updateViewport();return Z("processResize",_._resizeWatches)};_.onInitialNativeScroll=function(e,t){return R.fadeIn(0,0,{width:"100%",height:"30px"}).then(function(){return _.update(e,t,true,false,true).then(function(){return R.fadeOut()})})};_.setInteractionState(D.options.interactionState)});_.onInit=function(){return ee};D.applyColumnOrderSoftPatch=function(e,t){var n=e?"add":"replace";var i=[{qPath:"/qHyperCubeDef/qColumnOrder",qOp:n.toString(),qValue:JSON.stringify(t)}];D.backendApi.applyPatches(i,true)};D.options.externalInterface&&(D.options.externalInterface.forceRedraw=function(){_.onPaint()});function te(){_.updateLocked(D.grid);N&&N();J(false)}D.applyColumnWidthSoftPatch=function(e,t){var n=e?"add":"replace";var i=t.map(function(e){return void 0===e||null===e?-1:e});var o=[{qPath:"/qHyperCubeDef/columnWidths",qOp:n.toString(),qValue:JSON.stringify(i)}];D.backendApi.applyPatches(o,true);D._columnWidthsExistsInLayout=true};function ne(){r.getSiblingCells(D.grid,D.selections.activationCell).forEach(function(e){a.deselectCell(D.grid,e)});_.updateLocked(D.grid);N&&N();J(false)}function ie(){if(!D.selections.active||!D.selections.activationCell)return;r.getSiblingCells(D.grid,D.selections.activationCell).forEach(function(e){a.deselectCell(D.grid,e)});_.updateLocked(D.grid)}function oe(){D.object.selectionsClass="";_.updateLocked(D.grid);J(true)}function re(e,t){return C.getValue(e,"layout.qHyperCube.qDimensionInfo."+t+".qIsOneAndOnlyOne",false)}a.init(D.selectionsApi,D.backendApi,D.selections,te,ne,ie);var ae=D.selectionsApi.ignoreOnOutside;D.selectionsApi.ignoreOnOutside=function(e){if(e.closest(".qv-st-dim-columns").length)return true;if(ae(e)||e.closest(".qv-st-selections-active").length)return true};D.selectionsApi.getMenuMaxHeight=function(){return w.outerHeight()};D.selectWhileLocked=function(){h.showLockedFeedback(D.layout.qHyperCube.qDimensionInfo)};D.selectDimensionValue=function(t,n){D.scrollApi.updateViewport();D.scrollApi.scrollColumnInView(t.dataColIx,_.metaHeaders);if(t.representation===t.REPRESENTATION_URL&&e(n.target).is("a"))return;var i=t.type,o=t.dataRowIx,s=t.dataColIx;if(re(D,s)||!D.selectionsApi.getKeyAsToggleSelected(n)){ie();a.reset(D.selections)}function l(){var e=r.getCellsInRow(D.grid,i,o).filter(function(e){return e.dataColIx===s})[0];if(!e)return;N=a.selectDimensionValue(D.$id,D.backendApi,D.selectionsApi,D.selections,e,D.grid,true);var t=D.selectionsApi.watchActivated(function(){oe();t()})}_.whenUpdated().then(l)};D.activateSelections=function(e){D.scrollApi.updateViewport();N=a.activateSelections(D.$id,D.backendApi,D.selectionsApi,D.selections,e);var t=D.selectionsApi.watchActivated(function(){oe();t()})};D.multiselectDimensionValues=function(e,t){var n,i=r.getSiblingCells(D.grid,e),o=e.dataRowIx-e.rowIx,s=t.dataRowIx-t.rowIx,l=e.rowIx,u=t.rowIx;l+=o-s;l=Math.max(l,0);l=Math.min(l,i.length-1);function c(e){var t=i[e];t&&t.isDimensionValue&&a.selectDimensionCells(D.backendApi,D.selectionsApi,D.selections,D.grid,t,false)}if(l<=u)for(n=l;n<=u;++n)c(n);else if(l>u)for(n=l;n>=u;--n)c(n)};D.multiselect=function(){D.selections.active&&a.sendSelection(D.backendApi,D.selectionsApi,D.selections,D.grid,D.selections.currentCell)};D.sort=function(e){if(!e)return;D.scrollApi.updateViewport();var t=e.dataColIx,n=[].concat(D.layout.qHyperCube.qEffectiveInterColumnSortOrder),i=n[0],o="",r,a,s,l=D.layout.qHyperCube;if(t!==i){s=n.indexOf(t);c.move(n,s,0)}var u=[{qPath:"/qHyperCubeDef/qInterColumnSortOrder",qOp:"replace",qValue:"["+n.join(",")+"]"}];if(t===i){o=e.isDimension?"/qHyperCubeDef/qDimensions/":"/qHyperCubeDef/qMeasures/";r=H(t,l.qDimensionInfo,l.qMeasureInfo);e.reversed=!r.qReverseSort;a=e.isDimension?t:t-D.layout.qHyperCube.qDimensionInfo.length;o+=a+"/qDef/qReverseSort";u.push({qPath:o,qOp:"replace",qValue:e.reversed.toString()})}D.backendApi.applyPatches(u,true)};D.currentHeaderSearch=null;D.search=function(t,n){if(D.currentHeaderSearch===n){n.open=false;D.currentHeaderSearch=null;y.isSmallDevice?d.close():u.close();return}if(D.currentHeaderSearch){D.currentHeaderSearch.open=false;D.currentHeaderSearch=null}y.isSmallDevice?V(d,n.fieldName,D,t):V(u,n.fieldName,D,t).then(function(t){var i;J(true);t.closing.then(function(t){if(t&&!e(t.target).closest(".qv-st-header-cell-search").length>0){D.currentHeaderSearch=null;n.open=false}i=t});t.closed.then(function(){t=null;n.open=false;i||(D.currentHeaderSearch=null);J(false)});D.currentHeaderSearch&&D.currentHeaderSearch===n&&(t=null)});n.open=true;D.currentHeaderSearch=n};D.openUrl=function(e){D.linksInteractive&&f.open(e,"_blank")};D.options.externalInterface&&D.options.externalInterface.straightTableId&&D.$emit("straight-table-initialized",{id:D.options.externalInterface.straightTableId,grid:D.grid,headers:_.metaHeaders,scrollApi:D.scrollApi})}}}]);return{initialProperties:{qHyperCubeDef:{qDimensions:[],qMeasures:[],qSuppressMissing:true,qMode:"S",columnOrder:[],columnWidths:[],qColumnOrder:[]}},data:{dimensions:{min:function e(t){return t>0?0:1},max:1e3,description:function e(){return i.get("Visualizations.Descriptions.Column")},add:function e(t,n,i){var o=i.hcProperties.qColumnOrder,r=i.hcProperties.columnOrder,a=i.hcProperties.columnWidths,s=i.getDimensions().length-1;c.indexAdded(o,s);c.indexAdded(r,s);a.splice(s,0,-1);return t},remove:function e(t,n,i,o){var r=i.hcProperties.qColumnOrder,a=i.hcProperties.columnOrder,s=i.hcProperties.columnWidths;c.indexRemoved(r,o);c.indexRemoved(a,o);s.splice(r[o],1)}},measures:{min:function e(t){return t>0?0:1},max:1e3,description:function e(){return i.get("Visualizations.Descriptions.Column")},add:function e(t,n,i){var o=i.hcProperties.qColumnOrder,r=i.hcProperties.columnOrder,a=i.hcProperties.columnWidths,s=i.getDimensions().length+i.getMeasures().length-1;c.indexAdded(o,s);c.indexAdded(r,s);a.splice(o[s],0,-1)},remove:function e(t,n,i,o){var r=i.hcProperties.qColumnOrder,a=i.hcProperties.columnOrder,s=i.hcProperties.columnWidths,l=(i.hcProperties.qDimensions?i.hcProperties.qDimensions.length:0)+o;c.indexRemoved(r,l);c.indexRemoved(a,l);s.splice(l,1)}}},support:{cssScaling:true,snapshot:true,export:true,exportData:true,sharing:false},type:"table",template:"<qv-straight-table></qv-straight-table>",BackendApi:r,definition:a,migrate:{properties:function e(t){return w.migrateProperties(I.migrateProperties(t))},snapshot:function e(t){return w.migrateSnapshot(t)}},importProperties:function e(t,i,o){var r=u.hypercube.importProperties(t,i,o),a=r.qProperty.qHyperCubeDef.qColumnOrder,s=r.qProperty.qHyperCubeDef.qDimensions,l=r.qProperty.qHyperCubeDef.qMeasures,c=n.getService("qvGridObjectDataService");u.unquarantineObject(r.qProperty,"straightTableColumnWidths")||C.setValue(r,"qProperty.qHyperCubeDef.columnWidths",i.qHyperCubeDef.columnWidths.concat());l.forEach(function(e){""===e.qDef.qAggrFunc&&e.qDef.qExpressions&&0===e.qDef.qExpressions.length&&(e.qDef.qAggrFunc="Expr")});for(var d=0;d<s.length;d++){var p=s[d].qDef.representation;if(p&&p.urlLabel&&p.urlLabel.qStringExpression){var f=[];f.push({qExpression:p.urlLabel.qStringExpression.qExpr,id:"urlLabel"});C.setValue(r,"qProperty.qHyperCubeDef.qDimensions."+d+".qAttributeExpressions",f)}}if(!c.columnOrder.isValid(a,s,l,true)){r.qProperty.qHyperCubeDef.qColumnOrder=c.columnOrder.create(s,l);r.qProperty.qHyperCubeDef.columnOrder=r.qProperty.qHyperCubeDef.qColumnOrder.concat()}r.qProperty.qHyperCubeDef.qDimensions.forEach(function(e){e.qOtherTotalSpec&&e.qOtherTotalSpec.qTotalMode&&(e.qOtherTotalSpec.qTotalMode="TOTAL_OFF")});r.qProperty.qHyperCubeDef.qMeasures.forEach(N);u.unquarantineConditionalShow(r);return r},exportProperties:function e(t){var n=u.hypercube.exportProperties(t);u.quarantineProperty("qHyperCubeDef.columnWidths",n,"straightTableColumnWidths");u.quarantineConditionalShow(n);return n},controller:_}}.apply(t,i),void 0!==o&&(e.exports=o))},1060:function(e,t,n){"use strict";var i,o;!(i=[n(11),n(48),n(91),n(89),n(381),n(1657),n(1658),n(299),n(1224),n(107),n(1659),n(1660),n(159),n(304),n(97),n(1270)],o=function(e,t,n,i,o,r,a,s,l,u,c,d,p,f,h,g){var m,v;m={auto:"auto auto",alwaysFit:"contain",fitWidth:"100% auto",fitHeight:"auto 100%",fill:"100% 100%"};v={topLeft:"0% 0%",centerLeft:"50% 0%",bottomLeft:"100% 0%",topCenter:"0% 50%",centerCenter:"50% 50%",bottomCenter:"100% 50%",topRight:"0% 100%",centerRight:"50% 100%",bottomRight:"100% 100%"};t.directive("qvTextImageEditor",[function(){return{restrict:"A",scope:{editorOptions:"=",save:"="},link:function t(n,i){l.show(i,n.editorOptions);i.on("qv-outside",function(t){var i=e(t.target);if(i.closest(".qv-texttool-toolbar, .modal-container, .qui-immidiateContextual, .lui-popover, .lui-dialog").length)return;n.save()});n.$on("$destroy",function(){n.save();l.hide()})}}}]);function b(e){return e.background&&e.background.isUsed&&e.background.url&&e.background.url.qStaticContentUrl&&e.background.url.qStaticContentUrl.qUrl||""}function x(n,o){var r=t.getService("$timeout"),a=o.find(".qv-media-tool-html")[0];if("none"===n.responsive||"undefined"===typeof n.responsive)return r(function(){n.sizeClass="";n.sizeStyle={maxWidth:"",maxHeight:""};e(a).find("img").css(n.sizeStyle);n.visibilityClass="";n.responsiveClass=""},0);n.sizeClass="";n.visibilityClass="hidden";"images"===n.responsive?n.responsiveClass="responsive-images":"text"===n.responsive?n.responsiveClass="responsive-text":n.responsiveClass="responsive-images responsive-text";if(!a){n.visibilityClass="";return i.resolve()}return r(function(){if(""===n.visibilityClass)return;n.sizeClass="";n.sizeStyle={maxWidth:"100%",maxHeight:"100%"};e(a).find("img").css(n.sizeStyle);e(a).addClass("default-font-size");var t=a.offsetWidth-a.clientWidth;var i=(a.scrollHeight+t*a.offsetHeight/48)/a.clientHeight;e(a).width("auto");e(a).removeClass("default-font-size");if(i>1){n.sizeStyle={maxWidth:Math.floor(1/i*100)+"%",maxHeight:Math.floor(1/i*100)+"%"};e(a).find("img").css(n.sizeStyle)}n.sizeClass=i>3?"bp-4":i>2?"bp-3":i>1.5?"bp-2":i>1?"bp-1":"";n.visibilityClass=""},10)}function y(e){return!l.hasContent(e)||""===e.trim()}function C(e){var t=0;if(document.createRange){var n=document.createRange();n.selectNodeContents(e);if(n.getBoundingClientRect){var i=n.getBoundingClientRect();i&&(t=i.bottom-i.top)}}return t}function q(e){return!y(e.markdown)||b(e)}return{type:"text-image",BackendApi:s,definition:a,initialProperties:{qHyperCubeDef:{qDimensions:[],qMeasures:[]},images:[],markdown:"",background:{url:{},size:"auto"}},data:{measures:{min:0,max:1e3,description:function e(){return n.get("Visualizations.Descriptions.TextImage.Measure")},add:function e(t,n){n.markdown+="=[]("+t.qDef.cId+")"},remove:function e(t,n){n.markdown=c.removeMeasure(t.qDef.cId,n.markdown)},replace:function e(t,n,i,o){o.markdown=c.replaceMeasure(n.qDef.cId,t.qDef.cId,o.markdown)}}},support:{cssScaling:true,snapshot:q,export:q,exportData:true,sharing:false},exportProperties:null,importProperties:null,template:r,showRequirements:function e(){return false},getDropMeasureOptions:function e(t,n,i,o){if(n.getMeasures().length<n.maxMeasures())"expression"===t.item.type?n.addExpressionMeasure(t.item.name,"").then(function(){i.setProperties(n.properties)}):n.addLibraryMeasure(t.item.id).then(function(){i.setProperties(n.properties)});else{t.ReplaceMeasures(i,n);o()}},controller:["$scope","$element","$sce",function(n,r,a){var s=r.find(".qv-ti");n.isSelected=function(){return n.options.isActive||n.options.isZoomed};n.$watch("editing",function(e){n.object.preventDrag=e});n.edit=function(){if(!n.object.inEditState()||n.editing||n.object.isLink)return;if(n.isSelected()){n.saving=false;n.saved=false;n.backendApi.getProperties().then(function(e){var t=n.object.getCreatePropertyHandler();t.setProperties(e);n.editorOptions={markdown:e.markdown,maxlength:u.textImage,toolbar:{style:"popover",buttons:"all",width:561},useMeasures:true,layout:n.backendApi.model.layout,properties:e,propertyHandler:t,copiedMeasures:[],insertedImages:[],onOpen:function e(t){t.saveRange();n.$apply(function(){n.editing=true;n.initializing=false});setTimeout(function(){q()},0)},isActive:function e(){return n.editing||n.initializing}};n.initializing=true})}};function q(){var e=l.getEditorElement();g.enable(e,true)}function D(e){var t=[];e.find(".tokenized-measure").each(function(e,n){var i=n.getAttribute("data-measure");i=o.decompressFromBase64(i);t.push(JSON.parse(i))});return t}function w(e){function t(e){var t=l.getOptions().insertedImages;for(var n=0;n<t.length;n++)if(t[n].url===e)return t[n].urlDef;return null}var n=[];e.find("img:not(.tokenized-measure)").map(function(e,i){var o=i.getAttribute("data-image-id");var r=i.getAttribute("src");var a=t(r);a||(a=i.getAttribute("src"));n.push({id:o,url:a})});return n}n.save=function(){if(n.saving||n.saved)return;l.closing();var e=l.getMarkdown();var t=l.getEditorElement();if(null!==e&&e!==n.markdown){n.saving=true;var i=l.getOptions().properties;i.markdown=e;c.syncMeasures(D(t),i);d.syncImages(w(t),i);n.backendApi.model.setProperties(i);n.saved=true}else n.editing=false};n.clickHtml=function(t){var i=!n.navigation;i&&e(t.target).closest("a").length&&t.preventDefault()};function I(){t.$apply(n,function(){n.editing=false})}this.onPaint=function(e){var o="";var r="";var u="";var c="";var d=[];n.finishRender=false;if(n.saving){n.editing=false;n.saving=false}o=b(e);if(o){f.stripBasePath(o);o=o.replace(/"/g,'\\"');o=o.replace(/'/g,"\\'");r=f.addBasePath(o);u=m[e.background.size]||m.auto;c=v[e.background.position]||v.topLeft;var h=new Image,g=i();d.push(g.promise);h.onload=function(){g.resolve()};h.onerror=function(){g.resolve()};h.src=r;if(h.complete){h.onload=null;h.onerror=null;g.resolve()}}s.css({backgroundImage:"url('"+r+"')",backgroundSize:u,backgroundPosition:c,backgroundRepeat:"no-repeat"});n.empty=y(e.markdown)&&!o;n.html=a.trustAsHtml(l.toHTML(e.markdown,e,true));n.direction=this.view.options.direction;n.textDirection=p.getAutoOrAlternativeDirection(e.markdown);n.markdown=e.markdown;n.responsive=e.responsive;var C=t.getService("$timeout");var q=x(n,s).then(function(){return C(function(){s.find("img").each(function(e,t){t.complete||function(e){var t=i();d.push(t.promise);e.onload=function(){t.resolve()};e.onerror=function(){t.resolve()}}(t)});if(d.length)return i.all(d).then(function(e){return x(n,s).then(function(){n.finishRender=true;return e})});n.finishRender=true},0,false)});return q.then(function(){if(n.backendApi.isSnapshot){e.snapshotData.scrollTopPercent&&s.closest(".qv-object-content").css("top",-e.snapshotData.scrollTopPercent+"%");e.snapshotData.verticalScrollWidth&&s.find(".qv-media-tool-html").css("padding-right",e.snapshotData.verticalScrollWidth+"px")}return C(function(){},500)})};this.onResize=function(){return this.onPaint.apply(this,arguments)};this.setInteractionState=function(e){this._super(e);n.navigation=(n.options.navigation||n.options.limitedInteraction)&&n.object.inAnalysisState();n.editmode=n.object.inEditState();n.editmode||(n.editing=false)};this.getPreferredSize=function(){var e=i();var t=n.$watch("finishRender",function(n){if(true===n){var i=0;s.find(".qv-media-tool-html").contents().each(function(){i+=3===this.nodeType?C(this):this.offsetHeight;"BR"===this.nodeName&&(i+=8)});e.resolve(i?{w:s.width(),h:i}:void 0);t()}});return e.promise};this.setSnapshotData=function(t){if(n.backendApi.isSnapshot)n.object.layout.snapshotData.scrollTopPercent&&(t.snapshotData.scrollTopPercent=n.object.layout.snapshotData.scrollTopPercent);else{var i=s.find(".qv-media-tool-html")[0];t.snapshotData.scrollTopPercent=i.scrollTop/i.clientHeight*100;t.snapshotData.verticalScrollWidth=e(i).innerWidth()-i.clientWidth}};h.on("start",I);n.$on("$destroy",function(){h.off("start",I)})}],getDropFieldOptions:function e(t,n,i,o,r){t.AddFieldAsMeasure(i,n,r);o()},getDropDimensionOptions:function e(t,n,i,o){o()}}}.apply(t,i),void 0!==o&&(e.exports=o))},1147:function(e,t,n){"use strict";var i,o;!(i=[n(1648)],o=function(e){var t={create:n};return t;function n(){return new e}}.apply(t,i),void 0!==o&&(e.exports=o))},1187:function(e,t,n){"use strict";var i,o;!(i=[n(204),n(403),n(101)],o=function(e,t,n){return{getLayersProperties:i,getDimensionTitle:o,createHyperCubeHandler:r};function i(e,t){return n.getValue(e,t||"layers")}function o(e,n){if(!e.length)return"";var i=e[0];var o=i.qDef.cId;var r=n.getDimensionLayout(o);return t.create().getDimensionTitle(r,i,true)}function r(t,n,i,o){var r=new e({app:o,path:t});r.setProperties(n);r.setLayout(i);return r}}.apply(t,i),void 0!==o&&(e.exports=o))},1248:function(e,t,n){"use strict";var i,o;!(i=[n(1525),n(90)],o=function(e,t){var n=[{value:"ascending",translation:"properties.sorting.ascending"},{value:"descending",translation:"properties.sorting.descending"}];function i(e,i,o){return{type:"items",items:{toggled:{type:"boolean",ref:e,translation:i,convertFunctions:o.toggled},order:{type:"string",component:"dropdown",ref:e,options:n,convertFunctions:o.sorting,show:function n(i){return 0!==t.getValue(i,e,0)}}}}}function o(t,n){t=t||"qSortByState";var o={toggled:e.booleanConvertFunctions(n),sorting:e.invertedEnumConvertFunctions(n)};return i(t,"properties.sorting.sortByState",o)}function r(t,n){t=t||"qSortByFrequency";var o={toggled:e.booleanConvertFunctions(n),sorting:e.invertedEnumConvertFunctions(n)};return i(t,"properties.sorting.sortByFrequency",o)}function a(t,n){t=t||"qSortByAscii";var o={toggled:e.booleanConvertFunctions(n),sorting:e.enumConvertFunctions(n)};return i(t,"properties.sorting.sortByAlphabetic",o)}function s(t,n){t=t||"qSortByNumeric";var o={toggled:e.booleanConvertFunctions(n,-1),sorting:e.enumConvertFunctions(n)};return i(t,"properties.sorting.sortByNumeric",o)}function l(n,o){n=n||"qSortByExpression";var r={toggled:e.booleanConvertFunctions(o),sorting:e.enumConvertFunctions(o)};var a=i(n,"properties.sorting.sortByExpression",r);a.items.expression={type:"number",component:"expression",expressionType:"ValueExpr",ref:"qExpression",translation:"Common.Expression",defaultValue:"",show:function e(i){return 0!==t.getValue(i,n,0)}};return a}return{state:o,ascii:a,numeric:s,expression:l,frequency:r}}.apply(t,i),void 0!==o&&(e.exports=o))},1260:function(e,t,n){"use strict";var i,o;!(i=[n(100),n(185)],o=function(e,t){return{getProgressColor:n,getSegmentColors:i,resolveColor:o,resolveColorSegment:r,getPropertyLogic:a};function n(e,t,n){var i=(t||{}).baseColor;if(i&&i.color&&e.color&&"measure"===e.color.useBaseColors)return o(i);return n}function i(e){if(e.paletteColors&&e.paletteColors.length)return e.paletteColors;return e.colors&&e.colors.length?e.colors:void 0}function o(t){return e.resolveColor(t)}function r(e,t){if(e.paletteColors&&e.paletteColors[t])return o(e.paletteColors[t]);return o(e.colors[t].color)}function a(){return t.getLogicFor("hard","default")}}.apply(t,i),void 0!==o&&(e.exports=o))},1263:function(e,t,n){"use strict";var i,o;!(i=[n(92),n(159)],o=function(e,t){var n,i,o,r,a,s,l;i=e.extend("ClassList",{init:function e(){this.classList=[]},addClass:function e(t){if(!t)return;var n=this.classList.indexOf(t);-1===n&&this.classList.push(t);return this},removeClass:function e(t){if(!t)return;var n=this.classList.indexOf(t);-1!==n&&this.classList.splice(n,1);return this},hasClass:function e(t){return-1!==this.classList.indexOf(t)}});o=i.extend("Cell",{init:function e(t,n){this._super.apply(this,arguments);this.setDefaults();this.colIx=t;this.rowIx=n},setDefaults:function e(){this.classList.length=0;this.style={};this.color={};this.colspan=1;this.rowspan=1;this.text="";this.displayText="";this.dataValue=-1;this.dataColIx=-10;this.effectiveDataColIx=void 0;this.dataRowIx=-1;this.isDimensionValue=false;this.type=void 0;this.locked=false;this.isNullValue=false;this.value="";this.tid="";this.dir="auto";this.isRtl=false;this.isTotal=false;this.fieldName=""},setText:function e(n){var i=t.detectTextDirection(n);this.text=n;this.dir=t.supportDirAuto()?"auto":i;this.isRtl="rtl"===i},setData:function e(t,n,i,o,r){this.setText(t);this.rowspan=n||1;this.colspan=i||1;this.dataRowIx=o||-1;this.dataColIx=r||-1},setHeader:function e(t,n,i,o,r,a,s,l){this.setText(t);this.dataValue=n;this.rowspan=i||1;this.colspan=o||1;this.dataRowIx=r;this.dataColIx=a;this.isTotal=l;this.templateSrc="pt-header-cell-item.ng.html";this.addClass("header");this.setNullClass(s)},setTopHeader:function e(){this.setHeader.apply(this,arguments);this.addClass("top")},setLeftHeader:function e(){this.setHeader.apply(this,arguments);this.addClass("left")},setFromMetaHeader:function e(t){Object.keys(t).forEach(function(e){this[e]=t[e]},this);this.setText(t.text);this.setTextAlign(t.autoAlignText,t.explicitTextAlign);this.setAriaSort(t.isSorted,t.sortIndicator)},setNullClass:function e(t){if(t){this.isNullValue=t;this.addClass("null-value")}},addFocusListener:function e(t){this.focusListeners=this.focusListeners||[];this.focusListeners.push(t)},focus:function e(){this.focusListeners&&this.focusListeners.forEach(function(e){e()})},addBlurListener:function e(t){this.blurListeners=this.blurListeners||[];this.blurListeners.push(t)},blur:function e(){this.blurListeners&&this.blurListeners.forEach(function(e){e()})}});Object.defineProperties(o.prototype,{REPRESENTATION_URL:{value:"url"},REPRESENTATION_TEXT:{value:"text"}});a=o.extend("StraightCell",{setDefaults:function e(){this._super.apply(this,arguments);this.isNumeric=false;this.textAlign="left";this.color.bgByExpression=false;this.color.bgIsDark=false;this.selected=false;this.selectedHighlighted=false;this.qvaOutsideIgnoreFor="";this.isSearchIcon=false;this.open=false;this.sortable=false;this.isMeasure=false;this.isSorted=false;this.reversed=false;this.isSelectLocked=false;this.columnHighlighted=this.columnHighlighted||false;this.hidden=false;this.isFillColumn=false;this.ariaSort=void 0},getAutoTextAlign:function e(){if(this.isNumeric)return"right";return this.isRtl?"right":"left"},setTextAlign:function e(t,n){this.textAlign=t?this.getAutoTextAlign():n||"left"},setAriaSort:function e(t,n){this.ariaSort="none";t&&("A"===n?this.ariaSort="ascending":"D"===n&&(this.ariaSort="descending"))}});s=o.extend("PivotCell",{setDefaults:function e(){this._super.apply(this,arguments);this.templateSrc="pt-cell-item.ng.html";this.collapseExpandClass="";this.isMeta=false},setCollapseExpandClass:function e(t){this.addClass("parent");t.qCanExpand?this.collapseExpandClass="lui-icon--plus":t.qCanCollapse&&(this.collapseExpandClass="lui-icon--minus")},setEmpty:function e(t,n,i){this.setHeader("",-4,t,n);this.addClass("empty");this.addClass(i)}});r=i.extend("Row",{init:function e(t,n){this._super.apply(this,arguments);this.cells=[];this.style={};this.isBold=false;this.classList=[];this.gridType=t;this.rowIx=n;this.reset()},getIndex:function e(){var t,n;for(n=0;n<this.cells.length;++n){t=this.cells[n];if(t.dataRowIx>=0)return t.dataRowIx}return-1},setNextCellIx:function e(t){this.nextCellIx=t},reset:function e(t){var n;this.nextCellIx=0;this.isBold=false;t||(this.classList=[]);for(n=0;n<this.cells.length;++n)this.cells[n].setDefaults()},removeUnused:function e(){this.cells.splice(this.nextCellIx,this.cells.length-this.nextCellIx)},_createCell:function e(t){switch(this.gridType){case"pivot":return new s(t,this.rowIx);default:return new a(t,this.rowIx)}},getCell:function e(t){this.cells[t]||(this.cells[t]=this._createCell(t));return this.cells[t]},getColIx:function e(t){return this.cells.indexOf(t)},getPreviousCell:function e(t){var n=this.getColIx(t);if(n>0)return this.getCell(n-1)},getNextCell:function e(){var t;if(this.cells[this.nextCellIx]){t=this.cells[this.nextCellIx];t.setDefaults()}else{t=this._createCell(this.nextCellIx);this.cells[this.nextCellIx]=t}this.nextCellIx++;return t},getCellSize:function e(){return this.nextCellIx},addEmptyHeaderCell:function e(t,n,i,o,r,a){var s=this.getNextCell();s.setEmpty(i,o,r);s.setData("",i,o,t,n);s.setNullClass(a);return s},addEmptyMetaCell:function e(t,n,i){var o=this.addEmptyHeaderCell(-1,-1,t,n,i);o.isMeta=true;return o},addEmptyDataCell:function e(t,n){var i=this.getNextCell();i.setData("",-4,t,n);i.addClass("empty");return i},addTotalCell:function e(t,n,i){var o=this.getNextCell();o.setHeader(t,-1,n,i);o.addClass("bold");this.addClass("bold");return o},addLeftCollapseExpandCell:function e(t,n,i,o,r){var a=this.getNextCell();a.setLeftHeader("",-1,1,1,t,n,o,r);a.setCollapseExpandClass(i);return a}});l=e.extend("RowList",{init:function e(t){this.rows=[];this.gridType=t},reset:function e(t){this.rows.forEach(function(e){e.reset(t)});this.nextRowIx=0},get:function e(t){this.rows[t]||(this.rows[t]=new r(this.gridType,t));return this.rows[t]},getNext:function e(){var t=this.get(this.nextRowIx);this.nextRowIx++;return t},removeUnused:function e(){this.rows.splice(this.nextRowIx,this.rows.length-this.nextRowIx);this.rows.forEach(function(e){e.removeUnused()})},setNextRowIx:function e(t){this.nextRowIx=t}});n=e.extend("DataGrid",{init:function e(t){this.headerList=new l(t);this.rowList=new l(t);this.footerList=new l(t);this.gridType=t;this.reset()},setTopTreeDepth:function e(t){this.topTreeDepth=t},setLeftTreeDepth:function e(t){this.leftTreeDepth=t},reset:function e(t,n){this.rowList.reset();if(!t){this.headerList.reset(n);this.footerList.reset(n)}this.topTreeDepth=-1;this.leftTreeDepth=-1},getRowsByCellType:function e(t){var n=[];n=t===this.CELL_TYPE_DATA||t===this.CELL_TYPE_LEFT?this.rows:this.headerRows;return n},getRow:function e(t){return this.rowList.get(t)},getHeaderRow:function e(t){return this.headerList.get(t)},getFooterRow:function e(t){return this.footerList.get(t)},getNextRow:function e(){return this.rowList.getNext()},getNextHeaderRow:function e(){return this.headerList.getNext()},getNextFooterRow:function e(){return this.footerList.getNext()},getCell:function e(t,n){return this.getRow(t).getCell(n)},getHeaderCell:function e(t,n){return this.getHeaderRow(t).getCell(n)},getFooterCell:function e(t,n){return this.getFooterRow(t).getCell(n)},removeUnused:function e(){this.rowList.removeUnused();this.headerList.removeUnused();this.footerList.removeUnused()},getNextRowIx:function e(){return this.rowList.nextRowIx},setNextRowIx:function e(t){this.rowList.setNextRowIx(t)},setNextHeaderIx:function e(t){this.headerList.setNextRowIx(t)}});Object.defineProperties(n.prototype,{headerRows:{get:function e(){return this.headerList.rows}},footerRows:{get:function e(){return this.footerList.rows}},rows:{get:function e(){return this.rowList.rows}},GRID_TYPE_STRAIGHT:{value:"straight"},GRID_TYPE_PIVOT:{value:"pivot"},CELL_TYPE_TOP:{value:"top"},CELL_TYPE_LEFT:{value:"left"},CELL_TYPE_DATA:{value:"data"}});return n}.apply(t,i),void 0!==o&&(e.exports=o))},1264:function(e,t,n){"use strict";var i,o;!(i=[n(982),n(94)],o=function(e,t){return{migrateProperties:s,migrateSnapshot:l,getColumnOrder:u,getColumnDataIndex:c,getLeftOfDataArea:d,useNewColumnOrderIdx:p,updatePropertiesOnRefresh:f,findLeftForSnapshots:g};function n(e,t){if(void 0===t&&0===e.length)return false;var n=e.every(function(e,n){return e===t[n]});return n&&e.length===t.length}function i(n,i){return e.canModifyHardProperties(t,n,i)}function o(e,t){return e&&e.length>0&&t&&0===t.length}function r(e,t){return t&&t.length>0&&e&&0===e.length||!n(t,e)}function a(e){return e&&e.qHyperCube&&e.qHyperCube.qColumnOrder&&e.qHyperCube.qColumnOrder.length>0}function s(e){var t=e&&e.qHyperCubeDef;t&&o(t.columnOrder,t.qColumnOrder)?t.qColumnOrder=t.columnOrder.slice():t&&r(t.columnOrder,t.qColumnOrder)&&(t.columnOrder=t.qColumnOrder.slice());return e}function l(e){var t=e.qHyperCube;if(t.columnOrder&&!t.qColumnOrder||0===t.qColumnOrder.length){var n=e.snapshotData.object.origDataPages||t.qDataPages;t.qColumnOrder=n.filter(function(e){return e&&e.qArea}).map(function(e){return e.qArea.qLeft});n.forEach(function(e){e&&e.qArea&&(e.qArea.qLeft=t.qColumnOrder.indexOf(e.qArea.qLeft))});n=n.filter(function(e){return e&&e.qArea&&-1!==t.columnOrder.indexOf(t.qColumnOrder[e.qArea.qLeft])});t.columnOrder=t.qColumnOrder.slice();t.qDataPages=n;e.snapshotData.object.origDataPages=n}else if(t.columnOrder&&t.columnOrder.length!==t.qColumnOrder.length){t.qDataPages=t.qDataPages.filter(function(e){return e&&e.qArea&&-1!==t.qColumnOrder.indexOf(t.columnOrder[e.qArea.qLeft])});t.qColumnOrder=t.columnOrder.slice();e.snapshotData.object.origDataPages=t.qDataPages}else{t.columnOrder=new Array(t.qColumnOrder.length);for(var i=0;i<t.columnOrder.length;i++)t.columnOrder[i]=t.qColumnOrder[i]}return e}function u(e){var t=Array.isArray(e.qColumnOrder)?e.qColumnOrder.slice():e.qColumnOrder;var n=Array.isArray(e.columnOrder)?e.columnOrder.slice():e.columnOrder;return t&&t.length>0?t:n}function c(e,t){var n=e.qHyperCube.columnOrder;var i=e.qHyperCube.qColumnOrder;if(!i||n&&n.length>i.length)return n[t];return i&&i.length>0?i[t]:t}function d(e,t,n,i){var o=g(n,t);return o>=0?o:p(n.qHyperCube,i)?t:e&&e.qLeft}function p(e,t){return h(e)||a(t)}function f(e,t){o(t.columnOrder,t.qColumnOrder)&&e&&e.model&&e.model.getEffectiveProperties&&e.model.getEffectiveProperties().then(function(t){if(i(e.model,t)){t.qHyperCubeDef.qColumnOrder=t.qHyperCubeDef.columnOrder.slice();e.model.setProperties(t);e.model.app.clearUndoBuffer()}else{var n=[{qPath:"/qHyperCubeDef/qColumnOrder",qOp:"add",qValue:JSON.stringify(t.qHyperCubeDef.columnOrder)}];e.applyPatches(n,true)}})}function h(e){return e&&e.qColumnOrder&&e.qColumnOrder.length>0}function g(e,t){var n=e&&e.qHyperCube,i=n&&n.qDataPages,o=u(e.qHyperCube),r;i&&(i=i.filter(function(e){return e}));i&&i.length&&i.forEach(function(n){n&&n.qArea&&n.qArea.qLeft===t&&(r=o.indexOf(e.qHyperCube.qColumnOrder[t]))});i&&i.length&&i.length===o.length&&void 0===r&&(r=i[t].qArea.qLeft);return r}}.apply(t,i),void 0!==o&&(e.exports=o))},1265:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(90),n(1003),n(1128)],o=function(e,t){e.service("qvGridObjectSelectionService",["$timeout","$document","qvGridObjectDataService",function(e,n,i){var o;o={$new:function e(){var t={active:false,currentDataColIx:-1,effectiveDataColIx:-1,currentDataRowIx:-1,currentCell:void 0,activationCell:void 0,dataValues:{},unbindKeyboard:null};Object.defineProperties(t,{dataValuesArray:{get:function e(){var t,n=[],i=Object.keys(this.dataValues),o=i.length;for(t=0;t<o;++t)n.push(parseInt(i[t]));return n}},selectedIndices:{get:function e(){var t,n=[],i=this.dataValuesArray,o=i.length;for(t=0;t<o;++t)n.push(this.dataValues[i[t]]);return n}}});return t},init:function e(t,n,i,r,a,s){t.confirm=function(){n.endSelections(true);t.deactivated();o.reset(i);o.hide(i);r()};t.cancel=function(){n.endSelections(false);t.deactivated();o.reset(i);o.hide(i);a()};t.clear=function(){i.dataValues={};s();o.reset(i);n.clearSelections();t.selectionsMade=false}},reset:function e(t){t.dataValues={};t.currentDataColIx=-1;t.effectiveDataColIx=-1;t.currentDataRowIx=-1;t.currentCell=void 0},show:function e(n,i){if(n.active)return;n.currentDataColIx=i.dataColIx;n.effectiveDataColIx=i.effectiveDataColIx;n.currentDataRowIx=i.dataRowIx;n.activationCell=t.extend(true,{},i);n.active=true},hide:function e(t){t.active=false},bindKeyboard:function e(t,i){var o=".selections-keyboard-"+i;n.on("keyup"+o,function(e){27===e.which?t.cancel():13===e.which&&t.confirm()});return function(){n.off(o)}},isColumnar:function e(t,n){return n.type===t.CELL_TYPE_LEFT||n.type===t.CELL_TYPE_DATA},selectValue:function e(t,n,i){i.dataValues[n.dataValue]=o.isColumnar(t,n)?n.dataRowIx:n.dataColIx;i.currentDataColIx=n.dataColIx;i.effectiveDataColIx=n.effectiveDataColIx;i.currentDataRowIx=n.dataRowIx},selectCell:function e(t,n,i){if(t.gridType===t.GRID_TYPE_PIVOT){n[i?"addClass":"removeClass"]("selected-highlighted");n[i?"removeClass":"addClass"]("selected")}else{n.selectedHighlighted=!!i;n.selected=!i}},lockCell:function e(t,n){t.gridType===t.GRID_TYPE_PIVOT?n.addClass("locked"):n.isSelectLocked=true},deselectValue:function e(t,n,i){delete i.dataValues[n.dataValue]},deselectCell:function e(t,n){if(t.gridType===t.GRID_TYPE_PIVOT){n.removeClass("selected-highlighted");n.removeClass("selected")}else{n.selectedHighlighted=false;n.selected=false}},unlockCell:function e(t,n){t.gridType===t.GRID_TYPE_PIVOT?n.removeClass("locked"):n.isSelectLocked=false},removeCellStyle:function e(t){if(t.color.bgByExpression||t.style.color){t.styleCache={style:t.style,bgByExpression:t.color.bgByExpression};t.style="";t.color.bgByExpression=false}},restoreCellStyle:function e(t){if(t.styleCache){t.style=t.styleCache.style;t.color.bgByExpression=t.styleCache.bgByExpression;delete t.styleCache}},getSelectionType:function e(t,n){var i={};i[t.CELL_TYPE_TOP]="T";i[t.CELL_TYPE_LEFT]="L";i[t.CELL_TYPE_DATA]="D";return i[n]},sendSelection:function e(t,n,i,r,a){var s,l,u,c=i.selectedIndices;if(0===c.length)return;if(o.isColumnar(r,i.currentCell)){s=["number"===typeof i.effectiveDataColIx?i.effectiveDataColIx:i.currentDataColIx];l=i.selectedIndices}else{s=i.selectedIndices;l=[i.currentDataRowIx]}u=o.getSelectionType(r,a.type);n.selectionsMade=true;t.select(l,s,u).then(function(e){e||n.clear()})},getCellCountWithDataValue:function e(t,n,i){var r,a=[],s=0,l=n.length,u,c;if(0===l)return 0;for(c=0;c<l;++c){u=n[c];r=o.isColumnar(t,u)?u.dataColIx:u.dataRowIx;if(u.dataValue===i&&-1===a.indexOf(r)){a.push(r);s++}}return s},getSiblingCell:function e(t,n){if(t.gridType===t.GRID_TYPE_PIVOT)return n.currentCell;return n.activationCell},selectDimensionCells:function e(n,r,a,s,l,u){var c=l.dataValue,d=o.isSelected(a,l),p=i.getSiblingCells(s,o.getSiblingCell(s,a)||l),f,h;if(-1===p.indexOf(l))return;h=l.type===s.CELL_TYPE_TOP?n.getSize().qcx:n.getSize().qcy;f=o.getCellCountWithDataValue(s,p,c);if(h===f&&u&&d)return;p.forEach(function(e){e.dataValue in a.dataValues&&o.selectCell(s,e)});if(u&&d){o.deselectValue(s,l,a);p.forEach(function(e){e.dataValue===c&&o.deselectCell(s,e)})}else if(d){if(!u){p.forEach(function(e){e.dataValue===c&&o.selectCell(s,e)});o.selectCell(s,l,true)}}else{o.selectValue(s,l,a);p.forEach(function(e){e.dataValue===c&&o.selectCell(s,e)});o.selectCell(s,l,true)}a.currentCell=t.extend(true,{},l);return function(){0===a.dataValuesArray.length?r.clear():o.sendSelection(n,r,a,s,l)}},selectDimensionValue:function e(t,n,i,r,a,s,l){var u=o.activateSelections(t,n,i,r,a),c;if(!a.locked&&!a.isNullValue){c=o.selectDimensionCells(n,i,r,s,a,l);c&&c()}return u},activateSelections:function t(n,i,r,a,s){if(!a.active&&!s.locked){i.beginSelections();o.show(a,s);a.unbindKeyboard=o.bindKeyboard(r,n);e(function(){r.activated(true)})}return function(){a.unbindKeyboard()}},isSelected:function e(t,n){return n.dataValue in t.dataValues},updateStraight:function e(t,n,r){var a,s,l,u;if(n.dataValuesArray.length){u=i.getSiblingCells(t,r);l=u.length;for(a=0;a<l;++a){s=u[a];if(s.dataValue in n.dataValues){o.selectCell(t,s);n.currentDataRowIx===s.dataRowIx&&o.selectCell(t,s,true)}}}},updatePivot:function e(t,n,r){var a,s,l,u;if(n.dataValuesArray.length){u=i.getSiblingCells(t,r);l=u.length;for(a=0;a<l;++a){s=u[a];s.dataValue in n.dataValues&&o.selectCell(t,s)}}}};return o}])}.apply(t,i),void 0!==o&&(e.exports=o))},1266:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(1626),n(1627),n(96)],o=function(e,t,n,i){e.directive("qvTableColumnWidthAdjuster",function(){return{restrict:"E",replace:true,template:t,scope:{columns:"=",explicitColumnWidths:"=",rtl:"=",minColWidth:"="}}});e.directive("qvColumnWidthAdjustColumn",function(){return{restrict:"E",scope:{column:"=",explicitColumnWidth:"=",rtl:"=",minColWidth:"="},template:n,replace:true,link:function e(t,n){var o="columnAdjuster",r=t.minColWidth||40,a;t.columnStyle={};t.$watch("column.left",function(){t.columnStyle.left=t.column.left+"px"});t.$watch("column.hidden",function(){t.columnStyle.display=t.column.hidden?"none":"block"});t.$watch("column.height",function(){t.columnStyle.height=t.column.height+"px"});t.$watch("column.top",function(){t.columnStyle.top=t.column.top+"px"});t.$on("$destroy",function(){i(n[0]).off("*",o)});i(n[0]).swipe({id:o,options:{radiusThreshold:5,preventDefault:false},start:function e(){t.explicitColumnWidth=t.column.width;a=t.explicitColumnWidth;t.$emit("onExplicitColumnStarted")},update:function e(n,i){var o=(t.rtl?-1:1)*i.swipe.deltaX,s=Math.max(a+o,r);t.isActive||(t.isActive=true);t.explicitColumnWidth=s;t.$apply();t.$emit("onExplicitColumnChanging")},end:function e(){t.isActive=false;t.$emit("onExplicitColumnChanged")}}).doubletap({id:o,end:function e(){t.isActive=false;t.explicitColumnWidth=-1;t.$apply();t.$emit("onExplicitColumnChanged")}})}}})}.apply(t,i),void 0!==o&&(e.exports=o))},1267:function(e,t){e.exports='<div class="pp-component pp-list-component pp-list pp-nm-hcd" tcl="data">\n\t<div class="pp-nm-hcd__lists" qv-sortable-list="sortableItemLists">\n\n\t\t\x3c!-- Lists --\x3e\n\t\t<div class="pp-nm-hcd__list"\n\t\t\t ng-class="{ \n\t\t\t\t \'disabled\': list.disabled, \n\t\t\t\t \'empty\': isAutoChart && !getUndraggedItems(list).length,\t\t\t\t \n\t\t\t\t \'has-headerless-sibling\': list.hasHeaderlessSibling }"\n\t\t\t ng-if="list.show() !== false"\n\t\t\t ng-repeat="list in sortableItemLists.lists"\n\t\t\t tid="{{::list.tid}}">\n\t\t\t\n\t\t\t \x3c!-- List header --\x3e\n\t\t\t<div class="pp-nm-hcd__list-header" ng-class="{ \'descriptionless\': list.descriptionless }" ng-if="::!list.hideHeader">\n\t\t\t\t<span class="pp-nm-hcd__list-header-title">{{list.title}}</span>\n\t\t\t</div>\n\n\t\t\t\x3c!-- List body --\x3e\n\t\t\t<div class="pp-nm-hcd__list-body">\n\n\t\t\t\t<ul class="pp-nm-hcd__list-items">\n\t\t\t\t\t\n\t\t\t\t\t\x3c!-- Dimensions / measures --\x3e\n\t\t\t\t\t<li class="pp-nm-hcd__list-item" \n\t\t\t\t\t\tng-class="item.classList"\n\t\t\t\t\t\tng-repeat="item in list.items track by item.id"\n\t\t\t\t\t\tng-include="item.templateSrc">\n\t\t\t\t\t</li>\n\n\t\t\t\t\t\x3c!-- Next possible item - Description and add button --\x3e\n\t\t\t\t\t<li class="pp-nm-hcd__list-item" ng-show="showNextPossibleItem(list)">\n\t\t\t\t\t\t<div class="pp-nm-di">\n\t\t\t\t\t\t\t<div class="pp-nm-di__description" ng-if="showNextPossibleItemDescription(list)">\n\t\t\t\t\t\t\t\t{{getNextPossibleItemDescription(list)}}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<button class="lui-button lui-button--block pp-nm-di__add-button"\n\t\t\t\t\t\t\t\t\tng-class="{ \'lui-active\': list.adding }"\n\t\t\t\t\t\t\t\t\tng-click="list.addClicked($event)"\n\t\t\t\t\t\t\t\t\tqv-enter="list.addClicked($event)"\n\t\t\t\t\t\t\t\t\tqva-outside-ignore-for="{{::\'addButton-\' + $id}}"\n\t\t\t\t\t\t\t\t\ttid="add-hc-data">\n\t\t\t\t\t\t\t\t\t<span class="lui-button__text">{{list.getAddLabel()}}</span>\n\t\t\t\t\t\t\t\t\t<i class="toggle-expand lui-button__caret lui-caret" ng-if="hasMultipleAddOptions()"></i>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'},1268:function(e,t,n){"use strict";var i,o;!(i=[n(1649)],o=function(e){var t={create:n};return t;function n(t,n){return new e(t,n)}}.apply(t,i),void 0!==o&&(e.exports=o))},1269:function(e,t,n){"use strict";var i,o;!(i=[n(54),n(446)],o=function(e,t){var n={gather:i};return n;function i(e){e=e||{};if(!o(e))return;t.put(e.expression,e.aggregation)}function o(t){return!!t.expression&&e.isString(t.expression)&&!!t.aggregation&&e.isString(t.aggregation)}}.apply(t,i),void 0!==o&&(e.exports=o))},1270:function(e,t,n){"use strict";var i,o;!(i=[n(11),n(159),n(114)],o=function(e,t,n){var i={};var o=t.supportDirAuto();function r(e){return e.is("textarea,input")&&0===e.val().length||""===e[0].textContent&&0===e.has("img").length}function a(e,t){r(e)?e.css("direction",t):"rtl"!==e.css("direction")&&"ltr"!==e.css("direction")||e.css("direction","")}function s(n,i,o){n.find("div,p").each(function(n,r){i?"auto"!==r.getAttribute("dir")&&r.setAttribute("dir","auto"):r.setAttribute("dir",t.detectTextDirection(r.innerText));a(e(r),o)})}i.enable=function(i,r){var l=e(i);a(l,n.direction);l.attr("dir",t.getAutoOrAlternativeDirection(l[0].innerText));if(r){l.attr("x-auto-direction-for-paragraphs","");s(l,o,n.direction)}l.on("keyup",function(){o||l.attr("dir",t.detectTextDirection(l[0].innerText));r&&s(l,o,n.direction);a(l,n.direction)})};return i}.apply(t,i),void 0!==o&&(e.exports=o))},1320:function(e,t,n){"use strict";var i,o;!(i=[n(100),n(109),n(11)],o=function(e,t,n){var i={blendValue:p,getIcon:r,getSegmentIndex:l,shouldBlend:s,resolveColorSegment:d,resolveColor:c,getAutoMinMax:f,_getBlendInfo:u};function o(e,t){return e.paletteColors?e.paletteColors[t]:e.colors[t].color}function r(e,t){return e.paletteColors?e.paletteColors[t].icon:e.colors[t].icon}function a(e,t,i){var o;o=n.extend(true,{},e);if(o&&o.limits){o.limits=o.limits.concat().sort(function(e,t){return e.value-t.value});o.limits.forEach(function(e){e.value=(e.value-t)/(i-t)})}var r=o.paletteColors||o.colors;o&&r&&(o.localColors=r.concat().map(function(e,t){return{color:d(o,t)}}));return o}function s(e,t){if(0===e.limits.length)return;var n;n=0===t?e.limits[t].gradient:t===e.limits.length?e.limits[t-1].gradient:e.limits[t].gradient||e.limits[t-1].gradient;return n}function l(e,t,n){if(Number.isNaN(+t))return 0;var i=n?Math.min(n,t):0,o=e.segments.limits.concat().sort(function(e,t){return e.value-t.value}),r=e.segments.paletteColors||e.segments.colors,a,s;for(s=0;s<r.length;s++){if(s===r.length-1)return s;a=o[s].value;if(t<a&&t>=i)return s;i=a}return 0}function u(e,t,n){var i,o,r=e.limits.concat().sort(function(e,t){return e.value-t.value}),a=t>0?r[t-1]:{value:0,gradient:false},s=e.localColors[t-(t>0?1:0)],l=r[t]?r[t]:{value:1,gradient:false},u=e.localColors[t+(t<e.localColors.length-1?1:0)],c=n===l.value?1:(n-a.value)/(l.value-a.value);if(a&&a.gradient&&l&&l.gradient)if(n-a.value<l.value-n){i=s.color;o=.5-c}else{i=u.color;o=c-.5}else if(a&&a.gradient){i=s.color;o=1-(.5+c/2)}else if(l&&l.gradient){i=u.color;o=c/2}else{i=e.localColors[t].color;o=n}return{color:i,t:o}}function c(t){return e.resolveColor(t)}function d(e,t){return i.resolveColor(o(e,t))}function p(e,n,i,o){var r,s,l=0,c,d,p=a(e,i,o);if(n<=0)return p.localColors[0].color;if(n>=1)return p.localColors[p.localColors.length-1].color;for(c=0;c<p.localColors.length;c++){s=p.limits[c]?p.limits[c].value:1;if(n>=l&&n<s){r=u(p,c,n,i,o);d=new t(p.localColors[c].color).blend(new t(r.color),r.t);break}l=s}return d}function f(e,t){function n(e){return e.hasOwnProperty("value")?e.value:e}var i=e.map(n);var o,r,a=0;i=i.sort(function(e,t){return e-t});var s=i.some(function(e){return Number.isNaN(+e)});r=Number.isNaN(+t)?Number.isNaN(+i[0])?.5:i[0]:t;if(0===i.length||s)a=0===r?0:.5*r;else{if(1!==i.length){o=i[i.length-1]-i[0];o=o>0?o:1;return{min:Math.min(r,i[0])-o/2,max:Math.max(r,i[i.length-1])+o/2}}o=i[0]-r;if(0!==o&&!Number.isNaN(+o))return o>0?{min:r-.5*Math.abs(r),max:i[0]+2*o}:{min:i[0]+2*o,max:r+.5*Math.abs(r)};a=0===r?.5:Math.abs(.5*r)}return{min:r-a,max:r+a}}return i}.apply(t,i),void 0!==o&&(e.exports=o))},1325:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(96),n(165),n(99),n(272),n(91),n(321),n(402),n(1326),n(101),n(207),n(1647),n(1267),n(1147),n(1268),n(1269),n(111)],o=function(e,t,n,i,o,r,a,s,l,u,c,d,p,f,h,g){return{name:"columns",template:p,controller:["$scope","$element","$timeout","qvGridObjectDataService","luiPopover",function(p,m,v,b,x){var y=p.args.cache,C="columns_",q=n.getComponent("items"),D=f.create(),w=h.create(p,x);p.expandClicked=function(e,t){if(t.disabled||e.target.classList.contains("pp-nm-di__draggable"))return;t.expanded=!t.expanded;y.put(C+t.id,t.expanded)};var I=null,S=null,L=null;p.addClicked=function(e){E(e)};p.hasMultipleAddOptions=function(){return true};p.getAddLabel=function(){return r.get("properties.columns.add")};function E(e){if(p.adding){M();p.adding=false;return}var t=e.currentTarget;I=x.show({template:l.template,controller:l.controller,input:{items:[{tid:"dimension",select:function e(){V("dimension",t)},disabled:function e(){return p.args.handler.getDimensions().length>=p.args.handler.maxDimensions()},translation:"Common.Dimension"},{tid:"measure",select:function e(){V("measure",t)},disabled:function e(){return p.args.handler.getMeasures().length>=p.args.handler.maxMeasures()},translation:"Common.Measure"}],closeTypeFoldout:M},alignTo:t});I.closing.then(function(e){e&&!e.target.classList.contains("lui-button__text")&&(p.adding=false)});I.closed.then(function(){I=null});p.adding=true}function M(e){if(I){I.close();I=null}e&&e.target.classList.contains("pp-toplist-add-button")&&t.preventGestures();p.addType=null}function _(){var e=u.getValue(p.data,p.definition.sortIndexRef);if(void 0===e){e=b.columnOrder.create(p.args.handler.getDimensionLayouts(),p.args.handler.getMeasureLayouts());u.setValue(p.data,p.definition.sortIndexRef,e);p.$emit("saveProperties")}else if(e.length&&"number"!==typeof e[0]){u.setValue(p.data,p.definition.sortIndexRef,e.map(function(e){return e.dataColIx}));p.$emit("saveProperties")}}function A(){_();var e=u.getValue(p.data,p.definition.sortIndexRef),t=p.data.qHyperCubeDef.qDimensions.length;p.sortableItemLists.reset();D.resetTitles();e.forEach(function(e,n){var i,r,a,s,l,u,c,d;if(e<t){r=e;a=p.data.qHyperCubeDef.qDimensions[r];s="dimension";l=a.qDef.cId;i=p.definition.items.dimensions;c=p.args.handler.getDimensionLayout(l)}else{r=e-t;a=p.data.qHyperCubeDef.qMeasures[r];l=a.qDef.cId;s="measure";i=p.definition.items.measures;c=p.args.handler.getMeasureLayout(l);c||(c=p.args.handler.getMeasureLayouts()[r]);d=w.isChangeable(a)}if("dimension"===s){var f=c;u=D.getDimensionTitle(f,a,true)}else{var h=c;if(h){u=D.getCachedMeasureTitle(h);D.getMeasureTitle(h,a,true,p.args.app).then(function(e){u=e})}}var g={getItemLayout:function e(){return c},title:function e(){return u},isInvalid:function e(){if("dimension"===s){var t=this.getItemLayout();return t&&!!t.qError&&!o.isCalcCondNotCalculatedErr(t.qError)}var n=this.getItemLayout();return n&&!!n.qError},component:q,definition:{type:"items",items:i.items},data:a,args:p.args,id:l,expanded:y.get(C+l)||false,index:n,type:s,sourceIndex:r,dataColIx:e,templateSrc:"pp-data-item.ng.html",markerClass:"dimension"===s?"pp-dimension":"pp-measure",sortable:false!==p.definition.allowMove};if(d){g.canChangeMeasureAggregation=true;g.currentAggregation=w.getAggregation(a.qDef.qDef);g.remainder=w.getRemainder(a.qDef.qDef)}$.addSortableItem(g)})}function P(e){p.args.handler.addFieldDimension(e.value,"").then(function(){p.$emit("saveProperties",p.data);H();R()})}function k(e){p.args.handler.addLibraryDimension(e.libraryId).then(function(){p.$emit("saveProperties",p.data);H();R()})}function T(e){p.args.handler.addLibraryMeasure(e.libraryId).then(function(){p.$emit("saveProperties",p.data);H();R()})}function O(e){p.args.handler.addExpressionMeasure(e.value,"").then(function(){p.$emit("saveProperties",p.data);H();R()})}function V(e,t){p.addType=e;M();F();var n,i={app:p.args.app,closeAddPopover:H};if("dimension"===e){n=a;i.addFieldDimension=P;i.addLibraryDimension=k}else{n=s;i.addLibraryMeasure=T;i.addExpressionMeasure=O}S=x.show({template:n.template,controller:n.controller,input:i,alignTo:t,dock:"bottom"})}function H(e){if(S){S.close();S=null}e&&e.target.classList.contains("pp-toplist-add-button")&&t.preventGestures();p.adding=false}p.removeItem=function(e){"dimension"===e.type?p.args.handler.removeDimension(e.sourceIndex).then(function(){p.$emit("saveProperties")}):p.args.handler.removeMeasure(e.sourceIndex).then(function(){p.$emit("saveProperties")})};p.openContextMenu=function(t,n){var i=e.getService("qvContextMenu").menu();i.addItem({translation:"Common.Delete",tid:"delete",select:function e(){p.removeItem(n)}});L=e.getService("qvContextMenu").show(i,{position:{x:t.pageX,y:t.pageY},docking:"Top"})};function R(){v(function(){var e=m.find(".pp-nm-hcd__lists"),t=e.find(".pp-nm-hcd__list-items").children().last();t[0]&&(e[0].scrollTop=t[0].offsetTop-1)},100)}p.$on("pp-open-path",function(e,t){var n=t.split("."),i=n[0],o=n[1];if("columns"===i&&o){y.put(C+o,true);R()}});p.add=function(e){e&&e.trim().length&&("measure"===p.addType?O({value:e,label:e}):"dimension"===p.addType&&P({value:e,label:e}))};p.sortableItemLists=c.create({options:{direction:"vertical",listKey:"list",scrollSelector:".pp-nm-hcd__lists",listSelector:".pp-nm-hcd__list-items",itemKey:"item",itemSelector:".qv-pp-sortable.draggable",itemDragSelector:".qv-pp-sortable-handle",itemGhostSelector:".pp-nm-di__header",gesture:{name:"swipe",options:{radiusThreshold:i.treatAsDesktop()?4:0,preventDefault:false}}},addPlaceholder:function e(){var t=this._super.apply(this,arguments);t.classList=["qv-pp-sortable"]},onBegin:function e(t){this._super.apply(this,arguments);t.isDragged=true;F()},onMove:function e(){var t=this.getIndexOfItem(arguments[0]),n;if(-1===t){this.onCancel();return false}this._super.apply(this,arguments);n=this.getIndexOfItem(arguments[0]);if(-1===n){this.onCancel();return false}n<t&&t--;p.data.qHyperCubeDef.qColumnOrder=$.get().filter(function(e){return"empty-item"!==e.id}).map(function(e){return e.dataColIx});d.fixTableHypercubeOrders(p.data.qHyperCubeDef);d.updateColumnInfoOrders(p.data.qHyperCubeDef,t,n);p.$emit("saveProperties");return true},onCancel:function e(t){this._super.apply(this,arguments);t&&(t.isDragged=false)},onEnd:function e(t){t&&(t.isDragged=false);p.$apply()}});var $=p.sortableItemLists.createList(1,{title:r.get("Common.Columns"),tid:"columns",getAddLabel:p.getAddLabel,addClicked:p.addClicked,descriptionless:true});function F(){$.items.forEach(function(e){e.expanded=false;y.put(C+e.id,false)})}p.isItemDraggable=function(e){if(!e.sortable)return false;var t=p.args.properties.qHyperCubeDef,n=t.qDimensions.length+t.qMeasures.length;return n>1};p.showChangeAggregation=function(e){return e.canChangeMeasureAggregation&&!e.isDragged};p.getItemHeaderTitle=function(e){return p.showChangeAggregation(e)?e.remainder:e.title()};p.openChangeAggregationPopover=function(e,t){if(!p.showChangeAggregation(t))return;var n={isOpenButton:function e(t){return t.classList.contains("pp-nm-di__header-aggregation")},onAggregationChanged:function e(t,n){g.gather({expression:t.extractedField,aggregation:n})}};w.openPopover(e,t.id,t,n)};p.isChangeAggregationPopoverOpen=function(e){return w.isPopoverOpen(e.id)};p.showItemDescription=function(){return false};p.showNextPossibleItem=function(e){var t=p.getUndraggedItems(e),n=0,i=0,o=0,r=0;t.forEach(function(e){"dimension"===e.type?n++:i++});o=p.args.handler.dimensionDefinition.max-n;r=p.args.handler.measureDefinition.max-i;return!!o||!!r};p.showNextPossibleItemDescription=function(){return false};p.getUndraggedItems=function(e){return e.get(function(e){return!e.isDragged})};p.$watchCollection("data.qHyperCubeDef.qColumnOrder",A);p.$watchCollection("data.qHyperCubeDef.qDimensions",A);p.$watchCollection("data.qHyperCubeDef.qMeasures",A);p.$on("$destroy",function(){M();H();L&&L.close()})}]}}.apply(t,i),void 0!==o&&(e.exports=o))},1326:function(e,t,n){"use strict";var i,o;!(i=[n(1646)],o=function(e){return{template:e,controller:["$scope",function(e){e.itemClicked=function(e,t){e.preventDefault();t.disabled()||t.select()}}],scope:{items:"=",alignTo:"=",closeTypeFoldout:"=",qvaOutsideIgnoreFor:"="}}}.apply(t,i),void 0!==o&&(e.exports=o))},1327:function(e,t,n){"use strict";var i,o;!(i=[n(54),n(178),n(187)],o=function(e,t,n){var i={addAggregation:o};return i;function o(i,o){if(!e.isString(i))throw new Error("Expression-assembler: Aggregation must be a string");if(!e.isString(o))throw new Error("Expression-assembler: Content must be a string");var r=n.SYMBOLS.FUNCTION.LEFT,a=n.SYMBOLS.FUNCTION.RIGHT;var s=t.getFormattedAggregation(i);var l=s+r+o+a;return l}}.apply(t,i),void 0!==o&&(e.exports=o))},1334:function(e,t){e.exports='<div class="pp-component pp-dropdown-component" ng-if="visible" tcl="dropdown">\n    <div class="label" ng-if="label" title="{{label}}" ng-class="{ \'disabled\': readOnly }">\n\t\t{{label}}\n\t</div>\n\n\t<div class="value">\n\t\t<div ng-if="!loading">\n\t\t\t<lui-select x-model="value" x-change="change()" x-disabled="readOnly"\n\t\t\t\t\t\tx-options="option.value as option.label for option in options" tid="{{key}}">\n\t\t\t</lui-select>\n\t\t\t<div style="display: none" class="tids">\n\t\t\t\t<i ng-repeat="option in options">{{option.value}}</i>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="pp-loading-container" ng-if="loading">\n\t\t\t<div class="pp-loader qv-loader"></div>\n\t\t</div>\n\t\t<div ng-if="errorMessage" class="pp-invalid error">{{errorMessage}}</div>\n\t</div>\n</div>'},1494:function(e,t,n){"use strict";var i,o;!(i=[n(89),n(101),n(130),n(134),n(91)],o=function(e,t,n,i,o){function r(t){var o=t.getDimensions(),r=t.getMeasures(),a;function s(e){e>10?1!==t.getSorting()[0]&&t.changeSorting(1,0):0!==t.getSorting()[0]&&t.changeSorting(1,0)}if(1===o.length&&1===r.length){var l=o[0];return l.qLibraryId?i.get(l.qLibraryId,t.app).then(function(e){return e.getLayout()}).then(function(e){if(e&&e.qDimInfos&&e.qDimInfos[0]){var t=e.qDimInfos[0].qCardinal;s(t)}return l}):t.app.getFieldList().then(function(e){var t=n.findField(l.qDef.qFieldDefs[0],e);if(t){var i=t.qCardinal;s(i)}return l})}if(o.length>1&&1===r.length){a=t.getSorting().indexOf(0);0!==a&&t.changeSorting(a,0)}return e.resolve()}function a(e){var t;if(e.getDimensions().length>1&&1===e.getMeasures().length){t=e.getSorting().indexOf(0);0!==t&&e.changeSorting(t,0)}}function s(e,n){var i=n.getDimensions(),o=n.getMeasures(),r=t.getValue(e,"color.mode");i.length>1&&e.color?e.color.persistent=true:"byDimension"===r&&o.length>1?t.setValue(e,"color.mode","byMultiple"):"byExpression"===r&&0===o.length&&t.setValue(e,"color.mode","primary")}function l(e){if(e>=2)return 1;return 15}var u={measures:{min:1,max:l,description:function e(t){var n="vertical"===t.orientation?"Visualizations.Descriptions.Height":"Visualizations.Descriptions.Width";return o.get(n)},add:function e(t,n,i){return r(i).then(function(){t.qSortBy.qSortByNumeric=-1;s(n,i);return t})},move:function e(t,n,i){a(i);s(n,i)},remove:function e(t,n,i){var o=i.getDimensions();s(n,i);if(o.length>1&&"stacked"===n.barGrouping.grouping){n.qHyperCubeDef.qMode="K";n.qHyperCubeDef.qAlwaysFullyExpanded=true}else 1===o.length&&(n.qHyperCubeDef.qMode="S")}},dimensions:{min:1,max:function e(t){if(t>=2)return 1;return 2},description:function e(t,n,i){var r,a=t.qHyperCubeDef.qDimensions.length;r=i.isAutoChart&&n>a-1?"Visualizations.Descriptions.Color":a>1&&0===n?"stacked"===t.barGrouping.grouping?"Visualizations.Descriptions.Stack":"Visualizations.Descriptions.Group":"Visualizations.Descriptions.Bar";return o.get(r)},add:function e(t,n,i){if(i.getDimensions().length>1&&"stacked"===n.barGrouping.grouping){n.qHyperCubeDef.qMode="K";n.qHyperCubeDef.qAlwaysFullyExpanded=true}return r(i).then(function(){s(n,i);return t})},move:function e(t,n,i){if(i.getDimensions().length>1&&"stacked"===n.barGrouping.grouping){n.qHyperCubeDef.qMode="K";n.qHyperCubeDef.qAlwaysFullyExpanded=true}a(i);s(n,i)},remove:function e(t,n,i){var o=i.getDimensions();s(n,i);1===o.length&&(n.qHyperCubeDef.qMode="S")}}};return u}.apply(t,i),void 0!==o&&(e.exports=o))},1525:function(e,t,n){"use strict";var i,o;!(i=[],o=function(){function e(e,t){e=e||function(){return false};t=t||1;return{get:function e(t){return!!t("integer")},set:function n(i,o){if(i){var r=e();var a=r?-1:1;a*=t;o("integer",a)}else o("integer",0)}}}function t(e){e=e||function(){return false};return{get:function t(n){var i=e()?-1:1;var o=n("integer")*i;switch(o){case-1:return"descending";case 1:return"ascending";default:return"disabled"}},set:function t(n,i){var o=e();switch(n){case"descending":i("integer",o?1:-1);break;case"ascending":i("integer",o?-1:1);break;case"disabled":i("integer",0);break;default:i("integer",void 0);break}}}}function n(e){var n=function t(){return!e||!e()};return t(n)}return{booleanConvertFunctions:e,enumConvertFunctions:t,invertedEnumConvertFunctions:n}}.apply(t,i),void 0!==o&&(e.exports=o))},1529:function(e,t,n){"use strict";var i,o;!(i=[n(91)],o=function(e){var t={measures:{min:1,max:1,description:function t(n){var i="horizontal"===n.orientation?"properties.xAxis":"properties.yAxis";return e.get(i)},add:function e(){},move:function e(){},remove:function e(){}},dimensions:{min:1,max:2,description:function t(n,i){var o;o=0===i?"Visualizations.Descriptions.Box":"horizontal"===n.orientation?"properties.yAxis":"properties.xAxis";return e.get(o)},add:function e(){},move:function e(){},remove:function e(){}}};return t}.apply(t,i),void 0!==o&&(e.exports=o))},1533:function(e,t,n){"use strict";var i,o;!(i=[n(101),n(91)],o=function(e,t){function n(t,n){var i=n.getMeasures(),o=e.getValue(t,"color.mode");"byDimension"===o&&1===i.length&&"line"===e.getValue(i[0].qDef,"series.type")?e.setValue(t,"color.mode","primary"):"byDimension"===o&&i.length>1&&e.setValue(t,"color.mode","byMultiple")}function i(e,t){var n=0===t.indexOf(e);n||(e.qDef.series={axis:1,type:"line"})}return{dimensions:{min:1,max:1,description:function e(n){var i=n.qHyperCubeDef.qMeasures,o=[0,0,0],r,a=["Visualizations.Descriptions.Marker","Visualizations.Descriptions.Line","Visualizations.Descriptions.ComboChart.Dimension.LineMarker","Visualizations.Descriptions.Bar","Visualizations.Descriptions.ComboChart.Dimension.BarMarker","Visualizations.Descriptions.ComboChart.Dimension.BarLine","Visualizations.Descriptions.ComboChart.Dimension.BarLineMarker"];if(!i.length)return t.get("Visualizations.Descriptions.Bar");for(var s=0;s<i.length;++s){r=i[s].qDef.series.type;"bar"===r?o[0]=1:"line"===r?o[1]=1:o[2]=1}var l=a[parseInt(o.join(""),2)-1];return t.get(l)},add:function e(t,i,o){n(i,o)},move:function e(t,i,o){n(i,o)}},measures:{min:1,max:15,description:function e(n,i){var o,r=n.qHyperCubeDef.qMeasures[i];if(r){var a=r.qDef.series.type;o="line"===a?"Visualizations.Descriptions.ComboChart.Measure.HeightLine":"bar"===a?"Visualizations.Descriptions.ComboChart.Measure.HeightBar":"Visualizations.Descriptions.ComboChart.Measure.HeightMarker"}else o="Visualizations.Descriptions.Height";return t.get(o)},add:function e(t,o,r){n(o,r);i(t,o.qHyperCubeDef.qMeasures)},move:function e(t,i,o){n(i,o)},replace:function e(t,n){n.qDef.series&&(t.qDef.series.type=n.qDef.series.type||"bar")}}}}.apply(t,i),void 0!==o&&(e.exports=o))},1569:function(e,t,n){"use strict";var i,o;!(i=[n(91)],o=function(e){function t(e,t){2===t.qHyperCubeDef.qInterColumnSortOrder.length?t.qHyperCubeDef.qInterColumnSortOrder=[1,0]:3===t.qHyperCubeDef.qInterColumnSortOrder.length&&(t.qHyperCubeDef.qInterColumnSortOrder=[1,2,0])}function n(e,t){var n=t.getDimensions();n.length>1&&e.color&&(e.color.point.persistent=true)}var i={measures:{min:1,max:1,description:function t(n){var i="horizontal"===n.orientation?"properties.xAxis":"properties.yAxis";return e.get(i)},add:function e(){},move:function e(){},remove:function e(){}},dimensions:{min:1,max:2,description:function t(n,i){var o;o=0===i?"Visualizations.Descriptions.Point":"horizontal"===n.orientation?"properties.yAxis":"properties.xAxis";return e.get(o)},add:function e(i,o,r){t(i,o);n(o,r)},move:function e(i,o,r){t(i,o);n(o,r)},remove:function e(i,o,r){t(i,o);n(o,r)}}};return i}.apply(t,i),void 0!==o&&(e.exports=o))},1570:function(e,t,n){"use strict";var i,o;!(i=[n(198)],o=function(e){var t;t=e.extend("FieldApi",{init:function e(t){this._super(t,"/dimensions");this.cacheCube.setMethodName("getListObjectData")},updateCache:function e(){},getProperties:function e(){return this.model.getProperties()},getData:function e(t){return this.cacheCube.getData(t)},getSize:function e(){return this.model.layout.qListObject.qSize},isLocked:function e(){return this.model.layout.qListObject.qDimensionInfo.qLocked}});return t}.apply(t,i),void 0!==o&&(e.exports=o))},1571:function(e,t,n){"use strict";var i,o;!(i=[],o=function(){var e,t,n,i;i={qSortByState:1,qSortByAscii:1,qSortByNumeric:1,qSortByLoadOrder:1};e={uses:"settings",items:{general:{items:{showTitles:{defaultValue:false}}}}};t={type:"array",component:"filterpane-data",translation:"Common.Data",allowAdd:true,allowRemove:true,allowMove:true,addTranslation:"properties.dimensions.add",grouped:false,ref:"qChildListDef",items:{libraryId:{type:"string",component:"library-item",libraryItemType:"dimension",ref:"qListObjectDef.qLibraryId",translation:"Common.Dimension",show:function e(t){return t.qListObjectDef.qLibraryId}},field:{type:"string",component:"expression",expressionType:"dimension",ref:"qListObjectDef.qDef.qFieldDefs.0",translation:"Common.Field",show:function e(t){return!t.qListObjectDef.qLibraryId},change:function e(t){var n=t.qListObjectDef.qDef;n.qFieldLabels||(n.qFieldLabels=[]);n.qFieldLabels[0]=n.qFieldDefs[0]}},title:{ref:"title",type:"string",expression:"optional",translation:"Common.Title"},autoSort:{ref:"qListObjectDef.qDef.autoSort",type:"boolean",defaultValue:true,show:false},cId:{ref:"qListObjectDef.qDef.cId",type:"string",show:false}}};n={type:"items",component:"filterpane-sorting",translation:"properties.sorting",allowMove:true,schemaIgnore:true,items:{autoSort:{ref:"qListObjectDef.qDef.autoSort",type:"boolean",translation:"properties.sorting",component:"switch",defaultValue:true,options:[{value:true,translation:"Common.Auto"},{value:false,translation:"Common.Custom"}],change:function e(t){if(t.qListObjectDef.qDef.autoSort){var n=t.qListObjectDef;for(var o=0;o<n.qDef.qSortCriterias.length;o++)n.qDef.qSortCriterias[o]=i}}},dimension:{component:"sorting-dimension",ref:"qListObjectDef",show:function e(t){return!t.qListObjectDef.qDef.autoSort},sortingItems:{state:true,expression:true,frequency:true,numeric:true,ascii:true}}}};return{type:"items",component:"accordion",items:{data:t,sorting:n,settings:e}}}.apply(t,i),void 0!==o&&(e.exports=o))},1572:function(e,t,n){"use strict";var i,o;!(i=[n(238),n(153),n(130),n(90),n(115)],o=function(e,t,n,i,o){var r=1e3;var a=e.extend({init:function e(t){this._super(t);this.dimensionLayout=[];this.dimensions=[]},autoSortDimension:function e(i){return i.qLibraryId?this.app.getDimensionList().then(function(e){var o=n.findLibraryDimension(i.qLibraryId,e);var r=o?o.qData.info:void 0;t.autoSortDimension(i,r);return i}):this.app.getFieldList().then(function(e){var o=n.findField(i.qDef.qFieldDefs[0],e);var r=o?[o]:void 0;t.autoSortDimension(i,r);return i})},getDimensions:function e(){return this.dimensions||[]},minDimensions:function e(){return 1},maxDimensions:function e(){return 1e3},setModel:function e(t){this.model=t},addDimension:function e(t){var n,a,s=this;t.qDef.cId=i.generateId();t.qShowAlternatives=true;if(this.getDimensions().length<r){n=o.getType("listbox");a=n.getInitialProperties({});return a.then(function(e){return s.autoSortDimension(t).then(function(){e.qListObjectDef=t;if(t.qLibraryId)return s.app.getDimension(t.qLibraryId).then(function(t){return t.getProperties().then(function(t){t.qDim.qLabelExpression?e.title={qStringExpression:{qExpr:t.qDim.qLabelExpression}}:e.title=t.qDim.title;return s.model.createChild(e,s.properties).then(function(){return e.qListObjectDef})})});e.title=t.qDef.title||t.qDef.qFieldLabels[0]||t.qDef.qFieldDefs[0];return s.model.createChild(e,s.properties).then(function(){return e.qListObjectDef})})})}},removeDimension:function e(t){var n=this.layout.qChildList.qItems[t];return this.model.destroyChild(n.qInfo.qId,this.properties).then(function(){return n})},getDimensionLayouts:function e(){return this.dimensionLayout||[]},getDimensionLayout:function e(t){var n=this.getDimensionLayouts();return n[t]?n[t].qListObject.qDimensionInfo:""}});return a}.apply(t,i),void 0!==o&&(e.exports=o))},1573:function(e,t){e.exports='<qv-filterpane\n\t\tclass="qv-filterpane"\n\t\tqv-collapsed-listbox-delegated-open\n\t\toutside-ignore-name="outsideIgnoreName"\n\t\tinteractive="interactive"\n\t\tqva-direction x-dir-setting="{{options.direction}}"\n\t\tng-class="{\'qv-filterpane-scrollable\': !hasExpanded && !options.zoomEnabled}"\n\t\tng-attr-aria-hidden="{{accessibleFilterpane ? \'false\' : \'true\'}}"\n\t\tng-keydown="handleKeyDown($event)"\n\t\trole="list">\n\t<div ng-repeat="column in columns"\n\t\t class="qv-filterpane-column"\n\t\t ng-class="{ \'qv-fullscreen-hidden\': !hasFocus() && $last && column.showAll && !object.expanded }"\n\t\t role="presentation">\n\t\t<div ng-repeat="item in column.items"\n\t\t\t ng-class="{\'qv-filterpane-collapsed\': !item.expand, \'qv-filterpane-expanded\': item.expand}"\n\t\t\t ng-style="{height: item.height}"\n\t\t\t tid="qv-object-filterpane.dimension"\n\t\t\t qv-focusable-filterpane-item="{ type: \'item\' }"\n\t\t\t tabindex="-1"\n\t\t\t role="listitem">\n\t\t\t<qv-object ng-if="item.expand" model="item.model" options="item.options" object="item.object" ng-click="setFocusInListbox()"></qv-object>\n\t\t\t<qv-collapsed-listbox ng-if="!item.expand" model="item.model" read-direction="options.direction" outside-ignore-name="outsideIgnoreName" responsive-mode="item.responsiveMode" interactive="interactive"></qv-collapsed-listbox>\n\t\t</div>\n\n\t\t<div ng-if="column.showAll && object.expanded"\n\t\t\tclass="qv-filterpane-collapsed qv-filterpane-showall"\n\t\t\tqv-focusable-filterpane-item="{ type: \'fullscreen\' }"\n\t\t\ttabindex="-1"\n\t\t\trole="listitem"\n\t\t>\n\t\t\t<span class="lui-icon lui-icon--more" aria-hidden="true"></span>\n\t\t\t<div class="presentation" q-title-translation="Tooltip.Filterpane.NotAllItemsShow"></div>\n\t\t</div>\n\n\t\t<div ng-if="column.showAll && !object.expanded"\n\t\t\t class="qv-filterpane-collapsed qv-filterpane-fullscreen"\n\t\t\t qv-focusable-filterpane-item="{ type: \'fullscreen\' }"\n\t\t\t aria-label="{{fullscreenButtonLabel}}"\n\t\t\t tabindex="-1"\n\t\t\t role="listitem">\n\t\t\t<button class="lui-button"\n\t\t\t\tng-class="{ \'lui-disabled\': !object.inAnalysisState() }"\n\t\t\t\tqva-activate="triggerFullScreen()"\n\t\t\t\tq-title-translation="Tooltip.Filterpane.ClickForFullScreen"\n\t\t\t\ttabindex="-1"\n\t\t\t>\n\t\t\t\t<span class="lui-icon lui-icon--more lui-button__icon" aria-hidden="true"></span>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n</qv-filterpane>\n'},1574:function(e,t,n){"use strict";var i,o;!(i=[n(10),n(48),n(50),n(101)],o=function(e,t,n,i){var o=34,r=28,a=10,s=89,l=160,u=20,c=47,d=30;t.service("qvFilterpaneLayout",function(){return{getMaxColumns:function e(t){return n.isSmallDevice?1:Math.floor((t.width+u)/(l+u))||1},getMaxItemsPerColumn:function e(t){return Math.max(1,Math.floor((t.height+a)/(o+a)))},getDimensionCount:function e(t){return t.qChildList.qItems.length},getColumnItemsCount:function e(t){var n=0;t.forEach(function(e){n+=e.itemCount});return n},getHeightOf:function e(t){var n=(o+a)*t-a;return Math.max(n,0)},getDimensionCardinal:function e(t){var n=i.getValue(t,"model.layout.qListObject.qDimensionInfo.qStateCounts",void 0);if(!n)return;return Object.keys(n).reduce(function(e,t){return e+n[t]},0)},getHeightOfExpanded:function e(t){var n=t*d+c+3;return n},doesAllFit:function e(t,n,i){return i<=t*n},haveRoomToExpandOne:function e(t,i){var o=i.itemCount>1?a:0;return!n.isSmallDevice&&t.height>this.getHeightOf(i.itemCount-1)+s+o},getSize:function e(t,n){return{width:t.innerWidth()-1,height:t.innerHeight(),dimensionCount:this.getDimensionCount(n)}},sizeChanged:function t(n,i){return!e.equals(n,i)},calculateColumns:function e(t,i,o){var l=!n.isSmallDevice&&t.height>s,u=this.getMaxColumns(t),c=this.getMaxItemsPerColumn(t),d=this.getColumnItemsCount(i);if(l&&this.doesAllFit(c,u-i.length-1,t.dimensionCount-d-1)){i.push({expand:true,itemCount:1});d+1<t.dimensionCount&&this.calculateColumns(t,i,o)}else{var p;p=Math.min(t.dimensionCount-d,c);if(n.isSmallDevice)p=t.dimensionCount-d;else if(!o){p=Math.ceil((t.dimensionCount-d)/(u-i.length));p=Math.max(c,p);p=Math.min(t.dimensionCount-d,p)}i.push({expand:false,itemCount:p});if(i.length>=u&&c>0&&this.getColumnItemsCount(i)<t.dimensionCount){i[i.length-1].showAll=true;r+a>t.height-this.getHeightOf(c)&&(i[i.length-1].itemCount=Math.max(i[i.length-1].itemCount-1,0))}this.getColumnItemsCount(i)<t.dimensionCount&&i.length<u&&this.calculateColumns(t,i,o)}},balanceColumns:function e(t,n){var i,o,r;i=n.filter(function(e){return e.expand});o=n.filter(function(e){return false===e.expand});if(o.length>0&&!o[o.length-1].showAll&&this.haveRoomToExpandOne(t,o[o.length-1]))o[o.length-1].expand=true;else{r=this.getColumnItemsCount(o);o.forEach(function(e,t){var n,i;n=t<r%o.length?1:0;i=Math.floor(r/o.length)+n;e.itemCount=i},this)}return o.concat(i)},getDimensions:function e(t){return t.qChildList.qItems.map(function(e){return{id:e.qInfo.qId,expand:false,height:void 0,responsiveMode:"full"}})},sortDimensions:function e(t,n){var i;i=t.qChildList.qItems.map(function(e){return e.qInfo.qId});return i.map(function(e){return n.filter(function(t){return t.id===e})[0]})},isValid:function e(t){return!!t&&!!t.qChildList&&!!t.qChildList.qItems&&this.getDimensionCount(t)>0},mergeColumnsAndDimensions:function e(t,n){t.forEach(function(e){e.items=n.slice(0,e.itemCount);n=n.slice(e.itemCount)},this);return t},reSizeArray:function e(t,n,i,o){while(t.length>n)t.pop();while(t.length<n)t.push(i.extend(true,{},o))},dimensionsEqual:function e(t,n){return t.id===n.id&&t.expand===n.expand&&t.height===n.height},shouldDimensionBeUpdated:function e(t,n){return!this.dimensionsEqual(t,n)},patchScope:function e(t,n,i){this.resizeScopeArrays(t,n,i);t.columns.forEach(function(e,i,o){var r=n[i];o[i].showAll=r.showAll;o[i].expand=r.expand;o[i].itemCount=r.itemCount;e.items.forEach(function(e,n){var o=r.items[n];if(this.shouldDimensionBeUpdated(e,o)){e.colIdx=i;e.rowIdx=n;o.expand||delete e.options;o.expand&&!e.options&&(e.options={isPopover:false,isReadonly:t.object.isReadonly,interactionState:t.options.interactionState,card:t.options.card,selections:t.options.selections,navigation:t.options.navigation,direction:t.options.direction});this.copyDimensionValues(o,e)}},this)},this)},expandOne:function e(t,n){var i,o,r;for(i=0;i<t.length;i++){o=t[i];if(o.cardinal&&!o.expand){r=this.getHeightOfExpanded(o.cardinal);if(r<n){o.expand=true;o.height=r+"px";return r+a}}}return false},calculateExpandPriority:function e(t,n){t.forEach(function(e){if(e.expand){var t=0,i,r,l=n.height-this.getHeightOf(e.itemCount-1)-a,u=0;e.items.forEach(function(e){e.cardinal=this.getDimensionCardinal(e)}.bind(this));i=e.items.concat().sort(function(e,t){return e.cardinal-t.cardinal});if(i.length>1){while(l>s){var c=this.expandOne(i,l);if(!c)break;t++;u+=c;l=n.height-this.getHeightOf(e.itemCount-t)-u}var d=i.filter(function(e){return e.expand});u=0;d.forEach(function(e){u+=this.getHeightOfExpanded(e.cardinal)+a},this);l=n.height-this.getHeightOf(e.itemCount-d.length)-u}r=i.filter(function(e){return!e.expand});if(l>s&&r.length){var p=r[0],f=r.length>1?a:0;if(!p.expand){i.length>1&&(p.height=n.height-this.getHeightOf(r.length-1)-u-f+"px");p.expand=true}}}if(1===e.items.length&&n.height<o-4){e.items[0].responsiveMode=n.height<.5*o?"spark":"small";e.items[0].height=n.height+"px"}},this)},resolveAllModels:function e(t,n,i,o){var r=[];n.forEach(function(e,n){var o=t.columns[n]||{items:[]};e.items.forEach(function(e,t){var n=o.items[t]||{};this.shouldDimensionBeUpdated(e,n)||!n.model?r.push(i(e)):e.model=n.model},this)},this);return o.all(r)},resizeScopeArrays:function e(t,n,i){t.columns.length!==n.length&&this.reSizeArray(t.columns,n.length,i,{items:[]});t.columns.forEach(function(e,o){e.items.length!==n[o].items.length&&this.reSizeArray(t.columns[o].items,n[o].items.length,i,{})},this)},copyDimensionValues:function e(t,n){Object.keys(t).forEach(function(e){n[e]=t[e]})},getResolveModelFunction:function e(t){return function(e){return this.resolveModel(e,t)}.bind(this)},resolveModel:function e(t,n){return n.getObject(t.id).then(function(e){t.model=e;return e.getLayout()})}}})}.apply(t,i),void 0!==o&&(e.exports=o))},1575:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(11),n(106),n(1576),n(100),n(50),n(392),n(290),n(289)],o=function(e,t,n,i,o,r){e.directive("qvCollapsedListbox",function(){return{restrict:"E",replace:true,template:i,scope:{model:"=",outsideIgnoreName:"=",responsiveMode:"=",interactive:"=",readDirection:"="},require:"^?qv-collapsed-listbox-delegated-open",link:function t(i){var r=o.initializeService("object.listBox");var a=function e(){i.backgroundStyle={"background-color":r.getStyle("","backgroundColor")};i.listStyle={color:r.getStyle("title.main","color"),"font-size":r.getStyle("title.main","fontSize")}};a();o.ThemeChanged.bind(a);i.$on("$destroy",function(){o.ThemeChanged.unbind(a)});i.title="";i.hasError=false;i.isLocked=false;i.options={direction:i.readDirection};n(i,"model",function(t){e.$apply(i,function(){var e=t.qListObject.qDimensionInfo;i.hasError=!(!t.qListObject.qError&&!t.qListObject.qDimensionInfo.qError);i.stateCounts=e.qStateCounts;i.isLocked=e.qStateCounts.qLocked>0;i.isDrillDown="H"===e.qGrouping;i.title=t.title;i.id=t.qInfo.qId})})}}});e.directive("qvCollapsedListboxDelegatedOpen",function(){return{restrict:"A",scope:{outsideIgnoreName:"=",interactive:"=?"},controller:["$scope","$element","qvListboxPopoverService","qvListboxPopoverServiceMobile",function(e,n,i,o){var a;e.$on("openPopover",function(e,n){var i=t(n.target).find(".qv-collapsed-listbox");s(i,true)});var s=function s(l,c){var d=l.isolateScope().model,p=l.isolateScope().id,f=l.isolateScope().options.direction,h={qvaOutsideIgnoreFor:e.outsideIgnoreName,$alignToElement:l,position:u(l,n),collision:"flipfit",direction:f};if(!e.interactive)return;if(p===a){r.isSmallDevice?o.close():i.close();a=void 0;return}a=p;var g=r.isSmallDevice?o.show(d,h):i.show(d,h);var m;if(!r.isSmallDevice){g.closing.then(function(e){e&&!t(e.target).closest(".qv-collapsed-listbox").length>0&&(a=void 0);m=e});g.closed.then(function(){g=null;m||(a=void 0);c&&l.closest(".qv-filterpane-collapsed").focus()})}};n.on("qv-activate",".qv-collapsed-listbox:not(.error)",function(e){e.preventDefault();var n=t(e.target).closest(".qv-collapsed-listbox");s(n,false)});function l(e,t){return{left:e.position().left-t.position().left,top:e.position().top-t.position().top,right:t.width()-e.position().left-e.width(),bottom:t.height()-e.position().top-e.height()}}function u(e,t){var n=l(e,t),i;i=Math.max(n.left,n.right)>Math.max(n.top,n.bottom)?n.left>n.right?"left":"right":n.top>n.bottom?"top":"bottom";return i}}]}})}.apply(t,i),void 0!==o&&(e.exports=o))},1576:function(e,t){e.exports='<div class="qv-collapsed-listbox"\n\t ng-class="{locked: isLocked, error: hasError, spark: responsiveMode == \'spark\', small: responsiveMode == \'small\', interactive: interactive}"\n\t ng-style="backgroundStyle"\n\t qva-outside-ignore-for="{{outsideIgnoreName}}"\n\t qva-direction x-dir-setting="{{readDirection}}">\n\t<div class="error-layer"></div>\n\t<div class="title-wrapper" ng-style="listStyle">\n\t\t<span ng-if="isLocked" class="lui-icon lui-icon--lock" qva-direction x-dir-setting="{{readDirection}}"></span>\n\t\t<span ng-if="isDrillDown" class="lui-icon lui-icon--select-alternative" q-title-translation="Tooltip.dimensions.drilldown" x-dir-setting="{{readDirection}}"></span>\n\t\t<span class="title" ng-attr-title="{{title}}" qva-direction x-dir-setting="{{readDirection}}" x-dir-text="{{title}}">{{title}}</span>\n\t</div>\n\t<qv-state-count-bar ng-if="!hasError" state-counts="stateCounts" options="options"></qv-state-count-bar>\n</div>\n'},1577:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(167)],o=function(e,t){e.service("qvFilterPaneKeyboardNavigationService",function(){function e(e,t){var n=e.columns,i=0===n[0].itemCount,o=t?t.colIdx:0,r=t?t.rowIdx:0;e.focus={item:i?n[0].fullscreen:n[o].items[r],isFullscreenBtn:i,focusInListbox:false}}function n(e,t){var n=e.columns,o=n[n.length-1],r=e.focus;if(o.showAll)if(o.fullscreen){o.fullscreen.colIdx=n.length-1;o.fullscreen.rowIdx=o.itemCount}else o.fullscreen={colIdx:n.length-1,rowIdx:o.itemCount,id:"fullscreen"};else o.fullscreen=null;if(r&&!r.focusInListbox&&t){i(e,t);e.hasFocus()&&r.item&&r.item.focus&&r.item.focus()}}function i(e,t){var n=e.focus,i=e.columns;for(var o=0;o<i.length;++o){var r=i[o].items;for(var a=0;a<r.length;++a)if(r[a].id===t){n.item=i[o].items[a];return}}var s=i[i.length-1];if(s.showAll){n.item=s.fullscreen;n.forceFocus=e.hasFocus();n.isFullscreenBtn=true}else{n.item=s.items[s.itemCount-1];n.isFullscreenBtn=false}}function o(e,n){var i=e.focus,o=i.item.rowIdx,r=i.item.colIdx,a=e.columns,s=a.length-1,l=i.isFullscreenBtn?o-1:a[r].itemCount-1,u=!a[s].itemCount,c=a[s].fullscreen;switch(n){case t.ARROW_UP:if(o>0){o-=1;i.isFullscreenBtn=false}else if(0===o&&r>0){r-=1;o=a[r].itemCount-1;i.isFullscreenBtn=false}break;case t.ARROW_DOWN:if(o<l)o+=1;else if(o===l)if(c&&r===s)i.isFullscreenBtn=true;else if(r<s){r+=1;o=0;i.isFullscreenBtn=r===s&&u}break;case t.ARROW_RIGHT:if(r<s){r+=1;o=0;i.isFullscreenBtn=r===s&&u}break;case t.ARROW_LEFT:if(r>0){r-=1;o=0;i.isFullscreenBtn=false}break}i.item=i.isFullscreenBtn?c:a[r].items[o];i.item.focus()}return{init:e,updateFocus:n,setFocusById:i,handleNavigation:o}})}.apply(t,i),void 0!==o&&(e.exports=o))},1578:function(e,t,n){"use strict";var i,o;!(i=[n(48)],o=function(e){var t="qvFocusableFilterpaneItem";e.directive(t,[function(){return{restrict:"A",link:function e(n,i,o){var r=n.$eval(o[t]).type;n.$on("listboxBlur",function(){var e;n.item&&(e={colIdx:n.item.colIdx,rowIdx:n.item.rowIdx});n.setFocus(e)});n.$on("listTab",function(){n.focus.item.blur()});function a(){i[0].setAttribute("tabindex",0);i[0].focus()}function s(){i[0].setAttribute("tabindex",-1)}if("item"===r){n.item.focus=a;n.item.blur=s;n.focus&&(n.focus.shouldResetFocus?n.setFocus({colIdx:0,rowIdx:0}):n.hasFocus()&&n.focus.item.id===n.item.id&&n.focus.item.focus())}else if("fullscreen"===r){n.column.fullscreen||(n.column.fullscreen={});n.column.fullscreen.focus=a;n.column.fullscreen.blur=s;if(n.focus)if(n.focus.shouldResetFocus){n.setFocus({colIdx:0,rowIdx:0});n.focus.shouldResetFocus=true}else if(n.focus.isFullscreenBtn){n.focus.item=n.column.fullscreen;(n.hasFocus()||n.focus.forceFocus)&&n.focus.item.focus()}}}}}])}.apply(t,i),void 0!==o&&(e.exports=o))},1579:function(e,t,n){"use strict";var i,o;!(i=[n(180),n(291),n(1580),n(1260),n(100),n(109),n(89)],o=function(e,t,n,i,o,r,a){var s;var l=i.getPropertyLogic();function u(e,n){if(!this._axis||!this._segmentInfo||void 0===this._axis.getPlotMin()||void 0===this._axis.getPlotMax())return a.resolve();var i=this._axis,o=this._style.value.font,s=i.isVertical(),l=t.getFontHeight(o),u=this.renderers.gauge.getTextWidth(e,o),c=this._axis.getPositionOfValue(n),d=(n-i.getPlotMin())/(i.getPlotMax()-i.getPlotMin()),p,f=[];if(this._data.useSegments){p=this._gaugeHelper.createBarSegments(this._segmentInfo,i,s,this.rect,d,this.yMirrorMode);f=p.shapes;f=f.concat(this._gaugeHelper.createGaugeMeterPointer(d,i,s,p.pointerBgColor,this.yMirrorMode))}else{f=this._gaugeHelper.createBarProgress(d,i,this._progressColor,s,this.rect);(d>1||d<0)&&(f=f.concat(this._gaugeHelper.createGaugeMeterPointer(d,i,s,new r(d>1?this._progressColor:this._style.area.color),this.yMirrorMode)))}!Number.isNaN(+d)&&(s&&this.rect.width>100||!s&&this.rect.height>100)&&f.push(this._gaugeHelper.createGaugeMeterValue(c,e,u,s,this.rect,l,o,this.yMirrorMode));this.renderers.gauge.stage.removeChildren();this.renderers.gauge.stage.addChildren(f);return this.renderers.gauge.render()}function c(e,n){if(!this._axis||!this._segmentInfo&&this._data.useSegments||this._axis._radius<=0)return a.resolve();var i=this._axis,o=this._style.value.font,r=t.getFontHeight(o),s=Math.min(this.rect.height,this.rect.width),l=(n-i.getPlotMin())/(i.getPlotMax()-i.getPlotMin()),u=[];if(s<50)u=this._gaugeHelper.createRadialSpark(l,this._data.useSegments?this._segmentInfo:this._progressColor,i,this.rect);else{if(this._data.useSegments){u=this._gaugeHelper.createRadialSegments(this._segmentInfo,i);Number.isNaN(+l)||u.push(this._gaugeHelper.createRadialGaugeMeter(l,i))}else u=this._gaugeHelper.createRadialProgress(l,this._progressColor,i,this.rect);u=u.concat(this._gaugeHelper.createRadialGaugeValue(n,e,i,this.rect,o,r))}this.renderers.gauge.stage.removeChildren();this.renderers.gauge.stage.addChildren(u);return this.renderers.gauge.render()}function d(e){return{value:{color:e.getStyle("label.value","color"),font:"normal "+e.getStyle("label.value","fontSize")+" 'QlikView Sans'",minFontSize:12,maxFontSize:60},area:{color:"#eeeeee"},pointer:{color:{light:"#E6E6E6",dark:"#595959"}}}}s=e.extend({init:function e(){this._super.apply(this,arguments);this._gaugeHelper=new n;this._type="bar";this._currentProperties={};this._transitionProperties={};this._inTransition=false;this._cacheItems=[];this.renderers={gauge:new t(this.container)};this._styleService=o.initializeService("object.gauge")},_updateSize:function e(){this.invalidateDisplay("Gauge._updateSize")},_updateProperties:function e(){if(!this._data)return;var t=this._data;this._segmentInfo={};var n=t.qHyperCube.qMeasureInfo[0].coloring?t.qHyperCube.qMeasureInfo[0].coloring.gradient:null;if(t.color&&"measure"===t.color.useBaseColors&&n){if("percent"===n.limitType){var o=t.measureAxis.max-t.measureAxis.min;this._segmentInfo.limits=n.limits.map(function(e,i){return{value:t.measureAxis.min+e*o,gradient:n.breakTypes[i]}})}else this._segmentInfo.limits=n.limits.map(function(e,t){return{value:e,gradient:n.breakTypes[t]}});this._segmentInfo.colors=n.colors.map(function(e){return{color:i.resolveColor(e)}})}else{t.segmentInfo&&t.segmentInfo.limits&&(this._segmentInfo.limits=t.segmentInfo.limits.concat().sort(function(e,t){return e.value-t.value}));if(t.segmentInfo){var r=i.getSegmentColors(t.segmentInfo);r&&(this._segmentInfo.colors=r.map(function(e,n){return{color:i.resolveColorSegment(t.segmentInfo,n)}}))}}var a=this._data.paletteProgressColor||this._data.progressColor||l.color.paletteColor.defaultValue();this._progressColor=i.getProgressColor(t,t.qHyperCube.qMeasureInfo[0].coloring,i.resolveColor(a));this._orientation=t.orientation;this._type=t.gaugetype;this._transitionProperties={value:t.qHyperCube.qDataPages[0].qMatrix[0][0].qNum,text:t.qHyperCube.qDataPages[0].qMatrix[0][0].qText};this._super()},hasValidData:function e(){return this._super()&&this._data},setAxis:function e(t){this._axis=t;this._axis.listen("changed",function(){this.invalidateDisplay()},this)},setRefLines:function e(t){this._refLines=t},setRefLineLabels:function e(t){this._refLineLabels=t},setColorMap:function e(t){this._colorMap=t},getColorMap:function e(){return this._colorMap},paint:function e(){if(!this._axis)return a.resolve();this._style=d(this._styleService);this._gaugeHelper.style=this._style;var t=[];this._gaugeHelper.updateSize(this.rect,this._axis.isVertical(),this._axis.isRadial());if(this._refLines){this._refLines.setPaddingToAxis(this._gaugeHelper.getPaddingToAxis());this._refLines.setRelevantPos(this._gaugeHelper.getRelevantPos())}if(this._refLineLabels){this._refLineLabels.setPaddingToAxis(this._gaugeHelper.getPaddingToAxis());this._refLineLabels.setRelevantPos(this._gaugeHelper.getRelevantPos())}this._gaugeHelper.updateLabelStyle(this._style,this.rect);var n=this._data.qHyperCube.qDataPages[0].qMatrix[0][0],i=this.measureFormatters[0],o=i&&"U"===i.type?i.formatValue(n.qNum):n.qText,r=this._currentProperties.value;this._inTransition&&i&&(o=i.format(r));this._axis.isRadial()?t.push(c.apply(this,[o,r])):t.push(u.apply(this,[o,r]));this._currentValue=r;if(this._refLines&&this._refLineLabels){this._refLines.setGaugeWidth(this._gaugeHelper.getGaugeWidth());this._refLineLabels.setGaugeWidth(this._gaugeHelper.getGaugeWidth())}return a.all(t)},afterPaint:function e(){},clear:function e(){},getGaugeWidth:function e(t,n){return this._gaugeHelper.getGaugeWidth(t,n)}});Object.defineProperty(s.prototype,"className",{value:"GaugeArea"});return s}.apply(t,i),void 0!==o&&(e.exports=o))},1580:function(e,t,n){"use strict";var i,o;!(i=[n(92),n(293),n(1002),n(1232),n(278),n(1032),n(109),n(486),n(1581)],o=function(e,t,n,i,o,r,a,s,l){var u,c=[0,1],d=[0,.5,1];function p(e,t,n){return{x0:e.x0,y0:e.y0,x1:e.x1,y1:e.y1,limits:t,colors:n}}function f(e){if(!e)return[];return e.paletteColors||e.colors}u=e.extend("GaugeHelper",{init:function e(){this._padding=0;this._colorWidth=50;this._maxWidth=50;this._labelPadding=10;this._fontManager=new l;this._fontManager.setRectLimits(100,1e3);this._bigValuesSettings={minFontSize:12,maxFontSize:60}},createBarSegments:function e(n,i,o,r,s,l){var u=f(n);if(0===u.length)return{shapes:[]};var h=[],g,m=n.limits,v,b=this._colorWidth,x,y,C,q={},D,w,I,S,L,E=false,M,_={value:0,gradient:false},A,P=new a,k=l&&!o;s=Math.min(Math.max(s,0),1);m=m.map(function(e){return{value:(e.value-i.getPlotMin())/(i.getPlotMax()-i.getPlotMin()),gradient:e.gradient}});for(g=0;g<u.length;g++){I=m[g]?m[g]:{value:1,gradient:false};x=I.value;y=0===g?0:m[g-1].value;S=i.getPositionOfNormalizedValue(x);M=i.getPositionOfNormalizedValue(y);q.current=new a(u[g].color);q.next=new a(u[g+1]?u[g+1].color:u[g].color);L=(s-y)/(x-y);E=L>=0&&L<=1;if(o){b=r.width<10?r.width:this._colorWidth;v=new t(this._relevantPos,S,b,M-S)}else{b=this._colorWidth;v=new t(M,this._relevantPos,S-M,b)}A={x0:v.x,y0:v.y+(o?v.height:0),x1:v.x+(o?0:v.width),y1:v.y};if(_&&_.gradient&&!I.gradient){q.last=a.getBlend(q.current,q.last,.5);C={gradient:p(A,c,k?[q.current.toRGBA(),q.last.toRGBA()]:[q.last.toRGBA(),q.current.toRGBA()])};D=q.last;w=q.current}else if(I.gradient){q.next=a.getBlend(q.current,q.next,.5);if(_.gradient){q.last=a.getBlend(q.current,q.last,.5);C={gradient:p(A,d,k?[q.next.toRGBA(),q.current.toRGBA(),q.last.toRGBA()]:[q.last.toRGBA(),q.current.toRGBA(),q.next.toRGBA()])};if(L>.5){L=(L-.5)/.5;D=q.last;w=q.current}else{L/=.5;D=q.current;w=q.next}}else{C={gradient:p(A,c,k?[q.next,q.current]:[q.current,q.next])};D=q.current;w=q.next}}else C=q.current.toRGBA();E&&(P=C.gradient?a.getBlend(D,w,L):q.current);v.opacity=1;v.fill=C;v.stroke=C;h.push(v);q.last=q.current;_=I}return{shapes:h,pointerBgColor:P}},createBarProgress:function e(n,i,o,r,s){var l=[],u,c,d,p,f,h=new a(o),g=new a(this.style.area.color),m;n=Number.isNaN(+n)?0:n>1?1:n<0?0:n;c=i.getPositionOfValue(i.getPlotMin());d=i.getPositionOfValue(i.getPlotMax());p=i.getPositionOfValue((i.getPlotMax()-i.getPlotMin())*n+i.getPlotMin());this._labelPadding=this._colorWidth/2;f=this._colorWidth;m=this._relevantPos;u=r?new t(m,p,f,s.height):new t(c,m,p-c,f);u.opacity=1;u.fill=h.toHex();u.stroke=h.createShiftedColor().toHex();u.strokeWidth=1;l.push(u);u=r?new t(m,0,f,p):new t(p,m,d-p,f);u.opacity=1;u.fill=g.toHex();u.stroke=g.createShiftedColor(.1).toHex();u.strokeWidth=1;l.push(u);return l},createGaugeMeterValue:function e(t,n,i,o,a,s,l,u){var c=new r;c.text=n;c.ColorWidth=200;c.font=l;c.opacity=1;c.fill=this.style.value.color;if(o){if(t+s/2>a.height){c.baseline="bottom";t=a.height}else if(t<s/2){c.baseline="top";t=0}else c.baseline="middle";c.x=u?this._relevantPos-this._labelPadding:this._relevantPos+this._colorWidth+this._labelPadding;c.maxWidth=a.width-c.x;c.y=t;c.align=u?"right":"left"}else{c.y=this._relevantPos+this._colorWidth+this._labelPadding+s;c.x=Math.max(Math.min(a.width-i/2,t),i/2);c.align="center";c.baseline="bottom"}return c},createGaugeMeterPointer:function e(t,i,r,a,s){var l=t>1?1:t<0?-1:0,u,c=[],d=this._relevantPos,p=Math.max(Math.round(this._colorWidth/25),2),f=50,h=d<f?10:this._colorWidth,g=Math.max(h,10)/6,m=a.isDark()?this.style.pointer.color.light:this.style.pointer.color.dark,v=new o,b=new n,x=!r&&s?1:-1;b.opacity=1;b.stroke=m;b.strokeWidth=p;v.opacity=1;v.fill=m;v.strokeWidth=p;t=t>1?1:t<0?0:t;u=i.getPositionOfValue((i.getPlotMax()-i.getPlotMin())*t+i.getPlotMin());if(r){if(0!==l){v.set([{x:d+h/2,y:u},{x:d-g+h/2,y:l*g*2+u},{x:d+g+h/2,y:l*g*2+u}]);c.push(v)}b.set(d,u,d+h,u)}else{if(0!==l){v.set([{y:d+h/2,x:u},{y:d-g+h/2,x:x*l*g*2+u},{y:d+g+h/2,x:x*l*g*2+u}]);c.push(v)}b.set(u,d,u,d+h)}c.push(b);return c},updateLabelStyle:function e(t,n){this._bigValuesSettings={minFontSize:this.style.value.minFontSize,maxFontSize:this.style.value.maxFontSize};t.value.font="normal "+this._fontManager.getFontSize(n,this._bigValuesSettings)+"px 'QlikView Sans'"},createRadialSegments:function e(t,n){var o=f(t);if(0===o.length)return[];var r=[],s,l=t.limits,u,h,g,m=this._colorWidth,v,b=o[0].color,x,y={value:0,gradient:false},C,q,D=n.getAngleOfNormalizedValue(0),w=this._paddingToAxis;l=l.map(function(e){return{value:(e.value-n.getPlotMin())/(n.getPlotMax()-n.getPlotMin()),gradient:e.gradient}});m=this._colorWidth*(n._relevantAngle>Math.PI?1:Math.sin(n._relevantAngle/4));this._colorWidth=m;if(n._radius-m-w<0)return r;for(s=0;s<o.length;s++){h=l[s]?l[s]:{value:1,gradient:false};x=o[s+1]?o[s+1].color:o[s].color;u=o[s].color;v=n.getAngleOfNormalizedValue(h.value);g=new i(n._centerPoint.x,n._centerPoint.y,n._radius-m-w,n._radius-w,Math.min(D,v),Math.max(D,v),0);q={x0:g.x3,y0:g.y3,x1:g.x4,y1:g.y4};if(y&&y.gradient&&!h.gradient){x=new a(u).blend(new a(b),.5);C={gradient:p(q,c,[x,u])}}else if(h.gradient){x=new a(u).blend(new a(x),.5);if(y.gradient){b=new a(u).blend(new a(b),.5);C={gradient:p(q,d,[b,u,x])}}else C={gradient:p(q,c,[u,x])}}else C=u;g.opacity=1;g.fill=C;g.stroke=C;r.push(g);D=v;y=h;b=u}return r},createRadialGaugeMeter:function e(t,n){var i=s.getAngleOfNormalizedValue(t,n),r=Math.max(this._colorWidth,10)/6,a=2,l,u,c=t>1?-1:1,d;if(t>1||t<0){u=this._colorWidth*(n._relevantAngle>Math.PI?1:Math.sin(n._relevantAngle/4));this._colorWidth=u;l=-u*c/2;d=new o([{x:2*r+a,y:l},{x:a,y:r+l},{x:a,y:-r+l}])}else d=new o([{x:.5*-r+4,y:0},{x:8*-r,y:r},{x:8*-r,y:-r}]);d.opacity=1;d.translate(n._centerPoint.x+Math.cos(i)*n._radius,n._centerPoint.y+Math.sin(i)*n._radius);d.rotate(i);(t>1||t<0)&&d.rotate(-c*Math.PI/2);d.fill=this.style.pointer.color.dark;return d},createRadialProgress:function e(t,n,r,l){var u=Math.min(r._radialOptions.start,r._radialOptions.end),c=Number.isNaN(+t)?u:s.getAngleOfNormalizedValue(t,r),d=Math.max(r._radialOptions.start,r._radialOptions.end),p=Math.min(l.width,l.height),f,h=[],g,m=(p>500?this._maxWidth:Math.max(p/500*this._maxWidth,10))/6,v=2,b=this._paddingToAxis,x,y=new a(this.style.area.color),C;n=new a(n);g=this._colorWidth*(r._relevantAngle>Math.PI?1:Math.sin(r._relevantAngle/4));this._colorWidth=g;if(r._radius-g-b<0)return h;if(t>1||t<0){C=t>1?-1:1;x=-g*C/2;f=new o([{x:2*m+v,y:x},{x:v,y:m+x},{x:v,y:-m+x}]);f.opacity=1;f.translate(r._centerPoint.x+Math.cos(c)*r._radius,r._centerPoint.y+Math.sin(c)*r._radius);f.rotate(c-C*Math.PI/2);f.fill=n.toHex();h.push(f)}if(u<c){f=new i(0,0,r._radius-g-b,r._radius-b,u,c,0);f.opacity=1;f.translate(r._centerPoint.x,r._centerPoint.y);f.fill=n.toHex();f.stroke=n.createShiftedColor().toHex();h.push(f)}if(d>c){f=new i(0,0,r._radius-g-b,r._radius-b,c,d,0);f.opacity=1;f.translate(r._centerPoint.x,r._centerPoint.y);f.fill=y.toHex();f.stroke=y.createShiftedColor(.1).toHex();h.push(f)}return h},createRadialGaugeValue:function e(t,n,i,o,a,s){var l=new r;l.text=n;l.x=o.width/2;l.y=.5*o.height-s/2+.05*Math.min(o.width,o.height);l.align="center";l.font=a;l.baseline="middle";l.maxWidth=1.4*i._radius;l.opacity=1;l.fill=this.style.value.color;return[l]},createRadialSpark:function e(t,n,i,r){var a=.4*Math.min(r.width,r.height),l,u=s.getAngleOfNormalizedValue(t,i)+Math.PI/2,c=0,d,p=new o;p.opacity=1;if("string"!==typeof n)if(1===n.colors.length)p.fill=n.colors[0].color;else for(l=0;l<n.colors.length;l++){d=n.limits[l]?(n.limits[l].value-i.getPlotMin())/(i.getPlotMax()-i.getPlotMin()):1;if(t>=c&&t<d){p.fill=n.colors[l].color;break}c=d}else p.fill=n;r.width<r.height?p.set([{x:0,y:-a},{x:-a/2,y:+a/2},{x:a/2,y:+a/2},{x:0,y:-a}]):p.set([{x:-a/2,y:a/2},{x:0,y:-a},{x:+a/2,y:a/2},{x:-a/2,y:a/2}]);p.translate(i._centerPoint.x,i._centerPoint.y);p.rotate(u);return[p]},getGaugeWidth:function e(t,n){var i;if(t){i=n?"width":"height";this._colorWidth=t[i]>500?this._maxWidth:Math.max(t[i]/500*this._maxWidth,10)}return this._colorWidth},updateSize:function e(t,n,i){var o=Math.min(t.width,t.height),r;r=i?o:n?t.width:t.height;this._colorWidth=r>500?this._maxWidth:Math.max(r/500*this._maxWidth,10);this._relevantPos=(r-this._colorWidth)/2;this._paddingToAxis=Math.min(6,o/200)},getPaddingToAxis:function e(){return this._paddingToAxis},getRelevantPos:function e(){return this._relevantPos},getPadding:function e(){return this._padding}});return u}.apply(t,i),void 0!==o&&(e.exports=o))},1581:function(e,t,n){"use strict";var i,o;!(i=[n(92)],o=function(e){var t;function n(e,t,n){return e<t?0:e>n?1:(e-t)/(n-t)}t=e.extend("FontManager",{init:function e(){this._minFontSize=10;this._maxFontSize=20;this._minRectSize=100;this._maxRectSize=900;this._fontWeight="normal";this._fontFamily="QlikView Sans";this._fontSize=10},setFontWeight:function e(t){this._fontWeight=t},setFontFamily:function e(t){this._fontFamily=t},setRectLimits:function e(t,n){this._minRectSize=t;this._maxRectSize=n},getFont:function e(t,i){var o=Math.min(t.height,t.width),r=i&&i.minFontSize?i.minFontSize:this._minFontSize,a=i&&i.maxFontSize?i.maxFontSize:this._maxFontSize,s=n(o,this._minRectSize,this._maxRectSize);this._fontSize=r+Math.round(s*(a-r));return this._fontWeight+" "+this._fontSize+"px "+this._fontFamily},getFontSize:function e(t,i){var o=Math.min(t.height,t.width),r=i&&i.minFontSize?i.minFontSize:this._minFontSize,a=i&&i.maxFontSize?i.maxFontSize:this._maxFontSize,s=n(o,this._minRectSize,this._maxRectSize);return r+Math.round(s*(a-r))}});return t}.apply(t,i),void 0!==o&&(e.exports=o))},1582:function(e,t,n){"use strict";var i,o;!(i=[n(1171),n(100)],o=function(e,t){var n;function i(e){if(!e||!e.paletteColor&&!e.color)return"#000000";return e.paletteColor?t.resolveColor(e.paletteColor):t.resolveColor(e.color,t.deprecatedPalette)}n=e.extend("GaugeRefLines",{namespace:".gaugereflines",init:function e(){this._super.apply(this,arguments);this._width=50},paint:function e(){this._super.apply(this,[].slice.call(arguments));if(!this._hasVisibleRefLines)return;var t,n,o,r,a,s,l,u,c,d,p,f,h,g=[],m=this._paddingToAxis,v=this._relevantPos,b,x;for(t=0;t<this._numRefLinesDataAxes;t+=1){o=this._data[t];r=this._axes[t];a=this._axisPlotMinValues[t];s=this._axisPlotMaxValues[t];for(n=0;n<o.length;n+=1){if(!o[n].show||void 0===o[n].refLineExpr)continue;l=this._currentProperties["value"+t+n];if(l>s||l<a)continue;if(r.isRadial()){b=r._radius;x=r.getAngleOfValue(l);c=r._centerPoint.x+Math.cos(x)*(b-m);d=r._centerPoint.y+Math.sin(x)*(b-m);p=r._centerPoint.x+Math.cos(x)*(b-m-this._width);f=r._centerPoint.y+Math.sin(x)*(b-m-this._width)}else{u=r.getPositionOfValue(l);u=Math.floor(u)-.5;if(r.isVertical()){c=v;d=u;p=v+this._width;f=u}else{c=u;d=v;p=u;f=v+this._width}}h=i(o[n]);g.push({type:"line",stroke:h,strokeWidth:1,shape:{x1:c,y1:d,x2:p,y2:f}})}}this.renderer.shapes=g;this.renderer.render()},setGaugeWidth:function e(t){this._width=t;this.updateSize();this.invalidateDisplay()},setPaddingToAxis:function e(t){this._paddingToAxis=t},setRelevantPos:function e(t){this._relevantPos=t}});return n}.apply(t,i),void 0!==o&&(e.exports=o))},1583:function(e,t,n){"use strict";var i,o;!(i=[n(1172),n(1032),n(100)],o=function(e,t,n){var i;function o(e){return String(void 0!==e.label?e.label:e)}function r(e){if(!e||!e.paletteColor&&!e.color)return"#000000";return e.paletteColor?n.resolveColor(e.paletteColor):n.resolveColor(e.color,n.deprecatedPalette)}i=e.extend("GaugeRefLineLabels",{init:function e(){this._super.apply(this,arguments)},paint:function e(){if(!this._axis){this._clearLabels();return}this._axis.updateNow(["properties"]);if(this._plotMinValue!==this._axis.getPlotMin()||this._plotMaxValue!==this._axis.getPlotMax()){this._hasVisibleRefLines=this.checkIfHavingVisibleRefLines();this.updateLocalPlotMaxMinValues.call(this)}if(!this._hasVisibleRefLines){this._clearLabels();return}var n,i,a,s,l,u,c,d,p,f,h,g="bottom",m=this._relevantPos,v=[],b=[],x=this._axis,y,C,q,D,w,I,S,L;for(n=0;n<this._data.length;n+=1){if(!this._data[n].show||void 0===this._data[n].refLineExpr)continue;i=this._currentProperties["value"+n];a=o(this._data[n].refLineExpr);if(void 0===i||Number.isNaN(+i)||i<this._axis.getPlotMin()||i>this._axis.getPlotMax())continue;D=new t;D.font=this._style.label.font;D.maxWidth=this._labelMaxWidthForYAxis;D.maxNumLines=3;h=a;f=h.replace(/[0-9]|\.|-|\+|e/g,"");f=f.length?h:x.format(i);c=this._data[n].label+" ("+f+")";d=r(this._data[n]);D.setText(c);D.ellipsis="â€¦ ("+f+")";I=D.measure();if(x.isRadial()){C=x._radius;q=x.getAngleOfValue(i);l=x._centerPoint.x+Math.cos(q)*C;u=x._centerPoint.y+Math.sin(q)*C;y=q>Math.PI/2&&q<3*Math.PI/2?"right":"left";g=q>Math.PI&&q<2*Math.PI?"bottom":"top";w=I.width;if(l-w<0){D.maxWidth+=l-w;l=D.maxWidth}else l+w>this.rect.width&&(D.maxWidth=w+(this.rect.width-(l+w)))}else{s=x.getPositionOfValue(i);s=Math.floor(s)-.5;L=I.height/2;if(x.isVertical()){y=this.yMirrorMode?"right":"left";g="middle";l=this.yMirrorMode?m-4:m+this._width+4;u=s<L?s+(L-s+4):s>this.rect.height-L?s-(s-(this.rect.height-L-4)):s}else{y="center";u=m+this._width;g="top";S=I.width/2;l=s<S?s+(S-s+4):s>this.rect.width-S?s-(s-(this.rect.width-S-4)):s}}D.x=l;D.y=u;D.align=y;D.baseline=g;D.fill=d;b.push(D);v.push({position:s,shapeWrapper:D,tooltipRows:[{label:this._data[n].label,value:f}]})}p=v?v.length:0;if(0===p){this._clearLabels();return}this.renderer.stage.removeChildren();this.renderer.stage.addChildren(b);this.renderer.render();this._tooltips.setLabelObjects(v)},setGaugeWidth:function e(t){this._width=t;this.invalidateDisplay()},setPaddingToAxis:function e(t){this._paddingToAxis=t},setRelevantPos:function e(t){this._relevantPos=t}});return i}.apply(t,i),void 0!==o&&(e.exports=o))},1584:function(e,t){e.exports='<div class="qv-viz" aria-hidden="true"></div>\n<div qva-popup-disclaimer ng-if="!!dataAttributes.popupDisclaimer.show" pop-close="dataAttributes.popupDisclaimer.onPopClose" pop-message="dataAttributes.popupDisclaimer.message" pop-title="dataAttributes.popupDisclaimer.title" />\n'},1585:function(e,t,n){"use strict";var i,o;!(i=[n(91),n(100),n(101),n(1260)],o=function(e,t,n,i){var o,r,a;var s=i.getPropertyLogic();function l(e){return"measure"===n.getValue(e,"color.useBaseColors")}o={uses:"data",items:{measures:{disabledRef:""},dimensions:{disabledRef:""}}};r={type:"items",uses:"settings",component:"expandable-items",translation:"Common.Appearance",items:{presentation:{type:"items",grouped:true,translation:"properties.presentation",items:{rangeLimits:{type:"items",items:{text:{component:"text",translation:"properties.axis.rangeLimits",style:"sHeader"},min:{ref:"measureAxis.min",translation:"properties.axis.min",type:"number",expression:"optional",invalid:function e(t){return t.measureAxis&&t.measureAxis.min>=t.measureAxis.max},change:function e(t){n.setValue(t,"disclaimerClosed",true)}},max:{ref:"measureAxis.max",translation:"Common.Max",type:"number",expression:"optional",defaultValue:100,invalid:function e(t){return t.measureAxis&&t.measureAxis.min>=t.measureAxis.max},change:function e(t){n.setValue(t,"disclaimerClosed",true)}}}},type:{ref:"gaugetype",type:"string",component:"item-selection-list",defaultValue:"radial",horizontal:true,items:[{icon:"gauge_gauge",component:"icon-item",labelPlacement:"bottom",translation:"properties.gauge.radial",value:"radial"},{icon:"gauge_vertical_bar",component:"icon-item",labelPlacement:"bottom",translation:"properties.gauge.bar",value:"bar"}],change:function e(t){if("radial"===t.gaugetype){a=t.orientation;t.orientation="horizontal"}else t.orientation=a}},autoOrientation:{ref:"autoOrientation",translation:"properties.orientation",type:"boolean",defaultValue:true,component:"switch",undefinedValue:false,options:[{value:true,translation:"Common.Auto"},{value:false,translation:"Common.Custom"}],show:function e(t){return"bar"===t.gaugetype}},orientation:{ref:"orientation",type:"string",component:"item-selection-list",defaultValue:"horizontal",horizontal:true,items:[{component:"icon-item",icon:"direction_up_down",labelPlacement:"bottom",translation:"properties.orientation.vertical",value:"vertical"},{icon:"direction_left_right",component:"icon-item",labelPlacement:"bottom",translation:"Common.Horizontal",value:"horizontal"}],show:function e(t){return"bar"===t.gaugetype&&!t.autoOrientation}},angle:{ref:"angle",translation:"properties.gauge.angle",type:"number",component:"slider",min:.2,max:.98,step:.1,defaultValue:.7,show:function e(){return false}},segments:{type:"items",items:{useSegments:{ref:"useSegments",type:"boolean",component:"switch",defaultValue:false,translation:"properties.gauge.useSegments",change:function e(t){var n=i.getSegmentColors(t.segmentInfo);t.useSegments&&1===n.length?t.segmentInfo.paletteColors=[t.paletteProgressColor||t.progressColor]:t.paletteProgressColor=n[0]},options:[{value:false,translation:"properties.off"},{value:true,translation:"properties.on"}]},useBaseColor:{ref:"color.useBaseColors",type:"string",defaultValue:"measure",translation:"properties.useLibraryMeasureColors",component:"switch",show:function e(t){t.color||(t.color={});t.color.useBaseColors||(t.color.useBaseColors="off");return true},options:[{value:"off",translation:"properties.off"},{value:"measure",translation:"properties.on"}]},paletteProgressColor:{component:"color-picker",translation:"properties.color",ref:"paletteProgressColor",type:"object",dualOutput:true,defaultValue:s.color.paletteColor.defaultValue,show:function e(i){if(!n.getValue(i,"paletteProgressColor")){var o=t.resolveColor(n.getValue(i,"progressColor"));var r=-1;if(!o||"none"===o){o=s.color.paletteColor.defaultValue();r=o.index}n.setValue(i,"paletteProgressColor",{index:r,color:o})}return!l(i)&&!i.useSegments}},valueMode:{ref:"valueMode",translation:"properties.value",type:"string",component:"dropdown",options:[{value:"absolute",translation:"properties.gauge.absolute"},{value:"relative",translation:"properties.gauge.relative"}],show:function e(){return false},defaultValue:"absolute"},maxSegments:{ref:"maxSegments",type:"number",defaultValue:6,show:false},segmentInfo:{ref:"segments",type:"items",component:"color-scale-creator",show:function e(t){return!l(t)&&t.useSegments},items:{limits:{ref:"segmentInfo.limits",type:"array",items:{value:{ref:"value",type:"number",expression:"optional",invalid:function e(t,n){return"number"===typeof t.value&&(t.value<n.measureAxis.min||t.value>n.measureAxis.max)},defaultValue:1},gradient:{translation:"properties.gradient",ref:"gradient",type:"boolean",show:false}}},paletteColors:{items:{color:{ref:"color",type:"string"},index:{ref:"index",type:"integer",defaultValue:6}},type:"array",ref:"segmentInfo.paletteColors"}}}}},disclaimerClosed:{ref:"disclaimerClosed",type:"boolean",defaultValue:false,show:false}}},measureAxis:{type:"items",label:function t(n,i){var t,o=i.getMeasureLayouts()[0];t=o?e.get("properties.measureAxisWithInfo",[o.qFallbackTitle]):e.get("properties.measureAxis");return t},grouped:true,items:{axis:{type:"items",snapshot:{title:"properties.measureAxis",tid:"property-yAxis"},items:{show:{ref:"measureAxis.show",translation:"properties.axis.labelsAndTitle",type:"string",component:"dropdown",options:[{value:"all",translation:"properties.axis.show.all"},{value:"labels",translation:"properties.axis.show.labels"},{value:"title",translation:"properties.axis.show.title"},{value:"none",translation:"Common.None"}],defaultValue:"all"},spacing:{ref:"measureAxis.spacing",translation:"properties.axis.scale",type:"number",component:"dropdown",defaultValue:1,show:function e(t){return t.measureAxis&&"none"!==t.measureAxis.show&&"title"!==t.measureAxis.show},options:[{value:2,translation:"properties.gridLine.wide"},{value:1,translation:"properties.gridLine.medium"},{value:.5,translation:"properties.gridLine.narrow"}]}}}}}}};var u={type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling",items:{suppressZero:null,calcCond:{uses:"calcCond"}}},refLines:{uses:"reflines"}}};return{type:"items",component:"accordion",items:{data:o,addons:u,settings:r}}}.apply(t,i),void 0!==o&&(e.exports=o))},1586:function(e,t,n){"use strict";var i,o;!(i=[n(119),n(1587)],o=function(e,t){e.directive("qvaPopupDisclaimer",function(){return{template:t,replace:true,scope:{popMessage:"=",popTitle:"=",popClose:"="},link:function e(t){t.onClose=function(){t.popClose()}}}})}.apply(t,i),void 0!==o&&(e.exports=o))},1587:function(e,t){e.exports='<div class="qv-popup-disclaimer">\n\t<div class="close-icon  lui-icon  lui-icon--remove" qva-activate="onClose()"></div>\n\t<header class="dm-header">{{popTitle}}</header>\n\t<main class="dm-main">\n\t\t<p class="dm-p">{{popMessage}}</p>\n\t</main>\n</div>'},1588:function(e,t,n){"use strict";var i,o;!(i=[n(91)],o=function(e){var t={dimensions:{min:1,max:1,description:function t(){return e.get("Visualizations.Descriptions.Histogram.Dimension")},add:function e(){},move:function e(){},remove:function e(){}}};return t}.apply(t,i),void 0!==o&&(e.exports=o))},1591:function(e,t){e.exports='<div class="qv-viz" ng-class="{link : linkInteractionOn}">\n\t<div class="kpi-data" qva-activate="onShowVerifyDialog()">\n\t\t<div ng-show="baseLayoutInfo.components[0].show" class="measure-wrapper" ng-class="textAlign" ng-style="measureTitleStyle">\n\t\t\t<div class="measure-title ellips-text" title="{{measureTitle}}">\n\t\t\t\t<span ng-bind="measureTitle"></span>\n\t\t\t\t<i class="info-icon  lui-icon  lui-icon--goto" ng-if="linkInteractionOn" title="{{sheetLinkTitle}}"></i>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="value-wrapper" ng-class="textAlign">\n\t\t\t<div class="ellips-text" ng-class="{ \'no-shrink\' : secondaryValues.length && baseLayoutInfo.components[1].components[1].components[0].show}">\n\t\t\t\t<qv-kpi-value value="mainValue.value" formatted-value="mainValue.formattedValue" value-style="mainValue.style" formatter="mainValue.formatter" css-class="mainValue.cssClass" show-glyph="mainValue.showGlyph" />\n\t\t\t</div>\n\t\t\t<div ng-show="baseLayoutInfo.components[1].components[1].components[0].show" class="secondary-wrapper ellips-text" ng-repeat="secondaryValue in secondaryValues">\n\t\t\t\t<qv-kpi-value value="secondaryValue.value" formatted-value="secondaryValue.formattedValue" value-style="secondaryValue.style" title-style="secondaryValue.titleStyle" formatter="secondaryValue.formatter" css-class="secondaryValue.cssClass" show-glyph="secondaryValue.showGlyph" measure-title="secondaryValue.measureTitle" />\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t\x3c!--\n\t<div ng-show="useViz" class="visualization">\n\t\t<qv-object class="cell-content" model="viz.model" options="viz.options"></qv-object>\n\t</div>\n\t--\x3e\n\t<div class="click-again-overlay" ng-class="{show : showVerifyDialog}" ng-style="verifyDialogStyle" qva-activate="linkToSheet()">\n\t\t<span ng-if="!sheetIsMissing" q-translation="properties.kpi.verifyToGoSheet"></span>\n\t\t<span class="sheetLinkTitle ellips-text" ng-bind="sheetLinkTitle"></span>\n\t</div>\n\n</div>\n'},1592:function(e,t,n){"use strict";var i,o;!(i=[n(100),n(101),n(185)],o=function(e,t,n){var i,o;var r=n.getLogicFor("hard","default");function a(e){return t.getValue(e,"qDef.conditionalColoring.useBaseColors",true)}i={uses:"data",addTranslation:"Properties.AddData",items:{measures:{disabledRef:"",items:{measureAxisMin:{type:"items",ref:"qDef.measureAxis.min",defaultValue:0},measureAxisMax:{type:"items",ref:"qDef.measureAxis.max",defaultValue:100},conditionalColoringUseConditionalColoring:{type:"items",ref:"qDef.conditionalColoring.useConditionalColoring",defaultValue:false},conditionalColoringUseSingleColor:{type:"items",ref:"qDef.conditionalColoring.singleColor",defaultValue:3},conditionalColoringPaletteSingleColor:{type:"items",ref:"qDef.conditionalColoring.paletteSingleColor",defaultValue:r.color.paletteColor.defaultValue},limits:{type:"items",ref:"qDef.conditionalColoring.segments.limits",defaultValue:[]},paletteColors:{type:"items",ref:"qDef.conditionalColoring.segments.paletteColors",defaultValue:[{index:6}]}}}}};o={type:"items",uses:"settings",component:"expandable-items",translation:"Common.Appearance",items:{presentation:{type:"items",grouped:false,translation:"properties.presentation",items:{showMeasureTitle:{ref:"showMeasureTitle",component:"checkbox",translation:"properties.kpi.showTitle",defaultValue:true},textAlign:{ref:"textAlign",type:"string",component:"dropdown",translation:"properties.Alignment",options:[{value:"left",translation:"properties.dock.left"},{value:"center",translation:"Common.Center"},{value:"right",translation:"properties.dock.right"}],defaultValue:"center"},fontSize:{ref:"fontSize",type:"string",component:"dropdown",translation:"MediaTool.Toolbar.FontSize",options:[{value:"S",translation:"Common.Small"},{value:"M",translation:"Common.Medium"},{value:"L",translation:"Common.Large"}],defaultValue:"M"},linkToSheet:{type:"items",items:{useLink:{ref:"useLink",type:"boolean",component:"switch",translation:"properties.kpi.linkToSheet",defaultValue:false,options:[{value:true,translation:"properties.on"},{value:false,translation:"properties.off"}]},kpiLink:{ref:"sheetLink",type:"string",component:"sheet-dropdown",show:function e(t){return t.useLink}},openUrlInNewTab:{ref:"openUrlInNewTab",type:"boolean",component:"switch",translation:"properties.kpi.openUrlInNewTab",defaultValue:true,options:[{value:true,translation:"properties.on"},{value:false,translation:"properties.off"}],show:function e(t){return t.useLink}}}}}},color:{type:"items",grouped:false,translation:"properties.color",items:{conditionalColoring:{type:"array",component:"measures-tab",ref:"qHyperCubeDef.qMeasures",items:{useConditionalColoring:{ref:"qDef.conditionalColoring.useConditionalColoring",component:"switch",type:"boolean",options:[{value:true,translation:"properties.on"},{value:false,translation:"properties.off"}],translation:"properties.kpi.conditionalColoring",defaultValue:false,change:function n(i){var o=t.getValue(i,"qDef.conditionalColoring");var r=t.getValue(i,"qDef.conditionalColoring.segments.paletteColors")||t.getValue(i,"qDef.conditionalColoring.segments.colors");o&&o.useConditionalColoring&&1===r.length?i.qDef.conditionalColoring.segments.paletteColors=[{index:-1,color:e.resolveColor(i.qDef.conditionalColoring.paletteSingleColor||i.qDef.conditionalColoring.singleColor)}]:i.qDef.conditionalColoring.paletteSingleColor={index:-1,color:e.resolveColor(r[0].color)}}},useBaseColor:{ref:"qDef.conditionalColoring.useBaseColors",type:"boolean",defaultValue:true,translation:"properties.libraryColors",component:"switch",show:function e(n,i){var o=t.getValue(i.properties,"color.useBaseColors");var r=t.getValue(n,"qDef.conditionalColoring.useBaseColors");if("off"===o){t.setValue(i.properties,"color.useBaseColors");t.setValue(n,"qDef.conditionalColoring.useBaseColors",false)}else void 0===r&&t.setValue(n,"qDef.conditionalColoring.useBaseColors",true);return true},options:[{value:false,translation:"properties.off"},{value:true,translation:"properties.on"}]},percentageWarning:{component:"text",translation:"properties.kpi.librarySegmentWarning",style:"hint",show:function e(n){var i=t.getValue(n,"qDef.conditionalColoring.useBaseColors");var o=t.getValue(n,"qDef.conditionalColoring.useConditionalColoring");return i&&o}},paletteSingleColor:{component:"color-picker",translation:"properties.color",ref:"qDef.conditionalColoring.paletteSingleColor",type:"object",dualOutput:true,defaultValue:r.color.paletteColor.defaultValue,show:function n(i){if(!t.getValue(i,"qDef.conditionalColoring.paletteSingleColor")){var o=e.resolveColor(t.getValue(i,"qDef.conditionalColoring.singleColor"));var r={index:-1,color:o};t.setValue(i,"qDef.conditionalColoring.paletteSingleColor",r)}return!a(i)&&i.qDef.conditionalColoring&&!i.qDef.conditionalColoring.useConditionalColoring}},rangeLimits:{type:"items",items:{min:{ref:"qDef.measureAxis.min",translation:"properties.axis.min",type:"number"},max:{ref:"qDef.measureAxis.max",translation:"Common.Max",type:"number",defaultValue:100}},show:function e(){return false}},segmentInfo:{ref:"qDef.conditionalColoring.segments",type:"items",component:"color-scale-creator",conditionalColoringRef:{props:"qHyperCubeDef.qMeasures",layout:"qHyperCube.qMeasureInfo"},useGlyph:true,useAutoMinMax:true,show:function e(t){return!a(t)&&t.qDef.conditionalColoring.useConditionalColoring},items:{limits:{ref:"qDef.conditionalColoring.segments.limits",type:"array",items:{value:{ref:"value",type:"number",expression:"optional",invalid:function e(t){return Number.isNaN(+t.value)},defaultValue:1},gradient:{translation:"properties.gradient",ref:"gradient",type:"boolean",show:false}}},paletteColors:{type:"array",ref:"qDef.conditionalColoring.segments.paletteColors",defaultValue:[{index:6}],items:{color:{ref:"color",type:"string",defaultValue:""},index:{ref:"index",type:"integer"},icon:{ref:"icon",type:"string",defaultValue:""}}}}}}}}}}};var s={type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling",items:{suppressZero:null,calcCond:{uses:"calcCond"}}}}};return{type:"items",component:"accordion",items:{data:i,addons:s,settings:o}}}.apply(t,i),void 0!==o&&(e.exports=o))},1593:function(e,t,n){"use strict";var i,o;!(i=[n(203)],o=function(e){var t=new e,n="10px 'QlikView Sans'",i=t.getFontHeight(n)+1,o=t.getTextWidth("M",n),r=10,a={NONE:0,ADJUSTTOTEXT:1},s={NONE:0,SCALE:1,MAX:2},l={ROW:"row",COLUMN:"column"},u={checkLayout:d,getDirection:c,sizeComponent:p,TextScaleMode:s,ElementScaleMode:a,Direction:l,FixedMobileHeight:150};function c(e,t,n){var i,o=e.ratio?e.ratio:1,r=t/n;i=e.direction===l.ROW?o>r?l.COLUMN:l.ROW:o>r?l.ROW:l.COLUMN;return i}function d(e){if(!e.components||0===e.components.length)return e;var t,n,i=0,o=e.boundingBox.height,r=e.boundingBox.width,a,s,u=e.direction,p=c(e,o,r),f;e.components.forEach(function(e){e.direction=e.direction?e.direction:p;t=e.size.min?e.size.min:e.size?e.size:0;if("function"===typeof e.isVisible&&!e.isVisible()||t*o<(e.size.treshold&&e.size.treshold.height?e.size.treshold.height:10)||r<(e.size.treshold&&e.size.treshold.width?e.size.treshold.width:10))e.show=false;else{i+=t;e.show=true}});for(a=e.components.length-1;a>=0;a--){s=e.components[a];i<1?s.size.stretch&&(s.size.value=s.size.min+(1-i)):"number"===typeof s.size||(s.size.value=null)}e.components.forEach(function(e){n=e.size.value?e.size.value:e.size.min?e.size.min:e.size;f={};if(u===l.ROW){f.height=o;f.width=r*n}else{f.width=r;f.height=o*n}e.boundingBox=f});e.components.forEach(function(e){d(e)});return e}function p(e,t,n,i,o,r){var l,u,c;u=e.boundingBox.width;c=e.boundingBox.height;e.components&&e.components.forEach(function(t){p(t,e,u,c,o,r)});if("function"===typeof e.getText){o===s.MAX?l=h(e.getText(),u,c):o===s.SCALE&&(l=f(e,u,c));r===a.ADJUSTTOTEXT&&(e.boundingBox={height:l.height,width:l.width});e.fontSizes||(e.fontSizes={});e.fontSizes.fontSize=10*l.fontSize+"%";e.fontSizes.fontSizeScale=l.fontSize}}function f(e,t,n){if(!e.fontSizes)return{fontSize:"10px"};var i=e.getText(),o=e.fontSizes.min,r=e.fontSizes.max,a=e.fontSizes.maxNrChars,s=h(i,t,n,a,e.fontSizes.scale||1),l=Math.min((n-o.height)/(r.height-o.height),1),u=o.fontSize+l*(r.fontSize-o.fontSize),c=Math.max(Math.min(s.fontSize,u),o.fontSize);return{fontSize:c}}function h(e,a,s,l,u){u=u||1;var c=l?l*o:t.getTextWidth(e,n)*u,d=1.2*i,p=Math.min(a/c,s/d);return{fontSize:Math.max(9*p,r)}}return u}.apply(t,i),void 0!==o&&(e.exports=o))},1594:function(e,t,n){"use strict";var i,o;!(i=[n(1320),n(100),n(1162)],o=function(e,t,n){function i(e,t){var n=e.qHyperCube.qMeasureInfo[t];if(!n)return false;if(n.coloring&&n.coloring.baseColor&&n.coloring.baseColor.color)return n.coloring.baseColor;if(n.baseColor&&n.baseColor.color)return n.baseColor}function o(e,t){if(void 0===t.useBaseColors)return!e.color||"measure"===e.color.useBaseColors;return t.useBaseColors}return{getValueInfo:function r(a,s,l){var u=Math.abs(a);var c=l.qHyperCube.qMeasureInfo[s].conditionalColoring;var d;var p;var f="";var h;var g=l.qHyperCube.qMeasureInfo[s].coloring?l.qHyperCube.qMeasureInfo[s].coloring.gradient:null;var m=i(l,s);if(c.useConditionalColoring&&o(l,c)&&g&&"absolute"===g.limitType){d=e.getAutoMinMax(g.limits,a);var v=g.limits.map(function(e){return(e-d.min)/(d.max-d.min)});var b=g.colors.map(t.resolveColor);var x=n.setupColors(b,g.breakTypes,v);var y=n.createColorScale(x.colors,false);y.setLimits(x.limits);y.setMaxMinValues(d.max,d.min);h=y.getColor(a).toHex()}else if(o(l,c)&&m)h=t.resolveColor(m);else if(c.useConditionalColoring){d=l.qHyperCube.qMeasureInfo[s].measureAxis;var C=d&&!Number.isNaN(+d.min)?d.min:a-u;var q=d&&!Number.isNaN(+d.max)?d.max:a+u;p=(a-C)/(q-C);var D=e.getSegmentIndex(c,a,C);f=e.getIcon(c.segments,D)||"";h=e.shouldBlend(c.segments,D)?e.blendValue(c.segments,p,C,q):e.resolveColorSegment(c.segments,D)}else h=e.resolveColor(c.paletteSingleColor||c.singleColor);return{color:h,icon:f,useCondColor:c.useConditionalColoring}}}}.apply(t,i),void 0!==o&&(e.exports=o))},1595:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(1596),n(90),n(1305)],o=function(e,t,n,i){e.directive("qvKpiValue",[function(){return{replace:true,template:t,restrict:"E",scope:{value:"=",formattedValue:"=",valueStyle:"=",formatter:"=",cssClass:"=",showGlyph:"=",measureTitle:"=",titleStyle:"="},link:function e(t){var o;function r(e,n,r,a){o&&o.destroy();o=new i(e,{currentValue:n},400).progress(function(){e.currentFormattedValue=a?a.formatValue(e.currentValue):e.currentValue;t.$digest()}).then(function(){e.currentFormattedValue="U"!==a.type?r:a.formatValue(e.currentValue)})}function a(){if(Number.isNaN(+t.formattedValue)||!t.formatter)t.currentFormattedValue=t.formattedValue;else if("U"===t.formatter.type){t.tweenFormatter||(t.tweenFormatter=t.formatter.clone());t.tweenFormatter.pattern=s(t.formattedValue,true);t.tweenFormatter.prepare();r(t,t.value,t.formattedValue,t.tweenFormatter)}else r(t,t.value,t.formattedValue,t.formatter)}function s(e,t){var i="0",o,r=e.match(/(?:-?\d+)([^\d](?=\d))/),a=r?r[1]:"",s,l=0;if(a){s=new RegExp("(?:"+n.escapeRegExp(a)+")(\\d+)");r=e.match(s);l=r?r[1].length:0}if(l){i+=a;for(o=0;o<l;o++)i+="0"}t&&(i+="A");return i}t.$watchCollection("[formattedValue,formatter]",function(){a()})}}}])}.apply(t,i),void 0!==o&&(e.exports=o))},1596:function(e,t){e.exports='<div class="ellips-text">\n\t<div class="kpi-value" ng-style="valueStyle">\n\t\t<div class="ellips-text">\n\t\t\t<span ng-bind="currentFormattedValue" title="{{currentFormattedValue}}"></span>\n\t\t</div>\n\t\t<div class="glyph-wrapper" ng-if="showGlyph">\n\t\t\t<span ng-class="cssClass" class="lui-icon"></span>\n\t\t</div>\n\t</div>\n\t<div class="kpi-title ellips-text" ng-style="titleStyle" ng-bind="measureTitle"></div>\n</div>\n'},1597:function(e,t,n){"use strict";var i,o;!(i=[n(101),n(91)],o=function(e,t){function n(e){var t=e.getDimensions(),n=e.getMeasures(),i;if(1===t.length&&1===n.length)0!==e.getSorting()[0]&&e.changeSorting(1,0);else if(t.length>1&&1===n.length){i=e.getSorting().indexOf(0);0!==i&&e.changeSorting(i,0)}}function i(t,n){var i=n.getDimensions(),o=n.getMeasures(),r=e.getValue(t,"color.mode");i.length>1&&e.setValue(t,"color.persistent",true);"byMeasure"===r&&i.length>1?e.setValue(t,"color.mode","byDimension"):"byDimension"===r&&i.length<=1&&o.length<=1?e.setValue(t,"color.mode","primary"):"byExpression"===r&&0===o.length&&e.setValue(t,"color.mode","primary")}function o(e){if(e>=2)return 1;return 15}return{dimensions:{min:1,max:function e(t){if(t>=2)return 1;return 2},description:function e(n,i){var o,r=n.qHyperCubeDef.qDimensions.length;o=r>1&&0===i?"area"===n.lineType&&true===n.stackedArea?"Visualizations.Descriptions.Stack":"Visualizations.Descriptions.Group":"area"===n.lineType?"Visualizations.Descriptions.Area":"Visualizations.Descriptions.Line";return t.get(o)},add:function e(t,o,r){if(r.getDimensions().length>1){o.qHyperCubeDef.qMode="K";o.qHyperCubeDef.qAlwaysFullyExpanded=true}n(r);i(o,r)},move:function e(t,o,r){if(r.getDimensions().length>1){o.qHyperCubeDef.qMode="K";o.qHyperCubeDef.qAlwaysFullyExpanded=true}n(r);i(o,r)},remove:function e(t,n,o){var r=o.getDimensions();i(n,o);1===r.length&&(n.qHyperCubeDef.qMode="S")},autoSort:function e(t,n,i,o){i&&(-1!==i.indexOf("$numeric")||-1!==i.indexOf("$date")||-1!==i.indexOf("$timestamp")?o.qSortByNumeric=1:-1===i.indexOf("$text")&&-1===i.indexOf("$ascii")||(o.qSortByAscii=1))}},measures:{min:1,max:o,description:function e(){return t.get("Visualizations.Descriptions.Height")},add:function e(t,o,r){n(r);i(o,r)},move:function e(t,o,r){n(r);i(o,r)},remove:function e(t,n,o){var r=o.getDimensions();i(n,o);if(r.length>1){n.qHyperCubeDef.qMode="K";n.qHyperCubeDef.qAlwaysFullyExpanded=true}else 1===r.length&&(n.qHyperCubeDef.qMode="S")}}}}.apply(t,i),void 0!==o&&(e.exports=o))},1603:function(e,t,n){"use strict";var i,o;!(i=[n(198)],o=function(e){var t;function n(e,t,n){var i,o,r,a=[];for(o=0;o<t.length;o++)for(i=0;i<e.length;i++){r={qType:n,qCol:t[o],qRow:e[i]};a.push(r)}return a}t=e.extend("PivotApi",{init:function e(t){this._super(t,"/qHyperCubeDef",{mode:"P"});this.cacheCube.setMethodName("getHyperCubePivotData")},updateCache:function e(t){if(t&&t.qHyperCube&&"P"===t.qHyperCube.qMode){this.cacheCube.set(t.qHyperCube.qPivotDataPages);this.cacheCube.setCubeSize(t.qHyperCube.qSize)}else this.cacheCube.clear();this.backendStackThrottle.clear()},getData:function e(t){switch(this.model.layout.qHyperCube.qMode){case"P":return this.cacheCube.getData(t);default:throw new Error("you are using a non-supported backend-api")}},getReducedData:function e(t,n,i){i=void 0!==i?i:"D1";return this.model.getHyperCubeReducedData(this.path,t,n,i)},select:function e(t,i,o){switch(this.model.layout.qHyperCube.qMode){case"P":return this.model.selectPivotCells(this.path,n(t,i,o));default:throw new Error("you are using a non-supported backend-api")}},expandTop:function e(t,n,i){return this.model.expandTop(this.path,t,n,i)},expandLeft:function e(t,n,i){return this.model.expandLeft(this.path,t,n,i)},collapseTop:function e(t,n,i){return this.model.collapseTop(this.path,t,n,i)},collapseLeft:function e(t,n,i){return this.model.collapseLeft(this.path,t,n,i)},clearSelections:function e(){return this.model.resetMadeSelections()},hasSelections:function e(){return this.model.layout.qSelectionInfo.qMadeSelections},getSize:function e(){return this.model.layout.qHyperCube.qSize}});return t}.apply(t,i),void 0!==o&&(e.exports=o))},1604:function(e,t,n){"use strict";var i,o;!(i=[n(383),n(101),n(90),n(91),n(160),n(49),n(113)],o=function(e,t,n,i,o,r,a){var s,l,u,c;function d(e,t,n){if(!n.properties.qHyperCubeDef.qIndentMode)return true;var i=n.properties.qHyperCubeDef.qInterColumnSortOrder.indexOf(-1),o=n.properties.qHyperCubeDef.qNoOfLeftDims,r;i>-1&&i<o&&o--;r=n.properties.qHyperCubeDef.qDimensions.indexOf(e);return 0===r||r>=o}function p(e){e.qAttributeExpressions[0]=e.qAttributeExpressions[0]||{};e.qAttributeExpressions[1]=e.qAttributeExpressions[1]||{};e.qAttributeExpressions[0].id=o.IDMAP.CELL_BACKGROUND_COLOR;e.qAttributeExpressions[1].id=o.IDMAP.CELL_FOREGROUND_COLOR}s={uses:"settings",items:{presentation:{type:"items",translation:"properties.presentation",items:{alwaysFullyExpanded:{ref:"qHyperCubeDef.qAlwaysFullyExpanded",type:"boolean",translation:"properties.pivot.fullyExpanded",defaultValue:false},indentMode:{ref:"qHyperCubeDef.qIndentMode",type:"boolean",translation:"properties.pivot.indentMode"}}}}};l={type:"items",translation:"properties.sorting",items:{defaultSorting:{uses:"sorting",items:{dimensions:{showPriority:false,allowMove:false},measures:{included:false}}}}};c={type:"string",component:"expression",ref:"qCalcCondition.qCond",expression:"optional",expressionType:"ValueExpr",translation:"Object.Table.Columns.VisibilityCondition",defaultValue:{qv:""},tid:"visibilityCondition",isExpression:function e(t){return"string"===typeof t&&t.trim().length>0},show:function e(){return r.getFlag("PIVOT_SHOW_HIDE")||a.PIVOT_SHOW_HIDE}};var f={type:"items",component:"pivot-data",translation:"properties.data",addTranslation:"Properties.AddData",items:{dimensions:n.extend(true,{},e.dimensions,{items:{globalGrouping:{type:"boolean",translation:"properties.dimensionLimits.globalGrouping",ref:"qOtherTotalSpec.qGlobalOtherGrouping",defaultValue:false,show:function e(n){return"OTHER_OFF"!==t.getValue(n,"qOtherTotalSpec.qOtherMode")}},totalMode:{type:"string",component:"switch",translation:"properties.showTotals",ref:"qOtherTotalSpec.qTotalMode",defaultValue:"TOTAL_OFF",trueOption:{value:"TOTAL_EXPR",translation:"properties.on"},falseOption:{value:"TOTAL_OFF",translation:"properties.off"},show:d},totalsLabel:{type:"string",component:"expression",expressionType:"StringExpr",ref:"qTotalLabel",translation:"properties.totals.label",defaultValue:function e(){return i.get("Object.Table.Totals")},show:function e(n,i,o){return"TOTAL_OFF"!==t.getValue(n,"qOtherTotalSpec.qTotalMode")&&d(n,i,o)}},visibilityCondition:c}}),measures:n.extend(true,{},e.measures,{items:{visibilityCondition:c,tableColorBgByExpression:{component:"expression",expressionType:"measure",ref:"qAttributeExpressions.0.qExpression",translation:"Object.Table.Measure.BackgroundExpression",defaultValue:"",change:p},tableColorByExpression:{component:"expression",expressionType:"measure",ref:"qAttributeExpressions.1.qExpression",translation:"Object.Table.Measure.ForegroundExpression",defaultValue:"",change:p}}})}};u={type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling",items:{calcCond:{uses:"calcCond"}}}}};return{type:"items",component:"accordion",items:{data:f,sorting:l,addons:u,settings:s}}}.apply(t,i),void 0!==o&&(e.exports=o))},1605:function(e,t,n){"use strict";var i,o;!(i=[n(204),n(89),n(125),n(1058),n(90),n(1606)],o=function(e,t,n,i,o,r){var a=1e3,s=1e3;var l;l=e.extend({addDimension:function e(n,a,s){var l=this.getDimensions(),u=void 0!==a&&a,c=this;n.qDef.cId||(n.qDef.cId=o.generateId());if(l.length<this.maxDimensions())return this.autoSortDimension(n).then(function(){i.fixPivotHypercubeOrders(c.hcProperties);r.rearrange(c,l,n,u,s);return t.resolve(n)})},reinsertDimension:function e(n,i,r){var a=this.getDimensions();n.qDef.cId||(n.qDef.cId=o.generateId());if(a.length<this.maxDimensions())return this.addDimension(n,i,r);if(a.length<s){r=this.hcProperties.qLayoutExclude.qHyperCubeDef.qDimensions.length;this.hcProperties.qLayoutExclude.qHyperCubeDef.qDimensions.splice(r,0,n);return t.resolve(n)}},removeDimension:function e(o){var r=this.getDimensions(),a;var s=this.properties.qHyperCubeDef.qNoOfLeftDims,l=this.hcProperties.qInterColumnSortOrder;var u,c;for(c=0;c<l.length;c++)if(l[c]===o){u=c;break}u+1<=s&&this.properties.qHyperCubeDef.qNoOfLeftDims--;var d=this.properties.qHyperCubeDef.columnWidths?this.properties.qHyperCubeDef.columnWidths[1]:void 0;Array.isArray(d)&&d.length>o&&d.splice(o,1);a=r.splice(o,1)[0];n.indexRemoved(this.hcProperties.qInterColumnSortOrder,o);i.fixPivotHypercubeOrders(this.hcProperties);return t.resolve(a)},addMeasure:function e(n,i,r,s){var l=this.getMeasures(),u=this;n.qDef.cId||(n.qDef.cId=o.generateId());s||delete n.qDef.qNumFormat;if(l.length<this.maxMeasures()){var c=1===l.length;l.push(n);return this.autoSortMeasure(n).then(function(){c&&u.hcProperties.qInterColumnSortOrder.push(-1);return n})}if(l.length<a){this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures.push(n);return t.resolve(n)}},reinsertMeasure:function e(n,i){var r=this.getMeasures();n.qDef.cId||(n.qDef.cId=o.generateId());i=void 0!==i?i:r.length;if(r.length<this.maxMeasures()){r.splice(i,0,n);if(this.hcProperties&&this.hcProperties.qInterColumnSortOrder&&2===r.length){var s=this.hcProperties.qInterColumnSortOrder.indexOf(-1);-1===s&&this.hcProperties.qInterColumnSortOrder.push(-1)}}else if(r.length<a){i=this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures.length;this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures.splice(i,0,n)}return t.resolve(n)},removeMeasure:function e(n){var i=this.getMeasures(),o,r,a;if(n<i.length){o=2===i.length;r=this.hcProperties.qMeasures.splice(n,1)[0];if(o){var s=this.hcProperties.qInterColumnSortOrder;a=s.indexOf(-1);s.splice(a,1);a+1<=this.hcProperties.qNoOfLeftDims&&this.hcProperties.qNoOfLeftDims--}}else r=this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures.splice(n-i.length,1)[0];return t.resolve(r)},getSorting:function e(){throw new Error("don't call this")},changeSorting:function e(){throw new Error("don't call this")},setSorting:function e(){throw new Error("don't call this")}});return l}.apply(t,i),void 0!==o&&(e.exports=o))},1606:function(e,t,n){"use strict";var i,o;!(i=[],o=function(){return{rearrange:e};function e(e,t,n,i,o){var r=e.hcProperties.qNoOfLeftDims,a=t.length,s=e.hcProperties.qInterColumnSortOrder,l=s.indexOf(-1);function u(){s.splice(l,1);s.push(a);s.splice(l+1,0,-1)}if(i||-1!==r&&!Number.isNaN(+r))if(!i&&r>=0){if(l>=r)u();else{-1!==l&&--r;o<=r&&-1!==l?u():s.push(a)}if("number"===typeof o&&o<r){var c=Math.max(o-1,0);t.splice(c,0,n)}else t.splice(r,0,n);e.hcProperties.qNoOfLeftDims++}else{0===a&&(e.hcProperties.qNoOfLeftDims=0);var d="number"===typeof o?o+r:void 0;l>=d?u():s.push(a);"number"===typeof o?d>l&&l>-1?t.splice(d-1,0,n):t.splice(d,0,n):t.push(n)}else{e.hcProperties.qNoOfLeftDims=1;s.unshift(a);t.splice(0,0,n)}}}.apply(t,i),void 0!==o&&(e.exports=o))},1607:function(e,t,n){"use strict";var i,o;!(i=[n(189),n(101),n(160),n(90)],o=function(e,t,n,i){return{importProperties:o,exportProperties:r};function o(n,o,r){var a=e.pivotChart.importProperties.apply(e,[n,o,r]);e.unquarantineObject(a.qProperty,"pivotTableColumnWidths")||t.setValue(a,"qProperty.qHyperCubeDef.columnWidths",o.qHyperCubeDef.columnWidths.concat());var s=i.getValue(a,"qProperty.qHyperCubeDef.qMeasures",[]);s.forEach(l);e.unquarantineConditionalShow(a);return a}function r(t){var n=e.pivotChart.exportProperties.apply(e,[t]);e.quarantineProperty("qHyperCubeDef.columnWidths",n,"pivotTableColumnWidths");e.quarantineConditionalShow(n);var o=i.getValue(n,"properties.qHyperCubeDef.qMeasures",[]);o.forEach(u);return n}function a(e){var t=n.getIndexById(e,n.IDMAP.CELL_BACKGROUND_COLOR);return t>-1?e[t]:0!==n.getIndexById(e,n.IDMAP.CELL_FOREGROUND_COLOR)?e[0]:e[1]}function s(e){var t=n.getIndexById(e,n.IDMAP.CELL_FOREGROUND_COLOR);return t>-1?e[t]:1!==n.getIndexById(e,n.IDMAP.CELL_BACKGROUND_COLOR)?e[1]:e[0]}function l(e){var t=e.qAttributeExpressions;var n=a(t);var i=s(t);t[0]=n;t[1]=i}function u(e){var t=e.qAttributeExpressions;t&&t[0]&&(t[0].id=n.IDMAP.CELL_BACKGROUND_COLOR);t&&t[1]&&(t[1].id=n.IDMAP.CELL_FOREGROUND_COLOR)}}.apply(t,i),void 0!==o&&(e.exports=o))},1608:function(e,t){e.exports='<div class="qv-pt" ng-class="{ \'qv-pt-interactive\': interactive, \'sortable-active\': pivoting.dragPlaceholder, \'qv-rtl-layout\': options.direction === \'rtl\', \'touch-on\': !treatAsDesktop }" aria-hidden="true" ng-click="onClick($event)">\n\t<qv-table-column-width-adjuster\n\t\t\tmin-col-width="scrollApi.settings.column.minColWidth"\n\t\t\tng-if="navigatable && !selectionsApi.active && layout.qHyperCube.qNoOfLeftDims"\n\t\t\tcolumns="columns"\n\t\t\texplicit-column-widths="explicitColumnWidths"\n\t\t\tx-rtl="rtl"\n\t\t\tdir="{{direction}}">\n\t</qv-table-column-width-adjuster>\n\t<qv-scroll-area x-non-mouse-viewport-scrolling="nonMouseViewportScrolling"\n\t\t\t\t\tclass="qv-grid-object-scroll-area"\n\t\t\t\t\tqva-delegated-activate=".qv-pt-expandable#interactive && !selectionsApi.active && collapseExpand($event);"\n\t\t\t\t\tqv-sortable-list="pivoting"\n\t\t\t\t\tx-direction="viewport.direction">\n\t\t<table\tdir="{{viewport.direction}}"\n\t\t\t\tqv-selections-select-while-locked="selectWhileLocked()"\n\t\t\t\tqv-selections-toggle-dimension-value="{ selector: \'.cell\' }"\n\t\t\t\tqv-selections-on-toggle-dimension-value="interactive && selectDimensionValue(cell, $event)"\n\t\t\t\tqv-selections-exclude-toggle-dimension-value="excludeDimensionToggle($event)"\n\t\t\t\tqv-selections-multiselect="{ selector: \'.cell:not(.null-value)\' }"\n\t\t\t\tqv-selections-start-multiselect="interactive && activateSelections(cell)"\n\t\t\t\tqv-selections-update-multiselect="interactive && multiselectDimensionValues(start, current, dataColIx)"\n\t\t\t\tqv-selections-end-multiselect="interactive && multiselect()">\n\t\t\t<colgroup>\n\t\t\t\t<col ng-repeat="cell in metaGhostHeaders.headers" ng-style="cell.style" />\n\t\t\t</colgroup>\n\t\t\t<tbody ng-style="themeStyle.header">\n\t\t\t\t<tr ng-repeat="row in grid.headerRows" tid="header.row"\n\t\t\t\t\tng-class="row.classList" on-finish-render>\n\t\t\t\t\t<th ng-repeat="cell in row.cells"\n\t\t\t\t\t\tng-class="cell.classList"\n\t\t\t\t\t\tclass="cell"\n\t\t\t\t\t\tcolspan="{{cell.colspan}}"\n\t\t\t\t\t\trowspan="{{cell.rowspan}}"\n\t\t\t\t\t\tng-style="cell.style"\n\t\t\t\t\t\tqv-pivot-table-include="cell.templateSrc"\n\t\t\t\t\t\ttitle="{{cell.text}}"\n\t\t\t\t\t\ttid="header.row.cell"></th>\n\t\t\t\t</tr>\n\t\t\t\t<tr ng-repeat="row in grid.rows" tid="data.row" ng-style="themeStyle.content" on-finish-render>\n\t\t\t\t\t<td ng-repeat="cell in row.cells"\n\t\t\t\t\t\tng-class="cell.classList"\n\t\t\t\t\t\tclass="cell"\n\t\t\t\t\t\tcolspan="{{cell.colspan}}"\n\t\t\t\t\t\trowspan="{{cell.rowspan}}"\n\t\t\t\t\t\tng-style="cell.style"\n\t\t\t\t\t\tqv-pivot-table-include="cell.templateSrc"\n\t\t\t\t\t\ttitle="{{cell.text}}"\n\t\t\t\t\t\ttid="data.row.cell"></td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\t</qv-scroll-area>\n</div>\n'},1609:function(e,t){e.exports='<div class="value" ng-class="{ \'qv-rtl-text\': cell.isRtl }" ng-bind="cell.text" dir="{{cell.dir}}"></div>\n'},1610:function(e,t){e.exports='<div class="value" dir="{{cell.dir}}" ng-class="{ \'qv-rtl-text\': cell.isRtl }">\n\t<i class="qv-pt-expandable lui-icon" ng-if="cell.collapseExpandClass" ng-class="cell.collapseExpandClass"></i>\n\t<span ng-bind="cell.text"></span>\n</div>\n'},1611:function(e,t){e.exports='<div class="left-meta-headers list"\n\t tid="meta.rows"\n\t ng-repeat="list in [pivoting.rows]"\n\t qv-pivot-table-include="list.templateSrc">\n</div>'},1612:function(e,t){e.exports='<div class="top-meta-headers list"\n\t tid="meta.columns"\n\t ng-repeat="list in [pivoting.columns]"\n\t qv-pivot-table-include="list.templateSrc">\n</div>'},1613:function(e,t){e.exports='<div class="button-wrapper"\n\t ng-repeat="header in list.items track by header.id"\n\t qv-pivot-table-include="header.templateSrc">\n</div>'},1614:function(e,t){e.exports='<div class="lui-button qv-pt-meta-button"\n\t\ttid="meta.button"\n\t\tng-style="header.style"\n\t\tng-class="{ \'lui-active\': header.open, \'pseudo\': header.isPseudoDim, \'dragging\': header.dragging, \'lui-disabled\': !interactive || selectionsApi.active }"\n\t\tqva-outside-ignore-for="{{header.qvaOutsideIgnoreFor}}"\n\t\tqva-activate="!header.isPseudoDim && !selectionsApi.active && interactive && showDimension($event, header)">\n\t<span ng-if="header.locked" class="lui-icon lui-icon--lock"></span>\n\t<div class="meta-text" dir="{{header.dir}}" title="{{header.title}}">{{header.title}}</div>\n\t<span ng-if="!header.isPseudoDim" class="lui-icon lui-icon--search"></span>\n</div>\n'},1615:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(1263)],o=function(e,t){e.provider("qvDataGrid",function e(){this.$get=[function(){return function e(n){return new t(n)}}]})}.apply(t,i),void 0!==o&&(e.exports=o))},1616:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(90),n(91),n(99),n(1058)],o=function(e,t,n,i,o){var r=8;function a(e,t,n){this.calcApprMaxGlyphCnt=e;this.maxGlyphCnt=n;this.isWidthFlexible=t;this.style={}}function s(e,n,o){var a=10,s={glyphWidth:r,collapseExpandIconGlyphCnt:i.treatAsDesktop()?3:4,columnPaddingGlyphCnt:3,metaHeaderMaxGlyphCnt:(150+a)/r,cellPaddingGlyphCnt:Math.ceil(12/r),buttonPaddingGlyphCnt:Math.ceil(20/r),buttonArrowGlyphCnt:Math.ceil(13/r),buttonMarginOfSafetyGlyphCnt:2,leftTree:{minNonEmptyGlyphCnt:12,emptyGlyphCnt:3,widthFactor:.35},topTree:{wideWidthFactor:.3,growFactor:1.2,minGlyphCnt:8}};this.opts=t.extend(true,s,e);this.layout=n;this.viewportRect=o;this.headers=[];this.maxGlyphs=0;this.availableGlyphs=0;this.leftCellCnt=0;this.dataColumnsInfo={cnt:0,width:0}}s.prototype={_reset:function e(){this.headers.length=0;this.maxGlyphs=0;this.availableGlyphs=0;this.leftCellCnt=0;this.dataColumnsInfo.cnt=0;this.dataColumnsInfo.width=0},_addCollapseExpandHeader:function e(t){var n=new a(this.opts.collapseExpandIconGlyphCnt,false);n.isCollapseExpandIcon=true;t.push(n);this.availableGlyphs-=this.opts.collapseExpandIconGlyphCnt},_addCollapseExpandHeaders:function e(t){for(var n=0;n<this.leftDimCnt-1&&this.leftDimCnt>1&&this.leftDimCnt<=this.sortOrderCnt;++n)this._addCollapseExpandHeader(t)},_getLeftCollapseExpandCnt:function e(t){return this.isIndentMode?this.leftDimCnt-1:t},_addLeftTreeMetaGhostHeader:function e(t,n,i){var o=i>n,r=new a(n,o,i);t.push(r);this.availableGlyphs-=n},_addEmptyLeftTreeMetaGhostHeader:function e(t,n){var i=new a(n||this.opts.leftTree.emptyGlyphCnt,false);t.push(i);this.availableGlyphs-=i.calcApprMaxGlyphCnt},_getDataGhostHeaders:function e(){var t,n=[],i;for(t=0;this.availableGlyphs>0&&this.totDataColCnt>0&&t<this.totDataColCnt;++t){i=this.longestMeasureGlyphCnt;i+=this.opts.columnPaddingGlyphCnt;i/this.longestTopDimGlyphCnt<this.opts.topTree.wideWidthFactor&&(i+=i*this.opts.topTree.growFactor);0===t&&i>this.availableGlyphs&&(i=this.availableGlyphs);if(this.availableGlyphs-i<0){this.availableGlyphs=0;break}this.availableGlyphs-=i;var o=new a(i,true);n.push(o)}return n},_getLeftGhostHeaders:function e(t,n,i){var o=[],r=this.opts.collapseExpandIconGlyphCnt*this._getLeftCollapseExpandCnt(n),a=this.longestLeftDimGlyphCnt,s=Math.min(this.longestLeftDimTitleGlyphCnt,this.opts.metaHeaderMaxGlyphCnt);n>0?this.isIndentMode?this._getLeftGhostHeadersIndent(o,a,s,r,n,i):this._getLeftGhostHeadersNonIndent(o,n,s,r):this._addEmptyLeftTreeMetaGhostHeader(o,t);return o},_isSpaceForDataColumn:function e(t,n){return this.maxGlyphs-t>=n.calcApprMaxGlyphCnt},_getLeftGhostHeadersIndent:function e(t,n,i,o,r,a){var s=n,l,u;this.pseudoInLeftTree&&(s+=this.longestMeasureTitleGlyphCnt);r>0&&s<this.opts.leftTree.minNonEmptyGlyphCnt&&(s=this.opts.leftTree.minNonEmptyGlyphCnt);s<i-o&&(0===a.length||a.length>0&&this._isSpaceForDataColumn(i-o,a[0]))&&(s=i-o);if(s+o>this.availableGlyphs&&a.length>0&&!this._isSpaceForDataColumn(s+o,a[0])){var c=[],d=[];c.push(Math.ceil(s/3));c.push(Math.ceil(this.opts.leftTree.widthFactor*this.maxGlyphs));c.push(this.opts.metaHeaderMaxGlyphCnt);d.push(Math.min.apply(null,c));r>0&&d.push(this.opts.leftTree.minNonEmptyGlyphCnt);d.push(this.availableGlyphs);u=s;l=Math.max.apply(null,d)}else l=s;this._addCollapseExpandHeaders(t);this._addLeftTreeMetaGhostHeader(t,l,u)},_getLeftGhostHeadersNonIndent:function e(t,n,i,o){this._getLeftDimsWidths(n,i,o).forEach(function(e){this._addCollapseExpandHeader(t);this._addLeftTreeMetaGhostHeader(t,e)},this)},_getLeftDimsWidths:function e(t,n,i){var o=[],r=0,a=0,s,l,u,c;for(l=0;l<t;++l){s=this._getDimGlyphCnt(l)+this.opts.cellPaddingGlyphCnt;r+=s;o.push({target:s,adjusted:s})}if(r<n-i){var d=n-i-r,p=o[o.length-1];p.target+=Math.min(d,this.maxGlyphs-r);p.adjusted=p.target;r=o.reduce(function(e,t){return e+t.target},0)}if(r+i>this.availableGlyphs&&r+i>this.maxGlyphs*this.opts.leftTree.widthFactor){r=0;for(l=0;l<t;++l){s=Math.min(this.opts.metaHeaderMaxGlyphCnt-this.opts.collapseExpandIconGlyphCnt,o[l].target>8?o[l].target/2:o[l].target);o[l].adjusted=s;r+=s}}if(r+i>this.availableGlyphs&&r+i>this.maxGlyphs){a=(r+i-this.maxGlyphs)/r;for(l=0;l<t;++l){s=o[l].adjusted;o[l].adjusted=Math.floor(s-s*a)}}else if(r+i<this.availableGlyphs){c=this.availableGlyphs-r-i;u=o.reduce(function(e,t){return e+(t.adjusted<t.target?t.target:0)},0);for(l=0;l<t;++l){s=o[l];s.adjusted<s.target&&(o[l].adjusted+=Math.floor(s.target/u*c))}}return o.map(function(e){return e.adjusted})},_calculateGhostMetaHeadersWidth:function e(t,n){var i=1,o,r,a;n=n||this.headers;n.forEach(function(e){e.minWidth=e.calcApprMaxGlyphCnt*this.opts.glyphWidth;e.widthFactor=e.minWidth/t;i-=e.widthFactor},this);if(i>0){o=i;a=n.filter(function(e){return e.isWidthFlexible&&e.maxGlyphCnt>e.calcApprMaxGlyphCnt});r=a.reduce(function(e,t){return t.maxGlyphCnt-t.calcApprMaxGlyphCnt},0);a.forEach(function(e){var n=e.maxGlyphCnt-e.calcApprMaxGlyphCnt,a=n/r,s=Math.min(n*this.opts.glyphWidth/t,a*o);e.widthFactor+=s;i-=s},this)}if(i>0){a=n.filter(function(e){return true===e.isWidthFlexible});a.forEach(function(e){e.widthFactor+=i/a.length})}n.forEach(function(e){e.width=Math.floor(e.widthFactor*t);e.style.width=e.width+"px"})},calculateColumns:function e(t){var n=0,i=[],o=true;t.forEach(function(e){e.column=n;if(o){i[n]=[];o=false}i[n][i[n].length]=e;if(!e.isCollapseExpandIcon){n++;o=true}});return i},calculateNumColumns:function e(t){return t.reduce(function(e,t){return e+(t.isCollapseExpandIcon?0:1)},0)},_updateLeftHeadersGlyphCnt:function e(t,n){var i,o,r,a,s,l,u,c,d,p,f;i=t.filter(function(e){return!e.isCollapseExpandIcon});o=t.filter(function(e){return e.isCollapseExpandIcon});r=i.reduce(function(e,t){return e+t.calcApprMaxGlyphCnt},0);a=o.reduce(function(e,t){return e+t.calcApprMaxGlyphCnt},0);s=r*this.opts.glyphWidth;l=a*this.opts.glyphWidth;n=Math.max(n,l);u=n-l;c=u/s;d=0;i.forEach(function(e){e.oldCalcApprMaxGlyphCnt=e.calcApprMaxGlyphCnt;e.calcApprMaxGlyphCnt=Math.floor(e.calcApprMaxGlyphCnt*c);e.calcApprMaxGlyphCnt=Math.max(4,e.calcApprMaxGlyphCnt);d+=e.calcApprMaxGlyphCnt});p=Math.floor(u/this.opts.glyphWidth)-d;i.sort(function(e,t){return t.calcApprMaxGlyphCnt-e.calcApprMaxGlyphCnt});for(f=0;f<p;f++)i[f].calcApprMaxGlyphCnt+=1},update:function e(t,n,i){var o,r,a,s,l,u,c=[],d=[],p=[],f=0;i=i||this.explicitColumnWidths;this._reset();this.maxGlyphs=Math.floor(this.viewportRect.width/this.opts.glyphWidth);this.availableGlyphs=this.maxGlyphs;this.availableGlyphs>0&&(c=this._getDataGhostHeaders());o=this._getLeftGhostHeaders(t,n,c);l=this.calculateColumns(o);for(u=0;u<l.length;u++)if(i[u]>0){this._updateLeftHeadersGlyphCnt(l[u],i[u]);d=d.concat(l[u])}else p=p.concat(l[u]);s=c.reduce(function(e,t){return e+t.calcApprMaxGlyphCnt},0);a=o.reduce(function(e,t){return e+t.calcApprMaxGlyphCnt},0);while(c.length>0&&s+a>this.maxGlyphs){r=c.pop();if(0===c.length&&this.maxGlyphs-a>=this.opts.topTree.minGlyphCnt){r.calcApprMaxGlyphCnt=this.maxGlyphs-a;c.push(r);s=r.calcApprMaxGlyphCnt;break}s-=r.calcApprMaxGlyphCnt}this.leftHeaders=o;this.dataHeaders=c;this.leftColumns=l;this.headers=o.concat(c);this.dataColumnsInfo.cnt=c.length;this.leftCellCnt=o.length;if(o.length&&i&&i.length){for(u=0;u<l.length;u++)if(i[u]>0){this._calculateGhostMetaHeadersWidth(i[u],l[u],this.viewportRect.width);f+=l[u].reduce(function(e,t){return e+t.minWidth},0)}this._calculateGhostMetaHeadersWidth(this.viewportRect.width-f,p.concat(c),this.viewportRect.width);o.forEach(function(e){e.oldCalcApprMaxGlyphCnt&&(e.calcApprMaxGlyphCnt=e.oldCalcApprMaxGlyphCnt)})}else this._calculateGhostMetaHeadersWidth(this.viewportRect.width);this.dataColumnsInfo.width=c[0]?c[0].widthFactor*this.viewportRect.width:0},_getDimGlyphCnt:function e(t){if(t===this.pseudoDimIndex)return this.longestMeasureTitleGlyphCnt;return this.layout.qHyperCube.qDimensionInfo[this.sortOrder[t]].qApprMaxGlyphCount},getDimInfo:function e(t,n){n||(n=0);if(t+n===this.pseudoDimIndex)return;return this.layout.qHyperCube.qDimensionInfo[this.sortOrder[t+n]]}};function l(e){var t=!!this.layout.qHyperCube.qAlwaysFullyExpanded;return this.sortOrder.filter(function(t,n){return e?n>=this.leftDimCnt:n<this.leftDimCnt},this).map(function(e,n){var i=0;if(-1===e)return 0;var o=this.layout.qHyperCube.qDimensionInfo[e];if(n+1<this.leftDimCnt){i=o.qApprMaxGlyphCount;t||(i+=this.opts.collapseExpandIconGlyphCnt);i=Math.max(o.othersLabel?o.othersLabel.length:0,i)}else{i=o.qApprMaxGlyphCount;i+=this.opts.columnPaddingGlyphCnt}return i},this).sort(function(e,t){return t-e})[0]||0}function u(e){return this.sortOrder.filter(function(t,n){return e?n>=this.leftDimCnt:n<this.leftDimCnt},this).map(function(e){var t=0;if(-1===e)t=n.get("Common.Measures").length;else{t=this.layout.qHyperCube.qDimensionInfo[e].qFallbackTitle.length+this.opts.buttonArrowGlyphCnt;this.layout.qHyperCube.qDimensionInfo[e].othersLabel&&(t=Math.max(this.layout.qHyperCube.qDimensionInfo[e].othersLabel.length,t))}return t+this.opts.buttonPaddingGlyphCnt+this.opts.buttonMarginOfSafetyGlyphCnt},this).sort(function(e,t){return t-e})[0]||0}Object.defineProperties(s.prototype,{isIndentMode:{get:function e(){return this.layout.qHyperCube.qIndentMode}},pseudoDimIndex:{get:function e(){var t=this.sortOrder.indexOf(-1);return~t?t:this.sortOrderCnt}},longestMeasureGlyphCnt:{get:function e(){return this.layout.qHyperCube.qMeasureInfo.map(function(e){return Math.max(e.qApprMaxGlyphCount,2)}).sort(function(e,t){return t-e})[0]||0}},longestMeasureTitleGlyphCnt:{get:function e(){return this.layout.qHyperCube.qMeasureInfo.map(function(e){return(e.qFallbackTitle||"").length}).sort(function(e,t){return t-e})[0]||0}},longestLeftDimTitleGlyphCnt:{get:function e(){return u.call(this)}},longestLeftDimGlyphCnt:{get:function e(){return l.call(this)}},longestTopDimGlyphCnt:{get:function e(){return l.call(this,true)}},sortOrder:{get:function e(){return this.layout.qHyperCube.qEffectiveInterColumnSortOrder}},sortOrderCnt:{get:function e(){return this.sortOrder.length}},leftDimCnt:{get:function e(){return this.layout.qHyperCube.qNoOfLeftDims>=0?this.layout.qHyperCube.qNoOfLeftDims:this.sortOrderCnt}},topDimCnt:{get:function e(){return this.sortOrderCnt-this.leftDimCnt}},totDataColCnt:{get:function e(){return this.layout.qHyperCube.qSize.qcx}},pseudoInLeftTree:{get:function e(){return this.pseudoDimIndex<this.leftDimCnt}},pseudoInTopTree:{get:function e(){return-1!==this.sortOrder.slice(this.leftDimCnt).indexOf(-1)}},columnWidths:{get:function e(){var t=this.layout.qHyperCube.columnWidths;return o.isValidColumnWidths(t)?[t[0].slice(),t[1].slice()]:[[],[]]}},explicitColumnWidths:{get:function e(){var t=this.columnWidths,n,i,o,r;if(!t||!t.length||1===t.length&&!Array.isArray(t[0])&&t[0]<=0)return[];if(t.length&&!Array.isArray(t[0])&&t[0]>0)n=t;else{if(this.isIndentMode)return t&&Array.isArray(t[0])?t[0]:[];n=t&&Array.isArray(t[1])?t[1]:[]}i=n?n.length:0;o=[];for(r=0;r<i;r++)o[r]=n[this.sortOrder[r]];return o}}});e.provider("qvPivotTableMetaGhostHeadersProvider",function e(){this.$get=[function(){return function e(t,n,i){return new s(t,n,i)}}]})}.apply(t,i),void 0!==o&&(e.exports=o))},1617:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(1618),n(1058)],o=function(e,t,n){function i(){this.$get=[function(){return function e(i,o,r,a,s,l,u,c){return new(t.extend("PivotTableSortableMetaLists",{addPlaceholder:function e(t,n){var i=this._super.apply(this,arguments);i.style.width=n.width;t.dragging=true},allowAutoScroll:function e(){return false},onBegin:function e(){this._super.apply(this,arguments);u.off();c.off();this.toggleCellsWhenSorting(this.grid.headerRows,this.grid.rows,true)},enable:function e(){this._super.apply(this,arguments);u.on();c.on();this.toggleCellsWhenSorting(this.grid.headerRows,this.grid.rows,false)},allowDrag:function e(){var e=this._super.apply(this,arguments);return e&&!(a&&a.qSelectionInfo&&a.qSelectionInfo.qMadeSelections)},onMove:function e(t){this._super.apply(this,arguments);this.patchPivotingProperties(t.dimIx)},onMoveToList:function e(t){var n=this._super.apply(this,arguments);n&&this.patchPivotingProperties(t.dimIx);return n},onEnterList:function e(t){t===this.rows&&t.isEmpty()&&this.metaGhostHeaders.update(2*this.metaGhostHeaders.opts.leftTree.emptyGlyphCnt);this._super.apply(this,arguments);t===this.columns&&this.rows.isEmpty()&&this.metaGhostHeaders.update(this.metaGhostHeaders.opts.leftTree.emptyGlyphCnt)},patchPivotingProperties:function e(t){var o,r,s,l;function u(e){return e.dimIx}o=this.rows.items.map(u);r=this.columns.items.map(u);this.backendApi.model.getEffectiveProperties().then(function(e){n.validatePivotHyperCube(e.qHyperCubeDef);s=n.reorderColumnOrderDef(t,o,r,e.qHyperCubeDef);l=n.getNoLeftDimsDef(t,o,a.qHyperCube,e.qHyperCubeDef);n.reorderPivotDimensions(e.qHyperCubeDef,s);var u=[{qPath:"/qHyperCubeDef/qInterColumnSortOrder",qOp:"replace",qValue:JSON.stringify(e.qHyperCubeDef.qInterColumnSortOrder)},{qPath:"/qHyperCubeDef/qNoOfLeftDims",qOp:"replace",qValue:JSON.stringify(l)},{qPath:"/qHyperCubeDef/qDimensions",qOp:"replace",qValue:JSON.stringify(e.qHyperCubeDef.qDimensions)}];e.qHyperCubeDef.columnWidths&&u.push({qPath:"/qHyperCubeDef/columnWidths",qOp:"replace",qValue:JSON.stringify(e.qHyperCubeDef.columnWidths)});i.applyPatches(u,true)})},toggleCellsWhenSorting:function e(){var t,n;for(t=arguments.length-1;t>=0;--t){if(!Array.isArray(arguments[t])){n=arguments[t];continue}var i,o=arguments[t];var r,a,s;for(i=0;i<o.length;++i){a=o[i].cells.length;for(r=0;r<a;++r){s=o[i].cells[r];s.isMeta?s[n?"addClass":"removeClass"]("drop"):s[n?"addClass":"removeClass"]("locked")}}}}}))({listSelector:".meta",listKey:function e(t){return t.find(".list").scope().list},itemSelector:".button-wrapper",itemDragSelector:".button-wrapper",itemKey:"header",containerSelector:"table"},i,o,r,a,s,l)}}]}e.provider("qvPivotTablePivoting",i)}.apply(t,i),void 0!==o&&(e.exports=o))},1618:function(e,t,n){"use strict";var i,o;!(i=[n(207),n(91),n(159)],o=function(e,t,n){var i;i=e.extend("SortableMetaLists",{init:function e(t,n,i,o,r,a,s){this._super.apply(this,[t]);this.layout=r;this.backendApi=n;this.grid=i;this.metaGhostHeaders=o;this.$id=a;this.currentPopover=s;this.rows=this.createList();this.rows.templateSrc="pt-meta-list.ng.html";this.columns=this.createList();this.columns.templateSrc="pt-meta-list.ng.html"},reset:function e(){this._super.apply(this,arguments)},update:function e(i){var o,r,a,s,l,u,c=t.get("Common.Values");this.reset();for(o=0;o<this.sortOrderCnt;++o){r=this.sortOrder[o];if(o<this.metaGhostHeaders.leftDimCnt)a=this.rows;else{if(i<=0)continue;a=this.columns}if(-1!==r){u=this.layout.qHyperCube.qDimensionInfo[r].qGroupFieldDefs[this.layout.qHyperCube.qDimensionInfo[r].qGroupPos];l=this.layout.qHyperCube.qDimensionInfo[r].qFallbackTitle;s={title:l,id:this.layout.qHyperCube.qDimensionInfo[r].cId,fieldName:u,style:{},qvaOutsideIgnoreFor:"qv-pt-meta-header-"+this.$id,open:this.currentPopover.header&&u===this.currentPopover.header.fieldName,dimIx:r,locked:!!this.layout.qHyperCube.qDimensionInfo[r].qLocked,dir:n.getAutoOrAlternativeDirection(l)}}else{l=c;s={title:c,dimIx:-1,isPseudoDim:true,style:{},locked:false,dir:n.getAutoOrAlternativeDirection(l)}}s.templateSrc="pt-meta-item.ng.html";a.addSortableItem(s)}}});Object.defineProperties(i.prototype,{sortOrder:{get:function e(){return this.layout.qHyperCube.qEffectiveInterColumnSortOrder}},sortOrderCnt:{get:function e(){return this.sortOrder.length}}});return i}.apply(t,i),void 0!==o&&(e.exports=o))},1619:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(1620)],o=function(e,t){function n(e,n,i,o,r,a,s,l,u,c){var d=n.find(o);var p=d.find(r);var f=p.find(a);var h;var g;var m;h={minRowHeight:i,rect:{left:0,top:0,width:0,height:0},scrollRect:{left:0,top:0,width:0,height:0},rowCount:0,direction:c.direction,getVirtualScrollController:function e(){return d.controller("qvScrollArea")},getSortableListController:function e(){return d.controller("qvSortableList")},getMultiSelectController:function e(){return f.controller("qvSelectionsMultiselect")},getEmptyMetaCellsOfLastHeaderRow:function e(){var t=d.find(".last-top-row .header.empty.left-meta.bottom-meta");return t},getFirstDataCell:function e(){var t=d.find(s),n;n={top:0,left:0,width:0};if(t.length){var i=t[0].getBoundingClientRect(),o=t.position();n.top=o.top;n.left=o.left;n.width=i.width}return n},getTopHeaders:function e(){return d.find(l)},getScrollAreaBBox:function e(){return u&&u.object&&!c.freeResize?t.getSnapshotScrollAreaBBox(d,u.object):d[0].getBoundingClientRect()},getScrollAreaPosition:function e(){return d.position()},getScrollContentBBox:function e(){return p[0].getBoundingClientRect()},updateRowCount:function e(t){h.rowCount=Math.ceil(t)},getMaxRowCount:function e(){return Math.ceil(h.scrollRect.height/h.minRowHeight)},getVisibleRowCount:function e(){var t=n[0].querySelector(s),i,o;if(!t)return 0;i=t.parentNode;o=Array.prototype.slice.call(i.parentNode.childNodes);o=o.filter(function(e){return e.nodeType===Node.ELEMENT_NODE});o=o.splice(o.indexOf(i));function r(e,t){var n=e.offsetTop+e.getBoundingClientRect().height,i=t.top+t.height;return n<=i}function a(e,t){var n=t-e;return 1===n?t:Math.floor(e+n/2)}function l(e,t,n){var i=n-t,o=a(t,n),s=r(e[o],h.scrollRect);if(0===i)return s?o:-1;if(1===i)return s?o:l(e,t,t);return s?l(e,o,n):l(e,t,o)}if(0===o.length)return 0;var u=l(o,0,o.length-1)+1;if(u===o.length){var c=o[o.length-1],d=h.scrollRect.top+h.scrollRect.height-(c.offsetTop+c.getBoundingClientRect().height);u+=Math.floor(d/(3*h.minRowHeight))}return u},updateRect:function t(){g=e(function(){var e=h.getScrollAreaBBox(),t=h.getFirstDataCell();h.rect.top=e.top;h.rect.left=e.left;h.rect.width=e.width;h.rect.height=e.height;h.updateRowCount((h.rect.height-t.top)/h.minRowHeight)},false);return g},updateScrollRect:function t(n){m=e(function(){var e=h.getScrollAreaPosition(),t=h.getFirstDataCell();h.scrollRect.top=e.top+t.top;h.scrollRect.height=h.rect.height-t.top;if("rtl"===h.direction){h.scrollRect.left=0;h.scrollRect.width=t.left+t.width}else{h.scrollRect.left=t.left;h.scrollRect.width=h.rect.width-t.left}if(n){h.updateRowCount(h.collapsedRowCount||h.scrollRect.height/h.minRowHeight);delete h.collapsedRowCount}},false);return m},getScrollRect:function e(){return{top:h.scrollRect.top,left:h.scrollRect.left,width:h.scrollRect.width,height:h.scrollRect.height}}};return h}function i(e){return n.bind(null,e)}function o(){this.$get=["$timeout",i]}e.provider("qvPivotTableViewportProvider",o)}.apply(t,i),void 0!==o&&(e.exports=o))},1620:function(e,t,n){"use strict";var i,o;!(i=[],o=function(){function e(e,t){var n=e[0].getBoundingClientRect();return{height:t.size.h,width:t.size.w,top:n.top,left:n.left}}return{getSnapshotScrollAreaBBox:e}}.apply(t,i),void 0!==o&&(e.exports=o))},1621:function(e,t,n){"use strict";var i,o;!(i=[n(48)],o=function(e){function t(e,t,n){var i=e.getVirtualScrollController(),o,r,a={active:false,activeFromStart:false},s={xAxis:0,yAxis:0};r={page:{qLeft:0,qTop:0,qWidth:0,qHeight:0},equalsPage:function e(t){return this.page.qLeft===t.qLeft&&this.page.qTop===t.qTop&&this.page.qWidth===t.qWidth&&this.page.qHeight===t.qHeight},setPage:function e(t){this.page.qLeft=t.qLeft;this.page.qTop=t.qTop;this.page.qWidth=t.qWidth;this.page.qHeight=t.qHeight},onGetData:function e(t){o=t},scroll:function e(t,n,o){var r=i.getScrollAmount(t,n,o);i.scroll(r.deltaX,r.deltaY,false,false)},DELTA_MODE:i.DELTA_MODE,setScrollViewport:function t(){return e.updateScrollRect(false).then(function(){i.setViewport(e.getScrollRect())}).catch(function(e){false})},setVirtualSize:function o(){var s=this;return e.updateScrollRect(true).then(function(){var o,l,u,c,d;a.active=false;a.activeFromStart=false;if(e.scrollRect.top+e.scrollRect.height>=e.rect.height&&r.page.qHeight>=n.qcy){o=e.getVisibleRowCount();if(o<r.page.qHeight){a.active=true;a.activeFromStart=true;e.updateRowCount(o)}}l={vPosY:s.page.qTop*e.minRowHeight,vPosX:s.page.qLeft*t.width};c=r.page.qWidth===n.qcx?e.scrollRect.width:n.qcx*t.width;u={width:c,height:n.qcy*e.minRowHeight};d={width:e.scrollRect.width,height:e.rowCount*e.minRowHeight};i.setVirtualSize(u,d,e.getScrollRect());(l.vPosY>0||l.vPosX>0)&&i.scroll(l.vPosX,l.vPosY)}).catch(function(e){false})},alignToBottom:function t(){var n=false;if(a.active){if(s.yAxis>0){var o=e.getVisibleRowCount();o<e.rowCount&&e.updateRowCount(o)}else{var r=e.getMaxRowCount();e.rowCount>=r&&(a.active=false);n=true}i.setVirtualViewport({width:e.scrollRect.width,height:e.rowCount*e.minRowHeight});n&&i.setVirtualScrollPos(0,-1)}}};function l(t){var i=e.getMaxRowCount();if(a.activeFromStart)return;t.qHeight=Math.min(n.qcy-t.qTop,i);e.updateRowCount(Math.min(t.qHeight,e.rowCount))}function u(n){return{qLeft:t.cnt>0?Math.round(n.vPosX/t.width):0,qTop:Math.round(n.vPosY/e.minRowHeight),qWidth:Math.max(1,t.cnt),qHeight:Math.max(1,e.rowCount)}}function c(e){if(e.qTop>0&&e.qTop+e.qHeight>n.qcy){e.qTop=Math.max(0,n.qcy-e.qHeight);e.qHeight=Math.min(n.qcy,e.qHeight)}if(e.qLeft>0&&e.qLeft+e.qWidth>n.qcx){e.qLeft=Math.max(0,n.qcx-e.qWidth);e.qWidth=Math.min(n.qcx,e.qWidth)}}i.onScroll(function(e,t){var n=i.getVirtualPosition(),d=i.getMaxPosition(),p=u(n);if(a.active&&t<0){l(p);d=i.getMaxPosition()}d.vPosY>0&&n.vPosY===d.vPosY&&(a.active=true);c(p);a.lastTop=p.qTop;s.xAxis=e;s.yAxis=t;if(!r.equalsPage(p)||a.active){r.setPage(p);o(r.page).then(function(){r.alignToBottom()})}});i.getScrollAmount=function(n,o,r){var a=i.getVirtualPosition();var s=i.getMaxPosition();switch(r){case 1:return{deltaX:t.width*n,deltaY:e.minRowHeight*o};case 2:return{deltaX:t.cnt*t.width*n,deltaY:e.minRowHeight*e.rowCount*o};case 10:return{deltaX:0,deltaY:o>0?a.vPosY*o:a.vPosY-s.vPosY};default:return{deltaX:n,deltaY:o}}};return r}function n(){return t}function i(){this.$get=[n]}e.provider("qvPivotTableVirtualScrollProvider",i)}.apply(t,i),void 0!==o&&(e.exports=o))},1622:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(11),n(164),n(101)],o=function(e,t,n,i){function o(e,o,r,a,s,l,u,c){var d=e.$new(),p;function f(t,n){var i,r,a,s=[],l,u,c,p=d.dataValuesArray.length,f;i=t.getRowsByCellType(t.CELL_TYPE_TOP).concat(t.getRowsByCellType(t.CELL_TYPE_LEFT));u=p>0?o.getSiblingCells(t,n):[];r=i.length;for(f=0;f<r;++f)s=s.concat(i[f].cells);l=s.length;for(f=0;f<l;++f){a=s[f];c=-1!==u.indexOf(a);(c&&!a.isDimensionValue||!c&&!a.isMeta)&&e[p?"lockCell":"unlockCell"](t,a)}}function h(){if(!d.active)return;e.updatePivot(l,d,d.currentCell);f(l,d.currentCell)}function g(){c.on();p&&p()}function m(){c.on();p&&p()}function v(){if(!d.active||!d.currentCell)return;o.getSiblingCells(l,d.currentCell).forEach(function(t){e.deselectCell(l,t)});f(l,d.currentCell)}function b(e,t){var n=i.getValue(e,"layout.qHyperCube.qDimensionInfo."+t,{});var o=n.qIsOneAndOnlyOne||false;return o}r.excludeDimensionToggle=function(e){return!a.active&&t(e.target).is(".qv-pt-expandable")};r.selectDimensionValue=function(t,n){var i=a.getKeyAsToggleSelected(n);var o;o=e.isColumnar(l,t)?t.dataColIx:r.metaGhostHeaders.leftDimCnt+t.dataRowIx;var u=r.layout.qHyperCube.qEffectiveInterColumnSortOrder[o];if(b(r,u)||!i){v();e.reset(d)}p=e.selectDimensionValue(r.$id,s,a,d,t,l,i);f(l,d.currentCell)};r.activateSelections=function(t){p=e.activateSelections(r.$id,s,a,d,t)};r.multiselectDimensionValues=function(t,n){var i,u,c,p=o.getSiblingCells(l,t),h=p.length,g,m=e.isColumnar(l,t),v=m?t.dataRowIx:t.dataColIx,b=m?n.dataRowIx:n.dataColIx;if(-1===p.indexOf(n)||!n.isDimensionValue)return;for(i=0;i<h;++i){c=p[i];u=m?c.dataRowIx:c.dataColIx;g=v<=b?u>=v&&u<=b:u>=b&&u<=v;g&&c.isDimensionValue&&c!==n&&e.selectDimensionCells(s,a,d,r.grid,c,false)}e.selectDimensionCells(s,a,d,r.grid,n,false);f(l,d.currentCell)};r.multiselect=function(){d.active&&e.sendSelection(s,a,d,l,d.currentCell)};r.selectWhileLocked=function(){if(d.dataValuesArray.length>0)return;n.showLockedFeedback(u.qHyperCube.qDimensionInfo)};a.watchActivated(function(){c.off()});e.init(a,s,d,g,m,v);return{updateSelections:h}}function r(e,t){return o.bind(null,e,t)}function a(){this.$get=["qvGridObjectSelectionService","qvGridObjectDataService",r]}e.provider("qvPivotTableSelectionsProvider",a)}.apply(t,i),void 0!==o&&(e.exports=o))},1623:function(e,t,n){"use strict";var i,o;!(i=[n(11),n(48),n(1624),n(1625),n(207),n(91),n(249)],o=function(e,t,n,i,o,r){var a={Dimension:"dimension",Measure:"measure",Pseudo:"pseudo"};t.getService("$templateCache").put("pivot-panel-item.ng.html",i);t.directive("qvPivotPanel2",function(){return{restrict:"E",template:n,replace:true,scope:{layout:"=layout",backendApi:"=backendApi"},controller:["$scope","$element",function(t,n){var i=this;t.itemTemplateSrc="pivot-panel-item.ng.html";t.sortableItemLists=o.create({options:{listKey:"list",listSelector:".qv-pivot-panel-column",itemSelector:".sortable",itemDragSelector:".icon-handle",itemKey:"item"},addPlaceholder:function e(){var t=this._super.apply(this,arguments);t.addClass("sortable")},bindAutoScroll:function t(){var i=n.find(".qv-pivot-panel-list ul");i.each(function(){var t=e(this),n=t.scope().list;n.scrollInfo={elem:t[0],clientRect:t[0].getBoundingClientRect(),scrollWidth:t[0].scrollWidth,scrollHeight:t[0].scrollHeight}})},onBegin:function e(){this._super.apply(this,arguments);this.bindAutoScroll()},onEnterList:function e(){this.bindAutoScroll()},onMove:function e(){var t=this._super.apply(this,arguments);t&&i.sortOrderUpdated();return t},onMoveToList:function e(t,n){var o=this._super.apply(this,arguments);if(o){if(n.disabled)return;i.sortOrderUpdated()}return o},onAutoScroll:function e(t,n,i,o){this._super.apply(this,arguments);!n&&i&&(n=this.getList(i));if(!n)return;var r=n.scrollInfo;o(r.elem,r.clientRect,r.scrollWidth,r.scrollHeight)}});t.columns=t.sortableItemLists.createList(1,{title:r.get("Common.Columns"),showMoveHandle:true});t.rows=t.sortableItemLists.createList(1,{title:r.get("Common.Rows"),showMoveHandle:true});t.measures=t.sortableItemLists.createList(2,{title:r.get("Common.Measures")});t.grid={rows:[]};t.grid.rows.push({lists:[t.columns]});t.grid.rows.push({lists:[t.rows,t.measures]});i.sortOrderUpdated=function(){var e=[],n;t.rows.items.forEach(function(t){e.push(t.dimIndex)});n=e.length;t.columns.items.forEach(function(t){e.push(t.dimIndex)});var i=[{qPath:"/qHyperCubeDef/qInterColumnSortOrder",qOp:"replace",qValue:JSON.stringify(e)},{qPath:"/qHyperCubeDef/qNoOfLeftDims",qOp:"replace",qValue:JSON.stringify(n)}];t.backendApi.applyPatches(i,true)};function s(e){var t;t=e.qLibraryId?e.title||"":e.qFallbackTitle||"";return t}function l(){var e=t.layout.qHyperCube.qNoOfLeftDims,n;t.sortableItemLists.reset();n=t.layout.qHyperCube.qEffectiveInterColumnSortOrder.map(function(e){var n;t.$broadcast("pivotPanelUpdated");if(-1===e)return{title:"Measures",cId:"pseudo-dimension",type:a.Pseudo,dimIndex:e,cssClass:["sortable","is-pseudo"]};n=t.layout.qHyperCube.qDimensionInfo[e];return{title:s(n),cId:n.cId,type:a.Dimension,dimIndex:e,cssClass:["sortable"]}});e=e<0?n.length:e;n.splice(0,e).forEach(function(e){var n=t.rows.add(e.title,e.cId,e.cssClass,1);n.dimIndex=e.dimIndex});n.forEach(function(e){var n=t.columns.add(e.title,e.cId,e.cssClass,1);n.dimIndex=e.dimIndex});t.layout.qHyperCube.qMeasureInfo.forEach(function(e){t.measures.add(e.qFallbackTitle||"",e.cId,[],2)})}t.$watchCollection("layout.qHyperCube.qDimensionInfo",l);t.$watchCollection("layout.qHyperCube.qEffectiveInterColumnSortOrder",l);t.$watchCollection("layout.qHyperCube.qMeasureInfo",l);t.$watchCollection("layout.qHyperCube.qNoOfLeftDims",l)}]}})}.apply(t,i),void 0!==o&&(e.exports=o))},1624:function(e,t){e.exports='<div class="qv-pivot-panel"\n\t qv-sortable-list="sortableItemLists">\n\t<div class="qv-pivot-panel-row" ng-repeat="row in grid.rows">\n\t\t<div class="qv-pivot-panel-column" ng-if="$first"></div>\n\t\t<div ng-repeat="list in row.lists" class="qv-pivot-panel-column" ng-class="{\'qv-pivot-panel-disabled\': list.disabled}">\n\t\t\t<h2>{{list.title}}</h2>\n\t\t\t<div class="qv-pivot-panel-list">\n\t\t\t\t<ul>\n\t\t\t\t\t<li ng-repeat="item in list.items track by item.id" class="qv-pivot-panel-item" ng-class="item.classList" ng-include src="itemTemplateSrc"></li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n'},1625:function(e,t){e.exports='<div class="field-wrapper field-token" ng-style="item.style">\n\t<div ng-if="list.showMoveHandle" class="icon-handle"></div>\n\t<div class="field-text">{{item.title}}</div>\n</div>\n'},1626:function(e,t){e.exports='<div class="column-width-adjuster">\n\t<qv-column-width-adjust-column ng-repeat="column in columns" column="column" explicit-column-width="explicitColumnWidths[$index]" x-rtl="rtl" min-col-width="minColWidth"></qv-column-width-adjust-column>\n</div>\n'},1627:function(e,t){e.exports='<div class="column-width-adjust-column" ng-style="columnStyle" >\n\t<div class="column-width-adjust-line" ng-class="{active : isActive}"></div>\n</div>\n'},1628:function(e,t,n){"use strict";var i,o;!(i=[n(101),n(91)],o=function(e,t){function n(e){var t=e.getMeasures();2===t.length?e.setSorting([2,1,0]):3===t.length&&e.setSorting([3,2,1,0])}function i(t,n){var i=n.getMeasures(),o=e.getValue(t,"color.mode");"byExpression"===o&&0===i.length&&e.setValue(t,"color.mode","primary")}var o={dimensions:{min:1,max:1,description:function e(){return t.get("Visualizations.Descriptions.Bubble")}},measures:{min:2,max:3,description:function e(n,i){var o;o=0===i?"properties.xAxis":1===i?"properties.yAxis":2===i?"Visualizations.Descriptions.Size":"Visualizations.Descriptions.Color";return t.get(o)},add:function e(t,i,o){n(o);t.qSortBy.qSortByNumeric=-1},remove:function e(t,o,r){n(r);i(o,r)}}};return o}.apply(t,i),void 0!==o&&(e.exports=o))},1629:function(e,t,n){"use strict";var i,o;function r(e){r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return r(e)}!(i=[n(383),n(90),n(101),n(91),n(160),n(113),n(99)],o=function(e,t,n,i,o,a,s){var l={textAlignAuto:{ref:"qDef.textAlign.auto",type:"boolean",component:"switch",translation:"Common.Text.TextAlignment",options:[{value:true,translation:"Common.Auto"},{value:false,translation:"Common.Custom"}],defaultValue:true},textAlign:{ref:"qDef.textAlign.align",type:"string",component:"dropdown",options:[{value:"left",translation:"Common.Text.AlignLeft"},{value:"right",translation:"Common.Text.AlignRight"}],defaultValue:"left",show:function e(t){return void 0!==t.qDef.textAlign&&!t.qDef.textAlign.auto}}};var u={representationType:{ref:"qDef.representation.type",type:"string",component:"dropdown",translation:"Object.Table.Representation",options:[{value:"text",translation:"Object.Table.Representation.Text"},{value:"url",translation:"Object.Table.Representation.Url"}],defaultValue:"text",show:function e(t){if("object"!==r(t.qDef.representation)){var n=t.qDef.representation||"text";t.qDef.representation={type:n}}return true}},representationUrl:{ref:"qDef.representation.urlLabel",type:"string",expression:"optional",translation:"Object.Table.Representation.Url.Label",defaultValue:"",change:function e(t){var n=o.getIndexById(t.qAttributeExpressions,o.IDMAP.CELL_URL_LABEL);if(t.qDef.representation.urlLabel.qStringExpression){var i=t.qDef.representation.urlLabel.qStringExpression.qExpr;-1===n?t.qAttributeExpressions.push(o.create(o.IDMAP.CELL_URL_LABEL,{qExpression:i})):t.qAttributeExpressions[n].qExpression=i}else t.qAttributeExpressions&&n>-1&&t.qAttributeExpressions.splice(n,1)},show:function e(t){var n=t.qDef.representation;return n&&"url"===n.type}}};var c={tableCellColoring:{component:"attribute-expression-reference",defaultValue:[],ref:"qAttributeExpressions",items:[{component:"expression",ref:"qExpression",expressionType:"measure",translation:"Object.Table.Measure.BackgroundExpression",defaultValue:"",id:o.IDMAP.CELL_BACKGROUND_COLOR,tid:"tableColorBgByExpression"},{component:"expression",ref:"qExpression",expressionType:"measure",translation:"Object.Table.Measure.ForegroundExpression",defaultValue:"",id:o.IDMAP.CELL_FOREGROUND_COLOR,tid:"tableColorByExpression"}]},totalsAggr:{type:"items",items:{totalsAggrFunc:{type:"string",component:"dropdown",ref:"qDef.qAggrFunc",translation:"Object.Table.AggrFunc",options:[{value:"Expr",translation:"Common.Auto"},{value:"Avg",translation:"Object.Table.AggrFunc.Avg"},{value:"Count",translation:"Object.Table.AggrFunc.Count"},{value:"Max",translation:"Object.Table.AggrFunc.Max"},{value:"Min",translation:"Object.Table.AggrFunc.Min"},{value:"Sum",translation:"Object.Table.AggrFunc.Sum"},{value:"None",translation:"Object.Table.AggrFunc.None"}],defaultValue:"Expr"},totalsAggrFuncMessage:{component:"text",translation:"Object.Table.AggrFuncMessage",show:function e(t,i){return i&&!n.getValue(i,"properties.totals.show")&&"noTotals"===n.getValue(i,"properties.totals.position")}}}}};var d={tableCellColoring:{component:"attribute-expression-reference",defaultValue:[],ref:"qAttributeExpressions",items:[{component:"expression",ref:"qExpression",expressionType:"measure",translation:"Object.Table.Measure.BackgroundExpression",defaultValue:"",id:o.IDMAP.CELL_BACKGROUND_COLOR,tid:"tableColorBgByExpression"},{component:"expression",ref:"qExpression",expressionType:"measure",translation:"Object.Table.Measure.ForegroundExpression",defaultValue:"",id:o.IDMAP.CELL_FOREGROUND_COLOR,tid:"tableColorByExpression"},{component:"expression",ref:"qExpression",expressionType:"measure",defaultValue:"",id:o.IDMAP.CELL_URL_LABEL,tid:"URLLabelByExpression",show:false}]}};var p={visibilityCondition:{type:"string",component:"expression",ref:"qCalcCondition.qCond",expression:"optional",expressionType:"ValueExpr",translation:"Object.Table.Columns.VisibilityCondition",defaultValue:{qv:""},tid:"visibilityCondition",isExpression:function e(t){return"string"===typeof t&&t.trim().length>0}}};var f={uses:"settings",items:{presentation:{type:"items",translation:"properties.presentation",items:[{ref:"totals.show",type:"boolean",translation:"properties.totals",component:"switch",options:[{value:true,translation:"Common.Auto"},{value:false,translation:"Common.Custom"}],defaultValue:true},{ref:"totals.position",translation:"Common.Position",type:"string",component:"dropdown",options:[{value:"noTotals",translation:"Common.None"},{value:"top",translation:"Common.Top"},{value:"bottom",translation:"Common.Bottom"}],defaultValue:"noTotals",show:function e(t){return!t.totals.show}},{ref:"totals.label",translation:"properties.totals.label",type:"string",expression:"optional",defaultValue:function e(){return i.get("Object.Table.Totals")}}]}}};if(a.ST_HSCROLL){f.items.presentation.grouped=true;f.items.presentation.items=[{type:"items",items:f.items.presentation.items},{type:"items",translation:"Object.Table.Scrolling",items:[{component:"text",translation:"Object.Table.Scrolling"},{ref:"scrolling.keepFirstColumnInView",type:"boolean",translation:"Object.Table.Scrolling.KeepFirstColumnInView",component:"checkbox",defaultValue:false},{ref:"scrolling.horizontal",type:"boolean",translation:"Object.Table.Scrolling.HorizontalScroll",component:"checkbox",defaultValue:true}],show:function e(){return s.treatAsDesktop()}},{type:"items",translation:"Object.Table.WrapText",items:[{component:"text",translation:"Object.Table.Multiline"},{ref:"multiline.wrapTextInHeaders",type:"boolean",translation:"Object.Table.Multiline.WrapTextInHeaders",component:"checkbox",defaultValue:true},{ref:"multiline.wrapTextInCells",type:"boolean",translation:"Object.Table.Multiline.WrapTextInCells",component:"checkbox",defaultValue:true}]}]}var h={type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling",items:{calcCond:{uses:"calcCond"}}}}};var g={type:"items",component:"columns",translation:"Common.Data",sortIndexRef:"qHyperCubeDef.qColumnOrder",allowMove:true,allowAdd:true,addTranslation:"Common.Columns",items:{dimensions:{type:"array",component:"expandable-items",ref:"qHyperCubeDef.qDimensions",grouped:true,items:t.extend(true,{},e.dimensions.items,p,d,l,u)},measures:{type:"array",component:"expandable-items",ref:"qHyperCubeDef.qMeasures",grouped:true,items:t.extend(true,{},e.measures.items,p,c,l)}}};var m={uses:"sorting"};return{type:"items",component:"accordion",items:{data:g,sorting:m,addons:h,settings:f}}}.apply(t,i),void 0!==o&&(e.exports=o))},1630:function(e,t){e.exports='<div class="qv-st" ng-class="{ \'qv-st-interactive\': interactive,\n\t\t\'qv-st-links-interactive\': linksInteractive,\n\t\t\'align-column-picker\': scrollApi.settings.columnPicker.show,\n\t\t\'qv-st-selections-active\': selections.active,\n\t\t\'qv-st-virtual-scroll-enabled\': scrollApi.virtualScrollEnabled,\n\t\t\'qv-st-navigatable\': navigatable,\n\t\t\'qv-rtl-layout\': rtl,\n\t\t\'qv-st-nowrap-in-headers\': !multiline.wrapTextInHeaders,\n\t\t\'qv-st-nowrap-in-cells\': !multiline.wrapTextInCells,\n\t\t\'qv-st-reordering-active\': reorderingColumn\n\t}" ng-keydown="handleKeyDown($event)" ng-keyup="handleKeyUp($event)"\n\tng-click="onClick($event)"\n\tng-focus="setFocus()"\n\ttabindex="-1" role="grid">\n\t<div class="qv-st-header-wrapper" dir="{{direction}}">\n\t\t<qv-table-column-width-adjuster\n\t\t\t\tmin-col-width="scrollApi.settings.column.minColWidth"\n\t\t\t\tng-if="navigatable && !selections.active"\n\t\t\t\tcolumns="columns"\n\t\t\t\texplicit-column-widths="visibleExplicitColumnWidths"\n\t\t\t\tx-rtl="rtl"\n\t\t\t\tdir="{{direction}}">\n\t\t</qv-table-column-width-adjuster>\n\t\t<qv-straight-table-top-header></qv-straight-table-top-header>\n\t</div>\n\t<qv-scroll-area class="qv-grid-object-scroll-area qv-animate" dir="{{direction}}"\n\t\t\t\t\tx-direction="direction">\n\t\t<qv-straight-table-data qv-selections-select-while-locked="selectWhileLocked()"\n\t\t\t\t\t\t\t\tqv-selections-toggle-dimension-value="{ selector: \'.qv-st-data-cell\'}"\n\t\t\t\t\t\t\t\tqv-selections-on-toggle-dimension-value="interactive && selectDimensionValue(cell, $event)"\n\t\t\t\t\t\t\t\tqv-selections-multiselect="{ selector: \'.qv-st-data-cell:not(.qv-st-data-cell-null-value)\' }"\n\t\t\t\t\t\t\t\tqv-selections-start-multiselect="interactive && activateSelections(cell)"\n\t\t\t\t\t\t\t\tqv-selections-update-multiselect="interactive && multiselectDimensionValues(start, current, dataColIx)"\n\t\t\t\t\t\t\t\tqv-selections-end-multiselect="interactive && multiselect()"></qv-straight-table-data>\n\t</qv-scroll-area>\n\t<qv-straight-table-bottom-header></qv-straight-table-bottom-header>\n\t<qv-scroll-loader></qv-scroll-loader>\n\t<qv-straight-table-column-picker-activator ng-if="scrollApi.settings.columnPicker.show"></qv-straight-table-column-picker-activator>\n</div>\n'},1631:function(e,t,n){"use strict";var i,o;!(i=[n(11)],o=function(e){function t(t,n,i,o){var r=i.top+i.height,a,s;var l=0;while(l<t.length){if(e(t[l]).offset().top+e(t[l]).height()>i.top){a=t[l];break}l++}l=t.length-1;while(l>=0){if(e(t[l]).offset().top<r){s=t[l];break}l--}if(!a||!s||n<=0)return{index:1,height:o?2:1,width:n||1};var u=e(a).scope().row.getIndex(),c=e(s).scope().row.getIndex();return{index:u,height:c-u+1,width:n}}return{getIndexHeightAndWidth:t}}.apply(t,i),void 0!==o&&(e.exports=o))},1632:function(e,t,n){"use strict";var i,o;!(i=[n(11),n(179)],o=function(e,t){var n=t.extend({init:function e(t,n,i,o,r,a,s,l){this.snapshotObject=s;this.options=l;this._super.apply(this,arguments)},getBoundingBox:function e(){var t;t=this.options.freeResize?this.$element[0].getBoundingClientRect():{height:this.snapshotObject.size.h,width:this.snapshotObject.size.w};return t},getScrollAreaClientWidth:function e(){if(!this.options.freeResize)return this.snapshotObject.size.w;return this._super.apply(this,arguments)},bindNativeHorizontalScroll:function e(){}});var i=t.extend({getScrollAreaClientHeight:function e(){var t=this.getScrollAreaBoundingBox();var n=this.getBoundingBox();return n.bottom-t.top},getScrollAreaBoundingBox:function t(){return e.extend(true,{},this._super.call(this))},getScrollAreaClientWidth:function e(){return this.$element.width()}});var o=i.extend({init:function e(t,n,i,o,r,a,s){this._super.apply(this,arguments);this.columnPicker=s},getBoundingBox:function t(){var n=e.extend(true,{},this._super.call(this));this.$element.find(".qv-st-column-picker").length>0&&(n.width+=this.columnPicker.width);return n}});var r=i.extend({init:function e(t){var n=Array.prototype.slice.call(arguments);n[0]=t.closest(".qv-object-content-container");this._super.apply(this,n);this.$element.css("-webkit-overflow-scrolling","touch");this.$element.find(".qv-object-content").first().css({overflow:"hidden",width:"inherit"})},destroy:function e(){this._super();this.unbindNativeHorizontalScroll();this.$element.find(".qv-object-content").first().css({overflow:"hidden",width:"100%"})},unbindNativeHorizontalScroll:function e(){this.$element.off("scroll"+this.namespace)},bindNativeHorizontalScroll:function e(t){this.$element.on("scroll"+this.namespace,t)},getScrollAreaBoundingBox:function e(){var t=this._super.call(this);t.width=this.$element[0].clientWidth+this.$element[0].scrollLeft;t.right=t.left+t.width;return t},getScrollAreaClientWidth:function e(){return this.$element[0].clientWidth},updateHorizontalScroll:function e(t){t.locked?this.$element.css({overflow:"hidden"}):this.$element.css({overflow:t.tableWidth>t.viewportWidth+1?"auto":"",direction:t.direction})},getHorizontalScroll:function e(){return this.$element.scrollLeft()},setHorizontalScroll:function e(t){this.$element.scrollLeft(t)}});var a=i.extend({});function s(e,t,i,s){var l=".qv-st-data-row",u=".qv-grid-object-data-first-row",c=".qv-grid-object-data-last-row";if(e.backendApi.isSnapshot)return new n(t,i,l,"","",null,e.layout.snapshotData.object,e.options);if(!s.horizontalScroll.enabled)return new o(t,i,l,u,c,null,s.columnPicker);if(s.horizontalScroll.useNativeScroll)return new r(t,i,l,u,c);return new a(t,i,l,u,c)}return{create:s,SnapshotScrollDOMApi:n,ColumnPickerTableScrollDOMApi:o,NativeHorizontalTableScrollDOMApi:r,VirtualHorizontalTableScrollDOMApi:a}}.apply(t,i),void 0!==o&&(e.exports=o))},1633:function(e,t,n){"use strict";var i,o;!(i=[n(206)],o=function(e){var t=e.extend({interactive:false,init:function e(t,n){this._super(t,n);if(!this.virtualScrollEnabled){this.settings.horizontalScroll.useVirtualScroll=false;this.settings.horizontalScroll.enabled=this.settings.horizontalScroll.useVirtualScroll||this.settings.horizontalScroll.useNativeScroll}this.direction="ltr"},initialize:function e(t,n,i,o){var r;this.settings.horizontalScroll.enabled&&this.settings.horizontalScroll.useNativeScroll&&t.bindNativeHorizontalScroll(function(){i.fadeScrollbarsWithoutDelay();this.$timeout.cancel(r);r=this.$timeout(function(){i.fadeInScrollbars();this.setVirtualSize(true)}.bind(this),100)}.bind(this));return this._super(t,n,i,o)},activate:function e(){this._super();this.interactive=true},deactivate:function e(){this._super();this.interactive=false},setDirection:function e(t){this.direction=t;this.domApi.setDirection(t)},updateHorizontalScroll:function e(){if(!(this.settings.horizontalScroll.enabled&&this.interactive))return;this.settings.horizontalScroll.useNativeScroll&&this.domApi.updateHorizontalScroll({locked:this.horizontalPositionLocked,viewportWidth:this.settings.width-(this.settings.columnPicker.show?this.settings.columnPicker.width:0),tableWidth:this.getAllColumnsWidth()})},columnWidths:null,updateMetaHeaders:function e(t,n,i){this.columnWidths=t.reduce(function(e,t){t.isFillColumn||(t.isSearchIcon?e.length>0&&(e[e.length-1]+=t.calculatedWidth):e.push(t.calculatedWidth));return e},[]);if(this.settings.horizontalScroll.enabled&&this.settings.horizontalScroll.useVirtualScroll){var o=this.domApi.getScrollAreaClientWidth()-this.getLockedColumnsWidth();var r=this.settings.horizontalScroll.keepFirstColumnInView;var a=this.virtualScrollApi.getVirtualPosition();var s=i||Math.floor(a.vPosX/this.settings.minColumnWidth);var l=this.columnWidths;var u=r?1:0;var c=0;n&&n.lockScrollPosition||this.updateViewportColumns(this.domApi.getScrollAreaClientWidth());s=Math.min(s,this.getScrollableColumnsCount()-this.viewportColumns);var d=-1;var p=0;t.forEach(function(e){if(e.isFillColumn)return;if(!e.isSearchIcon){d+=1;p=l[d]}if(0===d&&r)e.shouldBeRemoved=false;else if(d<s+u)e.shouldBeRemoved=true;else if(c>=o)e.shouldBeRemoved=true;else{(e.isSearchIcon||e.isMeasure)&&(c+=p);e.shouldBeRemoved=false}});for(var f=t.length-1;f>=0;--f)t[f].shouldBeRemoved&&t.splice(f,1)}},scrollColumnInView:function e(t,n){if(!this.settings.horizontalScroll.enabled)return;function i(e){if(!e)return 0;return e.reduce(function(e,t){return e+t},0)}var o=n.filter(function(e){return!e.isSearchIcon&&!e.isFillColumn});var r=o.filter(function(e){return e.dataColIx===t})[0];if(r){var a=r.qLeft;var s=i(this.columnWidths.slice(0,a));var l=this.columnWidths[a];var u=this.domApi.getScrollAreaClientWidth();if(this.settings.horizontalScroll.useNativeScroll){var c=this.domApi.getHorizontalScroll();c>s?c=Math.max(0,s-5):c+u<s+l&&(c=s+l-u+5);c!==this.domApi.getHorizontalScroll()&&this.domApi.setHorizontalScroll(c)}else{var d=this.virtualScrollApi.getVirtualPosition();var p=Math.floor(d.vPosX/this.settings.minColumnWidth);var f=this.columnWidths.slice();if(this.settings.horizontalScroll.keepFirstColumnInView){var h=f.shift();s-=h;u-=h;a--}p>0&&(s-=i(f.slice(0,p)));if(s+l>u){var g=l,m=a;for(var v=a-1;v>=0;--v){g+=f[v];if(g>u)break;m=v}this.virtualScrollApi.setVirtualViewport({width:(a-m+1)*this.settings.minColumnWidth,height:this.domApi.getVisibleRowCount(this.settings.maxRowHeight)*this.settings.minRowHeight});this.virtualScrollApi.scroll(m*this.settings.minColumnWidth-d.vPosX,0)}}}},horizontalPositionLocked:false,lockHorizontalScrollPosition:function e(t){if(!this.settings.horizontalScroll.enabled)return;this.horizontalPositionLocked=t;this.settings.horizontalScroll.useNativeScroll?this.updateHorizontalScroll():this.virtualScrollApi.setHorizontalScrollInteractive(!t)},getVirtualScrollAmount:function e(t,n,i){this.horizontalPositionLocked&&(t=0);if(this.settings.horizontalScroll.enabled){0!==t&&0!==n&&(Math.abs(t)>Math.abs(n)?n=0:t=0);if(i===this.DELTA_MODE.LINE)return{deltaX:t*this.settings.minColumnWidth,deltaY:this.settings.minRowHeight*n};if(i===this.DELTA_MODE.PAGE){var o=Math.max(0,this.domApi.getVisibleRowCount()-1);return{deltaX:this.getVisibleColumnCount()*this.settings.minColumnWidth*t,deltaY:o*this.settings.minRowHeight*n}}}return this._super(t,n,i)},getLockedColumnsWidth:function e(){var t=0;this.settings.horizontalScroll.enabled&&this.settings.horizontalScroll.keepFirstColumnInView&&this.columnWidths&&this.columnWidths.length>0&&(t=this.columnWidths[0]);return t},getAllColumnsWidth:function e(){if(!this.columnWidths)return 0;return this.columnWidths.reduce(function(e,t){return e+t},0)},getScrollableColumnsWidth:function e(){if(!this.columnWidths||0===this.columnWidths.length)return 0;var t=0;this.settings.horizontalScroll.enabled&&this.settings.horizontalScroll.keepFirstColumnInView&&(t=1);return this.columnWidths.slice(t).reduce(function(e,t){return e+t},0)},getScrollableColumnsCount:function e(){if(!this.columnWidths)return 0;var t=this.columnWidths.length;this.settings.horizontalScroll.enabled&&this.settings.horizontalScroll.keepFirstColumnInView&&(t-=1);return t},updateViewportColumns:function e(t){var n=0;var i=0;if(this.settings.horizontalScroll.keepFirstColumnInView){n+=this.columnWidths[0];i=1}this.viewportColumns=0;for(var o=this.columnWidths.length-1;o>=i;--o){n+=this.columnWidths[o];n<=t&&this.viewportColumns++;if(n>t)break}},getViewportColumns:function e(){if(this.settings.horizontalScroll.enabled)return this.viewportColumns;return this.getScrollableColumnsCount()},getVisibleColumnCount:function e(){var t=this.getPage();var n=0;var i=Math.ceil(this.domApi.getScrollAreaClientWidth());var o=0;for(var r=t.left;r<this.columnWidths.length;r++){o+=this.columnWidths[r];if(!(o<=i&&0!==this.columnWidths[r]))break;n++}return n},countColumnsToScrollOut:function e(t){var n=this.getPage();var i=this.getVisibleColumnCount();var o=this.columnWidths.slice(n.left);var r=o.splice(i).slice(0,t);var a=this.domApi.getScrollAreaClientWidth();var s=a-o.reduce(function(e,t){return e+t},0);if(!r.length)return 0;r[0]=r[0]-s;var l=r.reduce(function(e,t){return e+t},0);return o.reduce(function(e,t){e+=l>0?1:0;l-=t;return e},0)},onSetVirtualSize:function e(t){var n,i=this.domApi.getScrollAreaBoundingBox(),o=this.domApi.getScrollContentBoundingBox(),r=this.virtualScrollApi.getVirtualPosition(),a=this.settings.minRowHeight*this.totalRows,s=this.getViewportColumns(),l,u,c;var d=this.getLockedColumnsWidth();var p=this.getScrollableColumnsCount();if("reduce"===this.settings.alignToBottom){n=this.domApi.getVisibleRowCount(this.settings.maxRowHeight);o.height>=i.height&&this.settings.viewportRowCount>=this.totalRows&&n<this.settings.viewportRowCount&&(this.settings.viewportRowCount=n);u={width:s*this.settings.minColumnWidth,height:n*this.settings.minRowHeight}}else u={width:s*this.settings.minColumnWidth,height:i.height};l={width:this.settings.minColumnWidth*p,height:a};c={top:0,left:"rtl"!==this.direction?d:0,width:i.width-d,height:i.height};this.virtualScrollApi.setVirtualSize(l,u,c);t?this.virtualScrollApi.scroll(r.vPosX,r.vPosY,true):this.virtualScrollApi.scroll(Math.min(r.vPosX,(p-s)*this.settings.minColumnWidth),0,true)},updateVirtualViewport:function e(){var t=this.domApi.getVisibleRowCount(this.settings.maxRowHeight);var n=this.domApi.getScrollAreaBoundingBox();var i=this.getLockedColumnsWidth();this.virtualScrollApi.setViewport({top:0,left:"rtl"!==this.direction?i:0,width:n.width-i,height:n.height});this.virtualScrollApi.setVirtualViewport({width:this.getViewportColumns()*this.settings.minColumnWidth,height:t*this.settings.minRowHeight})},onVirtualScroll:function e(t,n){this.Scroll.emit();var i=this.virtualScrollApi.getVirtualPosition(),o=this.domApi.getVisibleRowCount(this.settings.maxRowHeight),r=this.getPage(i);if(r.top>0&&r.top+o>this.totalRows){r.top=Math.max(0,this.totalRows-o);r.height=Math.min(this.totalRows,r.height)}if(r.left>0&&r.left+r.width>this.totalColumns){r.left=Math.max(0,this.totalColumns-r.width);r.width=Math.min(this.totalColumns,r.width)}this.axisDelta.xAxis=t;this.axisDelta.yAxis=n;return this.dataApi.onVirtualScroll(r.top,r.height,r.left,r.width,t,n).then(function(){this.updateVirtualViewport()}.bind(this)).catch(function(e){false})}});return t}.apply(t,i),void 0!==o&&(e.exports=o))},1634:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(167),n(1635)],o=function(e,t){e.service("qvGridKeyboardNavigationService",function(){var e={HEADERS:"headers",DATA:"data",FOOTER:"footer"};function n(t){var n=t.getCell(0,0);return{cell:n,area:e.DATA}}function i(t){return t.area===e.DATA}function o(t){return t.area===e.HEADERS}function r(t){return t.area===e.FOOTER}function a(t,n){switch(n.area){case e.HEADERS:return t.getHeaderCell(n.row,n.col);case e.DATA:return t.getCell(n.row,n.col);case e.FOOTER:return t.getFooterCell(n.row,n.col)}}function s(e,t){var n=e.getHeaderRow(0);var i;var o=0;for(i=0;i<=t;i++)n.cells[i].isSearchIcon&&o++;return t-o}function l(e,t){var n=e.getHeaderRow(0);var i;var o=0;for(i=0;i<=t+o;i++)n.cells[i].isSearchIcon&&o++;return t+o}function u(e){return o(e)&&0===e.cell.rowIx}function c(e,t){var n=e.headerRows[0];var i=n.cells.length;var o;var r=i;for(o=0;o<i;o++)t?n.cells[o].isFillColumn&&r--:(n.cells[o].isFillColumn||n.cells[o].isSearchIcon)&&r--;return r}function d(e){var t=e.domApi.getVisibleRowCount(e.settings.maxRowHeight);return Math.max(0,t-1)}function p(e,t,n){var i=n.getVisibleColumnCount();var o=f(e,i,t)-1;if(t){var r=e.headerRows[0];r.cells[o].isSearchIcon&&o--}return o}function f(e,t,n){var i=e.headerRows[0];var o=0;if(!n)return t;return i.cells.reduce(function(e,n){n.isSearchIcon||o++;if(o>t||n.isFillColumn)return e;return e+1},0)}function h(e,t){var n=t.domApi.getHeightOfRow(e)||t.settings.minRowHeight;var i=0;var o;for(o=0;o<e;o++){if(i>=n)break;i+=Math.max(t.domApi.getHeightOfRow(o),t.settings.minRowHeight)}return o}function g(e){return e.rowList.rows.length}function m(e){return e.footerList.rows.length>0}function v(e){var t=e.getPage();return t.top>0}function b(e){var t=e.getPage();var n=e.domApi.getVisibleRowCount();return e.interactive&&t.top+n<e.totalRows}function x(e){var t=e.getPage();var n=e.getVisibleColumnCount();return e.interactive&&t.left+n<e.totalColumns}function y(t,n,a){var s=n.cell.rowIx;var u=n.cell.colIx;var c=e.DATA;if(i(n)&&0===s)if(v(a))a.scroll(0,-1,a.DELTA_MODE.LINE);else{s=t.headerRows.length-1;c=e.HEADERS;0===s&&(u=l(t,u))}else if(o(n)){if(s>0){s--;0===s&&(u=l(t,u))}c=e.HEADERS}else if(r(n)){c=e.DATA;s=g(t)-1}else if(s>0){s--;c=e.DATA}return{area:c,row:s,col:u}}function C(t,n,i){var a=n.cell.rowIx;var l=n.cell.colIx;var u=e.DATA;if(o(n)&&a===t.headerRows.length-1){0===a&&(l=s(t,l));a=0;u=e.DATA}else if(o(n)&&a<t.headerRows.length-1){0===a&&(l=s(t,l));a++;u=e.HEADERS}else if(r(n))u=e.FOOTER;else{u=e.DATA;var c=d(i);if(a<c)a++;else if(b(i)){var p=h(c+1,i);a-=p-1;i.scroll(0,p,i.DELTA_MODE.LINE)}else if(m(t)){a=0;u=e.FOOTER}}return{area:u,row:a,col:l}}function q(t,n,i){var s=n.cell.rowIx;var l=n.cell.colIx;var u=e.DATA;o(n)?u=e.HEADERS:r(n)&&(u=e.FOOTER);if(l>0)l--;else{var c=i.getPage();c.left>0&&i.scroll(-1,0,i.DELTA_MODE.LINE)}if(u===e.HEADERS&&0===s){var d=a(t,{area:u,row:s,col:l});d.isSearchIcon&&(0===l?l++:l--)}return{area:u,row:s,col:l}}function D(t,n,i){var o=n.cell.rowIx;var r=n.cell.colIx;var s;var l=n.area;var d=u(n);var h=false;s=p(t,d,i);if(r<s)r++;else if(x(i)){var g=i.countColumnsToScrollOut(1);var m=a(t,{area:l,row:o,col:r+1});m.isSearchIcon&&r++;r-=f(t,g,d)-1;h=true;i.scroll(g,0,i.DELTA_MODE.LINE)}if(l===e.HEADERS&&0===o&&!h){var v=a(t,{area:l,row:o,col:r});v.isSearchIcon&&(r===c(t,true)-1?r--:r++)}return{area:l,row:o,col:r}}function w(e,t,n){var o=t.cell.rowIx;i(t)&&(v(n)?n.scroll(0,-1,n.DELTA_MODE.PAGE):o=0);return{area:t.area,row:o,col:t.cell.colIx}}function I(e,t,n){var o=t.cell.rowIx;i(t)&&(b(n)?n.scroll(0,1,n.DELTA_MODE.PAGE):o=d(n));return{area:t.area,row:o,col:t.cell.colIx}}function S(e,t,n){var i=t.cell.rowIx;var o=0;var r=n.getPage();var a=0===r.left;var s;if(0===t.cell.colIx&&0===r.left)return{area:t.area,row:i,col:o};if(!a){s=0-r.left;s<0&&n.scroll(s,0,n.DELTA_MODE.LINE)}return{area:t.area,row:i,col:o}}function L(e,t){if(t)return e.headerRows[0].cells.length-1;return e.rows[0].cells.length-1}function E(e,t,n){var i=t.cell.rowIx;var o=t.cell.colIx;var r=u(t);var a=false;if(!x(n))return{area:t.area,row:t.cell.rowIx,col:p(e,r,n)};var s=n.getPage();var l=n.totalColumns-s.left-n.getViewportColumns();o=n.getViewportColumns()-1;n.scroll(l,0,n.DELTA_MODE.LINE);o>L(e,r)&&(a=true);if(r){a=true;o=2*n.getViewportColumns()-1}return{deferFocus:a,area:t.area,row:i,col:o}}function M(e,n,i,o,r){var s;var l;switch(n){case t.ARROW_UP:l=y(e,i,r);break;case t.ARROW_DOWN:l=C(e,i,r);break;case t.ARROW_RIGHT:l=o?q(e,i,r):D(e,i,r);break;case t.ARROW_LEFT:l=o?D(e,i,r):q(e,i,r);break;case t.PAGE_UP:l=w(e,i,r);break;case t.PAGE_DOWN:l=I(e,i,r);break;case t.HOME:l=S(e,i,r);break;case t.END:l=E(e,i,r);break;default:throw new Error("Unsupported keyboard key.")}s=l.deferFocus?{rowIx:l.row,colIx:l.col}:a(e,l);return{deferFocus:!!l.deferFocus,cell:s,area:l.area}}function _(e,n,i,o){var r=i.cell;var s;switch(n){case t.ARROW_UP:if(r.rowIx>0||v(o)){s=y(e,i,o);r=a(e,s)}break;case t.ARROW_DOWN:if(r.rowIx<d(o)||b(o)){s=C(e,i,o);r=a(e,s)}break;default:throw new Error("Unsupported keyboard key.")}return{cell:r,area:i.area}}function A(e,t,n){if(!t)return;var i;var o=t.cell.rowIx;var r=t.cell.colIx;var s=d(n);var l=p(e,u(t),n);if(o>s||r>l){o=o>s?s:o;r=r>l?l:r}i={area:t.area,row:o,col:r};return{cell:a(e,i),area:i.area}}return{init:n,moveFocus:M,moveFocusWhileSelecting:_,realignFocus:A,TABLE_AREA:e,KEYS:t}})}.apply(t,i),void 0!==o&&(e.exports=o))},1635:function(e,t,n){"use strict";var i,o;!(i=[n(48)],o=function(e){var t="qvFocusableCell";e.directive(t,[function(){return{restrict:"A",link:function e(n,i,o){var r=n.$eval(o[t]);var a=n.cell||n.header;n.area=r.area;if(a){a.addFocusListener(function(){i[0].setAttribute("tabindex",0);i[0].focus()});a.addBlurListener(function(){i[0].setAttribute("tabindex",-1);i[0].blur()})}n.$watchGroup(["cell.isFillColumn","header.isFillColumn"],function(e){var t=void 0!==e[0]?e[0]:e[1];t?t&&i[0].removeAttribute("tabindex"):i[0].setAttribute("tabindex",-1)})}}}])}.apply(t,i),void 0!==o&&(e.exports=o))},1636:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(11),n(1637),n(91)],o=function(e,t,n,i){e.directive("qvStraightTableTopHeader",function(){return{restrict:"E",replace:true,template:n,link:function e(n){var o=n.layout.qInfo.qId;n.sortHeader=function(e){var i=t(e.target).scope().header;n.sort(i)};n.searchHeader=function(e){var i=t(e.target).closest(".qv-st-header-cell");var o=i.scope().header;e.preventDefault();n.search(i,o)};n.getSRLabelForColumns=function(e){var t=i.get("Accessibility.Table.SortedAscending");var n=i.get("Accessibility.Table.SortedDescending");if(e.isSorted){if("A"===e.sortIndicator)return e.text+". "+t;if("D"===e.sortIndicator)return e.text+". "+n}return e.text};n.getTopHeaderColIx=function(e){return e.isSearchIcon||e.isTotal?void 0:o+"-header-"+e.dataColIx};n.getTotalsColIx=function(e){return e.isTotal?o+"-header-"+e.dataColIx:void 0}}}})}.apply(t,i),void 0!==o&&(e.exports=o))},1637:function(e,t){e.exports='<div class="qv-st-header" tid="qv-st-header-top" ng-style="scrollApi.topBottomStyle">\n\t<table\tdir="{{direction}}"\n\t\t\tng-style="tableStyles.header"\n\t\t\tqva-delegated-activate=".qv-st-header-sortable:not(.qv-st-custom-header)#navigatable && !selections.active && sortHeader($event);\n\t\t   .qv-st-header-cell-search:not(.qv-st-total-cell)#interactive && !selections.active && searchHeader($event)">\n\t\t<colgroup class="qv-st-columns">\n\t\t\t<col ng-repeat="header in grid.headerRows[0].cells"\n\t\t\t\t ng-style="header.style"\n\t\t\t\t ng-class="header.classList"/>\n\t\t</colgroup>\n\t\t<tbody>\n\t\t\t<tr ng-repeat="row in grid.headerRows">\n\t\t\t\t<th ng-repeat="header in row.cells"\n\t\t\t\t\ttid="{{header.tid}}"\n\t\t\t\t\tng-attr-id="{{getTopHeaderColIx(header)}}"\n\t\t\t\t\tng-attr-headers="{{getTotalsColIx(header)}}"\n\t\t\t\t\tng-attr-aria-sort="{{header.ariaSort}}"\n\t\t\t\t\tclass="qv-st-header-cell"\n\t\t\t\t\tqva-outside-ignore-for="{{header.qvaOutsideIgnoreFor}}"\n\t\t\t\t\tng-class="{ \'qv-st-header-cell-numeric\': header.isNumeric,\n\t\t\t\t\t\t\'qv-st-custom-header\': !!options.customHeader,\n\t\t\t\t\t\t\'qv-st-header-sortable\': header.sortable,\n\t\t\t\t\t\t\'qv-st-total-cell\': header.isTotal,\n\t\t\t\t\t\t\'qv-st-header-cell-hidden\': header.shouldBeRemoved,\n\t\t\t\t\t\t\'qv-st-header-cell-dimension\': header.isDimension,\n\t\t\t\t\t\t\'qv-st-header-cell-search\': header.isSearchIcon,\n\t\t\t\t\t\t\'qv-st-header-cell-search-open\': header.isSearchIcon && header.open,\n\t\t\t\t\t\t\'qv-st-reordering-column\': header.dataColIx === reorderingColumn.dataColIx\n\t\t\t\t\t }"\n\t\t\t\t\taria-label="{{header.isTotal ? getSRLabelForTotals(header) : getSRLabelForColumns(header)}}"\n\t\t\t\t\tcolspan="{{header.colspan}}"\n\t\t\t\t\tqv-st-column-reorder-handle="navigatable && !selections.active && !header.isSearchIcon && !header.isTotal"\n\t\t\t\t\tqv-focusable-cell="{ area: TABLE_AREA.HEADERS }">\n\t\t\t\t\t<qv-straight-table-header-cell ng-if="!header.isSearchIcon || !options.customHeader" aria-hidden="true"></qv-straight-table-header-cell>\n\t\t\t\t\t<qv-straight-table-header-cell-search ng-if="!header.isTotal && header.isSearchIcon"></qv-straight-table-header-cell-search>\n\t\t\t\t</th>\n\t\t\t</tr>\n\t\t</tbody>\n\t</table>\n</div>\n'},1638:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(1639),n(50),n(11),n(242)],o=function(e,t,n,i){e.directive("qvStraightTableHeaderCell",[function(){return{restrict:"E",replace:true,template:t,link:function t(i,o){i.hasCustomHeader=!!i.options.customHeader;var r=o.closest(".qv-st-header-cell");if(i.options.customHeader){i.customHeaderHeight=i.options.customHeader.height;var a=e.getService("$compile");i.dmmodel=i.options.customHeader.model;o.append(a(i.options.customHeader.template)(i))}i.$watch("!header.isSearchIcon && !header.isTotal && selections.currentDataColIx === header.dataColIx",function(e){var t;if(!e){if(-1!==i.selections.currentDataColIx){t=i.row.getPreviousCell(i.header);i.header.removeClass("qv-st-active-col");t&&t.removeClass("qv-st-pre-active-col")}return}t=i.row.getPreviousCell(i.header);i.header.addClass("qv-st-active-col");t&&t.addClass("qv-st-pre-active-col");i.selectionsApi.getDockToElement=function(){var e=i.rtl?r.next():r;return n.isSmallDevice?o.closest(".qv-object").parent():e}})}}}]);e.directive("qvStColumnReorderHandle",[function(){return{restrict:"A",link:function e(t,n,o){if(t.options.disableDragAndDropColumnReorder)return;n.draggable({delay:100,appendTo:n.closest(".qv-st"),axis:"x",zIndex:100,opacity:1,helper:function e(){var t=n.width();var o=i("<div class='qv-st-column-drag-helper'><table><tbody></tbody></table></div");var r=i(document.createElement("tr"));n.clone().css("box-sizing","border-box").css("width",n.width()).css("height",n.height()+"px").appendTo(r);if(n.next().is(".qv-st-header-cell-search")){n.next().clone().css("box-sizing","border-box").css("width",n.next().width()).css("height",n.next().height()+"px").appendTo(r);t+=n.next().width()}o.find("table > tbody").append(r);o.css("box-sizing","border-box").css("width",t+4+"px");return o},start:function e(){t.$emit("onStartReorderingColumns",{dataColIx:t.header.dataColIx})},drag:function e(i,o){t.$emit("onReorderingColumns",{dataColIx:t.header.dataColIx,offset:t.rtl?n.closest(".qv-st").innerWidth()-o.position.left-o.helper.width():o.position.left})},stop:function e(i,o){t.$emit("onStopReorderingColumns",{dataColIx:t.header.dataColIx,offset:t.rtl?n.closest(".qv-st").innerWidth()-o.position.left-o.helper.width():o.position.left})}});o.qvStColumnReorderHandle&&t.$watch(o.qvStColumnReorderHandle,function(e){n.draggable("option","disabled",!e)})}}}]);e.directive("qvStraightTableHeaderCellSearch",[function(){return{restrict:"E",replace:true,template:'<i class="lui-icon  lui-icon--search" q-title-translation="Common.Search"></i>',link:function e(t,i){var o=i.closest(".qv-st-header-cell");t.$watch("!header.isTotal && selections.currentDataColIx === header.dataColIx",function(e){if(!e){-1!==t.selections.currentDataColIx&&t.header.removeClass("qv-st-active-col");return}t.header.addClass("qv-st-active-col");t.selectionsApi.getSelectionToolbarWidthOffset=function(){var e=t.rtl?o.prev():o;return n.isSmallDevice?0:e[0].getBoundingClientRect().width+1}})}}}])}.apply(t,i),void 0!==o&&(e.exports=o))},1639:function(e,t){e.exports='<div class="qv-st-header-cell-wrapper" ng-style="{height: customHeaderHeight}">\n\t<div class="qv-st-value" ng-if="!hasCustomHeader"\n\t\t ng-class="{ \'qv-st-header-selections-active\': header.selectionsActive }"\n\t\t ng-style="{ \'textAlign\': header.textAlign }">\n\t\t<div class="qv-st-value-overflow"\n\t\t\t dir="{{header.dir}}"\n\t\t\t ng-class="{ \'qv-rtl-text\': header.isRtl }">\n\t\t\t<i ng-class="{\'lui-icon\': header.locked, \'lui-icon--lock\': header.locked }"></i><span ng-attr-title="{{header.text}}" ng-bind="header.text"></span>\n\t\t</div>\n\t</div>\n\n\t<i ng-if="header.isSorted && header.sortIndicator !== \'N\' && !hasCustomHeader"\n\t   class="qv-st-sorting-indicator"\n\t   ng-class="{ \'lui-icon lui-icon--triangle-top\': header.sortIndicator === \'A\', \'lui-icon lui-icon--triangle-bottom\': header.sortIndicator === \'D\', \'icon-triangle-light\': header.color.bgIsDark && header.reversed }"\n\t   ng-style="header.sortStyle"></i>\n</div>\n'},1640:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(1641)],o=function(e,t){e.directive("qvStraightTableData",[function(){return{restrict:"E",replace:true,template:t}}])}.apply(t,i),void 0!==o&&(e.exports=o))},1641:function(e,t){e.exports='<div class="qv-st-data" tid="qv-st-data">\n\t<qv-scroll-load-button\n\t\t\tclass="qv-st-load-prev"\n\t\t\tdisabled="!navigatable"\n\t\t\tng-show="scrollApi.loadPrevious && scrollApi.settings.columnCount > 0 && ( navigatable || !isLoadPrevVisible )"\n\t\t\ton-load="scrollApi.gotoPreviousBlock()"\n\t\t\ttext="Object.Listbox.LoadPrevious"\n\t\t\tscroll-api="scrollApi"\n\t\t\tshow-button="scrollApi.loadPrevious"\n\t\t\twatch-resize="watchResize"\n\t\t\tprevious="true">\n\t</qv-scroll-load-button>\n\t<label class="hidden-screen-reader-label" ng-attr-id="{{\'st-cell-selection-status-label-\' + objectId }}" aria-live="assertive"></label>\n\t<table ng-style="tableStyles.content"\n\t\t   dir="{{direction}}">\n\t\t<colgroup class="qv-st-columns">\n\t\t\t<col ng-repeat="header in grid.headerRows[0].cells"\n\t\t\t\t ng-style="header.style"\n\t\t\t\t ng-class="header.classList"/>\n\t\t</colgroup>\n\t\t<tbody>\n\t\t\t<tr ng-repeat="row in grid.rows" class="qv-st-data-row" ng-class="{ \'qv-grid-object-data-first-row\': $first, \'qv-grid-object-data-last-row\': $last }">\n\t\t\t\t<td ng-repeat="cell in row.cells" class="qv-st-data-cell"\n\t\t\t\t\trowspan="{{ cell.rowspan }}"\n\t\t\t\t\tcolspan="{{ cell.colspan }}"\n\t\t\t\t\theaders="{{ objectId + \'-header-\' + cell.dataColIx}}"\n\t\t\t\t\tqv-focusable-cell="{ area: TABLE_AREA.DATA }"\n\t\t\t\t\tng-style="!cell.selected && !cell.selectedHighlighted && cell.style"\n\t\t\t\t\tng-class="{ \'qv-st-data-cell-dimension-value\' : cell.isDimensionValue,\n\t\t\t\t\t\t\'qv-st-data-cell-hidden\': cell.hidden,\n\t\t\t\t\t\t\'qv-st-data-cell-numeric\': cell.isNumeric,\n\t\t\t\t\t\t\'qv-st-data-cell-selected\': cell.selected,\n\t\t\t\t\t\t\'qv-st-data-cell-selected-highlighted\': cell.selectedHighlighted,\n\t\t\t\t\t\t\'qv-st-data-cell-null-value\': cell.isNullValue,\n\t\t\t\t\t\t\'qv-st-data-cell-locked\': cell.isSelectLocked,\n\t\t\t\t\t\t\'qv-st-data-cell-color-dark\': cell.color.bgByExpression && !cell.color.bgIsDark,\n\t\t\t\t\t\t\'qv-st-data-cell-color-light\': cell.color.bgByExpression && cell.color.bgIsDark,\n\t\t\t\t\t\t\'qv-st-data-cell-column-highlighted\': cell.columnHighlighted,\n\t\t\t\t\t\t\'qv-st-reordering-column\': cell.dataColIx === reorderingColumn.dataColIx\n\t\t\t\t\t}">\n\t\t\t\t\t<qv-straight-table-data-cell></qv-straight-table-data-cell>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</tbody>\n\t</table>\n\t<qv-scroll-loader class="qv-scroll-row-loader"></qv-scroll-loader>\n\t<qv-scroll-load-button\n\t\t\tclass="qv-st-load-next"\n\t\t\tng-show="scrollApi.loadNext && scrollApi.settings.columnCount > 0 && navigatable"\n\t\t\ton-load="scrollApi.gotoNextBlock()"\n\t\t\ttext="Object.Listbox.LoadMore"\n\t\t\tscroll-api="scrollApi"\n\t\t\tshow-button="scrollApi.loadNext"\n\t\t\twatch-resize="watchResize">\n\t</qv-scroll-load-button>\n</div>\n'},1642:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(1643)],o=function(e,t){e.directive("qvStraightTableDataCell",[function(){return{restrict:"E",replace:true,template:t,link:function e(){}}}])}.apply(t,i),void 0!==o&&(e.exports=o))},1643:function(e,t){e.exports='<div class="qv-st-value"\n\t ng-attr-title="{{cell.text}}"\n\t ng-style="{ \'textAlign\': cell.textAlign }"\n\t dir="{{cell.dir}}">\n\t<div class="qv-st-value-overflow"\n\t\t ng-class="{ \'qv-rtl-text\': cell.isRtl }">\n\t\t<a ng-if="cell.representation === \'url\' && !selections.active" ng-style="{\'color\': cell.style.color}" qva-activate="openUrl(cell.url)" ng-attr-title="{{cell.url}}" ng-bind="cell.text"></a>\n\t\t<span ng-if="cell.representation === \'text\' || cell.representation === \'url\' && selections.active" ng-bind="cell.text"></span>\n\t</div>\n</div>\n'},1644:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(1645)],o=function(e,t){e.directive("qvStraightTableBottomHeader",function(){return{restrict:"E",replace:true,template:t,link:function e(){}}})}.apply(t,i),void 0!==o&&(e.exports=o))},1645:function(e,t){e.exports='<div class="qv-st-bottom-header" tid="qv-st-bottom-header" ng-style="tableStyles.header">\n\t<table dir="{{direction}}">\n\t\t<colgroup class="qv-st-columns">\n\t\t\t<col ng-repeat="header in grid.headerRows[0].cells"\n\t\t\t\t ng-style="header.style"\n\t\t\t\t ng-class="header.classList" />\n\t\t</colgroup>\n\t\t<tbody>\n\t\t\t<tr ng-repeat="row in grid.footerRows">\n\t\t\t\t<td ng-repeat="header in row.cells"\n\t\t\t\t\ttid="{{header.tid}}"\n\t\t\t\t\theaders="{{objectId + \'-header-\' + $index}}"\n\t\t\t\t\tclass="qv-st-header-cell"\n\t\t\t\t\tng-class="{ \'qv-st-header-cell-numeric\': header.isNumeric,\n\t\t\t\t\t\t\'qv-st-total-cell\': header.isTotal,\n\t\t\t\t\t\t\'qv-st-header-cell-hidden\': header.shouldBeRemoved,\n\t\t\t\t\t\t\'qv-st-header-cell-dimension\': header.isDimension,\n\t\t\t\t\t\t\'qv-st-header-cell-measure\': header.isMeasure,\n\t\t\t\t\t\t\'qv-st-header-cell-search\': header.isSearchIcon }"\n\t\t\t\t\tcolspan="{{header.colspan}}"\n\t\t\t\t\taria-label="{{getSRLabelForTotals(header)}}"\n\t\t\t\t\tqv-focusable-cell="{ area: TABLE_AREA.FOOTER }">\n\t\t\t\t\t<qv-straight-table-header-cell></qv-straight-table-header-cell>\n\t\t\t\t</th>\n\t\t\t</tr>\n\t\t</tbody>\n\t</table>\n</div>\n'},1646:function(e,t){e.exports='<lui-popover style="min-width: 100px;width: 150px;" align-to="alignTo" position="\'bottom\'" on-close-view="closeTypeFoldout(event)" qva-outside-ignore-for="{{qvaOutsideIgnoreFor}}" class="pp-type-popover" tid="pp-type-popover">\n\t<ul class="lui-list">\n\t\t<li ng-repeat="item in items" class="lui-list__item" tid="{{item.tid}}" ng-class="{ \'lui-disabled\': item.disabled() }" qva-activate="itemClicked($event,item);" ng-disabled="item.disabled()">\n\t\t\t<span class="lui-list__text" q-translation="{{item.translation}}"></span>\n\t\t</li>\n\t</ul>\n</lui-popover>\n'},1647:function(e,t,n){"use strict";var i,o;!(i=[n(125)],o=function(e){function t(e){var t=e.qDimensions,i=e.qMeasures;function o(){var e=[];for(var n=0;n<t.length+i.length;n++)e.push(n);return e}n(t,i,e.qColumnOrder)&&(e.qColumnOrder=o());n(t,i,e.qInterColumnSortOrder)&&(e.qInterColumnSortOrder=o())}function n(e,t,n){var i={},o=[],r=false;n.forEach(function(e){i[e]?r=true:i[e]=true});r=r||e.length+t.length!==Object.keys(i).length;Object.keys(i).forEach(function(e){o.push(parseInt(e,10))});o=o.sort(function(e,t){return e-t});for(var a=0;a<o.length;++a)r=r||o[a]!==a;return r}function i(n){t(n);var i=n.qDimensions,o=n.qMeasures,r=n.qColumnOrder,a=n.qInterColumnSortOrder;var s=[],l=[],u;for(var c=0;c<r.length;c++){u=r[c];u<i.length?s.push(u):l.push(u)}function d(){for(var t=0;t<s.length;t++)if(s[t]!==t){var n=s[t];var o=s.indexOf(t);var l=s[o];e.swap(s,t,o);e.swap(i,n,l);e.swap(r,r.indexOf(n),r.indexOf(l));e.swap(a,a.indexOf(n),a.indexOf(l))}}function p(){for(var t=0;t<l.length;t++)if(l[t]!==t+i.length){var n=l[t];var s=l.indexOf(t+i.length);var u=l[s];e.swap(l,t,s);e.swap(o,n-i.length,u-i.length);e.swap(r,r.indexOf(n),r.indexOf(u));e.swap(a,a.indexOf(n),a.indexOf(u))}}d();p()}function o(t,n,i){var o;if(n<i)for(o=n;o<i;o++)e.swap(t.columnWidths,o,o+1);else for(o=n;o>i;o--)e.swap(t.columnWidths,o,o-1)}return{validateTableHyperCube:t,fixTableHypercubeOrders:i,isInvalidOrderArray:n,updateColumnInfoOrders:o}}.apply(t,i),void 0!==o&&(e.exports=o))},1648:function(e,t,n){"use strict";var i,o;!(i=[n(403)],o=function(e){function t(){this.titleRetriever=e.create();this.cache={}}t.prototype.getDimensionTitle=n;t.prototype.getMeasureTitle=i;t.prototype.getCachedMeasureTitle=o;t.prototype.resetTitles=r;return t;function n(e,t,n){return this.titleRetriever.getDimensionTitle(e,t,n)}function i(e,t,n,i){var o=this;return this.titleRetriever.getMeasureTitle(e,t,n,i).then(function(t){e&&s(o.cache,e.cId,t);return t})}function o(e){return e?a(this.cache,e.cId):""}function r(){this.titleRetriever.resetTitles()}function a(e,t){return e[t]||""}function s(e,t,n){e[t]=n}}.apply(t,i),void 0!==o&&(e.exports=o))},1649:function(e,t,n){"use strict";var i,o;!(i=[n(1650),n(369),n(178)],o=function(e,t,n){function i(e,t){o(e,t,this)}i.prototype.isChangeable=r;i.prototype.getAggregation=a;i.prototype.getRemainder=s;i.prototype.openPopover=l;i.prototype.closePopover=u;i.prototype.isPopoverOpen=c;return i;function o(t,n,i){t||d("Scope is required");n||d("LuiPopover is required");i.popovers=[];i.createPopover=function(){return e.create(t,n)}}function r(e){if(!e||!e.qDef)return false;var n=!!e.qDef.qLabel||!!e.qDef.qLabelExpression,i=!!e.qLibraryId;if(n||i)return false;var o=t.classify(e.qDef.qDef);return 1===o.count&&o.result.function.isCommon}function a(e){if(!e)return"";var i=t.classify(e);return n.getFormattedAggregation(i.result.function.content)}function s(e){if(!e)return"";var n=t.classify(e);return n.result.remainder.content}function l(e,t,n,i){var o=this,r=o.popovers[t];if(!r){r=o.createPopover();o.popovers[t]=r}Object.keys(this.popovers).forEach(function(e){if(e===t)return;o.popovers[e].close();delete o.popovers[e]});r.open(e,n,i)}function u(e){var t=this.popovers[e];if(t){t.close();delete this.popovers[e]}}function c(e){var t=this.popovers[e];return!!t&&t.isOpen()}function d(e){throw new Error("ChangeMeasureAggregationService: "+e)}}.apply(t,i),void 0!==o&&(e.exports=o))},1650:function(e,t,n){"use strict";var i,o;!(i=[n(1651)],o=function(e){var t={create:n};return t;function n(t,n){return new e(t,n)}}.apply(t,i),void 0!==o&&(e.exports=o))},1651:function(e,t,n){"use strict";var i,o;!(i=[n(187),n(178),n(1327),n(1652),n(90)],o=function(e,t,n,i,o){function r(e,t){a(this,e,t)}r.prototype.open=s;r.prototype.close=l;r.prototype.isOpen=u;return r;function a(n,o,r){o||c("Scope is required");r||c("LuiPopover is required");n.scope=o;n.luiPopover=r;n.popover=null;n.defaultConfig={isOpenButton:function e(){return false},onAggregationChanged:function e(){}};var a=e.COMMON_FUNCTIONS.map(function(e){return t.getFormattedAggregation(e)});n.settings={template:i,input:{aggregations:a},dock:"bottom",closeOnResize:true,closeOnOutside:true}}function s(e,t,i){e.stopPropagation();var r=this;if(r.popover){r.popover=null;return}var a=o.extend({},r.defaultConfig,i);r.settings.alignTo=e.target;r.settings.input.getCurrentAggregation=function(){return t.currentAggregation};r.settings.input.onAggregationChanged=function(e){t.currentAggregation=e;var i=n.addAggregation(e,t.remainder);t.data.qDef.qDef=i;a.onAggregationChanged(t,e);r.scope.$emit("saveProperties");l.call(r)};r.popover=r.luiPopover.show(r.settings);r.popover.closing.then(function(e){e&&!a.isOpenButton(e.target)&&(r.popover=null)})}function l(){if(this.popover){this.popover.close();this.popover=null}}function u(){return!!this.popover}function c(e){throw new Error("ChangeAggregationPopover: "+e)}}.apply(t,i),void 0!==o&&(e.exports=o))},1652:function(e,t){e.exports='<lui-popover class="pp-selectaggregation-popover">\n\t<div class="lui-popover__body lui-popover__body lui-nopad">\n\t\t<ul class="lui-list">\n\t\t\t<li class="lui-list__item" \n\t\t\t\tng-repeat="aggregation in aggregations" \n\t\t\t\tng-class="{ \'lui-active\': aggregation === getCurrentAggregation() }"\n\t\t\t\tng-click="onAggregationChanged(aggregation)"\n\t\t\t\ttitle="{{aggregation}}">\n\t\t\t\t<span class="lui-list__text lui-list__action">{{aggregation}}</span>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</lui-popover>'},1653:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(1654),n(1655),n(97),n(207),n(1656),n(96),n(249),n(1003)],o=function(e,t,n,i,o,r,a){e.service("qvStraighTableColumnPickerService",["luiPopover",function(e){return{show:function t(i){var o=e.showToPosition({template:n,input:i,x:i.position.x,y:i.position.y,dock:"right",closeOnEscape:true,closeOnOutside:true,outsideIgnore:i.qvaOutsideIgnoreFor});o.closed.then(function(){i.closeColumnPicker();o=null});return function(){o&&o.close()}}}}]);e.directive("qvStraightTableColumnPicker",function(){return{restrict:"A",require:"qvSortableList",link:function e(t,n,i,o){t.columnPicker.cancel=function(){o.cancel()}}}});return e.directive("qvStraightTableColumnPickerActivator",["qvStraighTableColumnPickerService","qvGridObjectDataService",function(e,n){return{restrict:"E",replace:true,template:t,require:"^qvObjectContent",link:function t(s,l,u,c){var d;a(l[0]).tap({options:{preventDefault:false},end:function e(t,n){f(n);s.$digest()}}).swipe({options:{preventDefault:false},start:function e(){p();s.$digest()}});function p(){s.columnPicker.showPopover=false;d&&d();d=void 0}function f(t){if(!s.navigatable||s.selections.active)return;s.columnPicker.showPopover=!s.columnPicker.showPopover;if(s.columnPicker.showPopover){g();var n=l[0].getBoundingClientRect();var o=t.pagePoints[0].y;d=e.show({position:{x:n.left+Math.floor(n.width/2),y:o},columnPicker:s.columnPicker,onMoveBegin:s.onMoveBegin,onMoveEnter:s.onMoveEnter,onMoveCancel:s.onMoveCancel,onMove:s.onMove,closeColumnPicker:p,qvaOutsideIgnoreFor:s.columnPicker.qvaOutsideIgnoreFor,sortableItemLists:s.sortableItemLists,hc:s.layout.qHyperCube,options:s.options});i.on("start."+s.$id,m)}else p()}function h(){s.columnPicker.columns.get().forEach(function(e,t){s.scrollApi.settings.columnCount<t?e.disabled=true:e.disabled=false})}s.sortableItemLists=o.create({options:{direction:"vertical",itemKey:"col",itemSelector:".qv-st-cp-sortable",itemDragSelector:".qv-st-cp-handle"},addPlaceholder:function e(t,n){var i=this._super.apply(this,arguments);i.style.height=n.height;i.id=-1},onMove:function e(t){var n=this._super.apply(this,arguments);if(n){h();var i=!Array.isArray(s.layout.qHyperCube.qColumnOrder);var o=s.layout.qHyperCube.qColumnOrder;var a=s.columnPicker.columns.get(function(e){return e.id>=0}).map(function(e){return e.id});var l=r.applyPartialReorder(o,a,t.id);s.applyColumnOrderSoftPatch(i,l)}return n}});s.columnPicker={showPopover:false,columns:s.sortableItemLists.createList(),qvaOutsideIgnoreFor:"qv-st-column-picker-"+s.$id,cancel:function e(){}};function g(){var e=s.layout.qHyperCube,t=e.qDimensionInfo.concat(e.qMeasureInfo),i={},o,r;s.columnPicker.cancel();s.columnPicker.columns.reset();n.columnOrder.getVisible(e).forEach(function(e){var n={id:e,classList:["qv-st-cp-sortable"],title:t[e].qFallbackTitle};s.columnPicker.columns.addSortableItem(n)});i.title="";i.id=-2;i.classList=["qv-st-cp-divider"];i.isDivider=true;s.columnPicker.columns.addSortableItem(i,32);o=s.columnPicker.columns.getIndexByItem(i);r=s.scrollApi.settings.columnCount;s.columnPicker.columns.moveItem(o,r);h()}c.watchPaint(g);function m(){i.off("start."+s.$id,m);if(s.columnPicker.showPopover){d();s.columnPicker.showPopover=false;s.$digest()}}}}}])}.apply(t,i),void 0!==o&&(e.exports=o))},1654:function(e,t){e.exports='<div class="qv-st-column-picker"\n\t tid="qv-st-column-picker"\n\t ng-class="{ \'qv-st-column-picker-open\': columnPicker.showPopover }"\n\t tabindex="-1">\n\t<table>\n\t\t<tr>\n\t\t\t<td q-title-translation="{{columnPicker.showPopover ? \'Tooltip.CloseColumnPicker\' : \'Tooltip.ColumnPicker\'}}">\n\t\t\t\t<div class="qv-st-column-picker-more">\n\t\t\t\t\t<span class="lui-icon lui-icon--more" aria-hidden="true"></span>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\t</table>\n</div>\n'},1655:function(e,t){e.exports='<lui-popover\n\t\tclass="qv-st-column-picker-popover"\n\t\tqva-direction x-dir-setting="{{input.options.direction}}"\n\t\tqva-mouse-wheel-outside="closeColumnPicker()">\n\t<lui-popover-header>\n\t\t<lui-popover-title q-translation="Common.Columns"/>\n\t</lui-popover-header>\n\t<lui-popover-body class="lui-nopad">\n\t\t<ul class="qv-st-cp-popover-list"\n\t\t\tqv-sortable-list="input.sortableItemLists">\n\t\t\t<li class="qv-st-cp-popover-list-item"\n\t\t\t\tdraggable="false"\n\t\t\t\tng-repeat="col in input.columnPicker.columns.items track by col.id"\n\t\t\t\tng-class="col.classList"\n\t\t\t\tng-style="col.style">\n\t\t\t\t<table class="qv-st-cp-popover-table" ng-if="col.id !== -2">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td ng-class="{ \'disabled\': col.disabled }">\n\t\t\t\t\t\t\t<div class="qv-st-cp-overflow" ng-bind="col.title" qva-direction x-dir-setting="{{options.direction}}" x-dir-text="{{col.title}}"></div>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td ng-if="col.id !== -2" class="qv-st-cp-handle">\n\t\t\t\t\t\t\t<div class="lui-icon lui-icon--handle"></div>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</li>\n\t\t</ul>\n\t</lui-popover-body>\n</lui-popover>\n'},1656:function(e,t,n){"use strict";var i,o;!(i=[],o=function(){function e(e,t,n){var i=e.slice();var o=i.indexOf(n);i.splice(o,1);if(t.length<2)return i;var r=t.indexOf(n);var a;var s;if(r>0){a=t[r-1];s=i.indexOf(a)+1}else{a=t[1];s=Math.max(0,i.indexOf(a))}i.splice(s,0,n);return i}return{applyPartialReorder:e}}.apply(t,i),void 0!==o&&(e.exports=o))},1657:function(e,t){e.exports='<div class="qv-ti" style=\'width: 100%; height: 100%;\' qva-activate="edit()">\n\t<div class="media-tool-scrollbar" ng-if="!editing && !initializing && !saving && !empty" dir="{{ direction }}">\n\t\t<div class="qv-media-tool-html" ng-class="[sizeClass, visibilityClass, responsiveClass, {\'qv-interactive\': navigation}]" ng-click="clickHtml($event)" ng-bind-html="html" dir="{{ textDirection }}"></div>\n\t</div>\n\t<div class="text-image-hint" ng-if="empty && !editing" ng-class="{ \'selected\': isSelected() }">\n\t\t<div class="hint-content" ng-show="!isSelected() || !editmode || object.isLink">\n\t\t\t<i class="hint-icon lui-icon lui-icon--text"></i>\n\t\t\t<div class="text" q-translation="Object.TextImage.EmptyHint"></div>\n\t\t</div>\n\t\t<div class="hint-content" ng-show="isSelected() && editmode && !object.isLink">\n\t\t\t<i class="hint-icon lui-icon lui-icon--plus"></i>\n\t\t\t<div class="text" q-translation="Object.TextImage.EmptySelectedHint"></div>\n\t\t</div>\n\t</div>\n\t<div class="qv-media-tool-editor" ng-class="[sizeClass, visibilityClass, responsiveClass]" ng-if="initializing || editing || saving" qv-text-image-editor x-editor-options="editorOptions" x-save="save" dir="{{ direction }}" qva-outside-ignore-for="media-toolbar"></div>\n</div>'},1658:function(e,t,n){"use strict";var i,o;!(i=[n(101)],o=function(e){return{type:"items",component:"accordion",items:{data:{uses:"data",items:{measures:{disabledRef:""},dimensions:{disabledRef:""}}},settings:{uses:"settings",items:{general:{items:{showTitles:{defaultValue:false}}},presentation:{type:"items",translation:"properties.presentation",items:{responsive:{type:"string",component:"dropdown",ref:"responsive",translation:"properties.textImage.responsive",defaultValue:"all",undefinedValue:"none",snapshot:{tid:"property-responsive"},options:[{value:"all",translation:"properties.textImage.responsive.textImages"},{value:"text",translation:"properties.textImage.responsive.text"},{value:"images",translation:"properties.textImage.responsive.images"},{value:"none",translation:"properties.textImage.responsive.none"}]}}},markdown:{type:"string",ref:"markdown",show:false,defaultValue:""},images:{type:"array",ref:"images",show:false,defaultValue:[]},backgroundImage:{type:"items",translation:"properties.backgroundImage",grouped:true,items:{useBackgroundImage:{ref:"background.isUsed",type:"boolean",translation:"properties.backgroundImage.use",component:"switch",defaultValue:false,options:[{value:true,translation:"properties.on"},{value:false,translation:"properties.off"}]},backgroundUrl:{ref:"background.url.qStaticContentUrlDef.qUrl",layoutRef:"background.url.qStaticContentUrl.qUrl",schemaIgnore:true,translation:"Common.Image",tooltip:{select:"properties.media.select",remove:"properties.media.removeBackground"},type:"string",component:"media",defaultValue:"",show:function t(n){return e.getValue(n,"background.isUsed")}},backgroundSize:{ref:"background.size",translation:"properties.backgroundImage.size",type:"string",component:"dropdown",defaultValue:"auto",options:[{value:"auto",translation:"properties.backgroundImage.originalSize"},{value:"alwaysFit",translation:"properties.backgroundImage.sizeAlwaysFit"},{value:"fitWidth",translation:"properties.backgroundImage.sizeFitWidth"},{value:"fitHeight",translation:"properties.backgroundImage.sizeFitHeight"},{value:"fill",translation:"properties.backgroundImage.sizeStretch"}],show:function t(n){return e.getValue(n,"background.isUsed")&&e.getValue(n,"background.url.qStaticContentUrlDef.qUrl")}},backgroundPosition:{ref:"background.position",translation:"Common.Position",type:"string",component:"align-matrix",defaultValue:"topLeft",show:function t(n){return e.getValue(n,"background.isUsed")&&e.getValue(n,"background.url.qStaticContentUrlDef.qUrl")&&"fill"!==e.getValue(n,"background.size")},currentSize:function t(n){return e.getValue(n,"background.size")}}}}}}}}}.apply(t,i),void 0!==o&&(e.exports=o))},1659:function(e,t,n){"use strict";var i,o;!(i=[n(125),n(90)],o=function(e,t){function n(e,t){var n=[],i=[],o,r,a;o=e.map(function(e){return e.qDef.cId});r=t.map(function(e){return e.qDef.cId});for(a=r.length-1;a>=0;--a)o.contains(r[a])||n.push({index:a,id:r[a],measure:t[a]});for(a=0;a<o.length;++a)r.contains(o[a])?o.lastIndexOf(o[a])!==a&&i.push({index:a,id:o[a],measure:e[a]}):i.push({index:a,id:o[a],measure:e[a]});return{removed:n,added:i}}function i(e,t){return t.replace(/=\[(\w*?)]\((\w*?)\)/g,function(t,n,i){return e===i?"":t})}function o(e,t,n,i){var o=-1;return n.replace(/=\[(\w*?)]\((\w*?)\)/g,function(n,r,a){if(a===e){++o;var s="undefined"!==typeof i;if(!s||s&&o===i)return"=["+r+"]("+t+")"}return n})}function r(i,r){var a=r.qHyperCubeDef.qMeasures;var s=n(i,a);s.removed.forEach(function(t){var n=t.index;a.splice(n,1);e.indexRemoved(r.qHyperCubeDef.qInterColumnSortOrder,r.qHyperCubeDef.qDimensions.length+n)});s.added.forEach(function(n){var i=n.measure.qDef.cId,s=t.generateId();n.measure.qDef.cId=s;a.push(n.measure);e.indexAdded(r.qHyperCubeDef.qInterColumnSortOrder,r.qHyperCubeDef.qDimensions.length+a.length-1);r.markdown=o(i,s,r.markdown,1)})}return{removeMeasure:i,replaceMeasure:o,syncMeasures:r}}.apply(t,i),void 0!==o&&(e.exports=o))},1660:function(e,t,n){"use strict";var i,o;!(i=[n(250),n(304),n(90)],o=function(e,t,n){function i(e,t){var n=[],i=[],o;var r=e.map(function(e){return e.id||""});var a=t.map(function(e){return e.id});for(o=a.length-1;o>=0;--o)r.contains(a[o])||n.push({index:o,id:a[o],url:t[o].url});function s(e){for(var n=0;n<t.length;n++)if(t[n].id===e)return t[n].url.qStaticContentUrlDef.qUrl;return null}for(o=0;o<r.length;++o)a.contains(r[o])?r.lastIndexOf(r[o])!==o&&i.push({index:o,id:r[o],url:s(r[o])}):i.push({index:o,id:r[o],url:e[o].url});return{removed:n,added:i}}function o(e,t,n,i){var o=-1;return n.replace(/!\[(\w*?)]\((.*?)\)/g,function(n,r,a){if(r===e){++o;var s="undefined"!==typeof i;if(!s||s&&o===i)return"!["+t+"]("+a+")"}return n})}function r(r,a){a.images||(a.images=[]);var s=a.images;var l=i(r,s);l.removed.forEach(function(e){var t=e.index;s.splice(t,1)});l.added.forEach(function(i){var r=i.id,l=n.generateId();var u=e.unescapeMarkdown(i.url);u=t.stripBasePath(u);s.push({id:l,url:{qStaticContentUrlDef:{qUrl:u}}});a.markdown=o(r,l,a.markdown,r?1:0)})}return{syncImages:r}}.apply(t,i),void 0!==o&&(e.exports=o))},1661:function(e,t,n){"use strict";var i,o;!(i=[n(91),n(101)],o=function(e,t){function n(e,n){var i=n.getDimensions(),o=n.getMeasures(),r=t.getValue(e,"color.mode");i.length>1&&e.color?e.color.persistent=true:"byExpression"===r&&0===o.length&&t.setValue(e,"color.mode","primary")}function i(e){var t;if(e.getDimensions().length>1){t=e.getSorting().indexOf(0);0!==t&&e.changeSorting(t,0)}}function o(e,n){t.setValue(n,"color.dimensionId",void 0)}var r={dimensions:{min:1,max:15,description:function t(n,i){var o=n.qHyperCubeDef.qDimensions.length,r=i>=o-1?"Visualizations.Descriptions.Rectangle":"Visualizations.Descriptions.Group";return e.get(r)},add:function e(t,i,o){n(i,o)},move:function e(t,o,r){i(r);n(o,r)},remove:function e(t,i,r){o(t,i,r);n(i,r)},replace:function e(n,i,o,r){t.getValue(r,"color.dimensionId")===i.qDef.cId&&t.setValue(r,"color.dimensionId",n.qDef.cId)}},measures:{min:1,max:1,description:function t(n,i){var o=0===i?"Visualizations.Descriptions.Size":"Visualizations.Descriptions.Color";return e.get(o)},add:function e(t,i,o){n(i,o)},move:function e(t,i,o){n(i,o)},remove:function e(t,i,o){n(i,o)}}};return r}.apply(t,i),void 0!==o&&(e.exports=o))},1663:function(e,t,n){"use strict";var i,o;!(i=[n(91)],o=function(e){var t={measures:{min:1,max:15,description:function t(){return e.get("Visualizations.Descriptions.Bar")},add:function e(){},move:function e(){},remove:function e(){}}};return t}.apply(t,i),void 0!==o&&(e.exports=o))},1672:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(108),n(1673),n(165),n(1674),n(101),n(128),n(131),n(90),n(91),n(315),n(1675)],o=function(e,t,n,i,o,r,a,s,l,u){e.directive("qvPropertyPanel",function(){return{template:n,restrict:"E",replace:true,scope:{ignorePatches:"<"},controller:["$scope",function(n){var c={};n.subPanels=[];s.selectedObject&&s.selectedObject.getAllPropertyPanelContent().then(function(e){if(e){var t={components:null,localeInfo:null,app:null,ext:null,globalChangeListeners:null,handler:null};l.extend(t,e);h(t)}}).catch(function(){});function d(e){n.title=r.getValue(e,n.titleRef||"title");n.subtitle=e.subtitle;n.isInvalid=e.qError||"invalid"===c.type;t.inClient()&&(n.isPatched=e.qHasSoftPatches)}function p(e){return e.model.app.getObject(e.properties.qExtendsId).then(function(e){return e.getLayout().then(function(e){return e.permissions.update})})}n.$on("$destroy",function(){c.model&&c.model.Invalidated.unbind(f)});function f(){c.model.getLayout().then(function(e){var t=e.visualization||e.qInfo&&e.qInfo.qType;if(!t)return;if(t!==c.type){c.type=t;return}n.$broadcast("layoutchanged",e);d(e);c.model.getProperties().then(function(e){if(e.qInfo.qId!==c.model.id&&"widget"!==c.type)return;n.args.prevProperties=e;e=l.extend(true,{},e);n.data=e;n.args.properties=e;c.properties=e;c.handler&&c.handler.setProperties(e);n.isLinked=!!e.qExtendsId;n.$broadcast("datachanged",e);n.isLinked&&p(c).then(function(e){n.showEditMasterPropsBtn=e})})})}n.$on("saveProperties",function(e,t){e.stopPropagation();t=t||n.data;c.globalChangeListeners&&c.globalChangeListeners.forEach(function(e){e&&"function"===typeof e&&e(t,n.args.handler,n.args)});c.model.setProperties(t)});n.$on("updateContent",function(e,t){e.preventDefault();h(t)});function h(e){n.subPanels.length=0;o.loadComponents().then(function(){c.model&&c.model.Invalidated.unbind(f);var t=l.extend(true,{},e.properties);var o={prevProperties:null,properties:t,cache:e.cache,layout:e.layout,model:e.model,localeInfo:e.localeInfo,app:e.app,ext:e.ext,yMirrorMode:e.yMirrorMode};if(e.handler){e.handler.setProperties(t);e.handler.setLayout(e.layout);o.handler=e.handler}n.data=t;n.definition=e.definition;n.args=o;n.args.iconName=e.iconName;n.args.headerLabel=e.headerLabel;n.args.headerAction=e.headerAction;n.iconName=e.iconName;n.isLinked=!!t.qExtendsId;n.showEditMasterPropsBtn=false;n.isLinked&&p(e).then(function(e){n.showEditMasterPropsBtn=e});n.headerComponentDefinition={type:"items",component:"header-with-switch",translation:n.data.title};n.headerComponent=l.extend({},i.findComponent({type:"items",component:"header-with-switch"}));n.rootComponent=l.extend({},i.findComponent(e.definition));c=e;e.model.Invalidated.bind(f);d(e.layout);n.isReady=true;var r=c.definition.interceptor;if(r&&l.isFunction(r)){var a=r(n);if(a&&l.isFunction(a.then)){n.isReady=false;a.then(function(){n.isReady=true})}}(e.model.isInvalid||e.model.isValidating)&&f()})}var g=n.$root.$on("showSubPanel",function(e,t){e.preventDefault();if(!t.id)throw new Error("A sub-panel need to have an id specified!");if(!t.triggerId)throw new Error("A sub-panel need to have a triggerId specified!");var i=n.subPanels.some(function(e){return e.options.triggerId===t.triggerId||e.options.id===t.id});i||n.subPanels.push({directiveHook:{},options:t})});var m=n.$root.$on("hideSubPanel",function(e,t){t=t||{};var i=n.subPanels||[];if(!i.length)return;if(t.hasOwnProperty("id")){if(!t.id)throw Error("PP: Invalid subpanel ID");var o=i.filter(function(e){return e.options.id===t.id});o.length&&o[0].directiveHook.close()}else if(t.all){var r=void 0===t.forceClose||t.forceClose;i.forEach(function(e){e.directiveHook.close(r)})}else i[i.length-1].directiveHook.close()});n.savePatches=function(){c.model.getEffectiveProperties().then(function(e){c.model.setProperties(e).then(function(){c.model.clearSoftPatches()})})};n.clearPatches=function(){c.model.clearSoftPatches()};n.editMasterProps=function(){e.getService("qvConfirmDialog").show({message:u.get("Object.Master.EditWarning.Text"),icon:"cogwheel"}).closed.then(function(e){e&&a.editMaster(c.properties.qExtendsId,c.properties.qInfo.qType)})};n.$on("$destroy",function(){g();m()})}]}})}.apply(t,i),void 0!==o&&(e.exports=o))},1673:function(e,t){e.exports='<div class="qv-property-panel">\n\t<div ng-if="!isInvalid && isLinked" class="overlay">\n\t\t<div class="overlay-content">\n\t\t\t<section>\n\t\t\t\t<div class="icon lui-icon lui-icon--link"></div>\n\t\t\t\t<p class="title" q-translation="Object.Linked.NoEdit.PropPanel.Title"></p>\n\t\t\t\t<p class="message" q-translation="Object.Linked.NoEdit.PropPanel.Text" ng-if="!showEditMasterPropsBtn"></p>\n\t\t\t\t<p class="message" q-translation="Object.Linked.Edit.PropPanel.Text" ng-if="showEditMasterPropsBtn"></p>\n\t\t\t\t<button class="lui-button" qva-activate="editMasterProps()" ng-if="showEditMasterPropsBtn" tid="edit-master-item">\n\t\t\t\t\t<span q-translation="Common.Edit"></span>\n\t\t\t\t</button>\n\t\t\t</section>\n\t\t</div>\n\t</div>\n\t<div ng-if="isInvalid" class="overlay">\n\t\t<div class="overlay-content">\n\t\t\t<section>\n\t\t\t\t<p class="title" q-translation="Object.Invalid.NoEdit.PropPanel.Title"></p>\n\t\t\t\t<p q-translation="Object.Invalid.NoEdit.PropPanel.Text"></p>\n\t\t\t</section>\n\t\t</div>\n\t</div>\n\t<div ng-if="!isLinked && isPatched && !ignorePatches" class="overlay">\n\t\t<div class="overlay-content">\n\t\t\t<section>\n\t\t\t\t<div class="lui-icon lui-icon--control"></div>\n\t\t\t\t<p class="title" q-translation="Object.VisualExploration.NoEdit.PropPanel.Title"></p>\n\t\t\t\t<p q-translation="Object.VisualExploration.NoEdit.PropPanel.Text"></p>\n\t\t\t</section>\n\n\t\t\t<div class="space"></div>\n\t\t\t<section>\n\t\t\t\t<button class="lui-button" qva-activate="savePatches()">\n\t\t\t\t\t<span q-translation="Common.Apply"></span>\n\t\t\t\t</button>\n\t\t\t</section>\n\n\t\t\t<div class="space"></div>\n\t\t\t<section>\n\t\t\t\t<button class="lui-button" qva-activate="clearPatches()">\n\t\t\t\t\t<span q-translation="Common.Discard"></span>\n\t\t\t\t</button>\n\t\t\t</section>\n\t\t</div>\n\t</div>\n\n\t<div include-pp-component x-component="headerComponent" x-definition="headerComponentDefinition" x-data="data" x-args="args"></div>\n\n\t<div class="property-content" ng-if="(!isLinked && !isPatched && isReady) || ignorePatches" include-pp-component x-component="rootComponent" x-args="args" x-definition="definition" x-data="data"></div>\n\n  \t<qv-property-sub-panel ng-repeat="subPanel in subPanels"></qv-property-sub-panel>\n</div>\n'},1675:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(1676),n(101),n(90),n(204),n(156),n(165)],o=function(e,t,n,i,o,r,a){e.directive("qvPropertySubPanel",function(){return{template:t,restrict:"E",replace:true,controller:["$scope","$timeout",function(e,t){var s="100%";var l={show:true,hide:true};var u="items.data";var c=e.subPanel;var d=c.options;var p=d.layoutPath;var f=d.propertiesPath;var h=null;var g=d.dataPath||u;d.transitions=i.extend({},l,d.transitions);e.classes={transitions:d.transitions.show};e.style={width:d.width||s,right:"-"+(d.width||s),top:0,zIndex:21};e.getTitle=function(){return"function"===typeof d.title?d.title(c.data,c.args.handler):d.title};e.subTitle=d.subTitle;d.footer&&(e.footerButtons=d.footer.items.filter(function(e){return"button"===e.type}));v();function m(){var t=i.extend({},e.args);var o=t.properties;var r=t.layout;p&&(r=n.getValue(t.layout,p));t.layout=r;var a=o;f&&(a=n.getValue(o,f));if(!a){e.stepOut();return}t.properties=a;if(h){t.handler=h;t.handler.setProperties(a);t.handler.setLayout(r)}c.args=t;c.data=a}function v(){var i=d.definition;var s=r.mapDefinition(i);var l=n.getValue(s,g);h=l?new o({app:e.args.app,dimensionDefinition:l.dimension||{},measureDefinition:l.measure||{}}):null;c.component=a.findComponent(i);c.definition=s;d.activePath&&d.definition.cacheKey&&e.args.cache.put("accordion_path_"+d.definition.cacheKey,d.activePath);m();t(function(){e.style.right=0;e.style.opacity=1})}function b(t){var n=e.subPanels.map(function(e){return e.options.id});var i=n.indexOf(t);if(-1===i)return;e.subPanels.splice(i,1);"function"===typeof d.stepOutCallback&&d.stepOutCallback(t)}function x(n){if(n||!d.transitions.hide){e.subPanel=null;b(d.id);return}e.classes.transitions=d.transitions.hide;e.style.right="-"+(d.width||s);e.style.opacity=0;t(b.bind(null,d.id),300)}e.stepOut=x;c.directiveHook.close=x;e.$watch("data",function(){m()})}]}})}.apply(t,i),void 0!==o&&(e.exports=o))},1676:function(e,t){e.exports='<div class="qv-property-sub-panel" ng-class="classes" ng-style="style">\n\t<div class="property-sub-header" ng-click="stepOut()">\n\t\t<div class="header-wrapper">\n\t\t\t<div class="back-navigation">\n\t\t\t\t<span class="lui-icon back-icon  lui-icon--previous  lui-icon--small"></span>\n\t\t\t</div>\n\t\t\t<div class="text-wrapper">\n\t\t\t\t<div class="navigation-title">\n\t\t\t\t\t{{getTitle()}}\n\t\t\t\t</div>\n\t\t\t\t<div class="navigation-sub-title">\n\t\t\t\t\t{{subTitle}}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class="property-sub-content" include-pp-component\n\t\t x-component="subPanel.component"\n\t\t x-definition="subPanel.definition"\n\t\t x-data="subPanel.data"\n\t\t x-args="subPanel.args">\n\t</div>\n\n\t<div ng-if="footerButtons" class="property-sub-footer">\n\t\t<button ng-repeat="btn in footerButtons" class="lui-button lui-button--block" qva-activate="btn.action($event)">\n\t\t\t<span class="lui-button__text" q-translation="{{btn.translation}}"></span>\n\t\t\t<span ng-if="btn.icon" class="lui-button__icon lui-icon lui-icon--{{btn.icon}}" q-title-translation="{{btn.translation}}"></span>\n\t\t</button>\n\t</div>\n</div>'},1688:function(e,t,n){"use strict";var i,o;!(i=[n(165),n(121),n(2719)],o=function(e,t,n){var i={template:n,controller:["$scope",function(n){var i=n.definition.items||{};function o(){n.items=Object.keys(i).filter(function(e){var t=i[e];if("function"===typeof t.show)return t.show(n.data,n.args.handler,n.args);if("boolean"===typeof t.show)return t.show;return true}).map(function(t){var n=i[t];return{component:e.findComponent(n),definition:n,key:t}})}n.$on("datachanged",function(){o()});n.$watch("data",function(){o()});t.defineVisible(n,n.args.handler)}]};return i}.apply(t,i),void 0!==o&&(e.exports=o))},1810:function(e,t,n){"use strict";var i,o;!(i=[n(89),n(130),n(399),n(178),n(1327)],o=function(e,t,n,i,o){return{convert:r};function r(r,s){if(!r||!s||!s.app)throw new Error("Missing required parameter(s)");var l=r.data&&r.data.qDef,u=l&&l.qFieldDefs&&l.qFieldDefs.length;if(!u)throw new Error("Unsupported operation: Can not convert a non-field to measure");var c=l.qFieldDefs[0],d=l.qFieldLabels&&l.qFieldLabels[0],p=s.app,f={aggregation:n.getAggregationForExpression(c,p,t.findField),isField:a(p,c)};return e.all(f).then(function(e){var t="countdistinct"===e.aggregation.toLowerCase(),n=t?"count":e.aggregation,r=i.getNormalizedExpression(c);e.isField&&(r="["+r+"]");t&&(r="distinct "+r);var a=o.addAggregation(n,r),u=s.createExpressionMeasure(a,d);l.qLabelExpression&&l.qLabelExpression.length&&(u.qDef.qLabelExpression=l.qLabelExpression);return u})}function a(e,n){return e.getFieldList().then(function(e){var o=i.getNormalizedExpression(n),r=t.findField(o,e);return!!r})}}.apply(t,i),void 0!==o&&(e.exports=o))},1811:function(e,t,n){"use strict";var i,o;!(i=[],o=function(){return{convert:e};function e(e,t){if(!e||!t)throw new Error("Missing required parameter(s)");var n=e.data&&e.data.qDef&&e.data.qDef.qDef;if(!n)throw new Error("Unsupported operation: Can not convert a non-measure to dimension");var i=e.data.qDef;var o=t.createFieldDimension("="+e.extractedField,i.qLabel);i.qLabelExpression&&i.qLabelExpression.length&&(o.qDef.qLabelExpression=i.qLabelExpression);return o}}.apply(t,i),void 0!==o&&(e.exports=o))},1812:function(e,t,n){"use strict";var i,o;!(i=[n(54),n(89),n(369),n(2703)],o=function(e,t,n,i){var o={extract:r};return o;function r(o){if(!e.isString(o))throw new Error("Field-extractor: Expression must be a string");var r={field:"",isValid:false};var a=n.classify(o);if(1!==a.count)return t.when(r);var s=a.result.remainder;r.field=s.isQualifier?s.qualified.content:s.content;r.isValid=i.isValid(s);return t.when(r)}}.apply(t,i),void 0!==o&&(e.exports=o))},1813:function(e,t){e.exports='<div class="pp-component pp-sorting-component" style="position:relative; height: 100%;" tcl="sorting" qv-sortable-list="sortableItemLists">\n\t<div ng-if="sortableItemLists.lists[0].isEmpty()" class="pp-data-empty-hint">\n\t\t<span q-translation="Common.NoData"></span>\n\t</div>\n\t<ul class="pp-expandable-list pp-data-list">\n\t\t<li ng-repeat="item in sortableItemLists.lists[0].items track by item.id" ng-include src="item.templateSrc" ng-class="item.classList"></li>\n\t</ul>\n</div>'},1814:function(e,t,n){"use strict";var i,o;!(i=[n(90),n(134),n(89),n(48),n(91)],o=function(e,t,n,i,o){function r(t,n){t.qDef=e.extend(true,{},t.qDef,n.qDim);for(var i=0;i<t.qDef.qFieldDefs.length;++i)t.qDef.qFieldDefs[i]===t.qDef.qFieldLabels[i]&&(t.qDef.qFieldLabels[i]="");t.qDef.baseColor&&delete t.qDef.baseColor;delete t.qDef.coloring;delete t.qDef.title;t.qLibraryId=""}function a(e){return t.get(e.qLibraryId).then(function(t){return t.getProperties().then(function(t){var a=new n;if("N"===t.qDim.qGrouping){i.getService("qvConfirmDialog").show({message:o.get("Dimension.Linked.BreakLinkDialog.Text"),icon:"link"}).closed.then(function(n){if(n){r(e,t);a.resolve()}else a.reject()});return a.promise}i.getService("qvAlertDialog").show({message:o.get("Dimension.Linked.BreakLink.Drilldown.Text")}).closed.then(function(){a.reject()});return a.promise})})}return{breakLink:r,showBreakLinkDialog:a}}.apply(t,i),void 0!==o&&(e.exports=o))},1815:function(e,t,n){"use strict";var i,o;!(i=[n(90),n(147),n(48),n(89),n(91)],o=function(e,t,n,i,o){function r(t,n){if(t.qDef){t.qDef=e.extend(true,{},t.qDef,n.qMeasure);t.qDef.baseColor&&delete t.qDef.baseColor;t.qDef.coloring&&delete t.qDef.coloring}else t.qExpr=n.qMeasure.qDef;t.qLibraryId=""}function a(e){return t.get(e.qLibraryId).then(function(t){return t.getProperties().then(function(t){r(e,t)})})}function s(e){var t=new i;n.getService("qvConfirmDialog").show({message:o.get("Measure.Linked.BreakLinkDialog.Text"),icon:"link"}).closed.then(function(n){n?a(e).then(function(){t.resolve()},function(){t.reject()}):t.reject()});return t.promise}return{breakLink:r,showBreakLinkDialog:s}}.apply(t,i),void 0!==o&&(e.exports=o))},2678:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(2679)],o=function(e,t){var n={template:t,controller:["$scope",function(t){var n=function e(){return t.data};e.defineLabel(t,t.definition,n,t.args.handler);e.defineCustom(t,t.args.handler,"action");Object.defineProperty(t,"disabled",{get:t.definition.disabled})}]};return n}.apply(t,i),void 0!==o&&(e.exports=o))},2679:function(e,t){e.exports='<div class="pp-component pp-button-component" tcl="button">\n\t<button class="lui-button" qva-activate="action();" ng-disabled="disabled">{{label}}</button>\n</div>\n'},2680:function(e,t,n){"use strict";var i,o;!(i=[n(165),n(121),n(2681)],o=function(e,t,n){var i={template:n,controller:["$scope",function(n){var i=n.definition.items||{};var o=function e(){return n.data};n.items=Object.keys(i).filter(function(e){var t=i[e];if("boolean"===typeof t.show)return t.show;return true}).map(function(r){var a=i[r];var s={component:e.findComponent(a),definition:a,key:r,path:r};t.defineLabel(s,a,o,n.args.handler);return s})}]};return i}.apply(t,i),void 0!==o&&(e.exports=o))},2681:function(e,t){e.exports='<div pp-accordion="items" x-args="args" x-definition="definition" tabindex=\'-1\' class="pp-accordion-container" tcl="accordion">\n\t<div class="pp-section" ng-repeat="item in items" pp-accordion-item tid="{{item.key}}">\n\t\t<h4 class="pp-section-header" ng-class="{ \'last\': $last }">{{item.label}}</h4>\n\t\t<div class="pp-section-content" include-pp-component x-component="item.component" x-definition="item.definition"\n\t\t\t x-data="data" x-args="args" x-path="{{item.path}}">\n\t\t</div>\n\t</div>\n</div>'},2682:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(2683)],o=function(e,t){var n={template:t,controller:["$scope",function(t){var n=function e(){return t.data};t.definition.inverted&&(t.definition.convertFunctions={get:function e(t){return!t("boolean")},set:function e(t,n){n("boolean",!t)}});e.defineLabel(t,t.definition,n,t.args.handler);e.defineVisible(t,t.args.handler);e.defineReadOnly(t,t.args.handler);e.defineChange(t,t.args.handler);e.defineValue(t,t.definition,n)}]};return n}.apply(t,i),void 0!==o&&(e.exports=o))},2683:function(e,t){e.exports='<div class="pp-component pp-checkbox-component" ng-if="visible" tcl="checkbox">\n\t<div class="value">\n\t\t<label class="lui-checkbox">\n\t\t\t<input class="lui-checkbox__input" type="checkbox" ng-model="value" tid="value" ng-change="change()" ng-disabled="readOnly" />\n\t\t\t<div class="lui-checkbox__check-wrap">\n\t\t\t\t<span class="lui-checkbox__check"></span>\n\t\t\t\t<span class="lui-checkbox__check-text label" ng-disabled="readOnly" ng-if="label" title="{{label}}">{{label}}</span>\n\t\t\t</div>\n\t\t</label>\n\t</div>\n</div>\n'},2684:function(e,t,n){"use strict";var i,o;!(i=[n(11),n(96),n(165),n(101),n(321),n(97),n(2685),n(1147),n(487)],o=function(e,t,n,i,o,r,a,s,l){var u={template:a,controller:["$scope","$element","$timeout","luiPopover",function(a,u,c,d){var p=a.args.cache,f="dimensions_",h=s.create(),g=l.create();a.listItemComponent=n.getComponent("items");a.listItemDefinition={items:a.definition.items||{},grouped:a.definition.grouped};function m(){var e=a.definition;h.resetTitles();g.resetTitles();var t=i.getValue(a.data,a.definition.ref,[]);var o=t.map(function(t,i){var o=t.qDef.cId;return{title:function e(){var n=a.args.handler.getDimensionLayout(o);return h.getDimensionTitle(n,t,true)},component:n.getComponent("items"),definition:e,data:t,id:o,index:i,expanded:p.get(f+o)||false,disabled:false}});var r=i.getValue(a.data,a.definition.disabledRef,[]);var s=r.map(function(i,o){var r=i.qDef.cId,s;g.getDimensionTitle(i,a.args.app,true).then(function(e){s=e});return{title:function e(){return s},component:n.getComponent("items"),definition:e,data:i,id:r,index:t.length+o,expanded:p.get(f+r)||false,disabled:true}});a.items=o.concat(s)}a.$watchCollection("data."+a.definition.ref,function(){m()});a.$watchCollection("data."+a.definition.disabledRef,function(){m()});a.isInvalid=function(e){var t=a.args.handler.getDimensionLayouts()[e];return t&&!!t.qError};a.itemClicked=function(t,n){if(e(t.target).hasClass("pp-delete-property")){n.index=n.disabled?n.index-a.args.handler.hcProperties.qDimensions.length:n.index;a.args.handler.removeDimension(n.index,n.disabled).then(function(){a.$emit("saveProperties")})}else{var i=p.get(f+n.data.qDef.cId)||false;if(!n.disabled){n.expanded=!i;p.put(f+n.data.qDef.cId,!i)}}};a.addDisabled=function(){return a.args.handler.getDimensions().length>=a.args.handler.maxDimensions()};var v=null;a.addClicked=function(t){var n;if(a.adding){b();return}if(!a.addDisabled()&&!a.adding){v=d.show({template:o.template,controller:o.controller,alignTo:t.currentTarget,input:{app:a.args.app,closeAddPopover:b,addFieldDimension:y,addLibraryDimension:C},dock:"bottom",closeOnEscape:true});a.adding=true}v.closing.then(function(t){t&&!e(t.target).hasClass("pp-toplist-add-button")&&(a.adding=false);n=t});v.closed.then(function(){n||(a.adding=false);v=null})};function b(n){if(v){v.close();v=null}n&&e(n.target).hasClass("pp-toplist-add-button")&&t.preventGestures();a.adding=false}function x(){c(function(){var e=u.find(".pp-toplist-content");var t=e.children().last();e[0].scrollTop=t[0].offsetTop-1},100)}function y(e){a.args.handler.addFieldDimension(e.value,"").then(function(e){p.put(f+e.qDef.cId,true);a.$emit("saveProperties");b();x()})}function C(e){a.args.handler.addLibraryDimension(e.libraryId).then(function(e){p.put(f+e.qDef.cId,true);a.$emit("saveProperties");b();x()})}a.sortableOptions={disabled:!a.definition.allowMove,onMove:function e(t,n){a.args.handler.moveDimension(t,n).then(function(){a.$emit("saveProperties")})}};r.on("start",b);a.$on("$destroy",function(){r.off("start",b)})}]};return u}.apply(t,i),void 0!==o&&(e.exports=o))},2685:function(e,t){e.exports='<div class="pp-component pp-list-component pp-toplist" tcl="dimensions">\n\t<button class="lui-button  lui-button--block  pp-toplist-add-button" ng-class="{\'lui-active\': adding }" qva-activate="addClicked($event)" qv-enter="addClicked($event)"\n\t\t\tng-disabled="addDisabled() || !definition.allowAdd" q-translation="{{definition.addTranslation}}" tid="add-dimension"></button>\n\n\t<ul class="pp-expandable-list pp-toplist-content pp-dimension-list" pp-sortable="sortableOptions">\n\t\t<li ng-repeat="item in items track by item.id" ng-class="{ \'locked\': item.locked || !definition.allowMove }">\n\t\t\t<div class="pp-expandable-list-header pp-dimension" qva-activate="itemClicked( $event, item )" qva-longtapdrag="enableTouchDrag()"\n\t\t\t\t ng-class="{ \'expanded\': item.expanded, \'disabled\': item.disabled, \'invalid\': isInvalid( $index ) }" pp-sortable-handle>\n\t\t\t\t<span class="toggle-expand  lui-icon  {{ item.expanded ? \'lui-icon--triangle-bottom\' : \'lui-icon--triangle-right\' }}"></span>\n\t\t\t\t<span class="text" title="{{item.title()}}">{{item.title()}}</span>\n\t\t\t\t<span class="icon icon-trash pp-delete-property" ng-if="definition.allowRemove" q-title-translation="Common.Delete"></span>\n\t\t\t</div>\n\t\t\t<div class="pp-expandable-list-content" ng-if="item.expanded && !item.disabled">\n\t\t\t\t<div include-pp-component x-component="listItemComponent" x-definition="listItemDefinition" x-data="item.data" x-args="args"></div>\n\t\t\t</div>\n\t\t</li>\n\t</ul>\n</div>\n'},2686:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(91),n(1334)],o=function(e,t,n){var i={template:n,controller:["$scope",function(n){var i=function e(){return n.data};e.defineLabel(n,n.definition,i,n.args.handler);e.defineVisible(n,n.args.handler);e.defineChange(n,n.args.handler);e.defineReadOnly(n,n.args.handler);e.defineValue(n,n.definition,i);n.options=[];function o(){var e=n.value;var i=n.options.some(function(t){return t.value===e});i||n.options.splice(0,0,{value:e,label:t.get("properties.selectValue")})}function r(i){n.loading=true;n.errorMessage="";e.fillOptions(n.definition,i||n.data,n.args.handler,n.options,n.args).then(function(){o();n.errorMessage="";n.loading=false},function(){o();n.errorMessage=t.get("Properties.PromiseFailed");n.loading=false})}o();r();n.$on("datachanged",function(e,t){r(t)})}]};return i}.apply(t,i),void 0!==o&&(e.exports=o))},2687:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(91),n(1334)],o=function(e,t,n){var i={template:n,controller:["$scope",function(n){var i=function e(){return n.data};e.defineLabel(n,n.definition,i,n.args.handler);e.defineVisible(n,n.args.handler);e.defineChange(n,n.args.handler);e.defineReadOnly(n,n.args.handler);n.options=[];Object.defineProperty(n,"value",{get:function e(){return n.data.qDef.isCustomFormatted?"OFF":n.data.qDef.qNumFormat?n.data.qDef.qNumFormat.qType:"U"},set:function e(t){if("OFF"===t){n.data.qDef.isCustomFormatted=true;n.data.qDef.qNumFormat.qType="U"}else{n.data.qDef.qNumFormat.qType=t;n.data.qDef.isCustomFormatted=false}}});function o(){var e=n.value;var i=n.options.some(function(t){return t.value===e});i||n.options.splice(0,0,{value:e,label:t.get("properties.selectValue")})}function r(i){n.loading=true;n.errorMessage="";e.fillOptions(n.definition,i||n.data,n.args.handler,n.options,n.args).then(function(){o();n.errorMessage="";n.loading=false},function(){o();n.errorMessage=t.get("Properties.PromiseFailed");n.loading=false})}o();r();n.$on("datachanged",function(e,t){r(t)})}]};return i}.apply(t,i),void 0!==o&&(e.exports=o))},2688:function(e,t,n){"use strict";var i,o;function r(e){r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return r(e)}!(i=[n(121),n(101),n(107),n(2689)],o=function(e,t,n,i){var o={template:i,controller:["$scope",function(i){var o=function e(){return i.data};i.definition.maxlength?i.maxlength=i.definition.maxlength:i.maxlength=n.expression;e.defineLabel(i,i.definition,o,i.args.handler);e.defineVisible(i,i.args.handler);e.defineReadOnly(i,i.args.handler);e.defineChange(i,i.args.handler);e.defineValue(i,i.definition,o);e.definePlaceholder(i,i.definition);Object.defineProperty(i,"displayValue",{get:function e(){var t=i.definition.expressionType;var n=i.value;switch(t){case"StringExpr":case"ValueExpr":n&&"object"===r(n)&&(n=n.qv);break;case"StringExpression":n&&"object"===r(n)&&(n=n.qStringExpression.qExpr);break;case"ValueExpression":n&&"object"===r(n)&&(n=n.qValueExpression.qExpr);break}return n},set:function e(t){var n=i.definition.expressionType;var o;switch(n){case"StringExpr":case"ValueExpr":o={qv:t};break;case"StringExpression":o={qStringExpression:{qExpr:t}};break;case"ValueExpression":o={qValueExpression:{qExpr:t}};break;default:o=t}i.value=o}});i.isExpression=function(){var e=i.definition.expressionType;var n=t.getValue(i.data,i.definition.ref);if("StringExpr"===e)return n.qv&&"="===n.qv[0];if("dimension"===e)return 0===n.indexOf("=");return true};i.isLocked=function(){var e=i.value;var t=i.definition.expressionType;switch(t){case"StringExpr":case"ValueExpr":e&&"object"===r(e)&&(e=e.qv);break;case"StringExpression":e&&"object"===r(e)&&(e=e.qStringExpression.qExpr);break;case"ValueExpression":e&&"object"===r(e)&&(e=e.qValueExpression.qExpr);break}return e&&(-1!==e.indexOf("\n")||e.length>i.maxlength)}}]};return o}.apply(t,i),void 0!==o&&(e.exports=o))},2689:function(e,t){e.exports='<div class="pp-component pp-string-component" ng-if="visible" tcl="string">\n\t<div class="label" ng-if="label" title="{{label}}">{{label}}</div>\n\n\t<div class="value">\n\t\t<div class="lui-input-group">\n\t\t\t<input class="lui-input  lui-input-group__item  lui-input-group__input" type="text" maxlength="{{maxlength}}" spellcheck="{{!isExpression()}}"\n\t\t\t\tng-class="{\'lui-invalid\': invalid, \'is-expression\': isLocked() }"\n\t\t\t\tpp-placeholder="placeholder"\n\t\t\t\tng-model="displayValue" ng-model-options="{ updateOn: \'blur\', allowInvalid: true }" qva-model-onkeyup\n\t\t\t\tpp-input-validator ng-readonly="isLocked()" ng-disabled="readOnly" ng-change="change()"\n\t\t\t\tpp-expression-editor="value" editor-disabled="!isLocked()" expression-type="{{definition.expressionType}}" tid="{{key}}" />\n\n\t\t\t<button class="lui-button  lui-input-group__item  lui-input-group__button" ng-show="!readOnly"\n\t\t\t\t\tpp-expression-editor="value" expression-type="{{definition.expressionType}}"\n\t\t\t\t\tq-title-translation="Tooltip.OpenExpressionEditor">\n\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--expression  edit-expression" ng-class="{\'active\': isExpression()}"></span>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\n\t<div ng-if="isLocked()" class="hint" q-translation="properties.editInExpressionEditor"></div>\n</div>\n'},2690:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(91),n(2691)],o=function(e,t,n){var i={template:n,controller:["$scope",function(n){var i=function e(){return n.data};n.options=[];n.select=function(e){n.value=e;"function"===typeof n.definition.change&&n.definition.change(n.data,n.args.handler);n.$emit("saveProperties")};e.defineLabel(n,n.definition,i,n.args.handler);e.defineVisible(n,n.args.handler);e.defineReadOnly(n,n.args.handler);e.defineValue(n,n.definition,i);function o(i){n.loading=true;n.errorMessage="";e.fillOptions(n.definition,i||n.data,n.args.handler,n.options,n.args).then(function(){n.errorMessage="";n.loading=false},function(){n.errorMessage=t.get("Properties.PromiseFailed");n.loading=false})}o();n.$on("datachanged",function(e,t){o(t)})}]};return i}.apply(t,i),void 0!==o&&(e.exports=o))},2691:function(e,t){e.exports='<div class="pp-component pp-buttongroup-component" ng-if="visible" tcl="buttongroup">\n\t<div class="label" ng-if="label" title="{{label}}" ng-class="{ \'disabled\': readOnly }">\n\t\t{{label}}\n\t</div>\n\n\t<div class="value">\n\t\t<div class="lui-buttongroup" ng-if="!loading">\n\t\t\t<button ng-repeat="option in options track by option.value" class="lui-button" ng-disabled="readOnly"\n\t\t\t\tng-class="{ \'lui-active\': option.value == value, \'small-icon\' : definition.smallIconFont }"\n\t\t\t\tqva-activate="select(option.value)" tid="{{option.value}}"\n\t\t\t\tq-title-translation="{{option.tooltip || option.label}}">\n\t\t\t\t<span class="lui-button__text">{{option.label}}</span>\n\t\t\t</button>\n\t\t</div>\n\n\t\t<div class="pp-loading-container" ng-if="loading">\n\t\t\t<div class="pp-loader qv-loader"></div>\n\t\t</div>\n\t\t<div ng-if="errorMessage" class="pp-invalid error">{{errorMessage}}</div>\n\t</div>\n</div>\n'},2692:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(91),n(2693)],o=function(e,t,n){var i={template:n,controller:["$scope",function(n){var i=function e(){return n.data};e.defineLabel(n,n.definition,i,n.args.handler);e.defineVisible(n,n.args.handler);e.defineChange(n,n.args.handler);e.defineReadOnly(n,n.args.handler);e.defineValue(n,n.definition,i);n.options=[];function o(i){n.loading=true;n.errorMessage="";e.fillOptions(n.definition,i||n.data,n.args.handler,n.options,n.args).then(function(){n.errorMessage="";n.loading=false},function(){n.errorMessage=t.get("Properties.PromiseFailed");n.loading=false})}o();n.$on("datachanged",function(e,t){o(t)})}]};return i}.apply(t,i),void 0!==o&&(e.exports=o))},2693:function(e,t){e.exports='<div class="pp-component pp-radiobuttons-component" ng-if="visible" tcl="radiobuttons">\n\t<div class="label" ng-if="label" title="{{label}}" ng-class="{ \'disabled\': readOnly }">\n\t\t{{label}}\n\t</div>\n\n\t<div class="value">\n\t\t<div ng-if="!loading">\n\t\t\t<label ng-repeat="option in options" class="lui-radiobutton" title="{{option.tooltip}}" qva-activate="click()">\n\t\t\t\t<input class="lui-radiobutton__input" type="radio" ng-value="option.value" ng-model="value" ng-change="change()" ng-disabled="readOnly">\n\t\t\t\t<div class="lui-radiobutton__radio-wrap">\n\t\t\t\t\t<span class="lui-radiobutton__radio"></span>\n\t\t\t\t\t<span class="lui-radiobutton__radio-text" title="{{option.label}}">{{option.label}}</span>\n\t\t\t\t</div>\n\t\t\t</label>\n\t\t</div>\n\n\t\t<div class="pp-loading-container" ng-if="loading">\n\t\t\t<div class="pp-loader qv-loader"></div>\n\t\t</div>\n\t\t<div ng-if="errorMessage" class="pp-invalid error">{{errorMessage}}</div>\n\t</div>\n</div>\n'},2694:function(e,t,n){"use strict";var i,o;!(i=[n(165),n(121),n(2695)],o=function(e,t,n){var i;i={template:n,controller:["$scope",function(n){var i=n.definition.items||{},o=function e(){return n.data},r=n.args.cache,a="expanded_"+(n.translation||n.label)+"_";n.isAutoChart="auto-chart"===n.data.visualization;n.expandClicked=function(e){e.expanded=!e.expanded;r.put(a+e.key,e.expanded)};function s(){n.items=Object.keys(i).filter(function(e){var t=i[e];if("function"===typeof t.show)return t.show(n.data,n.args.handler,n.args);if("boolean"===typeof t.show)return t.show;return true}).map(function(s){var l,u=i[s],c=r.get(a+s);l={component:e.findComponent(u),definition:u,data:n.data,expanded:c||false,key:s};t.defineLabel(l,u,o,n.args.handler);return l})}n.$on("datachanged",function(){s()});n.$watch("data",function(){s()});t.defineVisible(n,n.args.handler)}]};return i}.apply(t,i),void 0!==o&&(e.exports=o))},2695:function(e,t){e.exports='<div class="pp-component pp-expandable-items-component" tcl="expandable-items">\n\t<ul class="pp-expandable-list">\n\t\t<li ng-repeat="item in items track by item.key" tid="{{item.key}}">\n\t\t\t<div ng-if="::!isAutoChart" class="pp-expandable-list-header" ng-click="expandClicked(item)" ng-class="{ \'expanded\': item.expanded }">\n\t\t\t\t<i class="toggle-expand  lui-icon  {{ item.expanded ? \'lui-icon--triangle-bottom\' : \'lui-icon--triangle-right\' }}"></i>\n\t\t\t\t<span class="text" title="{{item.label}}">{{item.label}}</span>\n\t\t\t</div>\n\t\t\t<div ng-if="::isAutoChart" class="pp-expandable-list-header-auto-chart" ng-click="expandClicked(item)" ng-class="{ \'expanded\': item.expanded }">\n\t\t\t\t<span class="text" title="{{item.label}}">{{item.label}}</span>\n\t\t\t\t<span class="toggle-expand lui-icon lui-icon--small lui-icon--arrow-right" ng-class="{ \'expanded\': item.expanded }"></span>\n\t\t\t</div>\n\t\t\t<div class="pp-expandable-list-content" ng-if="item.expanded" ng-class="{ \'grouped\': definition.grouped }">\n\t\t\t\t<div include-pp-component x-component="item.component" x-definition="item.definition" x-data="item.data" x-args="args"></div>\n\t\t\t</div>\n\t\t</li>\n\t</ul>\n</div>'},2696:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(2697)],o=function(e,t){var n={template:t,controller:["$scope",function(t){var n=function e(){return t.data};e.defineLabel(t,t.definition,n,t.args.handler);e.defineVisible(t,t.args.handler);t.marginTop=t.definition.marginTop||"0px"}]};return n}.apply(t,i),void 0!==o&&(e.exports=o))},2697:function(e,t){e.exports='<div class="pp-data-header" ng-style="{\'margin-top\': marginTop}">\n    <span class="pp-data-header-text">{{label}}</span>\n</div>'},2698:function(e,t,n){"use strict";var i,o;!(i=[n(11),n(48),n(96),n(165),n(91),n(321),n(402),n(2699),n(101),n(99),n(207),n(2702),n(272),n(1147),n(983),n(1810),n(1811),n(1812),n(2704),n(1268),n(186),n(382),n(95),n(1269),n(399),n(2706),n(2708),n(111),n(2709)],o=function(e,t,n,i,o,r,a,s,l,u,c,d,p,f,h,g,m,v,b,x,y,C,q,D,w,I,S){var L={Dimensions:1,AlternativeDimensions:3,Measures:5,AlternativeMeasures:12};var E="pp-data-item.ng.html";var M={template:d,controller:["$scope","$element","$timeout","luiPopover","$document",function(d,M,_,A,P){var k=d.args.cache,T="data_",O={addFieldDimension:U,addLibraryDimension:Y,addExpressionMeasure:X,addLibraryMeasure:K},V=f.create(),H=h.create(),R=x.create(d,A),$=s.create(d,A,O);d.isAutoChart="auto-chart"===d.data.visualization;d.isAutoChart&&S.updateIndexes(d.args.properties);d.expandClicked=function(e,t){if(e.target.classList.contains("pp-nm-di__draggable"))return;t.expanded=!t.expanded;k.put(T+t.id,t.expanded)};d.removeItem=function(e){var t=e.__sortableItem__.typeFlag===L.AlternativeDimensions||e.__sortableItem__.typeFlag===L.AlternativeMeasures;"dimension"===e.type?d.args.handler.removeDimension(e.index,t).then(function(){d.$emit("saveProperties")}):d.args.handler.removeMeasure(e.index,t).then(function(){d.$emit("saveProperties")})};d.getAddLabel=function(){var e=d.args.ext&&d.args.ext.data,t=d.definition.items;if(0===t.dimensions.disabledRef.length&&0===t.measures.disabledRef.length){if(e&&!e.measures)return o.get("Visualization.Requirements.AddDimension");if(e&&!e.dimensions)return o.get("Visualization.Requirements.AddMeasure")}return o.get("properties.add")};d.hasMultipleAddOptions=function(){var e=d.args.ext&&d.args.ext.data;return e&&e.measures&&e.dimensions};var F=null,N=null,z=null;function B(e){if(F){F.destroy();F=null}e&&e.target.classList.contains("pp-toplist-add-button")&&n.preventGestures()}d.openContextMenu=function(e,n){var i=t.getService("qvContextMenu").menu();i.addItem({translation:"Common.Delete",tid:"delete",select:function e(){d.removeItem(n)}});z=t.getService("qvContextMenu").show(i,{position:{x:e.pageX,y:e.pageY},docking:"Top"})};function W(){d.sortableItemLists.ctrl&&d.sortableItemLists.ctrl.on();d.sortableItemLists.reset();V.resetTitles();H.resetTitles();d.isAutoChart&&S.updateIndexes(d.args.properties);G();j()}function G(){var e=d.definition.items.dimensions,t=l.getValue(d.data,e.ref,[]);t.forEach(function(t,n){var o=t.qDef.cId,r=d.args.handler.getDimensionLayout(o);var a={title:function e(){return V.getDimensionTitle(r,t,true)},isInvalid:function e(){var t=d.args.handler.getDimensionLayout(o);return t&&!!t.qError&&!p.isCalcCondNotCalculatedErr(t.qError)},component:i.getComponent("items"),definition:{type:"items",items:e.items},data:t,args:d.args,id:o,index:n,type:"dimension",expanded:k.get(T+o)||false,sortable:false!==e.allowMove,templateSrc:E,markerClass:"pp-dimension"};ae.addSortableItem(a,L.Dimensions)});if(d.isAutoChart&&t.length>1){var n=d.args.properties.qUndoExclude.generated.visualization,o=ae.items;o.sort(function(e,t){var i=S.getDimensionIndex(e.index,n),o=S.getDimensionIndex(t.index,n);return i<o?-1:1})}var r=l.getValue(d.data,e.disabledRef,[]);r.forEach(function(t,n){var o=t.qDef.cId,r=H.getCachedDimensionTitle(t);H.getDimensionTitle(t,d.args.app,true).then(function(e){r=e});var a={title:function e(){return r},component:i.getComponent("items"),definition:{type:"items",items:e.items},data:t,args:d.args,id:o,index:n,type:"dimension",expanded:k.get(T+o)||false,templateSrc:E,markerClass:"pp-dimension",sortable:false!==e.allowMove,isAlternative:true};se.addSortableItem(a,L.AlternativeDimensions)})}function j(){var e=d.definition.items.measures,t=l.getValue(d.data,e.ref,[]);t.forEach(function(t,n){var o=t.qDef.cId,r=d.args.handler.getMeasureLayout(o),a=V.getCachedMeasureTitle(r),s=R.isChangeable(t);V.getMeasureTitle(r,t,true,d.args.app).then(function(e){a=e});var l={title:function e(){return a},isInvalid:function e(){var t=d.args.handler.getMeasureLayout(o);return t&&!!t.qError},component:i.getComponent("items"),definition:{type:"items",items:e.items},data:t,args:d.args,id:o,index:n,type:"measure",expanded:k.get(T+o)||false,sortable:false!==e.allowMove,templateSrc:E,markerClass:"pp-measure"};t.qLibraryId||v.extract(t.qDef.qDef).then(function(e){l.isValidExtraction=e.isValid;l.extractedField=e.field});if(s){l.canChangeMeasureAggregation=true;l.currentAggregation=R.getAggregation(t.qDef.qDef);l.remainder=R.getRemainder(t.qDef.qDef)}le.addSortableItem(l,L.Measures)});if(d.isAutoChart&&t.length>1){var n=d.args.properties.qUndoExclude.generated.visualization,o=le.items;o.sort(function(e,t){var i=S.getMeasureIndex(e.index,n),o=S.getMeasureIndex(t.index,n);return i<o?-1:1})}var r=l.getValue(d.data,e.disabledRef,[]);r.forEach(function(t,n){var o=t.qDef.cId,r=H.getCachedMeasureTitle(t);H.getMeasureTitle(t,d.args.app,true).then(function(e){r=e});var a={title:function e(){return r},component:i.getComponent("items"),definition:{type:"items",items:e.items},data:t,args:d.args,id:o,index:n,type:"measure",expanded:k.get(T+o)||false,sortable:false!==e.allowMove,templateSrc:E,markerClass:"pp-measure",isAlternative:true};ue.addSortableItem(a,L.AlternativeMeasures)})}d.openAddMore=function(e){$.open(e,function(e){return e.classList.contains("lui-button")})};d.isAddingData=function(){return $.isAddingData()};function U(e){return d.args.handler.addFieldDimension(e.value,e.trimmedValue).then(function(){d.$emit("saveProperties");ie();oe("dimensions")})}function Y(e){return d.args.handler.addLibraryDimension(e.libraryId).then(function(){d.$emit("saveProperties");ie();oe("dimensions")})}function K(e){return d.args.handler.addLibraryMeasure(e.libraryId).then(function(){d.$emit("saveProperties");ie();oe("measures")})}function X(e){return d.args.handler.addExpressionMeasure(e.value,e.trimmedValue).then(function(){d.$emit("saveProperties");ie();oe("measures")})}function J(e){return d.args.handler.addAlternativeFieldDimension(e.value,e.trimmedValue).then(function(){d.$emit("saveProperties");ie();oe("alternative-dimensions")})}function Z(e){return d.args.handler.addAlternativeLibraryDimension(e.libraryId).then(function(){d.$emit("saveProperties");ie();oe("alternative-dimensions")})}function Q(e){return d.args.handler.addAlternativeLibraryMeasure(e.libraryId).then(function(){d.$emit("saveProperties");ie();oe("alternative-measures")})}function ee(e){return d.args.handler.addAlternativeExpressionMeasure(e.value,e.trimmedValue).then(function(){d.$emit("saveProperties");ie();oe("alternative-measures")})}function te(){ae.items.forEach(function(e){e.expanded=false;k.put(T+e.id,false)});le.items.forEach(function(e){e.expanded=false;k.put(T+e.id,false)});se.items.forEach(function(e){e.expanded=false;k.put(T+e.id,false)});ue.items.forEach(function(e){e.expanded=false;k.put(T+e.id,false)})}function ne(e,t,n){B();te();if(d.adding){ie();return}var i={input:{app:d.args.app,closeAddPopover:ie},alignTo:t,closeOnEscape:true,dock:"bottom"},o,s;if("dimensions"===e){o=d.args.ext.addDimensionPopoverComponent||r;i.input.addFieldDimension=U;i.input.addLibraryDimension=Y}else if("measures"===e){o=a;i.input.addLibraryMeasure=K;i.input.addExpressionMeasure=X}else if("alternative-dimensions"===e){o=d.args.ext.addDimensionPopoverComponent||r;i.input.addFieldDimension=J;i.input.addLibraryDimension=Z}else if("alternative-measures"===e){o=a;i.input.addLibraryMeasure=Q;i.input.addExpressionMeasure=ee}i.template=o.template;i.controller=o.controller;N=A.show(i);N.closing.then(function(e){s=e;e&&!(e.target.classList.contains("lui-button")||e.target.classList.contains("pp-list-add-button"))&&(d.adding=false);n.adding=false});N.closed.then(function(){N=null;s||(d.adding=false)});d.adding=true;n.adding=true}function ie(e){if(N){N.close();N=null}e&&e.target.classList.contains("pp-toplist-add-button");d.adding=false}function oe(e){_(function(){var t=M.find(".pp-nm-hcd__lists"),n=M.find("[tid='"+e+"'] .pp-nm-hcd__list-items"),i=n.children().last();i[0]&&(t[0].scrollTop=i[0].offsetTop-1)},100)}function re(e){return e.data&&e.data.qLibraryId&&e.data.qLibraryId.length>0}d.$on("pp-open-path",function(e,t){var n=t.split("."),i=n[0],o=n[1];if("data"===i&&o){var r=ae.get().some(function(e){return e.cId===o});oe(r?"dimensions":"measures")}});d.sortableItemLists=c.create({options:{direction:"vertical",listKey:"list",scrollSelector:d.isAutoChart?".property-content":".pp-nm-hcd__lists",listSelector:".pp-nm-hcd__list-items",itemKey:"item",itemSelector:".qv-pp-sortable.draggable",itemDragSelector:".qv-pp-sortable-handle",itemGhostSelector:".pp-nm-di__header",isOuterScroll:d.isAutoChart,suppressDragStyle:d.isAutoChart?["width"]:[],suppressEnd:d.isAutoChart?function(t){var n=e(P[0].elementFromPoint(t.clientX,t.clientY));if(!n.length)return false;return n.hasClass("pp-drop-zone")||!!n.parents(".pp-drop-zone").length}:function(){return false},gesture:{name:"swipe",options:{radiusThreshold:u.treatAsDesktop()?4:0,preventDefault:false}},zIndex:11},addPlaceholder:function e(){var t=this._super.apply(this,arguments);t.classList=["qv-pp-sortable"]},onBegin:function e(t){this._super.apply(this,arguments);t.isDragged=true;d.isDragging=true;q.publish("/pp-drop-zone/drag-begin",{type:"inline",item:t});te();var n=1;if("dimension"===t.type){re(t)||b.isInvalid(t)?le.setLocked(true):le.setLocked(le.listFull(n));d.isAutoChart&&ae.setLocked(true)}else if("measure"===t.type){se.setLocked(true);re(t)||!t.isValidExtraction?ae.setLocked(true):ae.setLocked(ae.listFull(n));d.isAutoChart&&le.setLocked(true)}switch(t.__sortableItem__.typeFlag){case L.AlternativeDimensions:ae.setLocked(ae.listFull());le.setLocked(true);break;case L.AlternativeMeasures:le.setLocked(le.listFull());ae.setLocked(true);break}},onEnd:function e(t){d.isDragging=false;t&&(t.isDragged=false);ae.setLocked(false);le.setLocked(false);se.setLocked(false);d.$apply()},onCancel:function e(t){this._super.apply(this,arguments);d.isDragging=false;t&&(t.isDragged=false);q.publish("/pp-drop-zone/drag-end");this.lists.forEach(function(e){e.setLocked(false)})},moveHcItem:function e(t,n,i,o,r,a,s){var u,c,p,f,h=d.data,g=function e(){d.$emit("saveProperties")};d.args.handler.setProperties(h);d.sortableItemLists.ctrl.off();if(t!==n)switch(t.typeFlag){case L.Dimensions:n.typeFlag===L.Measures?d.args.handler.removeMeasure(i.index,false).then(function(){return d.args.handler.reinsertDimension(s,false,o)}).then(g):d.args.handler.removeDimension(i.index,true).then(function(){return d.args.handler.reinsertDimension(i.data,false,o)}).then(g);break;case L.AlternativeDimensions:d.args.handler.removeDimension(i.index,false).then(function(){return d.args.handler.reinsertDimension(i.data,true,o)}).then(g);break;case L.Measures:n.typeFlag===L.Dimensions?d.args.handler.removeDimension(i.index,false).then(function(){return d.args.handler.reinsertMeasure(s,false,o)}).then(g):d.args.handler.removeMeasure(i.index,true).then(function(){return d.args.handler.reinsertMeasure(i.data,false,o)}).then(g);break;case L.AlternativeMeasures:d.args.handler.removeMeasure(i.index,false).then(function(){return d.args.handler.reinsertMeasure(i.data,true,o)}).then(g);break}else{r.apply(this,a);if(i.index===t.items.indexOf(i)){d.sortableItemLists.ctrl.on();return}u=[];c=[];p=[];f=[];ae.get().forEach(function(e){"placeholder"!==e.id&&u.push(e.data)});le.get().forEach(function(e){"placeholder"!==e.id&&c.push(e.data)});se.get().forEach(function(e){"placeholder"!==e.id&&p.push(e.data)});ue.get().forEach(function(e){"placeholder"!==e.id&&f.push(e.data)});l.setValue(h,d.definition.items.dimensions.ref,u);l.setValue(h,d.definition.items.dimensions.disabledRef,p);l.setValue(h,d.definition.items.measures.ref,c);l.setValue(h,d.definition.items.measures.disabledRef,f);n.typeFlag===L.Dimensions&&t.typeFlag===L.Dimensions&&"function"===typeof d.args.handler.dimensionDefinition.move&&d.args.handler.dimensionDefinition.move.call(d.args.handler,i.data,d.args.handler.properties,d.args.handler);n.typeFlag===L.Measures&&t.typeFlag===L.Measures&&"function"===typeof d.args.handler.measureDefinition.move&&d.args.handler.measureDefinition.move.call(d.args.handler,i.data,d.args.handler.properties,d.args.handler);g()}},onMoveToList:function e(t,n){var i=this.getList(t),o=!d.isAutoChart,r=o?n.length-1:n.length,a=1;if(void 0===i||void 0===n||n.disabled||n.listFull(a)&&n!==i){this.removePlaceholder();this.enable();return false}if(b.isMovingDimToMea(t,n)){var s=this;g.convert(t,t.args.handler).then(function(e){s.moveHcItem(n,i,t,r,s._super,arguments,e)})}else if(b.isMovingMeaToDim(t,n)){var l=m.convert(t,t.args.handler);this.moveHcItem(n,i,t,r,this._super,arguments,l)}else this.moveHcItem(n,i,t,r,this._super,arguments);return true},onMove:function e(t){if(-1===this.getIndexOfItem(t)){this.onCancel();return false}var n=this.getPlaceholder(),i=this.getList(n),o=this.getList(t);var r=1;if(void 0===i||i!==o&&i.listFull(r)){this.removePlaceholder();this.enable();return false}if(b.isMovingDimToMea(t,i)){var a=this;g.convert(t,t.args.handler).then(function(e){a.moveHcItem(i,o,t,i.items.indexOf(n),a._super,arguments,e)})}else if(b.isMovingMeaToDim(t,i)){var s=m.convert(t,t.args.handler);this.moveHcItem(i,o,t,i.items.indexOf(n),this._super,arguments,s)}else this.moveHcItem(i,o,t,i.items.indexOf(n),this._super,arguments);return true}});var ae=d.sortableItemLists.createList(L.Dimensions,{title:o.get(d.definition.items.dimensions.translation),tid:"dimensions",getAddLabel:function e(){return d.getAddLabel()},show:function e(){var t=d.args.ext&&d.args.ext.data,n=d.args.handler.dimensionDefinition,e=void 0===n.show||("function"===typeof n.show?n.show():n.show);return e&&(!t||!!t.dimensions)},listFull:function e(t){return d.args.handler.getDimensions().length>=d.args.handler.maxDimensions(t)},addClicked:function e(t){ae.addDisabled()||ne("dimensions",t.target,this)},addDisabled:function e(){return ae.listFull()||!d.definition.allowAdd},getMax:function e(){return d.args.handler.maxDimensions()},getItemDescription:function e(t){return pe("dimension",t)},descriptionCache:{}});var se=d.sortableItemLists.createList(L.AlternativeDimensions,{title:o.get(d.definition.items.dimensions.alternativeTranslation),tid:"alternative-dimensions",isAlternative:true,getAddLabel:function e(){return o.get("properties.addalternative")},show:function e(){var t=!!d.definition.items.dimensions.disabledRef,n=d.args.ext&&d.args.ext.data,i=!!n&&!!d.args.ext.data.dimensions,o=d.args.handler.dimensionDefinition,e=void 0===o.show||("function"===typeof o.show?o.show():o.show);return e&&t&&(se.items.length&&i||(!n||!!n.dimensions)&&d.args.handler.getDimensions().length>=d.args.handler.minDimensions())},listFull:function e(){return false},subSection:true,addClicked:function e(t){ne("alternative-dimensions",t.target,this)},addDisabled:function e(){return false}});var le=d.sortableItemLists.createList(L.Measures,{title:o.get("Common.Measures"),tid:"measures",getAddLabel:function e(){return d.getAddLabel()},show:function e(){var t=d.args.ext&&d.args.ext.data,n=d.args.handler.measureDefinition,e=void 0===n.show||("function"===typeof n.show?n.show():n.show);return e&&(!t||!!t.measures)},listFull:function e(t){return d.args.handler.getMeasures().length>=d.args.handler.maxMeasures(t)},addClicked:function e(t){le.addDisabled()||ne("measures",t.target,this)},addDisabled:function e(){return le.listFull()||!d.definition.allowAdd},getMax:function e(){return d.args.handler.maxMeasures()},getItemDescription:function e(t){return pe("measure",t)},descriptionCache:{}});var ue=d.sortableItemLists.createList(L.AlternativeMeasures,{title:o.get("properties.alternative.measures"),tid:"alternative-measures",isAlternative:true,getAddLabel:function e(){return o.get("properties.addalternative")},show:function e(){var t=!!d.definition.items.measures.disabledRef,n=d.args.ext&&d.args.ext.data,i=!!n&&!!d.args.ext.data.measures,o=d.args.handler.measureDefinition,e=void 0===o.show||("function"===typeof o.show?o.show():o.show);return e&&t&&(ue.items.length&&i||(!n||!!n.measures)&&d.args.handler.getMeasures().length>=d.args.handler.minMeasures())},listFull:function e(){return false},subSection:true,addClicked:function e(t){ne("alternative-measures",t.target,this)},addDisabled:function e(){return false}});var ce=d.definition.items;ce.dimensions.ref&&d.$watchCollection("data."+ce.dimensions.ref,W);ce.dimensions.disabledRef&&d.$watchCollection("data."+ce.dimensions.disabledRef,W);ce.measures.ref&&d.$watchCollection("data."+ce.measures.ref,W);ce.measures.disabledRef&&d.$watchCollection("data."+ce.measures.disabledRef,W);d.isAutoChart&&C.addDrag(M,u.treatAsDesktop()?".pp-nm-di__header.draggable":".pp-nm-di__draggable",{info:function e(t){return{type:"inline",item:t.item}},elem:"<div></div>"});d.isItemDraggable=function(e){if(!e.sortable)return false;var t="dimension"===e.type,n=e.isValidExtraction;if(d.isAutoChart){if(re(e))return false;return!!t||n}var i=le.listFull(0),o=ae.listFull(0);if(e.isAlternative){var r=d.definition.items,a=t?r.dimensions.disabledRef:r.measures.disabledRef,s=l.getValue(d.data,a,[]).length,u=s>1;if(u)return true;return t?!o:!i}var c=t?se.show():ue.show();if(c)return true;var p=d.args.handler,f=t?p.getDimensions().length:p.getMeasures().length,h=f>1;if(h)return true;var g=t?i:o;if(g)return false;return!!t||n};d.showChangeAggregation=function(e){return"measure"===e.type&&e.canChangeMeasureAggregation&&!e.isDragged};d.getItemHeaderTitle=function(e){if(d.showChangeAggregation(e))return e.remainder;return e.canChangeMeasureAggregation&&e.isDragged&&d.isAutoChart?e.remainder:e.title()};d.openChangeAggregationPopover=function(e,t){if(!d.showChangeAggregation(t))return;var n={isOpenButton:function e(t){return t.classList.contains("pp-nm-di__header-aggregation")},onAggregationChanged:function e(t,n){D.gather({expression:t.extractedField,aggregation:n})}};R.openPopover(e,t.id,t,n)};d.isChangeAggregationPopoverOpen=function(e){return R.isPopoverOpen(e.id)};d.showItemDescription=function(e){if(!d.isAutoChart&&!l.getValue(e,"args.handler."+e.type+"Definition.description"))return false;var t=d.sortableItemLists.getList(e);if(t.isAlternative||e.isDragged)return false;var n=d.getUndraggedItems(t),i=n.indexOf(e);if(0===i)return true;var o=t.getItemDescription(i),r=t.getItemDescription(i-1);var a=o===r;if(!a&&d.isAutoChart&&d.isDragging)return true;return!a};d.showNextPossibleItem=function(e){var t=d.getUndraggedItems(e),n=e.getMax()-t.length;return n>0};d.showNextPossibleItemDescription=function(e){var t=d.getUndraggedItems(e),n=t.length,i=d.getNextPossibleItemDescription(e);if(0===n)return!!i;var o=t[n-1];if(!d.isAutoChart&&!l.getValue(o,"args.handler."+o.type+"Definition.description"))return false;var r=d.getItemDescription(o);return i!==r};d.getNextPossibleItemDescription=function(e){var t=d.getUndraggedItems(e),n=e.getItemDescription(t.length);return n};d.getItemDescription=function(e){var t=d.sortableItemLists.getList(e),n=de(e);if(d.isAutoChart&&d.isDragging)return t.descriptionCache[n];var i=t.getItemDescription(n);t.descriptionCache[n]=i;return i};d.showEmptyItem=function(e){var t=d.getUndraggedItems(e);return!t.length};d.getUndraggedItems=function(e){return e.get(function(e){return!e.isDragged})};function de(e){var t=d.sortableItemLists.getList(e),n=d.getUndraggedItems(t),i=n.indexOf(e);return i}function pe(e,t){var n="dimension"===e.toLowerCase(),i=d.args.properties,o,r={isAutoChart:d.isAutoChart};if(d.isAutoChart){var a=i.qUndoExclude.generated;if(!a)return;var s=a.visualization,l=n?"getDimensionDescription":"getMeasureDescription";o=I[l](s,a,t,r)}else{var u=n?"dimensionDefinition":"measureDefinition",c=d.args.handler[u];c&&c.description&&(o=c.description(i,t,r))}return o}d.showAutoDropZone=function(e){return"libraryitem"===e.type};d.onDropAutoDropZone=function(e){var t=e.item,n="field"===t.type;if(n){var i=y.isMeasure(e.item.classifications);i?w.getAggregationForFieldItem(t).then(function(e){var n=y.getMeasureExpression(t.name,e);X({value:n})}):U({value:t.name})}else{var o="measure"===t.type?K:Y;o({libraryId:t.id})}};d.showTargetedDropZone=function(e,t){return"dimensions"===e?fe(t):he(t)};d.onDropTargetedDropZone=function(e,t){var n=t.item,i="libraryitem"===t.type;if(i){var o="field"===n.type;if(o)"dimensions"===e?U({value:n.name}):w.getAggregationForFieldItem(n).then(function(e){var t=y.getMeasureExpression(n.name,e);X({value:t})});else{var r="measure"===n.type?K:Y;r({libraryId:n.id})}}else d.sortableItemLists.onMoveToList(n,"dimensions"===e?ae:le)};function fe(e){var t=e.item,n="libraryitem"===e.type;return n?"measure"!==t.type:"measure"===t.type&&!re(t)&&t.isValidExtraction}function he(e){var t=e.item,n="libraryitem"===e.type;return n?"dimension"!==t.type:"dimension"===t.type&&!re(t)&&!t.isInvalid()}d.$on("$destroy",function(){B();ie();R.closePopover();$.close();z&&z.close()})}]};return M}.apply(t,i),void 0!==o&&(e.exports=o))},2699:function(e,t,n){"use strict";var i,o;!(i=[n(2700)],o=function(e){var t={create:n};return t;function n(t,n,i){return new e(t,n,i)}}.apply(t,i),void 0!==o&&(e.exports=o))},2700:function(e,t,n){"use strict";var i,o;function r(e){r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return r(e)}!(i=[n(90),n(89),n(139),n(125),n(99),n(130),n(2701),n(148),n(161),n(186),n(369),n(399),n(218)],o=function(e,t,n,i,o,a,s,l,u,c,d,p){var f=false,h=null;function g(e,t,n){m(e,t,n,this)}g.prototype.open=b;g.prototype.close=x;g.prototype.isAddingData=v;return g;function m(n,f,g,m){n||C("Scope is required");f||C("luiPopover is required");g&&"object"===r(g)||C("A data container object is required");m.scope=n;m.luiPopover=f;m.popover=null;m.boundClose=x.bind(m);var v=100,b={term:""};function q(e){if(""!==b.term){e.stopPropagation();b.term=""}m.boundClose()}function D(e){if(""!==b.term){e.stopPropagation();var t=d.classify(b.term);I(t)?g.addExpressionMeasure({value:b.term}):g.addFieldDimension({value:b.term})}m.boundClose()}n.position||(n.position="right");function w(e){return""===b.term?e.label:u.trimAutoCalendarName(e.value)}h=null;S(b.term);n.$watch(function(){return b.term},function(e,t){if(e===t)return;S(e)});m.settings={template:s,input:{isDirectDiscoveryField:l.isDirectDiscoveryField,getDirectDiscoveryTypeTranslationKey:l.getTypeTranslationKey,search:b,onEscape:q,onEnter:D,close:x,data:{fields:[],dimensions:[],measures:[]},getFieldDisplayName:w,autoFocus:o.treatAsDesktop(),addFieldDimension:function t(n){if(c.isMeasure(n.classifications)){var i=e.extend(true,{},n);p.getAggregationForFieldItem(n).then(function(e){i.value=c.getMeasureExpression(n.value,e);g.addExpressionMeasure(i).then(function(){m.boundClose()})})}else g.addFieldDimension(n).then(function(){m.boundClose()})},addLibraryDimension:function e(t){g.addLibraryDimension(t).then(function(){m.boundClose()})},addLibraryMeasure:function e(t){g.addLibraryMeasure(t).then(function(){m.boundClose()})},addViaExpressionEditor:function e(t){var n=d.classify(t.value);I(n)?g.addExpressionMeasure(t).then(function(){m.boundClose()}):g.addFieldDimension(t).then(function(){m.boundClose()})}},dock:"bottom",closeOnResize:true,closeOnOutside:true,closeOnEscape:true};function I(e){return e.result&&e.result.function&&e.result.function.content&&e.result.function.content.length>0}m.createListItems=S;function S(e){function o(){var t=y(h.fields,e);var n=y(h.dimensions,e);var o=y(h.measures,e);if(n.length+o.length>v){var r=Math.max(v-o.length,0);var a=Math.max(v-n.length,0);n=i.limit(n,r);o=i.limit(n,a);t=[]}else if(t.length+n.length+o.length>v){var s=Math.max(v-n.length-o.length,0);t=i.limit(t,s)}m.settings.input.data.fields=t;m.settings.input.data.dimensions=n;m.settings.input.data.measures=o}h?o():t.all({fields:a.getSortedFields(n.args.app),dimensions:a.getSortedDimensions(n.args.app),measures:a.getSortedMeasures(n.args.app)}).then(function(t){var n=t.fields.map(function(t){var n=t.isDerived&&""===e?t.qName.substring(t.qName.lastIndexOf(".")+1,t.qName.length):t.qName;return{toolTip:t.qName,label:n,value:t.qName,trimmedValue:t.displayName,qTags:t.qTags,isDerived:t.isDerived,isDateField:t.isDateField,isGeoField:t.isGeoField,classifications:t.classifications,defaultAggregation:t.defaultAggregation}});var i=t.dimensions.map(function(e){return{label:e.qData.title,value:e.qData.title,libraryId:e.qInfo.qId,isDrillDown:"H"===e.qData.grouping}});var r=t.measures.map(function(e){return{value:e.qData.title,label:e.qData.title,libraryId:e.qInfo.qId}});h={fields:n,dimensions:i,measures:r};o()})}}function v(){return f}function b(e,t){if(this.popover){this.popover=null;return}this.settings.input.search.term="";this.settings.alignTo=e.target;var n=this;h=null;this.createListItems("");this.popover=this.luiPopover.show(this.settings);this.popover.closing.then(function(e){e&&!t(e.target)&&(n.popover=null);f=false});f=true}function x(){if(this.popover){this.popover.close();this.popover=null;f=false}}function y(e,t){if(""===t)return e;return e.filter(function(e){if("undefined"===typeof e.value)return false;return n.string(e.value.toLowerCase()).indexOf(n.string(t.toLowerCase()))>-1})}function C(e){throw new Error("ChangeAggregationPopover: "+e)}}.apply(t,i),void 0!==o&&(e.exports=o))},2701:function(e,t){e.exports='<lui-popover style="min-width: 200px;width: 230px;" align-to="alignTo" position="position" collision="\'flipfit\'" on-close-view="closeAddPopover(event)" qva-outside-ignore-for="{{qvaOutsideIgnoreFor}}">\n\t<object-add-typeahead>\n\t\t<lui-popover-header>\n\t\t\t<div class="lui-input-group">\n\t\t\t\t<input class="lui-input  lui-input-group__item  lui-input-group__input" type="text" name="new-dimension" autocomplete="off" ng-model="search.term" tid="add-dimension-input" qva-focus="autoFocus"\n\t\t\t\t\t   object-add-typeahead-input on-escape="onEscape($event)" on-enter="onEnter($event)" maxlength="255"/>\n\t\t\t\t<button ng-if="allowExpressionEditor !== false" class="lui-button  lui-input-group__item  lui-input-group__button" qva-activate="close()"\n\t\t\t\t\t\tpp-expression-editor="search.term" pp-expression-editor-on-apply="addViaExpressionEditor({value:value})" expression-type="dimension"\n\t\t\t\t\t\tq-title-translation="Tooltip.OpenExpressionEditor" tid="fx-button">\n\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--expression  edit-expression"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</lui-popover-header>\n\t\t<div class="object-add-popover-content" object-add-typeahead-menu>\n\t\t\t<div class="object-add-popover-list-header" ng-if="data.dimensions.length" q-translation="Common.Dimensions"></div>\n\t\t\t<ul class="lui-list">\n\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="dimension in data.dimensions" tid="dimension-item"\n\t\t\t\t\tobject-add-typeahead-item="dimension" on-select="addLibraryDimension(dimension)">\n\t\t\t\t\t<span ng-if="dimension.isDrillDown" class="lui-icon lui-icon--drill-down lui-list__aside" q-title-translation="Tooltip.dimensions.drilldown"></span>\n\t\t\t\t\t<span qve-highlight text="{{dimension.label}}" title="{{dimension.label}}" query="search.term" class="lui-list__text lui-list__text--ellipsis"></span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t<div class="object-add-popover-list-header" ng-if="data.measures.length"  q-translation="Common.Measures"></div>\n\t\t\t<ul class="lui-list">\n\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="measure in data.measures" tid="measure-item"\n\t\t\t\t\tobject-add-typeahead-item="measure" on-select="addLibraryMeasure(measure)">\n\t\t\t\t\t<span qve-highlight text="{{measure.value}}" title="{{measure.value}}" query="search.term" class="lui-list__text lui-list__text--ellipsis"></span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t<div class="object-add-popover-list-header" ng-if="data.fields.length" q-translation="Common.Fields"></div>\n\t\t\t<ul class="lui-list">\n\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="field in data.fields" tid="field-item"\n\t\t\t\t\tobject-add-typeahead-item="field" on-select="addFieldDimension(field)"\n\t\t\t\t\tng-class="{\'derived-field\': (field.isDerived && search.term === \'\')}">\n\t\t\t\t\t<i ng-if="isDirectDiscoveryField( field )" class="lui-icon  lui-icon--direct-discovery  lui-list__aside" q-title-translation="{{ getDirectDiscoveryTypeTranslationKey( field.qTags ) }}"></i>\n\t\t\t\t\t<span ng-if="field.isDateField" class="lui-icon lui-list__aside  lui-icon--calendar"></span>\n\t\t\t\t\t<span ng-if="field.isGeoField" class="lui-icon lui-list__aside  lui-icon--map"></span>\n\t\t\t\t\t<span qve-highlight text="{{getFieldDisplayName(field)}}" title="{{field.toolTip}}" query="search.term" class="lui-list__text lui-list__text--ellipsis"></span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t<div class="object-add-popover-nohits" ng-if="!data.dimensions.length && !data.fields.length" q-translation="Toolbox.Search.Nohits"></div>\n\t\t</div>\n\t</object-add-typeahead>\n</lui-popover>\n'},2702:function(e,t){e.exports='<div class="pp-component pp-list-component pp-list pp-nm-hcd" tcl="data" ng-class="::{ \'auto-chart\': isAutoChart }" pp-scrollable-auto-content>\n\t<div class="pp-nm-hcd__lists" qv-sortable-list="sortableItemLists">\n\n\t\t\x3c!-- Drop zone - Auto place --\x3e\n\t\t<pp-drop-zone ng-if="isAutoChart"\n\t\t\t\t\t  on-drag-begin="showAutoDropZone(info)"\n\t\t\t\t\t  on-drop="onDropAutoDropZone(info)"\n\t\t\t\t\t  css-class="pp-nm-hcd__auto-drop-zone"\n\t\t\t\t\t  translation="DropZone.Auto">\n\t\t</pp-drop-zone>\n\n\t\t\x3c!-- Add more button for auto-charts --\x3e\n\t\t<button class="lui-button pp-nm-hcd__add-more-button" ng-if="::isAutoChart" ng-class="{\'lui-active\': isAddingData()}" ng-click="openAddMore($event)" q-translation="Common.Add"></button>\n\n\t\t\x3c!-- Lists --\x3e\n\t\t<div class="pp-nm-hcd__list"\n\t\t\t ng-class="{\n\t\t\t\t \'disabled\': list.disabled || list.locked,\n\t\t\t\t \'empty\': !isAutoChart && !getUndraggedItems(list).length,\n\t\t\t\t \'alternative\': list.isAlternative }"\n\t\t\t ng-if="list.show()"\n\t\t\t ng-repeat="list in sortableItemLists.lists"\n\t\t\t tid="{{::list.tid}}">\n\n\t\t\t\x3c!-- List header --\x3e\n\t\t\t<div class="pp-nm-hcd__list-header">\n\t\t\t\t<span class="pp-nm-hcd__list-header-title">{{::list.title}}</span>\n\t\t\t</div>\n\n\t\t\t\x3c!-- List body --\x3e\n\t\t\t<div class="pp-nm-hcd__list-body">\n\n\t\t\t\t\x3c!-- Drop zone - Dimension / Measure --\x3e\n\t\t\t\t<pp-drop-zone ng-if="isAutoChart"\n\t\t\t\t\t\t\t  on-drag-begin="showTargetedDropZone(list.tid, info)"\n\t\t\t\t\t\t\t  on-drop="onDropTargetedDropZone(list.tid, info)"\n\t\t\t\t\t\t\t  css-class="pp-nm-hcd__targeted-drop-zone"\n\t\t\t\t\t\t\t  size-selector=".pp-nm-hcd__list-body"\n\t\t\t\t\t\t\t  translation="DropZone.DropItem">\n\t\t\t\t</pp-drop-zone>\n\n\t\t\t\t<ul class="pp-nm-hcd__list-items">\n\n\t\t\t\t\t\x3c!-- Dimensions / measures --\x3e\n\t\t\t\t\t<li class="pp-nm-hcd__list-item pp-nm-hcd__list-item__data"\n\t\t\t\t\t\tng-class="item.classList"\n\t\t\t\t\t\tng-repeat="item in list.items track by item.id"\n\t\t\t\t\t\tng-include="item.templateSrc">\n\t\t\t\t\t</li>\n\n\t\t\t\t\t\x3c!-- Empty element for auto-charts --\x3e\n\t\t\t\t\t<li class="pp-nm-hcd__list-item pp-nm-hcd__list-item-empty" ng-if="::isAutoChart" ng-show="showEmptyItem(list)">\n\t\t\t\t\t\t<div class="pp-nm-di">\n\t\t\t\t\t\t\t<div class="pp-nm-di__header">\n\t\t\t\t\t\t\t\t<div class="pp-nm-di__header-title" q-translation="Common.Empty"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\n\t\t\t\t\t\x3c!-- Next possible item - Description and add button --\x3e\n\t\t\t\t\t<li class="pp-nm-hcd__list-item" ng-if="::!isAutoChart && !list.isAlternative" ng-show="showNextPossibleItem(list)">\n\t\t\t\t\t\t<div class="pp-nm-di">\n\t\t\t\t\t\t\t<div class="pp-nm-di__description" ng-if="showNextPossibleItemDescription(list)">\n\t\t\t\t\t\t\t\t{{getNextPossibleItemDescription(list)}}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<button class="lui-button pp-nm-di__add-button"\n\t\t\t\t\t\t\t\t\tng-class="{ \'lui-active\': list.adding }"\n\t\t\t\t\t\t\t\t\tng-click="list.addClicked($event)"\n\t\t\t\t\t\t\t\t\tqv-enter="list.addClicked($event)"\n\t\t\t\t\t\t\t\t\tqva-outside-ignore-for="{{::\'addButton-\' + $id}}"\n\t\t\t\t\t\t\t\t\ttid="add-hc-data">\n\t\t\t\t\t\t\t\t{{::list.getAddLabel()}}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\n\t\t\t\x3c!-- Add alternative button --\x3e\n\t\t\t<button class="lui-button pp-nm_hcd__add-alternative-button"\n\t\t\t\t\tng-class="{ \'lui-active\': list.adding }"\n\t\t\t\t\tng-if="list.isAlternative"\n\t\t\t\t\tng-click="list.addClicked($event)"\n\t\t\t\t\tqv-enter="list.addClicked($event)"\n\t\t\t\t\tqva-outside-ignore-for="{{::\'addButton-\' + $id}}"\n\t\t\t\t\ttid="add-hc-data">\n\t\t\t\t{{::list.getAddLabel()}}\n\t\t\t</button>\n\t\t</div>\n\t</div>\n</div>\n'},2703:function(e,t,n){"use strict";var i,o;!(i=[],o=function(){var e={isValid:t};return e;function t(e){if(!e)return false;if(e.isFieldlike)return true;if(e.qualified.isFieldlike)return true;return false}}.apply(t,i),void 0!==o&&(e.exports=o))},2704:function(e,t,n){"use strict";var i,o;!(i=[n(2705)],o=function(e){return{isForbiddenMove:t,isInvalid:e.isInvalid,isMovingDimToMea:e.isMovingDimToMea,isMovingMeaToDim:e.isMovingMeaToDim};function t(t,n,i){return e.isInvalidToMoveDimToAltMea(t,n)||e.isInvalidToMoveAltDimToMeaSect(t,n,i)||e.isInvalidToMoveLibDimToMea(t,n,i)||e.isInvalid(t)}}.apply(t,i),void 0!==o&&(e.exports=o))},2705:function(e,t,n){"use strict";var i,o;!(i=[],o=function(){return{isInvalidToMoveMeaToDim:o,isInvalidToMoveDimToAltMea:r,isInvalidToMoveLibDimToMea:s,isInvalidToMoveAltDimToMeaSect:a,isInvalid:l,isMovingDimToMea:u,isMovingMeaToDim:c};function e(e,t){if(!e||!t)throw new Error("Missing required parameter")}function t(e){return 3===e.typeFlag||e.__sortableItem__&&3===e.__sortableItem__.typeFlag}function n(e){return 12===e.typeFlag||e.__sortableItem__&&12===e.__sortableItem__.typeFlag}function i(e){return 5===e.typeFlag||e.__sortableItem__&&5===e.__sortableItem__.typeFlag}function o(e,t,n){if("measure"===e.type&&"measure"===t.type)return 1===n.typeFlag||3===n.typeFlag;return(1===t.typeFlag||3===t.typeFlag)&&"measure"===e.type}function r(e,t){return"dimension"===e.type&&n(t)}function a(e,o,r){return"dimension"===e.type&&"dimension"===o.type?t(e)&&(i(r)||n(r)):t(e)&&(i(o)||n(o))}function s(t,o,r){e(t,o);if("dimension"===t.type&&"dimension"===o.type)return"dimension"===t.type&&!!t.data.qLibraryId&&(i(r)||n(r));return"dimension"===t.type&&!!t.data.qLibraryId&&(i(o)||n(o))}function l(e){return e.isInvalid&&e.isInvalid()}function u(t,n){e(t,n);return!(t.isInvalid&&t.isInvalid())&&"dimension"===t.type&&!t.data.qLibraryId&&5===n.typeFlag}function c(t,n){e(t,n);return!(t.isInvalid&&t.isInvalid())&&"measure"===t.type&&!t.data.qLibraryId&&1===n.typeFlag}}.apply(t,i),void 0!==o&&(e.exports=o))},2706:function(e,t,n){"use strict";var i,o;!(i=[n(90),n(1494),n(1529),n(1533),n(1569),n(1053),n(1054),n(1588),n(1055),n(1597),n(2707),n(1057),n(1628),n(1059),n(1060),n(1661),n(1663)],o=function(e,t,n,i,o,r,a,s,l,u,c,d,p,f,h,g,m){var v={};C();var b={getDimensionDescription:x,getMeasureDescription:y};return b;function x(e,t,n,i){return q("Dimension",e,t,n,i)}function y(e,t,n,i){return q("Measure",e,t,n,i)}function C(){v.barchart={getDimensionDescription:t.dimensions.description,getMeasureDescription:t.measures.description};v.boxplot={getDimensionDescription:n.dimensions.description,getMeasureDescription:n.measures.description};v.combochart={getDimensionDescription:i.dimensions.description,getMeasureDescription:i.measures.description};v.distributionplot={getDimensionDescription:o.dimensions.description,getMeasureDescription:o.measures.description};v.filterpane={getDimensionDescription:r.data.dimensions.description};v.gauge={getMeasureDescription:a.data.measures.description};v.histogram={getDimensionDescription:s.dimensions.description};v.kpi={getMeasureDescription:l.data.measures.description};v.linechart={getDimensionDescription:u.dimensions.description,getMeasureDescription:u.measures.description};v.piechart={getDimensionDescription:c.dimensions.description,getMeasureDescription:c.measures.description};v.pivotTable={getDimensionDescription:d.data.dimensions.description,getMeasureDescription:d.data.measures.description};v.scatterplot={getDimensionDescription:p.dimensions.description,getMeasureDescription:p.measures.description};v.table={getDimensionDescription:f.data.dimensions.description,getMeasureDescription:f.data.measures.description};v.textImage={getMeasureDescription:h.data.measures.description};v.treemap={getDimensionDescription:g.dimensions.description,getMeasureDescription:g.measures.description};v.waterfall={getMeasureDescription:m.measures.description}}function q(t,n,i,o,r){var a=v[n],s="get"+t+"Description",l=a&&a[s];if(!e.isFunction(l))return;return l(i,o,r)}}.apply(t,i),void 0!==o&&(e.exports=o))},2707:function(e,t,n){"use strict";var i,o;!(i=[n(91)],o=function(e){return{dimensions:{description:function t(){return e.get("Visualizations.Descriptions.Slice")}},measures:{description:function t(n,i){var o;o=0===i?"Visualizations.Descriptions.Angle":i>=n.qHyperCubeDef.qMeasures.length?"Visualizations.Descriptions.Color":"Visualizations.Descriptions.Radius";return e.get(o)}}}}.apply(t,i),void 0!==o&&(e.exports=o))},2708:function(e,t,n){"use strict";var i,o;!(i=[n(186)],o=function(e){var t={visualization:"",indexes:{dimensions:{},measures:{}}};var n={updateIndexes:i,getDimensionIndex:o,getMeasureIndex:r};return n;function i(e){if(!e)return;var n=e.qHyperCubeDef,i=e.qUndoExclude.generated;if(!n||!i)return;a();var o=i.qHyperCubeDef||i.boxplotDef&&i.boxplotDef.qHyperCubeDef;if(!o)return;t.visualization=i.visualization;var r=s(n);u(r,n,o);var d=l(n);c(d,n,o)}function o(e,n){if(n!==t.visualization)return e;return t.indexes.dimensions[e]}function r(e,n){if(n!==t.visualization)return e;return t.indexes.measures[e]}function a(){t.indexes.dimensions={};t.indexes.measures={}}function s(e){var t={};e.qDimensions.forEach(function(e){var n=d(e);t[n]||(t[n]=[]);t[n].push(e)});return t}function l(e){var t={};e.qMeasures.forEach(function(e){var n=p(e);t[n]||(t[n]=[]);t[n].push(e)});return t}function u(e,n,i){Object.keys(e).forEach(function(o){var r=e[o];r.forEach(function(e,o){var r=f(e,i),a=n.qDimensions.indexOf(e),s=i.qDimensions.indexOf(r)+o,l=-1!==s;if(!l){var u=v(e,i),c=n.qDimensions.length-1;s=u?c:a}t.indexes.dimensions[a]=s})})}function c(e,n,i){Object.keys(e).forEach(function(o){var r=e[o];r.forEach(function(e,o){var r=h(e,i),a=n.qMeasures.indexOf(e),s=i.qMeasures.indexOf(r)+o,l=-1!==s;if(!l){var u=b(e,i),c=n.qMeasures.length-1;s=u?c:a}t.indexes.measures[a]=s})})}function d(e){var t=e.qLibraryId?e.qLibraryId:e.qDef.qFieldDefs[0];return t}function p(e){var t=e.qLibraryId?e.qLibraryId:e.qDef.qDef;return t}function f(e,t){return t.qDimensions.filter(function(t){return g(e,t)}).shift()}function h(e,t){return t.qMeasures.filter(function(t){return m(e,t)}).shift()}function g(e,t){if(e.qLibraryId)return e.qLibraryId===t.qLibraryId;return e.qDef.qFieldDefs[0]===t.qDef.qFieldDefs[0]}function m(e,t){if(e.qLibraryId)return e.qLibraryId===t.qLibraryId;return e.qDef.qDef===t.qDef.qDef}function v(t,n){return n.qDimensions.some(function(n){var i=n.qAttributeDimensions;if(!i.length)return false;var o=i[0];if(t.qLibraryId)return t.qLibraryId===o.qLibraryId;var r=e.normalizeExpression(t.qDef.qFieldDefs[0]),a=e.normalizeExpression(o.qDef);return r===a})}function b(t,n){return n.qDimensions.some(function(n){var i=n.qAttributeExpressions;if(!i.length)return false;var o=i[0];if(t.qLibraryId)return t.qLibraryId===o.qLibraryId;var r=e.normalizeExpression(t.qDef.qDef),a=e.normalizeExpression(o.qExpression);return r===a})}}.apply(t,i),void 0!==o&&(e.exports=o))},2709:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(95),n(91),n(236),n(2710)],o=function(e,t,n,i,o){var r="hover",a=".drag-and-drop-canvas",s={DRAG_BEGIN:"/pp-drop-zone/drag-begin",DRAG_END:"/pp-drop-zone/drag-end"};e.nativeComponent("ppDropZone",{template:o,replace:true,bindings:{onDragBegin:"&",onDrop:"&",cssClass:"@",sizeSelector:"@",translation:"@"},controller:["$scope","$element","$document",function(e,o,l){var u=this,c,d=o.children().first();u.$onInit=function(){u.text=n.get(u.translation);t.subscribe(s.DRAG_BEGIN,p);t.subscribe(s.DRAG_END,g);g();c={accept:{libraryitem:function e(t){return"field"===t.item.type||"measure"===t.item.type||"dimension"===t.item.type},inline:function e(){return true}},start:function e(t){if(!f(t.info))return;x(t.info)&&y();h();var n={targetRect:function e(){return d[0].getBoundingClientRect()},drop:function e(t){u.onDrop({info:t})},enter:function e(){v()},leave:function e(){b()}};t.registerDropRect(n)},end:function e(){g();b()}};i.registerDropTarget(c)};e.$on("$destroy",function(){t.unsubscribe(s.DRAG_BEGIN,p);t.unsubscribe(s.DRAG_END,g);i.unregisterDropTarget(c)});function p(e){if(!f(e))return;h()}function f(e){return u.onDragBegin({info:e})}function h(){m();d.show()}function g(){d.hide()}function m(){if(!u.sizeSelector)return;var e=d.closest(u.sizeSelector);if(!e.length)return;var t=e.position(),n=t.top,i=e.height(),o=e.width();d.css({top:n,height:i,width:o})}function v(){d.addClass(r)}function b(){d.removeClass(r)}function x(e){return"inline"===e.type}function y(){var e=l.find(a);e.length&&e.hide()}}]})}.apply(t,i),void 0!==o&&(e.exports=o))},2710:function(e,t){e.exports='<div class="pp-drop-zone {{$ctrl.cssClass}}">\n\t<div class="pp-drop-zone__content">\n\t\t<i class="pp-drop-zone__icon lui-icon lui-icon--drop"></i>\n\t\t<span class="pp-drop-zone__text">{{$ctrl.text}}</span>\n\t</div>\n</div>'},2711:function(e,t,n){"use strict";var i,o;!(i=[n(11),n(165),n(101),n(207),n(99),n(1813),n(2712),n(272),n(403)],o=function(e,t,n,i,o,r,a,s,l){var u={template:r,controller:["$scope",function(r){var u=r.args.cache,c="sortable_",d=l.create();r.expandClicked=function(t,n){if(n.disabled||e(t.target).hasClass("pp-move-item"))return;n.expanded=!n.expanded;u.put(c+n.id,n.expanded)};function p(){r.sortableItemLists.reset();d.resetTitles();var e=[],i=[];var o=r.definition.items.dimensions;var a=n.getValue(r.data,o.ref,[]);a.forEach(function(n,a){var l=n.qDef.cId,p,f=true;"function"===typeof o.included?f=o.included.call(null,a,r.data,r.args.handler):"boolean"===typeof o.included&&(f=o.included);"function"===typeof o.locked?p=o.locked.call(null,a,r.data,r.args.handler):"boolean"===typeof o.locked&&(p=o.locked);if(f){e.push({title:function e(){var t=r.args.handler.getDimensionLayout(l);return d.getDimensionTitle(t,n,true)},isInvalid:function e(){var t=r.args.handler.getDimensionLayout(l);return t&&!!t.qError&&!s.isCalcCondNotCalculatedErr(t.qError)},component:t.getComponent("items"),definition:o,data:n,args:r.args,type:"dimension",id:n.qDef.cId,interColIx:a,expanded:true===o.expanded||u.get(c+l)||false,sortable:false!==o.allowMove&&!p,showPriority:false!==o.showPriority,templateSrc:"pp-sorting-item.ng.html"});i.push(i.length)}});var l=r.definition.items.measures;var p=n.getValue(r.data,l.ref,[]);p.forEach(function(n,o){var s=n.qDef.cId,p,f=true,h=r.args.handler.getMeasureLayout(s),g;"function"===typeof l.included?f=l.included.call(null,o,r.data,r.args.handler):"boolean"===typeof l.included&&(f=l.included);"function"===typeof l.locked?p=l.locked.call(null,o,r.data,r.args.handler):"boolean"===typeof l.locked&&(p=l.locked);d.getMeasureTitle(h,n,true,r.args.app).then(function(e){g=e});if(f){e.push({title:function e(){return g},isInvalid:function e(){var t=r.args.handler.getMeasureLayout(s);return t&&!!t.qError},component:t.getComponent("items"),definition:l,data:n,args:r.args,type:"measure",id:n.qDef.cId,interColIx:a.length+o,expanded:true===l.expanded||u.get(c+s)||false,sortable:false!==l.allowMove&&!p,showPriority:false!==l.showPriority,templateSrc:"pp-sorting-item.ng.html"});i.push(i.length)}});var f=n.getValue(r.data,r.definition.sortIndexRef,void 0),g,m;if(f&&i.length!==f.length){g=i.sort(function(e,t){return f.indexOf(e)>f.indexOf(t)});m=g.map(function(t,n){return e[n]})}else m=f?f.map(function(t){return e[t]}):e;m.forEach(function(e,t){e.priority=t+1});m.forEach(function(e){h.addSortableItem(e)})}r.sortableItemLists=i.create({options:{direction:"vertical",listKey:"list",listSelector:".pp-expandable-list",itemKey:"item",itemSelector:".qv-pp-sortable",itemDragSelector:".qv-pp-sortable-handle",gesture:{name:"swipe",options:{radiusThreshold:o.treatAsDesktop()?4:0,preventDefault:false}}},addPlaceholder:function e(){var t=this._super.apply(this,arguments);t.classList=["qv-pp-sortable"]},onBegin:function e(){this._super.apply(this,arguments);f()},onMove:function e(){var t=this._super.apply(this,arguments);if(t){var i=h.get().map(function(e){return e.interColIx});var o=n.getValue(r.data,r.definition.sortIndexRef);i.length!==o.length&&(i=a.sortBasedOnSubSet(o,i));n.setValue(r.data,r.definition.sortIndexRef,i);r.$emit("saveProperties")}return t}});function f(){h.get().forEach(function(e){e.expanded=false;u.put(c+e.id,false)})}var h=r.sortableItemLists.createList(1,{tid:"sorting"});Object.keys(r.definition.items).forEach(function(e){var t=r.definition.items[e];r.$watchCollection("data."+t.ref,function(){p()})});r.$watchCollection("data."+r.definition.sortIndexRef,function(){p()})}]};return u}.apply(t,i),void 0!==o&&(e.exports=o))},2712:function(e,t,n){"use strict";var i,o;!(i=[],o=function(){var e={sortBasedOnSubSet:function e(t,n){var i,o=0,r=n.map(function(e){return t.indexOf(e)}).filter(function(e){return e>-1});i=t.map(function(e,t){var i=r.indexOf(t);return i>-1?n[o++]:e});return i}};return e}.apply(t,i),void 0!==o&&(e.exports=o))},2713:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(101),n(107),n(2714)],o=function(e,t,n,i){var o={template:i,controller:["$scope",r]};return o;function r(i){var o=i.definition.ref?i.definition.ref+".":"",r=o+"qDef.qFieldDefs",a=o+"qDef.qFieldLabels",s=o+"qDef.qLabelExpression",l=function e(){return i.data};e.defineChange(i,i.args.handler);i.items=c();i.$watchCollection("data."+r,u);i.$watch("data."+s,u);function u(){i.items=c()}function c(){var e=t.getValue(i.data,r,[]);var n=e.map(d);return n}function d(e,t){var n={field:p(e,t),label:f(t)};return n}function p(t,n){var o={definition:{type:"string",ref:m(r,n),expression:"always"},isLocked:function e(){return h(o.value)},isValid:true,setIsValid:function e(t){o.isValid=t},onExpressionEditorApply:function e(t){o.value=t;i.change()},interpretAsExpression:function e(){return g(o.value)}};e.defineValue(o,o.definition,l,"value");return o}function f(e){var n={isValid:true,setIsValid:function e(t){n.isValid=t},isLocked:function e(){return h(n.value)},onExpressionEditorApply:function e(t){var o;if(t){o=t.qStringExpression.qExpr;o&&"="!==o.charAt(0)&&(o="="+o)}n.value=o;i.change()},interpretAsExpression:function e(){return g(n.value)},getValueForExpressionEditor:function e(){var t=n.value;n.interpretAsExpression()&&(t={qStringExpression:{qExpr:t}});return t}};var o=m(a,e);Object.defineProperty(n,"value",{get:function e(){var n=t.getValue(l(),s);return n||t.getValue(l(),o)},set:function e(n){var i=n&&0===n.indexOf("=")?s:o;t.setValue(l(),i,n||void 0);var r=i===s?o:s;t.setValue(l(),r,void 0)}});return n}function h(e){if(!e)return false;return-1!==e.indexOf("\n")||e.length>n.name}function g(e){return e&&"="===e.charAt(0)}function m(e,t){return e+"."+t}}}.apply(t,i),void 0!==o&&(e.exports=o))},2714:function(e,t){e.exports='<div tcl="dimensions">\n\n\t\x3c!-- Field --\x3e\n\t<div class="pp-component pp-string-component" tcl="string">\n\t\t<div class="label" q-translation="Common.Field"></div>\n\t\t<div class="value">\n\t\t\t<div class="lui-input-group">\n\t\t\t\t<input class="lui-input lui-input-group__item lui-input-group__input" type="text" maxlength="255" spellcheck="false" ng-readonly="items[0].field.isLocked()"\n\t\t\t\t pp-input-validator pp-validation-on-result="items[0].field.setIsValid(isValid)" pp-expression-editor="items[0].field.value"\n\t\t\t\t editor-disabled="!items[0].field.isLocked()" expression-type="dimension" pp-expression-editor-on-apply="items[0].field.onExpressionEditorApply(value)"\n\t\t\t\t ng-model="items[0].field.value" ng-class="{ \'lui-invalid\': !items[0].field.isValid, \'is-expression\': items[0].field.isLocked() }"\n\t\t\t\t ng-change="change()" ng-model-options="{ updateOn: \'blur\', allowInvalid: true }" qva-model-onkeyup tid="field" />\n\n\t\t\t\t<button class="lui-button lui-input-group__item lui-input-group__button" pp-expression-editor="items[0].field.value"\n\t\t\t\t pp-expression-editor-on-apply="items[0].field.onExpressionEditorApply(value)" expression-type="dimension" q-title-translation="Tooltip.OpenExpressionEditor">\n\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--expression edit-expression" ng-class="{ \'active\': items[0].field.interpretAsExpression() }"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="items[0].field.isLocked()" class="hint" q-translation="properties.editInExpressionEditor"></div>\n\t</div>\n\n\t\x3c!-- Label expression --\x3e\n\t<div class="pp-component pp-string-component" tcl="string">\n\t\t<div class="label" q-translation="Common.Label"></div>\n\t\t<div class="value">\n\t\t\t<div class="lui-input-group">\n\t\t\t\t<input class="lui-input lui-input-group__item lui-input-group__input" type="text" maxlength="255" spellcheck="false" ng-readonly="items[0].label.isLocked()"\n\t\t\t\t pp-input-validator pp-validation-on-result="items[0].label.setIsValid(isValid)" pp-expression-editor="items[0].label.getValueForExpressionEditor()"\n\t\t\t\t editor-disabled="!items[0].label.isLocked()" expression-type="StringExpression" pp-expression-editor-on-apply="items[0].label.onExpressionEditorApply(value)"\n\t\t\t\t ng-model="items[0].label.value" ng-class="{ \'lui-invalid\': !items[0].label.isValid, \'is-expression\': items[0].label.isLocked() }"\n\t\t\t\t ng-change="change()" ng-model-options="{ updateOn: \'blur\', allowInvalid: true }" qva-model-onkeyup tid="label" pp-placeholder="items[0].field.value"\n\t\t\t\t pp-placeholder-suppress-equal="true" />\n\n\t\t\t\t<button class="lui-button lui-input-group__item lui-input-group__button" pp-expression-editor="items[0].label.getValueForExpressionEditor()"\n\t\t\t\t pp-expression-editor-on-apply="items[0].label.onExpressionEditorApply(value)" expression-type="StringExpression" q-title-translation="Tooltip.OpenExpressionEditor">\n\t\t\t\t\t<span class="lui-button__icon lui-icon lui-icon--expression edit-expression" ng-class="{ \'active\': items[0].label.interpretAsExpression() }"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div ng-if="items[0].label.isLocked()" class="hint" q-translation="properties.editInExpressionEditor"></div>\n\t</div>\n</div>'},2715:function(e,t,n){"use strict";var i,o;!(i=[n(2716),n(121),n(101),n(107)],o=function(e,t,n,i){var o={template:e,controller:["$scope",r]};return o;function r(e){var o=e.definition.ref?e.definition.ref+".":"",r=o+"qDef.qDef",a=o+"qDef.qLabel",s=o+"qDef.qLabelExpression",l=function t(){return e.data};t.defineChange(e,e.args.handler);e.expression=u();e.label=c();function u(){var n={definition:{type:"string",ref:r,expression:"always"},isLocked:function e(){return d(n.value)},isValid:true,setIsValid:function e(t){n.isValid=t},onExpressionEditorApply:function t(i){n.value=i;e.change()}};t.defineValue(n,n.definition,l,"value");return n}function c(){var t={isValid:true,setIsValid:function e(n){t.isValid=n},isLocked:function e(){return d(t.value)},onExpressionEditorApply:function n(i){var o;if(i){o=i.qStringExpression.qExpr;o&&"="!==o.charAt(0)&&(o="="+o)}t.value=o;e.change()},interpretAsExpression:function e(){var n=t.value;return n&&"="===n.charAt(0)},getValueForExpressionEditor:function e(){var n=t.value;t.interpretAsExpression()&&(n={qStringExpression:{qExpr:n}});return n}};Object.defineProperty(t,"value",{get:function e(){var t=n.getValue(l(),s);return t||n.getValue(l(),a)},set:function e(t){var i=t&&0===t.indexOf("=")?s:a;n.setValue(l(),i,t||void 0);var o=i===s?a:s;n.setValue(l(),o,void 0)}});return t}function d(e){if(!e)return false;return-1!==e.indexOf("\n")||e.length>i.name}}}.apply(t,i),void 0!==o&&(e.exports=o))},2716:function(e,t){e.exports='<div tcl="measures">\n\n\t\x3c!-- Expression --\x3e\n\t<div class="pp-component pp-string-component" tcl="string">\n\t\t<div class="label" q-translation="Common.Expression"></div>\n\t\t<div class="value">\n\t\t\t<div class="lui-input-group">\n\t\t\t\t<input class="lui-input  lui-input-group__item  lui-input-group__input" type="text" maxlength="255" spellcheck="false" ng-readonly="expression.isLocked()"\n\t\t\t\t pp-input-validator pp-validation-on-result="expression.setIsValid(isValid)" pp-expression-editor="expression.value" editor-disabled="!expression.isLocked()"\n\t\t\t\t expression-type="measure" pp-expression-editor-on-apply="expression.onExpressionEditorApply(value)" ng-model="expression.value"\n\t\t\t\t ng-class="{ \'lui-invalid\': !expression.isValid, \'is-expression\': expression.isLocked() }" ng-change="change()" ng-model-options="{ updateOn: \'blur\', allowInvalid: true }"\n\t\t\t\t qva-model-onkeyup tid="field" />\n\n\t\t\t\t<button class="lui-button  lui-input-group__item  lui-input-group__button" pp-expression-editor="expression.value" pp-expression-editor-on-apply="expression.onExpressionEditorApply(value)"\n\t\t\t\t expression-type="measure" q-title-translation="Tooltip.OpenExpressionEditor">\n\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--expression edit-expression active"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div ng-if="expression.isLocked()" class="hint" q-translation="properties.editInExpressionEditor"></div>\n\t</div>\n\n\t\x3c!-- Label expression --\x3e\n\t<div class="pp-component pp-string-component" tcl="string">\n\t\t<div class="label" q-translation="Common.Label"></div>\n\t\t<div class="value">\n\t\t\t<div class="lui-input-group">\n\t\t\t\t<input class="lui-input lui-input-group__item lui-input-group__input" type="text" maxlength="255" spellcheck="false" ng-readonly="label.isLocked()"\n\t\t\t\t pp-input-validator pp-validation-on-result="label.setIsValid(isValid)" pp-expression-editor="label.getValueForExpressionEditor()"\n\t\t\t\t editor-disabled="!label.isLocked()" expression-type="StringExpression" pp-expression-editor-on-apply="label.onExpressionEditorApply(value)"\n\t\t\t\t ng-model="label.value" ng-class="{ \'lui-invalid\': !label.isValid, \'is-expression\': label.isLocked() }" ng-change="change()"\n\t\t\t\t ng-model-options="{ updateOn: \'blur\', allowInvalid: true }" qva-model-onkeyup tid="label" pp-placeholder="expression.value"\n\t\t\t\t pp-placeholder-suppress-equal="true" />\n\n\t\t\t\t<button class="lui-button lui-input-group__item lui-input-group__button" pp-expression-editor="label.getValueForExpressionEditor()"\n\t\t\t\t pp-expression-editor-on-apply="label.onExpressionEditorApply(value)" expression-type="StringExpression" q-title-translation="Tooltip.OpenExpressionEditor">\n\t\t\t\t\t<span class="lui-button__icon lui-icon lui-icon--expression edit-expression" ng-class="{ \'active\': label.interpretAsExpression() }"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div ng-if="label.isLocked()" class="hint" q-translation="properties.editInExpressionEditor"></div>\n\t</div>\n</div>'},2717:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(107),n(2718)],o=function(e,t,n){var i={template:n,controller:["$scope",function(n){var i=function e(){return n.data};n.definition.maxlength?n.maxlength=n.definition.maxlength:n.maxlength=t.name;e.defineLabel(n,n.definition,i,n.args.handler);e.defineVisible(n,n.args.handler);e.defineReadOnly(n,n.args.handler);e.defineChange(n,n.args.handler);e.defineValue(n,n.definition,i);e.defineExpression(n,true,true)}]};return i}.apply(t,i),void 0!==o&&(e.exports=o))},2718:function(e,t){e.exports='<div class="pp-component pp-integer-component" ng-if="visible" tcl="integer">\n\t<div class="label" ng-if="label" title="{{label}}">{{label}}</div>\n\n\t<div class="value">\n\t\t<div ng-class="{ \'lui-input-group\': isExpressionDefinition }">\n\t\t\t<input type="text" maxlength="{{maxlength}}" spellcheck="{{!isExpression()}}" class="lui-input" ng-class="{\n\t\t\t\t\t\'lui-invalid\': invalid,\n\t\t\t\t\t\'lui-input-group__item\': isExpressionDefinition,\n\t\t\t\t\t\'lui-input-group__input\': isExpressionDefinition,\n\t\t\t\t\t\'is-expression\': isLocked()\n\t\t\t\t}"\n\t\t\t\tng-model="displayValue" ng-model-options="{ updateOn: \'blur\', allowInvalid: true }" qva-model-onkeyup\n\t\t\t\tpp-input-validator ng-readonly="isLocked()" ng-disabled="readOnly" ng-change="change()"\n\t\t\t\tpp-expression-editor="value" editor-disabled="!isLocked()" expression-type="{{expressionType}}" tid="{{key}}" pattern="[0-9]+"/>\n\n\t\t\t<button class="lui-input-group__item  lui-input-group__button  lui-button" ng-show="isExpressionDefinition && !readOnly"\n\t\t\t\t\tpp-expression-editor="value" expression-type="{{expressionType}}"\n\t\t\t\t\tq-title-translation="Tooltip.OpenExpressionEditor">\n\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--expression edit-expression" ng-class="{\'active\': isExpression()}"></span>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\n\t<div ng-if="isLocked()" class="hint" q-translation="properties.editInExpressionEditor"></div>\n</div>\n'},2719:function(e,t){e.exports='<div class="pp-component pp-items-component" ng-if="visible" tcl="items">\n\t<div ng-repeat="item in items track by item.key" tid="{{item.key}}" class="item" ng-class="{ \'grouped\': definition.grouped }">\n\t\t<div include-pp-component x-component="item.component" x-definition="item.definition" x-data="data" x-args="args"></div>\n\t</div>\n</div>'},2720:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(11),n(91),n(96),n(101),n(99),n(207),n(2721),n(2722),n(90),n(1187),n(111)],o=function(e,t,n,i,o,r,a,s,l,u,c){return{template:l,controller:["$scope","luiPopover",function(l,d){var p={showAddButton:false};l.def=u.extend(true,{},p,l.definition);l.noLayersHelpHeader=l.def.noLayersHelpHeader;l.noLayersHelpText=l.def.noLayersHelpText;var f=l.args.cache;var h="layers_";var g={};var m=o.getValue(l.data,l.definition.ref)||[];var v=m.map(function(e){return e.cId});var b={};v.forEach(function(e){b[e]=true});function x(e){f.put(h+e,false)}l.editLayer=function(e,t){var n=w.get(function(t){return t.id===e})[0];var i=l.definition.ref||"layers";var o={id:n.id,triggerId:"propertyPanelLayers",title:n.definition.title,subTitle:n.subTitle,layoutPath:i+"."+n.index,propertiesPath:i+"."+n.index,definition:n.definition,footer:{items:[{type:"button",translation:l.def.deleteBtnTranslation||"Common.Delete",icon:"bin",action:function e(t){t.preventDefault();l.removeLayer(n)}}]},transitions:{show:void 0===t||t,hide:true},stepOutCallback:x,dataPath:n.dataPath};var r=l.def.activePath;if(r){r="function"===typeof r?r.call(null,n):r;r&&r.length&&(o.activePath=r)}l.$root.$emit("showSubPanel",o);f.put(h+n.id,true)};l.removeLayer=function(e){var t=c.getLayersProperties(l.data,l.definition.ref);t.splice(e.index,1);l.$emit("saveProperties");delete b[e.cId]};l.getAddLabel=function(){return n.get(l.definition.addTranslation)};l.addClicked=function(e){if(l.adding){L();return}var i=c.getLayersProperties(l.data,l.definition.ref);if(i&&i.length<=y()){var o=Object.keys(l.definition.layers).map(function(e){var t=l.definition.layers[e];return{title:n.get(t.definition.translation),layer:t}});I=d.show({template:s,input:{items:o,addLayer:C},alignTo:e.currentTarget,closeOnEscape:true});I.closing.then(function(e){e&&!t(e.target).hasClass("lui-button__text")&&(l.adding=false)});I.closed.then(function(){I=null});l.adding=true}};function y(){if("function"===typeof l.definition.max)return l.definition.max.call(null,l.data,this);return l.definition.max||1e6}l.addDisabled=function(){var e=c.getLayersProperties(l.data,l.definition.ref);return e&&e.length>=y()};function C(e){var t=c.getLayersProperties(l.data,l.definition.ref);if(t&&t.length>=y())return;var n=u.extend(true,{},e.initialProperties||{},{cId:u.generateId()});t.push(n);l.$emit("saveProperties");L()}l.$on("pp-open-path",function(e,t){var n=t.split("."),i=n[0],o=n[1];if("data"===i&&o){f.put(h+o,true);D()}});function q(e,t){var n=e.map(function(e){return e.type});var i=t.map(function(e){return e.type});var o=n.join(",")===i.join(","),r=n.length>i.length,a=n.length===i.length&&!o;return r||a}function D(){var e=c.getLayersProperties(l.data,l.definition.ref);var t=w.get();l.sortableItemLists.reset();e.forEach(function(e,t){var i=o.getValue(l,"definition.layers."+e.type+".definition");if(i){var r=(l.definition.ref||"layers")+"."+t;var a=c.createHyperCubeHandler(r,l.args.properties,l.args.layout,l.args.app);g[e.cId]=a;var s={title:"function"===typeof i.title?i.title(e,a):i.title,subTitle:n.get(i.translation),footer:i.footer,id:e.cId,type:e.type,index:t,data:e,definition:i,sortable:true,dataPath:l.definition.dataPath};w.addSortableItem(s);f.get(h+e.cId)&&l.editLayer(s.id,false)}});var i=q(t,w.get());i&&l.$root.$emit("hideSubPanel",{all:true});l.hasLayers=!w.isEmpty()}l.sortableItemLists=a.create({options:{direction:"vertical",listKey:"list",listSelector:".pp-list-content",itemKey:"item",itemSelector:".qv-pp-sortable",itemDragSelector:".qv-pp-sortable-handle",gesture:{name:"swipe",options:{radiusThreshold:r.treatAsDesktop()?4:0,preventDefault:false}}},onBegin:function e(t){this._super.apply(this,arguments);l.movingItem=t},onCancel:function e(){this._super.apply(this,arguments);delete l.movingItem},onMove:function e(){var t=this._super.apply(this,arguments);if(t){delete l.movingItem;var n=w.get().map(function(e){return e.data});o.setValue(l.data,l.definition.ref,n);l.$emit("saveProperties")}return t}});var w=l.sortableItemLists.createList(1,{title:n.get("properties.layers"),tid:"layers"});var I=null,S=null;function L(e){if(I){I.close();I=null}e&&t(e.target).hasClass("pp-toplist-add-button")&&i.preventGestures();l.adding=false}l.openContextMenu=function(t,n){var i=e.getService("qvContextMenu").menu();i.addItem({translation:l.def.deleteBtnTranslation||"Common.Delete",tid:"delete",select:function e(){l.removeLayer(n)}});S=e.getService("qvContextMenu").show(i,{position:{x:t.pageX,y:t.pageY},docking:"Top"})};l.$watchCollection("data."+l.definition.ref,function(){D();var e=o.getValue(l.data,l.definition.ref)||[];var t=e.map(function(e){return e.cId});if(v.length<e.length){var n=e.filter(function(e){return-1===v.indexOf(e.cId)});var i=n[0];var r=!b[i.cId];l.$root.$emit("hideSubPanel",{all:true});var a=i.id||i.cId;if(r){i.id=a;l.editLayer(a,false)}b[a]=true}else{var s=v.join(",")!==t.join(",");s&&l.$root.$emit("hideSubPanel",{all:true})}v=t});l.$on("$destroy",function(){L();if(S){S.close();S=null}})}]}}.apply(t,i),void 0!==o&&(e.exports=o))},2721:function(e,t){e.exports='<lui-popover style="min-width: 200px;width: 230px;" align-to="alignTo" position="position" collision="\'flipfit\'" on-close-view="closeAddPopover(event)" qva-outside-ignore-for="{{qvaOutsideIgnoreFor}}">\n\t<ul class="lui-list">\n\t\t<li class="lui-list__item lui-list__action" ng-repeat="item in input.items" tid="layer-item" ng-click="input.addLayer(item.layer)">\n\t\t\t<span class="lui-list__text lui-list__text--ellipsis">\n\t\t\t\t{{item.title}}\n\t\t\t</span>\n\t\t</li>\n\t</ul>\n</lui-popover>\n\n'},2722:function(e,t){e.exports='<div class="pp-component pp-list-component pp-toplist" tcl="layers">\n\n  <div class="pp-no-layers-message" ng-if="!hasLayers && (noLayersHelpHeader || noLayersHelpText)">\n    <span class="no-layers-header">{{noLayersHelpHeader}}</span>\n    <p class="no-layers-text">{{noLayersHelpText}}</p>\n  </div>\n\n\t<div class="pp-list-container pp-layer-list" qv-sortable-list="sortableItemLists" ng-if="hasLayers">\n\t\t<ul class="pp-list-content lui-list">\n\t\t\t<li ng-repeat="item in sortableItemLists.lists[0].items track by item.id" ng-style="item.style"\n\t\t\t\tclass="lui-list__item"\n\t\t\t\tng-class="{ \'qv-pp-sortable\': item.sortable, \'on-the-move\': item === movingItem }"\n\t\t\t\tqva-activate="editLayer(item.id)" qva-context-menu="openContextMenu($event, item)" title="{{item.title}}">\n\n\t\t\t\t<span class="lui-list__aside move-handle qv-pp-sortable-handle">\n\t\t\t\t\t<span class="lui-icon  lui-icon--draggable" q-title-translation="Common.Move"></span>\n\t\t\t\t</span>\n\t\t\t\t<span class="lui-list__aside text-wrapper">\n\t\t\t\t  <span class="lui-list__text layer-title">{{item.title}}</span>\n\t\t\t\t  <span class="lui-list__text layer-sub-title">{{item.subTitle}}</span>\n\t\t\t\t</span>\n\t\t\t\t<span class="lui-list__aside">\n\t\t\t\t  <span class="lui-icon  lui-icon--next  lui-icon--small"></span>\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n\n  <button ng-if="def.showAddButton" class="lui-button lui-button--block pp-toplist-add-button" ng-class="{\'lui-active\': adding === true}" qva-activate="addClicked($event)" qv-enter="addClicked($event)" qva-outside-ignore-for="{{\'addButton-\' + $id}}"\n          ng-disabled="addDisabled()" tid="add-data">\n    <span class="lui-button__text">{{getAddLabel()}}</span>\n  </button>\n</div>\n'},2723:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(2724)],o=function(e,t){var n={template:t,controller:["$scope",function(t){var n=function e(){return t.data};e.defineLabel(t,t.definition,n,t.args.handler);e.defineVisible(t,t.args.handler);e.defineChange(t,t.args.handler);e.defineCustom(t,t.args.handler,"url")}]};return n}.apply(t,i),void 0!==o&&(e.exports=o))},2724:function(e,t){e.exports='<div class="pp-component pp-link-component" ng-if="visible" tcl="link">\n\t\x3c!--<div class="label" ng-if="label">{{label}}</div>--\x3e\n\n\t<div class="value" style="text-align: right;">\n\t\t<a ng-href="{{url}}" target="_blank">{{label}}</a>\n\t</div>\n\n</div>\n'},2725:function(e,t,n){"use strict";var i,o;function r(e){r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return r(e)}!(i=[n(48),n(11),n(165),n(121),n(101),n(156),n(99),n(207),n(90),n(2726),n(111)],o=function(e,t,n,i,o,a,s,l,u,c){var d={template:c,controller:["$scope","$element",function(c,d){var p=c.args.cache,f="list_"+c.definition.ref+"_";function h(e){if(c.definition.cId)return o.getValue(e,c.definition.cId,"");return e&&e.cId}function g(e,t){o.setValue(e,c.definition.cId||"cId",t)}i.defineVisible(c,c.args.handler);c.itemId=function(e){var t=h(e);if(!t){t=e.$$hashKey||u.generateId();g(e,t);delete e.$$hashKey}return t};c.isExpanded=function(e){return p.get(f+h(e))};c.expandClicked=function(e,n){if(t(e.target).hasClass("pp-move-item"))return;d.find("input").blur();var i=h(n.data),o=p.get(f+i)||false;n.expanded=!o;p.put(f+i,n.expanded)};c.addClicked=function(){if(!c.addDisabled()){b();if("function"===typeof c.definition.add&&c.definition.customAdd){c.definition.add.call(null,e,c.data,c.args.handler);return}var e=a.mapProperties(c.definition);e.cId=u.generateId();"function"===typeof c.definition.add&&c.definition.add.call(null,e,c.data,c.args.handler);var t=o.getValue(c.data,c.definition.ref,[]);t.push(e);p.put(f+e.cId,true);c.$emit("saveProperties")}};c.removeItem=function(e){var t=o.getValue(c.data,c.definition.ref,[]),n=t[e];"function"===typeof c.definition.remove&&c.definition.remove.call(null,n,c.data,c.args.handler);t.splice(e,1);c.$emit("saveProperties")};var m=null;c.openContextMenu=function(t,n){var i=e.getService("qvContextMenu").menu();i.addItem({translation:"Common.Delete",tid:"delete",select:function e(){c.removeItem(n.index)}});m=e.getService("qvContextMenu").show(i,{position:{x:t.pageX,y:t.pageY},docking:"Top"})};function v(){c.sortableItemLists.reset();var e=o.getValue(c.data,c.definition.ref,[]);e.forEach(function(e,t){var i=c.itemId(e);var a={title:function n(){var n,i=c.definition.itemTitleRef;if(i){n="function"===typeof i?i.call(null,e,t,c.args.handler):o.getValue(e,i,"");"object"===r(n)&&(n=n.qStringExpression?n.qStringExpression.qExpr:n.qValueExpression.qExpr)}else n=""+(t+1);return n},component:n.getComponent("items"),definition:{type:"items",items:c.definition.items},data:e,id:i,index:t,expanded:p.get(f+i)||false,disabled:true,sortable:false!==c.definition.allowMove};x.addSortableItem(a)})}c.sortableItemLists=l.create({options:{direction:"vertical",listKey:"list",listSelector:".pp-expandable-list",itemKey:"item",itemSelector:".qv-pp-sortable",itemDragSelector:".qv-pp-sortable-handle",gesture:{name:"swipe",options:{radiusThreshold:s.treatAsDesktop()?4:0,preventDefault:false}}},addPlaceholder:function e(){var t=this._super.apply(this,arguments);t.classList=["qv-pp-sortable"]},onBegin:function e(){this._super.apply(this,arguments);var t=d.find(".pp-list-content");t.css("height",t.innerHeight());b()},removePlaceholder:function e(){this._super.apply(this,arguments);var t=d.find(".pp-list-content");t.css("height","")},onMove:function e(){var t=this._super.apply(this,arguments);if(t){var n=x.get().map(function(e){return e.data});o.setValue(c.data,c.definition.ref,n);c.$emit("saveProperties")}return t}});function b(){x.items.forEach(function(e){e.expanded=false;p.put(f+h(e.data),false)})}c.$watchCollection("data."+c.definition.ref,v);c.addDisabled=function(){var e=o.getValue(c.data,c.definition.ref,[]);return c.definition.allowAdd&&e.length>=y()};var x=c.sortableItemLists.createList(1,{tid:"list"});function y(){if("function"===typeof c.definition.max)return c.definition.max.call(null,c.data,this);return c.definition.max||1e6}c.$on("$destroy",function(){if(m){m.close();m=null}})}]};return d}.apply(t,i),void 0!==o&&(e.exports=o))},2726:function(e,t){e.exports='<div class="pp-component pp-list-component pp-toplist" ng-if="visible" tcl="list">\n\n\t<div class="pp-toplist-content pp-list-container pp-nm-hcd__lists" qv-sortable-list="sortableItemLists">\n\t\t<ul class="pp-expandable-list pp-list-content">\n\t\t\t<li ng-repeat="item in sortableItemLists.lists[0].items track by item.id" class="pp-nm-di" ng-style="item.style">\n\t\t\t\t\x3c!-- Header --\x3e\n\t\t\t\t<div class="pp-nm-di__header" ng-class="{\'expanded\': item.expanded,\t\'draggable\': item.sortable, \'qv-pp-sortable\': item.sortable}" ng-style="item.style"\n\t\t\t\t ng-click="expandClicked($event, item)" qva-context-menu="openContextMenu($event, item)">\n\t\t\t\t\t\x3c!-- Header content --\x3e\n\t\t\t\t\t<div class="pp-nm-di__header-content">\n\t\t\t\t\t\t\x3c!-- Header title --\x3e\n\t\t\t\t\t\t<div class="pp-nm-di__header-title" title="{{item.title()}}">\n\t\t\t\t\t\t\t{{item.title()}}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\x3c!-- Header icons --\x3e\n\t\t\t\t\t\t<i ng-if="item.markerClass" ng-class="item.markerClass"></i>\n\t\t\t\t\t\t<i class="lui-icon pp-nm-di__header-toggle lui-icon--arrow-right" ng-class="{ \'expanded\': item.expanded }"></i>\n\t\t\t\t\t\t<i class="lui-icon lui-icon--draggable pp-nm-di__draggable qv-pp-sortable-handle" pp-di-draggable-hover\n\t\t\t\t\t\t q-title-translation="Common.Move"></i>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t\x3c!-- Content --\x3e\n\t\t\t\t<div class="pp-nm-di__content" ng-if="item.expanded">\n\n\t\t\t\t\t<div class="pp-nm-di__content-body">\n\t\t\t\t\t\t<div include-pp-component x-component="item.component" x-definition="item.definition" x-data="item.data" x-args="args"></div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t\x3c!-- Content footer - Remove button --\x3e\n\t\t\t\t\t<div class="pp-nm-di__content-footer" ng-if="definition.allowRemove">\n\t\t\t\t\t\t<button class="lui-button pp-nm-di__remove-button" ng-click="removeItem(item.index)">\n\t\t\t\t\t\t\t<span class="lui-button__icon lui-icon lui-icon--bin remove-icon" q-title-translation="Common.Delete"></span>\n\t\t\t\t\t\t\t<span class="lui-button__text" q-translation="Common.Delete"></span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</li>\n\t\t\t<li class="pp-nm-di" ng-if="definition.allowAdd">\n\t\t\t\t<button class="lui-button lui-button--block pp-toplist-add-button"  ng-disabled="addDisabled() || !definition.allowAdd"\n\t\t\t\tqva-activate="addClicked()" tid="add-item">\n\t\t\t\t   <span class="lui-button__text">{{definition.addTranslation | translate}}</span>\n\t\t\t   </button>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</div>'},2727:function(e,t,n){"use strict";var i,o;!(i=[n(11),n(96),n(165),n(101),n(402),n(97),n(2728),n(1147),n(487)],o=function(e,t,n,i,o,r,a,s,l){var u={template:a,controller:["$scope","$element","$timeout","luiPopover",function(a,u,c,d){var p=a.args.cache,f="measures_",h=s.create(),g=l.create();a.listItemComponent=n.getComponent("items");a.listItemDefinition={items:a.definition.items||{},grouped:a.definition.grouped};function m(){var e=a.definition;h.resetTitles();g.resetTitles();var t=i.getValue(a.data,a.definition.ref,[]);var o=t.map(function(t,i){var o=t.qDef.cId,r=a.args.handler.getMeasureLayout(o),s=h.getCachedMeasureTitle(r);h.getMeasureTitle(r,t,true,a.args.app).then(function(e){s=e});return{title:function e(){return s},component:n.getComponent("items"),definition:e,data:t,id:o,index:i,expanded:p.get(f+o)||false,disabled:false}});var r=i.getValue(a.data,a.definition.disabledRef,[]);var s=r.map(function(i,o){var r=i.qDef.cId,s;g.getMeasureTitle(i,a.args.app,true).then(function(e){s=e});return{title:function e(){return s},component:n.getComponent("items"),definition:e,data:i,id:r,index:t.length+o,expanded:p.get(f+r)||false,disabled:true}});a.items=o.concat(s)}a.$watchCollection("data."+a.definition.ref,function(){m()});a.$watchCollection("data."+a.definition.disabledRef,function(){m()});a.isInvalid=function(e){var t=a.args.handler.getMeasureLayouts()[e];return t&&!!t.qError};a.itemClicked=function(t,n){if(e(t.target).hasClass("pp-delete-property")){n.index=n.disabled?n.index-a.args.handler.hcProperties.qMeasures.length:n.index;a.args.handler.removeMeasure(n.index,n.disabled).then(function(){a.$emit("saveProperties")})}else{var i=p.get(f+n.data.qDef.cId)||false;if(!n.disabled){n.expanded=!i;p.put(f+n.data.qDef.cId,!i)}}};a.addDisabled=function(){return a.args.handler.getMeasures().length>=a.args.handler.maxMeasures()};var v=null;a.addClicked=function(t){var n;if(a.adding){b();return}if(!a.addDisabled()&&!a.adding){v=d.show({template:o.template,controller:o.controller,alignTo:t.currentTarget,input:{app:a.args.app,closeAddPopover:b,addLibraryMeasure:y,addExpressionMeasure:C},position:"bottom",closeOnEscape:true});a.adding=true}v.closing.then(function(t){t&&!e(t.target).hasClass("pp-toplist-add-button")&&(a.adding=false);n=t});v.closed.then(function(){n||(a.adding=false);v=null})};function b(n){if(v){v.close();v=null}n&&e(n.target).hasClass("pp-toplist-add-button")&&t.preventGestures();a.adding=false}function x(){c(function(){var e=u.find(".pp-toplist-content");var t=e.children().last();e[0].scrollTop=t[0].offsetTop-1},100)}function y(e){a.args.handler.addLibraryMeasure(e.libraryId).then(function(e){p.put(f+e.qDef.cId,true);a.$emit("saveProperties");b();x()})}function C(e){a.args.handler.addExpressionMeasure(e.value,"").then(function(e){p.put(f+e.qDef.cId,true);a.$emit("saveProperties");b();x()})}a.sortableOptions={disabled:!a.definition.allowMove,onMove:function e(t,n){a.args.handler.moveMeasure(t,n).then(function(){a.$emit("saveProperties")})}};r.on("start",b);a.$on("$destroy",function(){r.off("start",b)})}]};return u}.apply(t,i),void 0!==o&&(e.exports=o))},2728:function(e,t){e.exports='<div class="pp-component pp-list-component pp-toplist" tcl="measures">\n\t<button class="lui-button  lui-button--block  pp-toplist-add-button" ng-class="{\'lui-active\': adding}" qva-activate="addClicked($event)" qv-enter="addClicked($event)"\n\t\t\tng-disabled="addDisabled() || !definition.allowAdd" q-translation="{{definition.addTranslation}}" tid="add-measure"></button>\n\n\t<ul class="pp-expandable-list pp-toplist-content pp-measure-list" pp-sortable="sortableOptions">\n\t\t<li ng-repeat="item in items track by item.id" ng-class="{ \'locked\': item.locked || !definition.allowMove }" class="expandable-list-item">\n\t\t\t<div class="pp-expandable-list-header pp-measure pp-sublist-header" qva-activate="itemClicked( $event, item )" qva-longtapdrag="enableTouchDrag()"\n\t\t\t\t ng-class="{ \'expanded\': item.expanded && !item.disabled, \'disabled\': item.disabled, \'invalid\': isInvalid( $index ) }" pp-sortable-handle>\n\t\t\t\t<span class="toggle-expand  lui-icon  {{ item.expanded && !item.disabled ? \'lui-icon--triangle-bottom\' : \'lui-icon--triangle-right\' }}"></span>\n\t\t\t\t<span class="text" title="{{item.title()}}">{{item.title()}}</span>\n\t\t\t\t<span class="icon icon-trash pp-delete-property" ng-if="definition.allowRemove" q-title-translation="Common.Delete"></span>\n\t\t\t</div>\n\t\t\t<div class="pp-expandable-list-content" ng-if="item.expanded && !item.disabled">\n\t\t\t\t<div include-pp-component x-component="listItemComponent" x-definition="listItemDefinition" x-data="item.data" x-args="args"></div>\n\t\t\t</div>\n\t\t</li>\n\t</ul>\n</div>\n'},2729:function(e,t,n){"use strict";var i,o;!(i=[n(165),n(101),n(91),n(2730)],o=function(e,t,n,i){var o={template:i,controller:["$scope",function(i){var o=i.args.cache,r="measures_tab_",a=[n.get("properties.kpi.first"),n.get("properties.kpi.second")];i.buttonGroupTitle=n.get("properties.kpi.measure");i.listItemComponent=e.getComponent("items");i.listItemDefinition={items:i.definition.items||{},grouped:i.definition.grouped};function s(e){return e.map(function(e){return{index:e.index,label:a[e.index],active:e.expanded}})}function l(){var n=i.definition;var a=t.getValue(i.data,i.definition.ref,[]);var l=a.map(function(t,i){var a=t.qDef.cId;return{component:e.getComponent("items"),definition:n,data:t,id:a,index:i,expanded:o.get(r+i)||false}});if(l.length){var u=l.filter(function(e){return e.expanded});u.length||(l[0].expanded=true)}i.items=l;i.buttons=s(l)}i.$watchCollection("data."+i.definition.ref,function(){l()});i.isInvalid=function(e){var t=i.args.handler.getMeasureLayouts()[e];return t&&!!t.qError};i.onClickButton=function(e){var t=this;t.items.forEach(function(n,i){n.expanded=i===e.index;t.buttons[i].active=n.expanded;o.put(r+i,n.expanded)})}}]};return o}.apply(t,i),void 0!==o&&(e.exports=o))},2730:function(e,t){e.exports='<div class="pp-tab-container">\n\t<div class="pp-component pp-buttongroup-parent" ng-if="buttons.length > 1">\n\t\t<div class="pp-buttongroup-title" >{{buttonGroupTitle}}</div>\n\t\t<div class="lui-buttongroup">\n\t\t\t<lui-button ng-repeat="button in buttons" ng-click="onClickButton(button)" active="button.active">{{button.label}}</lui-button>\n\t\t</div>\n\t</div>\n\t<div ng-repeat="item in items track by item.id">\n\t\t<div ng-if="item.expanded" include-pp-component x-component="listItemComponent" x-definition="listItemDefinition" x-data="item.data" x-args="args"></div>\n\t</div>\n</div>\n\n\n\n'},2731:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(107),n(2732)],o=function(e,t,n){var i={template:n,controller:["$scope",function(n){var i=function e(){return n.data};n.definition.maxlength?n.maxlength=n.definition.maxlength:n.maxlength=t.name;e.defineLabel(n,n.definition,i,n.args.handler);e.defineVisible(n,n.args.handler);e.defineReadOnly(n,n.args.handler);e.defineChange(n,n.args.handler);e.defineValue(n,n.definition,i);e.defineExpression(n,true,true)}]};return i}.apply(t,i),void 0!==o&&(e.exports=o))},2732:function(e,t){e.exports='<div class="pp-component pp-number-component" ng-if="visible" tcl="number">\n\t<div class="label" ng-if="label" title="{{label}}">{{label}}</div>\n\n\t<div class="value">\n\t\t<div ng-class="{ \'lui-input-group\': isExpressionDefinition }">\n\t\t\t<input type="text" maxlength="{{maxlength}}" spellcheck="{{!isExpression()}}" class="lui-input" ng-class="{\n\t\t\t\t\t\'lui-invalid\': invalid,\n\t\t\t\t\t\'lui-input-group__item\': isExpressionDefinition,\n\t\t\t\t\t\'lui-input-group__input\': isExpressionDefinition,\n\t\t\t\t\t\'is-expression\': isLocked()\n\t\t\t\t}"\n\t\t\t\tng-model="displayValue" ng-model-options="{ updateOn: \'blur\', allowInvalid: true }" qva-model-onkeyup\n\t\t\t\tpp-input-validator ng-readonly="isLocked()" ng-disabled="readOnly" ng-change="change()"\n\t\t\t\tpp-expression-editor="value" editor-disabled="!isLocked()" expression-type="{{expressionType}}" tid="{{key}}"/>\n\n\t\t\t<button class="lui-input-group__item  lui-input-group__button  lui-button" ng-show="isExpressionDefinition && !readOnly"\n\t\t\t\t\tpp-expression-editor="value" expression-type="{{expressionType}}"\n\t\t\t\t\tq-title-translation="Tooltip.OpenExpressionEditor">\n\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--expression edit-expression" ng-class="{\'active\': isExpression()}"></span>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\n\t<div ng-if="isLocked()" class="hint" q-translation="properties.editInExpressionEditor"></div>\n</div>\n'},2733:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(2734)],o=function(e,t){var n={template:t,controller:["$scope",function(t){var n=function e(){return t.data};e.defineLabel(t,t.definition,n,t.args.handler);e.defineVisible(t,t.args.handler);e.defineReadOnly(t,t.args.handler);e.defineChange(t,n,t.args.handler);e.defineValue(t,t.definition,n);t.sliderOptions={min:t.definition.min,max:t.definition.max,step:t.definition.step,range:"array"===t.definition.type}}]};return n}.apply(t,i),void 0!==o&&(e.exports=o))},2734:function(e,t){e.exports='<div class="pp-component pp-slider-component" ng-if="visible" tcl="slider">\n\t<div class="label" title="{{label}}">{{label}}</div>\n\n\t<div class="value">\n\t\t<div class="slider" pp-slider="sliderOptions" ng-model="value" ng-change="change()" ng-disabled="readOnly" ></div>\n\t</div>\n</div>'},2735:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(107),n(2736)],o=function(e,t,n){var i={template:n,controller:["$scope",function(n){var i=function e(){return n.data};n.definition.maxlength?n.maxlength=n.definition.maxlength:n.maxlength=t.name;e.defineLabel(n,n.definition,i,n.args.handler);e.defineVisible(n,n.args.handler);e.defineReadOnly(n,n.args.handler);e.defineChange(n,n.args.handler);e.defineValue(n,n.definition,i);e.defineExpression(n,false,true);e.definePlaceholder(n,n.definition)}]};return i}.apply(t,i),void 0!==o&&(e.exports=o))},2736:function(e,t){e.exports='<div class="pp-component pp-string-component" ng-if="visible" tcl="string">\n\t<div class="label" ng-if="label" title="{{label}}">{{label}}</div>\n\n\t<div class="value">\n\t\t<div ng-class="{ \'lui-input-group\': isExpressionDefinition }">\n\t\t\t<input type="text" maxlength="{{maxlength}}" spellcheck="{{!isExpression()}}" class="lui-input" ng-class="{\n\t\t\t\t\t\'lui-invalid\': invalid,\n\t\t\t\t\t\'lui-input-group__item\': isExpressionDefinition,\n\t\t\t\t\t\'lui-input-group__input\': isExpressionDefinition,\n\t\t\t\t\t\'is-expression\': isLocked()\n\t\t\t\t}"\n\t\t\t   ng-model="displayValue" pp-placeholder="placeholder" ng-model-options="{ updateOn: \'blur\', allowInvalid: true }"\n\t\t\t   qva-model-onkeyup pp-input-validator ng-readonly="isLocked()" ng-disabled="readOnly" ng-change="change()"\n\t\t\t   pp-expression-editor="value" editor-disabled="!isLocked()" expression-type="{{expressionType}}" tid="{{key}}" />\n\n\t\t\t<button class="lui-input-group__item  lui-input-group__button  lui-button" ng-show="isExpressionDefinition && !readOnly"\n\t\t\t\t\tpp-expression-editor="value" expression-type="{{expressionType}}"\n\t\t\t\t\tq-title-translation="Tooltip.OpenExpressionEditor">\n\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--expression edit-expression" ng-class="{\'active\': isExpression()}"></span>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\n\t<div ng-if="isLocked()" class="hint" q-translation="properties.editInExpressionEditor"></div>\n</div>\n'},2737:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(101),n(130),n(91),n(2738),n(1814),n(1815)],o=function(e,t,n,i,o,r,a){function s(e,n){var i=n.lastIndexOf(".");if(-1!==i){n=n.substr(0,i);e=t.getValue(e,n)}return e}var l={template:o,controller:["$scope",function(o){var l=function e(){return o.data},u="measure"===o.definition.libraryItemType;e.defineLabel(o,o.definition,l,o.args.handler);e.defineVisible(o,o.args.handler);e.defineReadOnly(o,o.args.handler);e.defineChange(o,o.args.handler);o.breakLink=function(){var e=s(o.data,o.definition.ref);u?a.showBreakLinkDialog(e).then(function(){o.change()}):r.showBreakLinkDialog(e).then(function(){o.change()})};o.toolTopTranslationKey=u?"Measure.Unlink":"Dimension.Unlink";function c(){var e=t.getValue(o.data,o.definition.ref);u?o.args.app.getMeasureList().then(function(t){var r=n.findLibraryMeasure(e,t);o.value=r?r.qData.title:i.get("Object.ErrorMessage.MissingMeasure");o.invalid=!r}):o.args.app.getDimensionList().then(function(t){var r=n.findLibraryDimension(e,t);o.value=r?r.qData.title:i.get("Object.ErrorMessage.MissingDimension");o.invalid=!r})}o.$on("datachanged",function(){c()});c()}]};return l}.apply(t,i),void 0!==o&&(e.exports=o))},2738:function(e,t){e.exports='<div class="pp-component pp-string-component pp-library-item-component" ng-if="visible" tcl="library-item">\n\t<div class="label" ng-if="label" title="{{label}}">{{label}}</div>\n\n\t<div class="value">\n\t\t<div class="lui-input-group">\n\t\t\t<input class="lui-input  lui-input-group__item  lui-input-group__input" type="text" ng-model="value" disabled="disabled" title="{{value}}"\n\t\t\t\t   spellcheck="false" ng-class="{ \'lui-invalid\': invalid }"/>\n\t\t\t<button class="lui-button  lui-input-group__item  lui-input-group__button" qva-activate="breakLink()" ng-show="!invalid" tid="unlink-btn">\n\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--link  edit-expression" q-title-translation="{{toolTopTranslationKey}}"></span>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\n</div>\n'},2739:function(e,t,n){"use strict";var i,o;function r(e){r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return r(e)}!(i=[n(165),n(121),n(2740),n(11)],o=function(e,t,n,i){var o;o={template:n,controller:["$scope",function(n){var o=n.definition.items||{},a=function e(){return n.data};o="function"===typeof o?o():o;n.items=Object.keys(o).filter(function(e){return o[e]}).map(function(i,r,s){var l,u=o[i];l={component:e.findComponent(u),definition:u,data:n.data,key:i,value:u.value,show:u.show,labelPlacement:u.labelPlacement||"top",width:u.width};if(n.definition.horizontal&&s.length%3===0){l.definition.small=true;delete l.width}t.defineLabel(l,u,a,n.args.handler);return l});n.horizontal=n.definition.horizontal||false;n.small=n.items.length%3===0;var s=u(n.definition.itemsRadius);s&&(n.itemsRadius=s);var l=u(n.definition.itemsSpacing);l&&(n.itemsMargin=(n.horizontal?[0,l,0,0]:[l,0,0,0]).join(" "));t.defineLabel(n,n.definition,a,n.args.handler);t.defineVisible(n,n.args.handler);t.defineReadOnly(n,n.args.handler);t.defineValue(n,n.definition,a);function u(e,t){t=t||"px";if(!["number","string"].contains(r(e)))return null;var n=e.toString().length!==parseFloat(e).toString().length;return n?e:e+t}n.itemVisible=function(e){if("boolean"===typeof e.show)return e.show;if("function"===typeof e.show)return e.show.call(null,n.data,n.args.handler);return true};n.getWidth=function(e){var t=n.definition.horizontal?"45%":"100%";var o=e.width;var a=parseFloat(o);var s;switch(r(o)){case"string":o=i.trim(o);s=o.length?o:t;break;case"number":s=Number.isNaN(+a)?t:o+"px";break;default:e.definition&&e.definition.small||(s=t)}return s};n.onChange=function(e){n.value=e.item.value;"function"===typeof n.definition.change&&n.definition.change(n.data,n.args.handler,n.args);n.$emit("saveProperties")};n.options=[]}]};return o}.apply(t,i),void 0!==o&&(e.exports=o))},2740:function(e,t){e.exports='<div class="pp-component pp-item-selection-list-component" ng-if="visible" tcl="item-selection-list">\n\t<div class="label header" ng-if="label" title="{{label}}">{{label}}</div>\n\n\t<ul class="pp-item-selection-list" ng-class="{\'vertical\' : !horizontal, \'small\' : small}">\n\t\t<li ng-repeat="item in items" ng-click="onChange(this)" ng-show="itemVisible(item)" ng-style="{ width: getWidth(item), margin: itemsMargin }" ng-class="{\'transparent-border\': definition.itemBorder}">\n\t\t\t<div ng-show="item.labelPlacement == \'top\'" class="label" ng-class="{ \'disabled\': readOnly, \'bold\': ( definition.itemsBoldSelect && item.value == value ) }">\n\t\t\t\t<span>{{item.label}}</span>\n\t\t\t</div>\n\t\t\t<button ng-disabled="readOnly" ng-class="{\'item\': true, \'selected\': item.value == value, \'item-border\': definition.itemBorder}" ng-style="{\'border-radius\': itemsRadius}" title="{{item.label}}">\n\t\t\t\t<div include-pp-component x-component="item.component" x-definition="item.definition" x-data="data" x-args="args"></div>\n\t\t\t</button>\n\t\t\t<div ng-show="item.labelPlacement == \'bottom\'" class="label" ng-class="{ \'disabled\': readOnly, \'bold\': ( definition.itemsBoldSelect && item.value == value ) }">\n\t\t\t\t<span>{{item.label}}</span>\n\t\t\t</div>\n\t\t</li>\n\t</ul>\n</div>'},2741:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(91),n(90),n(2742)],o=function(e,t,n,i){var o={template:i,controller:["$scope",function(i){var o=function e(){return i.data};e.defineLabel(i,i.definition,o,i.args.handler);e.defineVisible(i,i.args.handler);e.defineReadOnly(i,i.args.handler);e.defineChange(i,i.args.handler);e.defineValue(i,i.definition,o);var r,a;if("undefined"!==typeof i.definition.trueOption){r=n.extend({value:true},i.definition.trueOption);a=n.extend({value:false},i.definition.falseOption)}else if(true===i.definition.options[0].value){r=i.definition.options[0];a=i.definition.options[1]}else{r=i.definition.options[1];a=i.definition.options[0]}if(r.translation){r.label=t.get(r.translation);delete r.translation;i.trueOption=r}else if("function"===typeof r.label){i.trueOption={value:r.value};Object.defineProperty(i.trueOption,"label",{get:function e(){return r.label(o(),i.args.handler)}})}else i.trueOption=r;if(a.translation){a.label=t.get(a.translation);delete a.translation;i.falseOption=a}else if("function"===typeof a.label){i.falseOption={value:a.value};Object.defineProperty(i.falseOption,"label",{get:function e(){return a.label(o(),i.args.handler)}})}else i.falseOption=a;i.getDescription=function(e){return e===r.value?i.trueOption.label:i.falseOption.label};Object.defineProperty(i,"switchValue",{get:function e(){return i.value===r.value},set:!i.definition.interceptor?s:l});function s(e){i.value=e?r.value:a.value;i.change()}function l(e){var t=true,o=i.definition.interceptorPredicate;o&&n.isFunction(o)&&(t=o(e));t?i.definition.interceptor().then(function(t){t&&s(e)}):s(e)}}]};return o}.apply(t,i),void 0!==o&&(e.exports=o))},2742:function(e,t){e.exports='<div class="pp-component pp-switch-component" ng-if="visible" tcl="switch">\n\t<div ng-class="{ \'inverse\': definition.inverse }" class="label" ng-if="definition.context !== \'header\' && label" ng-disabled="readOnly">\n\t\t<div class="title" title="{{label}}">{{label}}</div>\n\t\t<div class="value" title="{{getDescription(value)}}"> {{getDescription(value)}}</div>\n\t</div>\n\n\t<div ng-class="{ \'inverse\': definition.inverse }" class="label" ng-if="definition.context === \'header\'" ng-disabled="readOnly">\n\t\t<div class="title" ng-if="label" title="{{label}}">{{label}}</div>\n\t\t<div class="value" title="{{getDescription(value)}}" ng-class="{ \'only-value\': !label }" > {{getDescription(value)}}</div>\n\t</div>\n\t<lui-switch ng-class="{ \'lui-switch--inverse\': definition.inverse }" x-model="switchValue" x-disabled="readOnly" tid="{{key}}" />\n</div>\n'},2743:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(2744),n(302)],o=function(e,t){var n,i="-moz-linear-gradient(left",o="-webkit-linear-gradient(left",r=" -o-linear-gradient(left",a="-ms-linear-gradient(left",s="linear-gradient(to right";function l(e,t,n){var l,u,c;u="";c=")";if(n)if(t)for(l=e.length-1;l>=0;l--)u+=", "+e[l]+" "+100/(e.length-1)*(e.length-1-l)+"%";else for(l=e.length-1;l>=0;l--){u+=", "+e[l]+" "+100/e.length*(e.length-1-l)+"%";u+=", "+e[l]+" "+100/e.length*(e.length-l)+"%"}else if(t)for(l=0;l<e.length;l++)u+=", "+e[l]+" "+100/(e.length-1)*l+"%";else for(l=0;l<e.length;l++){u+=", "+e[l]+" "+100/e.length*l+"%";u+=", "+e[l]+" "+100/e.length*(l+1)+"%"}return"background:"+e[e.length/2]+"; background:"+i+u+c+"; background:"+o+u+c+"; background:"+r+u+c+"; background:"+a+u+c+"; background:"+s+u+c+";width: 100%; height: 32px;border-radius:4px;"}n={template:t,controller:["$scope",function(t){var n=function e(){return t.data},i=function e(t){if("boolean"===typeof t.definition.reverse)return t.definition.reverse;if("function"===typeof t.definition.reverse)return t.definition.reverse.call(null,t.data,t.handler);return false};e.defineLabel(t,t.definition,n,t.args.handler);e.defineVisible(t,t.args.handler);e.defineReadOnly(t,t.args.handler);e.defineValue(t,t.definition,n);Object.defineProperty(t,"style",{get:function e(){return l(t.definition.colors,"gradient"===t.definition.type,i(t))}})}]};return n}.apply(t,i),void 0!==o&&(e.exports=o))},2744:function(e,t){e.exports='<div class="pp-component pp-color-scale-component" ng-if="visible" qva-apply-style="style" tcl="color-scale">\n</div>'},2745:function(e,t,n){"use strict";var i,o;function r(e){r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return r(e)}!(i=[n(121),n(2746),n(302)],o=function(e,t){var n;n={template:t,controller:["$scope",function(t){var n=function e(){return t.data};t.style=(t.definition.width?"width:"+i(t.definition.width)+";":"")+(t.definition.height?"height:"+i(t.definition.height)+";":"");e.defineLabel(t,t.definition,n,t.args.handler);e.defineVisible(t,t.args.handler);e.defineReadOnly(t,t.args.handler);e.defineValue(t,t.definition,n);function i(e){switch(r(e)){case"undefined":case"object":return"";case"string":return e;case"number":default:return e+"px"}}}]};return n}.apply(t,i),void 0!==o&&(e.exports=o))},2746:function(e,t){e.exports='<div ng-if="visible" class="pp-component pp-image-item-component" ng-class="{ \'item-border\': definition.itemBorder, \'item-interaction\': definition.itemInteractive }" qva-apply-style="style" tcl="image-item">\n\t<img ng-src="{{definition.src}}"></img>\n</div>'},2747:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(2748),n(302)],o=function(e,t){var n={template:t,controller:["$scope",function(t){var n=function e(){return t.data};t.content="function"===typeof t.definition.icon?t.definition.icon(t.args.layout):t.definition.icon;t.small=t.definition.small||false;e.defineLabel(t,t.definition,n,t.args.handler);e.defineVisible(t,t.args.handler);e.defineReadOnly(t,t.args.handler);e.defineValue(t,t.definition,n);var i;"function"===typeof t.definition.icon&&(i=t.$on("layoutchanged",function(e,n){t.content=t.definition.icon(n)}));t.$on("$destroy",function(){i&&i()})}]};return n}.apply(t,i),void 0!==o&&(e.exports=o))},2748:function(e,t){e.exports='<div class="pp-component pp-icon-item-component lui-icon" ng-class="{ \'small\' : small }" ng-if="visible" qva-apply-style="style" tcl="icon-item">\n\t{{content}}\n</div>'},2749:function(e,t,n){"use strict";var i,o;function r(e){r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return r(e)}!(i=[n(100),n(121),n(101),n(2750),n(298),n(296)],o=function(e,t,n,i){var o;o={template:i,controller:["$scope",function(i){var o;var a=function e(){return i.data};i.disableNone=true;t.defineLabel(i,i.definition,a,i.args.handler);t.defineVisible(i,i.args.handler);t.defineReadOnly(i,i.args.handler);t.defineChange(i,i.args.handler);if(i.definition.dualOutput||"object"===i.definition.type||"object"===r(i.definition.defaultValue)){Object.defineProperty(i,"value",{get:function t(){return e.resolveColor(n.getValue(a(),i.definition.ref,{}))},set:function t(o){var r="undefined"!==typeof o.color?o.color:o;var s="undefined"!==typeof o.index?o.index:e.currentPalette.indexOf(o);n.setValue(a(),i.definition.ref,{index:s,color:r})}});i.palette=e.currentPalette;i.extended=true}else{Object.defineProperty(i,"value",{get:function t(){return e.resolveColor(n.getValue(a(),i.definition.ref,{}),e.deprecatedPalette)},set:function t(o){var r="undefined"!==typeof o.color?o.color:o;var s=e.deprecatedPalette.indexOf(r);n.setValue(a(),i.definition.ref,s)}});i.palette=e.deprecatedPalette;i.disableNone=false;i.extended=false}i.closeColorpickerFoldout=function(){o=void 0};i.openColorPickerFoldout=function(e){o=e};i.$on("$destroy",function(){o&&o.close()})}]};return o}.apply(t,i),void 0!==o&&(e.exports=o))},2750:function(e,t){e.exports='<div class="pp-component pp-color-picker-component" ng-if="visible" tcl="color-picker">\n\t<div ng-if="label" class="label" title="{{label}}" style="display:inline-block;">\n\t\t{{label}}\n\t</div>\n\t<div class="value picker" style="display: inline-block;">\n\t\t<div qv-color-picker-button-new\n\t\t\t on-close="closeColorpickerFoldout"\n\t\t\t on-open="openColorPickerFoldout"\n\t\t\t ng-model="value"\n\t\t\t ng-change="change()"\n\t\t\t palette="palette"\n\t\t\t disable-none="{{disableNone}}"\n\t\t\t extended="{{extended}}"\n\t\t\t ng-disabled="readOnly" \n\t\t\t ng-disabled="readOnly"\n\t\t\t toggle-open="true">\n\t\t</div>\n\t</div>\n</div>'},2751:function(e,t,n){"use strict";var i,o;function r(e){r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return r(e)}!(i=[n(165),n(96),n(121),n(100),n(2752),n(109),n(91),n(48),n(11),n(101),n(1769),n(90),n(1320),n(297)],o=function(e,t,n,i,o,a,s,l,u,c,d,p,f){var h,g=l.getService("qvGlyphService");function m(e){return i.resolveColor(e)}function v(e,t){if(!t.paletteColors||!t.paletteColors.length){t.paletteColors=t.colors.map(function(e){return{color:i.resolveColor(e.color),icon:e.icon,index:-1}});e.paletteColors=t.paletteColors.concat()}return t.paletteColors}function b(e,t){e.paletteColors=t.map(function(e){return{color:e.pickerModel.color,icon:e.pickerModel.icon,index:i.currentPalette.indexOf(e.pickerModel.color)}})}function x(e,t){e.paletteColors.push({color:i.resolveColor({index:t}),index:t})}function y(e,t){e.paletteColors.splice(t+1,1)}function C(e,t){return Number(((e-t)/1e3).toFixed(20))}h={template:o,controller:["$scope","$timeout","$element",function(o,h,q){var D=function e(){return o.data},w=o.args.model.layout,I=o.args.properties,S=q.find(".colorSlider"),L,E,M,_,A=[6,5];n.defineValue(o,o.definition.items.limits,D,"limits");n.defineValue(o,o.definition.items.paletteColors,D,"paletteColors");o.palette=i.currentPalette;o.extended=true;o.$watch("removeHandleActive",function(e){if(!S||Number.isNaN(+e))return;S.children().eq(e).removeClass("active-handle")});o.measureIndex=0;o.activeIndex=-1;o.add=s.get("properties.colorScaleCreator.addLimit");o.maxSegments=6;o.useGlyph=!!o.definition.useGlyph&&o.definition.useGlyph;o.useAutoMinMax=!!o.definition.useAutoMinMax&&o.definition.useAutoMinMax;o.definition.conditionalColoringRef||(o.definition.conditionalColoringRef={props:"",layout:""});P();k();n.defineLabel(o,o.definition,D,o.args.handler);n.defineVisible(o,o.args.handler);o.sliderCreated=false;o.sliderOptions={min:E,max:M,step:C(M,E),values:o.layoutLimits.map(function(e){return e.value}),stop:function e(){l.$apply(o,function(){o.limits.forEach(function(e,t){if(o.activeIndex===t&&o.slide){e.value=o.sliderOptions.values[t];o.slide=false}});o.firstClick=false;k();o.$emit("saveProperties")})},slide:function e(t,n){if(n.values.length!==o.layoutLimits.length)return;o.currentValue+=n.values[o.activeIndex]-o.firstClickValue;if(o.firstClick&&"object"===r(o.limits[o.activeIndex].value)||Math.abs(o.firstClickValue-o.currentValue)<200*o.sliderOptions.step)return false;o.slide=true;l.$apply(o,function(){o.limits[o.activeIndex].value=n.values[o.activeIndex];o.layoutLimits[o.activeIndex].value=n.values[o.activeIndex];o.sortedSegments=o.getSortedSegments();T()})},change:function e(){return false},start:function e(t,n){l.$apply(o,function(){var e=0,t=n.handle;if(!t||!u(t).hasClass("ui-slider-handle"))return;while(null!=(t=t.previousSibling))e++;if(e!==o.activeIndex){o.updateSelectedHandle(o.activeIndex,e);z(e);o.firstClick=true;o.firstClickValue=o.sliderOptions.values[e];o.currentValue=o.firstClickValue}T()})}};o.updateSelectedHandle=function(e,t){if(e===t)return;-1!==e&&S.children().eq(e).removeClass("active-handle");-1!==t&&S.children().eq(t).addClass("active-handle")};o.limitGradientCheckBoxComponent=e.getComponent("checkbox");o.limitGradientCheckBoxDefinition={ref:"gradient",type:"boolean",defaultValue:false,translation:s.get("properties.gradient")};o.limitListItemComponent=e.getComponent("items");o.limitlistItemDefinition={items:o.definition.items.limits.items||{}};o.colorListItemComponent=e.getComponent("items");o.colorlistItemDefinition={items:o.definition.items.paletteColors.items||{}};o.getArrowBackgroundStyle=function(e){if(!e)return;return{background:m(e.pickerModel.color)}};o.showValueIndicator=function(){return!!o.measureValues&&!Number.isNaN(+o.measureValues[o.measureIndex].value)};o.getMeasureValueClass=function(){var e=o.measureIndex?o.measureIndex:0,t;if(!o.measureValues||!o.measureValues[e])return;t=o.measureValues[e].nValue;if(t<0)return"left";if(t>1)return"right";return""};o.getMeasureValueStyle=function(){var e=o.measureIndex?o.measureIndex:0,t,n;if(!o.measureValues||!o.measureValues[e])return;t=o.measureValues[e].nValue;if(t>1||t<0)return{left:"",display:"none"};n="translateX("+100*-t+"%)";return{left:100*Math.max(Math.min(o.measureValues[e].nValue,1),0)+"%","-webkit-transform":n,"-moz-transform":n,"-o-transform":n,"-ms-transform":n,transform:n}};function P(){o.conditionalColoringProps=c.getValue(I,o.definition.conditionalColoringRef.props,I);Array.isArray(o.conditionalColoringProps)?o.conditionalColoringProps.some(function(e,t){if(o.data.qDef&&o.data.qDef.cId===o.conditionalColoringProps[t].qDef.cId){o.measureIndex=t;o.conditionalColoringProps=o.conditionalColoringProps[t];o.conditionalColoringLayout=c.getValue(w,o.definition.conditionalColoringRef.layout)[t];return true}}):o.conditionalColoringLayout=c.getValue(w,o.definition.conditionalColoringRef.layout,w);var e=o.conditionalColoringLayout.conditionalColoring?o.conditionalColoringLayout.conditionalColoring.segments:w.segmentInfo;o.layoutLimits=p.extend([],e.limits);o.layoutColors=v(o,e)}function k(){L=o.conditionalColoringProps.qDef&&o.conditionalColoringProps.qDef.measureAxis?o.conditionalColoringProps.qDef.measureAxis:o.conditionalColoringLayout.measureAxis;if(o.useAutoMinMax){var e=f.getAutoMinMax(o.layoutLimits,o.measureValues?o.measureValues[o.measureIndex].value:void 0);L.min=e.min;L.max=e.max}E=L.min;M=L.max}function T(){if(Number.isNaN(+o.activeIndex)||o.activeIndex<0)return;var e=(o.layoutLimits[o.activeIndex].value-E)/(M-E)*100+"%";q.find(".limit-options-arrow-fg").css("left",e);q.find(".limit-options-arrow-bg").css("left",e)}function O(e){var t=Math.min(Math.max(e.startLimit.value,0),1),n=Math.max(Math.min(e.endLimit.value-e.startLimit.value,1-t),0);return"background-color: "+m(e.pickerModel.color)+"; color: "+("#000000"===m(e.pickerModel.color)?"rgba(255,255,255,0.5)":"rgba(0,0,0,0.3)")+"; width: "+100*n+"%; left: "+100*t+"%;"}function V(){var e,t;o.invalidExpressionIndex=-1;for(e=0;e<o.layoutLimits.length;e++){t=o.layoutLimits[e];Number.isNaN(+t.value)&&(o.invalidExpressionIndex=e)}o.hasInvalidExpression=-1!==o.invalidExpressionIndex}o.getColorBackgroundStyle=function(e,t,n){var i=e[t].startLimit,o=e[t].endLimit,r,s=[];i.gradient&&s.push(new a(m(e[t-1].pickerModel.color)).blend(new a(m(e[t].pickerModel.color)),.5));s.push(m(e[t].pickerModel.color));o.gradient&&e[t+1]&&s.push(new a(m(e[t+1].pickerModel.color)).blend(new a(m(e[t].pickerModel.color)),.5));r=3===s.length?[0,50,100]:[0,100];return O(n)+" "+d.getCSSLinearGradient("right",s,r)};o.getSortedSegments=function(){var e=o.layoutLimits.concat().sort(function(e,t){return e.value-t.value}),t=o.layoutColors,n=o.sortedSegments?o.sortedSegments.slice(0,t.length):[],i=M,r=E,a={value:0,gradient:false},s,l,u,c,d;for(d=0;d<t.length;d++){l=e[d]?{value:(e[d].value-r)/(i-r),gradient:e[d].gradient}:{value:1,gradient:false};u=m(t[d]);c=t[d].icon;if(n[d]){s=n[d];s.startLimit=a;s.endLimit=l;s.pickerModel.color=u;s.pickerModel.cssClass=c?g.getIconClass(c):""}else{s={startLimit:a,endLimit:l,pickerModel:{color:u,icon:c,cssClass:c?g.getIconClass(c):""}};n.push(s)}a=l}n.length>t.length&&n.splice(t.length,n.length-t.length);return n};o.onGlyphOrColorChange=function(){b(o,o.sortedSegments);o.$emit("saveProperties")};o.closeColorpickerFoldout=function(e){o.onGlyphOrColorChange();e&&u(e.target).closest(".color-scale-container").length&&t.preventGestures()};var H=o.$on("layoutchanged",function(){P();(o.nrSegmentsChanged||o.limits.length!==o.layoutLimits.length)&&(o.nrSegmentsInLayoutChanged=true);F()});o.$on("$destroy",function(){H()});function R(e){if(!e||!e[0])return;o.measureValues&&o.measureValues.length===e.length||(o.measureValues=[]);for(var t=0;t<e[0].length;t++)o.measureValues[t]={nValue:(e[0][t].qNum-E)/(M-E),value:e[0][t].qNum}}function $(){if(!o.measureValues||0===o.measureValues.length)return;for(var e=0;e<o.measureValues.length;e++)o.measureValues[e].nValue=(o.measureValues[e].value-E)/(M-E)}function F(){V();R(w.qHyperCube.qDataPages[0].qMatrix);if(!o.hasInvalidExpression){k();$()}if(o.nrSegmentsInLayoutChanged||!o.sliderCreated){o.initializeSlider();z();o.nrSegmentsChanged=false;o.nrSegmentsInLayoutChanged=false}o.checkSliderVisiblility();N()}function N(){o.sortedSegments=o.getSortedSegments();if(!o.layoutLimits||o.layoutLimits.length<1)return;o.sliderCreated=true;S.slider("option",{min:E,max:M,step:C(M,E)});S.slider("values",o.layoutLimits.map(function(e){return"NaN"!==e.value?e.value:(M+E)/2}));o.sliderOptions.min=E;o.sliderOptions.max=M;o.sliderOptions.step=C(M,E);T()}o.addLimit=function(e){var t,n,i,r=o.layoutLimits,a=function e(t){var n=0;while(t>1){n++;t/=10}return n};n=o.paletteColors[o.paletteColors.length-1].index===A[0]?A[1]:A[0];if(r.length+1>=o.maxSegments)return;if(r.length>0){t=(r[r.length-1].value+M)/2;i=1e3/Math.pow(10,a(t));t=Math.round(t*i)/i}else t=o.measureValues[o.measureIndex].value;o.limits.push({value:t,gradient:false});x(o,n);o.nrSegmentsChanged=true;h(function(){q.find(".limitInput").focus()});k();o.$emit("saveProperties");e.preventDefault()};o.removeLimit=function(e){o.limits.splice(e,1);o.layoutLimits.splice(e,1);y(o,e);o.sortedSegments.splice(e+1,1);o.nrSegmentsChanged=true;z(-1);k();o.$emit("saveProperties")};function z(e){o.hasInvalidExpression&&(e=o.invalidExpressionIndex);"number"!==typeof e&&(e=o.layoutLimits.length-1);o.updateSelectedHandle(o.activeIndex,e);if(-1!==e&&-1===o.activeIndex){q.find(".limit-options-arrow").removeClass("hidden");q.find(".limit-options").removeClass("hidden")}else if(-1===e){q.find(".limit-options-arrow").addClass("hidden");q.find(".limit-options").addClass("hidden")}o.activeIndex=e}o.addDisabled=function(e){return e.length+1>=o.maxSegments};o.initializeSlider=function(){if(o.sliderCreated){S.slider("destroy");o.sliderCreated=false}o.sliderOptions.values=o.layoutLimits.map(function(e){return e.value});S.slider(o.sliderOptions)};o.checkSliderVisiblility=function(){_=o.layoutLimits;(_.length>0&&S.hasClass("notVisible")||_.length<1&&!S.hasClass("notVisible"))&&S.toggleClass("notVisible")};h(function(){F();z();T()})}]};return h}.apply(t,i),void 0!==o&&(e.exports=o))},2752:function(e,t){e.exports='<div  class="pp-component pp-color-scale-creator-component" ng-show="visible" tcl="color-scale-creator">\n\t\t<div ng-if="!showValueIndicator()" class="invalid-expression-text" q-translation="properties.colorScaleCreator.cantShowSettings">\n\n\t\t</div>\n\t\t<div ng-if="label && showValueIndicator()" class="label" title="{{label}}" style="display: inline-block;">\n\t\t\t{{label}}\n\t\t</div>\n\t\t<div ng-if="add && showValueIndicator() && !hasInvalidExpression" class="add-button">\n\t\t\t<button tid="addLimit-button" class="lui-button pp-add-property ng-binding" qva-activate="addLimit($event)" ng-disabled="addDisabled(limits)">{{add}}</button>\n\t\t</div>\n\t\t<div class="color-creator-container" ng-show="showValueIndicator()">\n\t\t\t\x3c!-- picker --\x3e\n\t\t\t<div ng-show="!hasInvalidExpression">\n\t\t\t\t<div class="color-scale-container">\n\t\t\t\t\t<div class="value-indicator-wrapper">\n\t\t\t\t\t\t<div class="value-indicator-text" ng-style="getMeasureValueStyle()" title="{{measureValues[measureIndex].value}}" q-translation="properties.value"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div qv-color-picker-custom-new\n\t\t\t\t\t\t ng-if="useGlyph"\n\t\t\t\t\t\t on-close="closeColorpickerFoldout"\n\t\t\t\t\t\t class="color-scale lui-icon"\n\t\t\t\t\t\t ng-repeat="itemData in sortedSegments"\n\t\t\t\t\t\t qva-apply-style="getColorBackgroundStyle( sortedSegments, $index, itemData )"\n\t\t\t\t\t\t ng-model="itemData.pickerModel"\n\t\t\t\t\t\t palette="palette"\n\t\t\t\t\t\t use-glyph="{{useGlyph}}"\n\t\t\t\t\t\t keep-open="true"\n\t\t\t\t\t\t disable-none="true"\n\t\t\t\t\t\t extended="{{extended}}"\n\t\t\t\t\t\t on-change="onGlyphOrColorChange"\n\t\t\t\t\t\t ng-class="{\'no-transition\' : slide, \'left\' : $index === 0, \'right\' : ($index === sortedSegments.length-1)}"\n\t\t\t\t\t\t qva-activate="onClick($event)">\n\t\t\t\t\t\t <span ng-class="itemData.pickerModel.cssClass"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div qv-color-picker-custom-new\n\t\t\t\t\t\t ng-if="!useGlyph"\n\t\t\t\t\t\t on-close="closeColorpickerFoldout"\n\t\t\t\t\t\t class="color-scale"\n\t\t\t\t\t\t ng-repeat="itemData in sortedSegments"\n\t\t\t\t\t\t qva-apply-style="getColorBackgroundStyle( sortedSegments, $index, itemData )"\n\t\t\t\t\t\t ng-model="itemData.pickerModel"\n\t\t\t\t\t\t palette="palette"\n\t\t\t\t\t\t use-glyph="{{useGlyph}}"\n\t\t\t\t\t\t keep-open="true"\n\t\t\t\t\t\t disable-none="true"\n\t\t\t\t\t\t extended="{{extended}}"\n\t\t\t\t\t\t on-change="onGlyphOrColorChange"\n\t\t\t\t\t\t ng-class="{\'no-transition\' : slide, \'left\' : $index === 0, \'right\' : ($index === sortedSegments.length-1)}"\n\t\t\t\t\t\t qva-activate="onClick($event)">\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="value-indicator" ng-class="getMeasureValueClass()" ng-style="getMeasureValueStyle()" title="{{measureValues[measureIndex].value}}"></div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="pp-component pp-slider-component" class="segment-slider" style="margin-bottom:5px; padding-right: 19px; padding-left: 15px;" ng-class="{\'notVisible\': limits.length < 1}">\n\t\t\t\t\t<div class="value">\n\t\t\t\t\t\t<div class="slider colorSlider"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div ng-show="hasInvalidExpression" class="invalid-limit-warning invalid-expression-text" q-translation="properties.colorScaleCreator.cantShowSettings">\n\t\t\t</div>\n\t\t\t<div class="hidden limit-options-arrow" ng-class="{\'notVisible\': limits.length < 1}">\n\t\t\t\t<div class="limit-options-arrow-fg" ng-class="{\'no-transition\' : slide}"></div>\n\t\t\t\t<div class="limit-options-arrow-bg" ng-class="{\'no-transition\' : slide}"></div>\n\t\t\t</div>\n\n\t\t\t<div class="limit-options hidden">\n\t\t\t\t<div ng-repeat="itemData in limits track by $index">\n\t\t\t\t\t<div class="limitInput" ng-if="$index == activeIndex" include-pp-component x-component="limitListItemComponent" x-definition="limitlistItemDefinition" x-data="itemData" x-args="args" ng-model="value">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div tid="limitOptions-gradient" ng-if="$index == activeIndex" include-pp-component x-component="limitGradientCheckBoxComponent" x-definition="limitGradientCheckBoxDefinition" x-data="itemData" x-args="args" ng-model="gradient">\n\t\t\t\t\t</div>\n\t\t\t\t\t<button tid="limitOptions-remove" ng-if="$index == activeIndex" class="lui-button  lui-button--block  pp-remove-property" qva-activate="removeLimit($index)">\n\t\t\t\t\t\t<span class="lui-button__text" q-translation="properties.colorScaleCreator.removeLimit"></span>\n\t\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--bin  remove-icon" q-title-translation="Common.Delete"></span>\n\t\t\t\t\t</button>\n\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t\x3c!--\n\t\t\t<div ng-repeat="itemData in colors">\n\t\t\t\t<div ng-if="$index == activeIndex" include-pp-component x-component="colorListItemComponent" x-definition="colorlistItemDefinition" x-data="itemData" x-args="args"></div>\n\t\t\t</div>\n\t\t\t--\x3e\n\t\t</div>\n\t</div>\n</div>\n'},2753:function(e,t,n){"use strict";var i,o;!(i=[n(165),n(1248),n(101),n(2754)],o=function(e,t,n,i){var o={template:i,controller:["$scope",function(i){var o=i.args.cache,r="sorting_dimension_";i.dropdown={activeIndex:o.get(r+a().qDef.cId)||0,options:[]};function a(){var e=i.definition.ref;return e?n.getValue(i.data,e):i.data}function s(){var e=[];var t=a().qDef.cId;var n=i.args.handler.getDimensionLayout(t);n&&"H"===n.qGrouping&&n.qGroupFallbackTitles.forEach(function(t,n){e.push({value:n,label:t})});i.dropdown.options=e}i.show=function(){var e=a();return!e.qDef.autoSort};i.isGroup=function(){var e=a();if(!e.qLibraryId)return false;var t=e.qDef.cId;var n=i.args.handler.getDimensionLayout(t);return n&&"H"===n.qGrouping};var l={};Object.keys(i.definition.sortingItems).forEach(function(e){if(i.definition.sortingItems[e]){var n=t[e];var o=n(null,function e(){return a().qDef.qReverseSort});l[e]=o}});l.defaultSortMessage={component:"text",translation:"properties.sorting.defaultSortingMessage",show:function e(t){return!(l.ascii&&t.qSortByAscii||l.numeric&&t.qSortByNumeric||l.expression&&t.qSortByExpression||l.frequency&&t.qSortByFrequency)}};i.item={component:e.getComponent("items"),definition:{type:"items",grouped:true,items:l},args:i.args};function u(e,t){for(var n=0;n<=t;n++)e[n]||(e[n]={})}function c(){i.dropdown.activeIndex>=i.dropdown.options.length&&(i.dropdown.activeIndex=0);var e=a();u(e.qDef.qSortCriterias,i.dropdown.activeIndex);var t=e.qDef.qSortCriterias[i.dropdown.activeIndex];i.item.data=t}i.$watch("dropdown.activeIndex",function(e){o.put(r+a().qDef.cId,e);s();c()});i.$on("datachanged",function(){c()});i.$watch("data",function(){c()})}]};return o}.apply(t,i),void 0!==o&&(e.exports=o))},2754:function(e,t){e.exports='<div class="" style="position:relative; height: 100%;" tcl="sorting">\n\t<div class="pp-component pp-dropdown-component" ng-if="show() && isGroup()" tcl="dropdown">\n\t\t<div class="label" ng-if="label" title="{{label}}">{{label}}</div>\n\n\t\t<div class="value">\n\t\t\t<lui-select x-model="dropdown.activeIndex" x-disabled="readOnly"\n\t\t\t\t\t\tx-options="option.value as option.label for option in dropdown.options" tid="{{key}}">\n\t\t\t</lui-select>\n\t\t</div>\n\t</div>\n\n\t<div class="separator"></div>\n\n\t<div ng-if="show()" include-pp-component x-component="item.component" x-definition="item.definition" x-data="item.data" x-args="item.args"></div>\n</div>'},2755:function(e,t,n){"use strict";var i,o;!(i=[n(165),n(1248),n(101),n(2756)],o=function(e,t,n,i){var o={template:i,controller:["$scope",function(i){function o(){var e=i.definition.ref;return e?n.getValue(i.data,e):i.data}i.show=function(){var e=o();return!e.qDef.autoSort};var r={};Object.keys(i.definition.sortingItems).forEach(function(e){if(i.definition.sortingItems[e]){var n=t[e];var a=n(null,function e(){return o().qDef.qReverseSort});r[e]=a}});r.defaultSortMessage={component:"text",translation:"properties.sorting.defaultSortingMessage",show:function e(t){return!(r.ascii&&t.qSortByAscii||r.numeric&&t.qSortByNumeric)}};i.item={component:e.getComponent("items"),definition:{type:"items",grouped:true,items:r},args:i.args};function a(){var e=o();i.item.data=e.qSortBy||{}}i.$on("datachanged",function(){a()});i.$watch("data",function(){a()})}]};return o}.apply(t,i),void 0!==o&&(e.exports=o))},2756:function(e,t){e.exports='<div style="position:relative; height: 100%;" tcl="sorting">\n\t<div ng-if="show()" include-pp-component x-component="item.component" x-definition="item.definition" x-data="item.data" x-args="item.args"></div>\n</div>'},2757:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(2758)],o=function(e,t){var n={template:t,controller:["$scope",function(t){var n=function e(){return t.data};e.defineLabel(t,t.definition,n,t.args.handler);e.defineVisible(t,t.args.handler);e.defineCustom(t,t.args.handler,"style");t.style||(t.style="message")}]};return n}.apply(t,i),void 0!==o&&(e.exports=o))},2758:function(e,t){e.exports='<div class="pp-component pp-text-component" ng-if="visible" tcl="text">\n\t<div ng-class="style" tid="{{key}}">{{label}}</div>\n</div>'},2759:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(107),n(2760)],o=function(e,t,n){return{template:n,controller:["$scope",function(n){var i=function e(){return n.data};n.rows=n.definition.rows||3;n.maxlength=n.definition.maxlength||t.description;e.defineLabel(n,n.definition,i,n.args.handler);e.defineVisible(n,n.args.handler);e.defineReadOnly(n,n.args.handler);e.defineChange(n,n.args.handler);e.defineValue(n,n.definition,i);e.defineExpression(n,false,false);e.definePlaceholder(n,n.definition);n.focused=function(){n.active=true};n.blurred=function(){n.active=false}}]}}.apply(t,i),void 0!==o&&(e.exports=o))},2760:function(e,t){e.exports='<div class="pp-component pp-textarea-component" ng-if="visible" tcl="textarea">\n\t<div class="label" ng-if="label" title="{{label}}">{{label}}</div>\n\n\t<div class="value">\n\t\t<div class="lui-textarea simple-textarea" ng-class="{\'lui-invalid\': invalid, \'lui-focused\': active}">\n\t\t\t<div class="textarea-wrapper" ng-class="{ \'is-expression\': isExpressionDefinition }">\n\t\t\t\t<textarea type="text" maxlength="{{maxlength}}" rows="{{rows}}" class="wrapped-textarea" placeholder="{{placeholder}}"\n\t\t\t\t\tpp-expression-editor="value" expression-type="{{expressionType}}" editor-disabled="!isLocked()"\n\t\t\t\t\tng-model="displayValue" ng-disabled="readOnly" ng-change="change()"\n\t\t\t\t\tng-model-options="{ updateOn: \'blur\', allowInvalid: true }" pp-input-validator tid="{{key}}"\n\t\t\t\t\tng-focus="focused()" ng-blur="blurred()">\n\t\t\t\t</textarea>\n\t\t\t</div>\n\n\t\t\t<button ng-show="isExpressionDefinition && !readOnly"\n\t\t\t\t\tpp-expression-editor="value"\n\t\t\t\t\texpression-type="{{expressionType}}"\n\t\t\t\t\tclass="lui-fade-button wrapped-button"\n\t\t\t\t\tq-title-translation="Tooltip.OpenExpressionEditor">\n\t\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--expression edit-expression" ng-class="{\'active\': isExpression()}"></span>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n</div>\n'},2761:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(91),n(1334)],o=function(e,t,n){var i={template:n,controller:["$scope",function(n){var i=function e(){return n.data};e.defineLabel(n,n.definition,i,n.args.handler);e.defineVisible(n,n.args.handler);e.defineChange(n,n.args.handler);e.defineReadOnly(n,n.args.handler);e.defineValue(n,n.definition,i);function o(){var e=n.value;var i=n.options.some(function(t){return t.value===e});i||n.options.splice(0,0,{value:e,label:t.get("properties.selectValue")})}function r(){var e=n.args.handler.getDimensions(),t,i,r,a;n.options.splice(0,n.options.length);for(a=0;a<e.length;++a){t=e[a];r=t.qDef.cId;i=n.args.handler.getDimensionLayout(r);t.qLibraryId&&i&&!i.qError?t.qError||n.options.push({value:r,label:i.title}):n.options.push({value:r,label:i&&i.qFallbackTitle||""})}o()}n.options=[];r();n.$on("layoutchanged",function(){r()})}]};return i}.apply(t,i),void 0!==o&&(e.exports=o))},2762:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(101),n(2763),n(304),n(832)],o=function(e,t,n,i,o){var r={template:n,controller:["$scope",function(n){var r=function e(){return n.data};e.defineLabel(n,n.definition,r,n.args.handler);e.defineVisible(n,n.args.handler);e.defineReadOnly(n,n.args.handler);e.defineChange(n,n.args.handler);e.defineValue(n,n.definition,r);e.defineCustom(n,n.args.handler,"tooltip");n.openMediaLibrary=function(){o.show({onCancel:function e(t){t&&n.save(null)},onConfirm:function e(t,i){n.save(i)},selectedFile:t.getValue(n.args.layout,n.definition.layoutRef)})};n.update=function(){var e=t.getValue(n.args.layout,n.definition.layoutRef);if(e){e=i.stripBasePath(e);n.mediaUrl=i.addBasePath(e)}else n.mediaUrl=""};n.save=function(e){if(e){e=i.stripBasePath(e);if(e!==n.value){n.value=e;n.$emit("saveProperties")}}else{n.value="";n.$emit("saveProperties")}};n.update();n.$on("layoutchanged",function(){n.update()})}]};return r}.apply(t,i),void 0!==o&&(e.exports=o))},2763:function(e,t){e.exports='<div class="pp-component pp-media-component" ng-if="visible" tcl="media">\n\t<div class="label" ng-if="label" title="{{label}}">{{label}}</div>\n\t<div class="value">\n\t\t<div class="placeholder">\n\t\t\t<button ng-if="!readOnly" class="lui-overlay-button select-icon" qva-activate="openMediaLibrary()"\n\t\t\t\t\tq-title-translation="{{tooltip.select}}">\n\t\t\t\t<span class="lui-overlay-button__icon  lui-icon  lui-icon--image"></span>\n\t\t\t</button>\n\t\t\t<img ng-show="value" ng-src="{{mediaUrl}}" />\n\t\t\t<button ng-if="value && !readOnly" class="lui-overlay-button lui-overlay-button--small remove-icon"\n\t\t\t\tq-title-translation="{{tooltip.remove}}" qva-activate="save(null)">\n\t\t\t\t<span class="lui-overlay-button__icon  lui-icon  lui-icon--close  lui-icon--small"></span>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n</div>\n'},2764:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(2765)],o=function(e,t){var n={template:t,controller:["$scope",function(t){var n=function e(){return t.data};e.defineLabel(t,t.definition,n,t.args.handler);e.defineVisible(t,t.args.handler);e.defineChange(t,t.args.handler);e.defineValue(t,t.definition,n);e.defineCustom(t,t.definition,"currentSize");t.name="unique"+ +new Date;t.positions=["topLeft","centerLeft","bottomLeft","topCenter","centerCenter","bottomCenter","topRight","centerRight","bottomRight"];var i={fitWidth:["centerLeft","centerCenter","centerRight"],fitHeight:["topCenter","centerCenter","bottomCenter"],alwaysFit:["centerLeft","centerCenter","centerRight","topCenter","bottomCenter"]};t.isPosEnabled=function(e){return!i[t.currentSize]||-1!==i[t.currentSize].indexOf(e)};t.update=function(){t.$emit("saveProperties")};t.$watch("currentSize",function(e){if(i[e]&&-1===i[e].indexOf(t.value)){t.data.background.position="centerCenter";t.$emit("saveProperties")}})}]};return n}.apply(t,i),void 0!==o&&(e.exports=o))},2765:function(e,t){e.exports='<div class="pp-component pp-align-matrix" ng-if="visible" tcl="align-matrix">\n\t<div class="label" ng-if="label" title="{{label}}">{{label}}</div>\n\t<div class="matrix">\n\t\t<div ng-repeat="position in positions" ng-class="{ \'disabled\': !isPosEnabled(position) }" >\n\t\t\t<input ng-disabled="!isPosEnabled(position)" id="{{name}}-{{$index}}" type="radio" name="{{name}}" value="{{position}}" ng-model="value" ng-change="update()" />\n\t\t\t<label  for="{{name}}-{{$index}}"></label>\n\t\t</div>\n\t</div>\n</div>'},2766:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(1334),n(246),n(326),n(101)],o=function(e,t,n,i,o){var r=1000.12,a=.1234,s=new Date(2014,1,17,15,30,40);function l(e,t,l,u,c,d){var p,f,h={},g;p=t.concat(e.options||[]).filter(function(e){if(e.fmt in h)return false;h[e.fmt]=true;return true});p=p.map(function(e){var t,o,c;switch(e.type){case"D":c=new i(d,"","","","D");o=s;break;case"M":c=new n(d,"","","","M");o=r;break;default:c=new n(d,"","","","F");o=/%$/.test(e.fmt)?a:r;break}if(e.label)t="function"===typeof e.label?e.label.call(null,l,u,d):e.label;else{t=c.format(o,e.fmt,e.thousand,e.decimal);e.fmt.indexOf(";")>=0&&(t+="; "+c.format(-o,e.fmt,e.thousand,e.decimal))}return{value:e.fmt,label:t,type:e.type}});f=[o.getValue(l,"qDef.qNumFormat.qType","F")];p=p.filter(function(e){return f.contains(e.type)});c.splice(0,c.length);for(g=0;g<p.length;++g)c.push(p[g]);return p}function u(e,t){var n=[];e.qDateFmt&&n.push({fmt:e.qDateFmt});n.push({fmt:"YYYY-MM-DD"});n.push({fmt:"DD MM YYYY"});n.push({fmt:"DD MMM YYYY"});n.push({fmt:"DD MMMM YYYY"});n.push({fmt:"MM/DD/YYYY"});n.push({fmt:"MMMM DD, YYYY"});e.qTimestampFmt&&n.push({fmt:e.qTimestampFmt});n.push({fmt:"YYYY-MM-DD hh:mm:ss[.fff]"});e.qTimeFmt&&n.push({fmt:e.qTimeFmt});n.push({fmt:"hh:mm:ss"});n.push({fmt:"h:mm:ss tt"});n.forEach(function(e){e.type="D";t.push(e)})}function c(e,t){var n=[];e.qMoneyFmt&&n.push({fmt:e.qMoneyFmt,type:"M"});n.forEach(function(n){n.decimal=e.qMoneyDecimalSep;n.thousand=e.qMoneyThousandSep;t.push(n)})}function d(e,t){var n=[],i=e.qThousandSep,o=e.qDecimalSep||".";if(e.qThousandSep){n.push({fmt:"#"+i+"##0"});n.push({fmt:"#"+i+"##0"+o+"0"});n.push({fmt:"#"+i+"##0"+o+"00"})}else{n.push({fmt:"0"});n.push({fmt:"0"+o+"0"});n.push({fmt:"0"+o+"00"})}n.push({fmt:"0%"});n.push({fmt:"0"+o+"0%"});n.push({fmt:"0"+o+"00%"});n.forEach(function(e){e.decimal=o;e.thousand=i;e.type="F";t.push(e)})}function p(e,t){d(e,t);c(e,t);u(e,t)}var f={template:t,controller:["$scope",function(t){var n=function e(){return t.data},i=[];e.defineLabel(t,t.definition,n,t.args.handler);e.defineVisible(t,t.args.handler);e.defineChange(t,t.args.handler);e.defineReadOnly(t,t.args.handler);e.defineValue(t,t.definition,n);t.options=[];p(t.args.localeInfo,i);l(t.definition,i,t.data,t.args.handler,t.options,t.args.localeInfo);t.$watch("data",function(e){l(t.definition,i,e||t.data,t.args.handler,t.options,t.args.localeInfo)})}]};return f}.apply(t,i),void 0!==o&&(e.exports=o))},2767:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(2768),n(91),n(246),n(326),n(444)],o=function(e,t,n,i,o,r){var a,s,l,u,c,d=1000.12,p=new Date(2014,1,17,15,30,40),f=1.0453718171296298;function h(e,t){var n,i,o,r;switch(e.qDef.qNumFormat.qType){case"D":case"T":case"TS":r=s;n=p;break;case"IV":r=l;n=f;break;case"M":r=u;n=d;break;case"R":o=e.qDef.qNumFormat.qDec||".";i=e.qDef.qNumFormat.qThou;default:r=c;n=d;break}return r.format(n,"undefined"!==typeof t?t:e.qDef.qNumFormat.qFmt,i,o)}function g(e,t){e.qDef.qNumFormat.qFmt=r.getDefaultNumericFormat(e.qDef.qNumFormat,t)}function m(e,t,n){return e===r.getDefaultNumericFormat(t.qDef.qNumFormat,n)}a={template:t,controller:["$scope",function(t){var a=function e(){return t.data};var d=t.args.localeInfo;s=new o(d,"","","","D");l=new o(d,"","","","IV");u=new i(d,"","","","M");c=new i(d,"","","","F");e.defineLabel(t,t.definition,a,t.args.handler);e.defineVisible(t,t.args.handler);e.defineReadOnly(t,t.args.handler);e.defineChange(t,t.args.handler);e.defineValue(t,t.definition,a);u.thousandDelimiter=t.args.localeInfo.qMoneyThousandSep||"";u.decimalDelimiter=t.args.localeInfo.qMoneyDecimalSep||".";l.pattern=t.args.localeInfo.qTimeFmt;c.thousandDelimiter=t.args.localeInfo.qThousandSep||"";c.decimalDelimiter=t.args.localeInfo.qDecimalSep||".";t.onkeyup=function(e){t.$apply(function(){t.example=h(t.data,r.getNormalizedFormat(t.data.qDef.qNumFormat,e[0].value))})};t.example_title=n.get("properties.numberFormatting.example");function p(){t.example=h(t.data);t.resetting=false;t.isDefaultFormat=m(t.data.qDef.qNumFormat.qFmt,t.data,t.args.localeInfo);t.showReset="R"===t.data.qDef.qNumFormat.qType}t.reset=function(){if(!t.resetting){g(t.data,t.args.localeInfo);t.resetting=true;t.$emit("saveProperties")}};t.$watch("data",function(){p()});t.$on("datachanged",function(){p()});p()}]};return a}.apply(t,i),void 0!==o&&(e.exports=o))},2768:function(e,t){e.exports='<div class="pp-component pp-string-component" ng-if="visible" tcl="string">\n\t<div class="label" ng-if="label" title="{{label}}">{{label}}</div>\n\n\t<div class="value">\n\t\t<input type="text" class="lui-input" maxlength="{{definition.maxlength || 255}}" tid="{{key}}" spellcheck="false"\n\t\t\t   ng-model="value" ng-class="{ \'qui-invalid\': invalid }" ng-disabled="readOnly" ng-change="change()"\n\t\t\t   ng-model-options="{ updateOn: \'blur\', allowInvalid: true }" qva-model-onkeyup pp-input-validator/>\n\n\t</div>\n</div>\n<div class="pp-component pp-number-formatter-component">\n\t<div class="label">{{example_title}}</div>\n\t<div class="value">{{example}}</div>\n</div>\n<button class="lui-button pp-add-property" qva-activate="reset()" qv-enter="reset()" ng-disabled="isDefaultFormat || resetting"\n        ng-show="showReset" q-translation="{{definition.resetTranslation}}"></button>\n'},2769:function(e,t,n){"use strict";var i,o;!(i=[n(101),n(165),n(2770)],o=function(e,t,n){return{template:n,controller:["$scope",function(n){function i(){var i=n.definition;n.component=t.findComponent(i.item);n.itemDefinition=i.item;n.itemData=e.getValue(n.data,n.definition.ref)}n.$on("datachanged",function(){i()});n.$watch("data",function(){i()})}]}}.apply(t,i),void 0!==o&&(e.exports=o))},2770:function(e,t){e.exports='<div include-pp-component x-component="component" x-definition="itemDefinition" x-data="itemData" x-args="args"></div>\n'},2771:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(2772),n(209)],o=function(e,t){var n={template:t,controller:["$scope",function(t){var n=function e(){return t.data};e.defineLabel(t,t.definition,n,t.args.handler);e.defineVisible(t,t.args.handler);e.defineChange(t,n,t.args.handler);e.defineValue(t,t.definition,n)}]};return n}.apply(t,i),void 0!==o&&(e.exports=o))},2772:function(e,t){e.exports='<div class="pp-component pp-string-component pp-tags-component" ng-if="visible" tcl="tags">\n\t<div class="label" ng-if="label" title="{{label}}">{{label}}</div>\n\t<div class="tagcloudContainer">\n\t\t<qv-tagcloud tags="value" on-change="change()"></qv-tagcloud>\n\t</div>\n</div>\n'},2773:function(e,t,n){"use strict";var i,o;!(i=[n(91),n(121),n(423),n(120),n(2774)],o=function(e,t,n,i,o){function r(t){i.get(t.value).then(function(e){e.getLayout().then(function(e){var n=e&&e.labelExpression,i=e&&e.qMeta&&e.qMeta.title;t.title=n||i||""})}).catch(function(){t.title=e.get("properties.selectSheet")})}var a={template:o,controller:["$scope",function(i){var o=function e(){return i.data};i.$on("datachanged",function(){if(!i.data.sheetLink)return;i.value=i.data.sheetLink;r(i)});i.$on("sheetSelected",function(e,t){var n=t.qInfo.qId;if(i.value===n)return;i.value=n;i.$emit("saveProperties")});i.onSelectSheet=function(){n.onSelectSheet(i)};t.defineLabel(i,i.definition,o,i.args.handler);t.defineVisible(i,i.args.handler);t.defineReadOnly(i,i.args.handler);t.defineValue(i,i.definition,o);if(i.value)r(i);else{i.value="";i.title=e.get("properties.selectSheet")}}]};return a}.apply(t,i),void 0!==o&&(e.exports=o))},2774:function(e,t){e.exports='<div class="pp-component pp-dropdown-component" ng-if="visible" tcl="dropdown">\n    <div class="label" ng-if="label" title="{{label}}" ng-class="{ \'disabled\': readOnly }">{{label}}</div>\n\n\t<div class="value">\n\t\t<div qva-activate="onSelectSheet()" class="lui-select" qui-disabled="readOnly" qui-tid="{{key}}">\n\t\t\t<div class="select ng-pristine ng-valid" ng-class="{ \'qui-hover\': hover }" ng-mouseenter="hover = true" ng-mouseleave="hover = false" ng-disabled="readOnly" >\n\t\t\t\t{{title}}\n\t\t\t</div>\n\t\t\t<div class="arrow"></div>\n\t\t\t<div class="border"></div>\n\t\t</div>\n\n\t</div>\n</div>\n'},2775:function(e,t,n){"use strict";var i,o;!(i=[n(101),n(121),n(2776),n(165),n(160)],o=function(e,t,n,i,o){function r(e,t){if(!e.ref||t.filter(function(e){return!e.ref||!e.id}).length)throw new Error("Invalid input to attribute-expression-ref property component. Requires ref for component and ref for each item.")}function a(t,n){var i=o.getById(n,t.id)||{};return e.getValue(i,t.ref,void 0)}var s={template:n,controller:["$scope",function(n){var s=n.definition.items||{};var l;var u=n.definition.ref;r(n.definition,s);function c(){n.innerData=[];var t=e.getValue(n.data,u,[]);n.items=Object.keys(s).filter(function(e,i){var o=s[e];n.innerData[i]=n.innerData[i]||{};n.innerData[i][o.ref]=a(o,t);n.innerData[i].id=o.id;if("function"===typeof o.show)return o.show(n.data,n.args.handler,n.args);if("boolean"===typeof o.show)return o.show;return true}).map(function(e){var t=s[e];return{component:i.findComponent(t),definition:t,key:e}});l||(l=n.$watch("innerData",function(){var t=e.getValue(n.data,u,[]);var i=t.length;var r=false;var l=[];s.forEach(function(i,s){var u=e.getValue(n.innerData[s],i.ref,null);var c=a(i,t);var d=o.getIndexById(t,i.id);if(null!==u&&""!==u){if(-1===d){t.push(n.innerData[s]);d=t.length-1;r=true}else if(u!==c){r=true;t[d][i.ref]=n.innerData[s][i.ref]}l[d]=true}else-1!==d&&delete t[d][i.ref]});for(var c=t.length-1;c>=0;c--)true!==l[c]&&t.splice(c,1);t=o.clean(t);r=r||i!==t.length;e.setValue(n.data,u,t);r&&n.change()},true))}n.$on("datachanged",function(){c()});n.$watch("data",function(){c()});n.$on("saveProperties",function(e){e.targetScope!==n&&e.stopPropagation()});t.defineVisible(n,n.args.handler);t.defineChange(n,n.args.handler)}]};return s}.apply(t,i),void 0!==o&&(e.exports=o))},2776:function(e,t){e.exports='<div class="pp-component pp-attr-ref-component" ng-if="visible" tcl="items">\n\t<div ng-repeat="item in items track by item.key" tid="{{item.definition.tid}}" class="item">\n\t\t<div include-pp-component x-component="item.component" x-definition="item.definition" x-data="innerData[$index]" x-args="args"></div>\n\t</div>\n</div>'},2777:function(e,t,n){"use strict";var i,o;!(i=[n(11),n(96),n(91),n(121),n(2778),n(402),n(321),n(130),n(150),n(1814),n(1815),n(2779)],o=function(e,t,n,i,o,r,a,s,l,u,c,d){var p={template:o,controller:["$scope","$element","luiPopover",function(o,p,f){var h=function e(){return o.data},g="dimension"===o.definition.libraryItemType,m=g?o.args.app.getDimensionList:o.args.app.getMeasureList,v=g?s.findLibraryDimension:s.findLibraryMeasure,b=g?u.showBreakLinkDialog:c.showBreakLinkDialog,x=g?a:r,y,C;o.adding=false;o.inputData={label:n.get(o.definition.translation)};o.breakLinkTooltip=g?"Dimension.Unlink":"Measure.Unlink";o.selectLibraryItemTooltip=g?"properties.colorBy.selectDimension":"properties.colorBy.selectMeasure";function q(){if(y){y.close();y=null}C&&t.preventGestures();o.adding=false;C=null}function D(e){if(!e)return;if(e.activeDimensionIndex>-1){o.inputData.label=n.get("properties.colorBy.currentDimension",e.activeDimensionIndex+1);o.linked=false;o.disableInput=true}else if(e.activeMeasureIndex>-1){o.inputData.label=n.get("properties.colorBy.currentMeasure",e.activeMeasureIndex+1);o.linked=false;o.disableInput=true}else if(e.key){o.disableInput=false;if("libraryItem"===e.type)m.call(o.args.app).then(function(t){var i=v(e.key,t);if(i){o.inputData.label=i.qData.title;o.linked=true}else{o.inputData.label=n.get(g?"Object.ErrorMessage.MissingDimension":"Object.ErrorMessage.MissingMeasure");o.linked=false;o.definition.change(o.data,o.args.handler,{libraryId:void 0,value:""})}o.invalid=!i});else{o.inputData.label=o.value.key&&"="===o.value.key.charAt(0)?o.value.key.substr(1):o.value.key;o.linked=false;o.definition.change(o.data,o.args.handler,{libraryId:void 0,value:o.inputData.key})}}}function w(e){var t;o.definition.change&&(t=o.definition.change(o.data,o.args.handler,e));if(t&&t.then)t.then(function(){o.$emit("saveProperties");q()});else{o.$emit("saveProperties");q()}}function I(e,t){if(t.activeDimensionIndex>=0)return e.value.activeDimensionIndex===t.activeDimensionIndex;if(t.activeMeasureIndex>=0)return e.value.activeMeasureIndex===t.activeMeasureIndex}function S(e){var t,n,i="";if(e.libraryId){t=e.libraryId;n="libraryItem"}else{t=e.value;n="expression"}if(o.value.key===t&&o.value.type===n&&I(o,e)){q();return}if(o.linked&&"libraryItem"===o.value.type&&"expression"===n)i=e.label||"";else{var r=e.value&&"="===e.value.charAt(0)?e.value.substr(1):e.value;i=o.value.label===o.value.key?r:o.value.label}o.value={label:i,key:t,type:n};e.activeDimensionIndex>=0?o.value.activeDimensionIndex=e.activeDimensionIndex:e.activeMeasureIndex>=0&&(o.value.activeMeasureIndex=e.activeMeasureIndex);w(e)}function L(e,t){var i=e>-1?n.get("properties.colorBy.currentDimension",e+1):"";var r=t>-1?n.get("properties.colorBy.currentMeasure",t+1):"";return i.length>0?i:r.length>0?r:o.value.key}o.$watch("value",function(e){"libraryItem"===e.type&&e.label!==e.key&&(o.inputData.label=e.label);D(o.value)});o.onEnter=function(){if(!o.adding){o.adding=true;S({libraryId:void 0,value:o.inputData.label})}e(p[0].getElementsByClassName("lui-input")[0]).blur()};o.onBlur=function(){if(!o.adding){o.adding=true;S({libraryId:void 0,value:o.inputData.label})}};o.onKeyUp=function(t){if(27===t.keyCode){o.inputData.label=o.value.label;e(p[0].getElementsByClassName("lui-input")[0]).blur()}};o.breakLink=function(){var e={qLibraryId:o.value.key,qDef:{}};b(e).then(function(){S({libraryId:void 0,label:g?e.qDef.qFieldLabels[0]:e.qDef.qLabel,value:g?d(e.qDef.qFieldDefs[0],true):e.qDef.qDef});o.linked=false})};o.editExpression=function(){l.show({expr:L(o.value.activeDimensionIndex,o.value.activeMeasureIndex),title:"Dimension.Expression.Dialog.Edit.Title"}).then(function(e){S({libraryId:void 0,value:d(e)})})};o.onSelectLibraryItem=function(e){function t(e){e.value=d(e.value,!!e.label);o.linked=false;S(e)}function n(e){o.disableInput=true;o.linked=false;S(e)}function i(e){o.disableInput=true;o.linked=false;S(e)}if(o.adding){q();return}o.adding=true;C=e.target;var r={template:x.template,controller:x.controller,input:{app:o.args.app,closeAddPopover:q,allowExpressionEditor:true,activeMeasures:o.args.handler.getMeasures(),activeDimensions:o.args.handler.getDimensions()},alignTo:C,dock:"bottom"};if(g){r.input.addFieldDimension=t;r.input.addLibraryDimension=S;r.input.addActiveDimension=i}else{r.input.addLibraryMeasure=S;r.input.addExpressionMeasure=S;r.input.addActiveMeasure=n}y=f.show(r);y.closing.then(function(e){e&&!(e.target.classList.contains("lui-button")||e.target.classList.contains("lui-caret")||e.target.classList.contains("lui-input-group__item")||e.target.classList.contains("lui-input-group__button"))&&(o.adding=false)})};i.defineVisible(o,o.args.handler);i.defineReadOnly(o,o.args.handler);i.defineValue(o,o.definition,h);i.defineLabel(o,o.definition,h,o.args.handler)}]};return p}.apply(t,i),void 0!==o&&(e.exports=o))},2778:function(e,t){e.exports='<div class="pp-component pp-colorby-component" ng-if="visible" tcl="string">\n\t<div class="label" ng-if="label" title="{{label}}">{{label}}</div>\n\n\t<div class="value">\n\t\t<div class="lui-input-group">\n\t\t\t<input class="lui-input lui-input-group__item lui-input-group__input" ng-disabled="linked || disableInput" qva-focus="autoFocus" qv-enter="onEnter()" qva-blur="onBlur()" ng-keyup="onKeyUp($event)" maxlength="255"\n\t\t\t\t   ng-model="inputData.label" type="text" />\n\t\t\t<button ng-if="linked" class="lui-button lui-input-group__item lui-input-group__button" q-title-translation="{{breakLinkTooltip}}" ng-click="breakLink()">\n\t\t\t\t<span class="lui-button__icon lui-icon lui-icon--link"></span>\n\t\t\t</button>\n\t\t\t<button ng-if="!linked && !disableInput" class="lui-button lui-input-group__item lui-input-group__button" q-title-translation="Tooltip.OpenExpressionEditor" ng-click="editExpression()">\n\t\t\t\t<span class="lui-button__icon lui-icon lui-icon--expression edit-expression"></span>\n\t\t\t</button>\n\t\t\t<button class="lui-button lui-caret lui-input-group__item lui-input-group__button" ng-click="onSelectLibraryItem($event)" q-title-translation="{{selectLibraryItemTooltip}}" ng-class="{\'lui-active\': adding === true}"></button>\n\t\t</div>\n\t</div>\n</div>'},2779:function(e,t,n){"use strict";var i,o;!(i=[],o=function(){function e(e){return"="===e.charAt(0)?e:"="+e}function t(e){return e.split(" ").length>1&&"="!==e.charAt(0)&&"["!==e.charAt(0)?"["+e+"]":e}return function(n,i){return e(i?t(n):n)}}.apply(t,i),void 0!==o&&(e.exports=o))},2780:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(2781),n(100),n(101)],o=function(e,t,n,i){var o={template:t,controller:["$scope",function(t){var o=function e(){return t.data};t.colors=[];function r(){var e=t.args.handler.layout.qHyperCube.qMeasureInfo;t.colors=e.filter(function(e){return i.getValue(e,"coloring.baseColor.color")||i.getValue(e,"baseColor.color")}).map(function(e){if(e.coloring&&e.coloring.baseColor)return n.resolveColor(e.coloring.baseColor);return n.resolveColor(e.baseColor)})}t.$on("datachanged",function(){r()});t.$watch("data",function(){r()});e.defineLabel(t,t.definition,o,t.args.handler);e.defineVisible(t,t.args.handler);e.defineReadOnly(t,t.args.handler);e.defineChange(t,t.args.handler);e.defineValue(t,t.definition,o)}]};return o}.apply(t,i),void 0!==o&&(e.exports=o))},2781:function(e,t){e.exports='<div class="pp-component pp-selection-list-component pp-measure-color-component" ng-if="visible" >\r\n\t<div class="label" ng-if="label">\r\n\t\t<div class="title" title="{{label}}">{{label}}</div>\r\n\t</div>\r\n\t<div class="pp-measure-color-colors-wrapper">\r\n\t\t<div class="pp-measure-color-color" ng-repeat="color in colors track by $index" ng-style="{\'background-color\': color}"></div>\r\n\t</div>\r\n</div>\r\n\r\n\r\n\r\n'},2782:function(e,t,n){"use strict";var i,o;function r(e){r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return r(e)}!(i=[n(90),n(121),n(101),n(107),n(191),n(150),n(2783),n(2784),n(2785)],o=function e(t,n,i,o,a,s,l,u,c){var d={template:u,controller:["$scope","luiPopover",p]};return d;function p(e,u){V(e);var d,p=null,f=27,h;var g={expressionRef:e.definition.expressionRef,elementRef:e.definition.elementRef,getElements:q()};n.defineChange(e,e.args.handler);n.defineVisible(e,e.args.handler);Object.defineProperty(e,"expression",{get:function t(){var n=i.getValue(e.data,g.expressionRef,"");n&&"object"===r(n)&&(n=n.qValueExpression.qExpr);return n},set:function t(n){var o={qValueExpression:{qExpr:n}};i.setValue(e.data,g.expressionRef,o)}});e.selectedElement=void 0;e.isLinked=true;e.isExpressionValid=true;Object.defineProperty(e,"MAX_LENGTH",{value:o.name,writable:false,configurable:false});e.unlink=I;e.onExpressionBlur=S;e.onKeyUp=L;e.onExpressionActivate=E;e.onExpressionEnter=M;e.openElementsPopover=_;e.isElementsPopoverOpen=A;e.openExpressionDialog=k;e.shouldForceEditInExpressionEditor=T;e.shouldShowEditInExpressionEditorMessage=O;var m=new a.ExpressionValidator(e.args.app),v=function t(n){e.isExpressionValid=n.valid};m.Update.bind(v);var b=new a.ExpressionValidator(e.args.app),x=function t(n){e.isExpressionValid=n.valid;e.change()};b.Update.bind(x);e.$on("$destroy",function(){m.Update.unbind(v);b.Update.unbind(x)});e.$on("datachanged",y);C();function y(t,n){e.data=n;C()}function C(){var n=g.getElements();function i(){var n=t.getValue(e.data,g.elementRef);if(!n){h=e.expression;e.isLinked=false;m.validate(e.expression);return}var i=D(n);i||R("No matching element found");w(i)}if("function"===typeof n.then)n.then(function(e){d=e;i()});else{d=n;i()}}function q(){var n=t.isFunction(e.definition.elements);return n?function t(){return e.definition.elements(e.args)}:function t(){return e.definition.elements}}function D(e){var t=d.filter(function(t){return t.id===e});return t.length>0?t[0]:null}function w(t){e.selectedElement=t;e.expression=t.exp;h=t.exp;e.isLinked=true}function I(){e.isLinked=false;e.selectedElement=void 0;t.setValue(e.data,g.elementRef,void 0);e.change()}function S(){if(!e.expression){e.expression=h;return}b.validate(e.expression);h=e.expression}function L(t){if(t.keyCode!==f)return;e.expression=h;l.blur(t.target)}function E(t){if(!T())return;l.blur(t.target);e.openExpressionDialog()}function M(e){l.blur(e.target)}function _(n){if(A()){P();return}var i={template:c,input:{elements:d,getSelectedElement:function t(){return e.selectedElement},onElementChanged:function n(i){w(i);t.setValue(e.data,g.elementRef,i.id);e.change();P()}},alignTo:n.target,dock:"bottom",closeOnResize:true,closeOnOutside:true};p=u.show(i);p.closing.then(function(e){l.clickedOnDropdownButton(e)&&(p=null)})}function A(){return!!p}function P(){if(!A())return;p.close();p=null}function k(){var t={expr:e.expression,title:e.expression?"Dimension.Expression.Dialog.Edit.Title":"Dimension.Expression.Dialog.Add.Title"};s.show(t).then(function(t){e.expression=t;e.change()})}function T(){return e.expression.length>e.MAX_LENGTH}function O(){return!e.isLinked&&T()}function V(e){e.args||H("args");e.args.handler||H("args.handler");e.data||H("data");e.definition||H("definition");e.definition.expressionRef||H("definition.expressionRef");e.definition.elementRef||H("definition.elementRef");e.definition.elements||H("definition.elements")}function H(e){R("Required data missing: $scope."+e)}function R(e){throw new Error("Component: SortByElement - "+e)}}}.apply(t,i),void 0!==o&&(e.exports=o))},2783:function(e,t,n){"use strict";var i,o;!(i=[n(11)],o=function e(t){var n={blur:i,clickedOnDropdownButton:o};return n;function i(e){t(e).blur()}function o(e){return e&&!t(e.target).closest(".pp-sortbyelement-dd-button").length>0}}.apply(t,i),void 0!==o&&(e.exports=o))},2784:function(e,t){e.exports='<div class="pp-component pp-string-component pp-sortbyelement-component" ng-if="visible" tcl="sort-by-element">\n\t\n\t<div class="value">\n\t\t<div class="lui-input-group">\n\n\t\t\t\x3c!-- Input for element --\x3e\n\t\t\t<input class="lui-input lui-input-group__item lui-input-group__input" \n\t\t\t\ttype="text"\n\t\t\t\ttitle="{{selectedElement.label}}"\n\t\t\t\tspellcheck="false"\n\t\t\t\tmaxlength="{{maxLength}}" \n\t\t\t\tng-if="isLinked" \n\t\t\t\tng-disabled="true"\n\t\t\t\tng-model="selectedElement.label" />\n\n\t\t\t\x3c!-- Input for expression --\x3e\n\t\t\t<input class="lui-input lui-input-group__item lui-input-group__input pp-sortbyelement-expression" \n\t\t\t\ttype="text"\n\t\t\t\tspellcheck="false"\n\t\t\t\tmaxlength="{{maxLength}}"\n\t\t\t\tng-if="!isLinked"\n\t\t\t\tng-readonly="isLocked()"\n\t\t\t\tng-class="{ \'lui-invalid\': !isExpressionValid, \'force-editor\': shouldForceEditInExpressionEditor() }" \n\t\t\t\tng-model="expression" \n\t\t\t\tqv-enter="onExpressionEnter($event)" \n\t\t\t\tqva-blur="onExpressionBlur()"\n\t\t\t\tng-keyup="onKeyUp($event)"\n\t\t\t\tqva-activate="onExpressionActivate($event)" />\n\n\t\t\t\x3c!-- Button for unlinking --\x3e\n\t\t\t<button class="lui-button lui-input-group__item lui-input-group__button" \n\t\t\t\tng-if="isLinked"\n\t\t\t\tq-title-translation="properties.boxplot.sorting.unlink"\n\t\t\t\tqva-activate="unlink()">\t\t\t\t\n\n\t\t\t\t<span class="lui-button__icon lui-icon lui-icon--link"></span>\n\t\t\t</button>\n\n\t\t\t\x3c!-- Button for opening expression editor --\x3e\n\t\t\t<button class="lui-button lui-input-group__item lui-input-group__button" \n\t\t\t\tng-if="!isLinked" \n\t\t\t\tq-title-translation="Tooltip.OpenExpressionEditor"\n\t\t\t\tqva-activate="openExpressionDialog()">\n\n\t\t\t\t<span class="lui-button__icon lui-icon lui-icon--expression edit-expression active"></span>\n\t\t\t</button>\n\n\t\t\t\x3c!-- Button for opening elements popover --\x3e\n\t\t\t<button class="lui-button lui-input-group__item lui-input-group__button pp-sortbyelement-dd-button" \n\t\t\t\tng-class="{\'lui-active\': isElementsPopoverOpen() }"\n\t\t\t\tq-title-translation="properties.boxplot.sorting.selectElement"\n\t\t\t\tqva-activate="openElementsPopover($event)">\n\n\t\t\t\t<span class="lui-caret"></span>\n\t\t\t</button>\n\n\t\t</div>\n\t</div>\n\n\t<div ng-if="shouldShowEditInExpressionEditorMessage()" class="hint" q-translation="properties.editInExpressionEditor"></div>\n\t\n</div>'},2785:function(e,t){e.exports='<lui-popover class="add-popover-wrapper pp-sortbyelement-popover">\n\t<div class="lui-popover__body lui-popover__body lui-nopad">\n\t\t<ul class="lui-list">\n\t\t\t<li class="lui-list__item" \n\t\t\t\tng-repeat="element in elements" \n\t\t\t\tng-class="{ \'lui-active\': element === getSelectedElement() }"\n\t\t\t\tng-click="onElementChanged(element)">\n\n\t\t\t\t<span class="lui-list__text lui-list__action">{{element.label}}</span>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</lui-popover>'},2786:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(2787)],o=function e(t,n){var i={template:n,controller:["$scope",o]};return i;function o(e){t.defineVisible(e,e.args.handler)}}.apply(t,i),void 0!==o&&(e.exports=o))},2787:function(e,t){e.exports='<div class="pp-component pp-nodata-component" ng-if="visible" tcl="nodata">\n\t<span q-translation="Common.NoData"></span>\n</div>'},2788:function(e,t,n){"use strict";var i,o;!(i=[n(165),n(101),n(461),n(2789)],o=function(e,t,n,i){var o={template:i,controller:["$scope",function(i){var o={expr:{ref:"cond",type:"string",component:"expression",expressionType:"ValueExpr",translation:"properties.hyperCube.calcCond",change:i.definition.condChange},customErrorMessage:{ref:"msg",component:"expression",defaultValue:"",type:"string",expressionType:"StringExpr",expression:"optional",placeholderTranslation:"Object.ErrorMessage.CalculationCondition",translation:"properties.hyperCube.calcCondMessage",show:function e(n){var i=t.getValue(n,"cond");return i.qv&&""!==i.qv},change:i.definition.msgChange}};i.items=Object.keys(o).map(function(t){var n=o[t];return{component:e.findComponent(n),definition:n,key:t}});function r(){if(i.definition.ref)return t.getValue(i.data,i.definition.ref);return i.data}i.newData={};Object.defineProperty(i.newData,"cond",{get:function e(){var t=r();var o=n.getPropCondition(t,i.definition.oldCondRef);return{qv:o}},set:function e(t){var o=r();n.setPropCondition(o,t.qv,i.definition.oldCondRef)}});Object.defineProperty(i.newData,"msg",{get:function e(){var t=r();var i=n.getPropMessage(t);return{qv:i}},set:function e(t){var i=r();n.setPropMessage(i,t.qv)}})}]};return o}.apply(t,i),void 0!==o&&(e.exports=o))},2789:function(e,t){e.exports='<div class="pp-component pp-items-component" tcl="items">\n\t<div ng-repeat="item in items track by item.key" tid="{{item.key}}" class="item" ng-class="{ \'grouped\': definition.grouped }">\n\t\t<div include-pp-component x-component="item.component" x-definition="item.definition" x-data="newData" x-args="args"></div>\n\t</div>\n</div>'},2790:function(e,t,n){"use strict";var i,o;!(i=[n(165),n(121),n(2791),n(91),n(90),n(101)],o=function(e,t,n,i,o,r){var a={template:n,controller:["$scope",function(n){var a="pp-options-list-"+o.generateId();var s=l();n.def=s;u();p(n.value);function l(){var e={showValue:false,valueTranslation:"{0}",horizontal:false,boldLabelForSelect:false,itemBorder:true,optionsRadius:3,optionsSpacing:0,optionsBoldSelect:true,labelDisclaimer:null};return o.extend(true,{},e,n.definition)}function u(){var e=function e(){return n.data};t.defineVisible(n,n.args.handler);t.defineReadOnly(n,n.args.handler);t.defineValue(n,s,e)}function c(){var e={component:"image-item",labelPlacement:"bottom",width:"100%"};var t="function"===typeof s.options?s.options(n.data):s.options;if(!t||!t.length)throw TypeError("No options returned/not specified in definition of options-list");return t.map(function(t){t.translation=i.get(t.translation);return o.extend(true,{},e,t)})}function d(e){var t=c();if(!t||!t.length)throw new Error("no items");var n=t.filter(function(t){return t.value===e})[0];return n}n.getItemFromValue=d;function p(e){if(!s.showValue)return;var t=d(e)||{};var o=t.translation||"";var r=i.get(o);var a=i.get(s.valueTranslation);n.valueLabel=a.replace(/\{0\}/g,r)}function f(e){e.id=e.id||a;e.triggerId="addLayer";n.$root.$emit("showSubPanel",e)}function h(){n.$root.$emit("hideSubPanel",{id:a})}n.showSubPanelWithOptions=function(){n.$root.$emit("showSubPanel",{id:a,triggerId:"propertyPanel",title:i.get(s.title),definition:g()})};if(s.entryComponentDefinition){n.entryComponentDefinition=s.entryComponentDefinition;n.entryButtonComponent=e.findComponent(n.entryComponentDefinition);n.entryComponentDefinition.src=d(n.value).src}function g(){var e={ref:s.ref,type:s.type,component:"item-selection-list",itemsRadius:s.optionsRadius,itemsSpacing:s.optionsSpacing,itemsBoldSelect:s.optionsBoldSelect,horizontal:s.horizontal,defaultValue:s.defaultValue,boldSelectLabel:s.boldSelectLabel,label:i.get(s.optionsLabel),itemBorder:s.itemBorder,items:c(),change:function e(t){var i=r.getValue(t,s.ref);p(i);h();"function"===typeof s.change&&s.change.apply(null,[].concat.apply([],arguments).concat(f));var o=d(i);n.entryComponentDefinition&&(n.entryComponentDefinition.src=o.src)}};return e}function m(){if(s.entryComponentDefinition){n.entryComponentDefinition=s.entryComponentDefinition;n.entryComponentDefinition.src=d(n.value).src}}n.label=i.get(s.translation);n.labelDisclaimer=i.get(s.labelDisclaimer);n.$watch("data."+s.ref,m.bind(this))}]};return a}.apply(t,i),void 0!==o&&(e.exports=o))},2791:function(e,t){e.exports='<div class="pp-component pp-options-list-component" ng-if="visible" tcl="item-options-list">\n\t\n\t<div class="label value" ng-if="def.showValue && value">\n\t\t\t<span>{{ valueLabel }}</span>\n\t</div>\n\n\t<div qva-activate="showSubPanelWithOptions()" class="button-wrapper">\n\t\t<button ng-if="!entryComponentDefinition" ng-disabled="readOnly" class="lui-button pp-add-property ng-binding entry-button" title="{{ label }}">\n\t\t\t{{ label }}\n\t\t</button>\n\n\t\t<div ng-if="entryComponentDefinition" ng-disabled="readOnly" class="entry-button entry-button-component" title="{{ def.label }}">\n\t\t\t<div include-pp-component x-component="entryButtonComponent" x-definition="entryComponentDefinition" x-data="data" x-args="args"></div>\n\t\t</div>\n\t</div>\n\n\t<div ng-show="def.labelDisclaimer" class="label disclaimer">\n\t\t<span>{{ labelDisclaimer }}</span>\n\t</div>\n\n</div>'},2792:function(e,t,n){"use strict";var i,o;!(i=[n(2793),n(2794),n(165),n(128),n(91),n(90),n(89),n(94),n(49),n(157)],o=function(e,t,n,i,o,r,a,s,l,u){var c={template:e,controller:["$scope","qvConfirmDialog",function(e,c){e.disableAutoChart=l.getFlag("DISABLE_AUTO_CHART")||u.isVariableDefined("DISABLE_AUTO_CHART");"sheet"===e.data.qInfo.qType?e.visible=false:e.visible=true;var d=e.data.visualization;i.getGrid()&&(e.data=i.getGrid().activeCell||i.getGrid().zoomCell||{});e.data.autoMode="auto-chart"===d;e.label=r.getValue(e.data,"model.layout.title","");e.iconName=e.args.iconName;var p={title:o.get("ToAutoChart.Dialog.Header"),message:o.get("ToAutoChart.Dialog.Content1")+"<div class='sub-body'>"+o.get("ToAutoChart.Dialog.Content2")+"</div>",okLabel:o.get("Common.Apply")};var f=function t(n){var i;var o;if(e.data.autoMode){if(n){i=!!e.data.model&&(!e.data.model.layout.qUndoExclude||!e.data.model.layout.qUndoExclude.generated);o=!!(e.data.model&&e.data.model.layout&&e.data.model.layout.qHyperCube)&&(0===e.data.model.layout.qHyperCube.qDimensionInfo.length&&0===e.data.model.layout.qHyperCube.qMeasureInfo.length)}else{i=!!e.data.model&&(!e.data.model.properties.qUndoExclude||!e.data.model.properties.qUndoExclude.generated);o=!!(e.data.model&&e.data.model.properties&&e.data.model.properties.qHyperCubeDef)&&(0===e.data.model.properties.qHyperCubeDef.qDimensions.length&&0===e.data.model.properties.qHyperCubeDef.qMeasures.length)}return i||o}function r(){return e.data.model&&"widget"===e.data.model.layout.visualization}function a(){return e.data.object&&e.data.object.ext&&(e.data.object.ext.data.dimensions||e.data.object.ext.data.measures)}var s=!!e.data.model&&(!!e.data.model.layout.extensionMeta&&e.data.model.layout.extensionMeta.isThirdParty);var l=!!e.data.object&&(!!e.data.object.ext&&!!e.data.object.ext.importProperties&&!!e.data.object.ext.exportProperties);if(r())return!a();return!l||s};e.shouldHideToggleSwitch=f();var h=o.get("ChartSuggestion.Header");e.switchComponent={component:n.findComponent({type:"items",component:"switch"}),definition:{ref:"autoMode",type:"boolean",component:"switch",defaultValue:"auto-chart"===d,options:[{value:true,label:h},{value:false,label:h}],label:function t(){var n=r.getValue(e.data,"model.layout.showTitles",false),i=n?r.getValue(e.data,"model.layout.title",e.label):"";return i},inverse:!l.getFlag("BRIGHT_THEME"),show:e.visible,shouldUpdateTitle:true,context:"header",change:function n(){var o=new a;var r=i.getGrid().activeCell||i.getGrid().zoomCell;if(r){var s=r.model;var l=e.data.autoMode?t.convertToAutoChart:t.convertToGenericChart;e.shouldHideToggleSwitch=f();l(s).then(function(){o.resolve(false)})}else o.resolve(false);return o.promise},interceptor:function e(){return c.show(p).closed},interceptorPredicate:function e(t){return t}},data:e.data,args:e.args};e.$on("layoutchanged",function(t,n){(n.title||""===n.title)&&(e.label=n.showTitles?n.title:"");e.shouldHideToggleSwitch=f(true)});if(s.view===s.Views.masterObject){e.switchComponent.definition.show=false;e.visible=false}}]};return c}.apply(t,i),void 0!==o&&(e.exports=o))},2793:function(e,t){e.exports='<div class="pp-component pp-header-parent-link" ng-if="args.headerLabel">\n\t<div class="property-sub-header" ng-click="args.headerAction()">\n\t\t<div class="header-wrapper">\n\t\t\t<div class="back-navigation">\n\t\t\t\t<span class="lui-icon back-icon  lui-icon--previous  lui-icon--small"></span>\n\t\t\t</div>\n\t\t\t<div class="text-wrapper">\n\t\t\t\t<div class="navigation-title">{{args.headerLabel}}</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n<div class="pp-component pp-header-with-switch-component" tid="assistance-header" tcl="switch">\n\t<div class="header-with-switch-icon">\n\t\t<span class="type-icon lui-icon lui-icon--{{iconName}}"></span>\n\t</div>\n\t<div class="switch-container" ng-if="!disableAutoChart">\t\t\t\n\t\t\t<div class="label" ng-if="label" ng-show="shouldHideToggleSwitch" title="{{label}}">\n\t\t\t\t{{label}}\n\t\t\t</div>\n\t\t\t<div ng-hide="shouldHideToggleSwitch" \n\t\t\t\t include-pp-component \t\t\t\t\n\t\t\t\t x-component="switchComponent.component" \n\t\t\t\t x-definition="switchComponent.definition" \n\t\t\t\t x-data="switchComponent.data" \n\t\t\t\t x-args="switchComponent.args"></div>\t\t\n\t</div>\n</div>\n'},2794:function(e,t,n){"use strict";var i,o;!(i=[n(115),n(406)],o=function(e,t){function n(e){e.properties.qUndoExclude.generated.qStateName=e.properties.qStateName;return e.setFullPropertyTree({qProperty:e.properties.qUndoExclude.generated,qChildren:[]}).then(function(){return e})}function i(n){var i=n.layout.visualization;var o="auto-chart";return e.getType(i).getExtensionType().then(function(e){return t.convertChart(e,o,n)})}return{convertToAutoChart:i,convertToGenericChart:n}}.apply(t,i),void 0!==o&&(e.exports=o))},2795:function(e,t,n){"use strict";var i,o;!(i=[n(91),n(124),n(115),n(121),n(2796),n(450),n(406),n(114)],o=function(e,t,n,i,o,r,a,s){var l={template:o,controller:["$scope","$element",function(o,l){var u,c=l.find(".wrapper"),d=function e(){return o.data};i.defineLabel(o,o.definition,d,o.args.handler);i.defineCustom(o,o.definition,"app");i.defineCustom(o,o.definition,"type");i.defineCustom(o,o.definition,"properties");i.defineCustom(o,o.definition,"currentType");i.defineCustom(o,o.definition,"recommended");o.selected=o.type===o.currentType;t.load().then(function(){o.title=e.get(n.getType(o.type).getLibraryInfo().translationKey)});var p={isReadonly:true,isPopover:false,selectionsDisabled:true,interactionState:0,components:{miniChart:{show:false},xAxisTitle:{show:false},yAxisTitle:{show:false},scrollArea:{showFlag:0}},direction:s.direction};o.changeChartType=function(){return o.args.model.getProperties().then(function(e){o.recommended?delete e.preferredChart:e.preferredChart=o.type;delete e.qUndoExclude.hashCode;o.args.model.setProperties(e)})};function f(){u&&u.resize()}function h(e,t){return a.createChart(e,t,false).then(function(e){u=new r(t,e)})}h(o.properties,o.app).then(function(){u.show(c,p)});o.$on("ppAccordionNewPath",function(){f()});f()}]};return l}.apply(t,i),void 0!==o&&(e.exports=o))},2796:function(e,t){e.exports='<div \n    class="pp-component pp-chart-type-component"    \n    tcl="chart-type" \n    qva-activate="changeChartType()">\n\n    <div class="wrapper item-border item-interaction" ng-class="{ \'selected\': selected }"></div>\n    <div class="title" ng-class="{ \'bold\': selected }">{{title}}</div>\n</div>'},2797:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(2798)],o=function(e,t){var n={template:t,controller:["$scope",function(t){var n=function e(){return t.data};e.defineLabel(t,t.definition,n,t.args.handler);e.defineCustom(t,t.args.handler,"action");e.defineCustom(t,t.args.handler,"title");e.defineCustom(t,t.args.handler,"subTitle");e.defineCustom(t,t.args.handler,"icon");t.definition&&t.definition.disabled&&Object.defineProperty(t,"disabled",{get:function e(){return t.definition.disabled(t.data,t.args.handler,t.args)}})}]};return n}.apply(t,i),void 0!==o&&(e.exports=o))},2798:function(e,t){e.exports='<div class="pp-component pp-icon-button-component"  tcl="icon-button">\n    <button class="icon-button" ng-disabled="disabled" ng-click="action();">\n        <span class="lui-list__aside">\n            <span class="lui-icon icon-wrapper">{{icon}}</span>\n        </span>\n        <span class="lui-list__aside text-wrapper">\n            <span class="lui-list__text button-title">{{title}}</span>\n            <span class="lui-list__text button-sub-title">{{subTitle}}</span>\n        </span>\n        <span class="lui-list__aside" ng-if="!disabled">\n            <span class="lui-icon lui-icon--small lui-icon--arrow-right icon-arrow"></span>\n        </span>\n    </button>\n</div>'},2799:function(e,t,n){"use strict";var i,o;!(i=[n(101),n(121),n(2800),n(54),n(501)],o=function(e,t,n,i){var o={template:n,controller:["$scope",function(n){var o=function e(){return n.data};t.defineLabel(n,n.definition,o,n.args.handler);t.defineVisible(n,n.args.handler);t.defineReadOnly(n,n.args.handler);t.defineChange(n,n.args.handler);t.defineValue(n,n.definition,o);n.value=n.value||{};n.value.colors=e.getValue(n,"value.colors",n.definition.colors);n.value.limits=e.getValue(n,"value.limits",n.definition.limits);n.value.types=e.getValue(n,"value.types",n.definition.types);n.value.minMax=e.getValue(n,"value.minMax",n.definition.minMax);n.value.percentage=e.getValue(n,"value.percentage",n.definition.percentage);var r=i.debounce(function(){n.change()},300);n.$watch("value",function(){r()},true);n.change()}]};return o}.apply(t,i),void 0!==o&&(e.exports=o))},2800:function(e,t){e.exports='<div class="pp-component pp-palette-creator" ng-if="visible" tcl="palette-creator">\n\t<qv-palette-creator colors="value.colors" min-max="value.minMax" percentage="value.percentage" limits="value.limits" types="value.types"></qv-palette-creator>\n</div> '},2801:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(2802),n(91),n(90)],o=function(e,t,n,i){var o={template:t,controller:["$scope",function(t){var o="pp-style-editor-"+i.generateId();var r=function e(){return t.data};e.defineLabel(t,t.definition,r,t.args.handler);Object.defineProperty(t,"disabled",{get:t.definition.disabled});t.openStyleEditor=function(){var e="function"===typeof t.definition.refFn?t.definition.refFn(t.data,t.args):t.definition.ref;var i=t.definition.key;t.setDefaultProps(e,i);var r=t.getComponentPathAndIndex(e,i);var a={id:o,triggerId:"propertyPanel",title:n.get(t.definition.subtitle||"LayerStyleEditor.component.styleEditor"),definition:t.createSubDefinition(),propertiesPath:r.path};t.$root.$emit("showSubPanel",a)};t.setDefaultProps=function(e,n){var i=t.args.properties;if(Array.isArray(i[e])){if(!i[e].some(function(e){return e.key===n})){i[e].push(t.definition.defaultValues);t.args.model.setProperties(t.args.properties)}}else{i[e]=[t.definition.defaultValues];t.args.model.setProperties(t.args.properties)}};t.getComponentPathAndIndex=function(e,n){var i=t.args.properties;var o;for(o=0;o<i[e].length;o++){var r=i[e][o];if(r.key===n){e=e+"."+o;break}}return{path:e,index:o}};t.createSubDefinition=function(){var e="function"===typeof t.definition.items?t.definition.items(t.data):t.definition.items;t.addResetBtn(e);var n={type:"items",components:"items",items:e};return n};t.addResetBtn=function(e){var n={component:"button",translation:t.definition.resetBtnTranslation||"LayerStyleEditor.component.resetAll",disabled:function e(){return JSON.stringify(this.args.properties)===JSON.stringify(this.definition.defaultValues)},action:function e(){t.resetToDefault()},defaultValues:"function"===typeof t.definition.defaultValues?t.definition.defaultValues(t.data):t.definition.defaultValues};e["resetBtn"]=n};t.resetToDefault=function(){var e=t.definition.ref;var n=t.args.properties;var i=t.definition.key;var o="function"===typeof t.definition.defaultValues?t.definition.defaultValues(t.data):t.definition.defaultValues;var r=t.getComponentPathAndIndex(e,i);if(JSON.stringify(n[e][r.index])!==JSON.stringify(o)){n[e][r.index]=o;t.args.model.setProperties(t.args.properties)}}}]};return o}.apply(t,i),void 0!==o&&(e.exports=o))},2802:function(e,t){e.exports='<div class="pp-component pp-button-component style-editor-button" tcl="style-editor">\n    <button class="lui-button" ng-click="openStyleEditor();" ng-model="value" ng-disabled="disabled">{{label}}</button>\n</div> '},2803:function(e,t,n){"use strict";var i,o;!(i=[n(121),n(2804),n(2805)],o=function(e,t,n){var i={template:t,controller:["$scope",function(t){var i=function e(){return t.data};e.defineLabel(t,t.definition,i,t.args.handler);e.defineCustom(t,t.args.handler,"getCapabilities");Object.defineProperty(t,"disabled",{get:t.definition.disabled});t.openDialog=function(){var e={properties:this.args.properties,handler:this.args.handler,model:this.args.model,getCapabilities:this.getCapabilities};var t=n.show(e);t.closed.then(function(){t=null})}}]};return i}.apply(t,i),void 0!==o&&(e.exports=o))},2804:function(e,t){e.exports='<div class="pp-component pp-button-component wms-setup-button">\n    <button class="lui-button" ng-click="openDialog();" ng-model="value" ng-disabled="disabled">{{label}}</button>\n</div>\n'},2805:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(2806),n(94),n(91),n(90)],o=function(e,t,n,i,o){function r(t){var n={props:t.properties,handler:t.handler,model:t.model,getCapabilities:t.getCapabilities};var i=e.getService("luiDialog").show({template:d.template,controller:d.controller,input:n,dock:"top",closeOnOutside:false,showArrow:false});return i}function a(){this.updateStatus("idle");if(null==this.props.wms)return;this.selectedVersion!==this.props.wms.version||this.url!==this.props.wms.url||this.viaServer!==this.props.wms.viaServer?this.hasWmsLoaded=false:this.hasCapabilities&&(this.hasWmsLoaded=true)}function s(e){var t=/image\/|IMAGE\//;for(var n=0;n<e.length;n++){var i=e[n];e[n]=i.replace(t,"").toUpperCase()}return e}function l(){this.hasWmsLoaded=false;this.updateStatus("loading");this.getCapabilities(this.url,this.selectedVersion,this.viaServer).then(function(e){this.layers=[];this.transparent=true;this.hasWmsLoaded=true;this.hasCapabilities=true;this.formats=this.formatTxt(e.formats);this.updateStatus("success");this.referenceSystems=e.srs;for(var t=0;t<e.layers.length;t++){var n=e.layers[t];this.layers.push({name:n.name,title:n.title,selected:false})}var i=RegExp(""+this.selectedFormat);i.test(JSON.stringify(this.formats))||(this.selectedFormat=this.formats[0]);this.layers[0].selected=true}.bind(this),function(){this.updateStatus("error");this.hasWmsLoaded=false}.bind(this))}function u(){null==this.props.wms&&(this.props.wms={url:"",viaServer:false,version:"",hasWmsLoaded:false,selectedCrs:"",selectedFormat:"",capabilities:{crs:[],layers:[],formats:[],transparent:true}});var e=this.props.wms;e.url=this.url;e.viaServer=this.viaServer;e.version=this.selectedVersion;e.hasWmsLoaded=this.hasWmsLoaded;if(this.hasWmsLoaded){e.selectedCrs=this.selectedCrs;e.selectedFormat=this.selectedFormat;e.capabilities.crs=this.referenceSystems;e.capabilities.layers=this.layers;e.capabilities.formats=this.formats;e.capabilities.transparent=this.transparent}!this.props.title&&e&&e.url&&(this.props.title=e.url.replace(/^[^]*\/\/|\/.*$/g,""));for(var t in this.handler.properties.gaLayers){var n=this.handler.properties.gaLayers[t];if(n.cId==this.props.cId){this.handler.properties.gaLayers[t]=this.props;break}}this.handler.updateGlobalChangeListeners();this.model.setProperties(this.handler.properties);this.destroyComponent()}function c(e){this.status.code=e;switch(e){case"loading":this.status.message=i.get("geo.properties.wms.status.loading");break;case"success":this.status.message=i.get("geo.properties.wms.status.success");break;case"error":this.status.message=i.get("geo.properties.wms.status.error");break;case"idle":this.status.message=i.get("geo.properties.wms.status.idle");break;default:this.status.message=i.get("geo.properties.wms.status.idle");this.status.code="idle";break}}var d={template:t,controller:["$scope",function(e){var t=o.extend(true,{},e.props.wms);if(Object.keys(t).length>0){e.url=t.url;e.viaServer=t.viaServer;e.selectedCrs=t.selectedCrs;e.selectedFormat=t.selectedFormat;e.hasWmsLoaded=t.hasWmsLoaded;e.hasCapabilities=t.hasWmsLoaded;e.transparent=t.capabilities.transparent;e.referenceSystems=t.capabilities.crs;e.formats=t.capabilities.formats;e.layers=t.capabilities.layers}e.selectedVersion=Object.keys(t).length>0?t.version:"1.1.0";e.versions=["1.1.0","1.1.1","1.3.0"];e.status={message:i.get("geo.properties.wms.status.idle"),code:"idle"};e.cancel=function(){e.destroyComponent()};e.close=function(){e.destroyComponent()};e.$on("$destroy",function(){n.StateChanged.unbind(e.cancel)});e.loadWms=l.bind(e);e.save=u.bind(e);e.updateStatus=c.bind(e);e.reLoad=a.bind(e);e.formatTxt=s}]};return{show:r,_reLoad:a,_loadWms:l,_save:u,_updateStatus:c,_formatTxt:s}}.apply(t,i),void 0!==o&&(e.exports=o))},2806:function(e,t){e.exports='<div class="lui-modal-background"></div>\n<div class="lui-dialog wms-setup-dialog-wrapper" >\n    <div class="lui-dialog__header">\n        <span q-translation="geo.properties.wms.setup"></span>\n        <button\n            class="lui-fade-button wms-setup-toolbar-buttons"\n            ng-click="$event.preventDefault(); close()"\n            data-name="close">\n            <span class="lui-fade-button__icon lui-icon lui-icon--close" q-title-translation="Common.Close"></span>\n        </button>\t\n    </div>\n    <div class="lui-dialog__body">\n        <div>\n            <span class="wms-setup-title" q-translation="geo.properties.wms.step1"></span>\n            <div class="wms-setup-url">\n                <label class="lui-label wms-setup-subtitle" q-translation="geo.properties.wms.serverUrl"></label>\n                <input class="lui-input" value="{{url}}" ng-model="url" ng-change="reLoad()" ng-disabled="status.code == \'loading\'">\n            </div>\n            <div class="wms-setup-group">\n                <div class="wms-setup-group-item">\n                    <label class="lui-checkbox">\n                        <input class="lui-checkbox__input" ng-model="viaServer" ng-change="reLoad()" type="checkbox"/>\n                        <div class="lui-checkbox__check-wrap">\n                            <span class="lui-checkbox__check"></span>\n                            <span class="lui-checkbox__check-text" q-translation="geo.properties.wms.viaServer"></span>\n                        </div>\n                    </label>\n                </div>\n            </div>\n            <div class="wms-setup-group">\n                <div class="wms-setup-dropdown wms-setup-group-item">\n                    <label class="lui-label wms-setup-subtitle" q-translation="geo.properties.wms.version"></label>\n                    <select class="lui-select" ng-model="selectedVersion" ng-change="reLoad()" ng-disabled="status.code == \'loading\' || url.length == 0">\n                        <option ng-repeat="version in versions">{{version}}</option>\n                    </select>\n                </div>\n                <div class="wms-setup-group-item">\n                    <button class="lui-button wms-setup-load lui-button--success" ng-click="loadWms()" ng-disabled="status.code == \'loading\' || url.length == 0" q-translation="geo.properties.wms.loadWms"></button>\n                </div>\n            </div>\n            <div class="wms-setup-group-status">\n                <label class="lui-label wms-setup-status" q-translation="geo.properties.wms.status"></label>\n                <div class="wms-setup-group-status-msg">\n                    <span class="lui-icon  lui-icon--tick ok-icon" aria-hidden="true" ng-show="status.code == \'success\'"></span>\n                    <span class="lui-icon  lui-icon--info error-icon" aria-hidden="true" ng-show="status.code == \'error\'"></span>\n                    <div ng-model="status">{{status.message}}</div>\n                </div>\n            </div>\n        </div>\n        <div class="wms-setup-border"></div>\n        <div class="step-two-wrapper">\n            <span class="wms-setup-title" q-translation="geo.properties.wms.step2"></span>\n            <div class="wms-setup-loadingscreen" ng-show="!hasWmsLoaded">\n                <label q-translation="geo.properties.wms.status.step1" ng-show="status.code != \'loading\'"></label>\n                <div class="spinner" ng-show="status.code == \'loading\'">\n                    <qv-spinner show="status.code == \'loading\'"></qv-spinner>\n                </div>\n            </div>\n            <div ng-show="hasWmsLoaded">\n                <div class="wms-setup-group">\n                    <div class="wms-setup-group-item">\n                        <label class="lui-label wms-setup-subtitle" q-translation="geo.properties.wms.crs"></label>\n                        <select class="lui-select wms-setup-dropdown" ng-model="selectedCrs">\n                            <option ng-repeat="referenceSystem in referenceSystems">{{referenceSystem}}</option>\n                        </select>\n                    </div>\n                    <div class="wms-setup-group-item wms-setup-transparent">\n                        <label class="lui-checkbox">\n                            <input class="lui-checkbox__input" ng-model="transparent" type="checkbox"/>\n                            <div class="lui-checkbox__check-wrap">\n                                <span class="lui-checkbox__check"></span>\n                                <span class="lui-checkbox__check-text" q-translation="geo.properties.wms.transparent"></span>\n                            </div>\n                        </label>\n                    </div>\n                </div>\n                <div class="wms-setup-group">\n                    <div class="wms-setup-group-item">\n                        <label class="lui-label wms-setup-subtitle" q-translation="geo.properties.wms.format"></label>\n                        <select class="lui-select wms-setup-dropdown" ng-model="selectedFormat">\n                            <option ng-repeat="format in formats">{{format}}</option>\n                        </select>\n                    </div>\n                </div>\n                <div class="wms-setup-layers">\n                    <label class="lui-label wms-setup-subtitle" q-translation="properties.layers"></label>\n                    <label class="lui-checkbox wms-setup-layer" ng-repeat="layer in layers">\n                        <input class="lui-checkbox__input" type="checkbox" aria-label="Label" ng-model="layer.selected" checked />\n                        <div class="lui-checkbox__check-wrap">\n                            <span class="lui-checkbox__check"></span>\n                            <span class="lui-checkbox__check-text">{{layer.title}}</span>\n                        </div>\n                    </label>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="lui-dialog__footer">\n        <button class="lui-button close-button" ng-click="cancel()" name="cancelButton" q-translation="Common.Cancel" data-tid="close-btn"></button>\n\t\t<button class="lui-button close-button lui-button--success" ng-disabled="status.code == \'loading\' ||Â url.length == 0" ng-click="$event.preventDefault(); save()" name="confirmButton" q-translation="Common.Save" data-tid="create-btn"></button>\n    </div>\n</div>'},2807:function(e,t,n){"use strict";var i,o;!(i=[n(11),n(48),n(96),n(165),n(272),n(91),n(321),n(402),n(99),n(1326),n(1267),n(207),n(1058),n(1147),n(1268),n(2808),n(1810),n(1811),n(1812),n(1269),n(111),n(249)],o=function(e,t,n,i,o,r,a,s,l,u,c,d,p,f,h,g,m,v,b,x){var y="pp-data-item.ng.html";function C(e){return e.data&&e.data.qLibraryId&&e.data.qLibraryId.length>0}return{name:"pivot-data",template:c,controller:["$scope","$element","$timeout","luiPopover",function(c,q,D,w){var I=c.args.cache,S="data_",L=i.getComponent("items"),E=null,M=null,_=null,A,P,k,T=f.create(),O=h.create(c,w),V={id:"pp-pseudo-item",templateSrc:"pp-pseudo-item.ng.html",index:-1};function H(e,t){var n=c.args.handler.createFieldDimension(e.value,"");c.args.handler.addDimension(n,t).then(function(){c.$emit("saveProperties",c.data);z();N(t?"columns":"rows")})}function R(e,t){var n=c.args.handler.createLibraryDimension(e.libraryId);c.args.handler.addDimension(n,t).then(function(){c.$emit("saveProperties",c.data);z();N(t?"columns":"rows")})}function $(e){c.args.handler.addLibraryMeasure(e.libraryId).then(function(){c.$emit("saveProperties",c.data);z();N("measures")})}function F(e){c.args.handler.addExpressionMeasure(e.value,"").then(function(){c.$emit("saveProperties",c.data);z();N("measures")})}function N(e){D(function(){var t=q.find(".pp-nm-hcd__lists"),n=q.find("[tid='"+e+"'] .pp-nm-hcd__list-items"),i=n.children().last();i[0]&&(t[0].scrollTop=i[0].offsetTop-1)},100)}function z(){if(_){_.close();_=null}}function B(){var e=0,t=[],n=[];A.get().forEach(function(n){if("empty-item"!==n.id){t.push(n.index);e++}});P.get().forEach(function(e){"empty-item"!==e.id&&t.push(e.index)});k.get().forEach(function(e){"empty-item"!==e.id&&n.push(e.index)});c.data.qHyperCubeDef.qNoOfLeftDims=e;p.validatePivotHyperCube(c.data.qHyperCubeDef);p.reorderPivotDimensions(c.data.qHyperCubeDef,t);p.reorderMeasures(c.data.qHyperCubeDef,n);c.$emit("saveProperties")}c.getAddLabel=function(){return r.get("properties.add")};c.addClicked=function(e){Y(e)};c.sortableItemLists=d.create({options:{direction:"vertical",listKey:"list",scrollSelector:".pp-nm-hcd__lists",listSelector:".pp-nm-hcd__list-items",itemKey:"item",itemSelector:".qv-pp-sortable.draggable",itemDragSelector:".qv-pp-sortable-handle",itemGhostSelector:".pp-nm-di__header",gesture:{name:"swipe",options:{radiusThreshold:l.treatAsDesktop()?4:0,preventDefault:false}}},addPlaceholder:function e(){var t=this._super.apply(this,arguments);t.classList=["qv-pp-sortable"]},onBegin:function e(t){this._super.apply(this,arguments);t.isDragged=true;G();if("dimension"===t.type){if(C(t)||g.isInvalid(t)){k.setLocked(true);k.disabled=true}}else if("measure"===t.type){if(C(t)||!t.isValidExtraction){A.setLocked(true);P.setLocked(true);A.disabled=true;P.disabled=true}k.setLocked(false);k.disabled=false}else if("pp-pseudo-item"===t.id){k.setLocked(true);k.disabled=true}},onMove:function e(t,n){if(-1===this.getIndexOfItem(t)||-1===this.getIndexOfItem(n)){this.onCancel();return false}var i=this.getList(n),o=i.items.indexOf(n),r=function e(){c.$emit("saveProperties")};this._super.apply(this,arguments);if(g.isMovingDimToMea(t,i))m.convert(t,t.args.handler).then(function(e){c.args.handler.removeDimension(t.index).then(function(){return c.args.handler.reinsertMeasure(e,o)}).then(function(){r()})});else if(g.isMovingMeaToDim(t,i)){var a=v.convert(t,t.args.handler),s="columns"===i.tid;c.args.handler.removeMeasure(t.index).then(function(){return c.args.handler.reinsertDimension(a,s,o)}).then(function(){r()})}else B();return true},onMoveToList:function e(t,n){var i=this.getList(t),o=n.items.length-1,r=function e(){c.$emit("saveProperties")};var a=this._super.apply(this,arguments);if(!a)return a;if(g.isMovingDimToMea(t,n))m.convert(t,t.args.handler).then(function(e){c.args.handler.removeDimension(t.index).then(function(){return c.args.handler.reinsertMeasure(e,o)}).then(function(){r()})});else if(g.isMovingMeaToDim(t,n)){var s=v.convert(t,t.args.handler);c.args.handler.removeMeasure(t.index).then(function(){return c.args.handler.reinsertDimension(s,false,o)}).then(function(){r()})}else i!==n&&B();return a},onCancel:function e(t){this._super.apply(this,arguments);t&&(t.isDragged=false)},onEnd:function e(t){t&&(t.isDragged=false);A.setLocked(false);P.setLocked(false);k.setLocked(false);A.disabled=false;P.disabled=false;k.disabled=false;c.$apply()}});A=c.sortableItemLists.createList(1,{title:r.get("Common.Dimensions"),tid:"rows",hasHeaderlessSibling:true,getAddLabel:c.getAddLabel,addClicked:function e(t){U("rows",t.target)},getUndraggedItemsCount:function e(){return J()},getMax:function e(){return c.args.handler.maxDimensions()},getItemDescription:function e(t){return c.args.handler.dimensionDefinition.description(c.args.properties,t,{type:"rows"})}});P=c.sortableItemLists.createList(1,{title:r.get("Common.Columns"),tid:"columns",hideHeader:true,getAddLabel:c.getAddLabel,addClicked:function e(t){U("columns",t.target)},getUndraggedItemsCount:function e(){return J()},getMax:function e(){return c.args.handler.maxDimensions()},getItemDescription:function e(t){return c.args.handler.dimensionDefinition.description(c.args.properties,t,{type:"columns"})}});var W=1;k=c.sortableItemLists.createList(W,{title:r.get("Common.Measures"),tid:"measures",getAddLabel:c.getAddLabel,addClicked:function e(t){U("measures",t.target)},getUndraggedItemsCount:function e(){var t=c.getUndraggedItems(k);return t.length},getMax:function e(){return c.args.handler.maxMeasures()},getItemDescription:function e(t){return c.args.handler.measureDefinition.description(c.args.properties,t)}});function G(){A.get().forEach(function(e){e.expanded=false;I.put(S+e.id,false)});P.get().forEach(function(e){e.expanded=false;I.put(S+e.id,false)});k.get().forEach(function(e){e.expanded=false;I.put(S+e.id,false)})}function j(e){if(E){E.close();E=null}e&&e.target.classList.contains("pp-toplist-add-button")&&n.preventGestures()}c.openContextMenu=function(e,n){var i=t.getService("qvContextMenu").menu();i.addItem({translation:"Common.Delete",tid:"delete",select:function e(){c.removeItem(n)}});M=t.getService("qvContextMenu").show(i,{position:{x:e.pageX,y:e.pageY},docking:"Top"})};function U(t,i){if(_){_=null;return}j();G();var o={alignTo:i,input:{app:c.args.app,allowExpressionEditor:true,closeAddPopover:z},closeOnEscape:true,dock:"bottom"},r;if("rows"===t){r=a;o.input.addFieldDimension=H;o.input.addLibraryDimension=R}else if("columns"===t){r=a;o.input.addFieldDimension=function(e){H(e,true)};o.input.addLibraryDimension=function(e){R(e,true)}}else{r=s;o.input.addLibraryMeasure=$;o.input.addExpressionMeasure=F}o.template=r.template;o.controller=r.controller;_=w.show(o);_.closing.then(function(t){if(t){var i=e(t.target);if(!i.hasClass("pp-nm-di__add-button")&&!i.parents(".pp-nm-di__add-button").length){_=null;n.preventGestures()}}c.adding=false});_.closed.then(function(){_=null})}function Y(e){if(c.adding){j();c.adding=false;return}var t=e.currentTarget;E=w.show({template:u.template,controller:u.controller,input:{items:[{translation:"Common.Row",tid:"row",select:function e(){U("rows",t)},disabled:function e(){return c.args.handler.getDimensions().length>=c.args.handler.maxDimensions()}},{translation:"Common.Column",tid:"column",select:function e(){U("columns",t)},disabled:function e(){return c.args.handler.getMeasures().length>=c.args.handler.maxMeasures()}},{translation:"Common.Measure",tid:"measure",select:function e(){U("measures",t)},disabled:function e(){return c.args.handler.getMeasures().length>=c.args.handler.maxMeasures()}}],closeTypeFoldout:j},alignTo:t});E.closing.then(function(e){e&&!e.target.classList.contains("lui-button__text")&&(c.adding=false)});E.closed.then(function(){E=null});c.adding=true}c.expandClicked=function(e,t){if(e.target.classList.contains("pp-nm-di__draggable"))return;t.expanded=!t.expanded;I.put(S+t.id,t.expanded);e.stopPropagation()};c.removeItem=function(e){"measure"===e.type?c.args.handler.removeMeasure(e.index).then(function(){c.$emit("saveProperties")}):c.args.handler.removeDimension(e.index).then(function(){c.$emit("saveProperties")})};function K(){var e=c.data.qHyperCubeDef.qNoOfLeftDims>=0?c.data.qHyperCubeDef.qNoOfLeftDims:c.data.qHyperCubeDef.qDimensions.length;c.sortableItemLists.reset();T.resetTitles();c.data.qHyperCubeDef.qInterColumnSortOrder.forEach(function(t,n){var i=n<e?A:P;var r;if(-1!==t){var a=c.data.qHyperCubeDef.qDimensions[t];var s=a.qDef.cId;r={component:L,definition:{type:"items",items:c.definition.items.dimensions.items},data:a,args:c.args,id:s,index:t,type:"dimension",expanded:I.get(S+s)||false,templateSrc:y,markerClass:"pp-dimension",title:function e(){var t=c.args.handler.getDimensionLayout(s);return T.getDimensionTitle(t,a,true)},isInvalid:function e(){var t=c.args.handler.getDimensionLayout(s);return t&&!!t.qError&&!o.isCalcCondNotCalculatedErr(t.qError)}}}else-1===t&&(r=V);i.addSortableItem(r)});c.data.qHyperCubeDef.qMeasures.forEach(function(e,t){var n=e.qDef.cId,i=c.args.handler.getMeasureLayout(n);i||(i=c.args.handler.getMeasureLayouts()[t]);var o=T.getCachedMeasureTitle(i),r=O.isChangeable(e);T.getMeasureTitle(i,e,true,c.args.app).then(function(e){o=e});var a={component:L,definition:{type:"items",items:c.definition.items.measures.items},data:e,args:c.args,id:n,index:t,type:"measure",expanded:I.get(S+n)||false,templateSrc:y,markerClass:"pp-measure",title:function e(){return o},isInvalid:function e(){return i&&!!i.qError}};e.qLibraryId||b.extract(e.qDef.qDef).then(function(e){a.isValidExtraction=e.isValid;a.extractedField=e.field});if(r){a.canChangeMeasureAggregation=true;a.currentAggregation=O.getAggregation(e.qDef.qDef);a.remainder=O.getRemainder(e.qDef.qDef)}k.addSortableItem(a,W)})}c.isItemDraggable=function(e){var t="dimension"===e.type,n=e===V;if(t||n)return true;var i=c.data.qHyperCubeDef.qMeasures.length,o=i>1,r=e.isValidExtraction;return o||r};c.showChangeAggregation=function(e){return e.canChangeMeasureAggregation&&!e.isDragged};c.getItemHeaderTitle=function(e){return c.showChangeAggregation(e)?e.remainder:e.title()};c.openChangeAggregationPopover=function(e,t){if(!c.showChangeAggregation(t))return;var n={isOpenButton:function e(t){return t.classList.contains("pp-nm-di__header-aggregation")},onAggregationChanged:function e(t,n){x.gather({expression:t.extractedField,aggregation:n})}};O.openPopover(e,t.id,t,n)};c.isChangeAggregationPopoverOpen=function(e){return O.isPopoverOpen(e.id)};c.showItemDescription=function(e){var t=X(e);return 0===t};c.getItemDescription=function(e){var t=c.sortableItemLists.getList(e),n=X(e);return t.getItemDescription(n)};c.showNextPossibleItem=function(e){var t=e.getUndraggedItemsCount(),n=e.getMax()-t;return n>0};c.showNextPossibleItemDescription=function(e){var t=c.getUndraggedItems(e);return!t.length};c.getNextPossibleItemDescription=function(e){var t=c.getUndraggedItems(e);return e.getItemDescription(t.length)};c.getUndraggedItems=function(e){return e.get(function(e){return!e.isDragged})};function X(e){var t=c.sortableItemLists.getList(e),n=c.getUndraggedItems(t),i=n.indexOf(e);return i}function J(){var e=c.getUndraggedItems(A),t=c.getUndraggedItems(P),n=e.length+t.length,i=e.indexOf(V)>-1||t.indexOf(V)>-1;i&&n--;return n}c.$watchCollection("data.qHyperCubeDef.qDimensions",K);c.$watchCollection("data.qHyperCubeDef.qMeasures",K);c.$watchCollection("data.qHyperCubeDef.qInterColumnSortOrder",K);c.$watch("data.qHyperCubeDef.qNoOfLeftDims",K);c.$on("$destroy",function(){j();z();M&&M.close()})}]}}.apply(t,i),void 0!==o&&(e.exports=o))},2808:function(e,t,n){"use strict";var i,o;!(i=[],o=function(){return{isInvalid:t,isMovingDimToMea:n,isMovingMeaToDim:i};function e(e,t){if(!e||!t)throw new Error("Missing required parameter")}function t(e){return e.isInvalid&&e.isInvalid()}function n(t,n){e(t,n);return!(t.isInvalid&&t.isInvalid())&&"dimension"===t.type&&!t.data.qLibraryId&&"measures"===n.tid}function i(t,n){e(t,n);return!(t.isInvalid&&t.isInvalid())&&"measure"===t.type&&!t.data.qLibraryId&&("rows"===n.tid||"columns"===n.tid)}}.apply(t,i),void 0!==o&&(e.exports=o))},2809:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(11),n(96),n(165),n(121),n(1688),n(101),n(99),n(89),n(419),n(231),n(91),n(321),n(207),n(1267),n(90),n(272),n(111)],o=function(e,t,n,i,o,r,a,s,l,u,c,d,p,f,h,g,m){var v={template:r.template,controller:["$scope",function(e){var t=e.definition.items||{};e.items=Object.keys(t).filter(function(e){return t[e]}).map(function(e){var n=t[e];return{component:i.findComponent(n),definition:n,key:e}});e.$on("saveProperties",function(t){t.stopPropagation();e.$broadcast("datachanged",e.data);e.args.model.setProperties(e.data)});o.defineVisible(e,e.args.handler);o.defineReadOnly(e,e.args.handler)}]};var b={name:"filterpane-data",template:h,controller:["$scope","$element","$timeout","luiPopover",function(i,o,r,h){var b=i.args.cache,x="dimensions_";var y={items:i.definition.items||{},grouped:i.definition.grouped};i.$on("layoutchanged",function(e){e.preventDefault()});i.$on("datachanged",function(e){e.preventDefault()});function C(e){return a.getValue(e,"qListObjectDef.qDef.cId","")}i.expandClicked=function(e,n){if(n.disabled||t(e.target).hasClass("pp-nm-di__draggable"))return;n.expanded=!n.expanded;b.put(x+C(n.data),n.expanded)};i.addClicked=function(e){if(i.adding){w();return}if(!i.addDisabled()){_();q=h.show({template:p.template,controller:p.controller,input:{app:i.args.app,position:"bottom",allowExpressionEditor:true,closeAddPopover:w,addFieldDimension:S,addLibraryDimension:L},alignTo:e.currentTarget,closeOnEscape:true,dock:"bottom"});q.closing.then(function(e){e&&!(e.target.classList.contains("lui-button")||e.target.classList.contains("pp-toplist-add-button")||e.target.classList.contains("lui-button__text"))&&(i.adding=false)});q.closed.then(function(){q=null});i.adding=true}};i.getAddLabel=function(){return d.get("properties.dimensions.add")};i.removeItem=function(e){i.args.handler.setModel(i.args.model);i.args.handler.removeDimension(e.index)};i.addDisabled=function(){return!i.args.handler.canAddDimension()};var q=null,D=null;function w(e){if(q){q.close();q=null}e&&t(e.target).hasClass("pp-toplist-add-button")&&n.preventGestures();i.adding=false}i.openContextMenu=function(t,n){var o=e.getService("qvContextMenu").menu();o.addItem({translation:"Common.Delete",tid:"delete",select:function e(){i.removeItem(n)}});D=e.getService("qvContextMenu").show(o,{position:{x:t.pageX,y:t.pageY},docking:"Top"})};function I(){r(function(){var e=o.find(".pp-nm-hcd__lists"),t=e.find(".pp-nm-hcd__list-items").children().last();t[0]&&(e[0].scrollTop=t[0].offsetTop-1)},100)}function S(e){i.args.handler.setModel(i.args.model);i.args.handler.addFieldDimension(e.value,e.value).then(function(){w();I()})}function L(e){i.args.handler.setModel(i.args.model);i.args.handler.addLibraryDimension(e.libraryId).then(function(){w();I()})}function E(e){var t={},n={};e.forEach(function(e){t[e]={};n[e]=i.args.app.getObject(e)});return l.all(n).then(function(n){var i={},o={};Object.keys(n).forEach(function(e){var r=n[e];t[e].model=r;i[e]=r.getProperties();o[e]=r.getLayout()});return l.all(i).then(function(n){e.forEach(function(e){t[e].properties=g.extend(true,{},n[e])});return l.all(o).then(function(n){e.forEach(function(e){t[e].layout=n[e]});return t})})})}function M(e){if(!e.qChildList)return;var t=e.qChildList.qItems.map(function(e){return e.qInfo.qId});E(t).then(function(e){i.sortableItemLists.reset();t.forEach(function(t,n){var o=new u({app:i.args.app,dimensionDefinition:i.definition,dimensionProperties:{}});var r=e[t];var a=r.properties;var s=r.model;var l=r.layout.qListObject.qDimensionInfo;var d=C(a);o.setProperties(a);o.setLayout(r.layout);var p={title:function e(){if(l.qError&&!m.isCalcCondNotCalculatedErr(l.qError))return c.getDimensionError(l.qError.qErrorCode);return r.layout.title||l.qFallbackTitle||""},isInvalid:function e(){return!!l.qError&&!m.isCalcCondNotCalculatedErr(l.qError)},data:a,id:t,cId:d,index:n,component:v,definition:y,templateSrc:"pp-data-item.ng.html",markerClass:"pp-dimension",args:{handler:o,cache:b,localeInfo:i.args.localeInfo,app:i.args.app,properties:a,model:s},expanded:b.get(x+d)||false,sortable:false!==i.definition.allowMove};A.addSortableItem(p)})})}i.$on("layoutchanged",function(e,t){M(t)});M(i.args.layout);function _(){A.items.forEach(function(e){e.expanded=false;b.put(x+e.cId,false)})}i.sortableItemLists=f.create({options:{direction:"vertical",listKey:"list",scrollSelector:".pp-nm-hcd__lists",listSelector:".pp-nm-hcd__list-items",itemKey:"item",itemSelector:".qv-pp-sortable.draggable",itemDragSelector:".qv-pp-sortable-handle",itemGhostSelector:".pp-nm-di__header",gesture:{name:"swipe",options:{radiusThreshold:s.treatAsDesktop()?4:0,preventDefault:false}}},addPlaceholder:function e(){var t=this._super.apply(this,arguments);t.classList=["qv-pp-sortable"]},onBegin:function e(t){this._super.apply(this,arguments);t.isDragged=true;_()},onMove:function e(){var t=this._super.apply(this,arguments);if(t){var n=A.get().filter(function(e){return"empty-item"!==e.id}).map(function(e){return e.id});i.args.model.setChildArrayOrder(n)}return t},onCancel:function e(t){this._super.apply(this,arguments);t&&(t.isDragged=false)},onEnd:function e(t){t&&(t.isDragged=false);i.$apply()}});var A=i.sortableItemLists.createList(1,{title:d.get("Common.Dimensions"),tid:"dimensions",getAddLabel:function e(){return d.get("properties.dimensions.add")},addClicked:i.addClicked});i.$on("pp-open-path",function(e,t){var n=t.split("."),i=n[0],o=n[1];if("dimensions"===i&&o){b.put(x+o,true);I()}});i.isItemDraggable=function(e){if(!e.sortable)return false;var t=i.args.layout.qChildList;if(!t)return false;var n=t.qItems.length;return n>1};i.getItemHeaderTitle=function(e){return e.title()};i.showItemDescription=function(e){if(e.isDragged)return false;var t=P(e);return 0===t};i.getItemDescription=function(e){var t=P(e),n=i.args.ext.data.dimensions.description(i.args.properties,t);return n};i.showNextPossibleItem=function(e){var t=i.getUndraggedItems(e),n=i.args.ext.data.dimensions.max,o=n-t.length;return o>0};i.showNextPossibleItemDescription=function(e){var t=i.getUndraggedItems(e);return 0===t.length};i.getNextPossibleItemDescription=function(){return i.args.ext.data.dimensions.description(i.args.properties,0)};i.getUndraggedItems=function(e){return e.get(function(e){return!e.isDragged})};function P(e){var t=i.sortableItemLists.getList(e),n=i.getUndraggedItems(t),o=n.indexOf(e);return o}i.$on("$destroy",function(){w();D&&D.close()})}]};return b}.apply(t,i),void 0!==o&&(e.exports=o))},2810:function(e,t,n){"use strict";var i,o;!(i=[n(11),n(165),n(121),n(1688),n(101),n(89),n(99),n(419),n(134),n(207),n(231),n(272),n(1813),n(90)],o=function(e,t,n,i,o,r,a,s,l,u,c,d,p,f){var h={template:i.template,controller:["$scope",function(e){var i=e.definition.items||{};e.items=Object.keys(i).filter(function(e){return i[e]}).map(function(e){var n=i[e];return{component:t.findComponent(n),definition:n,key:e}});e.$on("saveProperties",function(t){t.stopPropagation();e.$broadcast("datachanged",e.data);e.args.model.setProperties(e.data)});n.defineVisible(e,e.args.handler);n.defineReadOnly(e,e.args.handler)}]};var g={name:"filterpane-sorting",template:p,controller:["$scope",function(t){var n=t.args.cache,i="sorting_";var p={items:t.definition.items||{},grouped:t.definition.grouped};t.$on("layoutchanged",function(e){e.preventDefault()});t.$on("datachanged",function(e){e.preventDefault()});t.expandClicked=function(t,o){if(o.disabled||e(t.target).hasClass("pp-move-item"))return;o.expanded=!o.expanded;n.put(i+o.cId,o.expanded)};function g(e){var n={},i={};e.forEach(function(e){n[e]={};i[e]=t.args.app.getObject(e)});return r.all(i).then(function(t){var i={},o={};Object.keys(t).forEach(function(e){var r=t[e];n[e].model=r;i[e]=r.getProperties();o[e]=r.getLayout()});return r.all(i).then(function(t){e.forEach(function(e){n[e].properties=f.extend(true,{},t[e])});return r.all(o).then(function(t){e.forEach(function(e){n[e].layout=t[e]});return n})})})}function m(e){if(!e.qChildList)return;var r=e.qChildList.qItems.map(function(e){return e.qInfo.qId});l.getListLayout().then(function(e){g(r).then(function(a){t.sortableItemLists.reset();var l=[];Object.keys(a).forEach(function(r,u){var f=new s(t.definition,e,{}),g=a[r],m=g.properties,v=g.model,b=g.layout.qListObject.qDimensionInfo,x=o.getValue(m,"qListObjectDef.qDef.cId");f.setProperties(m);f.setLayout(g.layout);var y;y=b.qError&&!d.isCalcCondNotCalculatedErr(b.qError)?c.getDimensionError(b.qError.qErrorCode):g.layout.title||b.title||b.qFallbackTitle||"";l.push({component:h,definition:p,title:function e(){return y},isInvalid:function e(){return!!b.qError&&!d.isCalcCondNotCalculatedErr(b.qError)},data:m,id:r,cId:x,priority:u+1,args:{handler:f,cache:n,localeInfo:t.args.localeInfo,properties:m,model:v},expanded:n.get(i+x)||false,sortable:true,showPriority:true,templateSrc:"pp-sorting-item.ng.html"})});l.sort(function(e,t){var n=r.indexOf(e.id),i=r.indexOf(t.id);return n>i});l.forEach(function(e){b.addSortableItem(e)})})})}t.$on("layoutchanged",function(e,t){m(t)});m(t.args.layout);function v(){b.items.forEach(function(e){e.expanded=false;n.put(i+e.cId,false)})}t.sortableItemLists=u.create({options:{direction:"vertical",listKey:"list",listSelector:".pp-expandable-list",itemKey:"item",itemSelector:".qv-pp-sortable",itemDragSelector:".qv-pp-sortable-handle",gesture:{name:"swipe",options:{radiusThreshold:a.treatAsDesktop()?4:0,preventDefault:false}}},addPlaceholder:function e(){var t=this._super.apply(this,arguments);t.classList=["qv-pp-sortable"]},onBegin:function e(){this._super.apply(this,arguments);v()},onMove:function e(){var n=this._super.apply(this,arguments);if(n){var i=b.get().map(function(e){return e.id});t.args.model.setChildArrayOrder(i)}return n}});var b=t.sortableItemLists.createList(1,{tid:"sorting"})}]};return g}.apply(t,i),void 0!==o&&(e.exports=o))},2811:function(e,t){e.exports='<div class="pp-nm-di qv-pp-sortable" ng-class="{ \'draggable\': isItemDraggable(item), \'dragged\': item.isDragged }">\n\n\t\x3c!-- Description --\x3e\n\t<div class="pp-nm-di__description" ng-if="showItemDescription(item)">\n\t\t{{getItemDescription(item)}}\n\t</div>\n\n\t\x3c!-- Header --\x3e\n\t<div class="pp-nm-di__header"\n\t\t ng-class="{\n\t\t\t \'expanded\': item.expanded,\n\t\t\t \'invalid\': item.isInvalid(),\n\t\t\t \'disabled\': item.disabled,\n\t\t\t \'draggable\': isItemDraggable(item) }"\n\t\t ng-style="item.style"\n\t\t ng-click="expandClicked($event, item)"\n\t\t qva-context-menu="openContextMenu($event, item)">\n\n\t\t\x3c!-- Change aggregation dropdown --\x3e\n\t\t<button class="lui-button pp-nm-di__header-aggregation"\n\t\t\t\tng-show="showChangeAggregation(item)"\n\t\t\t\tng-click="openChangeAggregationPopover($event, item)"\n\t\t\t\tng-class="{ \'lui-active\': isChangeAggregationPopoverOpen(item) }"\n\t\t\t\ttitle="{{item.currentAggregation}}">\n\t\t\t{{item.currentAggregation}}\n\t\t</button>\n\n\t\t\x3c!-- Header content --\x3e\n\t\t<div class="pp-nm-di__header-content">\n\n\t\t\t\x3c!-- Header title --\x3e\n\t\t\t<div class="pp-nm-di__header-title" title="{{getItemHeaderTitle(item)}}">\n\t\t\t\t{{getItemHeaderTitle(item)}}\n\t\t\t</div>\n\n\t\t\t\x3c!-- Header icons --\x3e\n\t\t\t<i ng-if="item.markerClass" ng-class="item.markerClass"></i>\n\t\t\t<i class="lui-icon pp-nm-di__header-toggle lui-icon--arrow-right" ng-class="{ \'expanded\': item.expanded }"></i>\n\t\t\t<i class="lui-icon lui-icon--draggable pp-nm-di__draggable qv-pp-sortable-handle" pp-di-draggable-hover q-title-translation="Common.Move"></i>\n\t\t</div>\n\t</div>\n\n\t\x3c!-- Content --\x3e\n\t<div class="pp-nm-di__content" ng-if="item.expanded">\n\n\t\t\x3c!-- Content body - Master or inline dimension / measure --\x3e\n\t\t<div class="pp-nm-di__content-body">\n\t\t\t<div include-pp-component x-component="item.component" x-definition="item.definition" x-data="item.data" x-args="item.args"></div>\n\t\t</div>\n\n\t\t\x3c!-- Content footer - Remove button --\x3e\n\t\t<div class="pp-nm-di__content-footer">\n\t\t\t<button class="lui-button pp-nm-di__remove-button" ng-click="removeItem(item)">\n\t\t\t\t<span class="lui-button__icon lui-icon lui-icon--bin remove-icon" q-title-translation="Common.Delete"></span>\n\t\t\t\t<span class="lui-button__text" q-translation="Common.Delete"></span>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n</div>\n'},2812:function(e,t){e.exports='<div class="pp-nm-di qv-pp-sortable pseudo" ng-class="{ \'draggable\': isItemDraggable(item), \'dragged\': item.isDragged }">\n\n\t\x3c!-- Description --\x3e\n\t<div class="pp-nm-di__description" ng-if="showItemDescription(item)">\n\t\t{{getItemDescription(item)}}\n\t</div>\n\n\t\x3c!-- Header --\x3e\n\t<div class="pp-nm-di__header" \n\t\t ng-style="item.style"\n\t\t ng-class="{ \'draggable\': isItemDraggable(item) }">\n\n\t\t\x3c!-- Header content --\x3e\n\t\t<div class="pp-nm-di__header-content">\n\n\t\t\t\x3c!-- Header title --\x3e\n\t\t\t<div class="pp-nm-di__header-title" q-translation="Common.Values"></div>\n\n\t\t\t\x3c!-- Header icons --\x3e\n\t\t\t<i ng-if="item.markerClass" ng-class="item.markerClass"></i>\t\t\n\t\t\t<i class="lui-icon lui-icon--draggable pp-nm-di__draggable qv-pp-sortable-handle" pp-di-draggable-hover q-title-translation="Common.Move"></i>\n\t\t</div>\n\t</div>\n</div>'},2813:function(e,t){e.exports='<div class="pp-data-empty-hint">\n\t<span q-translation="Common.NoData"></span>\n</div>'},2814:function(e,t){e.exports='<div class="pp-expandable-list-header" qva-activate="expandClicked($event,item);"\n\t ng-style="item.style"\n\t ng-class="{ \'expanded\': item.expanded, \'invalid\': item.isInvalid(), \'qv-pp-sortable\': item.sortable }">\n\t<span class="priority" ng-if="item.showPriority">{{item.priority}}</span>\n\t<i class="toggle-expand  lui-icon  {{ item.expanded ? \'lui-icon--triangle-bottom\' : \'lui-icon--triangle-right\' }}"></i>\n\t<span class="text" title="{{item.title()}}">{{item.title()}}</span>\n\t<span class="lui-icon lui-icon--handle pp-move-item qv-pp-sortable-handle" ng-if="item.sortable" q-title-translation="Common.Move"></span>\n</div>\n<div class="pp-expandable-list-content" ng-if="item.expanded">\n\t<div include-pp-component x-component="item.component" x-definition="item.definition" x-data="item.data" x-args="item.args"></div>\n</div>\n'},290:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(90),n(89),n(141),n(283),n(364),n(50),n(365),n(245)],o=function(e,t,n,i,o,r,a,s){e.service("qvListboxPopoverService",["luiPopover",function(e){var l;var u;var c={showDelayed:function i(c,d,p,f){var h=n();if(l){u.selectionsActivated=function(){};u.selectionsDeactivated=function(){};l.close()}u={getVisualization:function e(){return h.promise},onPopoverClose:this.onPopoverClose,options:{setController:h.resolve,isPopover:true,showLock:d.showLock,search:d.search||{},smallDevice:a.isSmallDevice,direction:d.direction},selectionToolbarComponent:o,onClose:r};l=e.show({template:s,controller:r.controller,alignTo:d.$alignToElement[0],input:u,closeOnResize:false,dock:"top"});c.then(function(e){u.model=e}).catch(function(e){false});u.selectionsActivated=function(){t.isFunction(f)&&f()};u.selectionsDeactivated=function(){t.isFunction(p)&&p();p=null;f=null};return l},show:function e(t,i,o,r){return this.showDelayed(n.when(t),i,o,r)},showField:function e(t,o,r,a,s,l){return i.createTransientField(o,t,a).then(function(e){return n.resolve(this.show(e,r,s,l))}.bind(this)).catch(function(e){false})},showDimension:function e(t,n,o,r,a,s){i.createTransientDimension(n,t,r).then(function(e){this.show(e,o,a,s)}.bind(this)).catch(function(e){false})},close:function e(){l&&l.close();l=null},onPopoverClose:function e(){},getPopover:function e(){return l},onClosing:function e(){}};return c}])}.apply(t,i),void 0!==o&&(e.exports=o))},364:function(e,t,n){"use strict";var i,o;!(i=[n(89),n(97)],o=function(e,t){var n={template:null,controller:["$scope","$element","$timeout",function(n,i,o){var r=this;n.input.selectionsActivated=function(){};n.input.selectionsDeactivated=function(){};r.close=function(){a()};function a(){o(function(){n.destroyComponent();i.remove()});t.off("start.listbox-popover-error",a)}function s(){return o(function(){return i.find(".toolbar-wrapper").outerWidth()})}var l=n.input.onPopoverClose;var u=null;n.closingDeferred.promise.then(function(e){u&&u();l(e);a()});e.all({object:n.input.getVisualization(),width:s()}).then(function(e){var i=e.object,o=e.width;i.getSelectionToolbar().then(function(e){n.toolbar=e;n.toolbar.showLock=n.input.options.showLock;n.toolbar.position={width:o};i.activateSelections()});i.loaded.then(function(){i.ext.hasError(i)&&t.on("start.listbox-popover-error",a)});i.selectionsApi.watchActivated(function(){n.input.selectionsActivated()});i.selectionsApi.watchDeactivated(function(){n.input.selectionsDeactivated();a()});u=function e(){i.selectionsApi.confirm()}})}]};return n}.apply(t,i),void 0!==o&&(e.exports=o))},365:function(e,t){e.exports='<lui-popover\n\t\tclass="qv-listbox-popover"\n\t\tstyle="min-width: 200px;width: 234px;height: 332px"\n\t\ton-close-view="closeView(event)"\n\t\tqva-outside-ignore-for="{{input.qvaOutsideIgnoreFor}}"\n\t\tqva-mouse-wheel-outside="close()">\n\t<lui-popover-body style="height: 332px" class="lui-nopad">\n\t\t<qv-spinner show="!input.model" spinner-height="100px" spinner-width="100px" show-Delay="300" center-in-parent="true"></qv-spinner>\n\t\t<div class="toolbar-wrapper"\n\t\t\t qva-include-selection-toolbar\n\t\t\t component="input.selectionToolbarComponent"\n\t\t\t toolbar="toolbar"\n\t\t\t options="input.options"></div>\n\t\t<div class="listbox-wrapper">\n\t\t\t<qv-object object="object" model="input.model" options="input.options"></qv-object>\n\t\t</div>\n\t</lui-popover-body>\n</lui-popover>\n'},369:function(e,t,n){"use strict";var i,o;!(i=[n(54),n(407),n(187),n(178),n(408)],o=function(e,t,n,i,o){var r={};var a={classify:s};return a;function s(n){if(!e.isString(n))throw new Error("Expression-classifier: Expression must be a string");var i=n;if(r[i])return r[i];var a={content:n,count:0,result:{},results:[]};if(""===n){r[i]=a;return a}"="===n.charAt(0)&&(n=n.substr(1));var s=o.stripComments(n);var u=t.tokenize(s);a.count=u.length;u.forEach(function(e,t){var n;if(e.isOperator)a.results.push(e);else{n=l(e.content);a.results.push(n)}0===t&&(a.result=n)});r[i]=a;return a}function l(e){var t={content:e,function:{content:"",isCommon:false},remainder:{content:"",isFunction:false,isCommonFunction:false,isCommaSeparated:false,isFieldlike:false,isString:false,isNumber:false,isQualifier:false,qualified:{qualifier:"",content:"",isFieldlike:false}}};var n=u(e);if(n.hasAggregation){t.function.content=c(e,n);t.function.isCommon=m(t.function.content);t.remainder.content=d(e,n);var i=u(t.remainder.content);t.remainder.isFunction=b(i);t.remainder.isCommonFunction=x(t.remainder.content,i);t.remainder.isQualifier=f(t.remainder.content);t.remainder.isCommaSeparated=v(t.remainder.content);if(t.remainder.isQualifier){var o=h(t.remainder.content),r=g(t.remainder.content,o),a=u(r);t.remainder.qualified={qualifier:o,content:r,isFieldlike:y(a)}}n=i}else t.remainder.content=t.content;t.remainder.isFieldlike=y(n);t.remainder.isString=C(t.remainder.content);t.remainder.isNumber=q(t.remainder.content);return t}function u(e){var t={};t.expression=e;t.hasPrefix="="===e.charAt(0);t.leftSymbolIndex=e.indexOf(n.SYMBOLS.FUNCTION.LEFT);t.hasAggregation=t.leftSymbolIndex>0;t.isRightSymbolLast=e.substring(e.length-1)===n.SYMBOLS.FUNCTION.RIGHT;t.isEncapsulated=t.hasAggregation&&t.isRightSymbolLast;t.hasOperator=p(e);return t}function c(e,t){var n=t.hasPrefix?1:0,i=t.hasPrefix?t.leftSymbolIndex+1:t.leftSymbolIndex;return e.substr(n,i).trim()}function d(e,t){var n=e.substr(t.leftSymbolIndex),i=n.substr(1,n.length-2);return i.trim()}function p(e){var t=n.OPERATORS,i=t.SINGLES,o=t.MULTIPLES,r=t.WORDS;var a=i.some(function(t){return e.indexOf(t)>-1});if(a)return true;var s=o.some(function(t){return e.indexOf(t)>-1});if(s)return true;var l=r.some(function(t){return e.indexOf(" "+t+" ")>-1});return l}function f(e){return n.QUALIFIERS.some(function(t){return 0===e.toLowerCase().indexOf(t)})}function h(e){var t=n.QUALIFIERS.filter(function(t){return 0===e.toLowerCase().indexOf(t)}).shift();return t}function g(e,t){return e.slice(t.length).trim()}function m(e){return n.COMMON_FUNCTIONS.some(function(t){return e.toLowerCase()===t})}function v(e){var t=i.getCharacterIndexes(e,",");return t.some(function(t){return!S(e,t)})}function b(e){return e.isEncapsulated&&!e.isBleedingOperator}function x(e,t){if(!t.isEncapsulated)return false;var n=e.substr(0,t.leftSymbolIndex);return m(n)}function y(e){var t=e.expression;if(C(e.expression))return false;var o=D(t,n.SYMBOLS.FIELD.LEFT),r=w(t,n.SYMBOLS.FIELD.RIGHT),a=i.getCharacterCount(t,n.SYMBOLS.FIELD.LEFT),s=i.getCharacterCount(t,n.SYMBOLS.FIELD.RIGHT);if(o&&r&&1===a&&1===s)return true;return I(e)}function C(e){var t=D(e,n.SYMBOLS.STRING.LEFT),o=w(e,n.SYMBOLS.STRING.RIGHT),r=n.SYMBOLS.STRING.LEFT===n.SYMBOLS.STRING.RIGHT,a=i.getCharacterCount(e,n.SYMBOLS.STRING.LEFT),s;if(r)s=2===a;else{var l=i.getCharacterCount(e,n.SYMBOLS.STRING.RIGHT);s=1===a&&1===l}return t&&o&&s}function q(e){return!Number.isNaN(+e)}function D(e,t){return e.charAt(0)===t}function w(e,t){return e.charAt(e.length-1)===t}function I(e){if(e.hasAggregation)return false;var t=e.expression,i=t.indexOf(" ")>-1;if(i)return false;var o=n.OPERATORS.SINGLES.concat(n.OPERATORS.MULTIPLES).some(function(e){return t.indexOf(e)>-1});return!o}function S(e,t){return Object.keys(n.SYMBOLS).some(function(o){var r=n.SYMBOLS[o];return i.getIsCharacterEncapsulated(e,t,r.LEFT,r.RIGHT)})}}.apply(t,i),void 0!==o&&(e.exports=o))},392:function(e,t,n){"use strict";var i,o;!(i=[n(48),n(409)],o=function(e,t){e.directive("qvStateCountBar",function(){return{restrict:"E",template:t,replace:true,scope:{stateCounts:"=",options:"="},link:function e(t){t.percents=[];t.$watchCollection("stateCounts",function(){n()});function n(){var e=t.stateCounts,n;if(!e)return;n=o(e);t.percents=r(n)}function i(e){return Object.keys(e).reduce(function(t,n){return t+e[n]},0)}function o(e){var t=i(e),n={};["qSelected","qLocked","qOption","qAlternative"].forEach(function(i){var o=e[i]||0,r=Math.round(o/t*100);o>0&&0===r&&(r=1);n[i]=r});return n}function r(e){var t={},n,i,o=0;for(n in e){t[n]=e[n];(!i||e[n]>e[i])&&(i=n);o+=e[n]}o>100&&(t[i]=e[i]-(o-100));return t}}}})}.apply(t,i),void 0!==o&&(e.exports=o))},406:function(e,t,n){"use strict";var i,o;!(i=[n(282),n(89)],o=function(e,t){return{createInitialChart:o,createChart:i,convertChart:r,getPropertyTreeForConvertedChart:a,createConvertedChart:s};function n(e){var t=e.qHyperCubeDef;if(t&&t.qMeasures&&t.qDimensions){var n=t.qDimensions.concat(t.qMeasures);n.forEach(function(e){e.qAttributeExpressions&&e.qAttributeExpressions.forEach(function(e){e.qAttribute=true})})}}function i(e,t,i){var o=l(t,i).bind(t);n(e);return o(e)}function o(t,n,o){u(t,n,o);return e.getInitialProperties(t).then(function(e){return i(e,n,o)})}function r(e,t,n){if(!e)throw new Error("No extension provided");var i=n||e.model;return a(e,t,n).then(function(e){return n.setFullPropertyTree(e).then(function(){return i})})}function a(n,i,o){if(!n)throw new Error("No extension provided");var r=o||n.model;return t.all([e.getExtensionType(i),e.getInitialProperties(i),r.getFullPropertyTree()]).then(function(e){var t=e[0];var i=e[1];var o=e[2];var r;delete o.qProperty.qInfo.qId;if(n.exportProperties&&t.importProperties){var a;"boxplot"===n.type&&(a="boxplotDef");r=t.importProperties(n.exportProperties(o,a),i,t)}else r={qProperty:i,qChildren:[]};return r})}function s(e,t,n,i){u(t,n,i);return(e.model.properties,n,i).then(function(n){return r(e,t,n)})}function l(e,t){return t?e.createObject:e.createSessionObject}function u(e,t,n){if(!t||!e)throw new Error("Invalid inparameters: type or app missing");if(n)throw new Error("Persisted objects not implemented yet")}}.apply(t,i),void 0!==o&&(e.exports=o))},407:function(e,t,n){"use strict";var i,o;!(i=[n(54),n(187)],o=function(e,t){var n=r();var i={tokenize:o};return i;function o(t){if(!e.isString(t))throw new Error("Expression-tokenizer: Expression must be a string");t=t.trim();"="===t.charAt(0)&&(t=t.substr(1));var n=[],i=0,o=a(t);o.forEach(function(e){var o=t.substr(i,e.start-i).trim();o&&n.push({content:o,isOperator:false});n.push({content:e.content,isOperator:true});i=e.end});var r=t.substr(i,t.length);n.push({content:r.trim(),isOperator:false});return n}function r(){var e={};for(var n in t.SYMBOLS)if(t.SYMBOLS.hasOwnProperty(n)){var i=t.SYMBOLS[n];e[i.LEFT]=i.RIGHT}return e}function a(e){var t=[];for(var n=0;n<e.length;n++){var i=e.charAt(n);if(s(i)){n=l(e,i,n);continue}var o=[],r=false,a=u(i);o=c(i);if(o.length){var p=e.substr(n).toLowerCase();for(var f=0;f<o.length;f++){var h=o[f],g=d(p,h);if(g){t.push({content:h,start:n,end:n+h.length});r=true;n+=h.length-1;break}}}!r&&a&&t.push({content:i,start:n,end:n+1})}return t}function s(e){return n.hasOwnProperty(e)}function l(e,i,o){var r=i,a=n[r],s=e.substring(o).split(""),l=0,u=false;for(var c=0;c<s.length;c++){var d=s[c];d===t.SYMBOLS.STRING.LEFT&&(u=!u);if(u)continue;d===r&&l++;d===a&&l--;if(!l)return c+o}return o}function u(e){return t.OPERATORS.SINGLES.indexOf(e.toLowerCase())>-1}function c(e){var n=[];var i=t.OPERATORS.MULTIPLES.concat(t.OPERATORS.WORDS).filter(function(e){return e.length>1}).map(function(e){return e.toLowerCase()});i.forEach(function(t){0===t.indexOf(e.toLowerCase())&&n.push(t)});return n}function d(e,n){var i=0===e.indexOf(n+" "),o=t.OPERATORS.SINGLES.some(function(t){return 0===e.indexOf(n+t)});return i||o}}.apply(t,i),void 0!==o&&(e.exports=o))},408:function(e,t,n){"use strict";var i,o;!(i=[],o=function(){var e={stripComments:t};return e;function t(e){if(!e)return"";e=n(e);e=i(e);return e.trim()}function n(e){return e.replace(/\/\/(.*)$/gm,"")}function i(e){return e.replace(/\/\*[^]*?\*\//g,"")}}.apply(t,i),void 0!==o&&(e.exports=o))},409:function(e,t){e.exports='<div class="qv-state-count-bar" tid="stateCount" qva-direction x-dir-setting="{{options.direction}}">\n\t<div class="state selected" ng-style="{\'width\': percents.qSelected + \'%\'}"></div>\n\t<div class="state locked" ng-style="{\'width\': percents.qLocked + \'%\'}"></div>\n\t<div class="state optional" ng-style="{\'width\':  percents.qOption + \'%\'}"></div>\n\t<div class="state alternative" ng-style="{\'width\':  percents.qAlternative + \'%\'}"></div>\n</div>'},487:function(e,t,n){"use strict";var i,o;!(i=[n(985)],o=function(e){var t={create:n};return t;function n(){return new e}}.apply(t,i),void 0!==o&&(e.exports=o))},982:function(e,t,n){"use strict";var i,o;!(i=[],o=function(){return{canModifyHardProperties:e};function e(e,t,n){var i=e.Views&&e.Views.sheet;if(n.qHasSoftPatches||n.qExtendsId)return false;if(n.qInfo&&"masterobject"===n.qInfo.qType&&n.permissions)return n.permissions.update;if(e.view===i)return e.model&&e.model.layout.permissions.update;return t.app&&t.app.layout.permissions.update}}.apply(t,i),void 0!==o&&(e.exports=o))},983:function(e,t,n){"use strict";var i,o;!(i=[n(984)],o=function(e){var t={create:n};return t;function n(){return new e}}.apply(t,i),void 0!==o&&(e.exports=o))},984:function(e,t,n){"use strict";var i,o;!(i=[n(487)],o=function(e){function t(){this.alternativeTitleRetriever=e.create();this.cache={}}t.prototype.getDimensionTitle=n;t.prototype.getCachedDimensionTitle=i;t.prototype.getMeasureTitle=o;t.prototype.getCachedMeasureTitle=r;t.prototype.resetTitles=a;return t;function n(e,t,n){var i=this;return this.alternativeTitleRetriever.getDimensionTitle(e,t,n).then(function(t){l(i.cache,e.qDef.cId,t);return t})}function i(e){return s(this.cache,e.qDef.cId)}function o(e,t,n){var i=this;return this.alternativeTitleRetriever.getMeasureTitle(e,t,n).then(function(t){l(i.cache,e.qDef.cId,t);return t})}function r(e){return s(this.cache,e.qDef.cId)}function a(){this.alternativeTitleRetriever.resetTitles()}function s(e,t){return e[t]||""}function l(e,t,n){e[t]=n}}.apply(t,i),void 0!==o&&(e.exports=o))},985:function(e,t,n){"use strict";var i,o;!(i=[n(89),n(91),n(130)],o=function(e,t,n){function i(){this.titles={}}i.prototype.getDimensionTitle=o;i.prototype.getMeasureTitle=r;i.prototype.resetTitles=a;return i;function o(e,t,n){p(this);return s.call(this,e,t,n,true)}function r(e,t,n){p(this);return s.call(this,e,t,n,false)}function a(){this.titles={}}function s(e,t,n,i){var o=l(e,this.titles);if(o)return o.promise;o=u(e,this.titles);o.promise=c(e,t,n,i);return o.promise}function l(e,t){var n=d(e);return t[n]}function u(e,t){var n=d(e);var i={id:n,promise:null};t[n]=i;return i}function c(i,o,r,a){var s="H"===i.qDef.qGrouping,l=!!i.qLibraryId;if(s)return e.when(i.qData.title);if(l){var u=a?o.getDimensionList:o.getMeasureList;return u.call(o).then(function(e){var o=a?n.findLibraryDimension:n.findLibraryMeasure;var s=o(i.qLibraryId,e),l=s&&s.qData.labelExpression;return s?!r&&l?l:s.qData.title:t.get(a?"Object.ErrorMessage.MissingDimension":"Object.ErrorMessage.MissingMeasure")})}var c=i.qDef.qLabelExpression,d=!!c;if(d)return r?e.when(c):o.evaluate(c);var p;if(a){var f=i.qDef.qFieldLabels[0];p=!f?i.qDef.qFieldDefs[0]:f}else p=i.qDef.qLabel||i.qDef.qDef;return e.when(p)}function d(e){return e.qDef.cId}function p(e){if(!e)throw new Error("AlternativeTitleRetriever: Called without a context")}}.apply(t,i),void 0!==o&&(e.exports=o))},986:function(e,t,n){"use strict";var i,o;!(i=[n(90)],o=function(e){return{migrateProperties:t,needToMigrateProperties:n};function t(t){var n=e.findValuesOfQProperty(t,"qHyperCubeDef");n.forEach(function(e){var t=e.qDimensions;t.forEach(function(e){var t=e.qDef;true===t.autoSort&&t.qSortCriterias.forEach(function(e){e.qSortByNumeric=1;e.qSortByAscii=1})})});return t}function n(t){var n=e.findValuesOfQProperty(t,"qHyperCubeDef");return n.some(function(e){var t=e.qDimensions;return t.some(function(e){var t=e.qDef;return true===t.autoSort&&t.qSortCriterias.some(function(e){return 1!==e.qSortByNumeric||1!==e.qSortByAscii})})})}}.apply(t,i),void 0!==o&&(e.exports=o))}}]);