/*!
 * sense-client@6.105.4
 * 
 * Copyright(C) 2019 Qlik International AB
 * All Rights Reserved
 * 
 */
(window["qJsonp"]=window["qJsonp"]||[]).push([[80],{1148:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var i=o(n(98));var a=o(n(116));var s=n(1149);var r=o(n(91));function o(t){return t&&t.__esModule?t:{default:t}}var l=function t(e){var n=e.children;return i.default.createElement("div",{className:"qs-view-error","data-tid":"unsupported-device"},i.default.createElement("div",{className:"qs-view-error__center"},i.default.createElement("div",{className:"qs-view-error__image"},i.default.createElement(s.ReactComponent,null)),i.default.createElement("div",{className:"qs-view-error__title"},r.default.get("UnsupportedDisplaySize.Title")),i.default.createElement("div",{className:"qs-view-error__message"},r.default.get("UnsupportedDisplaySize.Message")),n?i.default.createElement("div",null,n):null))};l.propTypes={children:a.default.node};l.defaultProps={children:null};var c=l;e.default=c;t.exports=e.default},1149:function(t,e,n){"use strict";n.r(e);n.d(e,"ReactComponent",function(){return l});var i=n(98);var a=n.n(i);function s(){s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};return s.apply(this,arguments)}var r=a.a.createElement("defs",null,a.a.createElement("path",{d:"M5 1h147a4 4 0 0 1 4 4v102a4 4 0 0 1-4 4H5a4 4 0 0 1-4-4V5a4 4 0 0 1 4-4z",id:"Display_size_not_supported_svg__a"}),a.a.createElement("mask",{id:"Display_size_not_supported_svg__b",maskContentUnits:"userSpaceOnUse",maskUnits:"objectBoundingBox",x:-2,y:-2,width:159,height:114},a.a.createElement("path",{fill:"#fff",d:"M-1-1h159v114H-1z"}),a.a.createElement("use",{xlinkHref:"#Display_size_not_supported_svg__a"})),a.a.createElement("path",{d:"M24.659 20.094c.783 1.25.156 2.343-1.254 2.343H1.625c-1.566 0-2.036-1.093-1.253-2.343L11.027 1.5c.783-1.25 2.037-1.25 2.82 0L24.66 20.094zm-10.596-12.5c0-.469-.313-.782-.782-.782H11.72c-.469 0-.781.313-.781.782v6.25c0 .469.312.781.78.781h1.563c.469 0 .781-.313.781-.781v-6.25zm0 9.375c0-.469-.313-.782-.782-.782H11.72c-.469 0-.781.313-.781.782v1.562c0 .469.312.782.78.782h1.563c.469 0 .781-.313.781-.782V16.97z",id:"Display_size_not_supported_svg__c"}),a.a.createElement("path",{d:"M16.563 0H25v8.438c0 .312-.469.468-.625.312l-2.5-2.5-2.5 2.5a.755.755 0 0 1-1.094 0L16.25 6.719a.755.755 0 0 1 0-1.094l2.5-2.5-2.5-2.5c-.156-.156 0-.625.313-.625zM8.438 25H0v-8.438c0-.312.469-.468.625-.312l2.5 2.5 2.5-2.5a.755.755 0 0 1 1.094 0l2.031 2.031a.755.755 0 0 1 0 1.094l-2.5 2.5 2.5 2.5c.156.156 0 .625-.313.625z",id:"Display_size_not_supported_svg__e"}),a.a.createElement("path",{d:"M24.659 20.094c.783 1.25.156 2.343-1.254 2.343H1.625c-1.566 0-2.036-1.093-1.253-2.343L11.027 1.5c.783-1.25 2.037-1.25 2.82 0L24.66 20.094zm-10.596-12.5c0-.469-.313-.782-.782-.782H11.72c-.469 0-.781.313-.781.782v6.25c0 .469.312.781.78.781h1.563c.469 0 .781-.313.781-.781v-6.25zm0 9.375c0-.469-.313-.782-.782-.782H11.72c-.469 0-.781.313-.781.782v1.562c0 .469.312.782.78.782h1.563c.469 0 .781-.313.781-.782V16.97z",id:"Display_size_not_supported_svg__g"}));var o=a.a.createElement("g",{fill:"none",fillRule:"evenodd"},a.a.createElement("g",{transform:"translate(31 1)",fillRule:"nonzero"},a.a.createElement("use",{strokeOpacity:.15,stroke:"#000",mask:"url(#Display_size_not_supported_svg__b)",strokeWidth:4,strokeDasharray:"5",xlinkHref:"#Display_size_not_supported_svg__a"}),a.a.createElement("rect",{stroke:"#A6A6A6",strokeWidth:2,fill:"#FFF",width:125,height:112,rx:4}),a.a.createElement("path",{d:"M4 0h117a4 4 0 0 1 4 4v5H0V4a4 4 0 0 1 4-4z",fill:"#A6A6A6"}),a.a.createElement("path",{fill:"#C7C7C7",d:"M1 4h123v8H1z"}),a.a.createElement("circle",{fill:"#FFF",cx:7,cy:8,r:2}),a.a.createElement("circle",{fill:"#FFF",cx:19,cy:8,r:2}),a.a.createElement("path",{fill:"#FFF",d:"M27 6h77v4H27z"}),a.a.createElement("circle",{fill:"#FFF",cx:13,cy:8,r:2}),a.a.createElement("path",{fill:"#FFF",d:"M116 6h4v4h-4zM110 6h4v4h-4z"})),a.a.createElement("g",{transform:"translate(82 47)"},a.a.createElement("mask",{id:"Display_size_not_supported_svg__d",fill:"#fff"},a.a.createElement("use",{xlinkHref:"#Display_size_not_supported_svg__c"})),a.a.createElement("use",{fill:"#000",fillRule:"nonzero",xlinkHref:"#Display_size_not_supported_svg__c"}),a.a.createElement("g",{mask:"url(#Display_size_not_supported_svg__d)",fill:"#CCC"},a.a.createElement("path",{d:"M0-1h25v25H0z"}))),a.a.createElement("g",{opacity:.099,transform:"scale(-1 1) rotate(45 -169.276 -149.794)"},a.a.createElement("mask",{id:"Display_size_not_supported_svg__f",fill:"#fff"},a.a.createElement("use",{xlinkHref:"#Display_size_not_supported_svg__e"})),a.a.createElement("use",{fill:"#000",fillRule:"nonzero",xlinkHref:"#Display_size_not_supported_svg__e"}),a.a.createElement("g",{mask:"url(#Display_size_not_supported_svg__f)",fill:"#000"},a.a.createElement("path",{d:"M0 0h25v25H0z"}))),a.a.createElement("g",{transform:"translate(1 51)"},a.a.createElement("rect",{stroke:"#A6A6A6",fill:"#A6A6A6",fillRule:"nonzero",x:.218,y:-.5,width:48.825,height:84,rx:4}),a.a.createElement("rect",{fill:"#FFF",fillRule:"nonzero",x:2.595,y:1.875,width:44.072,height:79.25,rx:2}),a.a.createElement("rect",{fill:"#A6A6A6",fillRule:"nonzero",x:11,width:27,height:7,rx:2}),a.a.createElement("g",{transform:"translate(12 30)"},a.a.createElement("mask",{id:"Display_size_not_supported_svg__h",fill:"#fff"},a.a.createElement("use",{xlinkHref:"#Display_size_not_supported_svg__g"})),a.a.createElement("use",{fill:"#000",fillRule:"nonzero",xlinkHref:"#Display_size_not_supported_svg__g"}),a.a.createElement("g",{mask:"url(#Display_size_not_supported_svg__h)",fill:"#CCC"},a.a.createElement("path",{d:"M0-1h25v25H0z"})))));var l=function t(e){return a.a.createElement("svg",s({width:189,height:135},e),r,o)};e["default"]="../../img/core/Display_size_not_supported.c7cb99290f301c32e6667975b2e71c07.svg"},1272:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(1669),n(48),n(91),n(118),n(117),n(214),n(197),n(125),n(380),n(1211),n(1273),n(1081),n(89),n(103)],a=function(t,e,n,i,a,s,r,o,l,c,u,d,p,h,f){var g=1e3;return{template:e,controller:["$scope","$timeout","$interval","qvConfirmDialog",function(e,v,m,b){var y,S,I,x,q="scripteditor.progressindicator.closewhenfinished";var w;e.logMessages=[];e.runFinished=false;e.isFinished=false;e.closeWhenFinished=o.get(q,false).value;e.finishedWithError=false;e.hadErrorOrWarning=false;var C=false;var P=false;var E=0;var k={title:"scripteditor.progressindicator.abortbutton",tid:"2f0456",isDisabled:true,eventHandler:function t(){e.onCancelClicked()}},T={title:"Common.Close",tid:"2f0421",isDisabled:true,focus:false,eventHandler:function t(){e.onCloseClicked()}};e.buttons=[k];e.$watch("closeWhenFinished",function(t){o.set(q,{value:t})});function O(){if(true===e.isFinished){e.input.onClose&&e.input.onClose();e.destroyComponent();e.deferredResult.resolve()}else e.abortDialogActive||e.runFinished||e.buttons[0].isDisabled||e.onCancelClicked()}e.onCloseClicked=O;e.onEscape=O;function A(){for(var t in e.logMessages){var n=e.logMessages[t],i=n.content.split("\n"),s=n.type&&a.contains(n.type,"empty");for(var r=0;r<i.length;r++){var o=i[r];if(!o&&!s)continue;var l;l=n.type&&a.contains(n.type,"edc_error")?u.MESSAGE_TYPE.ERROR:n.type&&(a.contains(n.type,"synthetic_key")||a.contains(n.type,"edc_circular_reference"))?u.MESSAGE_TYPE.WARNING:s?u.MESSAGE_TYPE.EMPTY:u.MESSAGE_TYPE.DEFAULT;u.addMessage(l,o)}}}e.onCancelClicked=function(){w=true;if(!e.abortDialogActive){e.abortDialogActive=true;k.focus=false;var n="scripteditor.cancelscriptrundialog.title",a="scripteditor.cancelscriptrundialog.content";if(C){n="scripteditor.cancelscriptrundialog.searchindex.title";a="scripteditor.cancelscriptrundialog.searchindex.content"}e.dialogHandle=b.show({title:i.get(n),message:i.get(a),okLabel:i.get("Common.Yes"),cancelLabel:i.get("Common.No")});e.dialogHandle.closed.then(function(n){if(n){w=true;s.global.cancelReload();F()}else{e.abortDialogActive=false;t(".qv-scripteditor-progressindicator .lui-dialog").focus();k.focus=true}})}};function $(){var t=(new Date-y)/1e3,n=c.formatNum(t/3600)+":"+c.formatNum(t%3600/60)+":"+c.formatNum(t%60);e.elapsedTime=n}function D(){e.isStopped=false;e.elapsedTime="HH:MM:SS";d.reloadStarted();y=new Date;$();S=v(function t(){$();S=v(t,500)},500)}function _(){P=false;var e=t(".qv-progressindicator.scrolly");e.on("scroll",function(){e.scrollTop()<E&&(P=true)});G(1);x=false;I=m(M,1e3)}function M(){if(!x){x=true;return s.global.getProgress(0).then(L,function t(){N()})}}function N(){x=false;m.cancel(I)}function F(){e.isFinished=true;e.isStopped=true;v.cancel(S);e.input.progressIndicator.setActive(false);B();t(".executingscript").text(i.get("scripteditor.progressindicator.executingscriptdone"));e.closeWhenFinished&&!e.finishedWithError&&v(function(){e.closeWhenFinished&&e.onCloseClicked()},1400)}function L(t){var n=t.qProgressData.qPersistentProgressMessages,a=t.qProgressData.qTransientProgressMessage,s=t.qProgressData.qErrorData;if(!!n&&n.length>0){var r=c.translateMessageArray(n);var o=/\$Syn \d+ =/gi.test(r),l=o?r.match(/\$Syn \d+ =/gi).length:0;e.hadErrorOrWarning=e.hadErrorOrWarning||!!l;H({content:r,type:o?"synthetic_key":"",count:l});n.forEach(function(t){C=22===t.qMessageCode})}else a&&H({content:c.translateMessage(a),type:"transient"});s&&c.filterOutDuplicates(s).forEach(function(t){e.hadErrorOrWarning=true;e.finishedWithError=true;var n=t.qErrorDataCode.toLowerCase();R(i.get("scripteditor.progressindicator.followingerror")+":",n);H({content:t.qErrorString?t.qErrorString:"",type:n});R(i.get("scripteditor.progressindicator.errorhere")+":",n);H({content:t.qLine?t.qLine:"?",type:n})});x=false}function R(t,e){G(1);H({content:t,type:"headline "+e})}function j(){var t=["edc_error","synthetic_key"],n=[],a=-1,s=-1;e.logMessages.forEach(function(t,e){"edc_circular_reference"===t.type?a=e:"headline summary_headline"===t.type&&(s=e)});l.move(e.logMessages,a,s);e.logMessages=e.logMessages.map(function(t){if("edc_circular_reference"===t.type){t.type+=" summary";t.content=i.get("scripteditor.progressindicator.edc_circular_referencesummary")+":\n"+t.content}return t});t.forEach(function(t){var a,s=0;e.logMessages.forEach(function(e){e.type===t&&(s=e.count?s+e.count:s+1)});a="summary";s>0&&(a+=" "+t);n.push({content:i.get("scripteditor.progressindicator."+t+"summary",[s]),type:a})});n.forEach(H)}function G(t,e){for(var n=0;n<t;n++)H({content:"",type:"empty "+e})}function H(t){if(t){t.content&&(t.content=t.content.trim());e.logMessages.length&&"transient"===e.logMessages[e.logMessages.length-1].type&&e.logMessages.pop();e.logMessages.push(t);e.logMessages.length>g&&e.logMessages.splice(0,1);v(function(){if(!P){var t=document.getElementsByClassName("qv-progressindicator log");if(t&&t[0]){t[0].scrollTop=t[0].scrollHeight;E=t[0].scrollTop}}})}}function V(){T.isDisabled=true;k.isDisabled=false;k.focus=true;e.buttons=[k]}function B(){k.isDisabled=true;T.isDisabled=false;T.focus=true;e.buttons=[T]}function z(){v(function(){T.isDisabled=true;H({content:i.get("scripteditor.progressindicator.savingapp"),type:"transient"})});return e.input.scriptModel.setAndPersistScript().then(function(){R(i.get("scripteditor.progressindicator.appsaved"));v(function(){T.isDisabled=false})})}function U(t){e.runFinished=true;k.isDisabled=true;v(function(){if(e.dialogHandle){e.dialogHandle.close();k.disabled=true}});H({content:"\n",type:"transient"});if(t)return z().then(function(){true===e.hadErrorOrWarning?R(i.get("scripteditor.progressindicator.runfinishedwitherrorsorwarnings"),"summary_headline"):R(i.get("scripteditor.progressindicator.runfinished"),"summary_headline");j()});e.finishedWithError=true;R(w?i.get("scripteditor.progressindicator.runaborted"):i.get("scripteditor.progressindicator.runfail"));r.doDirtyRollback();return n.promise()}function K(t){return t&&t.error&&t.error.code?t.error.code:0}function Q(t){H({content:i.get("ErrorCode."+K(t)),type:"edc_error"});t&&(t.isHandled=true);e.finishedWithError=true;U(false).then(function(){F();A()})}function W(){u.clear();e.input.progressIndicator.setActive(true);R(i.get("scripteditor.progressindicator.runstarted"));D();var t=new h.resolve;function n(){return p.getRunLoadModelActions().then(function(t){return t},function(){return{executeBeforeRun:function e(){return t},executeAfterRun:function e(){return t}}})}n().then(function(t){e.input.scriptModel.fastSave().then(e.input.scriptModel.checkScriptSyntax).then(function(){t.executeBeforeRun().then(function(){V();_();return e.input.scriptModel.run().then(function(n){return s.global.getProgress(0).then(L).then(function(){N();return U(n).then(function(){return t.executeAfterRun(n).then(function(){F();A();f.trackEvent(f.customEvents.DATA_LOAD_ELAPSED_TIME,{Time_elapsed:e.elapsedTime})},Q)},Q)},Q)},Q)},Q)},Q)},Q)}W()}]}}.apply(e,i),void 0!==a&&(t.exports=a))},1273:function(t,e,n){"use strict";var i,a;!(i=[n(1151)],a=function(t){var e="reload-started-by-scripteditor";function n(){t.publish(e)}function i(n){t.subscribe(e,n)}return{reloadStarted:n,onReloadStarted:i}}.apply(e,i),void 0!==a&&(t.exports=a))},1589:function(t,e,n){"use strict";var i,a;!(i=[n(51),n(1590),n(145)],a=function(t,e){var n={template:e,scope:{text:"=",icon:"=",confirmLabel:"="},controller:["$scope",function(t){t.close=function(){t.destroyComponent();t.deferredResult.resolve()}}]};function i(e){var i=e.text;var a=void 0!==e.icon?e.icon:"cogwheel";var s=e.confirm||"Common.OK";var r={text:i,icon:a,confirmLabel:s};return t.show(n,r).resultPromise}return{show:i}}.apply(e,i),void 0!==a&&(t.exports=a))},1590:function(t,e){t.exports='<qv-modal-dialog qv-id="notification-dialog" qv-cancel="close()" qv-confirm="close()">\n    <main class="dm-main">\n        <div class="qv-mvc-dialog-content">\n            <div class="qv-mvc-dialog-icon icon-{{icon}}" ng-show="icon"></div>\n            <p><span q-translation="{{text}}"></span></p>\n        </div>\n    </main>\n    <footer class="dm-footer">\n        <lui-button x-variant="inverse" qva-activate="$event.preventDefault(); close()" name="confirm" autofocus q-translation="{{confirmLabel}}"></lui-button>\n    </footer>\n</qv-modal-dialog>\n'},1665:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=e.openEmbedDialog=e.AnalysisToolbarProvider=void 0;var i=r(n(98));var a=s(n(116));function s(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,n):{};i.get||i.set?Object.defineProperty(e,n,i):e[n]=t[n]}e.default=t;return e}function o(t){o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return o(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,i.key,i)}}function u(t,e,n){e&&c(t.prototype,e);n&&c(t,n);return t}function d(t,e){if(e&&("object"===o(e)||"function"===typeof e))return e;return h(t)}function p(t){p=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return p(t)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});e&&g(t,e)}function g(t,e){g=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return g(t,e)}var v=[];var m=function t(e){return v.push(e)};var b=function t(e){v=v.filter(function(t){return t!==e})};var y=function t(e){return v.forEach(function(t){return t(e)})};e.openEmbedDialog=y;var S=i.default.createContext(null);var I=function(t){f(e,t);function e(t){var n;l(this,e);n=d(this,p(e).call(this,t));n.openEmbedDialog=n.openEmbedDialog.bind(h(n));n.closeEmbedDialog=n.closeEmbedDialog.bind(h(n));n.state={showEmbedDialog:false,embedType:"",embedObjectId:"",actions:{openEmbedDialog:n.openEmbedDialog,closeEmbedDialog:n.closeEmbedDialog}};return n}u(e,[{key:"componentDidMount",value:function t(){m(this.openEmbedDialog)}},{key:"componentWillUnmount",value:function t(){b(this.openEmbedDialog)}},{key:"openEmbedDialog",value:function t(e){var n=e.type,i=e.objectId;this.setState({showEmbedDialog:true,embedType:n,embedObjectId:i})}},{key:"closeEmbedDialog",value:function t(){this.setState({showEmbedDialog:false})}},{key:"render",value:function t(){var e=this.props.children;return i.default.createElement(S.Provider,{value:this.state},e)}}]);return e}(i.PureComponent);e.AnalysisToolbarProvider=I;I.propTypes={children:a.default.node.isRequired};var x=S.Consumer;e.default=x},1666:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var i=l(n(98));var a=o(n(116));var s=o(n(110));var r=o(n(1767));function o(t){return t&&t.__esModule?t:{default:t}}function l(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,n):{};i.get||i.set?Object.defineProperty(e,n,i):e[n]=t[n]}e.default=t;return e}function c(t){c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return c(t)}function u(){u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};return u.apply(this,arguments)}function d(t,e){if(null==t)return{};var n=p(t,e);var i,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++){i=s[a];if(e.indexOf(i)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(t,i))continue;n[i]=t[i]}}return n}function p(t,e){if(null==t)return{};var n={};var i=Object.keys(t);var a,s;for(s=0;s<i.length;s++){a=i[s];if(e.indexOf(a)>=0)continue;n[a]=t[a]}return n}function h(t,e){return v(t)||g(t,e)||f()}function f(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function g(t,e){var n=[];var i=true;var a=false;var s=void 0;try{for(var r=t[Symbol.iterator](),o;!(i=(o=r.next()).done);i=true){n.push(o.value);if(e&&n.length===e)break}}catch(t){a=true;s=t}finally{try{i||null==r["return"]||r["return"]()}finally{if(a)throw s}}return n}function v(t){if(Array.isArray(t))return t}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,i.key,i)}}function y(t,e,n){e&&b(t.prototype,e);n&&b(t,n);return t}function S(t,e){if(e&&("object"===c(e)||"function"===typeof e))return e;return x(t)}function I(t){I=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return I(t)}function x(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function q(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});e&&w(t,e)}function w(t,e){w=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return w(t,e)}function C(t){return t.displayName||t.name||"Component"}function P(t,e){var n=function(n){q(a,n);function a(t){var e;m(this,a);e=S(this,I(a).call(this,t));e.state={sheet:null};e.updateSheet=e.updateSheet.bind(x(e));return e}y(a,[{key:"componentDidMount",value:function t(){this.updateSheet()}},{key:"componentDidUpdate",value:function t(e){var n=this.props.urlParameters;n!==e.urlParameters&&this.updateSheet()}},{key:"componentWillUnmount",value:function t(){this.unmounting=true}},{key:"updateSheet",value:function t(){var n=this;var i=this.props,a=i.app,o=i.urlParameters;var l=h(o,1),c=l[0];a.getObject(c).then(function(t){n.unmounting||n.setState({sheet:t})},function(t){if(e){var n=t.error.code===s.default.NxLocalizedErrorCode.LOCERR_GENERIC_NOT_FOUND;(0,r.default)(n)}})}},{key:"render",value:function e(){var n=this.props,a=n.urlParameters,s=d(n,["urlParameters"]);var r=this.state.sheet;if(!r)return null;var o=h(a,3),l=o[1],c=o[2];return i.default.createElement(t,u({},s,{args:c,state:l,sheet:r}))}}]);return a}(i.Component);n.propTypes={app:a.default.object.isRequired,urlParameters:a.default.array.isRequired};n.displayName="WithSheet(".concat(C(t),")");return n}var E=P;e.default=E;t.exports=e.default},1667:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var i=o(n(98));var a=r(n(116));var s=r(n(1767));function r(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,n):{};i.get||i.set?Object.defineProperty(e,n,i):e[n]=t[n]}e.default=t;return e}function l(t){l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return l(t)}function c(){c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};return c.apply(this,arguments)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,i.key,i)}}function p(t,e,n){e&&d(t.prototype,e);n&&d(t,n);return t}function h(t,e){if(e&&("object"===l(e)||"function"===typeof e))return e;return g(t)}function f(t){f=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return f(t)}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});e&&m(t,e)}function m(t,e){m=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return m(t,e)}function b(t){return t.displayName||t.name||"Component"}function y(t,e){var n=function(n){v(a,n);function a(t){var e;u(this,a);e=h(this,f(a).call(this,t));e.state={sheetLayout:null};e.updateSheet=e.updateSheet.bind(g(e));return e}p(a,[{key:"componentDidMount",value:function t(){var e=this.props.sheet;e&&this.updateSheet()}},{key:"componentDidUpdate",value:function t(e){var n=this.props.sheet;n!==e.sheet&&this.updateSheet()}},{key:"componentWillUnmount",value:function t(){this.unmounting=true}},{key:"updateSheet",value:function t(){var n=this;var i=this.props.sheet;i.getLayout().then(function(t){n.unmounting||("sheet"===t.qInfo.qType?n.setState({sheetLayout:t}):e&&(0,s.default)(true))})}},{key:"render",value:function e(){var n=this.state.sheetLayout;if(!n)return null;return i.default.createElement(t,c({},this.props,{sheetLayout:n}))}}]);return a}(i.Component);n.propTypes={sheet:a.default.object};n.defaultProps={sheet:null};n.displayName="WithSheetLayout(".concat(b(t),")");return n}var S=y;e.default=S;t.exports=e.default},1669:function(t,e){t.exports='<div class="lui-dialog qv-scripteditor-progressindicator" qva-outside-ignore-for="allOutside" ng-style="containerStyle" qv-global-escape="onEscape()" qv-abso>\n\t<div class="lui-dialog__header dm-header">\n\t\t<div class="lui-dialog__title" q-translation="scripteditor.progressindicator.title" tid="2f0526"></div>\n\t</div>\n\t<main class="lui-dialog__body dm-main">\n\t\t<div class="section clearfix">\n\t\t\t<div class="qv-loader" ng-class="{ \'hide\' : isFinished}"></div>\n\t\t\t<div class="executingscript" q-translation="scripteditor.progressindicator.executingscript"></div>\n\t\t\t<div class="header" q-translation="scripteditor.progressindicator.header" ng-class="{ \'hide\' : isFinished }"></div>\n\t\t\t<div class="elapsed">\n\t\t\t\t<span q-translation="scripteditor.progressindicator.elapsedtime"></span>\n\t\t\t\t<span class="time">{{elapsedTime}}</span>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="qv-progressindicator log borderbox scrolly">\n\t\t\t\t<div ng-repeat="message in logMessages" class="{{ message.type }}">{{ message.content }}</div>\n\t\t\t\n\t\t</div>\n\t</main>\n\t<footer class="lui-dialog__footer">\n\t\t<lui-checkbox x-model="closeWhenFinished">{{ \'scripteditor.progressindicator.closecheckbox\' | translate }}</lui-checkbox>\n\t\t<div class="button-wrap">\n\t\t\t<lui-button ng-repeat="button in buttons" tid="{{ button.tid }}" ng-click="$event.preventDefault(); button.eventHandler()" ng-disabled="button.isDisabled" q-translation="{{ button.title }}" qva-focus="button.focus"></lui-button>\n\t\t</div>\n\t</footer>\n</div>\n'},1672:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(108),n(1673),n(165),n(1674),n(101),n(128),n(131),n(90),n(91),n(315),n(1675)],a=function(t,e,n,i,a,s,r,o,l,c){t.directive("qvPropertyPanel",function(){return{template:n,restrict:"E",replace:true,scope:{ignorePatches:"<"},controller:["$scope",function(n){var u={};n.subPanels=[];o.selectedObject&&o.selectedObject.getAllPropertyPanelContent().then(function(t){if(t){var e={components:null,localeInfo:null,app:null,ext:null,globalChangeListeners:null,handler:null};l.extend(e,t);f(e)}}).catch(function(){});function d(t){n.title=s.getValue(t,n.titleRef||"title");n.subtitle=t.subtitle;n.isInvalid=t.qError||"invalid"===u.type;e.inClient()&&(n.isPatched=t.qHasSoftPatches)}function p(t){return t.model.app.getObject(t.properties.qExtendsId).then(function(t){return t.getLayout().then(function(t){return t.permissions.update})})}n.$on("$destroy",function(){u.model&&u.model.Invalidated.unbind(h)});function h(){u.model.getLayout().then(function(t){var e=t.visualization||t.qInfo&&t.qInfo.qType;if(!e)return;if(e!==u.type){u.type=e;return}n.$broadcast("layoutchanged",t);d(t);u.model.getProperties().then(function(t){if(t.qInfo.qId!==u.model.id&&"widget"!==u.type)return;n.args.prevProperties=t;t=l.extend(true,{},t);n.data=t;n.args.properties=t;u.properties=t;u.handler&&u.handler.setProperties(t);n.isLinked=!!t.qExtendsId;n.$broadcast("datachanged",t);n.isLinked&&p(u).then(function(t){n.showEditMasterPropsBtn=t})})})}n.$on("saveProperties",function(t,e){t.stopPropagation();e=e||n.data;u.globalChangeListeners&&u.globalChangeListeners.forEach(function(t){t&&"function"===typeof t&&t(e,n.args.handler,n.args)});u.model.setProperties(e)});n.$on("updateContent",function(t,e){t.preventDefault();f(e)});function f(t){n.subPanels.length=0;a.loadComponents().then(function(){u.model&&u.model.Invalidated.unbind(h);var e=l.extend(true,{},t.properties);var a={prevProperties:null,properties:e,cache:t.cache,layout:t.layout,model:t.model,localeInfo:t.localeInfo,app:t.app,ext:t.ext,yMirrorMode:t.yMirrorMode};if(t.handler){t.handler.setProperties(e);t.handler.setLayout(t.layout);a.handler=t.handler}n.data=e;n.definition=t.definition;n.args=a;n.args.iconName=t.iconName;n.args.headerLabel=t.headerLabel;n.args.headerAction=t.headerAction;n.iconName=t.iconName;n.isLinked=!!e.qExtendsId;n.showEditMasterPropsBtn=false;n.isLinked&&p(t).then(function(t){n.showEditMasterPropsBtn=t});n.headerComponentDefinition={type:"items",component:"header-with-switch",translation:n.data.title};n.headerComponent=l.extend({},i.findComponent({type:"items",component:"header-with-switch"}));n.rootComponent=l.extend({},i.findComponent(t.definition));u=t;t.model.Invalidated.bind(h);d(t.layout);n.isReady=true;var s=u.definition.interceptor;if(s&&l.isFunction(s)){var r=s(n);if(r&&l.isFunction(r.then)){n.isReady=false;r.then(function(){n.isReady=true})}}(t.model.isInvalid||t.model.isValidating)&&h()})}var g=n.$root.$on("showSubPanel",function(t,e){t.preventDefault();if(!e.id)throw new Error("A sub-panel need to have an id specified!");if(!e.triggerId)throw new Error("A sub-panel need to have a triggerId specified!");var i=n.subPanels.some(function(t){return t.options.triggerId===e.triggerId||t.options.id===e.id});i||n.subPanels.push({directiveHook:{},options:e})});var v=n.$root.$on("hideSubPanel",function(t,e){e=e||{};var i=n.subPanels||[];if(!i.length)return;if(e.hasOwnProperty("id")){if(!e.id)throw Error("PP: Invalid subpanel ID");var a=i.filter(function(t){return t.options.id===e.id});a.length&&a[0].directiveHook.close()}else if(e.all){var s=void 0===e.forceClose||e.forceClose;i.forEach(function(t){t.directiveHook.close(s)})}else i[i.length-1].directiveHook.close()});n.savePatches=function(){u.model.getEffectiveProperties().then(function(t){u.model.setProperties(t).then(function(){u.model.clearSoftPatches()})})};n.clearPatches=function(){u.model.clearSoftPatches()};n.editMasterProps=function(){t.getService("qvConfirmDialog").show({message:c.get("Object.Master.EditWarning.Text"),icon:"cogwheel"}).closed.then(function(t){t&&r.editMaster(u.properties.qExtendsId,u.properties.qInfo.qType)})};n.$on("$destroy",function(){g();v()})}]}})}.apply(e,i),void 0!==a&&(t.exports=a))},1673:function(t,e){t.exports='<div class="qv-property-panel">\n\t<div ng-if="!isInvalid && isLinked" class="overlay">\n\t\t<div class="overlay-content">\n\t\t\t<section>\n\t\t\t\t<div class="icon lui-icon lui-icon--link"></div>\n\t\t\t\t<p class="title" q-translation="Object.Linked.NoEdit.PropPanel.Title"></p>\n\t\t\t\t<p class="message" q-translation="Object.Linked.NoEdit.PropPanel.Text" ng-if="!showEditMasterPropsBtn"></p>\n\t\t\t\t<p class="message" q-translation="Object.Linked.Edit.PropPanel.Text" ng-if="showEditMasterPropsBtn"></p>\n\t\t\t\t<button class="lui-button" qva-activate="editMasterProps()" ng-if="showEditMasterPropsBtn" tid="edit-master-item">\n\t\t\t\t\t<span q-translation="Common.Edit"></span>\n\t\t\t\t</button>\n\t\t\t</section>\n\t\t</div>\n\t</div>\n\t<div ng-if="isInvalid" class="overlay">\n\t\t<div class="overlay-content">\n\t\t\t<section>\n\t\t\t\t<p class="title" q-translation="Object.Invalid.NoEdit.PropPanel.Title"></p>\n\t\t\t\t<p q-translation="Object.Invalid.NoEdit.PropPanel.Text"></p>\n\t\t\t</section>\n\t\t</div>\n\t</div>\n\t<div ng-if="!isLinked && isPatched && !ignorePatches" class="overlay">\n\t\t<div class="overlay-content">\n\t\t\t<section>\n\t\t\t\t<div class="lui-icon lui-icon--control"></div>\n\t\t\t\t<p class="title" q-translation="Object.VisualExploration.NoEdit.PropPanel.Title"></p>\n\t\t\t\t<p q-translation="Object.VisualExploration.NoEdit.PropPanel.Text"></p>\n\t\t\t</section>\n\n\t\t\t<div class="space"></div>\n\t\t\t<section>\n\t\t\t\t<button class="lui-button" qva-activate="savePatches()">\n\t\t\t\t\t<span q-translation="Common.Apply"></span>\n\t\t\t\t</button>\n\t\t\t</section>\n\n\t\t\t<div class="space"></div>\n\t\t\t<section>\n\t\t\t\t<button class="lui-button" qva-activate="clearPatches()">\n\t\t\t\t\t<span q-translation="Common.Discard"></span>\n\t\t\t\t</button>\n\t\t\t</section>\n\t\t</div>\n\t</div>\n\n\t<div include-pp-component x-component="headerComponent" x-definition="headerComponentDefinition" x-data="data" x-args="args"></div>\n\n\t<div class="property-content" ng-if="(!isLinked && !isPatched && isReady) || ignorePatches" include-pp-component x-component="rootComponent" x-args="args" x-definition="definition" x-data="data"></div>\n\n  \t<qv-property-sub-panel ng-repeat="subPanel in subPanels"></qv-property-sub-panel>\n</div>\n'},1675:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(1676),n(101),n(90),n(204),n(156),n(165)],a=function(t,e,n,i,a,s,r){t.directive("qvPropertySubPanel",function(){return{template:e,restrict:"E",replace:true,controller:["$scope","$timeout",function(t,e){var o="100%";var l={show:true,hide:true};var c="items.data";var u=t.subPanel;var d=u.options;var p=d.layoutPath;var h=d.propertiesPath;var f=null;var g=d.dataPath||c;d.transitions=i.extend({},l,d.transitions);t.classes={transitions:d.transitions.show};t.style={width:d.width||o,right:"-"+(d.width||o),top:0,zIndex:21};t.getTitle=function(){return"function"===typeof d.title?d.title(u.data,u.args.handler):d.title};t.subTitle=d.subTitle;d.footer&&(t.footerButtons=d.footer.items.filter(function(t){return"button"===t.type}));m();function v(){var e=i.extend({},t.args);var a=e.properties;var s=e.layout;p&&(s=n.getValue(e.layout,p));e.layout=s;var r=a;h&&(r=n.getValue(a,h));if(!r){t.stepOut();return}e.properties=r;if(f){e.handler=f;e.handler.setProperties(r);e.handler.setLayout(s)}u.args=e;u.data=r}function m(){var i=d.definition;var o=s.mapDefinition(i);var l=n.getValue(o,g);f=l?new a({app:t.args.app,dimensionDefinition:l.dimension||{},measureDefinition:l.measure||{}}):null;u.component=r.findComponent(i);u.definition=o;d.activePath&&d.definition.cacheKey&&t.args.cache.put("accordion_path_"+d.definition.cacheKey,d.activePath);v();e(function(){t.style.right=0;t.style.opacity=1})}function b(e){var n=t.subPanels.map(function(t){return t.options.id});var i=n.indexOf(e);if(-1===i)return;t.subPanels.splice(i,1);"function"===typeof d.stepOutCallback&&d.stepOutCallback(e)}function y(n){if(n||!d.transitions.hide){t.subPanel=null;b(d.id);return}t.classes.transitions=d.transitions.hide;t.style.right="-"+(d.width||o);t.style.opacity=0;e(b.bind(null,d.id),300)}t.stepOut=y;u.directiveHook.close=y;t.$watch("data",function(){v()})}]}})}.apply(e,i),void 0!==a&&(t.exports=a))},1676:function(t,e){t.exports='<div class="qv-property-sub-panel" ng-class="classes" ng-style="style">\n\t<div class="property-sub-header" ng-click="stepOut()">\n\t\t<div class="header-wrapper">\n\t\t\t<div class="back-navigation">\n\t\t\t\t<span class="lui-icon back-icon  lui-icon--previous  lui-icon--small"></span>\n\t\t\t</div>\n\t\t\t<div class="text-wrapper">\n\t\t\t\t<div class="navigation-title">\n\t\t\t\t\t{{getTitle()}}\n\t\t\t\t</div>\n\t\t\t\t<div class="navigation-sub-title">\n\t\t\t\t\t{{subTitle}}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class="property-sub-content" include-pp-component\n\t\t x-component="subPanel.component"\n\t\t x-definition="subPanel.definition"\n\t\t x-data="subPanel.data"\n\t\t x-args="subPanel.args">\n\t</div>\n\n\t<div ng-if="footerButtons" class="property-sub-footer">\n\t\t<button ng-repeat="btn in footerButtons" class="lui-button lui-button--block" qva-activate="btn.action($event)">\n\t\t\t<span class="lui-button__text" q-translation="{{btn.translation}}"></span>\n\t\t\t<span ng-if="btn.icon" class="lui-button__icon lui-icon lui-icon--{{btn.icon}}" q-title-translation="{{btn.translation}}"></span>\n\t\t</button>\n\t</div>\n</div>'},168:function(t,e,n){"use strict";var i,a;!(i=[n(92),n(90),n(183)],a=function(t,e,n){var i;var a;var s;var r=t.extend("PrecedentsService",{init:function t(){},_getAPI:function t(){i||(i=n.getApi("api/precedent/v1","openapi"));return i},_handleRestResponse:function t(e,n,i){return i.body.response},_getAppName:function t(){return e.getParameterByName("app")},defineDimension:function t(e){var n=this;var i=arguments;var a={};a.targets=[{type:"dimension",dimension:e}];a.source={type:"user"};a.relation={relation:"define"};return this._getAPI().then(function(t){return t.apis.precedents.addPrecedent({appId:n._getAppName()},{requestBody:a,server:t.spec.servers[0].url}).then(n._handleRestResponse.bind(n,"defineDimension",i))})},defineMeasure:function t(e){var n=this;var i=arguments;var a={};a.targets=[{type:"measure",measure:e}];a.source={type:"user"};a.relation={relation:"define"};return this._getAPI().then(function(t){return t.apis.precedents.addPrecedent({appId:n._getAppName()},{requestBody:a,server:t.spec.servers[0].url}).then(n._handleRestResponse.bind(n,"defineMeasure",i))})},dislikeField:function t(e){var n=this;var i=arguments;a=void 0;var s={};s.targets=[{type:"field",field:e}];s.source={type:"user"};s.relation={relation:"dislike"};return this._getAPI().then(function(t){return t.apis.precedents.addPrecedent({appId:n._getAppName()},{requestBody:s,server:t.spec.servers[0].url}).then(n._handleRestResponse.bind(n,"dislikeField",i))})},removeDefinedItem:function t(e){var n=this;var i=arguments;s=void 0;return this._getAPI().then(function(t){return t.apis.precedents.removePrecedent({appId:n._getAppName(),sourceType:"user",relation:"define",targetNodeId:e}).then(n._handleRestResponse.bind(n,"removeDefinedItem",i))})},getLearnedItems:function t(){var e=this;var n=arguments;if(s&&s.pending)return s;var i={};i.targets=[{type:"field"},{type:"libItem"},{type:"dimension"},{type:"measure"}];i.source={type:"user"};i.relations=[{relation:"define"},{relation:"dislike"}];s=this._getAPI().then(function(t){return t.apis.precedents.getRelationships({appId:e._getAppName()},{requestBody:i,server:t.spec.servers[0].url}).then(e._handleRestResponse.bind(e,"getDefinedItems",n))});return s},undislikeItem:function t(e){var n=this;var i=arguments;a=void 0;return this._getAPI().then(function(t){return t.apis.precedents.removePrecedent({appId:n._getAppName(),sourceType:"user",relation:"dislike",targetNodeId:e}).then(n._handleRestResponse.bind(n,"undislikeItem",i))})},getDislikedItems:function t(){var e=this;var n=arguments;if(a)return a;var i={};i.targets=[{type:"field"},{type:"libItem"}];i.source={type:"user"};i.relations=[{relation:"dislike"}];a=this._getAPI().then(function(t){return t.apis.precedents.getRelationships({appId:e._getAppName()},{requestBody:i,server:t.spec.servers[0].url}).then(e._handleRestResponse.bind(e,"getDislikedItems",n))});return a},dislikeLibItem:function t(e){var n=this;var i=arguments;a=void 0;var s={};s.targets=[{type:"libItem",libItem:e}];s.source={type:"user"};s.relation={relation:"dislike"};return this._getAPI().then(function(t){return t.apis.precedents.addPrecedent({appId:n._getAppName()},{requestBody:s,server:t.spec.servers[0].url}).then(n._handleRestResponse.bind(n,"dislikeLibItem",i))})},likeAnalysis:function t(e){var n=this;var i=arguments;var a={};a.targets=[{type:"analysis",analysis:e}];a.source={type:"user"};a.relation={relation:"like"};return this._getAPI().then(function(t){return t.apis.precedents.addPrecedent({appId:n._getAppName()},{requestBody:a,server:t.spec.servers[0].url}).then(n._handleRestResponse.bind(n,"likeAnalysis",i))})},dislikeAnalysis:function t(e){var n=this;var i=arguments;var a={};a.targets=[{type:"analysis",analysis:e}];a.source={type:"user"};a.relation={relation:"dislike"};return this._getAPI().then(function(t){return t.apis.precedents.addPrecedent({appId:n._getAppName()},{requestBody:a,server:t.spec.servers[0].url}).then(n._handleRestResponse.bind(n,"dislikeAnalysis",i))})},undislikeAnalysis:function t(e){var n=this;var i=arguments;return this._getAPI().then(function(t){return t.apis.precedents.removePrecedent({appId:n._getAppName(),sourceType:"user",relation:"dislike",targetNodeId:e.precedents.id}).then(n._handleRestResponse.bind(n,"undislikeAnalysis",i))})},scrapeApp:function t(){var e=this;var n=arguments;a=void 0;return this._getAPI().then(function(t){return t.apis.precedents.scrapeApp({appId:e._getAppName()}).then(e._handleRestResponse.bind(e,"scrapeApp",n))})}});return r}.apply(e,i),void 0!==a&&(t.exports=a))},169:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91)],a=function(t,e){var n=0;var i=6;var a=1;function s(t,e,s,o){var l;if(0===e.length)return;t[s]||(t[s]={});l=t[s];l.string=e;l.isWhitespace=o||e.length<a&&!r(e)||'"'===e;l.colorIx=l.isWhitespace?-1:n;n=l.isWhitespace?n:(n+1)%i}function r(t){return t.match(/[\u3040-\u9FBF]/)||t.match(/[\uFF65-\uFF9F]/)}function o(t,e,n,i){if(e.length<a&&!r(e))return;t.push({string:e,startQuote:n,endQuote:i})}t.service("qvGlobalSearchDataService",function(){this.transformResult=function(t,n){var i=n;t.matches=t.matches||[];t.searchTermGroups=t.searchTermGroups||[];t.searchVisualsGroups=t.searchVisualsGroups||[];for(var a=0;a<i.qSearchGroupArray.length;++a)if("DatasetType"===i.qSearchGroupArray[a].qGroupType){t.searchTermGroups.push(i.qSearchGroupArray[a]);var s=i.qSearchGroupArray[a];-1===t.matches.indexOf(s.qSearchTermsMatched.length)&&t.matches.push(s.qSearchTermsMatched.length)}else t.searchVisualsGroups.push(i.qSearchGroupArray[a]);t.displayResult.data=t.searchTermGroups.length>0;t.displayResult.visuals=t.searchVisualsGroups.length>0;t.searchVisualsGroups.length>0&&(t.existingChartGroupTitle=e.get("GlobalSearch.Existing.ChartsTitle",[t.searchVisualsGroups[0].qItems.length]))};this.showMore=function(t,e){if(!e||!t||1!==t.qSearchGroupArray.length)return;var n=t.qSearchGroupArray[0],i;for(var a=0;a<n.qItems.length;a++)if(n.qItems[a].qIdentifier===e.qIdentifier){i=n.qItems[a].qItemMatches;break}i&&(e.qItemMatches=i)};this.setHeaders=function(t){var e,n=0;for(e=0;e<t.searchTermGroups.length;e++)t.searchTermGroups[e].qTotalNumberOfItems>n&&(n=t.searchTermGroups[e].qTotalNumberOfItems);t.columnCount=n;t.columnWidth=Math.floor(100/n)+"%";t.shadowHeaders=t.shadowHeaders||[];t.shadowHeaders.splice(0,t.shadowHeaders.length-n);for(e=t.shadowHeaders.length;e<n;e++)t.shadowHeaders[e]={}};this.transformSuggest=function(t,e,n){var i,a=0,s,r=[];this.getUnderlinersAndSearchTerms(t.query,r,[]);n=void 0!==n?n:25;n=Math.min(n,e.qSuggestions.length);for(i=0;i<n;++i){s={value:e.qSuggestions[i].qValue,term:e.qSuggestions[i].qTerm};if(t.query===this.getResultingQueryFromSuggestion(r,s))continue;t.suggestions[a]=s;a++}t.suggestions.splice(a,t.suggestions.length-a)};this._whitespaces=[" ","\t","\n","\r","\r\n","　"];this.isWhiteSpaceAt=function(t,e){var n=this._whitespaces;var i=t.charAt(e),a;for(a=0;a<n.length;++a)if(i===n[a])return true;return false};this.getUnderlinersAndSearchTerms=function(t,e,i){var a=0,r=0,l=t.length,c=0,u,d=this._whitespaces,p=this;i.length=0;n=0;function h(t,e){var n,i,a;for(i=0;i<d.length;++i){n=t.indexOf(d[i],e);n>=0&&(!a||n<a)&&(a=n)}return a||-1}function f(t,e){var n;do{n=t.indexOf('"',e);e=n+1}while(n>=0&&e<l&&!p.isWhiteSpaceAt(t,e));return n}function g(){while(r<l&&p.isWhiteSpaceAt(t,r))r++;r>a&&s(e,t.substring(a,r),c++,true);a=r}g();while(a<l){if('"'===t.charAt(a)){s(e,t.substring(a,a+1),c++);r=f(t,++a);u=r>=0?t.substring(a,r):t.substring(a);s(e,u,c++);o(i,u,true,r>0);if(r<0)break;s(e,t.substring(r,r+1),c++);r+=1;a=r;g();continue}r=h(t,a);u=r>=0?t.substring(a,r):t.substring(a);s(e,u,c++);o(i,u,false,false);if(r<0)break;a=r;g()}e.splice(c,e.length-c)};this.getSuggestTerms=function(t,e){var n=this,i,a;function s(t){var e,i,a;t=t.trim();if(0===t.length)return null;e=t.length;i=e-1;a=-1;while(i>-1){if(n.isWhiteSpaceAt(t,i)){a=i+1;break}i--}a=Math.max(a,0);return t.substring(a,e)}a=s(t);i=e.map(function(t){return t.string});a&&2===a.length&&'"'===a.charAt(0)&&i.push(a.charAt(1));return i};this.getUnderlineLengthFromTermIx=function(t,e){var n=0,i,a=0;while(n<t.length){i=t[n];if(!(a<e||i.isWhitespace))break;if(n===t.length-1&&1===i.string.length&&!this.isWhiteSpaceAt(i.string,0)&&'"'!==i.string)break;i.isWhitespace||a++;n++}return n>0?n:0};this.getResultingQueryFromSuggestion=function(t,e){var n,i,a,s,r=this.getUnderlineLengthFromTermIx(t,e.term);n=t.slice(0,r).reduce(function(t,e){return t+e.string},"");i='"'===n.charAt(n.length-1);a=!i&&e.value.indexOf(" ")>=0;s=a||i;return n+(a?'"':"")+e.value+(s?'"':"")};this.getMinQueryLength=function(){return a};this.getMaxColorsNum=function(){return i}})}.apply(e,i),void 0!==a&&(t.exports=a))},1766:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.EmbedDialogComponent=p;e.default=h;var i=u(n(98));var a=n(171);var s=u(n(116));var r=u(n(1727));var o=u(n(2237));var l=u(n(988));var c=u(n(91));n(2243);function u(t){return t&&t.__esModule?t:{default:t}}function d(){d=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};return d.apply(this,arguments)}function p(t){var e=t.app,n=t.element,s=t.onClose,r=t.show,l=t.type,u=t.objectId;var d="sheet"===l?c.default.get("GlobalMenu.EmbedSheet"):c.default.get("contextMenu.embed");return i.default.createElement(a.Dialog,{tid:"105819",className:"qs-embed-dialog",show:r,parentElement:n,onEscape:s},i.default.createElement(a.Dialog.Header,null,i.default.createElement(a.Dialog.Title,null,d)),i.default.createElement(a.Dialog.Body,{className:"qs-embed-dialog__body"},i.default.createElement(o.default,{app:e,type:l,objectId:u})),i.default.createElement(a.Dialog.Footer,null,i.default.createElement(a.Button,{tid:"105812",onClick:s},c.default.get("Common.Close"))))}p.defaultProps={element:null,onClose:function t(){},show:false,type:"object",objectId:""};p.propTypes={app:s.default.object.isRequired,element:s.default.instanceOf(Element),onClose:s.default.func,show:s.default.bool,type:s.default.oneOf(["sheet","object"]),objectId:s.default.string};function h(t){var e=t.show;if(!e)return null;return i.default.createElement(l.default,null,function(e){return i.default.createElement(r.default,{render:function n(a){return i.default.createElement(p,d({element:a,app:e},t))}})})}},1767:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=d;var i=u(n(48));var a=u(n(91));var s=u(n(122));var r=u(n(94));var o=u(n(228));var l=u(n(177));var c=n(90);function u(t){return t&&t.__esModule?t:{default:t}}function d(t){if(t){var e=i.default.getService("$delayedModal");e.open({title:a.default.get("Error.SheetNotFound.Title"),content:a.default.get("Error.SheetNotFound.Message"),buttons:[]})}r.default.setView(r.default.Views.sheet);l.default.setSheet(null,null,(0,c.getParameterByName)("app"),null);setTimeout(function(){o.default.setNavigationMode(o.default.NavigationMode.sheet);s.default.goToOverview()},0)}t.exports=e.default},1776:function(t,e,n){"use strict";var i,a;!(i=[n(10),n(48),n(2308),n(50)],a=function(t,e,n,i){e.service("qvMobileOdagService",["$document","$compile","$rootScope",function(e,a,s){var r={odag:{$container:void 0,scope:null,input:{},getComponent:function t(){return n},setup:function t(){i.ViewChanged.bind(l)},destroy:function t(){i.ViewChanged.unbind(l)}}},o;function l(){u(r.odag)}function c(n){n.$container=t.element("<div>");n.$containerId?e.find(n.$containerId).append(n.$container):e.find("body").append(n.$container);n.scope=s.$new();n.$container.append(a(n.getComponent())(n.scope));n.setup()}function u(t){if(t.$container){t.scope.$destroy();t.$container.remove();t.$container=void 0;t.scope=null}t.destroy()}function d(t){return!!t.$container}function p(t,e){d(t)?u(t):c(t,e)}o={toggleMobileOdag:function t(){var e={};p(r.odag,e)},off:function t(e){var n=r[e];u(n)}};return o}])}.apply(e,i),void 0!==a&&(t.exports=a))},196:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){return{MEASURE:"measure",DIMENSION:"dimension",FIELD:"field",PUBSUB_TOPIC:"/cao/light-editing/swap"}}.apply(e,i),void 0!==a&&(t.exports=a))},212:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(10),n(95),n(48),n(909),n(94),n(140),n(184),n(103),n(168),n(155),n(49),n(89),n(202),n(223),n(176),n(175)],a=function(t,e,n,i,a,s,r,o,l,c,u,d,p,h,f){i.service("qvCaoService",["$document","qvSelectionToolbarService","qvGlobalSelectionsService","qvCaoSelectionService",function(i,g,v,m){var b,y,S;var I=300;var x=new c;var q=new u;var w=false;var C=d.getFlag("CE_PRECEDENTS");var P,E;S=o.createGroup("cao",1);S.registerKeys("ctrl+left",o.preventDefault);S.registerKeys("ctrl+home",o.preventDefault);S.registerKeys("ctrl+right",o.preventDefault);S.registerKeys("ctrl+end",o.preventDefault);S.registerKeys("ctrl+e",o.preventDefault);S.registerKeys("ctrl+c",o.preventDefault);S.registerKeys("ctrl+x",o.preventDefault);S.registerKeys("ctrl+v",o.preventDefault);S.registerKeys("ctrl+z",o.preventDefault);S.registerKeys("ctrl+y",o.preventDefault);S.registerKeys("cmd+shift+z",o.preventDefault);S.registerKeys("del",o.preventDefault);S.registerKeys("ctrl+f",o.preventDefault);S.registerKeys("backspace",o.preventDefault);S.registerKeys("esc",o.preventDefault);S.registerKeys("ctrl+shift+left",O);S.registerKeys("ctrl+shift+right",A);function k(){return{$container:void 0,$containerId:".qv-cao-container",getComponent:function t(){return a},setup:function t(){r.get().then(function(t){s.StateChanged.bind(T);t.enigmaModel.isInModalSelection()&&g.confirm()})},destroy:function t(){s.StateChanged.unbind(T)}}}function T(){(s.isInEditMode()||s.isInAnalysisMode()||s.inObjectView())&&_()}function O(){r.get().then(function(t){f.toggleAssetsPanel(t.id);n.publish("cao/insight/assetsPanelToggled",f.storageObj(t.id).assetsPanel)})}function A(){r.get().then(function(t){f.toggleContextPanel(t.id);n.publish("cao/insight/contextPanelToggled",f.storageObj(t.id).contextPanel)})}function $(n){S.on();y.$container=e.element("<div>");n=n||i;n.find(y.$containerId).append(y.$container);y.$container.showComponent(y.getComponent());y.setup();v.setCaoActive(true);t(".qv-cao").slideDown(I)}function D(){return!(!y||void 0===y.$container)}function _(){S.off();if(!y)return;t(".qv-cao").slideUp(I,function(){if(y.$container){y.$container.remove();y.$container=void 0}y.destroy();y=null;v.setCaoActive(false)})}b={isCaoOpen:D,toggleCao:function t(e){var n=h.getCurrentSheetInfo();m.clearSelection();y||(y=new k);if(D()){_();h.closeAnalysisOverlay(n.sheetId,n.appId);l.trackEvent(l.customEvents.INSIGHTS_CLICKED,{type:"close"});return false}h.openAnalysisOverlay(n.sheetId,n.appId,s.States.insight);$(e);w=false;l.trackEvent(l.customEvents.INSIGHTS_CLICKED,{type:"open"});return true},off:function t(){l.trackEvent(l.customEvents.INSIGHTS_CLICKED,{type:"off"});_()},scrapeApp:function t(){if(C){if(P)return E;P=true;E=x.scrapeApp().then(function(){P=false});return E}return(new p).resolve()},setRefreshIndicatorVisibility:function t(e){w=e},getRefreshIndicatorVisibility:function t(){return w},isInsightsAvailable:function t(){var e=new p;q.isRunning().then(function(){e.resolve(true)},function(){e.resolve(false)});return e.promise}};return b}])}.apply(e,i),void 0!==a&&(t.exports=a))},220:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(155),n(89),n(94),n(91),n(54),n(154),n(147),n(246),n(363),n(273),n(142),n(93),n(275),n(271)],a=function(t,e,n,i,a,s,r,o,l,c,u,d,p){t.service("qvSelectionInsightsService",["qvCaoSearchService","qvCurrentSelectionsService",function(t,h){var f;var g=new e;var v=new l(a.localeDetected,"","","","numeric");var m={};var b=2e4;var y="$";function S(t){return v.format(t,"#.#A")}function I(t){var e=parseFloat(t.toFixed(3));return new Intl.NumberFormat(a.localeDetected,{style:"percent",maximumSignificantDigits:3,minimumSignificantDigits:1}).format(parseFloat(e))}function x(t){var e="";var n=t.measureAggregation;if("avg"==n){var i=S(t.excludedMeasure.qNumber);e=a.get("SelectionInsights.CardSummaryAvg",[i])}else e=Number.isNaN(+t.excludedMeasurePercentage.toFixed(1))?"NaN":a.get("SelectionInsights.CardSummarySum",[I(t.excludedMeasurePercentage.toFixed(1)/100)]);return e}function q(t){var e=t.counts.excluded+t.counts.included;var n=t.counts.excluded;var i=t.measureBreakdown.excluded.num;return n>1?a.get("SelectionInsights.InsightSummaryExcludedLongMulti",[n,e,"<span class='dimLabelDesc'>"+t.dimension+"</span>","<span>"+i+"</span>","<span>"+t.measure+"</span>","<span>"+(t.measureAggregation[0].toUpperCase()+t.measureAggregation.slice(1))+"</span>"]):a.get("SelectionInsights.InsightSummaryExcludedLongSingle",[n,e,"<span class='dimLabelDesc'>"+t.dimension+"</span>","<span>"+i+"</span>","<span>"+t.measure+"</span>","<span>"+(t.measureAggregation[0].toUpperCase()+t.measureAggregation.slice(1))+"</span>"])}function w(t,e){var i=new n;var s={};var r=true;s.counts={};s.counts.excluded=parseFloat(e.analysis.numExcluded);s.counts.included=parseFloat(e.analysis.distinctCount)-parseFloat(e.analysis.numExcluded);s.counts.summary=a.get("SelectionInsights.CardCountsSummary",[s.counts.excluded,s.counts.excluded+s.counts.included,I(s.counts.excluded/(s.counts.excluded+s.counts.included))]);var o="";var l="";var c="";var u="";for(var d in e.analysis.matchRecord.matches){var p=e.analysis.matchRecord.matches[d];if("dimension"==p.slotRole){c=p.field||p.libIdLabel;u=p.libId}else{o=p.field||p.libIdLabel;l=Array.isArray(p.aggr)?p.aggr[0]:p.aggr}}s.dimension=c;s.measure=o;s.measureAggregation=l;s.dimensionId=u;var h=[];var f=t.evaluateEx(e.analysis.aggrMrsExcluded);h.push(f);var g=t.evaluateEx(e.analysis.aggrMrsTotal);h.push(g);var v=t.evaluateEx(e.analysis.aggrMrsIncluded);h.push(v);var y=t.evaluateEx(e.analysis.aggrMrs);h.push(y);var w=setTimeout(function(){var e=false;h.forEach(function(n){if(-1===n.$$state.status){e=true;t.global.cancelRequest(n.requestId).then(function(){})}});e&&i.reject()},b);n.all(h).then(function(t){var n=t[0];var a=t[1];var o=t[2];var l=t[3];s.excludedMeasurePercentage=n.qNumber/a.qNumber*100;s.includedMeasurePercentage=o.qNumber/a.qNumber*100;s.excludedMeasure=n;s.totalMeasure=a;s.includedMeasure=o;s.summaryString=x(s);s.excludedVis={dimension:e.analysis.dim,measure:e.analysis.aggrMrsExcluded};s.includedVis={dimension:e.analysis.dim,measure:e.analysis.aggrMrsIncluded};s.measureBreakdown={};s.measureBreakdown.excluded={num:S(n.qNumber),percentage:s.excludedMeasurePercentage.toFixed(1)};s.measureBreakdown.included={num:S(o.qNumber),percentage:s.includedMeasurePercentage.toFixed(1)};s.selectedMeasure={total:S(a.qNumber),selected:{num:S(l.qNumber),percentage:l.qNumber/a.qNumber*100,qNum:l.qNumber},excluded:{num:S(a.qNumber-l.qNumber),percentage:(a.qNumber-l.qNumber)/a.qNumber*100,qNum:a.qNumber-l.qNumber}};s.summaryStringLong=q(s);m[s.dimension].insight=s;clearTimeout(w);r=s.excludedMeasurePercentage+s.includedMeasurePercentage<100.01&&s.counts.included>=0&&s.counts.excluded>=0&&s.excludedMeasurePercentage+s.includedMeasurePercentage>99.9;s.show=r;i.resolve({show:r,summary:s.summaryString})}).catch(function(t){i.reject(t)});return i.promise}function C(t){return t.getObject(i.model.id).then(function(t){return t.getLayout().then(function(t){return t.qMeta.title})})}function P(t){var e=void 0;t||(e={scope:["libItems"]});return e}function E(t){b=t.runtimeSettings.suggestedTimeout;var e={};var n=null;if(!s.isEmpty(t.appRecommendations)){var i=t.appRecommendations[0].visualizations;var a=[];i.forEach(function(t){if("excludedCompareMsrSelector"!=t.analysis.analysis){var i=parseFloat(t.analysis.numExcluded)/parseFloat(t.analysis.distinctCount);var s=(parseFloat(t.analysis.distinctCount)-parseFloat(t.analysis.numExcluded))/parseFloat(t.analysis.distinctCount);var r="";var o="";var l="";for(var c in t.analysis.matchRecord.matches){var u=t.analysis.matchRecord.matches[c];if("dimension"==u.slotRole)l=u.field||u.libIdLabel;else{r=u.field||u.libIdLabel;o=u.aggr}}var d=true;(0===i||0===s||"avg"!=o&&"sum"!=o)&&(d=false);a.indexOf(l)>-1&&(d=false);if(d){a.push(l);e[l]={vis:t,measure:r,measureAggregation:o}}else;}else for(var p in t.analysis.matchRecord.matches){var h=t.analysis.matchRecord.matches[p];"measure"==h.slotRole&&(n=h.field||h.libIdLabel)}})}return{insights:e,measure:n}}function k(t,e){var n=P(t);var i=[];var s=false;if(void 0!=e)if(e.masterItem){i.push(e.libId);s=true}else i.push(e.qName);return g.getExcludedCompareVisualizations(i,n,s).then(function(t){if(t.__report.appDataModel.memberSelectionDone)return E(t);throw{error:a.get("SelectionInsights.Unsupported")}})}function T(e){var n=[];return e?r.getList().then(function(t){return t.getLayout()}).then(function(t){var e=t.filter(function(t){return t.qTags&&(-1===t.qTags.indexOf("$date")||-1===t.qTags.indexOf("$timestamp"))&&-1===t.qTags.indexOf("$geopoint")&&(t.qTags.indexOf("$numeric")>-1||t.qTags.indexOf("$integer")>-1)});n=n.concat(e);return O()}).then(function(e){n=n.concat(e);var i=t.sortFields(n);return i}):O().then(function(e){var n=t.sortFields(e);return n})}function O(){return o.getList().then(function(t){return t.getLayout().then(function(t){var e=t.map(function(t){return{qName:t.qData.title,classifications:["measure"],masterItem:true,libId:t.qInfo.qId,libIdLabel:t.qMeta.title}});return e})})}function A(t){if(t&&t.selectionsInStates){var e=[];t.selectionsInStates.forEach(function(t){t.qSelectionObject.qSelections.forEach(function(e){e.stateName=t.stateName});e=e.concat(t.qSelectionObject.qSelections)});var n=e.filter(function(t){return!t.qIsHidden});n.forEach(function(t){t.translation=h.translate(t);t.screenReaderLabel=h.translatedScreenReaderLabel(t);t.name=t.qReadableName||t.qField;t.displayStateName=t.stateName===y?a.get(u.DEFAULT_STATE_TRANSLATION):t.stateName});var i=c.groupSelectionsByField(n);var s=i.filter(function(t){return!t.isSingleState});s.forEach(function(t){t.translation=h.translate(t);t.screenReaderLabel=h.translatedScreenReaderLabel(t)});i=i.sort(d.sortSelections);return i}}function $(t,e){var n={qHyperCubeDef:{qDimensions:[{qDef:{qFieldDefs:[e?t.excludedVis.dimension:t.includedVis.dimension],qFieldLabels:[t.dimension]},qNullSuppression:true}],qMeasures:[{qDef:{qDef:e?t.excludedVis.measure:t.includedVis.measure,qLabel:t.measureAggregation[0].toUpperCase()+t.measureAggregation.slice(1)+"("+t.measure+")",qNumFormat:{qType:"F",qnDec:2,qUseThou:0,qFmt:"#,##0.00",qDec:".",qThou:","}},qSortBy:{qSortByAscii:-1}}],qInterColumnSortOrder:[1,0],qInitialDataFetch:[{qTop:0,qHeight:500,qLeft:0,qWidth:2}],columnOrder:[0,1],columnWidths:[197,230],qSuppressMissing:true,qReductionMode:"N",qMode:"S",qPseudoDimPos:-1,qNoOfLeftDims:-1,qMaxStackedCells:5e3},qInfo:{qId:"",qType:"visualization"},visualization:"table"};return p.getApp().then(function(t){return t.enigmaModel.createSessionObject(n).then(function(t){return t})})}function D(t){if(t&&t.selectionsInStates){var e=c.getAllSelectionsInStates(t);var n=e.filter(function(t){return true===t.qOneAndOnlyOne}).map(function(t,e){return"<strong>"+(e?" ":"")+t.name+"</strong>"});if(n.length>0)return{isOneAndOnlyOne:true,items:n};return false}return false}function _(t){if(t&&t.selectionsInStates){var e=c.getAllSelectionsInStates(t);if(e.filter(function(t){return true===t.qLocked}).length>0)return true;return false}return false}f={getSheet:function t(e){return C(e).then(function(t){return t})},getInsightDimensions:function t(e,n){return k(e,n).then(function(t){m={};m=t.insights;var e=[];for(var n in m){var i={};i.excluded=parseFloat(m[n].vis.analysis.numExcluded);i.included=parseFloat(m[n].vis.analysis.distinctCount)-parseFloat(m[n].vis.analysis.numExcluded);i.summary=a.get("SelectionInsights.CardCountsSummary",[i.excluded,i.excluded+i.included,I(i.excluded/(i.excluded+i.included))]);e.push({dimension:n,counts:i,measure:m[n].measure,measureAggregation:m[n].measureAggregation,show:true})}return{insights:e,measure:t.measure}}).catch(function(t){throw t})},getInsightSummary:function t(e,n){var i=m[e].vis;return w(n,i).then(function(t){return t})},getInsightDetails:function t(e){return m[e].insight},clearInsights:function t(){m={}},getMeasures:function t(e){return T(e).then(function(t){return t})},getLocalizedPercentage:function t(e){return I(e)},getSelectionItems:function t(e){return A(e)},getTableVis:function t(e,n){return $(e,n).then(function(t){return t})},isOneAndOnlyOne:function t(e){return D(e)},isHasLockedSelections:function t(e){return _(e)}};return f}])}.apply(e,i),void 0!==a&&(t.exports=a))},221:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(89),n(155),n(406),n(367),n(876),n(877),n(880),n(368)],a=function(t,e,n,i,a,s,r,o){t.service("qvCaoChartService",["qvCaoComplexityEstimatorService",function(t){var l;var c;var u=new n;function d(t,e,n){n.title=t;return i.createChart(n,e,false).then(function(t){return{model:t}})}function p(t){if(c)return g(c.app,c.searchPhrase,c.libItems,t);return e.reject({norefresh:true})}function h(t,e,n){var i=[];e.forEach(function(e){i.push(r.generateChartPropertiesForRecommendation(e.visualization,n).then(function(n){e.visualization=new a(e.visualization,t.__report,n);return e}))});return i}function f(n,i){var a=[];var r=3e3;n.runtimeSettings&&n.runtimeSettings.suggestedTimeout&&(r=n.runtimeSettings.suggestedTimeout);n.appRecommendations.forEach(function(e){e.recAnalyses.forEach(function(e){if("fact"===e.analysis.analysis&&1!==e.relevance)return;var n={relevance:e.relevance,suggestedTimeout:r,visualization:e,complexity:t.estimateComplexity(e,i)};a.push(n)})});return e.all(h(n,a,i)).then(function(t){var e=[];n.appCharts&&n.appCharts.forEach(function(t){t.appearsOnSheets.length>0&&e.push({relevance:t.relevance,suggestedTimeout:r,visualization:new s(t.id,t.appearsOnSheets,n.__report,i),complexity:-1})});return{recommendations:t.map(function(t){return new o(t,i)}),chartMatches:e.map(function(t){return new o(t,i)})}})}function g(t,e,n,i){c={app:t,searchPhrase:e,libItems:n};var a={exploreSupplemental:["appInsights"]};var s={};n&&(s={scope:["libItems"]});"boolean"===typeof i&&false===i&&(s.appPrecedents="skip");return u.getInsightRecommendations(e,a,true,[],s).then(function(e){return f(e,t)})}function v(t,e,n){c={app:t,searchPhrase:"",libItems:n};var i={exploreSupplemental:["appInsights"]};var a;n&&(a={scope:["libItems"]});return u.getVisRecommendations(e,true,i,[],a).then(function(e){return f(e,t)})}function m(t,e,n){return d(t,e,n)}function b(t,e){var n=t.matchRecord;var i=t.analysis.analysis;return u.adaptMatchRecord("update",n,i).then(function(n){n[0].analysis={analysis:n[0].analysis,analysisGroup:n[0].analysisGroup,dims:n[0].dims,msrs:n[0].msrs,titleTemplate:n[0].titleTemplate};return r.generateChartPropertiesForRecommendation(n[0],e).then(function(e){return{properties:e,analysis:n[0].analysis,matchRecord:t.matchRecord}})})}l={getInsights:g,getVisualRecommendations:v,refreshInsights:p,buildInsightChart:m,adaptRecommendation:b};return l}])}.apply(e,i),void 0!==a&&(t.exports=a))},222:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={resizeCharts:function t(e){if("function"===typeof Event)e.dispatchEvent(new Event("resize"));else{var n=e.document.createEvent("UIEvents");n.initUIEvent("resize",true,false,e,0);e.dispatchEvent(n)}}};return t}.apply(e,i),void 0!==a&&(t.exports=a))},223:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t="qCaoStorageObj";function e(){var e=JSON.parse(sessionStorage.getItem(t));null===e&&(e=JSON.parse(localStorage.getItem(t))||{});return e}function n(e){var n=JSON.parse(localStorage.getItem(t))||{};if(!n||!n[e]){n[e]={contextPanel:true,assetsPanel:true};sessionStorage.setItem(t,JSON.stringify(n));localStorage.setItem(t,JSON.stringify(n));return n[e]}return n[e]}var i={storageObj:function t(e){return n(e)},toggleContextPanel:function n(i){var a=e(i);a[i].contextPanel=!a[i].contextPanel;localStorage.setItem(t,JSON.stringify(a));sessionStorage.setItem(t,JSON.stringify(a));return a},toggleAssetsPanel:function n(i){var a=e(i);a[i].assetsPanel=!a[i].assetsPanel;localStorage.setItem(t,JSON.stringify(a));sessionStorage.setItem(t,JSON.stringify(a));return a}};return i}.apply(e,i),void 0!==a&&(t.exports=a))},2233:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var i=f(n(98));var a=n(171);var s=f(n(128));var r=f(n(94));var o=n(1665);var l=f(n(2234));var c=f(n(2246));var u=f(n(2315));var d=f(n(362));var p=f(n(122));var h=f(n(2316));n(2317);function f(t){return t&&t.__esModule?t:{default:t}}var g=function t(){if(r.default.inObjectView()){var e=s.default.getGrid();e&&e.exploreMenu(s.default.getZoomCell(),false);s.default.zoomOut()}else p.default.goToOverview()};var v={helpKey:"Stage_SheetView",loaderTranslationKey:"App.IsLoading.Sheet",titleTranslationKey:"",init:function t(){d.default.init();h.default.applyLink()},renderContent:function t(){return i.default.createElement(c.default,null)},renderMenuItems:function t(e){var n=e.closeMenu,a=e.disabled;return i.default.createElement(u.default,{closeMenu:n,disabled:a})},renderToolbarContent:function t(){return i.default.createElement(o.AnalysisToolbarProvider,null,i.default.createElement(l.default,null))},renderMobileToolbarLeftContent:function t(){return i.default.createElement(a.FadeButton,{tid:"4dfd77",size:"large",variant:"inverse",onClick:g},i.default.createElement(a.FadeButton.Icon,{name:"previous",size:"large"}))}};e.default=v;t.exports=e.default},2234:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var i=C(n(98));var a=w(n(116));var s=n(171);var r=w(n(91));var o=w(n(95));var l=n(90);var c=w(n(49));var u=w(n(94));var d=w(n(2235));var p=w(n(1715));var h=w(n(177));var f=n(1096);var g=w(n(1044));var v=w(n(2236));var m=w(n(1665));var b=w(n(1766));var y=w(n(2244));var S=w(n(1666));var I=w(n(1667));var x=w(n(411));var q=w(n(2245));function w(t){return t&&t.__esModule?t:{default:t}}function C(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,n):{};i.get||i.set?Object.defineProperty(e,n,i):e[n]=t[n]}e.default=t;return e}function P(){P=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};return P.apply(this,arguments)}function E(t){E="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return E(t)}function k(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,i.key,i)}}function O(t,e,n){e&&T(t.prototype,e);n&&T(t,n);return t}function A(t,e){if(e&&("object"===E(e)||"function"===typeof e))return e;return D(t)}function $(t){$=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return $(t)}function D(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});e&&M(t,e)}function M(t,e){M=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return M(t,e)}var N=function(t){_(e,t);function e(t){var n;k(this,e);n=A(this,$(e).call(this,t));n.toggleEditMode=n.toggleEditMode.bind(D(n));n.toggleBookmarkNavigator=n.toggleBookmarkNavigator.bind(D(n));n.toggleSheetNavigator=n.toggleSheetNavigator.bind(D(n));n.updateSheetList=n.updateSheetList.bind(D(n));n.state={sheetList:[],bookmarkNavigatorOpen:false,sheetNavigatorOpen:false};return n}O(e,[{key:"componentDidMount",value:function t(){o.default.subscribe("/data/sheet-list-layout-changed",this.updateSheetList)}},{key:"componentWillUnmount",value:function t(){o.default.unsubscribe("/data/sheet-list-layout-changed",this.updateSheetList)}},{key:"toggleEditMode",value:function t(){var e=this.props.sheetLayout;var n=u.default.state===u.default.States.edit;var i=n?u.default.States.analysis:u.default.States.edit;u.default.setState(i);h.default.setSheet(e.qInfo.qId,Object.keys(u.default.States)[i],(0,l.getParameterByName)("app"),null)}},{key:"toggleSheetNavigator",value:function t(e){var n=this;var i=this.state.sheetNavigatorOpen;var a=!i;d.default.toggle({pressed:a,close:function t(){return n.setState(function(t){var e=t.sheetNavigatorOpen;return{sheetNavigatorOpen:!e}})}},e.currentTarget);this.setState({sheetNavigatorOpen:a})}},{key:"toggleBookmarkNavigator",value:function t(e){var n=this;var i=this.props.appLayout;var a=this.state.bookmarkNavigatorOpen;var s=!a;p.default.toggle({pressed:s,close:function t(){return n.setState(function(t){var e=t.bookmarkNavigatorOpen;return{bookmarkNavigatorOpen:!e}})}},e.currentTarget,{create:i.permissions.createBookmark,small:false});this.setState({bookmarkNavigatorOpen:s})}},{key:"updateSheetList",value:function t(e){this.setState({sheetList:e})}},{key:"render",value:function t(){var e=this.props,n=e.appLayout,a=e.sheetLayout,o=e.displayMode,l=e.sheet;var d=this.state,p=d.sheetNavigatorOpen,h=d.bookmarkNavigatorOpen;var f=u.default.state===u.default.States.edit;var S=a.labelExpression||a.qMeta.title;var I=f?"Common.Done":"Common.Edit";var x=f?"Tooltip.StopEditSheet":"Tooltip.EditSheet";var w="edit";if(c.default.getFlag("SSA_IN_EDIT")){I=f?"Common.View":"Common.Edit";x=f?"Tooltip.viewSheet":"Tooltip.EditSheet";w=f?"view":"edit"}var C;C=c.default.getFlag("SSA_IN_EDIT")?f?"lui-buttongroup__button":"lui-buttongroup__button lui-button--success":f?"lui-buttongroup__button lui-button--warning":"lui-buttongroup__button";var P=n&&!n.qReadOnly&&n.permissions.createSheet;var E=a&&a.permissions.update;return i.default.createElement(i.Fragment,null,i.default.createElement("div",{className:"qs-popover-container qs-toolbar__element"},i.default.createElement(s.Button,{tid:"4e4ab2",className:h?"lui-active":"","qva-outside-ignore-for":"nav-bookmark",title:r.default.get("Common.Bookmarks"),onClick:this.toggleBookmarkNavigator},i.default.createElement(s.Button.Icon,{name:"bookmark",className:"qs-no-margin"}),i.default.createElement(s.Button.Caret,null))),i.default.createElement(s.ButtonGroup,{className:"qs-toolbar__element"},E||f?i.default.createElement(s.Button,{tid:"4dd782",className:C,title:r.default.get(x),onClick:this.toggleEditMode},i.default.createElement(s.Button.Icon,{name:w}),o>g.default.medium?i.default.createElement(s.Button.Text,{className:"lui-button__text qs-sheet-toolbar-edit-title"},r.default.get(I)):null):null,!P||E||f?null:i.default.createElement(q.default,{sheet:l,showText:o>g.default.medium}),i.default.createElement("div",{className:"qs-popover-container lui-buttongroup__button"},i.default.createElement(s.Button,{tid:"4e25a2",className:p?"lui-active":"","qva-outside-ignore-for":"nav-sheet",title:r.default.get("Common.Sheets"),onClick:this.toggleSheetNavigator},o>g.default.large?i.default.createElement(s.Button.Text,{className:"qs-sheet-toolbar-sheet-title lui-button__text"},S):null,i.default.createElement(s.Button.Icon,{name:"sheet"}),i.default.createElement(s.Button.Caret,null))),o>g.default.small?i.default.createElement(v.default,null):null),i.default.createElement(m.default,null,function(t){return i.default.createElement(i.Fragment,null,i.default.createElement(b.default,{show:t.showEmbedDialog,onClose:t.actions.closeEmbedDialog,type:t.embedType,objectId:t.embedObjectId}),i.default.createElement(y.default,null))}))}}]);return e}(i.Component);N.propTypes={displayMode:a.default.number.isRequired,appLayout:a.default.object.isRequired,sheetLayout:a.default.object.isRequired,sheet:a.default.object.isRequired};var F=(0,x.default)((0,S.default)((0,I.default)(function(t){return i.default.createElement(f.ToolbarConsumer,null,function(e){return i.default.createElement(N,P({},t,{displayMode:e}))})})));e.default=F;t.exports=e.default},2235:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(11),n(1222),n(1460),n(228)],a=function(t,e,n,i,a){var s;function r(r,o){var l=a.NavigationMode.sheet;s=t.getService("luiPopover").show({controller:n.controller,template:n.template,dock:"bottom",alignTo:o,outsideIgnore:"nav-"+l,container:e(o).parents(".popover-container,.qs-popover-container")[0],autoFocus:false,input:{showToolbar:true,showNavigation:false,navigationmode:l,isNavigator:true,tid:"sheetNavigator"}});i.open();s.closing.then(function t(n){s=null;r.pressed=false;r.close&&r.close();var a=n&&e(n.target).closest("[data-toolbar-navigator]");a&&a.length||i.close()})}function o(t,e){if(t.pressed)r(t,e);else{s.close();s=null;i.close()}}return{toggle:o}}.apply(e,i),void 0!==a&&(t.exports=a))},2236:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var i=c(n(98));var a=n(171);var s=l(n(91));var r=l(n(48));var o=l(n(122));function l(t){return t&&t.__esModule?t:{default:t}}function c(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,n):{};i.get||i.set?Object.defineProperty(e,n,i):e[n]=t[n]}e.default=t;return e}var u=function t(){var e=r.default.getService("$navigationService");var n=function t(){var n=e.Sheets.getPrevious();return n?n.qInfo.qId:""};var l=function t(){var n=e.Sheets.getNext();return n?n.qInfo.qId:""};var c=function t(){var n=e.Sheets.getPrevious();return s.default.get("Tooltip.PreviousSheet",n?n.qData.labelExpression||n.qData.title:"")};var u=function t(){var n=e.Sheets.getNext();return s.default.get("Tooltip.NextSheet",n?n.qData.labelExpression||n.qData.title:"")};var d=function t(){var n=e.Sheets.getPrevious();o.default.goToSheet(n.qInfo.qId)};var p=function t(){var n=e.Sheets.getNext();o.default.goToSheet(n.qInfo.qId)};return i.default.createElement(i.Fragment,null,i.default.createElement(a.Button,{tid:"btnQuickNavPrevious",className:"qs-sheet-toolbar-previous-sheet-button lui-buttongroup__button",onClick:d,disabled:!e.Sheets.hasPrevious(),"data-sheet-id":n(),title:c()},i.default.createElement(a.Button.Icon,{name:"previous"})),i.default.createElement(a.Button,{tid:"btnQuickNavNext",className:"qs-sheet-toolbar-next-sheet-button lui-buttongroup__button",onClick:p,disabled:!e.Sheets.hasNext(),"data-sheet-id":l(),title:u()},i.default.createElement(a.Button.Icon,{name:"next"})))};var d=u;e.default=d;t.exports=e.default},2237:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=e.EmbedConfiguratorComponent=void 0;var i=m(n(98));var a=v(n(116));var s=n(171);var r=v(n(997));var o=v(n(2238));var l=v(n(100));var c=v(n(173));var u=v(n(91));var d=v(n(2239));var p=v(n(2240));var h=n(2241);var f=v(n(214));var g=n(2242);function v(t){return t&&t.__esModule?t:{default:t}}function m(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,n):{};i.get||i.set?Object.defineProperty(e,n,i):e[n]=t[n]}e.default=t;return e}function b(t){b="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return b(t)}function y(){y=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};return y.apply(this,arguments)}function S(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};var i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})));i.forEach(function(e){I(t,e,n[e])})}return t}function I(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:true,configurable:true,writable:true}):t[e]=n;return t}function x(t,e,n,i,a,s,r){try{var o=t[s](r);var l=o.value}catch(t){n(t);return}o.done?e(l):Promise.resolve(l).then(i,a)}function q(t){return function(){var e=this,n=arguments;return new Promise(function(i,a){var s=t.apply(e,n);function r(t){x(s,i,a,r,o,"next",t)}function o(t){x(s,i,a,r,o,"throw",t)}r(void 0)})}}function w(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,i.key,i)}}function P(t,e,n){e&&C(t.prototype,e);n&&C(t,n);return t}function E(t,e){if(e&&("object"===b(e)||"function"===typeof e))return e;return T(t)}function k(t){k=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return k(t)}function T(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function O(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});e&&A(t,e)}function A(t,e){A=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return A(t,e)}var $=function(t){O(e,t);function e(t){var n;w(this,e);n=E(this,k(e).call(this,t));var i=n.props,a=i.app.id,s=i.type,r=i.objectId;var o={appId:a,type:s,objectId:r};var l=(0,h.getHashUrl)(o,{});var c=(0,h.getQueryParamUrl)(o,{});n.state={identity:Math.random().toString(36).substring(7),themes:[],bookmarks:[],languages:[],url:c,previewUrl:l,selections:[],selectionsReady:false};var u=function t(e,i){var a;return function(){for(var t=arguments.length,s=new Array(t),r=0;r<t;r++)s[r]=arguments[r];var o=function t(){return e.apply(T(n),s)};clearTimeout(a);a=setTimeout(o,i)}};n.handleFormChange=u(n.handleFormChange,300).bind(T(n));return n}P(e,[{key:"componentDidMount",value:function(){var t=q(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function t(i){while(1)switch(i.prev=i.next){case 0:e=this.props.engineFeatures.qAutoSave;!e&&f.default.isAppDirty()&&f.default.saveApp();i.t0=this;i.next=5;return l.default.getAvailableThemes();case 5:i.t1=i.sent;i.t0.setThemes.call(i.t0,i.t1);i.next=9;return c.default.getList();case 9:n=i.sent;i.next=12;return n.getLayout();case 12:this.setBookmarks(n.layout.qBookmarkList.qItems);this.setLanguages(u.default.languageList);this.getSelections();case 15:case"end":return i.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"setThemes",value:function t(e){this.setState({themes:e.custom?e.default.concat(e.custom):e.default})}},{key:"setBookmarks",value:function t(e){var n=[];e.forEach(function(t){n.push({name:t.qData.title,id:t.qInfo.qId})});this.setState({bookmarks:n})}},{key:"setLanguages",value:function t(e){var n=e.filter(function(t){return"pseudo"!==t.short&&"zz"!==t.short}).map(function(t){return{id:t.long,name:u.default.get(t.translatedLabel)}}).sort(function(t,e){return t.name.localeCompare(e.name,u.default.language)});this.setState({languages:n})}},{key:"getSelections",value:function(){var t=q(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function t(i){while(1)switch(i.prev=i.next){case 0:e=this.props.app;i.prev=1;i.next=4;return(0,g.getSelections)({app:e});case 4:n=i.sent;this.setState({selections:n,selectionsReady:true});i.next=11;break;case 8:i.prev=8;i.t0=i["catch"](1);this.setState({selections:[]});case 11:case"end":return i.stop()}},t,this,[[1,8]])}));function e(){return t.apply(this,arguments)}return e}()},{key:"handleFormChange",value:function(){var t=q(regeneratorRuntime.mark(function t(e){var n,i,a,s,r,o,l,c,u,d,p,f,g,v,m,b,y,I,x,q;return regeneratorRuntime.wrap(function t(w){while(1)switch(w.prev=w.next){case 0:n=this.props,i=n.app.id,a=n.type,s=n.objectId;r=e.bookmark,o=e.theme,l=e.language,c=e.clearSelections,u=e.allowInteraction,d=e.allowSelections,p=e.enableContextMenu,f=e.showSelectionBar,g=e.useCurrentSelections;v=this.state,m=v.identity,b=v.selections;y={bookmark:r,language:l,theme:o,clearSelections:c,enableContextMenu:p,disableInteraction:!u,disableSelections:!d,showSelectionsBar:f,selections:g?b:[]};I=(0,h.getHashUrl)({type:a,appId:i,objectId:s,identity:m},S({},y,{clearSelections:true}));x=(0,h.getQueryParamUrl)({type:a,appId:i,objectId:s},y);q=(0,h.getQueryParamUrl)({type:a,appId:i,objectId:s,identity:"preview"},y);this.setState(S({},e,{previewUrl:I,url:x,newTabUrl:q}));case 8:case"end":return w.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()},{key:"render",value:function t(){var e=this.state,n=e.themes,a=e.bookmarks,r=e.languages,l=e.url,c=e.newTabUrl,f=e.previewUrl,g=e.selectionsReady;var v=this.props,m=v.objectId,b=v.type;var y='<iframe src="'.concat(l,'" style="border:none;width:100%;height:100%;"></iframe>');return i.default.createElement("div",{className:"qs-embed-configurator"},i.default.createElement(p.default,{objectId:m,type:b,url:f}),i.default.createElement(o.default,{themes:n,bookmarks:a,languages:r,onChange:this.handleFormChange,showWarning:l.length>h.BROWSER_UNSAFE_URL_LENGTH,selectionsReady:g}),i.default.createElement("div",{className:"qs-embed-dialog__copy"},i.default.createElement(d.default,{render:function t(e){return i.default.createElement(i.default.Fragment,null,i.default.createElement("h3",null,u.default.get("Embed.Dialog.CopyToWebpage")),i.default.createElement("div",{className:"qs-embed-dialog__input-group"},i.default.createElement(s.InputGroup,null,i.default.createElement(s.InputGroup.Input,{tid:"105817",id:"iframeUrl",value:y,readOnly:true}),i.default.createElement(s.InputGroup.Button,{onClick:function t(){return e(y)}},u.default.get("Common.Copy")))),i.default.createElement("a",{className:"lui-text-info",target:"_blank",rel:"noopener noreferrer",href:c,tid:"1315b9"},u.default.get("Embed.Dialog.OpenNewTab")))}})))}}]);return e}(i.Component);e.EmbedConfiguratorComponent=$;$.propTypes={app:a.default.object.isRequired,engineFeatures:a.default.object.isRequired,type:a.default.oneOf(["object","sheet"]).isRequired,objectId:a.default.string.isRequired};var D=function t(e){return i.default.createElement(r.default,null,function(t){var n=t.engineFeatures;return i.default.createElement($,y({engineFeatures:n},e))})};e.default=D},2238:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var i=l(n(98));var a=n(171);var s=o(n(116));var r=o(n(91));function o(t){return t&&t.__esModule?t:{default:t}}function l(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,n):{};i.get||i.set?Object.defineProperty(e,n,i):e[n]=t[n]}e.default=t;return e}function c(t){c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return c(t)}function u(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:true,configurable:true,writable:true}):t[e]=n;return t}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,i.key,i)}}function h(t,e,n){e&&p(t.prototype,e);n&&p(t,n);return t}function f(t,e){if(e&&("object"===c(e)||"function"===typeof e))return e;return v(t)}function g(t){g=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return g(t)}function v(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});e&&b(t,e)}function b(t,e){b=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return b(t,e)}var y=function t(e){var n=e.id,s=e.label,o=e.checked,l=e.autoFocus,c=e.onChange,u=e.tid;return i.default.createElement("div",{className:"qs-embed-form__row-container"},i.default.createElement("div",{className:"qs-embed-form__label-container"},i.default.createElement("label",{htmlFor:n},s),i.default.createElement("span",null,i.default.createElement("b",null,r.default.get(o?"Common.Yes":"Common.No")))),i.default.createElement("div",{className:"qs-embed-form__input-container",tid:u},i.default.createElement(a.Switch,{autoFocus:l,id:n,checked:o,onChange:c})))};y.defaultProps={autoFocus:false,tid:""};y.propTypes={id:s.default.string.isRequired,label:s.default.string.isRequired,checked:s.default.bool.isRequired,autoFocus:s.default.bool,onChange:s.default.func.isRequired,tid:s.default.string};var S=function(t){m(e,t);function e(t){var n;d(this,e);n=f(this,g(e).call(this,t));n.state={allowSelections:true,showSelectionBar:true,allowInteraction:true,enableContextMenu:true,clearSelections:false,theme:"",bookmark:"",language:"",useCurrentSelections:true,savedState:{allowSelections:true,enableContextMenu:true}};n.handleChange=n.handleChange.bind(v(n));n.handleSelectionsChange=n.handleSelectionsChange.bind(v(n));return n}h(e,[{key:"componentDidMount",value:function t(){var e=this.props.onChange;e(this.state)}},{key:"componentDidUpdate",value:function t(e,n){var i=this.props,a=i.onChange,s=i.selectionsReady;n===this.state&&e.selectionsReady===s||a(this.state)}},{key:"getSwitchRow",value:function t(e,n,s,o,l){var c=this;return i.default.createElement("div",{className:"qs-embed-form__row-container",disabled:l},i.default.createElement("div",{className:"qs-embed-form__label-container"},i.default.createElement("label",{htmlFor:n},e),i.default.createElement("span",null,i.default.createElement("b",null,r.default.get(s?"Common.Yes":"Common.No")))),i.default.createElement("div",{className:"qs-embed-form__input-container",tid:o},i.default.createElement(a.Switch,{id:n,checked:s,onChange:function t(){return c.handleChange(n,!s)},disabled:l,className:l?"lui-disabled":""})))}},{key:"getSelectRow",value:function t(e,n,s,r,o){var l=this;return i.default.createElement("div",{className:"qs-embed-form__row-container"},i.default.createElement("div",{className:"qs-embed-form__label-container"},i.default.createElement("label",{htmlFor:s},e)),i.default.createElement("div",{className:"qs-embed-form__input-container"},i.default.createElement(a.Select,{tid:o,id:s,onChange:function t(e){return l.handleChange(s,e.target.value)}},i.default.createElement("option",{value:""},n),r.map(function(t){return i.default.createElement("option",{key:t.id,value:t.id},t.name)}))))}},{key:"handleChange",value:function t(e,n){var i=this.state,a=i.allowSelections,s=i.enableContextMenu,r=i.savedState;var o=r.allowSelections,l=r.enableContextMenu;"allowInteraction"!==e||n?"allowInteraction"===e?this.setState(function(){var t;return t={},u(t,e,n),u(t,"allowSelections",o),u(t,"enableContextMenu",l),t}):this.setState(function(){return u({},e,n)}):this.setState(function(){var t;return t={},u(t,e,n),u(t,"allowSelections",false),u(t,"enableContextMenu",false),u(t,"savedState",{allowSelections:a,enableContextMenu:s}),t})}},{key:"handleSelectionsChange",value:function t(){this.setState(function(t){return{useCurrentSelections:!t.useCurrentSelections}})}},{key:"render",value:function t(){var e=this;var n=this.state,a=n.allowInteraction,s=n.clearSelections,o=n.allowSelections,l=n.enableContextMenu,c=n.showSelectionBar,u=n.useCurrentSelections;var d=this.props,p=d.themes,h=d.bookmarks,f=d.languages,g=d.showWarning;return i.default.createElement("div",{className:"qs-embed-form"},i.default.createElement("div",{className:"qs-embed-configurator__desc"},r.default.get("Embed.Dialog.Description")),i.default.createElement("div",{className:"qs-embed-form__section"},i.default.createElement("h1",null,r.default.get("Embed.Dialog.General")),i.default.createElement(y,{autoFocus:true,id:"allowInteraction",label:r.default.get("Embed.Dialog.AllowInteraction"),checked:a,onChange:function t(){return e.handleChange("allowInteraction",!a)},tid:"1206e2"}),this.getSwitchRow(r.default.get("Embed.Dialog.EnableContextMenu"),"enableContextMenu",l,"",!a),this.getSwitchRow(r.default.get("Embed.Dialog.AllowSelections"),"allowSelections",o,"",!a),this.getSelectRow(r.default.get("Embed.Dialog.Languages"),r.default.get("Embed.Dialog.LanguageDefault"),"language",f,""),this.getSelectRow(r.default.get("Embed.Dialog.SetTheme"),r.default.get("Embed.Dialog.ThemeDefault"),"theme",p,"")),i.default.createElement("div",{className:"qs-embed-form__section"},i.default.createElement("h1",null,r.default.get("Embed.Dialog.Selections")),i.default.createElement(y,{id:"useCurrentSelections",label:r.default.get("Embed.Dialog.UseCurrentSelections"),checked:u,onChange:this.handleSelectionsChange}),g&&i.default.createElement("div",{className:"qs-embed-form__row-container"},i.default.createElement("div",{className:"qs-embed-form__warning"},i.default.createElement("span",{className:"lui-icon  lui-icon--warning","aria-hidden":"true"})," ",r.default.get("Embed.Dialog.UrlLengthWarning"))),this.getSwitchRow(r.default.get("Embed.Dialog.ShowSelectionsBar"),"showSelectionBar",c,"1206ef"),this.getSwitchRow(r.default.get("Embed.Dialog.SetClearSelections"),"clearSelections",s,"1206ee"),this.getSelectRow(r.default.get("Embed.Dialog.ApplyBookmark"),r.default.get("Embed.Dialog.NoBookmark"),"bookmark",h,"111afa")))}}]);return e}(i.Component);e.default=S;S.defaultProps={onChange:function t(){}};S.propTypes={onChange:s.default.func,themes:s.default.array.isRequired,bookmarks:s.default.array.isRequired,languages:s.default.array.isRequired,showWarning:s.default.bool.isRequired,selectionsReady:s.default.bool.isRequired};t.exports=e.default},2239:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=r;var i=s(n(98));var a=s(n(116));function s(t){return t&&t.__esModule?t:{default:t}}function r(t){var e=i.default.createRef();var n=function t(n){e.current.value=n;e.current.select();document.execCommand("copy")};return i.default.createElement(i.default.Fragment,null,t.render(n),i.default.createElement("input",{type:"text",style:{position:"absolute",top:"-9999px",opacity:0},readOnly:true,tabIndex:"-1","aria-hidden":true,ref:e}))}r.propTypes={render:a.default.func.isRequired};t.exports=e.default},2240:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var i=o(n(98));var a=r(n(116));var s=r(n(91));function r(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,n):{};i.get||i.set?Object.defineProperty(e,n,i):e[n]=t[n]}e.default=t;return e}function l(t){l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return l(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,i.key,i)}}function d(t,e,n){e&&u(t.prototype,e);n&&u(t,n);return t}function p(t,e){if(e&&("object"===l(e)||"function"===typeof e))return e;return h(t)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){f=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return f(t)}function g(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});e&&v(t,e)}function v(t,e){v=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return v(t,e)}var m=function(t){g(e,t);function e(t){var n;c(this,e);n=p(this,f(e).call(this,t));n.state={};return n}d(e,[{key:"render",value:function t(){var e=this.props,n=e.url,a=e.type,r=e.objectId;return i.default.createElement("div",{className:"qs-embed-dialog__preview"},i.default.createElement("div",{className:"qs-embed-dialog__preview-title"},i.default.createElement("span",null,s.default.get("Common.Preview"))),i.default.createElement("div",{className:"qs-embed-dialog__object-wrapper","aria-hidden":"true"},i.default.createElement("iframe",{title:"preview",className:"qs-embed-dialog__preview",src:n,tid:"111a8f"})),i.default.createElement("div",{className:"qs-embed-dialog__info-container"},i.default.createElement("input",{type:"text",readOnly:true,value:s.default.get("object"===a?"Embed.Dialog.ObjectID":"Embed.Dialog.SheetID",r)})))}}]);return e}(i.Component);e.default=m;m.propTypes={url:a.default.string.isRequired,objectId:a.default.string.isRequired,type:a.default.oneOf(["sheet","object"]).isRequired};t.exports=e.default},2241:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.getHashUrl=e.getQueryParamUrl=e.BROWSER_UNSAFE_URL_LENGTH=void 0;var i=a(n(13));function a(t){return t&&t.__esModule?t:{default:t}}var s=function t(e,n){return e.length&&e[e.length-1]===n};var r=function t(e){return s(e,"/")?e.slice(0,-1):e};var o=function t(){return"".concat(r(i.default.rootPath),"/single/")};var l=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t};if("string"===typeof e&&e.length)return n(encodeURIComponent(e));if("number"===typeof e)return n(e);return""};var c=function t(e){return"sheet"===e?"sheet":"obj"};var u=function t(e){return null!=e&&true===e};var d=function t(e,n){return l(n,function(t){return"&".concat(e,"=").concat(t)})};var p=function t(e,n){return l(n,function(t){return"/".concat(e,"/").concat(t)})};var h=function t(e){return Object.keys(e).filter(function(t){return u(e[t])}).join(",")};var f=function t(e){return 0===Object.keys(e).filter(function(t){return u(e[t])}).length?"":"&opt=".concat(h(e))};var g=function t(e){return 0===Object.keys(e).filter(function(t){return u(e[t])}).length?"":"/options/".concat(h(e))};var v=function t(e){return e?"&select=clearall":""};var m=function t(e){return e?"/select/clearall":""};var b=function t(e){return"$"===e?e:encodeURIComponent(e)};var y=function t(e){if(!e.length)return"";return e.map(function(t){return"&select=".concat(b(t.stateName),"::").concat(encodeURIComponent(t.name),",").concat(t.values.map(function(t){return l(t)}).join(","))}).join("")};var S=function t(e){if(!e.length)return"";return e.map(function(t){return"/select/".concat(b(t.stateName),"::").concat(encodeURIComponent(t.name),",").concat(t.values.map(function(t){return l(t)}).join(","))}).join("")};var I=function t(e){return e?"/identity/".concat(encodeURIComponent(e)):""};var x=function t(e){return e?"&identity=".concat(encodeURIComponent(e)):""};var q=2083;e.BROWSER_UNSAFE_URL_LENGTH=q;var w=function t(e){var n=e.type,i=void 0===n?"object":n,a=e.appId,s=e.objectId,r=e.identity;var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=l.bookmark,p=l.clearSelections,h=l.disableInteraction,g=l.disableSelections,m=l.disableAnimation,b=l.enableContextMenu,S=l.language,I=l.selections,q=void 0===I?[]:I,w=l.showSelectionsBar,C=l.theme;return"".concat(o(),"?appid=").concat(encodeURIComponent(a),"&").concat(c(i),"=").concat(encodeURIComponent(s)).concat(d("lang",S)).concat(d("theme",C)).concat(d("bookmark",u)).concat(f({noanimate:m,nointeraction:h,noselections:g,ctxmenu:b,currsel:w})).concat(v(p)).concat(y(q)).concat(x(r))};e.getQueryParamUrl=w;var C=function t(e){var n=e.type,i=void 0===n?"object":n,a=e.appId,s=e.objectId,r=e.identity;var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=l.disableSelections,u=l.disableAnimation,d=l.enableContextMenu,h=l.language,f=l.theme,v=l.showSelectionsBar,b=l.clearSelections,y=l.bookmark,x=l.selections,q=void 0===x?[]:x;return"".concat(o(),"#/app/").concat(encodeURIComponent(a),"/").concat(i,"/").concat(encodeURIComponent(s)).concat(I(r)).concat(p("lang",h)).concat(p("theme",f)).concat(p("bookmark",y)).concat(g({noanimate:u,nointeraction:true,noselections:c,ctxmenu:d,currsel:v})).concat(m(b)).concat(S(q))};e.getHashUrl=C},2242:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.getSelections=e.selectedValuesCount=void 0;var i=s(n(132));var a=s(n(1179));function s(t){return t&&t.__esModule?t:{default:t}}function r(t,e,n,i,a,s,r){try{var o=t[s](r);var l=o.value}catch(t){n(t);return}o.done?e(l):Promise.resolve(l).then(i,a)}function o(t){return function(){var e=this,n=arguments;return new Promise(function(i,a){var s=t.apply(e,n);function o(t){r(s,i,a,o,l,"next",t)}function l(t){r(s,i,a,o,l,"throw",t)}o(void 0)})}}var l=function t(e){var n=e.qSelectionObject.qSelections;return n.reduce(function(t,e){var n=e.qSelectedCount;return t+n},0)};e.selectedValuesCount=l;var c=function(){var t=o(regeneratorRuntime.mark(function t(e){var n,s,r;return regeneratorRuntime.wrap(function t(o){while(1)switch(o.prev=o.next){case 0:n=e.app;o.next=3;return i.default.get(n);case 3:s=o.sent;o.next=6;return s.getLayout();case 6:r=o.sent;return o.abrupt("return",a.default.get(r,n.enigmaModel,true));case 8:case"end":return o.stop()}},t)}));return function e(n){return t.apply(this,arguments)}}();e.getSelections=c},2243:function(t,e,n){},2244:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=e.topics=void 0;var i=o(n(98));var a=r(n(95));var s=r(n(1766));function r(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,n):{};i.get||i.set?Object.defineProperty(e,n,i):e[n]=t[n]}e.default=t;return e}function l(t){l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return l(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,i.key,i)}}function d(t,e,n){e&&u(t.prototype,e);n&&u(t,n);return t}function p(t,e){if(e&&("object"===l(e)||"function"===typeof e))return e;return f(t)}function h(t){h=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return h(t)}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});e&&v(t,e)}function v(t,e){v=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return v(t,e)}var m=Object.freeze({OPEN:"/embed-dialog/open",CLOSE:"/embed-dialog/close"});e.topics=m;var b=function(t){g(e,t);function e(t){var n;c(this,e);n=p(this,h(e).call(this,t));n.state={showDialog:false};n.handleOpen=n.handleOpen.bind(f(n));n.handleClose=n.handleClose.bind(f(n));return n}d(e,[{key:"componentDidMount",value:function t(){a.default.subscribe(m.OPEN,this.handleOpen);a.default.subscribe(m.CLOSE,this.handleClose)}},{key:"componentWillUnmount",value:function t(){a.default.unsubscribe(m.OPEN,this.handleOpen);a.default.unsubscribe(m.CLOSE,this.handleClose)}},{key:"handleOpen",value:function t(e){var n=e.type,i=e.objectId,a=e.onClose,s=void 0===a?function(){}:a;this.setState({showDialog:true,type:n,objectId:i,onClose:s})}},{key:"handleClose",value:function t(){var e=this.state.onClose;this.setState({showDialog:false},e)}},{key:"render",value:function t(){var e=this.state,n=e.showDialog,a=e.type,r=e.objectId;return i.default.createElement(s.default,{show:n,onClose:this.handleClose,type:a,objectId:r})}}]);return e}(i.Component);e.default=b},2245:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var i=c(n(98));var a=n(171);var s=l(n(116));var r=l(n(1668));var o=l(n(91));function l(t){return t&&t.__esModule?t:{default:t}}function c(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,n):{};i.get||i.set?Object.defineProperty(e,n,i):e[n]=t[n]}e.default=t;return e}function u(t){u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return u(t)}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,i.key,i)}}function h(t,e,n){e&&p(t.prototype,e);n&&p(t,n);return t}function f(t,e){if(e&&("object"===u(e)||"function"===typeof e))return e;return v(t)}function g(t){g=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return g(t)}function v(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});e&&b(t,e)}function b(t,e){b=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return b(t,e)}var y=function(t){m(e,t);function e(t){var n;d(this,e);n=f(this,g(e).call(this,t));n.onDuplicateSheet=n.onDuplicateSheet.bind(v(n));return n}h(e,[{key:"onDuplicateSheet",value:function t(){var e=this.props.sheet;(0,r.default)(e,true)}},{key:"render",value:function t(){var e=this.props.showText;return i.default.createElement(a.Button,{tid:"duplicate-sheet-when-no-edit-rights-button",title:o.default.get("Sheet.NoPermission"),onClick:this.onDuplicateSheet},i.default.createElement(a.Button.Icon,{name:"copy"}),e?i.default.createElement(a.Button.Text,{className:"lui-button__text qs-sheet-toolbar-duplicate-sheet"},o.default.get("Common.Duplicate")):null)}}]);return e}(i.Component);y.propTypes={sheet:s.default.object.isRequired,showText:s.default.bool};y.defaultProps={showText:false};var S=y;e.default=S;t.exports=e.default},2246:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var i=x(n(98));var a=n(171);var s=I(n(116));var r=I(n(11));var o=I(n(94));var l=I(n(177));var c=I(n(128));var u=I(n(362));var d=n(90);var p=I(n(91));var h=I(n(2247));var f=I(n(1005));var g=I(n(1043));var v=I(n(411));var m=I(n(1148));var b=I(n(2248));var y=I(n(1666));var S=I(n(1667));function I(t){return t&&t.__esModule?t:{default:t}}function x(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,n):{};i.get||i.set?Object.defineProperty(e,n,i):e[n]=t[n]}e.default=t;return e}function q(){q=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};return q.apply(this,arguments)}function w(t){w="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return w(t)}function C(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function P(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,i.key,i)}}function E(t,e,n){e&&P(t.prototype,e);n&&P(t,n);return t}function k(t,e){if(e&&("object"===w(e)||"function"===typeof e))return e;return O(t)}function T(t){T=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return T(t)}function O(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function A(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});e&&$(t,e)}function $(t,e){$=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return $(t,e)}function D(t){o.default.setState(o.default.States.analysis);c.default.deactivateCell();l.default.setSheet(t.qInfo.qId,Object.keys(o.default.States)[o.default.States.analysis],(0,d.getParameterByName)("app"),null)}var _=function(t){A(e,t);function e(t){var n;C(this,e);n=k(this,T(e).call(this,t));n.state={state:o.default.state};n.stateChanged=n.stateChanged.bind(O(n));n.updateState=n.updateState.bind(O(n));return n}E(e,[{key:"componentDidMount",value:function t(){var e=this.state.state;o.default.setView(o.default.Views.sheet);o.default.StateChanged.bind(this.stateChanged);f.default.setBeforeUnloadFunctions(null,true);e!==o.default.state&&this.setState({state:o.default.state});this.updateState(true)}},{key:"componentDidUpdate",value:function t(){this.updateState(false)}},{key:"componentWillUnmount",value:function t(){o.default.StateChanged.unbind(this.stateChanged);o.default.model.Closed.unbind(u.default.Sheets.navigate);f.default.unsetBeforeUnloadFunctions();(0,r.default)("body").removeClass("qv-story-disabled").removeClass("qv-view-sheet")}},{key:"updateState",value:function t(e){var n=this.props,i=n.sheet,a=n.state,s=n.appUrl;var r=(0,d.getParameterByName)("overlay");l.default.setSheet(i.id,a,(0,d.getParameterByName)("app"),r);e||o.default.model.Closed.unbind(u.default.Sheets.navigate);o.default.setSheet(i,a);o.default.model.Closed.bind(u.default.Sheets.navigate);s.applyArgs()}},{key:"stateChanged",value:function t(e,n){var i=this.state.state;n!==i&&this.setState({state:n})}},{key:"render",value:function t(){var e=this.props;var n=e.isSmallDevice,s=e.sheetLayout,r=e.appUrl;var l=this.state.state;if(!r.readyToRender)return null;if(n&&l===o.default.States.edit)return i.default.createElement(m.default,null,i.default.createElement("div",{style:{marginTop:"15px"}},i.default.createElement(a.Button,{onClick:function t(){return D(s)}},p.default.get("Fullscreen.Button.ToAnalyze"))));return i.default.createElement(b.default,e)}}]);return e}(i.Component);_.propTypes={isSmallDevice:s.default.bool.isRequired,app:s.default.object.isRequired,appLayout:s.default.object.isRequired,appUrl:s.default.object.isRequired};var M=(0,v.default)((0,y.default)((0,S.default)(function(t){return i.default.createElement(g.default,null,function(e){return i.default.createElement(_,q({},t,{isSmallDevice:e}))})},true),true));var N=function t(){var e=(0,h.default)(),n=e.readyToRender,a=e.applyArgs;return i.default.createElement(M,{appUrl:{readyToRender:n,applyArgs:a}})};e.default=N;t.exports=e.default},2247:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var i=n(98);var a=n(1086);var s=r(n(1160));function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){return u(t)||c(t,e)||l()}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function c(t,e){var n=[];var i=true;var a=false;var s=void 0;try{for(var r=t[Symbol.iterator](),o;!(i=(o=r.next()).done);i=true){n.push(o.value);if(e&&n.length===e)break}}catch(t){a=true;s=t}finally{try{i||null==r["return"]||r["return"]()}finally{if(a)throw s}}return n}function u(t){if(Array.isArray(t))return t}function d(){var t=(0,i.useState)(false),e=o(t,2),n=e[0],r=e[1];var l=(0,i.useState)(false),c=o(l,2),u=c[0],d=c[1];var p=(0,i.useContext)(a.UrlParametersContext),h=o(p,3),f=h[2];(0,i.useEffect)(function(){var t=true;u&&s.default.apply(f).then(function(){t&&r(true)});return function(){t=false}},[u]);return{readyToRender:n,applyArgs:function t(){return d(true)}}}var p=d;e.default=p;t.exports=e.default},2248:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var i=o(n(98));var a=r(n(11));var s=r(n(2249));function r(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,n):{};i.get||i.set?Object.defineProperty(e,n,i):e[n]=t[n]}e.default=t;return e}function l(t){l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return l(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,i.key,i)}}function d(t,e,n){e&&u(t.prototype,e);n&&u(t,n);return t}function p(t,e){if(e&&("object"===l(e)||"function"===typeof e))return e;return h(t)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){f=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return f(t)}function g(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});e&&v(t,e)}function v(t,e){v=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return v(t,e)}var m=function(t){g(e,t);function e(t){var n;c(this,e);n=p(this,f(e).call(this,t));n.elemRef=i.default.createRef();return n}d(e,[{key:"componentDidMount",value:function t(){this.component=(0,a.default)(this.elemRef.current).showComponent(s.default)}},{key:"componentWillUnmount",value:function t(){if(this.component)try{this.component.destroy()}catch(t){console.error(t)}}},{key:"render",value:function t(){return i.default.createElement("div",{id:"qv-stage-container",ref:this.elemRef})}}]);return e}(i.Component);var b=m;e.default=b;t.exports=e.default},2249:function(t,e,n){"use strict";var i,a;!(i=[n(2250),n(94),n(202),n(140),n(128),n(97),n(133),n(131),n(93),n(388),n(50),n(114),n(90),n(49),n(157),n(95),n(105),n(192),n(306),n(2251),n(1768),n(1672),n(2287),n(2301),n(175),n(2302),n(2305),n(1776),n(1223),n(2310),n(287),n(508),n(212)],a=function(t,e,n,i,a,s,r,o,l,c,u,d,p,h,f,g,v,m){function b(t,e){t.curSelOptions.enableCao=e;t.curSelOptions.objectSearch=!e}function y(t,e){t.curSelOptions.enableSelInsights=e}return{template:t,controller:["$scope","$timeout","qvGlobalSelectionsService","qvSmallDeviceMenuService","qvSheetService","qvCaoService","$element","qvAppDetailsService",function(t,S,I,x,q,w,C,P){var E=false;function k(t,e){w.isInsightsAvailable().then(function(n){n?e.app.published||!e.permissions.update?b(t,h.getFlag("CAO")&&h.getFlag("CAO_ENABLE_PUBLISHED")&&!t.insightsScriptDisabled):b(t,h.getFlag("CAO")&&!t.insightsScriptDisabled):b(t,false)})}var T=function e(n){k(t,n)};l.getApp().then(function(l){t.app=l;t.navbarModel={app:l,sheetId:t.currentSheet&&t.currentSheet?t.currentSheet.id:null};t.enableSheet=true;t.currentSheet=null;t.hasODAGNavPoints=false;t.odagAssetsTabActive=false;t.assetsController=null;t.odagFeatureOn=false;t.insightsScriptDisabled=false;t.brightTheme=h.getFlag("BRIGHT_THEME");t.ssaInEdit=h.getFlag("SSA_IN_EDIT");t.isSmallDevice=function(){return u.isSmallDevice};t.curSelOptions={enableCao:h.getFlag("CAO"),variant:"bright",objectSearch:!h.getFlag("CAO"),enableSelInsights:h.getFlag("SELECTION_INSIGHTS")};t.state=o;c.loadAppVariables(l).then(function(){if(f.isVariableDefined("DISABLE_INSIGHTS")){t.insightsScriptDisabled=true;b(t,false)}f.isVariableDefined("DISABLE_SELECTION_INSIGHTS")&&y(t,false)});P.get().then(function(t){T(t.model);t.bindOnModelChanged(T)});g.subscribe(v.Events.PubSub.ExpandSmartSearchSuggestedChart,function(e){t.expandSmartSearchSuggestedChart=Boolean(e)});t.$watch(e.isInEditMode,function(n){n!==t.inEdit&&void 0!==t.inEdit&&S(s.force);e.model.getLayout().then(function(e){t.inEdit=n;t.stateLoaded=true;!t.inEdit||k||o.hasPropertiesBeenClosedByUser()||O(e.cells.length>0);if(t.inEdit){if(!e.permissions.update&&a.getZoomCell()){a.zoomOut();a.deactivateCell()}t.assetsController||c.load().then(function(e){t.assetsController=e});if(t.activeCell&&"gridCellStale"===t.activeCell.type){var s=a.getCellWithId(t.activeCell.id);s?a.activateCell(s):q.setSheetAsSelectedObj()}else t.updateStagePropertyPanel(t.activeCell)}i.get().then(function(e){r.isODAGAvailable(e).then(function(n){t.odagFeatureOn=n;if(t.odagFeatureOn&&!E&&t.currentSheet&&t.currentSheet.getNavPoints){m.getList().then(function(t){t.layout&&t.layout.qAppObjectList&&t.layout.qAppObjectList.qItems.length>0&&r.getODAGLinks(e)});t.currentSheet.getNavPoints().then(function(e){t.hasODAGNavPoints=e.length>0})}})})})});var k=false;function O(e){t.state.propertiesOpen=e;e&&(k=true)}t.$watchCollection("state",function(e,n){var i=e.propertiesOpen!==n.propertiesOpen&&"undefined"!==typeof n.propertiesOpen;(e.assetsOpen!==n.assetsOpen||i)&&S(s.force);if(e.selectedObject!==n.selectedObject){e.selectedObject&&!k&&O(true);t.activeCell=e.selectedObject}(i&&e.propertiesOpen||e.selectedObject!==n.selectedObject)&&t.updateStagePropertyPanel(t.activeCell)});t.updateStagePropertyPanel=function(e){e&&e.getAllPropertyPanelContent().then(function(e){if(e){var n={iconName:"",titleRef:"",components:null,definition:null,properties:null,layout:null,localeInfo:null,app:null,cache:null,ext:null,globalChangeListeners:null,handler:null,model:null,yMirrorMode:d.isRtl};p.extend(n,e);t.$broadcast("updateContent",n)}}).catch(function(){})};t.$on("refreshPropertyPanel",function(){e.isInEditMode()&&t.updateStagePropertyPanel(t.activeCell)});t.$watch(I.isSelectActive.bind(null,l),function(e){if(e){t.activeCell&&"gridCell"==t.activeCell.type&&(t.activeCell.type="gridCellStale");a.saveZoom();a.saveScrollState()}else if(!e){a.restoreZoom();a.restoreScrollState()}t.enableSheet=!e});t.$watch(x.isOpen,function(e){t.isInSmallDeviceMenu=e});t.enableODAGToolbar=function(){var n=e.model.layout&&e.model.layout.permissions.update;var i=null;t.assetsController&&(i=t.assetsController.getActiveTabId());var a="assets-tab-odag"===i;var s=true;t.odagFeatureOn?t.inEdit?n&&(t.hasODAGNavPoints||a)||(s=false):t.hasODAGNavPoints||(s=false):s=false;return s};t.sheetChanged=function(n){t.currentSheet=n;t.navbarModel.sheetId=n&&n.id?n.id:null;n.getLayout().then(function(t){e.isInEditMode()&&!k&&O(t.cells.length>0)});q.setSheetAsSelectedObj();t.activeCell=o.selectedObject;t.state.propertiesOpen&&t.activeCell&&t.updateStagePropertyPanel(t.activeCell);!E&&t.currentSheet&&t.currentSheet.getNavPoints&&t.currentSheet.getNavPoints().then(function(e){t.hasODAGNavPoints=e.length>0})};t.sheetChanged(e.model);e.SheetChanged.bind(t.sheetChanged);n.shouldShowOverlay()&&(n.isInSelectionsMode()?I.toggleGlobalSelection(l):n.isInInsightMode()&&w.toggleCao(C))});this.destroy=function(){E=true;t.currentSheet=null;e.SheetChanged.unbind(t.sheetChanged);o.reset();t.destroyComponent();g.unsubscribe(v.Events.PubSub.ExpandSmartSearchSuggestedChart);P.get().then(function(t){t.unbindOnModelChanged(T)})}}]}}.apply(e,i),void 0!==a&&(t.exports=a))},2250:function(t,e){t.exports='<div class="qv-panel qv-panel-stage borderbox" ng-class="{\'qv-mode-edit\':inEdit, \'no-scroll\': isInSmallDeviceMenu, \'bright-theme\': brightTheme, \'ssa-in-edit\' : ssaInEdit}">\n\t<qv-stage-current-selections ng-show="ssaInEdit || !inEdit" ng-if="app" expand-smart-search-suggested-chart="expandSmartSearchSuggestedChart" app="app" options="curSelOptions" class="qvt-selections"></qv-stage-current-selections>\n\t<div class="qv-global-search-container"></div>\n\t<div class="qv-cao-container"></div>\n\t<div class="qv-explore-selections-container"></div>\n\t<div class="qv-panel-content flex-row" ng-class="{\'qv-panel-content-ssa\' : ssaInEdit}">\n\t\t<qv-stage-assets ng-if="inEdit" ng-show="state.assetsOpen" app="app"></qv-stage-assets>\n\t\t<div class="qvt-sheet-container">\n\t\t<qv-stage-sheet ng-if="enableSheet" class="qvt-sheet"></qv-stage-sheet>\n\t\t\t<qv-odag-toolbar class="qv-odag-bar-container" model= "navbarModel" ng-if="enableODAGToolbar() && !isSmallDevice()" in-edit-mode="inEdit" stand-alone="standAlone"></qv-odag-toolbar>\n\t\t</div>\n\t\t<div class=\'qv-panel-properties\' ng-if="stateLoaded" ng-show="inEdit && state.propertiesOpen"><qv-property-panel></qv-property-panel></div>\n\t</div>\n\n\t<qv-stage-edit-bar ng-if="stateLoaded" ng-show="inEdit" assets-open="state.assetsOpen" properties-open="state.propertiesOpen"></qv-stage-edit-bar>\n</div>'},2251:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(95),n(96),n(2252),n(388),n(382),n(94),n(128),n(97),n(49),n(99),n(503),n(2253),n(2255),n(2257),n(2260)],a=function(t,e,n,i,a,s,r,o,l,c,u,d){function p(e){r.addDrag(e,".library-item",{allowScroll:true,isEnabled:function t(e){return!e.item.disabled&&!l.isBlocked()&&(o.view===o.Views.sheet||o.view===o.Views.object?o.model.layout.permissions.update:o.view===o.Views.masterObject)},cond:function t(e){if(d.treatAsDesktop())return true;if(e.distance>7){var n=65;return e.angle>=180-n&&e.angle<180+n}return},onStart:function t(e,i){n.publish("/library/dragstart",i.item)},onStop:function t(e){n.publish("/library/dragstop",e)},info:function t(e){return{type:e.item.dragDropType?e.item.dragDropType:"libraryitem",item:e.item}},elem:function e(n){var e=n.currentTarget.cloneNode(true),i="lui-texthighlight";var a;if("div"===n.target.nodeName.toLowerCase()){e=n.target.parentElement.cloneNode(true);a=t(e).find("ul");a&&a.children.length>0&&t(e).find("ul").remove()}else if("li"===n.target.nodeName.toLowerCase()){a=t(n.target).find("ul");if(a&&a.children.length>0&&"ul"!==n.target.parentElement.nodeName.toLowerCase())t(e).find("ul").remove();else{e=n.target.cloneNode(true);t(e).find("ul").remove()}}e.className+=" ui-draggable-dragging";t(e).find("."+i).removeClass(i);return e}})}var h={template:a,restrict:"E",replace:true,scope:{app:"="},controller:["$scope","$element","$timeout",function(t,e,a){s.load().then(function(s){t.assetsLook=u.getFlag("BRIGHT_THEME")?"default":"inverse";t.assets=s;t.isEditVariable=s.fullMode;e.on("transitionend",function(t){"min-width"===t.originalEvent.propertyName&&a(c.force,0)});function r(){a(s.resize.bind(s),0)}n.subscribe("/resize/end",r);i.utils.touch&&e.on("touchforcechange",function(){});t.$on("$destroy",function(){n.unsubscribe("/resize/end",r);e.off("transitionend");i.utils.touch&&e.off("touchforcechange");s.query=""})});p(e)}]};e.directive("qvStageAssets",function(){return h});return h}.apply(e,i),void 0!==a&&(t.exports=a))},2252:function(t,e){t.exports='<div class="qv-panel-assets " ng-class="{\'qv-panel-assets-expanded\' : assets.tabExpanded, \'qv-panel-assets-collapsed\' : !assets.tabExpanded}">\n\t<qv-assets-button-panel assets="assets" is-edit-variable="isEditVariable"></qv-assets-button-panel>\n\t<section class="qui-toolsframe" id="assets-tab-container" ng-class="{ \'qv-has-tab-row\': assets.tabs.length > 1 }" >\n\t\t<qv-library-drop-target ng-if="assets.tabExpanded"></qv-library-drop-target>\n\n\t\t<header id="toolbox-header">\n\t\t\t<qv-assets-search-panel query="assets.query" clear-when="assets.query === \'\'" look="{{assetsLook}}" />\n\n\t\t\t<div ng-show="assets.activeTab.hasTableFilter">\n\t\t\t\t<qv-assets-table-select table="assets.table" variant="{{assetsLook}}"/>\n\t\t\t</div>\n\t\t</header>\n\n\t\t<div qva-assets-tab="assets.activeTab" component="assets.activeTab.component" class="tab-items-container"></div>\n\n\t\t<div ng-show="assets.activeTab.haveManageDataButtons">\n\t\t\t<qv-assets-data-buttons app="app" />\n\t\t</div>\n\t</section>\n\n\n</div>'},2253:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(2254),n(154),n(106),n(144),n(112)],a=function(t,e,n,i,a,s){t.directive("qvAssetsTableSelect",function(){return{restrict:"E",replace:true,scope:{selectedTable:"=table",variant:"@"},template:e,link:function t(e){function r(t){var n=a.getTables(t);e.tables=s.localeOrderBy(n);e.selectedTable&&-1!==e.tables.indexOf(e.selectedTable)||(e.selectedTable="All");e.$parent.assets.tabs&&s.toggleTableSelect(e.$parent.assets.tabs,n.length>=2)}n.getList().then(function(t){e.listModel=t});i(e,"listModel",r)}}})}.apply(e,i),void 0!==a&&(t.exports=a))},2254:function(t,e){t.exports='<div id="assets-table-select" data-help="Library.Table">\n\t<label q-translation="Assets.FieldsTab.Table"></label>\n\t<lui-select x-variant="{{variant}}" x-model="selectedTable" id="fields-tab-tables">\n\t\t<option value="All" q-translation="Common.All.Tables"></option>\n\t\t<option value="{{table}}" ng-repeat="table in tables">{{table}}</option>\n\t</lui-select>\n</div>'},2255:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(2256),n(236),n(387),n(112)],a=function(t,e,n,i,a){function s(t){var e=t.model.properties.qStateName;return null===e||void 0===e||""===e}function r(t,e,n){var r=e.parent("#assets-tab-container")[0].getBoundingClientRect();var o={left:r.left+2,right:r.right-2,top:r.top+2,bottom:r.bottom-2};var l={targetRect:o,prio:2};var c=n.info.cell.object.isLink;var u=n.info.cell.object.isInvalid;var d=!a.permissionToCreate("visualization");var p=i.typeSupportsMasterVisualizations(n.info.cell.object.type.type);var h=s(n.info.cell);var f=!u&&!c&&!d&&p&&h;if(f){t.error=false;t.title="library.addtoVisualization.drop.title";t.text="library.addtoVisualization.drop";e.addClass("active");l.enter=function(){e.children().addClass("hover")};l.leave=function(){e.children().removeClass("hover")};l.drop=function(t){i.addObjectInCellToLibrary(t.cell)}}else{l.enter=function(){e.addClass("active")};l.leave=function(){e.removeClass("active")};t.error=true;t.title="library.addtoVisualization.nodrop.title";d?t.text="library.addtoVisualization.nodrop.notpermitted":c?t.text="library.addtoVisualization.nodrop.link":u?t.text="library.addtoVisualization.nodrop.invalid":p&&h||(t.text="library.addtoVisualization.nodrop.notsupported")}n.registerDropRect(l)}function o(t){t.removeClass("active ");t.children().removeClass("hover")}t.directive("qvLibraryDropTarget",function(){return{restrict:"E",replace:true,scope:{},template:e,link:function t(e,i){e.active=false;var a={accept:{gridcell:function t(){return true}},start:r.bind(null,e,i),end:o.bind(null,i)};n.registerDropTarget(a);e.$on("$destroy",function(){n.unregisterDropTarget(a)})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},2256:function(t,e){t.exports='<div class="drop-target qv-animate" ng-class="{ error: error }">\n\t<div class=drop-border>\n\t\t<div class="overlay-content">\n\t\t\t<div class="lui-icon lui-icon--link"></div>\n\t\t\t<p class="title" ng-class="{ error: error }" q-translation="{{title}}"></p>\n\t\t\t<p q-translation="{{text}}"></p>\n\t\t</div>\n\t</div>\n</div>\n'},2257:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(2258),n(2259)],a=function(t,e,n){function i(t){return{restrict:"E",replace:true,scope:{count:"="},template:t,link:function t(e){var n=99;e.$watch("count",function(t){t&&(e.text=t<=n?t:n+"+")})}}}t.directive("qvSearchHitIndicator",function(){return i(e)});t.directive("qvOutlinedSearchHitIndicator",function(){return i(n)})}.apply(e,i),void 0!==a&&(t.exports=a))},2258:function(t,e){t.exports='<div class="qui-searchhitindicator" ng-show="count > 0">{{text}}</div>\n'},2259:function(t,e){t.exports='<div class="qui-outlinedsearchhitindicator" ng-show="count > 0">{{text}}</div>\n'},2260:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(2261),n(214),n(1272),n(1290),n(117),n(170),n(255),n(415)],a=function(t,e,n,i,a,s,r){t.directive("qvAssetsDataButtons",function(){return{restrict:"E",replace:true,scope:{app:"="},template:e,link:function e(o){o.buttons=[];t.getService("qvAppDetailsService").get().then(function(e){e.isQDLEnabled()&&o.buttons.push({tooltip:"Assets.FieldsTab.AddData.Tooltip",label:"Common.Add",icon:"lui-icon--add",class:"data-button-add",click:function e(){t.getService("addDataStateService").showAddData()}});var l=null;e.isScriptEditorHidden()||o.buttons.push({tooltip:"Assets.FieldsTab.RefreshData.Tooltip",class:"data-button-refresh",icon:"lui-icon--reload",click:function e(){if(l)return;var c={active:false,setActive:function t(e){this.active=e},isActive:function t(){return this.active}};n.init();o.app.getScript().then(function(e){var n=a.createQScriptModelFromRawText(s.global,o.app.engineApp,e,[],[]);l=t.getService("luiDialog").show({template:i.template,controller:i.controller,input:{scriptModel:n,progressIndicator:c,onClose:function t(){l=null;r.fadeOutWorkingOverlay()}}})})}})})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},2261:function(t,e){t.exports='<div ng-show="buttons.length > 0" class="assets-data-buttons">\n\t<button ng-repeat="button in buttons" class="lui-fade-button" ng-class="button.class" q-title-translation="{{button.tooltip}}" qva-activate="button.click()">\n\t\t<span ng-if="button.icon" class="lui-fade-button__icon lui-icon" ng-class="button.icon"></span>\n\t\t<span ng-if="button.label" class="lui-fade-button__text assets-data-label" q-translation="{{button.label}}"></span>\n\t</button>\n</div>'},2287:function(t,e,n){"use strict";var i,a;!(i=[n(90),n(11),n(48),n(2288),n(131),n(94),n(426),n(106),n(95),n(424),n(91),n(2289),n(2296),n(2300),n(287)],a=function(t,e,n,i,a,s,r,o,l,c,u){var d,p,h,f=false,g={template:i,replace:true,restrict:"E",scope:{assetsOpen:"=",propertiesOpen:"="},controller:["$scope","qvSheetService",function(i,g){i.stageState=a;i.inMasterEditView=s.view===s.Views.masterObject;h=window.localStorage["QlikView-clipboard"]&&window.localStorage["QlikView-clipboard"].length>0;i.hasPasteData=h;i.undoredo={};i.hasStorage=t.isLocalStorageSupported();i.undoredo.qUndoCount=0;i.undoredo.qRedoCount=0;i.assetsToggleLabel=i.assetsOpen?u.get("editbar.hideAssets"):u.get("editbar.showAssets");b();var v=c.hasPending();i.$watch(function(){return c.hasPending()},function(t){v=t});i.undo=function(t){t&&e(t.target).blur();if(v)return;if(i.undoinfo&&!f){f=true;i.undoinfo.undo().then(function(){f=false})}};i.redo=function(t){t&&e(t.target).blur();if(v)return;if(i.undoinfo&&!f){f=true;i.undoinfo.redo().then(function(){f=false})}};i.clearUndo=function(){i.undoinfo&&i.undoinfo.reset()};l.subscribe("/editbar/undo.editbar",i.undo);l.subscribe("/editbar/redo.editbar",i.redo);i.onCopyClicked=function(){i.cell&&t.isFunction(i.cell.copy)&&i.cell.copy()};i.onCutClicked=function(){i.cell&&t.isFunction(i.cell.cut)&&i.cell.cut()};i.onPasteClicked=function(){i.cell&&t.isFunction(i.cell.paste)&&i.cell.paste()};i.onRemoveClicked=function(){if(i.cell&&t.isFunction(i.cell.remove)){i.cell.remove();g.setSheetAsSelectedObj()}};i.checkPasteData=function(t){h=t;s.model.getLayout().then(function(e){i.hasPasteData=t&&e.permissions.update;n.$apply(i)})};var m=i.$root.$on("clearUndo",function(){i.clearUndo()});i.$on("$destroy",function(){m()});i.stateChanged=function(t,e){if(p!==t){i.inMasterEditView=t===s.Views.masterObject;p!==s.Views.story&&p!==s.Views.overview&&p!==s.Views.masterObject&&t!==s.Views.story&&t!==s.Views.view&&t!==s.Views.masterObject||i.clearUndo()}d!==e&&(i.cell=a.selectedObject);p=t;d=e};i.sheetChanged=function(){i.checkPasteData(h);i.clearUndo()};i.toggleAssets=function(){i.assetsOpen=!i.assetsOpen;i.assetsToggleLabel=i.assetsOpen?u.get("editbar.hideAssets"):u.get("editbar.showAssets")};i.toggleProperties=function(){a.togglePropertyPanelByUser()};function b(){i.propertiesToggleLabel=i.propertiesOpen?u.get("editbar.hideProperties"):u.get("editbar.showProperties");a.selectedObject&&"gridCell"===a.selectedObject.type?i.propertiesTooltip=i.propertiesOpen?u.get("editbar.hideChartProperties"):u.get("editbar.showChartProperties"):i.propertiesTooltip=i.propertiesOpen?u.get("editbar.hideSheetProperties"):u.get("editbar.showSheetProperties")}l.subscribe("/editbar/pastedata.editbar",i.checkPasteData);i.$watch("stageState.selectedObject",function(t){i.cell=t;b()});i.$watch("stageState.propertiesOpen",function(){i.propertiesOpen=a.propertiesOpen;b()});r.get().then(function(t){i.undoinfo=t;i.undoinfo.reset()});o(i,"undoinfo",function(t){i.undoredo=t.qUndoInfo});s.StateChanged.bind(i.stateChanged);s.SheetChanged.bind(i.sheetChanged);i.$on("$destroy",function(){l.unsubscribe(".editbar");s.StateChanged.unbind(i.stateChanged);s.SheetChanged.unbind(i.sheetChanged)});s.model&&i.sheetChanged(s.model);i.stateChanged(s.view,s.state);return this}]};n.directive("qvStageEditBar",function(){return g});return g}.apply(e,i),void 0!==a&&(t.exports=a))},2288:function(t,e){t.exports='<div class="qv-panel-subtoolbar qv-panel-edit-bar">\n\t<div class="qui-editbarflat qv-assets">\n\t\t<button\n\t\t\t\tng-class="{ \'active\': assetsOpen }"\n\t\t\t\tq-title-translation="{{assetsToggleLabel}}"\n\t\t\t\tng-click="toggleAssets()"\n\t\t\t\tdata-tid="assets-button">\n\t\t\t<span class="lui-icon lui-icon--toggle-left"></span>\n\t\t\t<span class="toggle-label" q-translation="{{assetsToggleLabel}}"></span>\n\t\t</button>\n\t</div>\n\t<div class="qui-editbarflat qv-editbar">\n\t\t<button\n\t\t\t\tclass="editbar-cut"\n\t\t\t\tng-disabled="!hasStorage || !cell || !cell.canCut() || inMasterEditView"\n\t\t\t\tq-title-translation="contextMenu.cut"\n\t\t\t\tng-click="onCutClicked()">\n\t\t\t<span class="lui-icon  lui-icon--cut"></span>\n\t\t</button>\n\t\t<button\n\t\t\t\tclass="editbar-copy"\n\t\t\t\tng-disabled="!hasStorage || !cell || !cell.canCopy() || inMasterEditView"\n\t\t\t\tq-title-translation="contextMenu.copy"\n\t\t\t\tng-click="onCopyClicked()">\n\t\t\t<span class="lui-icon  lui-icon--copy"></span>\n\t\t</button>\n\t\t<button\n\t\t\t\tclass="editbar-paste"\n\t\t\t\tng-disabled="!hasStorage || !hasPasteData || !cell || !cell.paste || inMasterEditView"\n\t\t\t\tq-title-translation="contextMenu.paste"\n\t\t\t\tng-click="onPasteClicked()">\n\t\t\t<span class="lui-icon  lui-icon--paste"></span>\n\t\t</button>\n\t\t<button\n\t\t\t\tclass="editbar-remove"\n\t\t\t\ttid="editbar-remove-button"\n\t\t\t\tng-disabled="inMasterEditView || !cell || !cell.canRemove()"\n\t\t\t\tq-title-translation="Common.Delete"\n\t\t\t\tng-click="onRemoveClicked()">\n\t\t\t<span class="lui-icon  lui-icon--bin"></span>\n\t\t</button>\n\t</div>\n\t<div class="qui-editbarflat qv-undoredo">\n\t\t<button\n\t\t\t\tclass="editbar-undo"\n\t\t\t\tng-disabled="!undoredo.qUndoCount"\n\t\t\t\tq-title-translation="Common.Undo"\n\t\t\t\tng-click="undo($event)">\n\t\t\t<span class="lui-icon  lui-icon--back"></span>\n\t\t\t</button>\n\t\t<button\n\t\t\t\tclass="editbar-redo"\n\t\t\t\tng-disabled="!undoredo.qRedoCount"\n\t\t\t\tq-title-translation="Common.Redo"\n\t\t\t\tng-click="redo($event)">\n\t\t\t<span class="lui-icon  lui-icon--forward"></span>\n\t\t</button>\n\t</div>\n\t<div class="qui-editbarflat qv-properties">\n\t\t<button\n\t\t\t\tng-class="{ \'active\': propertiesOpen }"\n\t\t\t\tq-title-translation="{{propertiesTooltip}}"\n\t\t\t\tng-click="toggleProperties()"\n\t\t\t\tdata-tid="property-panel-btn">\n\t\t\t<span class="toggle-label" q-translation="{{propertiesToggleLabel}}"></span>\n\t\t\t<span class="lui-icon lui-icon--toggle-right"></span>\n\t\t</button>\n\t</div>\n</div>'},2289:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(2290),n(2291)],a=function(t,e,n){var i;i={template:e,replace:true,restrict:"E",scope:{assets:"=",isEditVariable:"="},controller:["$scope",function(t){t.variablesOpen=false;t.openVariableDialog=function(){t.variablesOpen=true;n.show().opened.then(function(){t.variablesOpen=false})}}]};t.directive("qvAssetsButtonPanel",function(){return i});return i}.apply(e,i),void 0!==a&&(t.exports=a))},2290:function(t,e){t.exports='<div id="assets-button-panel" class="qui-editbarflat qv-assets">\n\n\t<button ng-repeat="tab in assets.tabs" ng-class="{ active: assets.activeTab == tab && assets.tabExpanded, \'hits\': tab.hitCount > 0, \'loading\': tab.loading}"\n\t\t\tdock="right"\n\t\t\tclass="qv-assets-toggle-button"\n\t\t\ttid="tab_bar_button_{{tab.id}}"\n\t\t\tqva-activate="assets.activateTab( tab )">\n\t\t<span class="lui-icon  lui-icon--{{tab.button.icon}}"></span>\n\t\t<qv-search-hit-indicator count="tab.hitCount"></qv-search-hit-indicator>\n\t\t<div class="qv-asset-toggle-label" q-translation="{{tab.longname || tab.button.text}}"></div>\n\t</button>\n\n\t<div class="divider"></div>\n\n\t<div class="filler"></div>\n\n\t<div>\n\t\t<div class="divider"></div>\n\t\t<button ng-if="isEditVariable"\n\t\t\t\tclass="variable qv-assets-toggle-button"\n\t\t\t\tng-class="{ \'active\': variablesOpen }"\n\t\t\t\ttid="show-variables"\n\t\t\t\ttitle="{{::\'Common.Variables\' | translate}}"\n\t\t\t\tlui-title-tooltip\n\t\t\t\tdock="right"\n\t\t\t\tqva-activate="openVariableDialog()">\n\t\t\t<span class="lui-icon  lui-icon--variables"></span>\n\t\t</button>\n\t</div>\n\n</div>'},2291:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(2292),n(2293),n(93),n(2294),n(209),n(241)],a=function(t,e,n,i){var a={template:e,controller:["$scope",function(t){i.getApp().then(function(e){t.variableController=new n(e);var i=t.variableController;t.close=function(){i.newVariable.state=i.newVariable.state||{};if(i.newVariable.state.create||i.newVariable.state.edit)return;t.destroyComponent();t.deferredResult.resolve();i.close()};e.getVariableListObject().then(function(e){t.listModel=e;var n=e.layoutSubscribe(function(t){t=t.filter(function(t){return!t.qIsReserved&&!t.qIsConfig});i.updateList(t)});t.$on("$destroy",function(){n.dispose()})});t.$watch("variableController.newVariable.qName",function(){i.validity.name||(i.validity.name=i.validateName(i.variables,i.newVariable))})})}]};function s(){var e=t.getService("luiDialog").show({template:a.template,controller:a.controller,closeOnOutside:false,showArrow:false});return e}return{show:s}}.apply(e,i),void 0!==a&&(t.exports=a))},2292:function(t,e){t.exports='<div class="lui-modal-background"></div>\n<div class="lui-dialog" id="variable-dialog">\n\t<div class="lui-dialog__header var-header">\n\t\t<div class="lui-dialog__title" q-translation="Common.Variables"></div>\n\t\t<lui-button qva-activate="variableController.createMode( $event )"\n\t\t\t\t\tid="createvariable"\n\t\t\t\t\ttid="create-variable"\n\t\t\t\t\tq-translation="Variable.Dialog.New.Button">\n\t\t</lui-button>\n\t</div>\n\n\t<div class="lui-dialog__body variable-container">\n\t\t<qv-variable-list controller="variableController"></qv-variable-list>\n\t</div>\n\n\n\t<div class="lui-dialog__footer">\n\t\t<lui-button qva-activate="$event.preventDefault(); close()"\n\t\t\t\t\tname="close"\n\t\t\t\t\tng-disabled="variableController.newVariable.state.edit || variableController.newVariable.state.create"\n\t\t\t\t\tq-translation="Common.Close"\n\t\t\t\t\ttid="close">\n\t</div>\n</div>\n\n\n\n'},2293:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(119),n(92),n(150),n(90),n(99),n(317)],a=function(t,e,n,i,a,s,r){var o=n.extend({init:function n(i){this.app=i;this.variables=[];this.newVariables=[];this.newVariable={};this.validity={name:true};this.treatAsDesktop=s.treatAsDesktop();this.container=t(".modal-container");this.container.on("qv-activate",function(){this.saveVariable();e.$rootScope.$apply()}.bind(this))},saveVariable:function t(){this.createVariable();this.editVariable()},showDetails:function t(e){this.saveVariable();this.isExpanded===e.qInfo.qId||this.isCreateMode()?this.isExpanded=null:this.isExpanded=e.qInfo.qId},hideDetails:function t(){if(this.isExpanded&&!this.isCreateMode()){this.isExpanded=null;document.body.focus()}},createMode:function t(e){e.stopPropagation();this.saveVariable();if(this.isCreateMode()){this.newVariable.scrollId=a.generateId();return}this.isExpanded=null;this.newVariable={scrollId:a.generateId(),qName:"",qDefinition:"",tags:[],state:{isNew:false,create:true,edit:false}};this.validity.name=true},createVariable:function t(){if(this.dialogIsOpen)return;if(!this.isCreateMode())return;this.updateTags();if(this.isAllowedToClose()){this.newVariable={};return}if(!this.validateName(this.variables,this.newVariable)){this.validity.name=false;return}var e={qInfo:{qType:"variable"},qName:this.newVariable.qName,qDefinition:this.newVariable.qDefinition,qComment:this.newVariable.qComment,tags:this.newVariable.tags};this.persist(e);this.newVariables.unshift(this.newVariable.qName);this.newVariable={}},remove:function t(n,i){n.stopPropagation();var a=this;r.show({text:"Variable.Dialog.Confirm.Delete"}).then(function(){a.app.destroyVariableById(i.qInfo.qId).then(function(){e.$rootScope.$emit("clearUndo");a.isEditMode()&&(a.newVariable.state.edit=false)})})},cancel:function t(){this.isEditMode()&&(this.newVariable.state.edit=false);this.newVariable={}},editVariable:function t(){if(this.dialogIsOpen)return;if(!this.isEditMode())return;this.updateTags();document.body.focus();var n=this.newVariable.qDefinition;var i=this.newVariable.qComment;var a=this.newVariable.tags;this.app.getVariableById(this.newVariable.qId).then(function(t){t.getProperties().then(function(s){s.qDefinition=n;s.qComment=i;s.tags=a;t.setProperties(s).then(function(){e.$rootScope.$emit("clearUndo")})})});this.newVariable.state.edit=false;this.newVariable={}},updateList:function t(e){var n=a.extend(true,[],e);var i=[];for(var s=0;s<this.newVariables.length;s++)for(var r=0;r<n.length;r++)if(this.newVariables[s]===e[r].qName){n[r].state={isNew:true};i.push(n[r].qName)}this.newVariables=i;this.variables=this.orderVariableList(n)},persist:function t(n){this.app.createVariableEx(n).then(function(){e.$rootScope.$emit("clearUndo")})},openInExpressionDialog:function t(e){e.preventDefault();this.dialogIsOpen=true;i.show({expr:this.newVariable.qDefinition,title:this.newVariable.qDefinition?"Dimension.Expression.Dialog.Edit.Title":"Dimension.Expression.Dialog.Add.Title"}).then(function(t){this.newVariable.qDefinition=t}.bind(this)).finally(function(){this.dialogIsOpen=false}.bind(this))},openEdit:function t(e){e.state=e.state||{};e.state.edit=true;this.newVariable.qId=e.qInfo.qId;this.newVariable.state=e.state;this.newVariable.qDefinition=e.qDefinition;this.newVariable.qComment=e.qDescription;this.newVariable.tags=e.qData.tags||[]},isCreateMode:function t(){return!!this.newVariable.state&&!!this.newVariable.state.create},isEditMode:function t(){return!!this.newVariable.state&&!!this.newVariable.state.edit},isAllowedToClose:function t(){return!!this.newVariable.state&&!!this.newVariable.state.create&&!this.newVariable.qName&&!this.newVariable.qDefinition&&!this.newVariable.qComment&&!this.newVariable.tags.length},orderVariableList:function t(e){var n=this.newVariables.map(function(t){for(var n=0;n<e.length;n++)if(t===e[n].qName)return e[n]});var i=e.filter(function(t){return!t.state||!t.state.isNew}).sort(function(t,e){return t.qName.localeCompare(e.qName)});return n.concat(i)},close:function t(){this.container.off("qv-activate")},validateName:l,validateNameLength:c,validateExistence:u});function l(t,e){return c(e)&&!u(t,e)}function c(t){return!!t.qName&&!!t.qName.trim()&&t.qName.length<256}function u(t,e){return 0!==t.filter(function(t){return t.qName===e.qName}).length}return o}.apply(e,i),void 0!==a&&(t.exports=a))},2294:function(t,e,n){"use strict";var i,a;!(i=[n(119),n(2295),n(241)],a=function(t,e){t.directive("qvVariableList",function(){return{template:e,replace:true,restrict:"E",scope:{controller:"="}}})}.apply(e,i),void 0!==a&&(t.exports=a))},2295:function(t,e){t.exports='<div class="variable-list-container">\n\t<ul class="lui-list variable-list-header">\n\t\t<li class="lui-list__header">\n\t\t\t<div class="lui-list__aside space-placeholder"></div>\n\t\t\t<div class="lui-list__text var-name" q-translation="Common.Name"></div>\n\t\t\t<div class="lui-list__text var-def" q-translation="Variable.Definition"></div>\n\t\t</li>\n\t</ul>\n\n\n\t<ul class="lui-list variable-list" ng-click="$event.stopPropagation()">\n\t\t<li ng-if="!!controller.newVariable">\n\t\t\t\x3c!--Create mode--\x3e\n\t\t\t<div ng-if="controller.newVariable.state.create" qva-outside="controller.createVariable()">\n\t\t\t\t<div class="lui-list__item lui-list__action" qva-scroll-into-view="{ scroll: controller.newVariable.scrollId, scrollSelector: \'.variable-list\' }" qv-escape="controller.cancel()">\n\t\t\t\t\t<div class="lui-list__text variabl-name-header" q-title-translation="Variable.Create.NewVariable" q-translation="Variable.Create.NewVariable"></div>\n\n\t\t\t\t\t<button tid="delete-button" class="lui-fade-button remove-button" ng-click="controller.cancel()" q-title-translation="Common.Delete">\n\t\t\t\t\t\t<span class="lui-fade-button__icon lui-icon lui-icon--bin"></span>\n\t\t\t\t\t</button>\n\n\t\t\t\t\t<button class="lui-fade-button lui-active" ng-click="controller.createVariable()" q-title-translation="Common.Save" data-tid="save">\n\t\t\t\t\t\t<span class="lui-fade-button__icon lui-icon lui-icon--edit"></span>\n\t\t\t\t\t</button>\n\n\t\t\t\t</div>\n\t\t\t\t<div class="create-form variable-details">\n\t\t\t\t\t<div class="label" q-translation="metadata.name"></div>\n\t\t\t\t\t<input tid="name-input" type="text" qva-focus="controller.treatAsDesktop" class="lui-input" maxlength="255" placeholder="{{variable.qName}}" ng-model="controller.newVariable.qName" ng-class="{ \'lui-invalid\': !controller.validity.name }" />\n\t\t\t\t\t<div class="label" q-translation="metadata.definition"></div>\n\t\t\t\t\t<tiny-editor value="controller.newVariable.qDefinition" on-open="controller.openInExpressionDialog( $event )"></tiny-editor>\n\t\t\t\t\t<div class="label" q-translation="metadata.description"></div>\n\t\t\t\t\t<textarea tid="description-text" class="lui-textarea" maxlength="512" ng-model="controller.newVariable.qComment"></textarea>\n\t\t\t\t\t<div class="label" q-translation="metadata.tags" ></div>\n\t\t\t\t\t<qv-tagcloud tags="controller.newVariable.tags" update="controller.updateTags"></qv-tagcloud>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</li>\n\n\t\t<li ng-repeat="variable in controller.variables track by variable.qInfo.qId" data-tid="variable-item">\n\t\t\t\x3c!--Edit mode--\x3e\n\t\t\t<div ng-if="controller.isExpanded == variable.qInfo.qId && variable.state.edit" qva-outside="controller.editVariable()">\n\t\t\t\t<div class="lui-list__item lui-list__action" ng-click="controller.editVariable()" qv-escape="controller.cancel()">\n\t\t\t\t\t<div class="lui-list__text variabl-name-header" title={{variable.qName}}>{{variable.qName}}</div>\n\n\t\t\t\t\t<button tid="delete-button" class="lui-fade-button remove-button" ng-click="controller.remove( $event, variable )" q-title-translation="Common.Delete">\n\t\t\t\t\t\t<span class="lui-fade-button__icon lui-icon lui-icon--bin"></span>\n\t\t\t\t\t</button>\n\n\t\t\t\t\t<button tid="edit-button" class="lui-fade-button lui-active" ng-click="controller.editVariable()" q-title-translation="Common.Save">\n\t\t\t\t\t\t<span class="lui-fade-button__icon lui-icon lui-icon--edit"></span>\n\t\t\t\t\t</button>\n\n\t\t\t\t</div>\n\t\t\t\t<div class="create-form variable-details" qva-scroll-into-view="{ scroll: true, scrollSelector: \'.variable-list\' }">\n\t\t\t\t\t<div class="label" q-translation="metadata.definition"></div>\n\t\t\t\t\t<tiny-editor value="controller.newVariable.qDefinition" on-open="controller.openInExpressionDialog( $event )"></tiny-editor>\n\t\t\t\t\t<div class="label" q-translation="metadata.description"></div>\n\t\t\t\t\t<textarea tid="description-text" class="lui-textarea" maxlength="512" ng-model="controller.newVariable.qComment"></textarea>\n\t\t\t\t\t<div class="label" q-translation="metadata.tags"></div>\n\t\t\t\t\t<qv-tagcloud tags="controller.newVariable.tags" update="controller.updateTags"></qv-tagcloud>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t\x3c!--Read only list--\x3e\n\t\t\t<div ng-if="controller.isExpanded != variable.qInfo.qId" ng-click="controller.showDetails( variable )" class="lui-list__item lui-list__action">\n\t\t\t\t<div class="lui-list__aside space-placeholder lui-icon lui-icon--script" ng-if="variable.qIsScriptCreated" q-title-translation="Variable.Script.Tooltip" data-tid="script-variable"></div>\n\t\t\t\t<div class="lui-list__aside space-placeholder" ng-if="!variable.qIsScriptCreated"></div>\n\t\t\t\t<div class="lui-list__text var-name" title={{variable.qName}}>{{variable.qName}}</div>\n\t\t\t\t<div class="lui-list__text var-def" title={{variable.qDefinition}}>{{variable.qDefinition}}</div>\n\t\t\t\t<div ng-if="variable.state.isNew" q-translation="Common.New" class="newTag">New</div>\n\t\t\t</div>\n\t\t\t<div ng-if="controller.isExpanded == variable.qInfo.qId && !variable.state.edit" qva-scroll-into-view="{ scroll: true, scrollSelector: \'.variable-list\' }" qv-escape="controller.hideDetails()">\n\t\t\t\t<div class="lui-list__item lui-list__action" ng-click="controller.showDetails( variable )">\n\t\t\t\t\t<div class="lui-list__aside space-placeholder lui-icon lui-icon--script" ng-if="variable.qIsScriptCreated" q-title-translation="Variable.Script.Tooltip"></div>\n\t\t\t\t\t<div class="lui-list__text variabl-name-header" title={{variable.qName}}>{{variable.qName}}</div>\n\n\t\t\t\t\t<button ng-if="!variable.qIsScriptCreated" tid="delete-button" class="lui-fade-button remove-button" ng-click="controller.remove( $event, variable )" q-title-translation="Common.Delete">\n\t\t\t\t\t\t<span class="lui-fade-button__icon lui-icon lui-icon--bin"></span>\n\t\t\t\t\t</button>\n\n\t\t\t\t\t<button ng-if="!variable.qIsScriptCreated" tid="edit-button" class="lui-fade-button lui-active" ng-click="controller.openEdit( variable )" q-title-translation="Common.Edit">\n\t\t\t\t\t\t<span class="lui-fade-button__icon lui-icon lui-icon--edit"></span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div class="variable-details">\n\t\t\t\t\t<div class="var-def-expanded">{{variable.qDefinition}}</div>\n\t\t\t\t\t<div ng-if="!variable.qIsScriptCreated" class="var-description">{{variable.qDescription}}</div>\n\t\t\t\t\t<div ng-if="variable.qIsScriptCreated" class="var-description" q-translation="Variable.Script.Description"></div>\n\t\t\t\t\t<ul class="tags">\n\t\t\t\t\t\t<li ng-repeat="tag in variable.qData.tags" class="lui-tag" ng-class="{ \'lui-matched\': tag.matching }">{{tag}}</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</li>\n\t</ul>\n</div>\n'},2296:function(t,e,n){"use strict";var i,a;!(i=[n(2297),n(2298),n(2299),n(128),n(95)],a=function(t,e,n,i,a){var s=new t(e,i,n);function r(t){return t&&t.grid&&t.grid.gridService?t.grid.gridService:i}a.subscribe("/copypaste/reset",function(){s.resetCopyBuffer();a.publish("/editbar/pastedata",false)});a.subscribe("/activeSheet/copyObject",function(t){s.copyObject(t).then(function(){i.deactivateCell(t);a.publish("/editbar/pastedata",true)})});a.subscribe("/activeSheet/cutObject",function(t){s.cutObject(t,r(t)).then(function(){i.deactivateCell(t);a.publish("/editbar/pastedata",true)})});a.subscribe("/activeSheet/pasteObject",function(t){i.zoomOut();s.pasteObject(t).then(function(e){e.service=r(t);a.publish("/dropAction/newObject",e);e.service.activateCell(t)},function(t){if(t){s.resetCopyBuffer();a.publish("/editbar/pastedata",false)}})})}.apply(e,i),void 0!==a&&(t.exports=a))},2297:function(t,e,n){"use strict";var i,a;!(i=[n(89),n(11),n(490),n(90)],a=function(t,e,n,i){function a(){delete localStorage["QlikView-clipboard"];delete localStorage["QlikView-clipboardMasterObject"];delete localStorage["QlikView-clipboardMeasures"];delete localStorage["QlikView-clipboardDimensions"];delete localStorage["QlikView-clipboardChildren"]}function s(n,i){var a=[],s=n.length,r=0,o=new t;0===s&&o.resolve(a);a.length=s;e.each(n,function(t){i.getDimensionProp(n[t]).then(function(e){var n={};n.id=e.qInfo.qId;n.type=e.qInfo.qType;n.grouping=e.qGrouping;n.title=e.title;n.fields=e.qDim.qFieldDefs;a[t]=n;r++;r===s&&o.resolve(a)})});return o.promise}function r(n,i){var a=[],s=n.length,r=0,o=new t;0===s&&o.resolve(a);a.length=s;e.each(n,function(t){i.getMeasureProp(n[t]).then(function(e){var n={};n.id=e.qInfo.qId;n.title=e.title;n.def=e.qMeasure.qDef;a[t]=n;r++;r===s&&o.resolve(a)})});return o.promise}function o(t,n,i){var a,o=[],l=[];if(t.qHyperCubeDef)for(a=0;a<t.qHyperCubeDef.qDimensions.length;a++)t.qHyperCubeDef.qDimensions[a].qLibraryId&&o.push(t.qHyperCubeDef.qDimensions[a].qLibraryId);if(t.qHyperCubeDef)for(a=0;a<t.qHyperCubeDef.qMeasures.length;a++)t.qHyperCubeDef.qMeasures[a].qLibraryId&&l.push(t.qHyperCubeDef.qMeasures[a].qLibraryId);i.getChildrenFor(t.qInfo.qId).then(function(c){var u=e.extend(true,{},t);c.length?localStorage["QlikView-clipboardChildren"]=JSON.stringify(c):delete localStorage["QlikView-clipboardChildren"];for(a=0;a<c.length;a++)c[a].qListObjectDef&&c[a].qListObjectDef.qLibraryId&&o.push(c[a].qListObjectDef.qLibraryId);s(o,i).then(function(t){t.length?localStorage["QlikView-clipboardDimensions"]=JSON.stringify(t):delete localStorage["QlikView-clipboardDimensions"]});r(l,i).then(function(t){t.length?localStorage["QlikView-clipboardMeasures"]=JSON.stringify(t):delete localStorage["QlikView-clipboardMeasures"]});i.addAppId(u).then(function(){localStorage["QlikView-clipboard"]=JSON.stringify(u);n.resolve()})})}function l(e,n){var a=new t;n.getVisualizationProp(e).then(function(t){if(t.qExtendsId){localStorage["QlikView-clipboardMasterObject"]=JSON.stringify(t);n.getMasterObjectProp(t.qExtendsId).then(function(e){var s=i.extend(true,{},e);s.qInfo.qType=t.qInfo.qType;o(s,a,n)})}else{delete localStorage["QlikView-clipboardMasterObject"];o(t,a,n)}});return a.promise}function c(e){var i=JSON.parse(localStorage["QlikView-clipboard"]),a=new t;e.isCopyingBundledImageBetweenApps(i).then(function(t){t&&n.showDialog([{message:"Object.CopyBetweenApps.BundleImageWarning.Text"}]);a.resolve(i)});return a.promise}function u(e){var n,i=new t,a=localStorage["QlikView-clipboardMasterObject"];if(a){n=JSON.parse(a);e.masterObjectExists(n.qExtendsId).then(function(){i.resolve(n)},function(){c(e).then(function(t){delete t.appId;i.resolve(t)})})}else c(e).then(function(t){delete t.appId;i.resolve(t)});return i.promise}function d(e,n,i,a){var s=new t;try{u(n).then(function(t){if(!n.hasVisualizationType(t.qInfo.qType)){s.reject(true);return}var r,o=localStorage["QlikView-clipboardChildren"];r=o?JSON.parse(o):[];e||(e=i.getOptimalCell());e?a.dataCheck(t,n).then(function(){a.childrenDataCheck(r,n).then(function(){s.resolve({cell:e,init:t,children:r,template:t.qInfo.qType})})}):s.reject(false)})}catch(t){s.reject(true)}return s.promise}function p(t,e,n){this.CopySupport=t;this.GridService=e;this.CopyTranslate=n}p.prototype.resetCopyBuffer=a;p.prototype.pasteObject=function(t){return d(t,this.CopySupport,this.GridService,this.CopyTranslate)};p.prototype.copyObject=function(t){if(t.isInvalidObject)return;return l(t,this.CopySupport)};p.prototype.cutObject=function(t,e){if(t.isInvalidObject){e.removeCell(t);return}return l(t,this.CopySupport).then(function(){e.removeCell(t)})};return p}.apply(e,i),void 0!==a&&(t.exports=a))},2298:function(t,e,n){"use strict";var i,a;!(i=[n(134),n(147),n(314),n(115),n(89),n(93)],a=function(t,e,n,i,a,s){var r={};r.getDimensionProp=function(e){var n=new a;t.get(e).then(function(t){t.getProperties().then(function(t){n.resolve(t)})});return n.promise};r.getMeasureProp=function(t){var n=new a;e.get(t).then(function(t){t.getProperties().then(function(t){n.resolve(t)})});return n.promise};r.getVisualizationProp=function(t){var e=new a;t.getVisualization?t.getVisualization().then(function(t){t.model.getProperties().then(function(t){e.resolve(t)})}):e.reject("No Visualization");return e.promise};r.getMasterObjectProp=function(t){var e=new a;n.get(t).then(function(t){t.getProperties().then(function(t){e.resolve(t)})});return e.promise};r.masterObjectExists=function(t){var e=new a;n.get(t).then(function(){e.resolve()},function(){e.reject()});return e.promise};r.hasVisualizationType=function(t){return i.getType(t)};r.getMeasureList=function(){return e.getListLayout()};r.getDimensionList=function(){return t.getListLayout()};r.getChildrenFor=function(t){var e=[],n=[],i;return s.getApp().then(function(s){return s.getObject(t).then(function(t){return t.getChildInfos().then(function(t){for(i=0;i<t.length;++i)e.push(s.getObject(t[i].qId));return a.all(e).then(function(t){for(i=0;i<t.length;++i)n.push(t[i].getProperties());return a.all(n)})})})})};r.addAppId=function(t){return s.getApp().then(function(e){t.appId=e.id})};function o(t){var e=false;if("text-image"===t.visualization){var n=new RegExp("^/media/");if(t.background.url.qStaticContentUrlDef&&n.test(t.background.url.qStaticContentUrlDef.qUrl))return true;for(var i=0;i<t.images.length;i++)if(n.test(t.images[i].url.qStaticContentUrlDef.qUrl)){e=true;break}}return e}r.isCopyingBundledImageBetweenApps=function(t){return s.getApp().then(function(e){return e.id!==t.appId&&o(t)})};return r}.apply(e,i),void 0!==a&&(t.exports=a))},2299:function(t,e,n){"use strict";var i,a;!(i=[n(89),n(11)],a=function(t,e){var n={};function i(n,i,a){var s=new t,r=0,o={dimensionId:n.id,found:false,match:-1,matchtype:0};function l(t){if(t.matchtype>o.matchtype){t.dimensionId=n.id;o=t}}a.length?e.each(a,function(t){if(a[t].qInfo.qType===n.type)if(a[t].qInfo.qId===n.id){l({found:true,match:-1,matchtype:3});r++}else i.getDimensionProp(a[t].qInfo.qId).then(function(e){var i=0;if(e.qDim.qFieldDefs.length===n.fields.length)while(i<e.qDim.qFieldDefs.length){if(e.qDim.qFieldDefs[i]!==n.fields[i])break;i++;l({found:false,match:t,matchtype:1})}r++;r===a.length&&s.resolve(o)});r===a.length&&s.resolve(o)}):s.resolve(o);return s.promise}function a(n,a,s){var r=new t,o=0;s.getDimensionList().then(function(t){e.each(a,function(e){i(a[e],s,t).then(function(i){if(!i.found){if(n.qListObjectDef&&i.dimensionId===n.qListObjectDef.qLibraryId){if(i.match<0){r.resolve();return}n.qListObjectDef.qLibraryId=t[i.match].qInfo.qId}if(n.qHyperCubeDef){if(i.match<0){r.resolve();return}n.qHyperCubeDef.qDimensions.length>e&&(n.qHyperCubeDef.qDimensions[e].qLibraryId=t[i.match].qInfo.qId)}}o++;o===a.length&&r.resolve()})})});return r.promise}function s(n,i){var a=new t,s=0,r={found:false,match:-1,matchtype:0};function o(t){t.matchtype>r.matchtype&&(r=t)}i.getMeasureList().then(function(t){t.length?e.each(t,function(e){if(t[e].qInfo.qId===n.id){o({found:true,match:-1,matchtype:3});s++}else i.getMeasureProp(t[e].qInfo.qId).then(function(i){n.def===i.qMeasure.qDef&&o({found:false,match:e,matchtype:1});s++;s===t.length&&a.resolve(r)});s===t.length&&a.resolve(r)}):a.resolve(r)});return a.promise}function r(n,i,a){var r=new t,o=0;a.getMeasureList().then(function(t){e.each(i,function(e){s(i[e],a).then(function(a){if(!a.found){if(a.match<0){r.resolve();return}n.qHyperCubeDef.qMeasures.length&&(n.qHyperCubeDef.qMeasures[e].qLibraryId=t[a.match].qInfo.qId)}o++;o===i.length&&r.resolve()})})});return r.promise}n.dataCheck=function(e,n,i){var s=false,o=false,l,c,u=new t;try{l=JSON.parse(localStorage["QlikView-clipboardDimensions"]);a(e,l,n).then(function(){s=true;o&&u.resolve()},function(){u.reject(i)})}catch(t){s=true;o&&u.resolve()}try{c=JSON.parse(localStorage["QlikView-clipboardMeasures"]);r(e,c,n).then(function(){o=true;s&&u.resolve()})}catch(t){o=true;s&&u.resolve()}return u.promise};n.childrenDataCheck=function(e,n){var i,a=[],s=0,r=new t;function o(t){void 0!==t&&a.push(t);s++;if(s===e.length){a.sort();a.length&&e.splice(a.pop(),1);r.resolve()}}if(e.length)for(i=0;i<e.length;i++)this.dataCheck(e[i],n,i).then(o,o);else r.resolve();return r.promise};return n}.apply(e,i),void 0!==a&&(t.exports=a))},2300:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(91),n(1589),n(95),n(90),n(94),n(144),n(128),n(387),n(483),n(272),n(101),n(262),n(111)],a=function(t,e,n,i,a,s,r,o,l,c,u,d,p){var h=false;function f(t,n,i,a){this.objectId=t;this.item=n;this.itemarray=i;this.cell=a;this.menu=e.getService("qvContextMenu").menu()}function g(t,e){e.updateGlobalChangeListeners&&e.updateGlobalChangeListeners();t.setProperties(e.properties)}f.prototype.ApplyAlternateState=function(t,e,n,i){this.menu.addItem({translation:i,tid:"apply-alternate-state",select:function i(){e.properties.qStateName=n;g(t,e)}})};f.prototype.Option=function(t){var e="/dropAction/";this.menu.addItem({translation:t.text,tid:t.tid||"",select:function n(){a.publish(e+t.id,t.args)}})};f.prototype.Add=function(t,n){var i=this.item,a=i.type,s=["contextMenu.add",i.name];"measure"===a?n.canAddMeasure()&&this.menu.addItem({translation:s,tid:"add",select:function a(){n.addLibraryMeasure(i.id).then(function(i){g(t,n);e.$rootScope.$broadcast("pp-open-path","data."+i.qDef.cId)})}}):"expression"===a?n.canAddMeasure()&&this.menu.addItem({translation:s,tid:"add",select:function a(){n.addExpressionMeasure(i.name,"").then(function(i){g(t,n);e.$rootScope.$broadcast("pp-open-path","data."+i.qDef.cId)})}}):n.canAddDimension()&&this.menu.addItem({translation:s,tid:"add",select:function s(){"field"===a?n.addFieldDimension(i.name,i.displayName).then(function(i){g(t,n);e.$rootScope.$broadcast("pp-open-path","data."+i.qDef.cId)}):"dimension"===a&&n.addLibraryDimension(i.id).then(function(i){g(t,n);e.$rootScope.$broadcast("pp-open-path","data."+i.qDef.cId)})}})};f.prototype.AddFieldAsMeasure=function(t,n){var i=this.item,a=s.escapeField(i.name),r;if(n.canAddMeasure()){r=this.menu.addItem({translation:"contextMenu.addFieldAsMeasure",tid:"add-field-as-measure"});["Sum","Count","Avg","Min","Max"].forEach(function(s){var o=s+"("+a+")";r.addItem({label:o,tid:s.toLowerCase(),select:function a(){n.addExpressionMeasure(o,i.displayName).then(function(i){g(t,n);e.$rootScope.$broadcast("pp-open-path","data."+i.qDef.cId)})}})})}};f.prototype.Replace=function(t,n,i,a){var s,r,o,l,c=this.item,u,p=c.type,h;h="measure"===p||"expression"===p?n.getMeasures():n.getDimensions();o=h.length>1?this.menu.addItem({translation:i,tid:"replace-submenu"}):this.menu;function f(i,a){o.addItem({translation:a,tid:"replace",select:function a(){var s;switch(p){case"field":s=n.createFieldDimension(c.name,c.name);n.replaceDimension(i,s).then(function(i){g(t,n);e.$rootScope.$broadcast("pp-open-path","data."+i.qDef.cId)});break;case"dimension":s=n.createLibraryDimension(c.id);n.replaceDimension(i,s).then(function(i){g(t,n);e.$rootScope.$broadcast("pp-open-path","data."+i.qDef.cId)});break;case"measure":s=n.createLibraryMeasure(c.id);n.replaceMeasure(i,s).then(function(i){g(t,n);e.$rootScope.$broadcast("pp-open-path","data.."+i.qDef.cId)});break;case"expression":s=n.createExpressionMeasure(c.name,c.name);n.replaceMeasure(i,s).then(function(i){g(t,n);e.$rootScope.$broadcast("pp-open-path","data.."+i.qDef.cId)});break}}})}for(s=0;s<h.length;++s){n.layout||n.setLayout(t.layout);if("measure"===p||"expression"===p){var v=n.getMeasureLayouts()[s];u=v&&v.qFallbackTitle;l=v&&!v.qError}else{var m=n.getDimensionLayouts()[s];if(m){var b="H"===m.qGrouping;u=b?m.title:m.qFallbackTitle}else u="";l=m&&!(m.qError&&!d.isCalcCondNotCalculatedErr(m.qError))}r=u&&l?["contextMenu.replace",u]:a;f(s,r)}};f.prototype.ReplaceDimensions=function(t,e,n){this.Replace(t,e,"Common.Replace","contextMenu.replace.invalidDimension",n)};f.prototype.ReplaceMeasures=function(t,e,n){this.Replace(t,e,"Common.Replace","contextMenu.replace.invalidMeasure",n)};f.prototype.ColorBy=function(t,e,n){var i=this.item,a=i.type,r=["contextMenu.colorBy",i.name],o=p.getValue(n,"ext.support.colorBy",false),l=e.canColorBy(null,o);var c=p.getValue(n,"ext.options.colorByPath","color");if("dimension"===a&&l.byDimension||"measure"===a&&l.byMeasure)this.menu.addItem({translation:r,tid:"colorby",select:function n(){var a=p.getValue(e.properties,c);u.setColorByPropertyDef(a,i);g(t,e)}});else if("field"===a&&(l.byMeasure||l.byDimension)){var d=s.escapeField(i.name),h;h=this.menu.addItem({translation:"contextMenu.colorByFieldMenu"});l.byDimension&&h.addItem({translation:["contextMenu.colorByDimension",i.name],tid:"colorbyfield",select:function n(){var a=p.getValue(e.properties,c);u.setColorByPropertyDef(a,i);g(t,e)}});if(l.byMeasure){var f=h.addItem({translation:"contextMenu.colorByMeasure"});["Sum","Count","Avg","Min","Max"].forEach(function(n){var a=n+"("+d+")";f.addItem({label:a,tid:"colorbyfield",select:function n(){var s=p.getValue(e.properties,c);u.setColorByPropertyDef(s,i,a);g(t,e)}})})}}};function v(t,n){var i=t.top+t.height/2,a=t.left+t.width/2;e.getService("qvContextMenu").show(n.menu,{position:{x:a,y:i},docking:"Center"})}function m(e){var i={id:"fieldlist",args:{template:"listbox",init:{dimensions:[],visualization:"listbox",gadgets:{Title:{text:n.get("Object.ListBox.Title")}}}}};t.each(e,function(t){i.args.init.dimensions.push({label:e[t].title,field:e[t].id})});return i}function b(e){var n=void 0===e.id?t('[id="grid"]'):t('.qv-gridcell[tid="'+e.id+'"]',"#grid");var i=n.offset();return{left:i.left,top:i.top,width:n.width(),height:n.height()}}function y(t,e,n){var i=t.object&&t.object.isInvalid;var a="template"===e.type||"visualization"===e.type;var s=n===r.Views.masterObject;var o=t.object&&t.object.ext&&t.object.ext.addChild;return!s&&(i||a)&&!o}function S(t,e,n,s,o){var c=e.id;var u;var d;if(s){s.args.sheet=t;s.args.cell=e}function p(){if(0===d.menu.items.length){i.show({text:"mastereditor.nooption"});return}d.Option({text:"Common.Cancel",tid:"cancel"});u=b(e);v(u,d)}if(c){d=new f(c,n,o,e);var h=y(e,n,r.view);if(s&&h){void 0!==d.item.template?s.text=["contextMenu.replaceWithNew",d.item.name]:s.text=["contextMenu.replaceWith",d.item.name];s.tid="replace";d.Option(s)}e.getVisualization().then(function(t){t.getDropOptions(d,p)})}else if(s)a.publish("/dropAction/"+s.id,s.args);else if("state"===n.type){d=new f;d.ApplyAlternateState(t,t,n.id,"contextMenu.applyStateToSheet");p()}else window.console.log("no drop action");e.isEmpty||l.activateCell(e)}function I(){var t;r.model.moveObject&&(t=r.model);return t}a.subscribe("/ui/library/addToSheet",function(t){var e=t.item,n=t.itemarray,i=t.cell,a=t.event,r,o=t.sheet||I();function u(t){S(o,i,e,t,n)}function d(t){if(n)S(o,i,e,m(n),n);else{var a=e.getDropOption(e,t);s.isPromise(a)?a.then(function(t){u(t)}):u(a)}}i||(i=l.getOptimalCell());if(i){r=i.id;if(r){var p="measure"===e.type||"dimension"===e.type||"field"===e.type||"expression"===e.type||"state"===e.type;i.object.isLink&&p?c.showNotEditableDialog():d(a)}else d(a)}});a.subscribe("/dropAction/fieldlist",function(t){var e;function n(){var t=e.shift();if(t){a.publish("/ui/library/addToSheet",{item:t});setTimeout(n,1e3)}}e=o.createFromArray(t.init.dimensions,"label");n()});a.subscribe("/dropAction/newObject",function(t){if(t.cell&&t.cell.object&&t.cell.object.ext.addChild&&"container"!==t.template){var e=[];for(var n=0;n<t.children.length;n++)e.push({qChildren:[],qEmbeddedSnapshotRef:null,qProperty:t.children[n]});t.cell.object.ext.addChild(t.init,e);return}var i=t.service||l;if(!h&&!i.isBlocked()){h=true;i.addObject(t).catch(function(){}).finally(function(){setTimeout(function(){h=false},500)})}})}.apply(e,i),void 0!==a&&(t.exports=a))},2301:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(94),n(131),n(128),n(95),n(90),n(48),n(184),n(89),n(214),n(93),n(111),n(240),n(280),n(175),n(257),n(287),n(1773)],a=function(t,e,n,i,a,s,r,o,l,c,u){var d,p=false,h=o.createGroup("sheet",10);function f(){p=true;u.getApp().then(function(t){t.global.getConfiguration().then(function(t){!t.qFeatures.qAutoSave&&p&&h.registerKeys("ctrl+s",_,{allowInInput:true})})});v()}function g(){var e=t(".qv-dialog").is(":visible"),n=t(".qui-delayedModal").is(":visible"),i=t(".qv-hdlm-wizard").is(":visible"),a=t(".lui-dialog").is(":visible");var s=r.getService("$delayedModal");return e||n||s.isOpened||i||a}function v(){h.on()}function m(){p=false;h.off()}function b(t){if(t===e.Views.sheet||t===e.Views.object||t===e.Views.masterObject){m();f()}else m()}e.StateChanged.bind(b);function y(){return d?l.resolve(d):e.model.getLayout().then(function(t){d=t.permissions;return l.resolve(d)})}function S(){var e=r.getService("qvGlobalSelectionsService");var n,i=e.isSelectActive(),a=g(),s=t(".stage-dimmer").length;n=!a&&!s&&!i;return n}function I(){r.getService("qvContextMenu").close();var t=r.getService("qvChartTooltipService");t.close()}function x(){var t=r.getService("$navigationService").Sheets;var e=S();if(e){I();var n=t.getPrevious();t.navigateToSheet(n)}}function q(){var t=S();var e=r.getService("$navigationService").Sheets;if(t){I();var n=e.getFirst();e.navigateToSheet(n)}}function w(){var t=S();var e=r.getService("$navigationService").Sheets;if(t){I();var n=e.getNext();e.navigateToSheet(n)}}function C(){var t=S();var e=r.getService("$navigationService").Sheets;if(t){I();var n=e.getLast();e.navigateToSheet(n)}}function P(){var t=S();t&&u.getApp().then(function(t){return t.getLayout()}).then(function(t){if(!t.qReadOnly&&t.permissions.createSheet){I();return e.setState(e.isInEditMode()?e.States.analysis:e.States.edit)}})}function E(){if(!i.isActive())return;y().then(function(t){var i=S(),a=n.selectedObject,r=!a||a.isEmpty,o=a&&a.canCopy&&a.canCopy()&&s.isFunction(a.copy);if(i&&t.update&&e.isInEditMode()&&o&&!r){I();a.copy()}})}function k(){if(!i.isActive())return;y().then(function(t){var i=S(),a=n.selectedObject,r=!a||a.isEmpty,o=a&&a.canCut&&a.canCut()&&s.isFunction(a.cut);if(i&&t.update&&e.isInEditMode()&&o&&!r){I();a.cut()}})}function T(){if(!i.isActive())return;y().then(function(t){var i=S(),a=n.selectedObject,r=a&&a.paste&&s.isFunction(a.paste);if(i&&t&&e.isInEditMode()&&r){I();a.paste()}})}function O(){y().then(function(t){var n=S();if(n&&t.update&&e.isInEditMode()){I();a.publish("/editbar/undo")}})}function A(){y().then(function(t){var n=S();if(n&&t.update&&e.isInEditMode()){I();a.publish("/editbar/redo")}})}function $(){if(!i.isActive())return;var t=r.getService("qvSheetService");var n=r.getService("qvAccessibilityGridService");var a=e.view===e.Views.masterObject,s=S();i.getZoomCell()?i.zoomOut():n.softReset("GenericObject");if(s&&!a){I();t.setSheetAsSelectedObj();r.$rootScope.$apply()}}function D(){if(!i.isActive())return;y().then(function(t){var i=r.getService("qvSheetService"),a=S(),o=n.selectedObject,l=!!o,c=e.view===e.Views.masterObject,u=o&&o.canRemove()&&s.isFunction(o.remove);if(t.update&&u&&a&&l&&!c){I();o.remove();i.setSheetAsSelectedObj()}})}function _(){var t=g();if(!t){I();c.saveApp()}}function M(){var n=r.getService("qvGlobalSearchService");if(e.state===e.States.analysis&&!g()&&!t(".stage-dimmer").length){I();u.getApp().then(function(t){n.openGlobalSearch(t)})}}h.registerKeys("ctrl+left",x);h.registerKeys("ctrl+home",q);h.registerKeys("ctrl+right",w);h.registerKeys("ctrl+end",C);h.registerKeys("ctrl+e",P);h.registerKeys("ctrl+c",E);h.registerKeys("ctrl+x",k);h.registerKeys("ctrl+v",T);h.registerKeys("ctrl+z",O);h.registerKeys("ctrl+y",A);h.registerKeys("cmd+shift+z",A);h.registerKeys("esc",$);h.registerKeys("del",D);h.registerKeys("ctrl+f",M);h.registerKeys("backspace",D)}.apply(e,i),void 0!==a&&(t.exports=a))},2302:function(t,e,n){"use strict";var i,a;!(i=[n(10),n(48),n(2303),n(50)],a=function(t,e,n,i){e.service("qvMobilePrintService",["$document",function(e){var a={print:{$container:void 0,input:{},getComponent:function t(){return n},setup:function t(){i.ViewChanged.bind(r)},destroy:function t(){i.ViewChanged.unbind(r)}}},s;function r(){l(a.print)}function o(n,i){n.$container=t.element("<div>");n.$containerId?e.find(n.$containerId).append(n.$container):e.find("body").append(n.$container);n.$container.showComponent(n.getComponent(),["$scope",function(t){t.input=i}]);n.setup()}function l(t){if(t.$container){t.$container.remove();t.$container=void 0}t.destroy()}function c(t){return!!t.$container}function u(t,e){c(t)?l(t):o(t,e)}s={toggleMobilePrint:function t(e,n){var i="Object"===n&&e.object.objectSize&&e.object.objectSize.w?e.object.objectSize.w:"640";var s="Object"===n&&e.object.objectSize&&e.object.objectSize.h?e.object.objectSize.h:"480";var r=96;var o={object:e,sourceType:n.toLowerCase(),currentWidth:i,currentHeight:s,currentDpi:r};u(a.print,o)},off:function t(e){var n=a[e];l(n)}};return s}])}.apply(e,i),void 0!==a&&(t.exports=a))},2303:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(92),n(2304),n(224),n(429),n(430)],a=function(t,e,n,i,a,s){var r=200;var o=e.extend({init:function t(e){var n=this;n.$scope=e;e.states=i.getStates();e.state=e.states.IDLE;e.layouts=s.layouts;e.outputs=s.outputs;e.fitCriteriaList={CurrentSize:0,BestFitNoPreserveAspectRatio:2};e.fitCriteria=e.fitCriteriaList.BestFitNoPreserveAspectRatio;e.sourceType=e.input.sourceType;e.export=e.outputs[0];if("pdf"===e.export.type){e.sizes=s.sizes;e.selectedSize=e.sizes[1];e.print={dpi:r,fitCriteria:e.fitCriteriaList.BestFitNoPreserveAspectRatio,width:e.input.currentWidth,height:e.input.currentHeight};e.selectedLayout=e.layouts[1]}}});o.$inject=["$scope"];t.directive("qvMobilePrint",["qvMobilePrintService",function(t){return{restrict:"E",template:n,controller:o,replace:true,require:["qvMobilePrint"],scope:true,link:function e(n){if(n.input&&n.input.object){var s=n.input.object.model.id;var r={id:s,model:n.input.object.model,options:{id:s,isVisible:true,isOnGrid:false,isZoomed:false}};n.obj=r}n.cancel=function(e){e.preventDefault();i.cancel();t.off("print")};var o=a.create(n);n.confirm=o.confirm;n.onPrintLayout=o.onPrintLayout;n.onFitCriteria=o.onFitCriteria;n.onFormatChange=o.onFormatChange}}}]);return"<qv-mobile-print></qv-mobile-print>"}.apply(e,i),void 0!==a&&(t.exports=a))},2304:function(t,e){t.exports='<div class="qv-mobile-print" tcl="mobile-print-settings">\n\t<div class="qui-toolbar qv-mp-toolbar">\n\t\t<qui-toolbarbutton qva-activate="cancel($event)" name="cancel" class="qv-mp-toolbar-close" tid="mobile-print-close">\n\t\t\t<span q-translation="Common.Cancel" class="qv-mp-toolbar-close-text"></span>\n\t\t</qui-toolbarbutton>\n\n\t\t<qui-toolbarbutton ng-disabled="state === states.PENDING" qva-activate="$event.preventDefault(); confirm(export.type)" name="confirm" class="qv-mp-toolbar-confirm" tid="mobile-print-export">\n\t\t\t<span q-translation="Print.Download" class="qv-mp-toolbar-confirm-text"></span>\n\t\t</qui-toolbarbutton>\n\t</div>\n\t<div ng-if="state === states.PENDING" class="loader-overlay">\n\t\t<div class="section loader-container">\n\t\t\t<div class="qv-loader white dm-p"></div>\n\t\t</div>\n\t</div>\n\n\t<div class="section" ng-if="sourceType === \'object\'">\n\t\t<div class="section-title" q-translation="Print.ChooseFormat"></div>\n\t\t<lui-select x-variant="inverse"\n\t\t\t\ttid="print-format"\n\t\t\t\tx-model="export"\n\t\t\t\tx-options="o as o.label for o in outputs"\n\t\t\t\tx-change="onFormatChange(export)"\n\t\t\t\tx-disabled="state === states.PENDING">\n\t\t</lui-select>\n\t</div>\n\n\t<div class="section" ng-show="export.type === \'pdf\'">\n\t\t<div class="section-title" q-translation="Print.PaperSize"></div>\n\t\t<lui-select x-variant="inverse"\n\t\t\t\ttid="print-paper-size"\n\t\t\t\tx-model="selectedSize"\n\t\t\t\tx-options="size.label for size in sizes"\n\t\t\t\tx-change="onSizeChange(selectedSize)"\n\t\t\t\tx-disabled="state === states.PENDING">\n\t\t</lui-select>\n\t</div>\n\t<div class="section" ng-show="export.type === \'pdf\'">\n\t\t<div class="section-title" q-translation="Print.Layout"></div>\n\n\t\t<lui-select x-variant="inverse"\n\t\t\t\ttid="print-orientation"\n\t\t\t\tx-model="selectedLayout"\n\t\t\t\tx-options="l.label for l in layouts"\n\t\t\t\tx-change="onPrintLayout(selectedLayout)"\n\t\t\t\tx-disabled="state === states.PENDING">\n\t\t</lui-select>\n\t</div>\n\n    <div ng-if="state === states.COMPLETED" tid="mobile-download-link" tdl="{{printUrl}}">\n        <div class="section qv-mobile-print-download">\n            <a ng-href="{{printUrl}}" target="_blank" q-translation="{{printUrlTranslationKey}}"></a>\n        </div>\n    </div>\n\n\t<div ng-if="state === states.TIMEOUT">\n\t\t<div class="section">\n\t\t\t<p class="dm-p" q-translation="Print.Failed.TimeoutMessage"></p>\n\t\t</div>\n\t</div>\n\t<div ng-if="state === states.FAILED">\n\t\t<div class="section">\n\t\t\t<p class="dm-p" q-translation="Print.Failed.GenericMessage"></p>\n\t\t</div>\n\t</div>\n</div>\n'},2305:function(t,e,n){"use strict";var i,a;!(i=[n(10),n(48),n(2306),n(50)],a=function(t,e,n,i){e.service("qvMobileDownloadService",["$document",function(e){var a={download:{$container:void 0,input:{},getComponent:function t(){return n},setup:function t(){i.ViewChanged.bind(r)},destroy:function t(){i.ViewChanged.unbind(r)}}},s;function r(){l(a.download)}function o(n,i){n.$container=t.element("<div>");e.find(n.$containerId||"body").append(n.$container);n.$container.showComponent(n.getComponent(),["$scope",function(t){t.input=i}]);n.setup()}function l(t){if(t.$container){t.$container.remove();t.$container=void 0}t.destroy()}function c(t){return!!t.$container}function u(t,e){c(t)?l(t):o(t,e)}s={toggleMobileDownload:function t(e,n){var i="Object"===n&&e.object.objectSize&&e.object.objectSize.w?e.object.objectSize.w:"640";var s="Object"===n&&e.object.objectSize&&e.object.objectSize.h?e.object.objectSize.h:"480";var r=96;var o={object:e,sourceType:n.toLowerCase(),currentWidth:i,currentHeight:s,currentDpi:r};u(a.download,o)},off:function t(e){var n=a[e];l(n)}};return s}])}.apply(e,i),void 0!==a&&(t.exports=a))},2306:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(2307),n(1317),n(1180),n(432)],a=function(t,e,n,i,a){t.directive("qvMobileDownload",["qvMobileDownloadService",function(s){return{restrict:"E",template:e,replace:true,scope:true,link:function e(r){if(r.input&&r.input.object){var o=r.input.object.model.id;var l={id:o,model:r.input.object.model,options:{id:o,isVisible:true,isOnGrid:false,isZoomed:false}};r.obj=l}r.cancel=c;function c(t){t.preventDefault();a.cancel();s.off("download")}r.states=a.getStates();r.sourceType=r.input.sourceType;var u=i.getForMobile();r.output=u.output;r.export=r.output.options[0];r.paperFormat=u.pdf.paperFormat;r.selectedPaperFormat=r.paperFormat.options[1];r.size=u.pdf.size;r.selectedFitCriteria=r.size.options[0];r.orientation=u.pdf.orientation;r.currentOrientation=r.orientation.options[1];r.onFormChange=d;function d(){r.embedUrl="";r.printUrl="";"pdf"==r.export.type?f():h();p(r,r.export.type)}function p(t,e){var i=n.create(t);i.confirm(e)}function h(){r.print={};r.imageCustomSize=false;r.print.format=r.export.format}function f(){r.print={};r.print.dpi=200;r.minDpi=72;r.maxDpi=300;r.selectedSize=r.selectedPaperFormat;r.selectedLayout=r.currentOrientation;r.print.fitCriteria=r.selectedFitCriteria.value}var g="";r.embedUrl="";var v=t.getService("$sce");var m=t.getService("$timeout");r.$watch("printUrl",b);function b(t){if("pdf"===r.export.type&&t&&t!=g){g=t;a.getPdfEmbedUrl(g).then(function(t){m(function(){r.embedUrl=v.trustAsResourceUrl(t)})},function(){r.embedUrl=""})}}r.onFormChange();r.downloadFile=y;function y(){var t=r.printUrl;var e=r.printFileName;var n=r.export.format;a.downloadFile(t,e,n)}}}}]);return"<qv-mobile-download></qv-mobile-download>"}.apply(e,i),void 0!==a&&(t.exports=a))},2307:function(t,e){t.exports='<div class="qv-mobile-download" tcl="mobile-download-settings">\n\t<div class="qui-toolbar qv-md-toolbar">\n\t\t<qui-toolbarbutton qva-activate="cancel($event)" name="cancel" class="qv-md-toolbar-close" tid="mobile-download-close">\n\t\t\t\t<span class="qv-md-toolbar-close-text" q-translation="Common.Close"></span>\n\t\t</qui-toolbarbutton>\n\t</div>\n\t<div ng-if="state === states.PENDING" class="loader-overlay">\n\t\t<div class="section loader-container">\n\t\t\t<div class="qv-loader white dm-p"></div>\n\t\t</div>\n\t</div>\n\t<div class="qv-md-download-body">\n\t\t<div class="section" ng-show="sourceType === \'object\' && output.show">\n\t\t\t<div class="section-title" q-translation="{{output.title}}"></div>\n\t\t\t<lui-select x-variant="inverse"\n\t\t\t\t\ttid="download-format"\n\t\t\t\t\tx-model="export"\n\t\t\t\t\tx-change="onFormChange()"\n\t\t\t\t\tx-options="o as o.label for o in output.options"\n\t\t\t\t\tx-disabled="state === states.PENDING">\n\t\t\t</lui-select>\n\t\t</div>\n\t\t<div class="preview-section" ng-hide="state === states.PENDING">\n\t\t\t<dd-image-preview ng-show="export.type === \'image\'" state="state" states="states" preview-url="printUrl"></dd-image-preview>\n\t\t\t<dd-pdf-preview ng-show="export.type === \'pdf\'" state="state" states="states" preview-url="embedUrl"></dd-pdf-preview>\n\t\t</div>\n\t\n\t\t<div class="section" ng-show="export.type === \'pdf\' && paperFormat.show">\n\t\t\t<div class="section-title" q-translation="{{paperFormat.title}}"></div>\n\t\t\t<lui-select x-variant="inverse"\n\t\t\t\t\ttid="download-paper-format"\n\t\t\t\t\tx-model="selectedPaperFormat"\n\t\t\t\t\tx-options="paperFormat.label for paperFormat in paperFormat.options"\n\t\t\t\t\tx-change="onFormChange()"\n\t\t\t\t\tx-disabled="state === states.PENDING">\n\t\t\t</lui-select>\n\t\t</div>\n\t\t<div class="section" ng-show="export.type === \'pdf\' && orientation.show">\n\t\t\t<div class="section-title" q-translation="{{orientation.title}}"></div>\n\t\t\t<lui-select x-variant="inverse"\n\t\t\t\t\ttid="download-orientation"\n\t\t\t\t\tx-model="currentOrientation"\n\t\t\t\t\tx-options="o.label for o in orientation.options"\n\t\t\t\t\tx-change="onFormChange()"\n\t\t\t\t\tx-disabled="state === states.PENDING">\n\t\t\t</lui-select>\n\t\t</div>\n\n\t\t<div class="section" ng-show="export.type === \'pdf\' && orientation.show">\n\t\t\t\t<div class="section-title" q-translation="{{size.title}}"></div>\n\t\t\t\t<lui-select x-variant="inverse"\n\t\t\t\t\t\ttid="download-fitcriteria"\n\t\t\t\t\t\tx-model="selectedFitCriteria"\n\t\t\t\t\t\tx-options="size.label for size in size.options"\n\t\t\t\t\t\tx-change="onFormChange()"\n\t\t\t\t\t\tx-disabled="state === states.PENDING">\n\t\t\t\t</lui-select>\n\t\t</div>\n\t</div>\n\n\t<div class="qv-md-download-footer">\n\t\t<div class="qv-md-btn-wrap" ng-if="state === states.COMPLETED">\n\t\t\t<lui-button\n\t\t\tng-click="downloadFile()"\n\t\t\tclass="lui-button lui-button--success lui-button--x-large qv-md-btn" \n\t\t\tng-class="{ \'lui-disabled\': state === states.PENDING || !printUrl }" \n\t\t\ttid="download-export" \n\t\t\tq-translation="Download.Title" \n\t\t\taria-label="{{translate(\'Download.Aria.DownloadButton\')}}"></lui-button>\n\t\t</div>\n\t\t<div class="qv-md-btn-wrap" ng-if="state === states.FAILED">\n\t\t\t<lui-button\n\t\t\t  class="lui-button lui-button--warning lui-button--x-large qv-md-btn" \n\t\t\t  qva-activate="onFormChange()"\n\t\t\t  tid="download-try-again" \n\t\t\t  q-translation="Common.TryAgain" \n\t\t\t  aria-label="{{translate(\'Download.Aria.TryAgain\')}}"></lui-button>\n\t\t</div>\n\t</div>\n</div>\n'},2308:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91),n(138),n(94),n(140),n(2309),n(135),n(509),n(1776),n(323),n(510)],a=function(t,e,i,a,s,r,o,l){t.nativeComponent("qvMobileOdag",{bindings:{},controller:["qvMobileOdagService","odagNavpointService",function(t,r){var c=this;c.pagetitle=e.get("odag.toolbar.mobile.title");c.loadingContent={value:true};c.selectedNavPoint=null;c.showInfoPopup=false;c.bindings=[];c.selectedNavPointHeader={templateThumbnail:"",templateName:e.get("Common.Loading"),templateDescription:e.get("Common.Loading")};c.selectedNavPointGeneratedApps=[];c.odagToolbarService=new l;c.odagNavpointService=r;c.expandedItem={item:null};c.generateAppInProgress=false;c.maxGeneratedAppLimitReached=false;c.dismissedMaxGenAppMsg=false;c.bindingsPass=true;c.isGenerateBtnDisabled=function(){c.bindingsPass=c.bindings.filter(function(t){return false===t.bindingPassesConstraint}).length>0;return c.selectedNavPoint&&(c.selectedNavPoint.invalid||c.maxGeneratedAppLimitReached||c.bindingsPass||!c.selectedNavPoint.rowCountPercentage||100!==c.selectedNavPoint.rowCountPercentage||o.isSuffixInUse("noData")||c.generateAppInProgress)};u(null);c.back=function(){u(null)};c.close=function(){t.toggleMobileOdag();c.odagToolbarService.destroy()};c.selectNavPoint=function(t){t&&!t.invalid&&u(t)};c.onApplySelectionsCallback=function(){c.close()};c.loadGeneratedApps=function(){r.loadGeneratedApps(c.selectedNavPoint,c.selectedNavPointGeneratedApps).then(function(){c.loadingContent.value=false;c.maxGeneratedAppLimitReached=c.selectedNavPointGeneratedApps.length>=c.selectedNavPoint.maxNumberOfApps})};c.dismissMaxGenAppMsgClicked=function(){c.dismissedMaxGenAppMsg=true};c.onGenerateAppClicked=function(){c.generateAppInProgress=true;r.generateApp(c.selectedNavPoint).then(function(){c.generateAppInProgress=false;c.showInfoPopup=false;c.loadGeneratedApps()}).catch(function(t){c.generateAppInProgress=false;throw t})};c.reloadApp=function(t,e){c.generateAppInProgress=true;r.reloadApp(c.selectedNavPoint,t.requestId,e).then(function(){c.generateAppInProgress=false;c.loadGeneratedApps();2===e&&(c.expandedItem.item=null)}).catch(function(t){c.generateAppInProgress=false;throw t})};c.onBodyClicked=function(){c.showInfoPopup=false};c.onNavPointInfoClicked=function(){c.showInfoPopup=!c.showInfoPopup};c.deleteGenAppClicked=function(t,e){t.preventDefault();t.stopPropagation();c.showInfoPopup&&(c.showInfoPopup=!c.showInfoPopup);if(e.deleteIcon&&!e.actionInProgress){e.actionInProgress=true;r.deleteGeneratedApp(e).then(function(){c.loadGeneratedApps();c.expandedItem.item&&e.requestId===c.expandedItem.item.requestId&&(c.expandedItem.item=null);e.actionInProgress=false}).catch(function(t){e.actionInProgress=false;throw t})}};function u(t){c.selectedNavPoint=t;if(c.selectedNavPoint){var o=a.model;c.odagToolbarService.sheetChanged(o.id);!c.selectedNavPointHeader.templateThumbnail&&c.selectedNavPoint&&(c.selectedNavPointHeader.templateThumbnail=n.p+"img/core/static/Default_thumbnail_app.png");c.circleModel={chartValue:t.rowCountPercentage?t.rowCountPercentage:0};c.infoHeader=e.get("odag.toolbar.navpoint.popup.info.header");r.initializeBindings(t,c.bindings);t.initialized.promise.then(function(){c.pagetitle=t.data.title;c.actualRowEstFormatted="NaN"===t.actualRowEst?e.get("odag.toolbar.navpoint.popup.invalid"):i.format.number(t.actualRowEst,{});c.maxRowExpressionCountFormatted=i.format.number(t.maxRowExpressionCount,{});r.updateItemHeader(c.selectedNavPoint,c.selectedNavPointHeader).finally(function(){r.loadGeneratedApps(c.selectedNavPoint,c.selectedNavPointGeneratedApps).then(function(){c.loadingContent.value=false;c.maxGeneratedAppLimitReached=c.selectedNavPointGeneratedApps.length>=c.selectedNavPoint.maxNumberOfApps;c.expandedItem.item&&(c.generatedApps.some(function(t){return c.expandedItem.item.requestId===t.requestId})||(c.expandedItem.item=null))})})})}else{c.dismissedMaxGenAppMsg=false;c.loadingContent.value=true;c.selectedNavPointGeneratedApps=[];c.pagetitle=e.get("odag.toolbar.mobile.title");s.get().then(function(t){c.odagToolbarService.init(t);var e=a.model;c.odagToolbarService.sheetChanged(e.id);!c.selectedNavPointHeader.templateThumbnail&&c.selectedNavPoint&&(c.selectedNavPointHeader.templateThumbnail=n.p+"img/core/static/Default_thumbnail_app.png")})}}}],template:r});return"<qv-mobile-odag></qv-mobile-odag>"}.apply(e,i),void 0!==a&&(t.exports=a))},2309:function(t,e){t.exports='<div class="qv-mobile-odag">\n\t<div class="qui-toolbar toolbar">\n\t\t<button ng-if="$ctrl.selectedNavPoint" class="lui-fade-button  lui-fade-button--inverse close-button" ng-click="$ctrl.back()">\n\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--arrow-left"></span>\n\t\t</button>\n\t\t<div ng-if="!$ctrl.selectedNavPoint"></div>  \x3c!--to keep the title centered --\x3e\n\t\t<h1 q-translation="{{$ctrl.pagetitle}}" class="title"></h1>\n\t\t<button class="lui-fade-button  lui-fade-button--inverse close-button" ng-click="$ctrl.close()" q-translation="Common.Close"></button>\n\t</div>\n\n\t<div ng-if="!$ctrl.selectedNavPoint" class="list-container">\n\t\t<ul class="list  lui-list">\n\t\t\t<li ng-repeat="item in $ctrl.odagToolbarService.getOdagNavPoints()" class="odag-nav-point lui-list__item lui-list__action" ng-click="$ctrl.selectNavPoint(item)">\n\t\t\t\t<div class="nav-point-container" ng-class="{\'invalid\': item.invalid }">\n\t\t\t\t\t<qv-odag-toolbar-navpoint item="item" in-edit-mode="false" in-mobile-mode="true"></qv-odag-toolbar-navpoint>\n\t\t\t\t</div>\n\t\t\t</li>\n\t\t</ul>\n\t\t<div ng-if="$ctrl.odagToolbarService.getOdagNavPoints().length === 0" class="no-navpoints" q-translation="odag.toolbar.navpoint.popup.noAppNavLinks"></div>\n\t</div>\n\n\t<div ng-if="$ctrl.selectedNavPoint" class="odag-selected-nav-point" >\n\n\t\t<div class="top" ng-click="$ctrl.onBodyClicked()">\n\t\t\t<div class="header">\n\t\t\t\t<img qva-prevent-drag ng-src="{{ $ctrl.selectedNavPointHeader.imgSrc }}" class="app-thumbnail-img"/>\n\t\t\t\t<div class="title-description-container">\n\t\t\t\t\t<div class="title" title="{{$ctrl.selectedNavPointHeader.templateName}}">{{$ctrl.selectedNavPointHeader.templateName}}</div>\n\t\t\t\t\t<div class="description" title="{{$ctrl.selectedNavPointHeader.templateDescription}}">{{$ctrl.selectedNavPointHeader.templateDescription}}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="app-list-container">\n\t\t\t\t<odag-app-list2 style="width:100%; height: 100%; position: relative; overflow-y:auto;" ng-if="!$ctrl.loadingContent.value" x-variant="odag-app-list--mobile" applist="$ctrl.selectedNavPointGeneratedApps" generate-app-in-progress="$ctrl.generateAppInProgress" expanded-item="$ctrl.expandedItem" reload-app="$ctrl.reloadApp" load-generated-apps="$ctrl.loadGeneratedApps" is-generate-btn-disabled="$ctrl.isGenerateBtnDisabled" on-apply-selections-callback="$ctrl.onApplySelectionsCallback" loading="$ctrl.loadingContent.value" delete-clicked="$ctrl.deleteGenAppClicked"></odag-app-list2>\n\t\t\t\t<div ng-if="$ctrl.maxGeneratedAppLimitReached && !$ctrl.dismissedMaxGenAppMsg && !$ctrl.loadingContent.value" class="odag-max-app-limit-reached">\n\t\t\t\t\t<div class="max-app-text" q-translation="odag.toolbar.napvoint.popup.maxAppLimitReached"></div>\n\t\t\t\t\t<button class="lui-fade-button close-button" q-title-translation="Common.Close" ng-click="$ctrl.dismissMaxGenAppMsgClicked()"><span class="lui-button__icon  lui-icon  lui-icon--close"></span></button>\n\t\t\t\t</div>\n\t\t\t\t<qv-spinner class="spinner" ng-if="$ctrl.loadingContent.value" show="$ctrl.loadingContent.value"></qv-spinner>\n\t\t\t</div>\n\n\t\t\t<div ng-if="$ctrl.showInfoPopup" class="infoPopup">\n\t\t\t\t<div class="info-constraints-header">{{$ctrl.infoHeader}}</div>\n\t\t\t\t<div class="info-row-count-container">\n\t\t\t\t\t<div class="info-section" q-translation="odag.toolbar.navpoint.popup.info.row.count.header"></div>\t\t\t\n\t\t\t\t\t<div class="info-row-count-content">\n\t\t\t\t\t\t<div class="info-row-count-progress-circle">\n\t\t\t\t\t\t\t<circle-chart model=\'$ctrl.circleModel\'></circle-chart>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="info-row-count-current">\n\t\t\t\t\t\t\t<div class="info-row-count-header" q-translation="odag.toolbar.navpoint.popup.info.row.count.current.header" ></div>\n\t\t\t\t\t\t\t<div class="">{{$ctrl.actualRowEstFormatted}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="info-row-count-constraint">\n\t\t\t\t\t\t\t<div class="info-row-count-header" q-translation="odag.toolbar.navpoint.popup.info.row.count.constraint.header"></div>\n\t\t\t\t\t\t\t<div> < {{$ctrl.maxRowExpressionCountFormatted}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\t\t\t\n\t\t\t\t</div>\t\n\t\t\t\t<div class="info-section" q-translation="odag.toolbar.navpoint.popup.info.field.header" ></div>\n\t\t\t\t<div class="info-field-container">\n\t\t\t\t\t<div class="info-field-header">\n\t\t\t\t\t\t<div class="info-field" q-translation="odag.toolbar.navpoint.popup.info.field.table.header"></div>\n\t\t\t\t\t\t<div class="info-value" q-translation="odag.toolbar.navpoint.popup.info.current.table.header"></div>\n\t\t\t\t\t\t<div class="info-constraint" q-translation="odag.toolbar.navpoint.popup.info.constraint.table.header"></div>\n\t\t\t\t\t</div>\n\t\n\t\t\t\t\t<div class="info-field-values">\n\t\t\t\t\t\t<div ng-repeat="binding in $ctrl.bindings | orderBy: \'-hasConstraint\' " class="info-field-row" ng-if="$ctrl.bindings.length">\n\t\t\t\t\t\t\t<div class="info-field-data">{{binding.fieldName}}</div>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<div class="info-value-data">\n\t\t\t\t\t\t\t\t<div class="info-field-checkmark" ng-if="binding.bindingPassesConstraint">\n\t\t\t\t\t\t\t\t\t<span class="lui-icon  lui-icon--tick" aria-hidden="true"></span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="info-field-warning" ng-if="!binding.bindingPassesConstraint">\n\t\t\t\t\t\t\t\t\t<span class="lui-icon  lui-icon--warning-triangle" aria-hidden="true"></span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div ng-if="binding.hasConstraint">{{binding.values.length}}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<div class="info-constraint-data">{{binding.constraint}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div ng-if="!$ctrl.expandedItem.item" class="bottom">\n\t\t\t<lui-button class="info-button" ng-click="$ctrl.onNavPointInfoClicked($event)" ng-class="{\'lui-button--danger\': $ctrl.bindingsPass, \'lui-active\': $ctrl.showInfoPopup}">\n\t\t\t\t<span class="lui-icon  lui-button__icon lui-icon--info"></span>\n\t\t\t</lui-button>\n\n\t\t\t<lui-button class="generate-button" tid="odag-toolbar-navpoint-popover_generate_app_button" ng-disabled="$ctrl.isGenerateBtnDisabled()" ng-click="$ctrl.onGenerateAppClicked()" q-translation="odag.toolbar.navpoint.popup.generate.app"></lui-button>\n\t\t</div>\n\n\t</div>\n\n</div>'},2310:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(11),n(2311),n(51)],a=function(t,e,n,i){function a(e){var a={};i.show(n,{cardControl:a});var s=t.getService("$timeout");s(function(){a.init(e)});return a}function s(){var t=e('[qv-id="card-modal"]');t.length&&t.scope().closeCard();t=null}var r={show:a,close:s};t.service("cardService",[function(){return r}]);return r}.apply(e,i),void 0!==a&&(t.exports=a))},2311:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(2312),n(2313),n(2314)],a=function(t,e){t.componentDirective("qhIncludeCardStep",{});var n={restrict:"EA",replace:true,scope:{cardControl:"="},template:e,controller:["$scope","$timeout","qhCardAnimation",function(t,e,n){t.steps=[];t.currentIndex=-1;t.isClosing=false;t.firstTime=true;t.cardControl.close=r;t.cardControl.init=function(e){t.stepList=e.cardSteps;t.customClass=e.customClass||"card-custom-default";t.onClose=e.onClose;a(t.stepList[0]);t.currentIndex=0};t.closeCard=function(){r()};t.loadCard=function(e){if(t.firstTime){n.setupAnimation(e.outer,true);i(e.outer,e.baseElem,true);t.firstTime=false}else{n.setupAnimation(e.inner,false);i(e.outer,e.baseElem,false)}};function i(t,i,a){e(function(){n.animate(t,1,a,i)},25)}function a(e){t.steps.push(l(e))}function s(){t.currentIndex>0&&e(function(){t.currentIndex--})}function r(){t.isClosing=true;t.onClose&&t.onClose();e(function(){t.destroyComponent()},500)}function o(){var n=t.currentIndex+1;if(n<t.stepList.length){n===t.steps.length&&a(t.stepList[n]);e(function(){t.currentIndex++})}}function l(t){t.input.close=r;t.input.next=o;t.input.back=s;var e={component:t.component,input:t.input};return e}}]};return n}.apply(e,i),void 0!==a&&(t.exports=a))},2312:function(t,e){t.exports='<div class="card-container" id="q-card-container" qv-id="card-modal">\n\t<div class="main-step-container-card {{::customClass}}" ng-repeat="step in steps" qh-card-steps>\n\t\t<div class="q-outer-card-box" qv-global-escape="step.input.close()" qva-outside="step.input.close()" id="qh-animation-frame">\n\t\t\t<qh-include-card-step class="q-include-card {{::step.input.cardClass}}" id="qh-inner-animation-frame" data-component="step.component" data-input="step.input"/>\n\t\t</div>\n\t</div>\n</div>'},2313:function(t,e,n){"use strict";var i,a;!(i=[n(48)],a=function(t){t.directive("qhCardSteps",["qhCardAnimation",function(t){return{restrict:"A",link:function e(n,i){var a=i.find("#qh-animation-frame"),s=i.find("#qh-inner-animation-frame");n.$watch("isClosing",function(e){e&&t.animate(a[0],0,true,i[0])});n.$watch("currentIndex",function(e,a){n.$index!==e&&n.$index!==a||t.setAnimationOnCard(n.$index,e,a,n.currentIndex,s[0],i[0])});function r(){a=null;s=null}n.loadCard({outer:a[0],inner:s[0],baseElem:i[0]});n.$on("$destroy",r)}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},2314:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(11)],a=function(t,e){function n(t,n){0!==n?e(t).addClass("start-card-animation"):e(t).addClass("finish-card-animation")}function i(t,n){if(0!==n){e(t).addClass("switch-card");e(t).removeClass("setup-inner-animation")}else{e(t).addClass("setup-inner-animation");e(t).removeClass("switch-card")}}var a={setupAnimation:function t(n,i){i?e(n).addClass("setup-animation"):e(n).addClass("setup-inner-animation")},animate:function t(e,a,s,r){s?n(e,a):i(e,a);r.style["z-index"]=a?200:100},setAnimationOnCard:function t(e,n,i,s,r,o){if(n===i||i<0)return;e===s?a.animate(r,1,false,o):a.animate(r,0,false,o)}};t.service("qhCardAnimation",[function(){return a}]);return a}.apply(e,i),void 0!==a&&(t.exports=a))},2315:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var i=x(n(98));var a=I(n(116));var s=I(n(997));var r=I(n(48));var o=I(n(91));var l=I(n(118));var c=I(n(322));var u=I(n(1316));var d=I(n(1433));var p=I(n(120));var h=I(n(94));var f=I(n(143));var g=n(1665);var v=I(n(1001));var m=I(n(1666));var b=I(n(1667));var y=I(n(411));var S=I(n(1668));function I(t){return t&&t.__esModule?t:{default:t}}function x(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,n):{};i.get||i.set?Object.defineProperty(e,n,i):e[n]=t[n]}e.default=t;return e}function q(){q=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};return q.apply(this,arguments)}function w(t){w="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return w(t)}function C(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function P(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,i.key,i)}}function E(t,e,n){e&&P(t.prototype,e);n&&P(t,n);return t}function k(t,e){if(e&&("object"===w(e)||"function"===typeof e))return e;return T(t)}function T(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function O(t){O=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return O(t)}function A(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});e&&$(t,e)}function $(t,e){$=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return $(t,e)}var D=function(t){A(e,t);function e(t){var n;C(this,e);n=k(this,O(e).call(this,t));n.state={userId:void 0,userDirectory:void 0,streams:[]};return n}E(e,[{key:"componentDidMount",value:function t(){var e=this;var n=this.props.app;n.getPublishableStreams().then(function(t){return e.setState({streams:t})});f.default.onDataReceived.then(function(t){var n=t.userId,i=t.userDirectory;"NONE"!==i&&e.setState({userId:n,userDirectory:i})})}},{key:"render",value:function t(){var e=this.props,n=e.app,a=e.appLayout,s=e.sheet,f=e.sheetLayout,m=e.closeMenu,b=e.disabled,y=e.features;var I=this.state,x=I.streams,q=I.userId,w=I.userDirectory;var C=[];var P=y.getFlag("AOSHARE");var E=f.permissions.publish&&f.qMeta&&!f.qMeta.published;if(E){var k=P?"GlobalMenu.SharedSpace.ApproveSheet":"GlobalMenu.PublishSheet";C.push(i.default.createElement(v.default,{key:P?"approve":"publish",tid:k,iconName:"publish",title:o.default.get(k),disabled:b,onSelect:function t(){d.default.openPublishDialog(h.default,x,n);m()}},o.default.get(k)))}var T=a.permissions.exportData&&!y.getFlag("DOWNLOAD_SHEET");T&&C.push(i.default.createElement(v.default,{key:"exportToPdf",tid:"GlobalMenu.ExportSheetToPdf",iconName:"print",title:o.default.get("GlobalMenu.ExportSheetToPdf"),disabled:b,onSelect:function t(){c.default.showForGlobalMenu(h.default,"Pdf","Sheet");m()}},o.default.get("GlobalMenu.ExportSheetToPdf")));var O=y.getFlag("DOWNLOAD_SHEET");O&&C.push(i.default.createElement(v.default,{key:"downloadToPdf",tid:"GlobalMenu.DownloadSheetToPdf",iconName:"download",title:o.default.get("GlobalMenu.DownloadSheetToPdf"),onSelect:function t(){u.default.showForGlobalMenu(h.default);m()}},o.default.get("GlobalMenu.DownloadSheetToPdf")));var A=a.permissions.createSheet;A&&C.push(i.default.createElement(v.default,{key:"duplicate",tid:"GlobalMenu.DuplicateSheet",iconName:"copy",title:o.default.get("GlobalMenu.DuplicateSheet"),disabled:b,onSelect:function t(){(0,S.default)(s,true);m()}},o.default.get("GlobalMenu.DuplicateSheet")));var $=a.published&&f.qMeta&&f.qMeta.published&&!f.qMeta.approved&&-1!==f.qMeta.privileges.indexOf("approve");$&&C.push(i.default.createElement(v.default,{key:"approve",tid:"GlobalMenu.ApproveSheet",iconName:"approve",title:o.default.get("GlobalMenu.ApproveSheet"),disabled:b,onSelect:function t(){s.approve();m()}},o.default.get("GlobalMenu.ApproveSheet")));var D=a.published&&f.qMeta&&f.qMeta.published&&f.qMeta.approved&&-1!==f.qMeta.privileges.indexOf("approve");D&&C.push(i.default.createElement(v.default,{key:"unapprove",tid:"GlobalMenu.UnapproveSheet",iconName:"unapprove",title:o.default.get("GlobalMenu.UnapproveSheet"),disabled:b,onSelect:function t(){s.unApprove();m()}},o.default.get("GlobalMenu.UnapproveSheet")));var _=f.permissions.publish&&f.qMeta.published&&!f.qMeta.approved&&f.qMeta.owner.userId===q&&f.qMeta.owner.userDirectory===w;if(_){var M=o.default.get(P?"GlobalMenu.SharedSpace.UnapproveSheet":"GlobalMenu.UnpublishSheet");C.push(i.default.createElement(v.default,{key:P?"unapprove":"unpublish",tid:M,iconName:"publish",title:o.default.get(M),disabled:b,onSelect:function t(){d.default.openUnpublishDialog(h.default,s);m()}},o.default.get(M)))}var N=f.qMeta&&!f.qMeta.published&&f.permissions.remove;if(N){var F=function t(e){if(l.default.startsWith(e,"<")&&l.default.endsWith(e,">"))return encodeURI(e);return e};C.push(i.default.createElement(v.default,{key:"delete",tid:"GlobalMenu.DeleteSheet",iconName:"bin",title:o.default.get("GlobalMenu.DeleteSheet"),disabled:b,onSelect:function t(){var e=f.qInfo.qId;var n=f.labelExpression||f.qMeta.title;var i=r.default.getService("qvConfirmDialog");i.show({title:o.default.get("AppOverView.Confirm.Title.Sheet"),message:o.default.get("AppOverView.Confirm.Description.Sheet",[F(n)]),cancelLabel:o.default.get("Common.Cancel"),okLabel:o.default.get("Common.Delete")}).closed.then(function(t){t&&p.default.remove(e)});m()}},o.default.get("GlobalMenu.DeleteSheet")))}var L=y.getFlag("SINGLE_CONFIG");L&&C.push(i.default.createElement(v.default,{key:"embed",tid:"i9fd7",title:o.default.get("GlobalMenu.EmbedSheet"),disabled:b,iconName:"code",onSelect:function t(){(0,g.openEmbedDialog)({type:"sheet",objectId:s.id});m()}},o.default.get("GlobalMenu.EmbedSheet")));return i.default.createElement(i.Fragment,null,C)}}]);return e}(i.Component);D.propTypes={app:a.default.object.isRequired,appLayout:a.default.object.isRequired,disabled:a.default.bool.isRequired,sheet:a.default.object.isRequired,sheetLayout:a.default.object.isRequired,closeMenu:a.default.func.isRequired,features:a.default.object.isRequired};var _=(0,y.default)((0,m.default)((0,b.default)(function(t){return i.default.createElement(s.default,null,function(e){return i.default.createElement(D,q({features:e},t))})})));e.default=_;t.exports=e.default},2316:function(t,e,n){"use strict";var i,a;!(i=[n(1315),n(128),n(49),n(90)],a=function(t,e,n,i){function a(t){return t.map(function(t){Number.isNaN(+t)||(t=+t);return"number"===typeof t?{qIsNumeric:true,qNumber:t}:"string"===typeof t?{qText:t}:t})}function s(s){if(!n.getFlag("CLOUD_SHARING_SERVICE"))return;var r=i.getParameterByName("insight");r&&t.getInsightDetails(r).then(function(t){var n=t.chartID;n&&e.highlightedCell(n);var i=t.selections;i&&s.clearAll().then(function(){i.forEach(function(t){s.getField(t.name).then(function(e){var n=a(t.values);e.selectValues(n,false,true)})})})})}return{applyLink:s}}.apply(e,i),void 0!==a&&(t.exports=a))},2317:function(t,e,n){},246:function(t,e,n){"use strict";var i,a;!(i=[n(92),n(90),n(405)],a=function(t,e,n){var i,a={3:"k",6:"M",9:"G",12:"T",15:"P",18:"E",21:"Z",24:"Y","-3":"m","-6":"μ","-9":"n","-12":"p","-15":"f","-18":"a","-21":"z","-24":"y"},s=/%$/,r=/^\(r(0[2-9]|[12]\d|3[0-6])\)/i,o=/^\(oct\)/i,l=/^\(dec\)/i,c=/^\(hex\)/i,u=/^\(bin\)/i,d=/^\(rom\)/i,p=/^(\(rom\)|\(bin\)|\(hex\)|\(dec\)|\(oct\)|\(r(0[2-9]|[12]\d|3[0-6])\))/i;function h(t,e,n,i){t=t.toString(e);n[1]===n[1].toUpperCase()&&(t=t.toUpperCase());t.length-t.indexOf(".")>10&&(t=t.slice(0,t.indexOf(".")+11));return t.replace(".",i||".")}function f(t,e,n){var i;if(r.test(e))t=h(t,Number(/\d{2}/.exec(e)[0]),e,n);else if(o.test(e))t=h(t,8,e,n);else if(l.test(e))t=h(t,10,e,n);else if(c.test(e))t=h(t,16,e,n);else if(u.test(e))t=h(t,2,e,n);else if(d.test(e)){i="";if(t<0){i="-";t=-t}t=Math.floor(t);if(0===t)t="0";else if(t<=5e5){t=g(t,e);t=i+t}else t=e+i+t.toExponential(0)}return t}function g(t,e){var n,i="",a=Number(String(t).slice(-3)),s=(t-a)/1e3,r=[0,1,4,5,9,10,40,50,90,100,400,500,900].reverse(),o=["0","I","IV","V","IX","X","XL","L","XC","C","CD","D","CM"].reverse();while(a>0)for(n=0;n<r.length;n++)if(r[n]<=a){i+=o[n];a-=r[n];break}for(n=0;n<s;n++)i="M"+i;e[1]!==e[1].toUpperCase()&&(i=i.toLowerCase());return i}function v(t){if(!t||!t.qNumericalAbbreviation)return a;var e={};var n=t.qNumericalAbbreviation.split(";");n.forEach(function(t){var n=t.split(":");2===n.length&&(e[n[0]]=n[1])});return e}i=t.extend("NumberFormatter",{init:function t(e,n,i,a,s){this.localeInfo=e;this.pattern=n;this.thousandDelimiter=i||",";this.decimalDelimiter=a||".";this.type=s||"numeric";this.abbreviations=v(e);this.prepare()},clone:function t(){var e=new i(this.localeInfo,this.pattern,this.thousandDelimiter,this.decimalDelimiter,this.type);e.subtype=this.subtype;return e},format:function t(e,n,i,a){this.prepare(n,i,a);return this.formatValue(e)},prepare:function t(e,n,i){var a,s;"undefined"===typeof e&&(e=this.pattern);"undefined"===typeof n&&(n=this.thousandDelimiter);"undefined"===typeof i&&(i=this.decimalDelimiter);if(!e){this._prepared={pattern:false};return}this._prepared={positive:{d:i,t:n,abbreviate:false,isFunctional:false,prefix:"",postfix:""},negative:{d:i,t:n,abbreviate:false,isFunctional:false,prefix:"",postfix:""}};a=this._prepared;e=e.split(";");a.positive.pattern=e[0];a.negative.pattern=e[1];p.test(e[0])&&(a.positive.isFunctional=true);e[1]?p.test(e[1])&&(a.negative.isFunctional=true):a.negative=false;s=a.positive.isFunctional&&(!a.negative||a.negative&&a.negative.isFunctional);if(!s){m(a.positive,n,i);a.negative&&m(a.negative,n,i)}},formatValue:function t(e){var i=this._prepared,a,s,r="",o,l,c="",u,d,p,h,g;if(Number.isNaN(+e))return e;if(false===i.pattern)return e.toString();if(e<0&&i.negative){i=i.negative;e=-e}else i=i.positive;u=i.d;d=i.t;if(i.isFunctional)e=f(e,i.pattern,u);else{i.percentage&&(e*=100);if(i.abbreviate){var v=this.abbreviations;var m=Object.keys(v).map(function(t){return parseInt(t)}).sort(function(t,e){return t>e?1:-1});var b;var y=m[0];p=0;s=Number(Number(e).toExponential().split("e")[1]);while(y<=s&&p<m.length){p++;y=m[p]}p>0&&(b=m[p-1]);var S;b&&s>0&&b>0?S=b:(s<0&&b<0||!b)&&(y<0&&y-s<=i.maxPrecision?S=y:b<=s&&!(y>0&&-s<=i.maxPrecision)&&(S=b));if(S){r=v[S];e/=Math.pow(10,S)}}o=Math.abs(e);a=i.temp;h=i.numericPattern;g=h.split(u)[1];"I"===this.type&&(e=Math.round(e));l=e;if(g||"#"!==h.slice(-1)[0])if(o>=1e15||o>0&&o<=1e-14)e=o?o.toExponential(15).replace(/\.?0+(?=e)/,""):"0";else{var I=Number(e.toFixed(Math.min(20,g?g.length:0)).split(".")[0]);var x=h.split(u)[0];x+=u;e=n(x,I)||"0";if(g){var q=Math.max(0,Math.min(14,g.length));var w=g.replace(/#+$/,"").length;var C=Number((o%1).toPrecision(q)).toFixed(q);C=C.slice(2).replace(/0+$/,"");for(p=C.length;p<w;p++)C+="0";C&&(e+=u+C)}else 0===I&&(l=0)}else if(o>=Math.pow(10,a)||o<1||o<1e-4)if(0===e)e="0";else if(o<1e-4||o>=1e20){e=l.toExponential(Math.max(1,Math.min(14,a))-1);e=e.replace(/\.?0+(?=e)/,"");c=""}else{e=e.toPrecision(Math.max(1,Math.min(14,a)));if(e.indexOf(".")>=0){e=e.replace(e.indexOf("e")<0?/0+$/:/\.?0+(?=e)/,"");e=e.replace(".",u)}}else{h+=u;a=Math.max(0,Math.min(20,a-Math.ceil(Math.log(o)/Math.log(10))));for(p=0;p<a;p++)h+="#";e=n(h,e)}e=e.replace(i.numericRegex,function(t){if(t===d)return i.groupTemp;if(t===u)return i.decTemp;return""});l<0&&!/^-/.test(e)&&(e="-"+e)}return i.prefix+e+c+r+i.postfix}});function m(t,e,n){var i,a,r=t.pattern,o,l,c,u,d,p,h;if(r.indexOf("A")>=0){r=r.replace("A","");t.abbreviate=true}h=y(e,n);o=r.match(h);o=o?o[0]:"";l=o?r.substr(0,r.indexOf(o)):r;c=o?r.substring(r.indexOf(o)+o.length):"";o||(o=r?"#":"##########");if(e&&e===n){i=o.split(n);a=i.pop();o=i.join("")+n+a;e=""}u=e;e=/,/.test(n)?"¤":",";u&&(o=o.replace(b(u,"g"),e));d=n;n=".";d&&(o=o.replace(b(d,"g"),n));p=o.match(/#/g);p=p?p.length:0;var f=r.split(d);var g;f[1]&&(g=f[1].match(/#|0/g));t.prefix=l||"";t.postfix=c||"";t.pattern=r;t.maxPrecision=g?g.length:2;t.percentage=s.test(r);t.numericPattern=o||"";t.numericRegex=new RegExp(b(e,null,true)+"|"+b(n,null,true),"g");t.groupTemp=u;t.decTemp=d;t.t=e;t.d=n;t.temp=p}function b(t,n,i){var a=e.escapeRegExp(t);if(i)return a;return new RegExp(a||"",n)}function y(t,n){n&&(n=e.escapeRegExp(n));t&&(t=e.escapeRegExp(t));return new RegExp("(?:[#0]+"+t+")?[#0]+(?:"+n+"[#0]+)?")}window.NumberFormatter=i;i.getStaticFormatter=function(){return{prepare:function t(){},formatValue:function t(e){return e+""}}};return i}.apply(e,i),void 0!==a&&(t.exports=a))},257:function(t,e,n){"use strict";var i,a;!(i=[n(10),n(48),n(871),n(94),n(102),n(169),n(176)],a=function(t,e,n,i,a){e.service("qvGlobalSearchService",["$document","qvSelectionToolbarService",function(e,s){var r,o={};function l(t){return o[u(t)]}function c(t,e){o[u(t)]=e}function u(t){if(t.id)return t.id.toUpperCase();return t.id}function d(t){return{$container:void 0,$containerId:".qv-global-search-container",$app:t,$lastKnownIndexProgress:void 0,$haveQuery:false,getComponent:function t(){return n},setup:function e(){i.StateChanged.bind(p.bind(null,t));t.isInModalSelection()&&s.confirm()},destroy:function t(){i.StateChanged.unbind(p)}}}function p(t){(i.isInEditMode()||!i.isInAnalysisMode||i.inObjectView())&&g(l(t))}function h(n,i,a){n.$container=t.element("<div>");i=i||e;i.find(n.$containerId).append(n.$container);n.$container.showComponent(n.getComponent(),["$scope",function(t){t.app=n.$app;t.options={objectSearchIsOn:a}}]);n.setup()}function f(t){return!(!t||void 0===t.$container)}function g(t){if(t.$container){t.$container.remove();t.$container=void 0}t.destroy()}function v(t){var e=l(t);if(!e){e=new d(t);c(t,e)}return e}function m(t,e){try{var n=e.qTransientProgressMessage.qMessageParameters[0],i=new Number(n),a=v(t);!Number.isNaN(+i)&&n&&(a.$lastKnownIndexProgress=i);r.IndexProgressUpdate.emit(u(t),i)}catch(t){return}}r={toggleGlobalSearch:function t(e,n,i){var a=v(e);f(a)?g(a):h(a,n,i)},openGlobalSearch:function t(e,n){var i=v(e);if(!f(i)){g(i);h(i,n)}},closeGlobalSearchIfNoQuery:function t(e){var n=l(e);n&&n.$haveQuery||this.off()},off:function t(){Object.keys(o).forEach(function(t){g(o[t])})},isSearchOpen:function t(e){return f(l(e))},setLastKnownIndexProgress:function t(e,n){var i=l(e)||{};i.$lastKnownIndexProgress=n},getLastKnownIndexProgress:function t(e){var n=l(e)||{};return n.$lastKnownIndexProgress},couldEngineBeIndexing:function t(e){var n=l(e)||{},i=n.$lastKnownIndexProgress;return void 0!==i&&i<100},requestIndexProgressUpdate:function t(e){e.global.getProgress(0).then(m.bind(null,e))},setHaveQuery:function t(e,n){var i=v(e);i.$haveQuery=n}};a.mixin(r);r.notification("IndexProgressUpdate");return r}])}.apply(e,i),void 0!==a&&(t.exports=a))},273:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){return{DEFAULT_STATE_TRANSLATION:"AlternateState.DefaultState",DEFAULT_STATE_NAME:"$"}}.apply(e,i),void 0!==a&&(t.exports=a))},274:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(97),n(99),n(854)],a=function(t,e,n){t.directive("qvPager",["$timeout",function(t){return{restrict:"A",priority:0,link:function i(a,s){n.treatAsDesktop()||s.css("overflow-x","auto");a.pagerData=s.find("ul").pager().data("qv-pager");s.addClass("qv-pager");a.nextPage=function(){t(function(){a.pagerData.goToNextPage();a.refreshPager(true)})};a.prevPage=function(){t(function(){a.pagerData.goToPreviousPage();a.refreshPager(true)})};a.goToPage=function(t){a.pagerData.goToPage(t);a.refreshPager(true)};a.refreshPager=function(t){var e="";t||a.pagerData.refresh();s.removeClass("qv-pager-back qv-pager-forward");if(1!==a.pagerData.currentPage){a.showShadow=true;e+="qv-pager-back "}else a.showShadow=false;a.pagerData.currentPage!==a.pagerData.maxPages&&(e+="qv-pager-forward ");s.addClass(e)};function r(){a.refreshPager()}a.$on("refreshPager",r);a.$on("$destroy",function(){e.off("end",r)})}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},275:function(t,e,n){"use strict";var i,a;!(i=[n(54),n(91),n(48),n(89),n(105),n(147),n(154),n(134),n(112),n(233),n(366)],a=function(t,e,n,i,a,s,r,o,l){n.service("qvCaoSearchService",["qvCaoSelectionService",function(n){var c;function u(){c=this;this.fieldList=[];this.queryString=[];this.queryTokens=[];this.caoSearchQueryHandlers=[]}u.prototype.createFieldList=function(){var t=[];return r.getList().then(function(t){return t.getLayout()}).then(function(e){t=t.concat(e);return c.getMasterItems()}).then(function(e){t=t.concat(e);c.fieldList=c.sortFields(t);return c.fieldList})};u.prototype.getFields=function(){return this.fieldList};u.prototype.getSelectedFields=function(t){return this.getFields().filter(function(t){return t.selected}).filter(function(e){var n=t.indexOf(e.qName);return n>-1})};u.prototype.syncFieldsInQueryWithFieldPicker=function(e){var n=this.getSelectedFields(e);this.fieldList=this.fieldList.map(function(e){var i=t.find(n,function(t){return t.caoFieldId===e.caoFieldId});e.selected=!!i;return e})};u.prototype.getMeasureMasterItems=function(){var t=this;return s.getList().then(function(e){return e.getLayout().then(function(e){t.measureMasterItems=e.map(function(t){return{qName:t.qData.title,classifications:["measure"],masterItem:true,libId:t.qInfo.qId,libIdLabel:t.qMeta.title}});return t.measureMasterItems})})};u.prototype.getDimensionMasterItems=function(){var t=this;return o.getList().then(function(e){return e.getLayout().then(function(e){t.dimensionMasterItems=e.map(function(t){return{qName:t.qData.title,classifications:["dimension"],masterItem:true,libId:t.qInfo.qId,libIdLabel:t.qMeta.title}});return t.dimensionMasterItems})})};u.prototype.getMasterItems=function(){var t=[];return i.all({measureItems:this.getMeasureMasterItems(),dimItems:this.getDimensionMasterItems()}).then(function(e){t=e.measureItems.concat(e.dimItems);return t})};u.prototype.sortFields=function(t){t=t.map(function(t){var n="cao_field_"+t.qName;n=n.split(" ").join("_");t.masterItem||(1===t.qSrcTables.length?t.tablesAssociated=t.qSrcTables[0]+" "+e.get("cao.search.field.table"):t.tablesAssociated=e.get("cao.search.field.table.title",t.qSrcTables.length));t.qSrcTables&&(t.tablesTooltip=t.qSrcTables.join(", "));t.name=t.qName;t.caoFieldId=t.masterItem?n+"masterItem_"+t.classifications[0]:n;t.highlight=false;t.classificationIcon=c.getFieldClassificationIcon(t);t.displayNameTokens=[{text:t.qName,matching:false}];if(t.classifications&&t.classifications.length>0){t.masterItemDimension="dimension"===t.classifications[0]&&t.masterItem;t.masterItemMeasures="measure"===t.classifications[0]&&t.masterItem}t.masterItem&&(t.masterItemTitle=t.masterItemDimension?e.get("cao.fieldPicker.masterItem.dimension"):e.get("cao.fieldPicker.masterItem.measure"));return t});return l.localeOrderBy(t,function(t){return t.qName})};u.prototype.getFieldClassificationIcon=function(e){var n;var i=t.find(e.qTags,function(t){return"$date"===t});var a=t.find(e.qTags,function(t){return"$geoname"===t});i?n="lui-icon--calendar":a&&(n="lui-icon--map");return n};u.prototype.indexesOfWordInString=function(t,e){t=t.toLowerCase();e=e.toLowerCase();var n=[];var i=t.indexOf(e);i>-1&&n.push(i);while(i>-1){i=t.indexOf(e,++i);i>-1&&n.push(i)}return n};u.prototype.getQueryTokensBasedOnQuotes=function(t){var e=[];if(t&&t.length>0){var n=t.split(" ");var i=0;var a=null;var s=null;var r=null;var o=false;n.forEach(function(l,u){a='"'===l.charAt(0);s='"'===l.charAt(l.length-1);u<n.length-1&&(r='"'===n[u+1].charAt(0));if(a){i=u;o=true;if(1===n.length&&a){l=l.substr(1);e.push(c.createToken(l,e,t,false));o=false}else if(u===n.length-1&&n.length>1){l=n.slice(i,u+1).join(" ").substr(1);e.push(c.createToken(l,e,t,false));o=false}if(o&&r&&!s){l=n.slice(i,u+1).join(" ").substr(1);e.push(c.createToken(l,e,t,false));o=false}}else if(o&&r&&!s){l=n.slice(i,u+1).join(" ").substr(1);e.push(c.createToken(l,e,t,false));o=false}else if(s){l=n.slice(i,u+1).join(" ");e.push(c.createToken(l,e,t,true));o=false}else if(o&&u===n.length-1){l=n.slice(i,u+1).join(" ").substr(1);e.push(c.createToken(l,e,t,false));o=false}else o||e.push(c.createToken(l,e,t,false))})}this.queryTokens=e;return this.queryTokens};u.prototype.createToken=function(t,e,n,i){var a;var s=t.length;if(e&&e.length>0){var r=e[e.length-1];a=n.indexOf(t,r.indexEnd)}else a=n.indexOf(t);""===t&&(s=1);return{word:i?t.substr(1).slice(0,-1):t,indexStart:""===t?a+1:a,indexEnd:a+s}};u.prototype.addStringToQueryAtIndex=function(t,e,n){var i="";if(e&&e.length>0){var a=e;var s=e.slice(0,n).trim();var r=a.slice(n).trim();i=s+t+r}return i};u.prototype.getCurrentToken=function(t,e){var n={index:null,token:null};var i=this.getQueryTokensBasedOnQuotes(t);i.some(function(t,i){if(e>=t.indexStart&&e<=t.indexEnd){n.index=i;n.token=t;return e>=t.indexStart&&e<=t.indexEnd}});return n};u.prototype.replaceTwoOrMoreSpacesWithOne=function(t){return t.replace(/\s\s+/g," ")};u.prototype.removeFieldFromQuery=function(t,e,n){var i=this.indexesOfWordInString(e,t.qName);if(i.length>1){n=n.filter(function(e){return e.caoFieldId!==t.caoFieldId}).map(function(t){t.indexStartOfFieldInQuery=e.indexOf(t.qName);t.indexEndOfFieldInQuery=e.indexOf(t.qName)+t.qName.length;return t});var a=-1;i.forEach(function(i){n.forEach(function(n){a=i!==n.indexStartOfFieldInQuery?i:e.indexOf(t.qName)})});if(-1===a)e=e.replace(t.qName,"");else{var s=e.split("");s.splice(a,t.qName.length);e=s.join("")}}else e=e.replace(t.qName,"");return e.replace(/^\s+/g,"")};u.prototype.addFieldToQuery=function(t,e,n,i,a){e=e||"";var s=t.qName.match(" ")||t.qName.match(String.fromCharCode(160));var r=s?'"'+t.qName+'"':t.qName;var o=this.getQueryTokensBasedOnQuotes(e);var l=0;var c=a-i>0;if(c){var u=e.split("");u.splice(i,a-i,r);e=u.join("");l=i+r.length+1}else if(""===e){e=r;l=n+r.length+1}else if(o.length>0&&t){var d=this.getCurrentToken(e,n);if(null!==d.index){o[d.index]={word:t.qName};e=o.map(function(t,e){if(e===d.index&&e<o.length-1&&o[e+1].word)return t.word.match(" ")?'"'+t.word+'" ':t.word+" ";return t.word.match(" ")?'"'+t.word+'"':t.word}).join(" ");l=d.token.indexStart+r.length+1}else{var p=" "+r;e=this.addStringToQueryAtIndex(p,e,n);l=n+r.length+1}}e=e.replace(/^\s+/g,"");return{query:e,cursorPosition:l}};u.prototype.searchResultPositionRelativeToQuery=function(t,e){var n=7.5;var i=.7;var a=0;if(t&&t.length>0){var s=t.slice(0,e).split("");var r=s.filter(function(t){return" "!==t});var o=s.filter(function(t){return" "===t});a+=r.length*n;a+=o.length*i}return a};u.prototype.registerForCaoSearchQuery=function(t){this.caoSearchQueryHandlers.push(t)};u.prototype.unRegisterFromCaoSearchQuery=function(){this.caoSearchQueryHandlers=[]};u.prototype.getMatchingFields=function(e,n){var i=[];var a=this.fieldList;var s;e?e=e?e.toLowerCase():"":e&&""!==e||(s=true);i=a.filter(function(t){var i=t.qName.toLowerCase();if(s||i.indexOf(e)>-1)return!n||n&&t.masterItem;return false});i=t.uniq(i).filter(function(t){return l.librarySearchFn(t,e)});return l.localeOrderBy(i,function(t){return t.qName})};u.prototype.clearSelectedFields=function(){this.fieldList.forEach(function(t){t.selected=false});n.clearSelection()};u.prototype.selectField=function(t,e){this.fieldList=this.fieldList.map(function(n){n.caoFieldId===t.caoFieldId&&(n.selected=e);return n})};u.prototype.updateInsights=function(t){this.caoSearchQueryHandlers.forEach(function(e){e&&e({query:t,fields:c.getFields().filter(function(t){return t.selected})})});n.clearSelection()};u.prototype.showIntro=function(t){this.caoSearchQueryHandlers.forEach(function(e){e&&e({showIntro:t})})};u.prototype.matchingField=function(t,e,n){var i=e>0&&e<=n.length-1;var s=e>=-1&&e<n.length-1;switch(t){case a.KeyCodes.Up:i&&e--;break;case a.KeyCodes.Down:s&&e++;break;case a.KeyCodes.Tab:break}return n[e]};return new u}])}.apply(e,i),void 0!==a&&(t.exports=a))},276:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(907)],a=function(t,e){t.directive("qvProgressBar",["$interval",function(t){return{replace:true,template:e,restrict:"E",scope:{percentDone:"=",onCompleted:"&",options:"="},link:function e(n){var i,a=true;n.display="0%";n.showPercent=0;function s(){if(n.showPercent>=100){t.cancel(i);n.onCompleted();return}if(n.showPercent>=n.percentDone){t.cancel(i);return}r(n.showPercent+1)}n.$watch("percentDone",function(e){if(void 0!==e)if(a){r(e);a=false}else{t.cancel(i);i=t(s,10)}});function r(t){n.showPercent=t;n.display=t+"%"}n.$on("$destroy",function(){t.cancel(i)})}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},277:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(968)],a=function(t,e){var n={bindings:{currentSelectionDisabled:"<"},template:e};t.directive("qvCurrentSelectionsItem",function(){return n});return n}.apply(e,i),void 0!==a&&(t.exports=a))},284:function(t,e,n){"use strict";var i,a;!(i=[n(94),n(158),n(334),n(239),n(848),n(849),n(341),n(335),n(427),n(320),n(360),n(361),n(245),n(306),n(508),n(428)],a=function(t,e,n,i,a,s,r,o){var l=e.inClient(),c,u;var d=new o;d.scope="root";if(!l){t.setState(t.States.analysis);t.setView(t.Views.sheet)}if(p()){document.body.classList.add("absolute-position-mashup");document.documentElement.classList.add("absolute-position-mashup")}c=new a(l);u=new r;s.init();function p(){var t=Array.prototype.slice.call(document.querySelectorAll("body > .qvobject, body > .qvplaceholder"));if(0===t.length)return false;return!t.some(function(t){return"absolute"!==t.style.position})}function h(t,e){i.setErrorCallback(t,e);n.setErrorCallback(t,e)}function f(t,e){d.register({scope:"root",name:t,callback:e})}function g(t){d.clear(t)}var v={openApp:i.openApp.bind({_qEvent:d}),currApp:i.currApp,getGlobal:n.get.bind({_qEvent:d}),setOnError:h,on:f,off:g,setLanguage:e.setLanguage,setDeviceType:e.setDeviceType,table:i.table,getAppList:n.getAppList,resize:e.resize,getExtensionList:e.getExtensionList,callRepository:e.callRepository,registerExtension:e.registerExtension,navigation:c,sessionApp:i.sessionApp,sessionAppFromApp:i.sessionAppFromApp,getThemeList:r.getThemeList,theme:u};Object.defineProperty(v,"Promise",{get:function t(){return e.Promise}});return v}.apply(e,i),void 0!==a&&(t.exports=a))},290:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(90),n(89),n(141),n(283),n(364),n(50),n(365),n(245)],a=function(t,e,n,i,a,s,r,o){t.service("qvListboxPopoverService",["luiPopover",function(t){var l;var c;var u={showDelayed:function i(u,d,p,h){var f=n();if(l){c.selectionsActivated=function(){};c.selectionsDeactivated=function(){};l.close()}c={getVisualization:function t(){return f.promise},onPopoverClose:this.onPopoverClose,options:{setController:f.resolve,isPopover:true,showLock:d.showLock,search:d.search||{},smallDevice:r.isSmallDevice,direction:d.direction},selectionToolbarComponent:a,onClose:s};l=t.show({template:o,controller:s.controller,alignTo:d.$alignToElement[0],input:c,closeOnResize:false,dock:"top"});u.then(function(t){c.model=t}).catch(function(t){false});c.selectionsActivated=function(){e.isFunction(h)&&h()};c.selectionsDeactivated=function(){e.isFunction(p)&&p();p=null;h=null};return l},show:function t(e,i,a,s){return this.showDelayed(n.when(e),i,a,s)},showField:function t(e,a,s,r,o,l){return i.createTransientField(a,e,r).then(function(t){return n.resolve(this.show(t,s,o,l))}.bind(this)).catch(function(t){false})},showDimension:function t(e,n,a,s,r,o){i.createTransientDimension(n,e,s).then(function(t){this.show(t,a,r,o)}.bind(this)).catch(function(t){false})},close:function t(){l&&l.close();l=null},onPopoverClose:function t(){},getPopover:function t(){return l},onClosing:function t(){}};return u}])}.apply(e,i),void 0!==a&&(t.exports=a))},306:function(t,e,n){"use strict";var i,a;function s(t){s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return s(t)}!(i=[n(10),n(48),n(96),n(850),n(851),n(132),n(106),n(97),n(50),n(94),n(202),n(90),n(114),n(113),n(852),n(853),n(363),n(273),n(142),n(95),n(105),n(89),n(167),n(103),n(290),n(274),n(175),n(855),n(257),n(212),n(392),n(240),n(271),n(289),n(276),n(965),n(277)],a=function(t,e,n,i,a,r,o,l,c,u,d,p,h,f,g,v,m,b,y,S,I,x,q,w){var C=b.DEFAULT_STATE_TRANSLATION;var P=b.DEFAULT_STATE_NAME;e.directive("qvSelectionPager",["qvGlobalSelectionsService","$timeout",function(t,n){var i=e.getService("$templateCache");i.put("current-selections-tooltip-template.ng.html",a);return{restrict:"A",priority:1,link:function e(i){var a=i.$watch(function(){return t.isSelectActive(i.app)},function(t){i.$emit("globalSelectionActive",t);n(function(){i.refreshPager(false)})});function s(){i.refreshPager(false)}l.on("end",s);i.$on("$destroy",function(){a();l.off("end",s)})}}}]);var E={template:i,replace:true,restrict:"E",scope:{app:"=",options:"=",expandSmartSearchSuggestedChart:"=?"},link:function t(n,i){var a=e.getService("$timeout"),s=e.getService("qvGlobalSelectionsService"),l=e.getService("qvExploreSelectionsService"),p=e.getService("qvGlobalSearchService"),h=e.getService("qvCaoService"),b=i.parent(),y,x,q;var E=new v(n,c,s,l,p,h);q=new g(n);n.isCaoActive=d.isInInsightMode();n.isExploreSelectionsActive=false;n.nbrSelection=0;n.haveHiddenSelections=false;n.isSmallDevice=c.isSmallDevice;n.cachedPlaceHolders=[];n.isGlobalSearchIndexing=false;n.progressBarOptions={hideText:true};n.setSearchIndexingDone=function(){n.isGlobalSearchIndexing=false};function k(t,e){if(t!==(n.app.enigmaModel.id||"").toUpperCase())return;var i=new Number(e);if(!n.isGlobalSearchIndexing&&i<100){n.indexPercentDone=i;n.isGlobalSearchIndexing=true;O(500)}else if(n.isGlobalSearchIndexing){n.indexPercentDone=i;i<100&&O(500)}else T()}function T(){a.cancel(x);if(y){p.IndexProgressUpdate.unbind(k);y=false}}function O(t){if(!y){p.IndexProgressUpdate.bind(k);y=true}a.cancel(x);x=a(function(){p.requestIndexProgressUpdate(n.app.enigmaModel)},t||0)}function A(){a(function(){n.isSmallDevice=c.isSmallDevice;if(f["SMARTSEARCH_INDEX_CLOSE"])if(n.isSmallDevice){T();n.setSearchIndexingDone()}else!p.isSearchOpen(n.app.enigmaModel)&&p.couldEngineBeIndexing(n.app.enigmaModel)&&O(0);n.isSmallDevice&&n.isCaoActive&&(n.isCaoActive=false)})}function $(){if(!q)return;u.isInAnalysisMode()?q.on():q.off()}function D(){u.inSheetView()&&c.isSmallDevice&&p.openGlobalSearch(n.app.enigmaModel,b);$();var t=d.isInInsightMode();t?t&&!n.isCaoActive&&(n.isCaoActive=true):n.isCaoActive=false}$();c.ViewChanged.bind(A);n.$watch("isSmallDevice",function(t){true!==t||u.inObjectView()?p.closeGlobalSearchIfNoQuery(n.app.enigmaModel):p.openGlobalSearch(n.app.enigmaModel,b)});u.StateChanged.bind(D);n.mobileIndicatorTop=false;n.mobileIndicatorShow=false;s.setCsShowCallback(function(t){n.mobileIndicatorShow=t});s.onClose(function(){document.activeElement!==i.find('[tid="toggleCaoButton"]')[0]&&document.activeElement!==i.find('[tid="currentSelections.toggleExploreSelection"]')[0]&&i.find('[tid="currentSelections.toggleGlobalSelections"]').focus()});n.$on("globalSelectionActive",function(t,e){n.isGlobalSelectionsActive=e});n.$on("exploreSelectionActive",function(t,e){n.isExploreSelectionsActive=e});function _(t){r.get(t).then(function(t){n.model=t;o(n,"app",F)}).catch(function(t){false});n.$watch(t.isInModalSelection.bind(t),function(t){n.inSelection=t;if(n.inSelection&&n.activeFieldName&&n.activeFieldName.length>0)n.cachedPlaceHolders=n.items.map(function(t){return m.createPlaceHolder({},t.qField,t.qReadableName||t.qField)});else{n.cachedPlaceHolders=[];n.items=n.items.filter(function(t){return!t.isPlaceHolder})}});n.app=t;o(n,"app",F)}var M=[];var N;function F(t){var e=false;var i;if(M.length!==t.qStateNames.length||!M.every(function(e,n){return e===t.qStateNames[n]})){i=[C].concat(t.qStateNames);e=true;M=t.qStateNames.concat()}if(n.model&&(!N||e)){i=[P].concat(t.qStateNames);n.model.getProperties().then(function(t){t.selectionsInStates=i.map(function(t){return{stateName:t,qSelectionObjectDef:{qStateName:t}}});n.model.setProperties(t)})}N=n.model}var L=n.$watch("app",function(t){_(t.enigmaModel);L()});n.$watch(function(){return p.isSearchOpen(n.app.enigmaModel)},function(t){n.isGlobalSearchActive=t;if(f["SMARTSEARCH_INDEX_CLOSE"])if(n.isSmallDevice||t){T();n.isGlobalSearchIndexing=false}else if(p.couldEngineBeIndexing(n.app.enigmaModel)){var e=p.getLastKnownIndexProgress(n.app.enigmaModel);n.isGlobalSearchIndexing=true;n.indexPercentDone=e;O(500)}});n.toggleGlobalSelection=function(t){t.preventDefault();E.toggleGlobalSelection(n.app);n.currentSelectionDisabled=false;n.expandSmartSearchSuggestedChart=false;S.publish(I.Events.PubSub.ExpandSmartSearchSuggestedChart,null);w.trackEvent(w.customEvents.GLOBAL_SELECTIONS_CLICKED,{type:"clicked"})};n.toggleGlobalSearch=function(){E.toggleGlobalSearch(b)};n.toggleExploreSelection=function(){E.toggleExploreSelection(b);n.expandSmartSearchSuggestedChart=false;S.publish(I.Events.PubSub.ExpandSmartSearchSuggestedChart,null);n.currentSelectionDisabled=false};n.toggleCao=function(){n.currentSelectionDisabled=false;E.toggleCao(b)};n.$watch("isCaoActive",function(t){false===t&&h.off()});n.$on("$destroy",function(){c.ViewChanged.unbind(A);p.off();h.off();n.isCaoActive=false;s.off();l.off();n.isExploreSelectionsActive=false;u.StateChanged.unbind(D);s.setCsShowCallback(null);a.cancel(x);p.IndexProgressUpdate.unbind(k);q&&q.delete()})},controller:["$scope","$element","$timeout","qvChartTooltipService","qvGlobalSelectionsService","qvCurrentSelectionsService",function(i,a,r,l,d,f){var g,v=false,b,I,w=e.getService("qvListboxPopoverService"),C=e.getService("qvListboxPopoverServiceMobile"),P=e.getService("qvMultiStatePopoverService");i.items=[];i.disable={clear:true,back:true,forward:true};i.brightCurSel=i.options&&"bright"===i.options.variant;i.hideUndoRedo=i.options&&true===i.options.hideUndoRedo;i.hideSelectionsTool=i.options&&true===i.options.hideSelectionsTool;i.hideSearch=i.options&&true===i.options.hideSearch;i.hideClearSelections=i.options&&true===i.options.hideClearSelections;i.currentSelectionDisabled=false;function E(){d.setCsShow(c.isSmallDevice&&i.items.length>0&&u.view!==u.Views.object)}function k(e){i.currentSelectionDisabled=false;i.disable.clear=0===y.getClearableStates(e.selectionsInStates).length;i.disable.back=0===e.qSelectionObject.qBackCount;i.disable.forward=0===e.qSelectionObject.qForwardCount;var n=m.getAllSelectionsInStates(e);i.haveHiddenSelections=n.some(function(t){return t.qIsHidden});var a=n.filter(function(t){return!t.qIsHidden});a.forEach(function(t){t.translation=f.translate(t);t.screenReaderLabel=f.translatedScreenReaderLabel(t);t.name=t.qReadableName||t.qField;t.displayStateName=m.getDisplayStateName(t.stateName);t.currentSelectionDisabled=i.currentSelectionDisabled});i.nbrSelections=a.length;d.setSelectionCount(a.length,i.app);E();var s=m.groupSelectionsByField(a);var o=s.filter(function(t){return!t.isSingleState});o.forEach(function(t){t.translation=f.translate(t);t.screenReaderLabel=f.translatedScreenReaderLabel(t)});s=s.sort(y.sortSelections);if(i.cachedPlaceHolders.length>0&&i.activeFieldName&&i.activeFieldName.length>0){i.cachedPlaceHolders.forEach(function(t){m.createPlaceHolder(t)});a.forEach(function(t){i.cachedPlaceHolders.forEach(function(e,n){t.qField===e.qField&&(i.cachedPlaceHolders[n]=p.extend(true,{},t))})});a=i.cachedPlaceHolders}if(i.multiPopover){var l=m.getIndexByKey(s,"name",i.multiPopover.fieldName);var c=m.getIndexByKey(i.items,"name",i.multiPopover.fieldName);var u=l>-1;if(u){var h=s.splice(l,1)[0];s.splice(c,0,h);var g=m.getAllStatesFromSelections(s,i.multiPopover.fieldName);if(g.length<=1&&i.activeFieldName.length){t.element('.item[data-csid="'+i.activeFieldName+'"]').focus();i.multiPopover.close()}}else i.multiPopover.close()}i.items=s;E();r(function(){i.$broadcast("refreshPager")})}o(i,"model",function(){I&&I.dispose();I=i.model.layoutSubscribe(k)});i.$watch(u.inObjectView,E);i.$watch("isSmallDevice",E);i.clear=function(t,e,n){var a=e?[e]:m.getAllStatesFromSelections(i.items);i.$parent.itemSelected&&(i.$parent.itemSelected=false);n&&n.stopPropagation();var s=a.map(function(e){return i.model.clearField(t,e)});return x.all(s)};i.clearAllFields=function(){return i.model.clearAll()};i.back=function(){return i.model.back()};i.forward=function(){return i.model.forward()};function T(e){var n=t.element(e).next("li");if(t.element(e).parent().find("li").length<=1)return null;return t.element(e).parent().find("li").length>1&&n.length>0?n:null}function O(e){var n=t.element(e).prev("li");if(t.element(e).parent().find("li").length<=1)return null;return n.length>0?n:null}function A(e,n){var a;var s=e.which;s=e.shiftKey&&q.TAB===s?"SHIFT_TAB":s;var o=document.activeElement&&"qv-multi-state-popover-btn-clear"===t.element(document.activeElement).attr("tid");var l=".item-multi-state[data-csid="+i.multiPopover.fieldName+"]";switch(s){case q.ESCAPE:i.multiPopover.close();a=t.element(l);break;case q.DELETE:a=T(e.target)||O(e.target);i.clear(n.qField,n.stateName);break;case q.SPACE:case q.ENTER:r(function(){e.target.click()});break;case q.ARROW_RIGHT:case q.ARROW_DOWN:case q.TAB:if(o)a=t.element('[tid="qv-multi-state-popover"] li.item:first');else{a=T(e.target);if(null===a&&s===q.TAB){i.multiPopover.close();a=t.element(l)}}break;case q.ARROW_LEFT:case q.ARROW_UP:case"SHIFT_TAB":if(o){a=t.element(l);i.multiPopover.close()}else a=O(e.target);break}if(a){a.focus();e.preventDefault()}}i.showPopover=function(e){var n=t.element(e.target).closest(".item"),a=n.scope().item.qField,s=n.scope().item.isPlaceHolder,o={qvaOutsideIgnoreFor:"currentSelectionsItems",$alignToElement:n,showLock:true,direction:h.direction};if(i.isClearSelectionIcon(e.target)){if(i.activeFieldName){c.isSmallDevice?w.close():C.close();i.activeFieldName=""}return}if(!n.hasClass("item-multi-state")&&(a===i.activeFieldName||s)){c.isSmallDevice?w.close():C.close();i.activeFieldName="";return}r(function(){i.closeTooltip()},100);i.activeFieldName=a;var l={listboxPopoverService:w,listboxPopoverServiceMobile:C,$timeout:r};var u=m.getAllStatesFromSelections(i.items,a);if(u.length>1){if(i.multiPopover)return;var d=function t(){return m.getMultiPopoverItems(i.items,a)};i.multiPopover=m.openMultiStatePopover(P,d,n[0],i.brightCurSel,{onClose:function t(){i.multiPopover=null;i.activeFieldName=""},clear:i.clear,click:function e(n){var a=t.element(n.target).closest(".item");var s=a.scope().item.qField;var r=a.scope().item.displayStateName;i.multiPopover.close();i.closeTooltip();i.onCloseFocusSelector='.item[data-csid="'+s+'"]';m.openListboxPopover(m.activatePopover,i,c.isSmallDevice,r,s,o,l)},openTooltip:i.openTooltip,closeTooltip:i.closeTooltip,direction:h.direction,handleKeyDown:A});i.multiPopover.fieldName=a}else m.openListboxPopover(m.activatePopover,i,c.isSmallDevice,u[0],a,o,l)};i.openTooltip=function(t,e){if(i.isClearSelectionIcon(t.target)){i.closeTooltip();return}if(v||n.utils.touch)return;var a=i.multiPopover&&i.multiPopover.fieldName===e.qField;if(e.states&&a)return;i.cancelTooltip();g=r(function(){var n=e.qStateCounts,i="object"===s(n),r=i?" ("+(n.qSelected+n.qSelectedExcluded+n.qLocked+n.qLockedExcluded)+"/"+e.qTotal+")":"";var o=e.states||!a&&"$"===e.stateName?e.translation:[m.getDisplayStateName(e.stateName),": ",e.translation].join("");v=true;l.open({content:[{header:(e.qReadableName||e.qField)+r,rows:[{content:o}]}],position:{x:t.clientX,y:t.clientY},alwaysOnTop:true,direction:"bottom",template:"current-selections-tooltip-template.ng.html"})},500)};i.closeTooltip=function(){v=false;i.cancelTooltip();l.close()};i.cancelTooltip=function(){r.cancel(g)};i.isClearSelectionIcon=function(e){return t.element(e).closest(".remove").is(".remove")};i.handleKeyDown=function(e,n){var s;var r=e.which;r=e.shiftKey&&q.TAB===r?"SHIFT_TAB":r;switch(e.which){case q.DELETE:s=i.items&&i.items.length>1?T(e.target):a.find('[data-tid="current-selections-back"]');i.clear(n.qField);break;case q.ESCAPE:if(i.multiPopover){i.multiPopover.close();s=t.element('.item[data-csid="'+i.multiPopover.fieldName+'"]')}break}if(n.isSingleState)switch(e.which){case q.SPACE:case q.ENTER:case q.ARROW_DOWN:i.showPopover(e);break}else switch(r){case q.SPACE:case q.ENTER:i.multiPopover?i.multiPopover.close():i.showPopover(e);s=t.element('.item[data-csid="'+i.multiPopover.fieldName+'"]');break;case q.ARROW_DOWN:i.multiPopover||i.showPopover(e);s=t.element('.item[data-csid="'+i.multiPopover.fieldName+'"]');break;case q.TAB:if(i.multiPopover){s=t.element('[tid="qv-multi-state-popover-btn-clear"]');e.preventDefault()}break;case"SHIFT_TAB":i.multiPopover&&i.multiPopover.close();break}s&&s.focus()};function $(t,n){i.items.forEach(function(t){if(-1!==n[0].indexOf(t.qField)){n[1]?t.feedbackActive=false:t.feedbackActive=true;e.$apply(i)}})}b=e.$rootScope.$on("locked-feedback",$);var D=function t(){var n=e.getService("qvExploreSelectionsService");n.off();i.isExploreSelectionsActive=false;i.currentSelectionDisabled=false};S.subscribe("selection/insights/close",D);S.subscribe("cao/insights/close",function(){i.isCaoActive=false});S.subscribe("selections/insights/details/close",function(){i.currentSelectionDisabled=false});S.subscribe("selections/insights/details/open",function(){i.currentSelectionDisabled=true});i.$on("$destroy",function(){b();I&&I.dispose();S.unsubscribe("cao/insights/close");S.unsubscribe("selection/insights/close",D);S.unsubscribe("selections/insights/details/close");S.unsubscribe("selections/insights/details/open")})}]};e.directive("qvStageCurrentSelections",function(){return E});return E}.apply(e,i),void 0!==a&&(t.exports=a))},323:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(54),n(89),n(91),n(133),n(975),n(280)],a=function(t,e,i,a,s){t.service("odagNavpointService",["$timeout","$delayedModal","odagNavpointServiceUI",function(t,r,o){var l;var c={};var u={SUCCEEDED:"succeeded",FAILED:"failed",VALIDATING:"validating",QUEUED:"queued",LOADING:"loading",CANCELING:"canceling",CANCELED:"canceled"};var d=[u.SUCCEEDED,u.FAILED,u.CANCELED];function p(t,e){o.updateImageOnItemHeader(e);return t.getLoadedLinkInfo(t).then(function(t){if(t.templateApp){e.templateName=t.templateApp.name;e.templateDescription=t.templateApp.description;if(t.templateApp.thumbnail){"/"===t.templateApp.thumbnail.substr(0,1)&&(t.templateApp.thumbnail=t.templateApp.thumbnail.substr(1));e.templateThumbnail=n.p+t.templateApp.thumbnail}o.updateImageOnItemHeader(e)}else{e.invalid=true;e.templateName=a.get("odag.toolbar.navpoint.popup.noTemplate");e.templateDescription=""}})}function h(t){switch(t.state){case u.SUCCEEDED:var e=a.get("odag.toolbar.navpoint.popup.delete.confirmation",[t.name]);var n=new i;r.open({title:a.get("odag.toolbar.navpoint.popup.delete.confirmation.title"),content:e,buttons:[{name:"Common.Cancel",tid:"odag-applist-modal-cancelBtn",callback:function t(){n.resolve()}},{name:"Common.Delete",tid:"odag-applist-modal-deleteBtn",defaultButton:true,callback:function e(){return s.deleteGenApp(t.parentContext.app,t.requestId).then(function(){n.resolve()})}}]});return n.promise;case u.FAILED:return s.requestAction(t.parentContext.app,t.requestId,s.ODAGRequestActionConst.FAIL_ACK,true,true);case u.VALIDATING:case u.QUEUED:case u.LOADING:case u.CANCELING:var o=true;var l=true;if(t.lastLoadedTime){o=false;l=false}return s.requestAction(t.parentContext.app,t.requestId,s.ODAGRequestActionConst.CANCEL,o,l);case u.CANCELED:return s.requestAction(t.parentContext.app,t.requestId,s.ODAGRequestActionConst.CANCEL_ACK,true,true)}}function f(t,e,n){return t.getLoadedLinkInfo(t).then(function(i){return s.reloadApp(t.model.parent.app,i,e,n,t.actualRowEst)})}function g(t,e){return s.getSelections(t,e)}function v(t,e){return o.getSelectedValuesDisplayString(t,e)}function m(t){return t.getLoadedLinkInfo(t).then(function(e){return s.generateApp(t.model.parent.app,t.model.parent.id,e,t.id,t.actualRowEst)})}function b(t){delete c[t.id]}function y(n,a,r,l){if(!r){l=Date.now();c[n.id]=l}return c[n.id]&&l>=c[n.id]?s.getGeneratedAppsForLink(n.model.parent.app,n.model.parent.id,n.data.odagLinkRefID,n.id).then(function(i){i.forEach(function(t){var i=o.createGeneratedAppWrapper(t,n.model.parent);var s=a.map(function(t){return t.requestId}).indexOf(t.id);if(s>-1){var r=a[s];var l=e.chain(i).keys().every(function(t){return e.has(r,t)&&e.isEqual(i[t],r[t])}).value();l||a.splice(s,1,i)}else a.push(i)});for(var s=a.length-1;s>-1;s--){var r=a[s];i.some(function(t){return t.id===r.requestId})||a.splice(s,1)}a.sort(function(t,e){var n=new Date(t.createdDate);var i=new Date(e.createdDate);return i-n});if(a.some(function(t){return t.loading}))return t(function(){y(n,a,true,l)},3e3);delete c[n.id]}):i.resolve()}function S(t){var e=a.get("Common.None");t.range&&(t.range.lowerBound&&t.range.lowerBound===t.range.upperBound?e=t.range.lowerBound:void 0===t.range.lowerBound||t.range.upperBound?void 0===t.range.upperBound||t.range.lowerBound?void 0!==t.range.lowerBound&&void 0!==t.range.upperBound&&(e="["+t.range.lowerBound+" - "+t.range.upperBound+"]"):e="<="+t.range.upperBound:e=">="+t.range.lowerBound);return e}function I(t,e){var n=true;t.range&&(t.range.lowerBound&&t.range.lowerBound===t.range.upperBound?n=t.range.lowerBound===e.length:void 0===t.range.lowerBound||t.range.upperBound?void 0===t.range.upperBound||t.range.lowerBound?void 0!==t.range.lowerBound&&void 0!==t.range.upperBound&&(n=e.length>=t.range.lowerBound&&e.length<=t.range.upperBound):n=e.length<=t.range.upperBound:n=e.length>=t.range.lowerBound);return n}function x(t,e){e.length=0;t.getLoadedLinkInfo(t).then(function(n){s.getConstraintFieldBindingValues(t.model.parent.app,n.bindings).then(function(t){for(var i=0;i<n.bindings.length;i++){var a=t[i];var s={fieldName:n.bindings[i].selectAppParamName,values:a.fieldValues,hasConstraint:!a.noConstraint,constraint:S(n.bindings[i]),bindingPassesConstraint:I(n.bindings[i],a.fieldValues)};e.push(s)}})})}function q(t,e,n){return s.renameGenApp(t,e,n)}function w(t){var e=t.parentContext.app;return s.clearSelections(e).then(function(){var n=[];for(var a=0;a<t.selectionsState.length;a++){var r=t.selectionsState[a];var o=r.selectionAppParamName;var l=r.values;n.push(s.selectFieldValuesForField(e,o,l))}return i.all(n)})}l={ODAG_STATE:u,ODAG_TERMINAL_STATES:d,updateItemHeader:p,loadGeneratedApps:y,stopLoadGeneratedApps:b,deleteGeneratedApp:h,reloadApp:f,getSelections:g,getSelectedValuesDisplayString:v,generateApp:m,renameGenApp:q,applySelections:w,initializeBindings:x};return l}])}.apply(e,i),void 0!==a&&(t.exports=a))},363:function(t,e,n){"use strict";var i,a;!(i=[n(91),n(273),n(90),n(11)],a=function(t,e,n,i){return{activatePopover:a,createPlaceHolder:r,getMultiPopoverItems:o,openMultiStatePopover:l,getAllStatesFromSelections:c,getAllSelectionsInStates:u,groupSelectionsByField:d,openListboxPopover:p,getIndexByKey:h,getDisplayStateName:s};function a(t,e,n,i,a,s){return t.showField(e,i.model.app.enigmaModel,n,{qStateName:s},function(){i.activeFieldName="";a(function(){i.closeTooltip()},100)})}function s(n){return n===e.DEFAULT_STATE_NAME?t.get(e.DEFAULT_STATE_TRANSLATION):n}function r(t,e,n){t.isPlaceHolder=true;t.active=false;t.qLocked=false;t.feedbackActive=false;t.translation="";t.qTotal=0;t.qStateCounts=0;e&&(t.qField=e);n&&(t.name=n);return t}function o(t,e){t=t||[];var n=t.filter(function(t){return t.qField===e})[0];var i=[];n&&n.states&&(i=n.states.map(function(t){t.isSingleState=true;t.displayStateName=s(t.stateName);return t}));return i}function l(t,e,n,i,a){var s=t.show({alignToElement:n,clear:a.clear,click:a.click,onClose:a.onClose,openTooltip:a.openTooltip,closeTooltip:a.closeTooltip,handleKeyDown:a.handleKeyDown,getItems:e,brightCurSel:i});return s}function c(t,e){e=e||null;var i=[];e&&(t=t.filter(function(t){return t.qField===e}));t.forEach(function(t){t.states?t.states.forEach(function(t){i.push(t.stateName)}):i.push(t.stateName)});i=n.getUnique(i);return i}function u(t){var e=[];(t.selectionsInStates||[]).forEach(function(t){t.qSelectionObject.qSelections.forEach(function(e){e.stateName=t.stateName});e=e.concat(t.qSelectionObject.qSelections)});return e}function d(t){var e={};t.forEach(function(t){var n=e[t.qField];n=n||{states:[],qField:t.qField};n.states.push(t);e[t.qField]=n});var n=Object.keys(e).map(function(t){var n=e[t];var i=n.states;if(1===i.length){n=n.states[0];n.isSingleState=true;n.isDefaultState="$"===i[0].stateName}else n.name=i[0].name;return n});return n}function p(t,e,n,a,s,r,o){if(n)return t(o.listboxPopoverServiceMobile,s,r,e,o.$timeout,a).catch(function(t){false});return t(o.listboxPopoverService,s,r,e,o.$timeout,a).then(function(t){var n;t.closing.then(function(t){t&&!i(t.target).closest(".current-selections-item").length>0&&(e.activeFieldName="");n=t}).catch(function(t){false});t.closed.then(function(){if(e.onCloseFocusSelector){i(e.onCloseFocusSelector).focus();e.onCloseFocusSelector=null}else e.activeFieldName&&i('.item[data-csid="'+e.activeFieldName+'"]').focus();t=null;n||(e.activeFieldName="")}).catch(function(t){false});t.opened.catch(function(t){false})}).catch(function(t){false})}function h(t,e,n){if([void 0,null].contains(e)||[void 0,null].contains(n))throw new Error("unaccepted key or val ( key: "+e+", val: "+n+")");var i=t.map(function(t){return t[e]});return i.indexOf(n)}}.apply(e,i),void 0!==a&&(t.exports=a))},364:function(t,e,n){"use strict";var i,a;!(i=[n(89),n(97)],a=function(t,e){var n={template:null,controller:["$scope","$element","$timeout",function(n,i,a){var s=this;n.input.selectionsActivated=function(){};n.input.selectionsDeactivated=function(){};s.close=function(){r()};function r(){a(function(){n.destroyComponent();i.remove()});e.off("start.listbox-popover-error",r)}function o(){return a(function(){return i.find(".toolbar-wrapper").outerWidth()})}var l=n.input.onPopoverClose;var c=null;n.closingDeferred.promise.then(function(t){c&&c();l(t);r()});t.all({object:n.input.getVisualization(),width:o()}).then(function(t){var i=t.object,a=t.width;i.getSelectionToolbar().then(function(t){n.toolbar=t;n.toolbar.showLock=n.input.options.showLock;n.toolbar.position={width:a};i.activateSelections()});i.loaded.then(function(){i.ext.hasError(i)&&e.on("start.listbox-popover-error",r)});i.selectionsApi.watchActivated(function(){n.input.selectionsActivated()});i.selectionsApi.watchDeactivated(function(){n.input.selectionsDeactivated();r()});c=function t(){i.selectionsApi.confirm()}})}]};return n}.apply(e,i),void 0!==a&&(t.exports=a))},365:function(t,e){t.exports='<lui-popover\n\t\tclass="qv-listbox-popover"\n\t\tstyle="min-width: 200px;width: 234px;height: 332px"\n\t\ton-close-view="closeView(event)"\n\t\tqva-outside-ignore-for="{{input.qvaOutsideIgnoreFor}}"\n\t\tqva-mouse-wheel-outside="close()">\n\t<lui-popover-body style="height: 332px" class="lui-nopad">\n\t\t<qv-spinner show="!input.model" spinner-height="100px" spinner-width="100px" show-Delay="300" center-in-parent="true"></qv-spinner>\n\t\t<div class="toolbar-wrapper"\n\t\t\t qva-include-selection-toolbar\n\t\t\t component="input.selectionToolbarComponent"\n\t\t\t toolbar="toolbar"\n\t\t\t options="input.options"></div>\n\t\t<div class="listbox-wrapper">\n\t\t\t<qv-object object="object" model="input.model" options="input.options"></qv-object>\n\t\t</div>\n\t</lui-popover-body>\n</lui-popover>\n'},366:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95)],a=function(t,e){t.service("qvCaoSelectionService",[function(){var t={sendSelectedChartChangeEvent:function t(){e.publish("cao/insight/selectedChartChanged",this.selectedChart)},getSelectedChart:function t(){return this.selectedChart},selectChart:function t(e){this.selectedChart=e;this.sendSelectedChartChangeEvent()},clearSelection:function t(){if(this.selectedChart){this.selectedChart=void 0;this.sendSelectedChartChangeEvent()}}};return t}])}.apply(e,i),void 0!==a&&(t.exports=a))},367:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(89),n(875)],a=function(t,e,n){function i(t,e,n){this.visualization=t;this.searchReport=e;this.options=t.options;this.type="generated";this.analysisPrecedentId=t.matchRecord.analysisPrecedentId;this.appearsOnSheets=[];this.properties=n}i.prototype.getTitle=function(){var t=this.visualization.analysis.titleTemplate;var i=this.visualization.matchRecord.matches;return e.resolve(n.findTitleForChart(t,i))};i.prototype.getMatchDetails=function(){var t=[];if(this.searchReport.search){var e=this.searchReport.search.fieldLibItemFinder.searchHits;this.visualization.matchRecord.matches.forEach(function(n){var i=n.field;n.libId&&(i=n.libId+"- "+n.libIdLabel);var a=e[i];a&&t.push({matchedOn:a.matchingTypes[0],matchedField:n.field||n.libIdLabel})})}return t};i.prototype.getChartType=function(){return e.resolve(this.properties.visualization)};i.prototype.loadChart=function(n){var i=new e;var a=t.getService("qvCaoChartService");var s=this;s.getTitle().then(function(t){a.buildInsightChart(t,n,s.properties).then(function(t){i.resolve(t)})});return i.promise};return i}.apply(e,i),void 0!==a&&(t.exports=a))},368:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(369)],a=function(t,e){t.service("qvCaoComplexityEstimatorService",[function(){var t;var n=[];var i=/aggr|rangeSum|FirstSortedValue/gi;function a(t){t.getFieldList().then(function(t){n=t})}function s(t){var e=n.filter(function(e){return e.qName===t});return e[0]&&e[0].qCardinal?e[0].qCardinal:0}function r(t){var n=e.classify(t);var a=0;var s=false;n.results.forEach(function(t){(-1!=t.content.search(i)||t.remainder&&-1!=t.remainder.content.search(i))&&(s=true);(t.function&&""!=t.function.content||t.isOperator)&&a++});return a*(s?3:1)}function o(t){var e=r(t.expr);var n=s(t.field,t)*e;return n*(e+1)}var l=function t(e){var n=0;e.analysis.dims&&e.analysis.dims.forEach(function(t){n+=o(t)});e.analysis.msrs&&e.analysis.msrs.forEach(function(t){n+=o(t)});return n};t={init:a,estimateComplexity:l};return t}])}.apply(e,i),void 0!==a&&(t.exports=a))},369:function(t,e,n){"use strict";var i,a;!(i=[n(54),n(407),n(187),n(178),n(408)],a=function(t,e,n,i,a){var s={};var r={classify:o};return r;function o(n){if(!t.isString(n))throw new Error("Expression-classifier: Expression must be a string");var i=n;if(s[i])return s[i];var r={content:n,count:0,result:{},results:[]};if(""===n){s[i]=r;return r}"="===n.charAt(0)&&(n=n.substr(1));var o=a.stripComments(n);var c=e.tokenize(o);r.count=c.length;c.forEach(function(t,e){var n;if(t.isOperator)r.results.push(t);else{n=l(t.content);r.results.push(n)}0===e&&(r.result=n)});s[i]=r;return r}function l(t){var e={content:t,function:{content:"",isCommon:false},remainder:{content:"",isFunction:false,isCommonFunction:false,isCommaSeparated:false,isFieldlike:false,isString:false,isNumber:false,isQualifier:false,qualified:{qualifier:"",content:"",isFieldlike:false}}};var n=c(t);if(n.hasAggregation){e.function.content=u(t,n);e.function.isCommon=v(e.function.content);e.remainder.content=d(t,n);var i=c(e.remainder.content);e.remainder.isFunction=b(i);e.remainder.isCommonFunction=y(e.remainder.content,i);e.remainder.isQualifier=h(e.remainder.content);e.remainder.isCommaSeparated=m(e.remainder.content);if(e.remainder.isQualifier){var a=f(e.remainder.content),s=g(e.remainder.content,a),r=c(s);e.remainder.qualified={qualifier:a,content:s,isFieldlike:S(r)}}n=i}else e.remainder.content=e.content;e.remainder.isFieldlike=S(n);e.remainder.isString=I(e.remainder.content);e.remainder.isNumber=x(e.remainder.content);return e}function c(t){var e={};e.expression=t;e.hasPrefix="="===t.charAt(0);e.leftSymbolIndex=t.indexOf(n.SYMBOLS.FUNCTION.LEFT);e.hasAggregation=e.leftSymbolIndex>0;e.isRightSymbolLast=t.substring(t.length-1)===n.SYMBOLS.FUNCTION.RIGHT;e.isEncapsulated=e.hasAggregation&&e.isRightSymbolLast;e.hasOperator=p(t);return e}function u(t,e){var n=e.hasPrefix?1:0,i=e.hasPrefix?e.leftSymbolIndex+1:e.leftSymbolIndex;return t.substr(n,i).trim()}function d(t,e){var n=t.substr(e.leftSymbolIndex),i=n.substr(1,n.length-2);return i.trim()}function p(t){var e=n.OPERATORS,i=e.SINGLES,a=e.MULTIPLES,s=e.WORDS;var r=i.some(function(e){return t.indexOf(e)>-1});if(r)return true;var o=a.some(function(e){return t.indexOf(e)>-1});if(o)return true;var l=s.some(function(e){return t.indexOf(" "+e+" ")>-1});return l}function h(t){return n.QUALIFIERS.some(function(e){return 0===t.toLowerCase().indexOf(e)})}function f(t){var e=n.QUALIFIERS.filter(function(e){return 0===t.toLowerCase().indexOf(e)}).shift();return e}function g(t,e){return t.slice(e.length).trim()}function v(t){return n.COMMON_FUNCTIONS.some(function(e){return t.toLowerCase()===e})}function m(t){var e=i.getCharacterIndexes(t,",");return e.some(function(e){return!P(t,e)})}function b(t){return t.isEncapsulated&&!t.isBleedingOperator}function y(t,e){if(!e.isEncapsulated)return false;var n=t.substr(0,e.leftSymbolIndex);return v(n)}function S(t){var e=t.expression;if(I(t.expression))return false;var a=q(e,n.SYMBOLS.FIELD.LEFT),s=w(e,n.SYMBOLS.FIELD.RIGHT),r=i.getCharacterCount(e,n.SYMBOLS.FIELD.LEFT),o=i.getCharacterCount(e,n.SYMBOLS.FIELD.RIGHT);if(a&&s&&1===r&&1===o)return true;return C(t)}function I(t){var e=q(t,n.SYMBOLS.STRING.LEFT),a=w(t,n.SYMBOLS.STRING.RIGHT),s=n.SYMBOLS.STRING.LEFT===n.SYMBOLS.STRING.RIGHT,r=i.getCharacterCount(t,n.SYMBOLS.STRING.LEFT),o;if(s)o=2===r;else{var l=i.getCharacterCount(t,n.SYMBOLS.STRING.RIGHT);o=1===r&&1===l}return e&&a&&o}function x(t){return!Number.isNaN(+t)}function q(t,e){return t.charAt(0)===e}function w(t,e){return t.charAt(t.length-1)===e}function C(t){if(t.hasAggregation)return false;var e=t.expression,i=e.indexOf(" ")>-1;if(i)return false;var a=n.OPERATORS.SINGLES.concat(n.OPERATORS.MULTIPLES).some(function(t){return e.indexOf(t)>-1});return!a}function P(t,e){return Object.keys(n.SYMBOLS).some(function(a){var s=n.SYMBOLS[a];return i.getIsCharacterEncapsulated(t,e,s.LEFT,s.RIGHT)})}}.apply(e,i),void 0!==a&&(t.exports=a))},370:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(894),n(169)],a=function(t,e){t.directive("qvGlobalSearchHighlights",function(){return{restrict:"E",template:e,replace:true,scope:{qText:"=",qRanges:"="},link:function e(n){var i=t.getService("qvGlobalSearchDataService").getMaxColorsNum();n.slices=null;n.$watch("qRanges",function(t){if(t){var e=0,s=[],r=t.sort(function(t,e){return t.qCharPos-e.qCharPos});for(var o=0;o<r.length;o++){var l=r[o];l.qCharPos>e&&s.push({qTerm:-1,qSliceText:n.qText.slice(e,l.qCharPos),highlight:false,iStart:e,iEnd:l.qCharPos});e=l.qCharPos+l.qCharCount;var c={qTerm:l.qTerm%i,highlight:true,qSliceText:n.qText.slice(l.qCharPos,e),iStart:l.qCharPos,iEnd:e};a(s,c);o===t.length-1&&e<n.qText.length&&s.push({qTerm:-1,qSliceText:n.qText.slice(e,n.qText.length),highlight:false,iStart:e,iEnd:n.qText.length})}n.slices=s}});function a(t,e){var n=null;for(var i=0;i<t.length;i++)if(t[i].iStart===e.iStart){n=t.splice(i,1,e);break}n||t.push(e)}}}})}.apply(e,i),void 0!==a&&(t.exports=a))},371:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(99),n(96)],a=function(t,e,n){t.directive("qvaSmartSearchSwipeHorizontal",["$parse",function(t){var i={up:false,down:false,right:true,left:true};return{restrict:"A",link:function a(s,r,o){var l=t(o.qvaSmartSearchSwipeHorizontal);function c(t,e){if(i[e.swipe.direction]){var a=e.swipe.curDeltaX>0?-1:0===e.swipe.curDeltaX?0:1;l(s,{delta:a});n.preventGestures(this.gestureHandler)}}e.treatAsDesktop()||n(r[0]).swipe({options:{radiusThreshold:50,preventDefault:false,useMomentum:true},start:c});s.$on("$destroy",function(){n(r[0]).off()})}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},372:function(t,e,n){"use strict";var i,a;!(i=[n(2)],a=function(t){var e=function t(){};e.parseQuery=function(e,n){var i={text:e,appId:n};var a={method:"POST",url:"/api/v1/sentences",data:i};return t.request(a).then(function(t){var e=t.data;return e}).catch(function(t){throw t})};e.getQueries=function(e,n){var i="?limit="+e+"&appId="+n;var a={method:"GET",url:"/api/v1/sentences"+i};return t.request(a).then(function(t){var e=t.data.data;return e}).catch(function(t){throw t})};return e}.apply(e,i),void 0!==a&&(t.exports=a))},373:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91)],a=function(t,e){t.service("qvCaoLearningConfidenceService",[function(){var t;var n={HIGH:{value:10,text:"high"},MEDIUM:{value:5,text:"medium"},LOW:{value:2,text:"low"},EMPTY:{value:0,text:"empty"}};function i(t){var e=t.getRelevance();var i=t.getMatchRecord();var a=n.EMPTY;if(t.isModified()){a=n.EMPTY;return a.text}1===e?a=n.HIGH:e>=.5?a=n.HIGH:e>0&&(a=n.HIGH);i.precedentStats&&(i.precedentStats.matchedFields===i.matches.length?a=n.HIGH:i.precedentStats.matchedFields>0&&a.value<n.MEDIUM.value&&(a=n.HIGH));return a.text}function a(t,n,i,a){var s={search:[],learned:[]};var r=t.field||t.libIdLabel;var o="";var l=i.filter(function(t){return t.matchedField===r})[0];var c=!!t.libIdLabel;var u=c?t.libId:null;if(l){switch(l.matchedOn){case"absoluteExactMatchCaseSensitive":o=e.get("cao.search.generated.absoluteExactMatchCaseSensitive");break;case"absoluteExactMatch":o=e.get("cao.search.generated.absoluteExactMatch");break;case"exactMatch":o=e.get("cao.search.generated.exactMatch");break;case"literalMatch":o=e.get("cao.search.generated.literalMatch");break;case"headMatch":o=e.get("cao.search.generated.headMatch");break;case"headSynonymMatch":o=e.get("cao.search.generated.headSynonymMatch");break;case"headStemMatch":o=e.get("cao.search.generated.headStemMatch");break;case"headStemSynonymMatch":o=e.get("cao.search.generated.headStemSynonymMatch");break;case"partialTokenMatch":o=e.get("cao.search.generated.partialTokenMatch");break;case"substrPartialMatch":o=e.get("cao.search.generated.substrPartialMatch");break;case"semanticMatch":o=e.get("cao.search.generated.semanticMatch");break;case"valueMatch":o=e.get("cao.search.generated.valueMatch");break;default:break}if(o){o=o.replace(/\{1\}/g,function(t){return"<b>"+t+"</b>"});var d=e.get(o,[n.search.searchPhrase.text,l.matchedField]);s.search.push({text:d,field:l.matchedField,priority:1,type:t.slotRole,isLibItem:c,libItemId:u,searchMatch:true})}}if(t.appPrecedent&&t.appPrecedent.appPrecedent){var p=false;if(t.appPrecedent.userDefined&&t.appPrecedent.userDefined.isUserDefined&&t.appPrecedent.userDefined.relations.indexOf("define")>-1){p=true;o=t.aggr||"measure"===t.slotRole?e.get("cao.confidence.reason.defined_measure"):e.get("cao.confidence.reason.defined_dimension")}else o=t.aggr||"measure"===t.slotRole?e.get("cao.confidence.reason.learned_measure"):e.get("cao.confidence.reason.learned_dimension");o=o.replace(/\{0\}/g,function(t){return"<b>"+t+"</b>"});s.learned.push({text:e.get(o,r),field:r,priority:1,type:t.slotRole,isLibItem:c,libItemId:u,userMatch:p})}if(0===s.learned.length&&a){o=t.aggr||"measure"===t.slotRole?e.get("cao.confidence.reason.assumed_measure"):e.get("cao.confidence.reason.assumed_dimension");o=o.replace(/\{0\}/g,function(t){return"<b>"+t+"</b>"});s.learned.push({text:e.get(o,r),field:r,priority:0,type:t.slotRole,isLibItem:c,libItemId:u})}return s}t={getReasonForSelectingField:a,determineConfidence:i,confidenceLevels:n};return t}])}.apply(e,i),void 0!==a&&(t.exports=a))},374:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(936),n(103)],a=function(t,e,n,i){t.nativeComponent("qvCaoRefreshIndicator",{bindings:{},controller:[function(){this.refresh=function(){i.trackEvent(i.customEvents.INSIGHTS_REFRESH_CLICKED);e.publish("cao/insight/refresh")}}],template:n})}.apply(e,i),void 0!==a&&(t.exports=a))},375:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(89),n(971)],a=function(t,e,n){var i=null;var a=null;function s(s){var r={id:s.id,type:s.type,canCopy:function t(){return false},canCut:function t(){return false},canRemove:function t(){return true},remove:function t(){s.model.removeObject()},getAllPropertyPanelContent:function r(){if(!i){i=t.getService("$cacheFactory");a=i("pp-navPoint")}return e.all({properties:s.model.getProperties(),layout:s.model.getLayout()}).then(function(t){var e={definition:n,iconClass:"lui-icon lui-icon--sign-post",titleRef:"qMeta.title",properties:t.properties,layout:t.layout,model:s.model,cache:a,type:s.invalid?"invalid":"odagNavPoint"};return e})}};return r}return{createSelectedObjFromNavPoint:s}}.apply(e,i),void 0!==a&&(t.exports=a))},392:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(409)],a=function(t,e){t.directive("qvStateCountBar",function(){return{restrict:"E",template:e,replace:true,scope:{stateCounts:"=",options:"="},link:function t(e){e.percents=[];e.$watchCollection("stateCounts",function(){n()});function n(){var t=e.stateCounts,n;if(!t)return;n=a(t);e.percents=s(n)}function i(t){return Object.keys(t).reduce(function(e,n){return e+t[n]},0)}function a(t){var e=i(t),n={};["qSelected","qLocked","qOption","qAlternative"].forEach(function(i){var a=t[i]||0,s=Math.round(a/e*100);a>0&&0===s&&(s=1);n[i]=s});return n}function s(t){var e={},n,i,a=0;for(n in t){e[n]=t[n];(!i||t[n]>t[i])&&(i=n);a+=t[n]}a>100&&(e[i]=t[i]-(a-100));return e}}}})}.apply(e,i),void 0!==a&&(t.exports=a))},405:function(t,e,n){var i;!(i=function(){return function(t,e){if(!t||isNaN(+e))return e;var e="-"==t.charAt(0)?-e:+e;var n=e<0?e=-e:0;var i=t.match(/[^\d\-\+#]/g);var a=i&&i[i.length-1]||".";var s=i&&i[1]&&i[0]||",";var t=t.split(a);e=e.toFixed(t[1]&&t[1].length);e=+e+"";var r=t[1]&&t[1].lastIndexOf("0");var o=e.split(".");(!o[1]||o[1]&&o[1].length<=r)&&(e=(+e).toFixed(r+1));var l=t[0].split(s);t[0]=l.join("");var c=t[0]&&t[0].indexOf("0");if(c>-1)while(o[0].length<t[0].length-c)o[0]="0"+o[0];else 0==+o[0]&&(o[0]="");e=e.split(".");e[0]=o[0];var u=l[1]&&l[l.length-1].length;if(u){var d=e[0];var p="";var h=d.length%u;for(var f=0,g=d.length;f<g;f++){p+=d.charAt(f);!((f-h+1)%u)&&f<g-u&&(p+=s)}e[0]=p}e[1]=t[1]&&e[1]?a+e[1]:"";return(n?"-":"")+e[0]+e[1]}}.call(e,n,e,t),void 0!==i&&(t.exports=i))},407:function(t,e,n){"use strict";var i,a;!(i=[n(54),n(187)],a=function(t,e){var n=s();var i={tokenize:a};return i;function a(e){if(!t.isString(e))throw new Error("Expression-tokenizer: Expression must be a string");e=e.trim();"="===e.charAt(0)&&(e=e.substr(1));var n=[],i=0,a=r(e);a.forEach(function(t){var a=e.substr(i,t.start-i).trim();a&&n.push({content:a,isOperator:false});n.push({content:t.content,isOperator:true});i=t.end});var s=e.substr(i,e.length);n.push({content:s.trim(),isOperator:false});return n}function s(){var t={};for(var n in e.SYMBOLS)if(e.SYMBOLS.hasOwnProperty(n)){var i=e.SYMBOLS[n];t[i.LEFT]=i.RIGHT}return t}function r(t){var e=[];for(var n=0;n<t.length;n++){var i=t.charAt(n);if(o(i)){n=l(t,i,n);continue}var a=[],s=false,r=c(i);a=u(i);if(a.length){var p=t.substr(n).toLowerCase();for(var h=0;h<a.length;h++){var f=a[h],g=d(p,f);if(g){e.push({content:f,start:n,end:n+f.length});s=true;n+=f.length-1;break}}}!s&&r&&e.push({content:i,start:n,end:n+1})}return e}function o(t){return n.hasOwnProperty(t)}function l(t,i,a){var s=i,r=n[s],o=t.substring(a).split(""),l=0,c=false;for(var u=0;u<o.length;u++){var d=o[u];d===e.SYMBOLS.STRING.LEFT&&(c=!c);if(c)continue;d===s&&l++;d===r&&l--;if(!l)return u+a}return a}function c(t){return e.OPERATORS.SINGLES.indexOf(t.toLowerCase())>-1}function u(t){var n=[];var i=e.OPERATORS.MULTIPLES.concat(e.OPERATORS.WORDS).filter(function(t){return t.length>1}).map(function(t){return t.toLowerCase()});i.forEach(function(e){0===e.indexOf(t.toLowerCase())&&n.push(e)});return n}function d(t,n){var i=0===t.indexOf(n+" "),a=e.OPERATORS.SINGLES.some(function(e){return 0===t.indexOf(n+e)});return i||a}}.apply(e,i),void 0!==a&&(t.exports=a))},408:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={stripComments:e};return t;function e(t){if(!t)return"";t=n(t);t=i(t);return t.trim()}function n(t){return t.replace(/\/\/(.*)$/gm,"")}function i(t){return t.replace(/\/\*[^]*?\*\//g,"")}}.apply(e,i),void 0!==a&&(t.exports=a))},409:function(t,e){t.exports='<div class="qv-state-count-bar" tid="stateCount" qva-direction x-dir-setting="{{options.direction}}">\n\t<div class="state selected" ng-style="{\'width\': percents.qSelected + \'%\'}"></div>\n\t<div class="state locked" ng-style="{\'width\': percents.qLocked + \'%\'}"></div>\n\t<div class="state optional" ng-style="{\'width\':  percents.qOption + \'%\'}"></div>\n\t<div class="state alternative" ng-style="{\'width\':  percents.qAlternative + \'%\'}"></div>\n</div>'},484:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(138),n(485),n(105),n(91)],a=function(t,e,n,i,a){t.directive("circleChart",function(){return{scope:{model:"="},restrict:"E",replace:true,template:n,controller:["$scope","$element","$timeout",function(t,n,s){var r=n.find(".circular-bar");t.radius=50;t.arcValue="M50 0 A 50 50, 0, 0, 1, 0 0, L 50 50 z";function o(){if(p()){var e=r.height();var n=r.width();if(e<n){t.radius=e/2;t.svgPos={height:e,width:e,top:0,left:n/2-e/2}}else{t.radius=n/2;t.svgPos={height:n,width:n,top:e/2-n/2,left:0}}}d()}function l(t,e,n,i){var a=(i-90)*Math.PI/180;return{x:t+n*Math.cos(a),y:e+n*Math.sin(a)}}function c(t,e,n,i,a){var s=l(t,e,n,a);var r=l(t,e,n,i);var o=a-i<=180?"0":"1";var c=["M",s.x,s.y,"A",n,n,0,o,0,r.x,r.y].join(" ");return c}function u(t){return 3.6*t}function d(){var n=0;if(t.model.chartValue)n=t.model.chartValue;else if(t.model.numerator&&t.model.denominator){n=0===t.model.denominator?0:t.model.numerator/t.model.denominator;n*=100}if(n>0&&n<1){var i=e.format.number(0,{style:"percent"});t.chartPercentageValue=a.get("CircleChart.ChartPercentageValue.LessThanOne",i)}else t.chartPercentageValue=e.format.number(Math.round(n)/100,{style:"percent"});var s=t.radius;var r=8;var o=0;if(t.model.chartValueSubText){r=-3;o=17}t.percentagePos={x:s,y:s+r};t.subtextPos={x:s,y:s+o};var l=100===n?99.99:n,d=l;d||(d=0);t.arcValue=c(s,s,s-5,0,u(d))}function p(){return r.height()>0||r.width()>0}t.$on(i.Events.EditorDetailsPane.ResizeChart,function(){o()});t.$watch("model",function(){d()});p()?o():s(function(){o()})}]}})}.apply(e,i),void 0!==a&&(t.exports=a))},485:function(t,e){t.exports='<div class="ds-visualization-circle-chart">\n\t<div class="chart-heading">{{ model.header }}</div>\n\n\t<div class="circular-bar">\n\t\t<svg version="1.1" xmlns="http://www.w3.org/2000/svg" ng-style="svgPos">\n\t\t\t<g class="arcs">\n\t\t\t\t<circle ng-attr-cx="{{radius}}" ng-attr-cy="{{radius}}" ng-attr-r="{{radius}}" class="outer-circle" />\n\t\t\t\t <path ng-attr-d="{{arcValue}}" class="outer-arc" tid="circle-chart-arc1" /> \n\t\t\t\t<circle ng-attr-cx="{{radius}}" ng-attr-cy="{{radius}}" ng-attr-r="{{radius - 10}}" class="inner-circle"  />\n\t\t\t</g>\n\t\t\t<text ng-attr-x="{{percentagePos.x}}" ng-attr-y="{{percentagePos.y}}" class="percentage-label">{{ chartPercentageValue }}</text>\n\t\t\t<text ng-attr-x="{{subtextPos.x}}" ng-attr-y="{{subtextPos.y}}" class="percentage-subtext-label">{{ model.chartValueSubText }}</text>\n\t\t</svg>\n\t</div>\n\n\t<div class="chart-footer">{{ model.footer }}</div>\n</div>\n\n'},508:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(91),n(94),n(969),n(207),n(99),n(97),n(133),n(236),n(509),n(192),n(287),n(510),n(274)],a=function(t,e,n,i,a,s,r,o,l,c,u,d){function p(t){return{odagLinkItem:function e(n){var a=n.item.getDropOption();var s={insertBeforeItem:t,title:a.args.init.linkRef.name,odagLinkRefID:a.args.init.linkRef.id};var r=i.model;l.addODAGNavPoint(r,s)}}}function h(e,n){function i(t,e,n){var i=p(e);var a={targetRect:n,drawRect:n,drop:i,dropShadePercentage:10};t.registerDropRect(a)}var a;var s={accept:{odagLinkItem:function t(){return true}},end:function t(){n.removeClass(a);e.dragging=false},start:function s(r){e.dragging=true;var o;try{o=n[0].getBoundingClientRect()}catch(t){return}var l={left:o.left+2,right:o.right-2,top:o.top+2,bottom:o.bottom-2};a="odagLinkItem"===r.info.type?"dragging library-dragging":"dragging";n.addClass(a);var c=n.find(".dropArea");for(var u=0;u<c.length;u++){var d=t(c[u]);var p=d[0].getBoundingClientRect();var h={left:p.left+2,right:p.right-2,top:p.top+2,bottom:p.bottom-2};var f=null;var g=e.odagNavPoints;u<g.items.length&&(f=g.items[u]);i(r,f,h)}var v=n.find(".odag-nav-point-cell:last");var m={left:0,right:0,top:0,bottom:0};var b=l.left;if(v.length){m=v[0].getBoundingClientRect();b=m.right}var y={left:b,top:l.top,right:l.right,bottom:l.bottom};i(r,null,y)}};c.registerDropTarget(s);e.$on("$destroy",function(){c.unregisterDropTarget(s)})}var f={template:a,restrict:"E",scope:{model:"=",inEditMode:"=",standAlone:"="},link:function t(e,n){h(e,n)},controller:["$scope","$timeout","$element","qvSheetService",function(t,e,a,c){t.sortableNavPoints=null;var p=t.standAlone?null:c;t.odagToolbarService=new u(p);t.dragging=false;t.waterMarkText="";var h=null;l.isODAGAvailable(t.model.app).then(function(e){e&&d.getList().then(function(e){e.layout&&e.layout.qAppObjectList&&e.layout.qAppObjectList.qItems.length>0&&l.getODAGLinks(t.model.app)})});t.sortableNavPoints=s.create({options:{direction:"horizontal",listKey:"list",listSelector:".list",itemKey:"item",itemSelector:".drag-odag-navpoint",itemDragSelector:".drag-odag-navpoint",gesture:{name:"swipe",options:{radiusThreshold:r.treatAsDesktop()?4:0,preventDefault:false}}},allowDrag:function e(){var e=this._super.apply(this,arguments);return e&&t.inEditMode},addPlaceholder:function t(){this._super.apply(this,arguments)},onBegin:function t(e){this._super.apply(this,arguments);h=e;h.classList=["reordering"];var n=a.find(".list");n.css("height",n.innerHeight())},removePlaceholder:function t(){this._super.apply(this,arguments);var e=a.find(".list");e.css("height","");h.classList=""},onMove:function e(){this._super.apply(this,arguments);var n=t.odagNavPoints.get().map(function(t){return t.data});var a=i.model;l.reorderNavPoints(a,n)}});t.odagNavPoints=t.sortableNavPoints.createList(1,{tid:"odagNavPoints"});t.$watchCollection("odagToolbarService.getOdagNavPoints()",function(n){t.odagNavPoints.reset();for(var i=0;i<n.length;i++)t.odagNavPoints.addSortableItem(n[i]);e(function(){t.$broadcast("refreshPager")})});t.$watch("model.sheetId",function(e){t.odagToolbarService.sheetChanged(e)});t.$watch("dragging",function(e){t.waterMarkText=e?n.get("odag.toolbar.help.dragging"):n.get("odag.toolbar.help.watermark")});t.odagToolbarService.init(t.model.app,t.model.openAppCallback).then(function(){t.waterMarkText=n.get("odag.toolbar.help.watermark")});o.on("end",function(){t.refreshPager(false)});t.$on("$destroy",function(){t.odagToolbarService.destroy()})}]};e.directive("qvOdagToolbar",function(){return f});return f}.apply(e,i),void 0!==a&&(t.exports=a))},509:function(t,e,n){"use strict";var i,a;!(i=[n(89),n(49),n(970),n(131),n(120),n(375),n(133),n(192),n(219)],a=function(t,e,n,i,a,s,r,o,l){function c(t){this.qvSheetService=t;this.currentApp=null;this.currentSheet=null;this.odagNavPoints=null;this.appLinkModelList=null;this.openAppCallback=null}c.prototype.init=function(t,e){var n=this;this.odagNavPoints=[];this.currentApp=t;this.openAppCallback=e;return o.getList(t).then(function(t){n.appLinkModelList=t;return t.getLayout().then(function(){n.updateNavPoints();t.Invalidated.bind(n.updateNavPoints.bind(n))})})};c.prototype.sheetChanged=function(t){var e=this;this.currentSheet&&this.currentSheet.Invalidated.unbind(this.updateNavPoints);t&&a.get(t,this.currentApp).then(function(t){e.currentSheet=t;if(e.currentSheet){e.updateNavPoints();e.currentSheet.Invalidated.bind(e.updateNavPoints.bind(e))}})};c.prototype.getODAGLinkInfo=function(n){var i=new t;if(n._cachedLinkProps)i.resolve(n._cachedLinkProps);else if(n.data.odagLinkRefID)l.getList(n.model.parent.app).then(function(t){if(t.filter(function(t){return t.properties.data.id===n.data.odagLinkRefID}).length>0)r.loadODAGLink(n.model.parent.app,n.data.odagLinkRefID).then(function(t){var a=e.getFlag("ODAG_SAAS_ENABLED")?t:t.objectDef;if(!t||"decommissioned"!==a){n.invalid=false;n.maxNumberOfApps=a.properties.genAppLimit[0].limit;n.maxRowExpressionCount=a.properties.rowEstRange[0].highBound;n._cachedLinkProps=a;return i.resolve(a)}n.invalid=true;i.resolve(null)},function t(){n.invalid=true;i.resolve(null)});else{n.invalid=true;i.resolve(null)}});else{n.invalid=true;i.resolve(null)}return i.promise};c.prototype.createODAGNavPointsList=function(e){var a=i.selectedObject?i.selectedObject:null;var o=null;var l=this;if(void 0!==e){this.odagNavPoints.splice(0,this.odagNavPoints.length);e.forEach(function(e){var c={id:e.info.id,type:"ODAGNavPoint",object:{isInvalid:true},data:e,openAppCallback:l.openAppCallback,model:null,maxRowExpressionCount:null,maxNumberOfApps:null,_cachedLinkProps:null,invalid:false,initialized:null};var u={parent:l.currentSheet,properties:e};c.model=new n(u);c.getLoadedLinkInfo=l.getODAGLinkInfo;c.getCurrentCountSessionObjectForLink=function(){return this.getLoadedLinkInfo(c).then(function(e){return e?r.getOrCreateSessionObjectsForLink(l.currentApp,e).then(function(t){return t}):t.resolve(null)})};l.odagNavPoints.push(c);if(a&&a.id===e.info.id&&!r.addingNewNavPointID[l.currentSheet.id]){o=c;i.setSelectedObject(s.createSelectedObjFromNavPoint(c))}});if(r.addingNewNavPointID[this.currentSheet.id]){var c=this.odagNavPoints.filter(function(t){return t.data.info.id===r.addingNewNavPointID[l.currentSheet.id]});if(c.length){i.setSelectedObject(s.createSelectedObjFromNavPoint(c[0]));o=c[0]}r.addingNewNavPointID[this.currentSheet.id]=null}this.qvSheetService&&a&&"ODAGNavPoint"===a.type&&!o&&this.qvSheetService.setSheetAsSelectedObj()}};c.prototype.updateNavPoints=function(){var t=this;if(this.currentApp&&this.currentSheet)return r.clearCachedSessionObjects(this.currentApp).then(function(){t.currentSheet.getNavPoints().then(function(e){t.createODAGNavPointsList(e)})})};c.prototype.hasODAGNavPoints=function(){return this.odagNavPoints.length>0};c.prototype.destroy=function(){this.odagNavPoints=[];this.appLinkModelList.Invalidated.unbind(this.updateNavPoints);this.currentSheet.Invalidated.unbind(this.updateNavPoints)};c.prototype.getOdagNavPoints=function(){return this.odagNavPoints};return c}.apply(e,i),void 0!==a&&(t.exports=a))},510:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(89),n(131),n(135),n(972),n(97),n(973),n(90),n(375),n(274),n(980)],a=function(t,e,n,i,a,s,r,o,l){var c={template:a,restrict:"E",replace:true,scope:{inEditMode:"=",inMobileMode:"=",item:"="},controller:["$scope","$timeout","$element","luiPopover",function(t,a,c,u){t.popover=null;t.stageState=n;t.$watch("stageState.selectedObject",function(e){t.selObject=e});var d=null;t.rowCountPercentage=0;function p(){if(t.popover){t.popover.close();return}var e={item:t.item};if(e.item.openAppCallback){var n=e.item.openAppCallback;e.item.openAppCallback=function(e,i){t.popover.close();n(e,i)}}var i=r;var a={input:e,dock:"top",alignTo:c[0],closeOnResize:true};i=o.extend(true,a,i);t.popover=u.show(i);t.popover.closed.then(function(){t.popover=null})}function h(){t.popover&&t.popover.close();return}function f(){var n=new e;if(d){var s=t.item;d.getLayout().then(function(e){s.actualRowEst=e.MaxRowCountExpression;i.isSuffixInUse("noData")&&(s.actualRowEst="NaN");var n=s.maxRowExpressionCount;var r=100*Math.min(n/s.actualRowEst,1);if(r>=100)if(100!==t.rowCountPercentage){t.rowCountPercentage=99;a(function(){t.rowCountPercentage=100;s.rowCountPercentage=100;s.rowCountPercentageNumber=100},300)}else s.rowCountPercentage=100;else{s.rowCountPercentage=r;t.rowCountPercentage=r}"number"===typeof s.rowCountPercentage&&Number.isNaN(+s.rowCountPercentage)?s.rowCountPercentageNumber=-1:s.rowCountPercentageNumber=s.rowCountPercentage}).finally(function(){n.resolve()})}else n.reject();return n.promise}function g(){t.item.getCurrentCountSessionObjectForLink().then(function(e){d=e;d&&d.Invalidated.bind(f);f().finally(function(){t.item.initialized.resolve()})})}t.$watchCollection("item",function(t,n){if(null!==n&&null===t.initialized){t.initialized=new e;g()}});s.on("end",h);t.onODAGNavPointClicked=function(e){if(t.inMobileMode)return;t.inEditMode?n.setSelectedObject(l.createSelectedObjFromNavPoint(e)):t.item.invalid||p(e)};t.deleteInvalidNavPoint=function(t,e){e.model.removeObject()};a(function(){t.$broadcast("refreshPager")});t.$on("$destroy",function(){d&&d.Invalidated.unbind(f)})}]};t.directive("qvOdagToolbarNavpoint",function(){return c});return c}.apply(e,i),void 0!==a&&(t.exports=a))},848:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(94),n(122),n(362)],a=function(t,e,n){var i;function a(){i||(i=t.getService("$navigationService"));return i}function s(){return a().Sheets.all.mashed}function r(){return a().Stories.all.mashed}function o(t){var n=e.model.id;var i=-1;t.forEach(function(t,e){t.qInfo.qId===n&&(i=e)});return i}function l(t,e){var n;e.forEach(function(e){e.qInfo.qId===t&&(n=e)});return n}function c(t,e){var n;e.forEach(function(e){e.qInfo.qId===t&&(n=e)});return n}function u(t){n.goToSheet(t,Object.keys(e.States)[e.state]);return{success:true,sheetId:t}}function d(t){n.goToStory(t,Object.keys(e.States)[e.States.play]);return{success:true,storyId:t}}function p(t,e,n){this.inClient=t;Object.defineProperties(this,{ANALYSIS:{get:function t(){return"analysis"}},EDIT:{get:function t(){return"edit"}},SNAPSHOT:{get:function t(){return"snapshot"}},sheets:{get:function n(){return t?s(this):e||[]}},stories:{get:function e(){return t?r(this):n||[]}}})}p.prototype.gotoSheet=function(t){var e=l(t,this.sheets);if(e)return u(t);return{success:false,error:"NOSUCHSHEET",errorMsg:"No such sheet"}};p.prototype.nextSheet=function(){if((e.view===e.Views.sheet||e.view===e.Views.object)&&e.model){var t=o(this.sheets)+1;var n=this.sheets[t===this.sheets.length?0:t].qInfo.qId;return u(n)}return{success:false,error:"NOCURRENTSHEET",errorMsg:"No current sheet"}};p.prototype.prevSheet=function(){if((e.view===e.Views.sheet||e.view===e.Views.object)&&e.model){var t=o(this.sheets)-1;var n=this.sheets[t<0?this.sheets.length-1:t].qInfo.qId;return u(n)}return{success:false,error:"NOCURRENTSHEET",errorMsg:"No current sheet"}};p.prototype.getCurrentSheetId=function(){if(e.view===e.Views.sheet&&e.model)return{success:true,sheetId:e.model.id};return{success:false,error:"NOCURRENTSHEET",errorMsg:"No current sheet"}};p.prototype.getMode=function(){return Object.keys(e.States)[e.state]};p.prototype.setMode=function(t){if(!this.isModeAllowed(t))return{success:false,error:"MODENOTALLOWED",errorMsg:"Mode not allowed"};e.setState(e.States[t]);return{success:true,mode:t}};p.prototype.isModeAllowed=function(t){switch(t){case this.ANALYSIS:return true;case this.EDIT:return this.inClient&&e.model.layout&&e.model.layout.permissions&&e.model.layout.permissions.update;case this.SNAPSHOT:return this.inClient}return false};p.prototype.gotoStory=function(t){var e=c(t,this.stories);if(e)return d(t);return{success:false,error:"NOSUCHSTORY",errorMsg:"No such story"}};return p}.apply(e,i),void 0!==a&&(t.exports=a))},849:function(t,e,n){"use strict";var i,a;!(i=[n(239)],a=function(t){function e(){this._options=null;this._appid=null;this._type=null;this._cols=null;return window.Reflect?window.Reflect.construct(HTMLElement,[],this.constructor):null}e.prototype=Object.create(HTMLElement.prototype);e.prototype.constructor=e;Object.setPrototypeOf(e,HTMLElement);e.prototype.connectedCallback=function(){i(this)};Object.defineProperty(e.prototype,"options",{get:function t(){return this._options},set:function t(e){this.setAttribute("options",e)}});e.observedAttributes=["options","appid","config"];e.prototype.attributeChangedCallback=function(t,e,s){if("options"===t&&this.vis){var r=JSON.parse(s);this.vis.setOptions(r)}else{a(this);"appid"!==t&&"config"!==t||n(this);i(this)}};e.prototype.disconnectedCallback=function(){a(this)};e.init=function(){window.customElements&&window.customElements.define&&customElements.define("qlik-visual",e)};return e;function n(e){var n=e.getAttribute("appid");if(n){var i=JSON.parse(e.getAttribute("config"));e.app=t.openApp(n,i)}else e.app=t.currApp()}function i(t){var e=t.getAttribute("visid"),i=JSON.parse(t.getAttribute("options"));t.app||n(t);if(t.app&&e)t.app.visualization.get(e).then(function(e){t.vis=e;i&&e.setOptions(i);e.show(t)});else if(t.app){var a=JSON.parse(t.getAttribute("cols")),s=t.getAttribute("type")||"barchart";t.app.visualization.create(s,a,i).then(function(e){t.vis=e;e.show(t)})}}function a(t){if(t.vis){t.vis.close();delete t.vis}}}.apply(e,i),void 0!==a&&(t.exports=a))},850:function(t,e){t.exports='<div class="qv-panel-subtoolbar qv-panel-current-selections" ng-class="{smallDevice: isSmallDevice, bright: brightCurSel, \'expand-smart-search-suggested-chart\': expandSmartSearchSuggestedChart}">\n\t<div ng-if="!isSmallDevice">\n\t\t<div class="qv-selections-pager" ng-class="{\'client-tab-navigation--bright\' : clientTabNavigation }">\n\t\t\t<div class="buttons borderbox border-bottom border-right" aria-hidden="true">\n\n\t\t\t\t<div tid="toggleGlobalSearchButton" tabindex="0" class="qv-subtoolbar-button toggle-button borderbox" ng-hide="hideSearch" ng-class="{active: isGlobalSearchActive, indexing: isGlobalSearchIndexing}" ng-click="toggleGlobalSearch()" q-title-translation="{{isGlobalSearchActive ? \'Tooltip.CloseGlobalSearch\' : \'Tooltip.GlobalSearch\'}}">\n\t\t\t\t\t<i class="lui-icon lui-icon--selection-search icon"></i>\n\t\t\t\t\t<div class="label" q-translation="GlobalSearch.Preparing" q-title-translation="GlobalSearch.Preparing.Tooltip"></div>\n\t\t\t\t\t<qv-progress-bar ng-if="isGlobalSearchIndexing" percent-done="indexPercentDone" on-completed="setSearchIndexingDone()" options="progressBarOptions"></qv-progress-bar>\n\t\t\t\t</div>\n\n\t\t\t\t<button class="qv-subtoolbar-button borderbox" ng-hide="hideUndoRedo" ng-click="back()" ng-disabled="disable.back" q-title-translation="Tooltip.NavigateBack" data-tid="current-selections-back">\n\t\t\t\t\t<i class="lui-icon lui-icon--selections-back"></i>\n\t\t\t\t</button>\n\n\t\t\t\t<button class="qv-subtoolbar-button borderbox" ng-hide="hideUndoRedo" ng-click="forward()" ng-disabled="disable.forward" q-title-translation="Tooltip.NavigateForward" data-tid="current-selections-forward">\n\t\t\t\t\t<i class="lui-icon lui-icon--selections-forward"></i>\n\t\t\t\t</button>\n\n\t\t\t\t<button id="clearselections" class="qv-subtoolbar-button borderbox" ng-disabled="disable.clear" ng-hide="hideClearSelections" ng-click="clearAllFields()" q-title-translation="Tooltip.ClearSelections" data-tid="current-selections-clear">\n\t\t\t\t\t<i class="lui-icon lui-icon--clear-selections"></i>\n\t\t\t\t</button>\n\n\t\t\t</div>\n\t\t\t<div class="selections-shadow" ng-if="showShadow"></div>\n\t\t\t<div class="wrap borderbox" style="height: 100%;" qv-pager qv-selection-pager>\n\t\t\t\t<ul class="list" ng-show="!isGlobalSelectionsActive || (items.length > 0 && currentSelectionDisabled) || (items.length > 0 && !isGlobalSelectionsActive)" qva-delegated-activate=".item#showPopover($event)" qva-outside-ignore-for="currentSelectionsItems">\n\t\t\t\t\t<li class="item" ng-class="{\'item-multi-state\': !item.isSingleState, \'multi-active\': multiPopoverFieldName && multiPopoverFieldName === item.qField, \'selection-insights-disabled\': currentSelectionDisabled}" ng-repeat="item in items track by item.qField" data-csid="{{item.qField}}" tabindex="0"\n\t\t\t\t\t ng-keydown="handleKeyDown($event, item)" aria-label="{{item.screenReaderLabel}}">\n\t\t\t\t\t\t<qv-current-selections-item ng-if="item.isSingleState" item="item" current-selection-disabled="currentSelectionDisabled"></qv-current-selections-item>\n\t\t\t\t\t\t<div ng-if="!item.isSingleState" class="current-selections-item" ng-mousemove="openTooltip($event, item)" ng-mouseleave="closeTooltip()">\n\t\t\t\t\t\t\t<div class="item-component label">\n\t\t\t\t\t\t\t\t<span ng-class="{ \'lui-icon lui-icon--lock\': item.qLocked }"></span><span class="name">{{item.name}}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="item-component count" title="">\n\t\t\t\t\t\t\t\t<span class="field-states-indicator">{{ item.states.length }}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="item-component caret">\n\t\t\t\t\t\t\t\t<span class="lui-icon lui-icon--arrow-down"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-if="currentSelectionDisabled" class="current-selections-disabled"></div>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\n\t\t\t\t<div ng-if="!items.length && !haveHiddenSelections" class="empty-text no-selection borderbox" q-translation="CurrentSelections.NoSelections"></div>\n\t\t\t\t<div ng-if="!items.length && haveHiddenSelections" class="empty-text no-selection borderbox" q-translation="CurrentSelections.OnlyHiddenSelections"></div>\n\t\t\t\t<a class="qv-pager-nav qv-pager-previous" ng-class="{inverted: brightCurSel}" ng-click="prevPage()" q-title-translation="Tooltip.Previous"><i class="lui-icon lui-icon--arrow-left"></i></a>\n\t\t\t\t<a class="qv-pager-nav qv-pager-next" ng-class="{inverted: brightCurSel}" ng-click="nextPage()" q-title-translation="Tooltip.Next"><i class="lui-icon lui-icon--arrow-right"></i></a>\n\t\t\t</div>\n\t\t\t<div class="buttons-end borderbox border-left">\n\t\t\t\t<div aria-hidden="true" class="qv-subtoolbar-button qv-explore-selections-btn toggle-button borderbox" tabindex="0" ng-class="{active: isGlobalSelectionsActive}" ng-hide="hideSelectionsTool" ng-click="toggleGlobalSelection($event)" q-title-translation="{{isGlobalSelectionsActive ? \'Tooltip.CloseGlobalSelector\' : \'Tooltip.GlobalSelector\'}}"\n\t\t\t\t tid="currentSelections.toggleGlobalSelections">\n\t\t\t\t\t<i class="lui-icon lui-icon--global-selector icon"></i>\n\t\t\t\t\t<span id="explore-selections-label" q-translation="CurrentSelections.ExploreSelectionsBtn"></span>\n\t\t\t\t</div>\n\n\t\t\t\t<div aria-labelledby="insights-label" tid="toggleCaoButton" id="toggle-insights" tabindex="0" class="qv-subtoolbar-button toggle-button borderbox qv-insight-toggle-button" ng-if="options && options.enableCao" ng-class="{active: isCaoActive, bright: brightCurSel}" ng-click="toggleCao()"\n\t\t\t\t q-title-translation="{{isCaoActive ? \'cao.CloseCognitiveAssociativeOverlay\' : \'cao.CognitiveAssociativeOverlay\'}}">\n\t\t\t\t\t<i class="lui-icon lui-icon--analyze icon" aria-hidden="true"></i>\n\t\t\t\t\t<span id="insights-label" q-translation="cao.CognitiveAssociativeOverlayToggleButton"></span>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\n\t\t</div>\n\t</div>\n\t<div ng-if="isSmallDevice && mobileIndicatorShow && !inSelection " ng-click="toggleGlobalSelection($event)" ng-class="{\'expand-smart-search-suggested-chart\': expandSmartSearchSuggestedChart}" class="qv-current-selections-mobile-wrapper" tid="currentSelections.toggleMobileSelections"\n\t q-title-translation="GlobalSelections.CurrentSelections">\n\t\t<div class="qv-current-selections-mobile-background">\n\t\t\t<p class="qv-current-selections-mobile-nbr" ng-class="{selections: nbrSelections > 0}">{{nbrSelections}}</p>\n\t\t</div>\n\t</div>\n</div>'},851:function(t,e){t.exports='<div qva-direction x-dir-setting={{options.direction}}" class="qv-tooltip qvt-generic-tooltip" ng-class="{\'above\':alwaysOnTop}">\n\t<div ng-repeat="item in content">\n\t\t<div qva-direction x-dir-text="{{item.header}}" x-dir-setting="{{options.direction}}" class="qv-tp-header">\n\t\t\t<strong>{{item.header}}</strong>\n\t\t</div>\n\t\t<table>\n\t\t\t<tr ng-repeat="row in item.rows" class="qv-tp-row">\n\t\t\t\t<td class=\'qv-tp-item\'>\n\t\t\t\t\t<div qva-direction x-dir-text="{{row.content}}" class="qv-tp-rowContent fade-out">{{row.content}}</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t</div>\n</div>'},852:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(184)],a=function(t,e,n){function i(i){var a={preventDefault:false,allowInInput:false};function s(){n.preventDefault();e.$rootScope.$apply()}function r(){i.inSelection&&t(document).trigger("qv-press");i.forward();s()}function o(){i.inSelection&&t(document).trigger("qv-press");i.back();s()}this.keyboardShortcutsGroup=n.createGroup("current-selection-"+i.app.id,1);this.keyboardShortcutsGroup.registerKeys("ctrl+shift+y",r,a);this.keyboardShortcutsGroup.registerKeys("ctrl+shift+z",o,a);this.keyboardShortcutsGroup.on();this.on=function(){if(!this._isOn){this.keyboardShortcutsGroup.on();this._isOn=true}};this.off=function(){if(this._isOn){this.keyboardShortcutsGroup.off();this._isOn=false}};this.delete=function(){this.keyboardShortcutsGroup.delete()}}return i}.apply(e,i),void 0!==a&&(t.exports=a))},853:function(t,e,n){"use strict";var i,a;!(i=[n(92)],a=function(t){var e=t.extend("CurrentSelectionsViewHelper",{init:function t(e,n,i,a,s,r){this.scope=e;this.responsiveState=n;this.globalSelectionService=i;this.exploreSelectionsService=a;this.globalSearchService=s;this.caoService=r},toggleGlobalSelection:function t(e){this.globalSelectionService.toggleGlobalSelection(e);this.responsiveState.isSmallDevice||this.globalSearchService.off();this.scope.isCaoActive=false;this.exploreSelectionsService.off();this.scope.isExploreSelectionsActive=false},toggleExploreSelection:function t(e){this.globalSelectionService.off();this.scope.isExploreSelectionsActive=this.exploreSelectionsService.toggleExploreSelection(e);this.globalSearchService.off();this.scope.isCaoActive=false},toggleGlobalSearch:function t(e){this.globalSearchService.toggleGlobalSearch(this.scope.app.enigmaModel,e,this.scope.options.objectSearch);this.scope.isCaoActive=false;this.globalSelectionService.off();this.exploreSelectionsService.off();this.scope.isExploreSelectionsActive=false},toggleCao:function t(e){this.scope.isCaoActive=this.caoService.toggleCao(e);this.globalSearchService.off();this.globalSelectionService.off();this.exploreSelectionsService.off();this.scope.isExploreSelectionsActive=false}});return e}.apply(e,i),void 0!==a&&(t.exports=a))},854:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(242)],a=function(t){t.widget("qv.pager",{options:{itemSelector:">li",orientation:"horizontal",pageSize:"auto",startPage:1,animationDuration:300},_create:function e(){var n=this.options;t.extend(this,{positionProperty:"horizontal"===n.orientation?"left":"top",sizeProperty:"horizontal"===n.orientation?"outerWidth":"outerHeight"});this.refresh();this.goToPage(n.startPage)},isItemInsidePage:function e(n){var i=t(n),a=i.position()[this.positionProperty]+i[this.sizeProperty](),s=Math.abs(parseFloat(i.parent().css("margin-"+this.positionProperty))),r=s+this.containerSize;return a>s&&a<r},calculatePageSize:function t(){return Math.floor(this.containerSize/this.calculateItemSize())},calculateItemSize:function t(){return this.element.find(this.options.itemSelector).eq(0)[this.sizeProperty]()},refresh:function t(){var e=this.currentPage||1;this.containerSize=this.element.parent()[this.sizeProperty]();this.pageSize="auto"===this.options.pageSize?this.calculatePageSize():this.options.pageSize;this.itemSize=this.calculateItemSize();this.maxPages=Math.ceil(this.element.find(this.options.itemSelector).length/this.pageSize||1);this.currentPage=Math.min(e,this.maxPages);this.goToPage(this.currentPage)},goToPage:function t(e){this.currentPage=Math.min(Math.max(1,e),this.maxPages);var n=(this.currentPage-1)*this.itemSize*this.pageSize,i={};i[this.positionProperty]=-n+"px";this.element.stop(true).animate(i,this.options.animationDuration)},goToPreviousPage:function t(){this.goToPage(this.currentPage-1)},goToNextPage:function t(){this.goToPage(this.currentPage+1)},goToPageContaining:function t(e){var n=Math.ceil(this.element.find(e).index()+1/this.pageSize);this.goToPage(n)},_destroy:function t(){this.element.off(this.eventNamespace)}});return t}.apply(e,i),void 0!==a&&(t.exports=a))},855:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(10),n(48),n(856),n(94),n(140),n(103),n(168),n(155),n(49),n(89),n(176)],a=function(t,e,n,i,a,s){n.service("qvExploreSelectionsService",["$document","qvSelectionToolbarService",function(n,r){var o,l;var c=300;function u(){return{$container:void 0,$containerId:".qv-explore-selections-container",getComponent:function t(){return i},setup:function t(){s.get().then(function(t){a.StateChanged.bind(d.bind(null,d));t.enigmaModel.isInModalSelection()&&r.confirm()})},destroy:function t(){a.StateChanged.unbind(d)}}}function d(){(a.isInEditMode()||!a.isInAnalysisMode||a.inObjectView())&&f()}function p(i){a.setState(a.States.analysis);l.$container=e.element("<div>");i=i||n;i.find(l.$containerId).append(l.$container);l.$container.showComponent(l.getComponent());l.setup();t(".qv-explore-selections").slideDown(c)}function h(){return!(!l||void 0===l.$container)}function f(){if(!l)return;t(".qv-explore-selections").slideUp(c,function(){if(l.$container){l.$container.remove();l.$container=void 0}l.destroy()})}o={toggleExploreSelection:function t(e){l||(l=new u);if(h()){f();return false}p(e);return true},off:function t(){f()}};return o}])}.apply(e,i),void 0!==a&&(t.exports=a))},856:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(857),n(858)],a=function(t,e){var n=["$scope",function(t){t.showFullModel=false;t.$on("$destroy",function(){})}];t.directive("qvExploreSelectionsComponent",function(){return{restrict:"E",template:e,controller:n,scope:true,replace:true,link:function t(e){e.target=null}}});return"<qv-explore-selections-component></qv-explore-selections-component>"}.apply(e,i),void 0!==a&&(t.exports=a))},857:function(t,e){t.exports='<div class="qv-explore-selections overlay" id="qv-explore-selections-overlay" style="display:none;">\n\t<qv-selection-insights full="showFullModel"></qv-selection-insights>\n</div>'},858:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(284),n(859),n(860),n(93),n(234),n(95),n(91),n(106),n(103),n(220),n(861),n(863),n(867)],a=function(t,e,n,i,a,s,r,o,l,c){var u={NO_SELECTIONS:0,GENERATE_INSIGHTS:1,INSIGHTS_FOUND:2,NO_INSIGHTS:3,UNSUPPORTED:4};var d={restrict:"E",bindings:{showFields:"<"},template:n,controller:["$scope","$timeout","qvSelectionInsightsService",function(n,d,p){var h=this;var f=null;this.showLoading=true;this.insights=[];this.activeCard=1e3;this.showInsightDetails=false;this.selectedInsight=null;this.hasSelection=false;this.measure="";this.newMeasureChosen=false;this.newSelection=false;this.isRefreshing=false;this.app=null;this.layout=null;this.selectionInsightsState=u.NO_SELECTIONS;this.states=u;this.measureError=false;this.loadingCards=false;this.cardIsInsight=true;this.selectionContribution="";this.isOneAndOnlyOneField=null;this.showing={table:false,excluded:false};this.$onInit=function(){g().then(function(t){if(t)a.getApp().then(function(t){h.app=t;t.enigmaModel.getCurrentSelectionObject().then(function(t){n.currentSelModel=t;l(n,"currentSelModel",function(){v()})});b(t);c.trackEvent(c.customEvents.EXPLORE_SELECTIONS_OPENED,{type:"clicked"})});else{m();h.showLoading=false}})};function g(){return p.getInsightDimensions(h.showFields).then(function(){return true}).catch(function(){return false})}this.generateInsights=function(){h.showLoading=true;h.newMeasureChosen=false;h.newSelection=false;y();c.trackEvent(c.customEvents.ASSOCIATIVE_INSIGHTS_GENERATED,{type:"clicked"})};function v(){if(h.selectionInsightsState!=u.UNSUPPORTED){h.hasSelection=n.currentSelModel.layout.qSelectionObject.qSelections.length>0;h.showLoading=false;h.isOneAndOnlyOneField=p.isOneAndOnlyOne(n.currentSelModel.layout);if(h.isOneAndOnlyOneField.isOneAndOnlyOne){h.selectionInsightsState=u.UNSUPPORTED;h.errorMsg=o.get("ExploreSelections.SingleSelectField",[h.isOneAndOnlyOneField.items])}else h.hasSelection||(h.selectionInsightsState=u.NO_SELECTIONS);h.hasSelection&&h.selectionInsightsState===u.NO_SELECTIONS&&(h.selectionInsightsState=u.GENERATE_INSIGHTS);h.layout=n.currentSelModel.layout;r.publish("selection/insights/current-selection",n.currentSelModel.layout)}}this.$onChanges=function(t){void 0===t.showFields||t.showFields.isFirstChange()||h.selectionInsightsState===u.NO_INSIGHTS&&(h.selectionInsightsState=u.GENERATE_INSIGHTS)};function m(){h.selectionInsightsState=u.UNSUPPORTED;h.errorMsg=o.get("ExploreSelections.NoSelectionInsights")}function b(t){return t.getCurrentSelectionObject().then(function(t){t.layoutSubscribe(function(){if(h.selectionInsightsState!=u.UNSUPPORTED){h.showInsightDetails=false;if(!h.newMeasureChosen){h.isRefreshing=true;r.publish("selection/insights/selection/changed")}if(h.selectionInsightsState!==u.NO_SELECTIONS&&h.selectionInsightsState!==u.NO_INSIGHTS){h.newSelection=true;h.newMeasureChosen=false}else h.selectionInsightsState===u.NO_INSIGHTS&&(h.selectionInsightsState=u.GENERATE_INSIGHTS)}c.trackEvent(c.customEvents.NEW_SELECTION_MADE,{type:"clicked"})})})}function y(){h.insights=[];return p.getInsightDimensions(h.showFields).then(function(t){r.publish("selection/insights/refreshed");h.showLoading=false;h.selectionInsightsState=u.INSIGHTS_FOUND;if(0!==t.insights.length){h.measure=t.insights[0].measure;h.loadingCards=true;S(t.insights)}else{r.publish("selection/insights/updated");t.measure?h.measure=t.measure:h.selectionInsightsState=u.NO_INSIGHTS}h.isRefreshing=false}).catch(function(){h.showLoading=false;m()})}function S(e){var n=t.getService("$q");function i(t){var a=e[t];if(!a)return n.resolve(true);return p.getInsightSummary(a.dimension,h.app).then(function(t){h.measureError="NaN"==t.summary;a.summaryNaN=h.measureError;a.summaryString=t.summary;if(t.show){h.insights.push(a);r.publish("selection/insight/draw",{insight:a,index:h.insights.length-1})}}).catch(function(){a.summaryError=true;h.insights.push(a)}).then(function(){t+=1;if(t<e.length)return i(t);h.loadingCards=false;r.publish("selection/insights/updated");return true})}return i(0)}this.openCardSummaryDialog=function(){f=t.getService("luiDialog").show({template:i,input:{title:"SelectionInsights.SummarySelection.HelpTitle",html:i,closeDialog:function t(){f.close();f=null}}})};this.backToSelections=function(){h.showInsightDetails=false;h.newMeasureChosen=false;r.publish("selections/insights/details/close")};this.closeInsights=function(){h.showInsightDetails=false;h.newMeasureChosen=false;p.clearInsights();r.publish("selection/insights/close")};this.openCard=function(t){r.publish("selections/insights/details/close");if(t>=0)h.newMeasureChosen||h.isRefreshing||h.insights[t].summaryNaN||!h.insights[t].show||d(function(){if(h.activeCard==t)h.closeCard();else{r.publish("selections/insights/details/open");h.activeCard=t;t=t>0?t:0;var n=p.getInsightDetails(h.insights[t].dimension,h.app);n.isMeasureNegative=n.includedMeasure.qNumber<0||n.excludedMeasure.qNumber<0;h.showInsightDetails=true;h.cardIsInsight=true;h.insights[t]=n;h.selectedInsight=h.insights[t];p.getTableVis(h.selectedInsight,h.showing.excluded).then(function(t){h.selectedInsight.table=t});n.isMeasureNegative?r.publish("selection/insights/details/negative",h.selectedInsight):r.publish("selection/insights/details/updated",{measure:h.selectedInsight.measure,aggr:h.selectedInsight.measureAggregation,dimension:h.selectedInsight.dimension,contribution:h.selectedInsight.selectedMeasure.selected.percentage.toFixed(1)});var i=e.openApp(h.app.qDocId);i.visualization.create("listbox",[h.selectedInsight.dimension],{showTitles:true,title:h.selectedInsight.dimension}).then(function(t){h.listbox=t.model.enigmaModel;I()})}});else if(!h.newMeasureChosen&&!h.isRefreshing)if(h.activeCard==t&&h.showInsightDetails)h.closeCard();else{h.activeCard=t;var n=p.getInsightDetails(h.insights[0].dimension,h.app);h.showInsightDetails=true;h.cardIsInsight=false;n.isSelectionNegative=n.selectedMeasure.selected.percentage<0||n.selectedMeasure.excluded.percentage<0;h.insights[0]=n;h.selectedInsight=h.insights[0];r.publish("selection/insights/current/open",{insight:h.selectedInsight});r.publish("selections/insights/details/open")}c.trackEvent(c.customEvents.ASSOCIATIVE_INSIGHTS_CARD_CLICKED,{type:"clicked"})};this.closeCard=function(){h.showInsightDetails=!h.showInsightDetails;h.cardIsInsight=true;h.activeCard=null};r.subscribe("selection/insights/details/close",function(){h.showInsightDetails=false});r.subscribe("selection/insights/new",function(t){h.isRefreshing=false;h.insights=[];h.activeCard=1e3;if(0===t.insights.length){h.measureError=false;r.publish("selection/insights/updated")}else{h.loadingCards=true;S(t.insights)}t.measure&&(h.measure=t.measure);h.showInsightDetails=false});r.subscribe("selection/insights/error",m);function I(){s.selectAll(".gwBar g").remove();var t=s.select(".gwBar svg");var e=t.append("g");var n=h.selectedInsight.counts.excluded/(h.selectedInsight.counts.excluded+h.selectedInsight.counts.included)*100/100*427;var i=h.selectedInsight.counts.included/(h.selectedInsight.counts.excluded+h.selectedInsight.counts.included)*100/100*427;e.append("rect").style("fill","#A9A9A9").attr("width",35).attr("height",Math.ceil(n)).attr("y",Math.ceil(i)).attr("x",0);e.append("rect").style("fill","white").attr("width",35).attr("height",Math.ceil(i)).attr("y",0).attr("x",0);var a=[];a.push([{x:35,y:Math.ceil(i)+Math.ceil(n)/2},{x:65,y:322}]);a.push([{x:65,y:322},{x:95,y:322}]);a.push([{x:35,y:Math.ceil(i)/2},{x:65,y:107}]);a.push([{x:65,y:107},{x:95,y:107}]);var r=s.svg.line().x(function(t){return t.x}).y(function(t){return t.y});var o=t.append("g").attr("class","lines");o.selectAll("path").data(a).enter().append("path").attr({d:r,"stroke-dasharray":"790 790","stroke-dashoffset":0}).style("stroke",function(t,e){return e>1?"white":"#A9A9A9"}).style("stroke-width","2").attr("opacity",1)}this.$onDestroy=function(){r.unsubscribe("selection/insights/show");r.unsubscribe("selection/insights/new");r.unsubscribe("selection/insights/error")}}]};t.nativeComponent("qvSelectionInsights",d)}.apply(e,i),void 0!==a&&(t.exports=a))},859:function(t,e){t.exports='<div class="qv-selections-insights-container">\n\t\x3c!-- Insights found --\x3e\n\t<div class="qv-selections-insights-header">\n\t\t<h2\n\t\t\tq-translation="SelectionInsights.AssociativeInsights"\n\t\t\tclass="qv-selections-insights-title"\n\t\t></h2>\n\t\t<span\n\t\t\tclass="lui-icon lui-icon--help lui-icon--small"\n\t\t\tng-click="$ctrl.openCardSummaryDialog()"\n\t\t></span>\n\t\t<div class="qv-insight-summary-close">\n\t\t\t<span\n\t\t\t\tclass="lui-icon lui-icon--close"\n\t\t\t\tng-click="$ctrl.closeInsights()"\n\t\t\t></span>\n\t\t</div>\n\t\t<qv-selection-insights-summary\n\t\t\tng-if="!$ctrl.showLoading && $ctrl.selectionInsightsState === $ctrl.states.INSIGHTS_FOUND"\n\t\t\tstates="$ctrl.states"\n\t\t\tselection-insights-state="$ctrl.selectionInsightsState"\n\t\t\tnew-measure-chosen="$ctrl.newMeasureChosen"\n\t\t\tnew-selection="$ctrl.newSelection"\n\t\t\tmeasure="$ctrl.measure"\n\t\t\tshow-loading="$ctrl.showLoading"\n\t\t\thas-selection="$ctrl.hasSelection"\n\t\t\tshow-fields="$ctrl.showFields"\n\t\t\tmeasure-error="$ctrl.measureError"\n\t\t\tselected-insight="$ctrl.selectedInsight"\n\t\t></qv-selection-insights-summary>\n\t</div>\n\t<qv-selection-insights-card-container\n\t\tng-show="!$ctrl.showLoading && $ctrl.selectionInsightsState === $ctrl.states.INSIGHTS_FOUND"\n\t\tnew-measure-chosen="$ctrl.newMeasureChosen"\n\t\tnew-selection="$ctrl.newSelection"\n\t\tmeasure="$ctrl.measure"\n\t\tshow-loading="$ctrl.showLoading"\n\t\tinsights="$ctrl.insights"\n\t\topen-card="$ctrl.openCard"\n\t\tactive-card="$ctrl.activeCard"\n\t\tclass="qv-selection-insights-card-container"\n\t\tshow-fields="$ctrl.showFields"\n\t\tloading-cards="$ctrl.loadingCards"\n\t\tcard-is-insight="$ctrl.cardIsInsight"\n\t></qv-selection-insights-card-container>\n\t\x3c!-- LOADING --\x3e\n\t<div class="qv-selections-insights-loading" ng-if="$ctrl.showLoading">\n\t\t<div class="spinner-container">\n\t\t\t<qv-spinner\n\t\t\t\tshow="$ctrl.showLoading"\n\t\t\t\tcenter-in-parent="true"\n\t\t\t></qv-spinner>\n\t\t</div>\n\t\t<div\n\t\t\tclass="loading-message"\n\t\t\tq-translation="SelectionInsights.Loading"\n\t\t></div>\n\t</div>\n\n\t\x3c!-- No selection has been made --\x3e\n\t<div\n\t\tclass="qv-selections-no-insights"\n\t\tng-if="!$ctrl.showLoading && $ctrl.selectionInsightsState === $ctrl.states.NO_SELECTIONS"\n\t>\n\t\t<div class="no-insights-icon"></div>\n\t\t<p\n\t\t\tclass="qv-selections-insights--p"\n\t\t\tq-translation="ExploreSelections.NoInsights"\n\t\t></p>\n\t</div>\n\n\t\x3c!-- AI is not supported for this app --\x3e\n\t<div\n\t\tclass="qv-selections-no-insights"\n\t\tng-if="!$ctrl.showLoading && $ctrl.selectionInsightsState === $ctrl.states.UNSUPPORTED"\n\t>\n\t\t<div class="no-insights-icon"></div>\n\t\t<p class="qv-selections-insights--p" ng-bind-html="$ctrl.errorMsg"></p>\n\t</div>\n\n\t\x3c!--\n\t\tUser opened the selection insights panel for the first time after making selections\n\t--\x3e\n\t<div\n\t\tclass="qv-selections-generate-insights qv-selections-no-insights"\n\t\tng-if="!$ctrl.showLoading && $ctrl.selectionInsightsState === $ctrl.states.GENERATE_INSIGHTS"\n\t>\n\t\t<div class="no-insights-icon"></div>\n\t\t<p\n\t\t\tq-translation="ExploreSelections.GenerateInsights"\n\t\t\tclass="qv-selections-insights--p"\n\t\t></p>\n\t\t<button\n\t\t\ttid="explore-selections-generate-insight-button"\n\t\t\tclass="lui-button lui-button--success"\n\t\t\tq-translation="ExploreSelections.GenerateInsights.Button"\n\t\t\tng-click="$ctrl.generateInsights()"\n\t\t></button>\n\t</div>\n\n\t\x3c!-- User has made a selection but no insights were found --\x3e\n\t<div\n\t\tclass="qv-selections-no-insights"\n\t\tng-if="!$ctrl.showLoading && $ctrl.selectionInsightsState === $ctrl.states.NO_INSIGHTS"\n\t>\n\t\t<div class="no-insights-icon"></div>\n\t\t<p\n\t\t\tclass="qv-selections-insights--p"\n\t\t\tq-translation="ExploreSelections.NoInsightsWithSelection.Paragraph1"\n\t\t></p>\n\t\t\x3c!--\n\t\t\tIf show fields checkbox is unchecked, we tell them to check it since they got no master item insights\n\t\t--\x3e\n\t\t<div\n\t\t\tng-if="!$ctrl.showFields"\n\t\t\tclass="select-fields"\n\t\t\tq-translation="ExploreSelections.NoInsightsWithSelection.Paragraph3"\n\t\t></div>\n\t</div>\n\n\t\x3c!-- Insights details --\x3e\n\t<qv-selection-insights-details\n\t\tng-show="$ctrl.selectionInsightsState === $ctrl.states.INSIGHTS_FOUND"\n\t\tshow-insight-details="$ctrl.showInsightDetails"\n\t\tselected-insight="$ctrl.selectedInsight"\n\t\tlistbox="$ctrl.listbox"\n\t\tcard-is-insight="$ctrl.cardIsInsight"\n\t\tback-to-selections="$ctrl.backToSelections()"\n\t\tlayout="$ctrl.layout"\n\t\tshowing="$ctrl.showing"\n\t></qv-selection-insights-details>\n</div>\n'},860:function(t,e){t.exports='<lui-dialog class="selection-insights-dialog" x-variant="{{::variant}}">\n\t<lui-dialog-header>\n\t\t<lui-dialog-title\n\t\t\tq-translation="SelectionInsights.SummarySelection.HelpTitle"\n\t\t></lui-dialog-title>\n\t</lui-dialog-header>\n\t<lui-dialog-body class="q-modal-loading">\n\t\t<p q-translation="SelectionInsights.SummarySelection.HelpText"></p>\n\t</lui-dialog-body>\n\t<lui-dialog-footer>\n\t\t<button\n\t\t\tclass="lui-button close-button"\n\t\t\tng-click="closeDialog();"\n\t\t\tq-translation="Common.Close"\n\t\t\ttid="selection-insights-dialog-help-button"\n\t\t></button>\n\t</lui-dialog-footer>\n</lui-dialog>\n'},861:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(862),n(234),n(95),n(220)],a=function(t,e,n,i){t.nativeComponent("qvSelectionInsightsCardContainer",{bindings:{showLoading:"<",insights:"=",openCard:"<",activeCard:"<",newMeasureChosen:"=",newSelection:"=",showFields:"<",loadingCards:"<",measure:"<",selectedInsight:"=",cardIsInsight:"<"},controller:["$timeout","qvSelectionInsightsService",function(t,e){var a=this;this.showLoading=true;this.insights=[];this.refreshActive=false;this.isRefreshing=false;this.hasInsights=true;this.itemString="";this.selectionContribution="";this.$onInit=function(){n.selectAll(".insight-bar-container svg").remove()};function s(){if(a.insights.length>0){var t=e.getInsightDetails(a.insights[0].dimension,a.app).selectedMeasure.selected.percentage/100;a.selectionContribution=a.getLocalizedPercentage(t)}}i.subscribe("selection/insights/updated",function(){t(function(){a.hasInsights=a.insights.length>0;s()})});i.subscribe("selection/insight/draw",function(e){t(function(){n.select("#insightCard"+e.index+" .insight-bar-container svg").remove();o(e.insight,e.index)})});i.subscribe("selection/insights/refresh",function(){a.isRefreshing=true});i.subscribe("selection/insights/refreshed",function(){a.isRefreshing=false;a.refreshActive=false});i.subscribe("selection/insights/new",function(){a.isRefreshing=false;a.refreshActive=false});i.subscribe("selection/insights/measure/cancel",function(){a.refreshActive=false});i.subscribe("selection/insights/fields/change",function(){a.refreshActive=true});i.subscribe("selection/insights/selection/changed",function(){a.refreshActive=true});i.subscribe("selection/insights/current-selection",function(t){r(e.getSelectionItems(t))});function r(t){if(t){a.itemString="";t.forEach(function(e,n){t.length-1===n?a.itemString+=e.name:a.itemString+=e.name+", "})}}this.getLocalizedPercentage=function(t){return e.getLocalizedPercentage(t)};this.getMeasurePercentage=function(t){var e=t.counts.excluded+t.counts.included;var n=t.counts.excluded<t.counts.included?t.counts.excluded:t.counts.included;var i=n/e*100;var s=Math.round(10*i)/100;s=a.getLocalizedPercentage(s/10);return s};function o(t,e){var i=n.select("#insightCard"+e+" .insight-bar-container").append("svg").attr("width",44).attr("height",125);var a=i.append("g");var s=t.counts.excluded/(t.counts.excluded+t.counts.included)*100/100*124;var r=t.counts.included/(t.counts.excluded+t.counts.included)*100/100*124;a.append("rect").style("fill","#A9A9A9").attr("width",12).attr("height",Math.ceil(s)).attr("y",Math.ceil(r)).attr("x",0);a.append("rect").style("fill","white").style("stroke-width",1).style("stroke","#E6E6E6").attr("width",12).attr("height",Math.ceil(r)).attr("y",0).attr("x",0);var o=[];var l=Math.ceil(r)+Math.ceil(s)/2;o.push([{x:12,y:l},{x:28,y:38}]);var c=n.svg.line().x(function(t){return t.x}).y(function(t){return t.y});var u=i.append("g").attr("class","lines");u.selectAll("path").data(o).enter().append("path").attr({d:c,"stroke-dasharray":"790 790","stroke-dashoffset":0}).style("stroke",function(t,e){return e>1?"white":"#A9A9A9"}).style("stroke-width","1").attr("opacity",1)}this.$onDestroy=function(){i.unsubscribe("selection/insights/updated");i.unsubscribe("selection/insights/fields/change");i.unsubscribe("selection/insights/measure/cancel");i.unsubscribe("selection/insights/selection/changed");i.unsubscribe("selection/insights/refresh");i.unsubscribe("selection/insights/new");i.unsubscribe("selection/insights/refreshed");i.unsubscribe("selection/insight/draw");i.unsubscribe("selection/insights/current-selection")}}],template:e})}.apply(e,i),void 0!==a&&(t.exports=a))},862:function(t,e){t.exports='<div tid="selection-insights-card-container" class="qv-selections-insights-cards-container" ng-show="!$ctrl.isRefreshing && $ctrl.hasInsights">\n\t<div ng-show="!$ctrl.showLoading" class="qv-selections-empty-cards">\n\t\t<div tid="current-selections-card" class="card selection-insights-card selection-insights-card--current-selection" ng-class="{\'active\': $ctrl.activeCard === -1 && !$ctrl.cardIsInsight}" ng-click="$ctrl.openCard(-1)" tabindex="0"> \n\t\t\t<div tid="no-longer-valid-overlay" class="no-longer-valid-overlay" ng-if="$ctrl.refreshActive">\n\t\t\t\t<div class="gray-overlay"></div>\n\t\t\t\t<span class="no-longer-valid-text" q-translation="SelectionInsights.Refresh.NoLongerValid"></span>\n\t\t\t</div>\n\t\t\t<div class="insight-card-content selection-insights-card--current-selection-content">\n\t\t\t\t<div class="insight-card-body">\n\t\t\t\t\t<div class="insight-dimension-title">\n\t\t\t\t\t\t<div class="insight-dimension-name" title="{{$ctrl.itemString}}">{{$ctrl.itemString}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="insight-card-body-your-selections" q-translation="SelectionInsights.CardSummaryYourSelections" q-title-translation="SelectionInsights.CardSummaryYourSelections"></div>\n\t\t\t\t\t<div class="insight-card-body-account" q-translation="SelectionInsights.CardSummaryAccountFor"></div>\n\t\t\t\t\t<div class="insight-measure-title">\n\t\t\t\t\t\t<div class="insight-current-selection-value" ng-show="$ctrl.selectionContribution">\n\t\t\t\t\t\t\t{{ $ctrl.selectionContribution }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="insight-measure-name" title="">\n\t\t\t\t\t\t\t{{ $ctrl.measure }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="selection-insights--other-fields" q-translation="SelectionInsights.FoundOtherFields"></div>\n\t\t<div tid="selection-insights-card" ng-repeat="insight in $ctrl.insights track by $index" id="insightCard{{ $index }}" class="card selection-insights-card insight-card" ng-class="{\'active\': $ctrl.activeCard === $index && $ctrl.cardIsInsight, \'disabled\': $ctrl.refreshActive || !insight.show, \'inactive\': insight.summaryNaN }"\n\t\t ng-click="$ctrl.openCard($index)" tabindex="0">\n\t\t\t<div tid="no-longer-valid-overlay" class="no-longer-valid-overlay" ng-if="$ctrl.refreshActive">\n\t\t\t\t<div class="gray-overlay"></div>\n\t\t\t\t<span class="no-longer-valid-text" q-translation="SelectionInsights.Refresh.NoLongerValid"></span>\n\t\t\t</div>\n\t\t\t<div class="insight-bar-container"></div>\n\t\t\t<div class="insight-card-content">\n\t\t\t\t<div class="insight-card-body">\n\t\t\t\t\t<div class="insight-dimension-title">\n\t\t\t\t\t\t<div class="insight-dimension-name" title="{{ insight.dimension }}">\n\t\t\t\t\t\t\t{{ insight.dimension }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div tid="insight-counts-summary" class="insight-card-body-your-selections" title="{{insight.counts.summary}}">{{insight.counts.summary}}</div>\n\t\t\t\t\t<div class="insight-card-body-account" q-translation="SelectionInsights.CardSummaryAccountFor"></div>\n\t\t\t\t\t<div class="insight-measure-title" ng-if="!insight.summaryError && !insight.summaryNaN && insight.show">\n\t\t\t\t\t\t<div class="insight-measure-value">\n\t\t\t\t\t\t\t{{ insight.summaryString }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="insight-measure-name" title="{{ insight.measure }}">\n\t\t\t\t\t\t\t{{ insight.measure }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="insight-measure-title" ng-if="insight.summaryError">\n\t\t\t\t\t\t<span class="timeout-error" q-translation="SelectionInsights.ErrorTimeout"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="insight-measure-title" ng-if="!insight.show && !insight.summaryNaN && !insight.summaryError">\n\t\t\t\t\t\t<span tid="selection-insight-error-calculation" class="timeout-error" q-translation="SelectionInsights.ErrorCalculations"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="insight-measure-title" ng-if="insight.summaryNaN">\n\t\t\t\t\t\t<span class="invalid-error" q-translation="SelectionInsights.InvalidMeasure"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div ng-if="$ctrl.showLoading" class="qv-selections-empty-cards">\n\t\t\t\t<div class="empty card"></div>\n\t\t\t\t<div class="empty card"></div>\n\t\t\t\t<div class="empty card"></div>\n\t\t\t\t<div class="empty card"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div id="cardLoading" class="card loading-card selection-insights-card inactive" ng-if="$ctrl.loadingCards">\n\t\t\t<div class="insight-bar-container">\n\t\t\t\t<div class="loading-line bar"></div>\n\t\t\t</div>\n\t\t\t<div class="insight-card-content">\n\t\t\t\t<div class="insight-card-body">\n\t\t\t\t\t<div class="loading-line title"></div>\n\t\t\t\t\t<div class="loading-line count"></div>\n\t\t\t\t\t<div class="loading-line contribution"></div>\n\t\t\t\t\t<div class="measure-container">\n\t\t\t\t\t\t<div class="loading-line percent"></div>\n\t\t\t\t\t\t<div class="loading-line measure"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n\n\x3c!-- LOADING --\x3e\n<div class="qv-selections-insights-loading" ng-if="$ctrl.isRefreshing">\n\t<div class="spinner-container">\n\t\t<qv-spinner show="$ctrl.isRefreshing" center-in-parent="true"></qv-spinner>\n\t</div>\n\t<div class="loading-message" q-translation="SelectionInsights.Loading"></div>\n</div>\n\n\x3c!-- NO INSIGHTS FOUND --\x3e\n<div class="qv-selections-no-insights" ng-show="!$ctrl.isRefreshing && !$ctrl.hasInsights">\n\t<div class="no-insights-icon"></div>\n\t<p class="qv-selections-insights--p" q-translation="ExploreSelections.NoInsightsWithSelection.Paragraph1"></p>\n\t<div ng-if="!$ctrl.showFields" class="select-fields" q-translation="ExploreSelections.NoInsightsWithSelection.Paragraph3"></div>\n</div>'},863:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(864),n(284),n(95),n(91),n(234),n(103),n(93),n(865),n(220)],a=function(t,e,n,i,a,s,r,o){t.nativeComponent("qvSelectionInsightsDetails",{bindings:{showInsightDetails:"<",selectedInsight:"<",listbox:"<",layout:"<",cardIsInsight:"<",backToSelections:"&",showing:"="},controller:["$timeout","qvSelectionInsightsService",function(t,e){var l=this;this.detailsTitle="";this.measure="";this.selectionHelp="";this.refreshActive=false;this.selectionInsightsMeasureBarTitle="";this.hasLockedSelections=false;this.selectionsBarTotal="";this.options={isReadonly:true,isPopover:false,selections:false,showSearch:true};this.showExcludedValues=false;this.celloptions={selections:false};l.selectionInsightsMeasureBarTitle=function(){if(l.selectedInsight&&l.selectedInsight.measureAggregation)return a.get("SelectionInsights.MeasureBarTitle",[l.selectedInsight.measureAggregation[0].toUpperCase()+l.selectedInsight.measureAggregation.slice(1),l.selectedInsight.measure])};l.selectionsBarTotal=function(){if(l.selectedInsight&&l.selectedInsight.selectedMeasure.total)return a.get("SelectionInsights.SelectionsBarTotal",[l.selectedInsight.selectedMeasure.total])};l.countBarTotal=function(){if(l.selectedInsight&&l.selectedInsight.counts.excluded&&l.selectedInsight.counts.included)return a.get("SelectionInsights.CountBarTotal",[l.selectedInsight.counts.excluded+l.selectedInsight.counts.included])};i.subscribe("selection/insights/details/negative",function(t){l.showExcludedValues=false;l.measure=t.measure;l.detailsTitle=a.get("SelectionInsights.DimensionContributionsTitle",["<strong>"+t.dimension+"</strong>","<strong>"+t.measure+"</strong>"]);l.selectionHelp=a.get("SelectionInsights.SelectionHelp","<strong>"+t.dimension+"</strong>");c(t)});i.subscribe("selection/insights/details/updated",function(t){l.showExcludedValues=false;l.measure=t.measure;l.hasLockedSelections=e.isHasLockedSelections(l.layout);l.detailsTitle=a.get("SelectionInsights.DimensionContributionsTitle",["<strong>"+t.dimension+"</strong>","<strong>"+t.measure+"</strong>"]);l.selectionHelp=a.get(l.hasLockedSelections?"SelectionInsights.SelectionHelpWithLockedSelections":"SelectionInsights.SelectionHelp","<strong>"+t.dimension+"</strong>");d()});i.subscribe("selection/insights/measure/cancel",function(){l.refreshActive=false});i.subscribe("selection/insights/fields/change",function(){l.refreshActive=true});i.subscribe("selection/insights/updated",function(){l.refreshActive=false});function c(t){s.selectAll(".bars-container svg").remove();var e=[{name:"excluded",value:t.counts.excluded,label:t.counts.excluded},{name:"included",value:t.counts.included,label:t.counts.included}];u(e,"value");var n=[{name:"excluded",value:t.excludedMeasure.qNumber,label:t.measureBreakdown.excluded.num},{name:"included",value:t.includedMeasure.qNumber,label:t.measureBreakdown.included.num}];u(n,"measure")}function u(t,e){var n=431;var i=120;var a=10;var r="";var o=45;var l=30;r="value"==e?" .val-dist":" .measure-dist";var c=s.select(".negative-chart"+r).append("svg").attr("width",i+o).attr("height",n+o);var u=c.append("g").attr("transform","translate("+a/2+",1)");var d=s.scale.ordinal().rangeRoundBands([0,i]);var p=s.scale.linear().range([n,0]);d.domain(t.map(function(t){return t.name}));"value"==e?p.domain([0,s.max(t,function(t){return t.value})]):p.domain(s.extent(t,function(t){return t.value}));var h=u.append("defs");h.append("filter").attr("id","blur").append("feGaussianBlur").attr("stdDeviation",5);if("value"==e){u.selectAll("bar").data(t).enter().append("rect").style("fill","rgba(0,0,0,0.1)").attr("x",function(t){return d(t.name)}).attr("width",d.rangeBand()).attr("y",function(t){return p(t.value)}).attr("height",function(t){return n-p(t.value)}).attr("filter","url(#blur)").attr("rx",3).attr("ry",3);u.selectAll("bar").data(t).enter().append("rect").style("fill",function(t){return"value"==e?"excluded"==t.name?"#A7A7A7":"#FFFFFF":"excluded"==t.name?"blue":"#FFFFFF"}).style("stroke",function(t){return"excluded"==t.name?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.27)"}).attr("x",function(t){return d(t.name)}).attr("width",d.rangeBand()).attr("y",function(t){return t.value>0?p(t.value):p(0)}).attr("height",function(t){return"value"==e?n-p(t.value):Math.abs(p(t.value)-p(0))}).attr("rx",3).attr("ry",3);u.selectAll("bar").data(t).enter().append("rect").style("fill",function(t){return"excluded"==t.name?"#A7A7A7":"#FFFFFF"}).attr("x",function(t){return d(t.name)}).attr("width",d.rangeBand()).attr("y",n-3).attr("height",3);var f=c.append("g").attr("class","barLabels").attr("transform","translate("+a/2+",0)");t.forEach(function(t,e){u.append("line").style("stroke","excluded"==t.name?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.27)").attr("x1",d(t.name)).attr("y1",n).attr("x2",d(t.name)).attr("y2",n-3);e>0&&u.append("line").style("stroke","excluded"==t.name?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.27)").attr("x1",d(t.name)+60).attr("y1",n).attr("x2",d(t.name)+60).attr("y2",n-3);var i=f.append("g");i.append("rect").attr("x",function(){return d(t.name)}).attr("width",d.rangeBand()).attr("height",2).attr("y",function(){return p(t.value)}).attr("opacity",0);i.append("text").attr("x",d(t.name)+l).attr("y",function(){return n-p(t.value)>n-l?p(t.value)+30:p(t.value)-10}).attr("text-anchor","middle").attr("class","grouped-bar-value-label").text(t.label).attr("fill",function(){var e="#404040";"excluded"==t.name&&n-p(t.value)>n-l&&(e="white");return e})})}else{h.append("pattern").attr("id","diagonalStripes").attr("patternUnits","userSpaceOnUse").attr("width",8).attr("height",8).attr("patternTransform","rotate(45)").append("rect").attr("width","2").attr("height","8").attr("fill","#4842b5");u.selectAll("bar").data(t).enter().append("rect").style("fill","rgba(0,0,0,0.1)").attr("x",function(t){return d(t.name)}).attr("width",d.rangeBand()).attr("y",function(t){return t.value>0?p(t.value):p(0)}).attr("height",function(t){return Math.abs(p(t.value)-p(0))}).attr("filter","url(#blur)").attr("rx",3).attr("ry",3);u.selectAll("bar").data(t).enter().append("rect").style("fill",function(t){return"excluded"==t.name?"#655DC6":"#FFFFFF"}).style("stroke",function(t){return"excluded"==t.name?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.27)"}).attr("x",function(t){return d(t.name)}).attr("width",d.rangeBand()).attr("y",function(t){return t.value>0?p(t.value):p(0)+1}).attr("height",function(t){return Math.abs(p(t.value)-p(0))}).attr("rx",3).attr("ry",3);u.selectAll("bar").data(t).enter().append("rect").style("fill",function(t){return"excluded"==t.name?"#655DC6":"#FFFFFF"}).attr("x",function(t){return d(t.name)}).attr("width",d.rangeBand()).attr("y",function(t){return t.value>0?p(t.value)-3:p(0)+1}).attr("height",2);var g=c.append("g").attr("class","barLabels").attr("transform","translate("+a/2+",0)");t.forEach(function(t,e){u.append("line").style("stroke","excluded"==t.name?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.27)").attr("x1",d(t.name)).attr("y1",function(){return t.value>0?p(t.value):p(0)}).attr("x2",d(t.name)).attr("y2",function(){return t.value>0?p(t.value)-3:p(0)+3});e>0&&u.append("line").style("stroke","excluded"==t.name?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.27)").attr("x1",d(t.name)+60).attr("y1",function(){return t.value>0?p(t.value):p(0)}).attr("x2",d(t.name)+60).attr("y2",function(){return t.value>0?p(t.value)-3:p(0)+3});"excluded"==t.name&&u.append("rect").attr("x",function(){return d(t.name)}).attr("width",d.rangeBand()).attr("y",function(){return t.value>0?p(t.value):p(0)}).attr("height",function(){return Math.abs(p(t.value)-p(0))}).attr("stroke","#504A9E").attr("rx",3).attr("ry",3).attr("fill","url(#diagonalStripes)");var n=g.append("g");n.append("rect").attr("x",function(){return d(t.name)}).attr("width",d.rangeBand()).attr("height",2).attr("y",function(){return t.value>0?p(t.value):p(0)}).attr("opacity",0);n.append("text").attr("x",d(t.name)+l).attr("y",function(){return t.value>0?p(t.value)+20:Math.abs(p(t.value)-p(0))<l?Math.abs(p(t.value)-p(0))+p(0)+20:Math.abs(p(t.value)-p(0))+p(0)-10}).attr("text-anchor","middle").attr("class","grouped-bar-label").text(t.label).attr("fill",function(){var e="#404040";"excluded"==t.name&&(e=Math.abs(p(t.value)-p(0))<l?"#655DC6":"#FFFFFF");return e})})}c.append("g").attr("class","x axis").append("line").attr("y1",p(0)).attr("y2",p(0)).attr("x2",i+a).attr("stroke","#404040").attr("stroke-width","3");var v=c.append("text").attr("x",i+2*a).attr("y",p(0)-28).attr("text-anchor","left").style("font-size","22px").attr("fill","#B3B3B3");v.append("tspan").attr("dx",0).attr("dy",4).text("+");v.append("tspan").attr("dx",-13).attr("dy",30).attr("fill","#404040").text("0");v.append("tspan").attr("dx",-10).attr("dy",30).text("-")}function d(){t(function(){var t=431;var e=213;s.selectAll(".connectors svg").remove();var n=s.select(".connectors .svg-container").append("svg").attr("width",e).attr("height",t);n.append("linearGradient").attr("id","area-gradient").attr("x1",0).attr("y1",0).attr("x2",5).attr("y2",0).selectAll("stop").data([{offset:"0%",color:"#A7A7A7"},{offset:"20%",color:"white"}]).enter().append("stop").attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color});var i=l.getPercentage("excluded")/100*t;var a=l.selectedInsight.measureBreakdown.excluded.percentage/100*t;var r=[{x:0,y:t-i},{x:e,y:t-a}];var o=[{x:0,y:i},{x:e,y:a}];var c=s.scale.linear().domain([0,s.max(o,function(t){return t.x})]).range([0,e]);var u=s.scale.linear().domain([0,t]).range([t,0]);var d=s.svg.area().x(function(t){return c(t.x)}).y0(t).y1(function(t){return u(t.y)});var p=s.svg.line().x(function(t){return t.x}).y(function(t){return t.y});var h=[];h.push(r);var f=n.append("g").attr("class","lines");f.selectAll("path").data(h).enter().append("path").attr({d:p,"stroke-dasharray":"3, 3","stroke-dashoffset":0}).style("stroke","#BEBEBE").style("stroke-width","1").attr("opacity",1);n.append("path").datum(o).attr("class","area").attr("d",d)})}this.getLocalizedPercentage=function(t){return e.getLocalizedPercentage(t)};this.getPercentageLocalized=function(t){if(l.selectedInsight){var e=l.selectedInsight.counts.excluded+l.selectedInsight.counts.included;return l.getLocalizedPercentage(l.selectedInsight.counts[t]/e)}return 0};this.getPercentage=function(t){if(l.selectedInsight){var e=l.selectedInsight.counts.excluded+l.selectedInsight.counts.included;return l.selectedInsight.counts[t]/e*100}return 0};this.showTable=function(t){l.showing={table:t,excluded:true};e.getTableVis(l.selectedInsight,true).then(function(t){l.selectedInsight.table=t})};this.toggleShowTableExcluded=function(t){l.showing={table:true,excluded:t};e.getTableVis(l.selectedInsight,t).then(function(t){l.selectedInsight.table=t})};this.selectExcluded=function(){var t=l.selectedInsight.dimension;var e=this.selectedInsight.dimensionId;l.showing={table:false,excluded:false};var a=l.layout.qSelectionObject.qSelections;if(void 0!==e)return o.getApp().then(function(t){t.getDimension(e).then(function(e){e.getDimension().then(function(e){var i=e.qFieldDefs[0].replace("=","");t.getField(i).then(function(t){return t.selectExcluded().then(function(){a.length>0&&a.forEach(function(t){n.currApp().field(t.qField).clear()})})})})})});n.currApp().field(t).selectExcluded().then(function(){a.length>0&&a.forEach(function(t){n.currApp().field(t.qField).clear()})});i.publish("selection/insights/close");r.trackEvent(r.customEvents.SELECT_POSSIBLE_CLICKED,{type:"clicked"})};this.selectPossible=function(){var t=l.selectedInsight.dimension;var e=this.selectedInsight.dimensionId;l.showing={table:false,excluded:false};var a=l.layout.qSelectionObject.qSelections;if(void 0!==e)return o.getApp().then(function(t){t.getDimension(e).then(function(e){e.getDimension().then(function(e){var i=e.qFieldDefs[0].replace("=","");t.getField(i).then(function(t){return t.selectPossible().then(function(){a.length>0&&a.forEach(function(t){n.currApp().field(t.qField).clear()})})})})})});n.currApp().field(t).selectPossible().then(function(){a.length>0&&a.forEach(function(t){n.currApp().field(t.qField).clear()})});i.publish("selection/insights/close");r.trackEvent(r.customEvents.SELECT_POSSIBLE_CLICKED,{type:"clicked"})};this.isLabelContained=function(t){var e=427;var n=55;var i=t/100*e;return n<i};this.isLabelSmall=function(t){var e=427;var n=65;var i=t/100*e;return n<i};this.getNegativeMeasureText=function(){return a.get("SelectionInsights.MeasureNegative",[l.selectedInsight.measureAggregation[0].toUpperCase()+l.selectedInsight.measureAggregation.slice(1),l.selectedInsight.measure,l.selectedInsight.dimension])};this.getNegativeMeasurePossible=function(){return a.get("SelectionInsights.MeasureNegativePossible",[l.selectedInsight.measureAggregation[0].toUpperCase()+l.selectedInsight.measureAggregation.slice(1),l.selectedInsight.measure,l.selectedInsight.dimension,"<span>"+l.selectedInsight.measureBreakdown.included.num+"</span>"])};this.getNegativeMeasureExcluded=function(){return a.get("SelectionInsights.MeasureNegativeExcluded",[l.selectedInsight.measureAggregation[0].toUpperCase()+l.selectedInsight.measureAggregation.slice(1),l.selectedInsight.measure,l.selectedInsight.dimension,"<span>"+l.selectedInsight.measureBreakdown.excluded.num+"</span>"])};this.$onDestroy=function(){i.unsubscribe("selection/insights/details/updated");i.unsubscribe("selection/insights/measure/cancel");i.unsubscribe("selection/insights/updated");i.unsubscribe("selection/insights/fields/change");i.unsubscribe("selection/insights/details/negative")}}],template:e})}.apply(e,i),void 0!==a&&(t.exports=a))},864:function(t,e){t.exports='<div class="qv-selections-insights-details" ng-show="$ctrl.showInsightDetails">\n\t<div class="main-details-wrapper" ng-class="{\'disabled\': $ctrl.refreshActive}">\n\t\t<div ng-if="$ctrl.refreshActive" class="gray-overlay"></div>\n\t\t<div class="current-selections-container" ng-show="!$ctrl.cardIsInsight">\n\t\t\t<div class="current-selections-container-inner">\n\t\t\t\t<qv-selection-insights-current selected-insight="$ctrl.selectedInsight" back-to-selections="$ctrl.backToSelections()"></qv-selection-insights-current>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="details-container" ng-show="$ctrl.cardIsInsight">\n\t\t\t<div class="details-container-inner">\n\t\t\t\t<div class="closeBtn">\n\t\t\t\t\t<button tid="back-to-selection-button" class="lui-button" ng-click="$ctrl.backToSelections()" q-translation="SelectionInsights.BackToSelections">\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div class="details-body">\n\t\t\t\t\t<div class="title details-title">\n\t\t\t\t\t\t<span tid="insight-details-title" ng-bind-html="$ctrl.detailsTitle"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div tid="insight-details-summary" class="detail-summary" ng-bind-html="$ctrl.selectedInsight.summaryStringLong"></div>\n\t\t\t\t\t<div class="qv-titles-and-bars">\n\t\t\t\t\t\t<div class="bars-titles">\n\t\t\t\t\t\t\t<div class="title-container longer" q-title-translation="{{ $ctrl.selectedInsight.dimension }}">\n\t\t\t\t\t\t\t\t<div tid="insights-with-selection-title" class="title-longer">\n\t\t\t\t\t\t\t\t\t{{ $ctrl.selectedInsight.dimension }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div tid="insight-with-selections-bar-total" class="bar-total" q-translation="SelectionInsights.CountBarTotal, {{$ctrl.selectedInsight.counts.excluded + $ctrl.selectedInsight.counts.included}}" title="{{$ctrl.countBarTotal()}}"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="title-container">\n\t\t\t\t\t\t\t\t<div tid="insights-without-selection-title" class="title-longer" q-translation="SelectionInsights.MeasureBarTitle, {{$ctrl.selectedInsight.measureAggregation[0].toUpperCase() + $ctrl.selectedInsight.measureAggregation.slice(1)}}, {{$ctrl.selectedInsight.measure}}"\n\t\t\t\t\t\t\t\t\ttitle="{{$ctrl.selectionInsightsMeasureBarTitle()}}"></div>\n\t\t\t\t\t\t\t\t<div tid="insight-without-selections-bar-total" class="bar-total" q-translation="SelectionInsights.SelectionsBarTotal, {{$ctrl.selectedInsight.selectedMeasure.total}}" title="{{$ctrl.selectionsBarTotal()}}"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="bars-container negative-chart" ng-show="$ctrl.selectedInsight.isMeasureNegative && !$ctrl.showing.table">\n\t\t\t\t\t\t\t<div class="val-dist">\n\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="legend-dist">\n\t\t\t\t\t\t\t\t<div class="possible-legend">\n\t\t\t\t\t\t\t\t\t<div class="square">\n\t\t\t\t\t\t\t\t\t\t<div class="white-square"></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="legend-label" tid="possible-chart-legend" q-translation="SelectionInsights.Possible" q-title-translation="{{SelectionInsights.Possible}}"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="excluded-legend">\n\t\t\t\t\t\t\t\t\t<div class="square">\n\t\t\t\t\t\t\t\t\t\t<div class="gray-square"></div>\n\t\t\t\t\t\t\t\t\t\t<div class="purple-square"></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="legend-label" tid="excluded-chart-legend" q-translation="SelectionInsights.Excluded" q-title-translation="{{SelectionInsights.Excluded}}"></div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="measure-dist">\n\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="bars-container" ng-show="!$ctrl.selectedInsight.isMeasureNegative && !$ctrl.showing.table">\n\t\t\t\t\t\t\t<div class="value-bar" ng-class="{\'negative\': $ctrl.selectedInsight.isMeasureNegative}">\n\t\t\t\t\t\t\t\t<div tid="insight-with-selections-included-bar" class="bar included" ng-style="{height: ($ctrl.getPercentage(\'included\') /100) * 427 + \'px\'}">\n\t\t\t\t\t\t\t\t\t<div tid="insight-with-selections-included-measure-value" class="label" ng-style="{top: ($ctrl.getPercentage(\'included\')/100) * 427 + 5 + \'px\'}"\n\t\t\t\t\t\t\t\t\t\tng-class="{\'overlay-top\': !$ctrl.isLabelContained($ctrl.getPercentage(\'included\')), \'small\': !$ctrl.isLabelSmall($ctrl.getPercentage(\'included\'))}">\n\t\t\t\t\t\t\t\t\t\t{{ $ctrl.selectedInsight.counts.included }}\n\t\t\t\t\t\t\t\t\t\t<div tid="insight-with-selections-included-measure-percentage" class="percentage">\n\t\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\t$ctrl.getPercentageLocalized(\n\t\t\t\t\t\t\t\t\t\t\t"included"\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div tid="insight-with-selections-excluded-bar" class="bar excluded" ng-style="{height: ($ctrl.getPercentage(\'excluded\') / 100) * 427 + \'px\'}">\n\t\t\t\t\t\t\t\t\t<div tid="insight-with-selections-excluded-measure-value" class="label" ng-style="{bottom: ($ctrl.getPercentage(\'excluded\')/100) * 427 + 5 + \'px\'}"\n\t\t\t\t\t\t\t\t\t\tng-class="{\'overlay-bottom\': !$ctrl.isLabelContained($ctrl.getPercentage(\'excluded\')), \'small\': !$ctrl.isLabelSmall($ctrl.getPercentage(\'excluded\'))}">\n\t\t\t\t\t\t\t\t\t\t{{ $ctrl.selectedInsight.counts.excluded }}\n\t\t\t\t\t\t\t\t\t\t<div tid="insight-with-selections-excluded-measure-percentage" class="percentage">\n\t\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\t$ctrl.getPercentageLocalized(\n\t\t\t\t\t\t\t\t\t\t\t"excluded"\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="connectors" ng-if="!$ctrl.selectedInsight.isMeasureNegative">\n\t\t\t\t\t\t\t\t<div class="svg-container">\n\t\t\t\t\t\t\t\t\t<svg width="215" height="429"></svg>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="possible-label" q-translation="SelectionInsights.PossibleValues"></div>\n\t\t\t\t\t\t\t\t<div class="excluded-label" q-translation="SelectionInsights.ExcludedValues"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="measure-bar excluded-insight" ng-if="!$ctrl.selectedInsight.isMeasureNegative">\n\t\t\t\t\t\t\t\t<div tid="insight-without-selections-included-bar" class="bar included" ng-style="{height: ($ctrl.selectedInsight.measureBreakdown.included.percentage/100) * 427 + \'px\'}">\n\t\t\t\t\t\t\t\t\t<div tid="insight-without-selections-included-measure-value" class="label" ng-style="{top: ($ctrl.selectedInsight.measureBreakdown.included.percentage/100) * 427 + 5 + \'px\'}"\n\t\t\t\t\t\t\t\t\t\tng-class="{\'overlay-top\': !$ctrl.isLabelContained($ctrl.selectedInsight.measureBreakdown.included.percentage), \'small\': !$ctrl.isLabelSmall($ctrl.selectedInsight.measureBreakdown.included.percentage)}">\n\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t$ctrl.selectedInsight.measureBreakdown\n\t\t\t\t\t\t\t\t\t\t.included.num\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t<div tid="insight-without-selections-included-measure-percentage" class="percentage">\n\t\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\t$ctrl.getLocalizedPercentage(\n\t\t\t\t\t\t\t\t\t\t\t$ctrl.selectedInsight\n\t\t\t\t\t\t\t\t\t\t\t.measureBreakdown.included\n\t\t\t\t\t\t\t\t\t\t\t.percentage / 100\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div tid="insight-without-selections-excluded-bar" class="bar excluded" ng-style="{height: ($ctrl.selectedInsight.measureBreakdown.excluded.percentage/100) * 427 + \'px\'}">\n\t\t\t\t\t\t\t\t\t<div tid="insight-without-selections-excluded-measure-value" class="label" ng-style="{bottom: ($ctrl.selectedInsight.measureBreakdown.excluded.percentage/100) * 427 + 5 + \'px\'}"\n\t\t\t\t\t\t\t\t\t\tng-class="{\'overlay-bottom\': !$ctrl.isLabelContained($ctrl.selectedInsight.measureBreakdown.excluded.percentage), \'small\': !$ctrl.isLabelSmall($ctrl.selectedInsight.measureBreakdown.excluded.percentage)}">\n\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t$ctrl.selectedInsight.measureBreakdown\n\t\t\t\t\t\t\t\t\t\t.excluded.num\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t<div tid="insight-without-selections-excluded-measure-percentage" class="percentage">\n\t\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\t$ctrl.getLocalizedPercentage(\n\t\t\t\t\t\t\t\t\t\t\t$ctrl.selectedInsight\n\t\t\t\t\t\t\t\t\t\t\t.measureBreakdown.excluded\n\t\t\t\t\t\t\t\t\t\t\t.percentage / 100\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="bars-container" style="display: block" ng-show="$ctrl.showing.table">\n\t\t\t\t\t\t\t<div class="table-container" ng-class="{\'possible\': !$ctrl.showing.excluded}">\n\t\t\t\t\t\t\t\t<qv-object tabindex="-1" class="cell-content" model="$ctrl.selectedInsight.table" options="$ctrl.celloptions"></qv-object>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="toggle-values" ng-class="{\'show-table\': !$ctrl.showing.table}">\n\t\t\t\t\t\t\t<button tid="show-table-button" ng-if="!$ctrl.showing.table" class="lui-button show-table--button" ng-click="$ctrl.showTable(true)">\n\t\t\t\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--table"></span><span class="lui-button__text" q-translation="SelectionInsights.ShowValues"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button tid="show-table-button" ng-if="!$ctrl.showing.excluded && $ctrl.showing.table" class="lui-button show-vis--button" ng-click="$ctrl.toggleShowTableExcluded(true)">\n\t\t\t\t\t\t\t\t<span class="lui-button__text" q-translation="SelectionInsights.ViewExcluded"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button tid="show-table-button" ng-if="$ctrl.showing.excluded && $ctrl.showing.table" class="lui-button show-vis--button" ng-click="$ctrl.toggleShowTableExcluded(false)">\n\t\t\t\t\t\t\t\t<span class="lui-button__text" q-translation="SelectionInsights.ViewPossible"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button tid="show-table-button" ng-if="$ctrl.showing.table" class="lui-button show-vis--button" ng-click="$ctrl.showTable(false)">\n\t\t\t\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--back"></span><span class="lui-button__text" q-translation="SelectionInsights.ShowVisualization"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="insight-summary-footer">\n\t\t\t\t<div class="help-text" ng-bind-html="$ctrl.selectionHelp"></div>\n\t\t\t\t<div class="btns" ng-if="!$ctrl.hasLockedSelections">\n\t\t\t\t\t<button tid="select-possible-button" class="lui-button selection-btn" ng-click="$ctrl.selectPossible()" q-translation="Selections.Possible"></button>\n\t\t\t\t\t<button tid="select-excluded-button" class="lui-button selection-btn" ng-click="$ctrl.selectExcluded()" q-translation="Selections.Excluded"></button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'},865:function(t,e,n){"use strict";var i,a;function s(t){s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return s(t)}!(i=[n(48),n(96),n(866),n(91),n(95),n(234),n(220)],a=function(t,e,n,i,a,r){t.nativeComponent("qvSelectionInsightsCurrent",{bindings:{selectedInsight:"<",backToSelections:"&"},controller:["$scope","qvSelectionInsightsService","qvChartTooltipService","$timeout",function(t,n,o,l){var c=this,u,d=false;this.items=[];this.app=null;this.model=null;this.selectionsTitle="";this.measure="";this.selectionsCaption="";this.selectionsBarTotal="";a.subscribe("selection/insights/current-selection",function(t){c.items=n.getSelectionItems(t)});a.subscribe("selection/insights/current/open",function(t){var e={measure:t.insight.measure,aggr:t.insight.measureAggregation,dimension:t.insight.dimension,contribution:t.insight.selectedMeasure.selected.percentage.toFixed(1)};var n=t.insight.isSelectionNegative?t.insight.selectedMeasure.selected.num:t.insight.selectedMeasure.selected.percentage.toFixed(1)+"%";c.measure=e.measure;c.selectionsTitle=i.get("SelectionInsights.SelectionsContributionsTitle","<strong>"+e.measure.substring(0,40)+"</strong>");c.selectionsCaption=i.get("SelectionInsights.SelectionContributionCaption",["<span>"+e.measure.substring(0,40)+"</span>","<span>"+n+"</span>","<span>"+(e.aggr[0].toUpperCase()+e.aggr.slice(1))+"</span>"]);r.selectAll(".negative-chart.select-measure-dist svg").remove();if(t.insight.isSelectionNegative){var a=[{name:"selected",value:t.insight.selectedMeasure.selected.qNum,label:t.insight.selectedMeasure.selected.num},{name:"excluded",value:t.insight.selectedMeasure.excluded.qNum,label:t.insight.selectedMeasure.excluded.num}];p(a)}});function p(t){var e=431;var n=120;var i=10;var a=".negative-chart.select-measure-dist";var s=45;var o=30;var l=r.select(".negative-chart"+a).append("svg").attr("width",n+s).attr("height",e+s);var c=l.append("g").attr("transform","translate("+i/2+",1)");var u=r.scale.ordinal().rangeRoundBands([0,n]);var d=r.scale.linear().range([e,0]);u.domain(t.map(function(t){return t.name}));d.domain(r.extent(t,function(t){return t.value}));var p=c.append("defs");p.append("filter").attr("id","blur").append("feGaussianBlur").attr("stdDeviation",5);p.append("pattern").attr("id","diagonalStripes").attr("patternUnits","userSpaceOnUse").attr("width",8).attr("height",8).attr("patternTransform","rotate(45)").append("rect").attr("width","2").attr("height","8").attr("fill","#4dc753");c.selectAll("bar").data(t).enter().append("rect").style("fill","rgba(0,0,0,0.1)").attr("x",function(t){return u(t.name)}).attr("width",u.rangeBand()).attr("y",function(t){return t.value>0?d(t.value):d(0)}).attr("height",function(t){return Math.abs(d(t.value)-d(0))}).attr("filter","url(#blur)").attr("rx",3).attr("ry",3);c.selectAll("bar").data(t).enter().append("rect").style("fill",function(t){return"selected"==t.name?"#6cd475":"#D8D8D8"}).style("stroke",function(t){return"selected"==t.name?"#37B342":"#959595"}).attr("x",function(t){return u(t.name)}).attr("width",u.rangeBand()).attr("y",function(t){return t.value>0?d(t.value):d(0)+1}).attr("height",function(t){return Math.abs(d(t.value)-d(0))}).attr("rx",3).attr("ry",3);c.selectAll("bar").data(t).enter().append("rect").style("fill",function(t){return"selected"==t.name?"#6cd475":"#D8D8D8"}).attr("x",function(t){return u(t.name)}).attr("width",u.rangeBand()).attr("y",function(t){return t.value>0?d(t.value)-3:d(0)+1}).attr("height",2);var h=l.append("g").attr("class","barLabels").attr("transform","translate("+i/2+",0)");t.forEach(function(t,e){c.append("line").style("stroke","selected"==t.name?"#37B342":"#959595").attr("x1",u(t.name)).attr("y1",function(){return t.value>0?d(t.value):d(0)}).attr("x2",u(t.name)).attr("y2",function(){return t.value>0?d(t.value)-3:d(0)+3});e>0&&c.append("line").style("stroke","selected"==t.name?"#37B342":"#959595").attr("x1",u(t.name)+60).attr("y1",function(){return t.value>0?d(t.value):d(0)}).attr("x2",u(t.name)+60).attr("y2",function(){return t.value>0?d(t.value)-3:d(0)+3});"selected"==t.name&&c.append("rect").attr("x",function(){return u(t.name)}).attr("width",u.rangeBand()).attr("y",function(){return t.value>0?d(t.value):d(0)}).attr("height",function(){return Math.abs(d(t.value)-d(0))}).attr("stroke","#504A9E").attr("stroke-width","0").attr("rx",3).attr("ry",3).attr("fill","url(#diagonalStripes)");var n=h.append("g");n.append("rect").attr("x",function(){return u(t.name)}).attr("width",u.rangeBand()).attr("height",2).attr("y",function(){return t.value>0?d(t.value):d(0)}).attr("opacity",0);n.append("text").attr("x",u(t.name)+o).attr("y",function(){return t.value>0?d(t.value)+20:Math.abs(d(t.value)-d(0))<o?Math.abs(d(t.value)-d(0))+d(0)+20:Math.abs(d(t.value)-d(0))+d(0)-10}).attr("text-anchor","middle").attr("class","grouped-bar-label").text(t.label).attr("fill",function(){var e="#414141";"selected"==t.name&&(e=Math.abs(d(t.value)-d(0))<o?"#2F9938":"#FFFFFF");return e})});l.append("g").attr("class","x axis").append("line").attr("y1",d(0)).attr("y2",d(0)).attr("x2",n+i).attr("stroke","#404040").attr("stroke-width","3");var f=l.append("text").attr("x",n+2*i).attr("y",d(0)-28).attr("text-anchor","left").style("font-size","22px").attr("fill","#B3B3B3");f.append("tspan").attr("dx",0).attr("dy",4).text("+");f.append("tspan").attr("dx",-13).attr("dy",30).attr("fill","#404040").text("0");f.append("tspan").attr("dx",-10).attr("dy",30).text("-")}c.selectionsBarTotal=function(){if(c.selectedInsight&&c.selectedInsight.selectedMeasure.total)return i.get("SelectionInsights.SelectionsBarTotal",[c.selectedInsight.selectedMeasure.total])};this.getLocalizedPercentage=function(t){return n.getLocalizedPercentage(t)};this.getSeparatorPos=function(){if(void 0!==c.items&&null!==c.selectedInsight&&void 0!==c.selectedInsight){var t=56;var e=427;if(c.selectedInsight.isSelectionNegative){var n=c.selectedInsight.selectedMeasure.selected.qNum;var i=c.selectedInsight.selectedMeasure.excluded.qNum;var a=0;e=431;var s=55;a=n<0?e-Math.abs(n)/2/((Math.abs(n)+i)/e):n/2/((Math.abs(i)+n)/e);return a+s}var r=38;var o=10;var l=(c.items.length*r+(c.items.length-1)*o)/2;var u=c.selectedInsight.selectedMeasure.selected.percentage/100*e/2;return t+Math.min(l,u)}};this.isLabelContained=function(t){var e=427;var n=55;var i=t/100*e;return n<i};this.getLabelFontSize=function(t){var e=427;var n=65;var i=t/100*e;return n<i?"24px":"36px"};this.getNegativeMeasureText=function(){return i.get("SelectionInsights.SelectionNegative",[c.selectedInsight.measureAggregation[0].toUpperCase()+c.selectedInsight.measureAggregation.slice(1),c.selectedInsight.measure])};function h(t){var e=t.qStateCounts;var n="";"object"===s(e)&&(n=" ("+(e.qSelected+e.qSelectedExcluded+e.qLocked+e.qLockedExcluded)+"/"+t.qTotal+")");return n}t.openTooltip=function(n,i){if(d||e.utils.touch)return;t.cancelTooltip();u=l(function(){d=true;var t=i.translation;var e=h(i);o.open({content:[{header:(i.qReadableName||i.qField)+e,rows:[{content:t}]}],position:{x:n.clientX,y:n.clientY},alwaysOnTop:true,direction:"bottom",template:"current-selections-tooltip-template.ng.html"})},500)};t.closeTooltip=function(){d=false;t.cancelTooltip();o.close()};t.cancelTooltip=function(){l.cancel(u)};this.getNegativeMeasurePossible=function(){return i.get("SelectionInsights.SelectionNegativePossible",[c.selectedInsight.measureAggregation[0].toUpperCase()+c.selectedInsight.measureAggregation.slice(1),c.selectedInsight.measure,"<span>"+c.selectedInsight.measureBreakdown.included.num+"</span>"])};this.getNegativeMeasureExcluded=function(){return i.get("SelectionInsights.SelectionNegativeExcluded",[c.selectedInsight.measureAggregation[0].toUpperCase()+c.selectedInsight.measureAggregation.slice(1),c.selectedInsight.measure,"<span>"+c.selectedInsight.measureBreakdown.excluded.num+"</span>"])};this.isLabelSmall=function(t){var e=427;var n=65;var i=t/100*e;return n<i};this.getVerticalHeight=function(){if(void 0!==c.items&&null!==c.selectedInsight&&void 0!==c.selectedInsight)return c.selectedInsight.isSelectionNegative?431:40*c.items.length+11*(c.items.length-1)};this.$onDestroy=function(){a.unsubscribe("selection/insights/current-selection");a.unsubscribe("selection/insights/current/open")}}],template:n})}.apply(e,i),void 0!==a&&(t.exports=a))},866:function(t,e){t.exports='<div class="closeBtn">\n\t<button tid="back-to-selection-button" class="lui-button" ng-click="$ctrl.backToSelections()" q-translation="SelectionInsights.BackToSelections"></button>\n</div>\n<div class="details-body">\n\t<div class="title current-selection-title">\n\t\t<span tid="selection-details-title" ng-bind-html="$ctrl.selectionsTitle"></span>\n\t</div>\n\t<div class="current-selection-caption">\n\t\t<div tid="selections-caption" ng-bind-html="$ctrl.selectionsCaption"></div>\n\t</div>\n\t<div class="current-selection-details">\n\t\t<div class="field-list">\n\t\t\t<div tid="selections-fields-title" class="fields-title" q-translation="SelectionInsights.YourSelections" q-title-translation="{{ SelectionInsights.YourSelections }}"></div>\n\t\t\t<div class="fields-items">\n\t\t\t\t<ul class="list" ng-show="$ctrl.items.length > 0">\n\t\t\t\t\t<li class="item" tid="selection-insight-details-user-selections" ng-class="{\'item-multi-state\': !item.isSingleState, \'multi-active\': multiPopoverFieldName && multiPopoverFieldName === item.qField}" ng-repeat="item in $ctrl.items track by item.qField" data-csid="{{ item.qField }}" tabindex="0"\n\t\t\t\t\t ng-keydown="handleKeyDown($event, item)" aria-label="{{ item.screenReaderLabel }}">\n\t\t\t\t\t\t<qv-current-selections-item ng-if="item.isSingleState" item="item"></qv-current-selections-item>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="separator" ng-class="{\'negative\': $ctrl.selectedInsight.isSelectionNegative}">\n\t\t\t<div class="legend-dist" ng-if="$ctrl.selectedInsight.isSelectionNegative">\n\t\t\t\t<div class="selected-legend">\n\t\t\t\t\t<div class="square">\n\t\t\t\t\t\t<div class="green-square"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="legend-label" tid="selected-chart-legend" q-translation="SelectionInsights.Selected" q-title-translation="{{ SelectionInsights.Selected }}"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="excluded-legend">\n\t\t\t\t\t<div class="square">\n\t\t\t\t\t\t<div class="gray-square"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="legend-label" tid="excluded-chart-legend" q-translation="SelectionInsights.Excluded" q-title-translation="{{ SelectionInsights.Excluded }}"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="vertical" ng-style="{height: $ctrl.getVerticalHeight() + \'px\'}"></div>\n\t\t\t<div class="horizontal" ng-style="{\'margin-top\': $ctrl.getSeparatorPos() + \'px\'}"></div>\n\t\t</div>\n\t\t<div class="chart">\n\t\t\t<div tid="selections-bar-title" class="bar-title" q-translation="SelectionInsights.SelectionsBarTitle, {{\n\t\t\t\t\t$ctrl.measure\n\t\t\t\t}}" q-translation-title="SelectionInsights.SelectionsBarTitle, {{\n\t\t\t\t\t$ctrl.measure\n\t\t\t\t}}"></div>\n\t\t\t<div tid="selections-bar-total" class="bar-total" title="{{ $ctrl.selectionsBarTotal() }}">\n\t\t\t\t{{ $ctrl.selectionsBarTotal() }}\n\t\t\t</div>\n\t\t\t<div class="bar selected" ng-if="!$ctrl.selectedInsight.isSelectionNegative" ng-style="{height: ($ctrl.selectedInsight.selectedMeasure.selected.percentage/100) * 427 + \'px\'}">\n\t\t\t\t<div tid="selected-measure-number" class="label" ng-style="{top: ($ctrl.selectedInsight.selectedMeasure.selected.percentage/100) * 427 + 5 + \'px\'}" ng-class="{\'overlay-top\': !$ctrl.isLabelContained($ctrl.selectedInsight.selectedMeasure.selected.percentage), \'small\': !$ctrl.isLabelSmall($ctrl.selectedInsight.selectedMeasure.selected.percentage)}">\n\t\t\t\t\t{{ $ctrl.selectedInsight.selectedMeasure.selected.num }}\n\t\t\t\t\t<div tid="selected-measure-percentage" class="percentage">\n\t\t\t\t\t\t{{\n\t\t\t\t\t\t$ctrl.getLocalizedPercentage(\n\t\t\t\t\t\t$ctrl.selectedInsight.selectedMeasure.selected\n\t\t\t\t\t\t.percentage / 100\n\t\t\t\t\t\t)\n\t\t\t\t\t\t}}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="bar excluded" ng-if="!$ctrl.selectedInsight.isSelectionNegative" ng-style="{height: ($ctrl.selectedInsight.selectedMeasure.excluded.percentage/100) * 427 + \'px\'}">\n\t\t\t\t<div tid="excluded-measure-number" class="label" ng-style="{bottom: ($ctrl.selectedInsight.selectedMeasure.excluded.percentage/100) * 427 + 5 + \'px\'}" ng-class="{\'overlay-bottom\': !$ctrl.isLabelContained($ctrl.selectedInsight.selectedMeasure.excluded.percentage), \'small\': !$ctrl.isLabelSmall($ctrl.selectedInsight.selectedMeasure.excluded.percentage)}">\n\t\t\t\t\t{{ $ctrl.selectedInsight.selectedMeasure.excluded.num }}\n\t\t\t\t\t<div tid="excluded-measure-percentage" class="percentage">\n\t\t\t\t\t\t{{\n\t\t\t\t\t\t$ctrl.getLocalizedPercentage(\n\t\t\t\t\t\t$ctrl.selectedInsight.selectedMeasure.excluded\n\t\t\t\t\t\t.percentage / 100\n\t\t\t\t\t\t)\n\t\t\t\t\t\t}}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="negative-chart select-measure-dist" ng-show="$ctrl.selectedInsight.isSelectionNegative"></div>\n\t\t</div>\n\t</div>\n</div>'},867:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(868),n(95),n(869),n(147),n(106),n(103),n(870)],a=function(t,e,n,i,a,s,r){t.nativeComponent("qvSelectionInsightsSummary",{bindings:{showLoading:"<",hasSelection:"<",measure:"=",newMeasureChosen:"=",newSelection:"=",showFields:"<",selectionInsightsState:"=",states:"=",measureError:"="},controller:["$scope","$timeout","luiPopover","qvSelectionInsightsService","qvSelectionInsightsSearchService",function(t,e,o,l,c){var u=this;this.showLoading=true;var d=[];this.fieldList=[];this.showFieldsChanged=false;this.currentMeasure=u.measure;function p(){e(function(){var t=document.getElementsByClassName("ai-change-field-input");t[0].focus()},100)}this.showChangeField=function(t){var e=["$scope",function(t){function e(e){var n=t.highlight;var i=c.getMatchingFields(e,n);t.measures=i.filter(function(t){return!t.masterItemMeasures});t.masterMeasures=i.filter(function(t){return t.masterItemMeasures})}function n(n){t.highlight=n;e(u.fieldList)}t.filterFields=n;t.onSelectMeasure=b;t.navigate=y;e(u.fieldList)}];h(i,e,t.currentTarget,"bottom",f)};function h(t,e,n,i,a){var s={template:t,controller:e,dock:i,alignTo:n,showArrow:true,autoFocus:false};var r=o.show(s);d.push(r);r.closed.then(function(){"function"===typeof a&&a()});p()}function f(){d.forEach(function(t,e){t.close();d.splice(e,1)})}function g(){l.getMeasures(u.showFields).then(function(t){u.fieldList=t})}function v(){a.getList().then(function(e){t.masterMeasuresListModel=e});s(t,"masterMeasuresListModel",function(){g()})}v();this.refreshInsights=function(){n.publish("selection/insights/refresh");u.newMeasureChosen=false;u.newSelection=false;u.showFieldsChanged&&m();return l.getInsightDimensions(u.showFields,u.selectedMeasure).then(function(t){n.publish("selection/insights/new",t);u.currentMeasure=u.measure}).catch(function(t){n.publish("selection/insights/error",t.error)})};this.$onChanges=function(t){if(void 0!==t.showFields&&!t.showFields.isFirstChange()){u.showFieldsChanged=true;u.newMeasureChosen=false;n.publish("selection/insights/fields/change")}};function m(){l.getMeasures(u.showFields).then(function(t){u.showFieldsChanged=false;u.fieldList=t})}n.subscribe("selection/insights/show",function(){u.showFieldsChanged&&m()});function b(t){u.newMeasureChosen=true;u.newSelection=false;u.measureError=false;u.selectedMeasure=t;u.measure=t.qName;f();r.trackEvent(r.customEvents.NEW_MEASURE_CHOSEN,{type:"clicked"});u.refreshInsights()}function y(t){b(t)}}],template:e})}.apply(e,i),void 0!==a&&(t.exports=a))},868:function(t,e){t.exports='<div class="qv-selections-insights-cards-summary" ng-class="{\'empty\': $ctrl.showLoading}">\n\t<div ng-if="!$ctrl.showLoading">\n\t\t<div class="summary-text" ng-if="!$ctrl.newMeasureChosen && !$ctrl.newSelection && !$ctrl.showFieldsChanged">\n\t\t\t<span q-translation="SelectionInsights.SummarySelection"> </span>\n\t\t</div>\n\t\t<div class="measure-select">\n\t\t\t<div class="refresh-insights-new-selection" ng-if="!$ctrl.newMeasureChosen && ($ctrl.newSelection || $ctrl.showFieldsChanged) ">\n\t\t\t\t<p class="refresh-insights-paragraph" q-translation="SelectionInsights.Refresh.NewSelection"></p>\n\t\t\t\t<div class="refresh-insights--button-group">\n\t\t\t\t\t<button class="lui-button  lui-button--success refresh-insights--button onlyOne" q-translation="SelectionInsights.Refresh" ng-click="$ctrl.refreshInsights()"></button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<h2 q-translation="Common.Measure"></h2>\n\t\t\t<p q-translation="SelectionInsights.CalculatedOn"></p>\n\t\t\t<button tid="ai-measure-picker" class="ai-measure-picker lui-button" id="ai-measure-picker" ng-click="$ctrl.showChangeField($event)" tabindex="0" ng-disabled="$ctrl.showFieldsChanged || $ctrl.newSelection">\n\t\t\t\t<span class="ai-measure-picker-text">{{ $ctrl.measure }}</span><span class="lui-icon lui-button__icon small lui-icon--small" ng-class="{\'lui-icon--arrow-down\' : !match.expanded, \'lui-icon--arrow-up\': match.expanded}"></span>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="measure-error" ng-if="$ctrl.measureError" q-translation="SelectionInsights.ErrorNaN"></div>\n\t</div>\n</div>\n<div class="hr-div">\n\t<hr class="qv-selection-insights-hr" ng-if="$ctrl.selectionInsightsState === $ctrl.states.INSIGHTS_FOUND" />\n</div>'},869:function(t,e){t.exports='<lui-popover class="ai-change-field-popover ai-popover">\n\t<object-add-typeahead>\n\t\t<lui-popover-header>\n\t\t\t<div class="lui-input-group">\n\t\t\t\t<input class="lui-input lui-input-group__input ai-change-field-input" type="text" autocomplete="off" ng-model="search.term" qva-focus="autoFocus" ng-change="filterFields(search.term)" maxlength="255" object-add-typeahead-input />\n\t\t\t</div>\n\t\t</lui-popover-header>\n\t\t<div class="lui-popover__body lui-nopad popover-body" object-add-typeahead-menu>\n\t\t\t<ul class="lui-list">\n\t\t\t\t<div ng-if="masterMeasures.length > 0" class="object-add-popover-list-header" q-translation="Common.MasterMeasures"></div>\n\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="field in masterMeasures" ng-click="onSelectMeasure(field)" on-select="navigate(field)" object-add-typeahead-item="field">\n\t\t\t\t\t<span class="lui-list__text" qve-highlight text="{{ field.qName }}" query="highlight"></span>\n\t\t\t\t</li>\n\n\t\t\t\t<div ng-if="measures.length > 0" class="object-add-popover-list-header" q-translation="Common.Measures"></div>\n\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="field in measures" ng-click="onSelectMeasure(field)" on-select="navigate(field)" object-add-typeahead-item="field">\n\t\t\t\t\t<span class="lui-list__text" qve-highlight text="{{ field.qName }}" query="highlight"></span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\n\t\t\t<div class="no-hits" ng-if="fieldList.length === 0">\n\t\t\t\t<span><i q-translation="Toolbox.Search.Nohits" /></span>\n\t\t\t</div>\n\t\t</div>\n\t</object-add-typeahead>\n</lui-popover>'},870:function(t,e,n){"use strict";var i,a;!(i=[n(54),n(48),n(112)],a=function(t,e,n){e.service("qvSelectionInsightsSearchService",[function(){var e;function i(e,i){var a=[];var s;i?i=i?i.toLowerCase():"":i&&""!==i||(s=true);if(s)return e;a=t.uniq(e).filter(function(t){return n.librarySearchFn(t,i)});return n.localeOrderBy(a,function(t){return t.qName})}e={getMatchingFields:function t(e,n){return i(e,n)}};return e}])}.apply(e,i),void 0!==a&&(t.exports=a))},871:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(872),n(873),n(306)],a=function(t,e,n){t.directive("qvGlobalSearch",function(){return{restrict:"E",template:e,controller:["$scope","$document","$element","$window",n],require:["qvGlobalSearch"],scope:true,replace:true,link:function t(){}}});return"<qv-global-search></qv-global-search>"}.apply(e,i),void 0!==a&&(t.exports=a))},872:function(t,e){t.exports='<div>\n\t<div class="qv-global-search" ng-class="{ \'overlay\': displaySuggestions || displayResult.data || displayResult.visuals }" ng-style="{paddingTop: toolbarHeight}" qva-outside="onOutsideSearch($event)" tid="globalSearch">\n\t\t<div class="zoomed-chart" ng-class="{\'animate-expand \': animateZoomedChart, \'animate-shrink\': !animateZoomedChart}">\n\t\t\t<div class="close-btn" ng-if="zoomedChart" tid="smartsearch-zoomed-chart">\n\t\t\t\t<button class="lui-fade-button" ng-click="minimizeExpandedChart()" tid="smartSearchExitZoomedChart">\n\t\t\t\t\t<span class="lui-fade-button__icon  lui-icon lui-icon--close lui-icon--large"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div class="chart" ng-if="zoomedChart">\n\t\t\t\t<qv-object tid="smartsearch-zoomed-chart-object" model="zoomedChart.model" options="zoomedChart.options"></qv-object>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<qv-global-search-input class="qv-global-search-input"></qv-global-search-input>\n\t\t<div class="qv-global-search-line" ng-if="!showMobileIndexProgressBar"></div>\n\t\t<qv-mobile-index-progress ng-if="isSmallDevice && query.length === 0 && isIndexClosedFeature"></qv-mobile-index-progress>\n\t\t<qv-global-search-history ng-if="isSearchHistoryFeature && searchInputFocused && query.length === 0"></qv-global-search-history>\n\t\t<div class="qv-global-search-dimmer" ng-if="query.length > 0 || forceShowDimmer" ng-style="dimmerStyles">\n\t\t\t<qv-global-search-result tid="globalSearch.ResultList"></qv-global-search-result>\n\t\t\t<div ng-show="scrollShow && !activity.show" class="scroll-affordance scroll-vertical"></div>\n\t\t</div>\n\t</div>\n\t<div class="qv-global-search-glass" ng-if="query.length > 0" qva-activate="close();"></div>\n</div>\n'},873:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(113),n(108),n(97),n(106),n(143),n(874),n(110),n(227),n(50),n(128),n(99),n(881),n(882),n(883),n(884),n(885),n(49),n(89),n(91),n(95),n(105),n(222),n(887),n(890),n(901),n(903),n(905),n(908),n(169),n(175)],a=function(t,e,n,i,a,s,r,o,l,c,u,d,p,h,f,g,v,m,b,y,S,I,x,q){function w(t,e,n,i){var a={qOffset:e,qCount:n,qGroupOptions:[],qGroupItemOptions:[]};if(t===f.data){a.qGroupOptions.push({qGroupType:"DatasetType",qOffset:0,qCount:-1});a.qGroupItemOptions.push({qGroupItemType:"Field",qOffset:0,qCount:i})}else if(t===f.visuals){a.qGroupOptions.push({qGroupType:"GenericObjectsType",qOffset:0,qCount:30});a.qGroupItemOptions.push({qGroupItemType:"GenericObject",qOffset:0,qCount:i})}return a}function C(t){var e={qContext:"CurrentSelections"};t&&(e.qCharEncoding="Utf16");return e}function P(t,e){t.dimmerStyles["max-height"]=e;t.dimmerStyles["height"]=e}function E(t){t.isSmallDeviceLandscape=u.orientation===u.Orientation.landscape&&u.isSmallDevice}function k(k,T,O,A){var $=e.getService("qvGlobalSearchDataService"),D=e.getService("$timeout"),_=e.getService("qvGlobalSelectionsService"),M=e.getService("qvGlobalSearchService"),N,F={search:{idCounter:0,requestState:h.idle,searchTerms:""},searchVisuals:{idCounter:0,requestState:h.idle,searchTerms:""},result:{requestState:h.idle},suggest:{idCounter:0,requestState:h.idle,suggestTerms:""}},L=function t(){D(function(){k.isSmallDevice=u.isSmallDevice;k.isSmallDevice&&(k.forceShowDimmer=false);E(k);H=G();j()})},R=function t(){k.isSmallDeviceLandscape=u.orientation===u.Orientation.landscape&&u.isSmallDevice;E(k);H=G();j()},j=function t(){P(k,T.find("body").height()-H)},G=function t(){return O.offset().top+O[0].offsetTop+O.find(".qv-global-search-input").outerHeight()},H=G(),V=O.parent().parent(),B=this;k.inClient=i.inClient();k.zoomedChart=false;k.focusState=new g(new v(g,this,k),g.Input);N=new o(O,k,this);k.forceShowDimmer=false;k.isSmallDevice=u.isSmallDevice;k.isSmallDeviceLandscape=u.orientation===u.Orientation.landscape&&u.isSmallDevice;k.showMobileIndexProgressBar=false;k.isObjectsFeature=n["SMARTSEARCH_OBJECTS"]&&k.inClient&&(k.isSmallDevice||k.options&&k.options.objectSearchIsOn);k.isSearchHistoryFeature=n["SEARCH_HISTORY"];k.isIndexClosedFeature=n["SMARTSEARCH_INDEX_CLOSE"];k.suggestedChartExpanded=null;I.subscribe(x.Events.PubSub.ExpandSmartSearchSuggestedChart,function(t){k.zoomedChart=t;k.animateZoomedChart=Boolean(t);k.suggestedChartExpanded=Boolean(t);t&&k.isSmallDevice&&q.resizeCharts(A)});I.subscribe(x.Events.PubSub.RestoreSearchState,function(){if(k.suggestedChartExpanded){k.query=k.suggestedChartExpanded;B.setQueryFromHistory()}});k.minimizeExpandedChart=function(){k.suggestedChartExpanded=null;I.publish(x.Events.PubSub.ExpandSmartSearchSuggestedChart,null)};if(k.isSearchHistoryFeature){r.userId?k.userID=r.userId:k.userID="DESKTOP";k.searchInputFocused=false;k.activeHistoryIx=-1;k.historyPermission=false;k.searchHistory=m.initHistory(k)}u.ViewChanged.bind(L);u.OrientationChanged.bind(R);a.on("end",j);k.input="input goes here";k.result="result goes here";k.isSelectActiveInSmallDevice=false;k.$on("$destroy",function(){O.off("qv-outside");N.delete();u.ViewChanged.unbind(L);u.OrientationChanged.unbind(R);a.off("end",j);I.unsubscribe(x.Events.PubSub.ExpandSmartSearchSuggestedChart);I.unsubscribe(x.Events.PubSub.RestoreSearchState)});k.$on("updateForceShowDimmer",function(t,e){k.forceShowDimmer=e});k.$watch("throbber.show",function(t){t&&k.focusState.reset()});k.app.getCurrentSelectionObject().then(function(t){k.modelSelections=t});s(k,"modelSelections",function(t){var e=t.qSelectionObject.qSelections,n;n=e.reduce(function(t,e){return t+(true===e.qLocked)?1:0},0);k.currentSelections=e.length>0;k.allSelectionsLocked=e.length===n;k.isObjectsFeature&&B.searchVisuals(k.searchTerms);B.search(k.searchTerms)});k.$watch("app.isModal()",function(t){t&&D(function(){M.toggleGlobalSearch(k.app)})});k.$watch(_.isSelectActive.bind(null,k.app),function(t){k.isSelectActiveInSmallDevice=t&&k.isSmallDevice});k.$watch("query",function(t){M.setHaveQuery(k.app,!!t)});if(k.isIndexClosedFeature&&!k.isSmallDevice&&M.couldEngineBeIndexing(k.app)){k.forceShowDimmer=true;D(function(){k.$broadcast("toggleActivityIndicator",true)})}k.underlines=[];k.query="";k.searchTerms=[];k.searchTermGroups=[];k.matches=[];k.displayResult={data:false,visuals:false};k.activity={show:false};k.throbber={show:false};k.indexProgress={enabled:false,show:false,visible:false};k.indexDone={show:false,visible:false};k.activeSelectIx=-1;k.showMeMoreFocus=false;k.forcePartials=false;k.allSelectionsLocked=false;k.dimmerStyles={};k.error={show:false,message:"",description:""};k.paging={lastRowIx:0,totalRows:0};k.searchOutsideSelections=function(){B.searchOutsideSelections()};k.onShowMoreHits=function(t,e,n){t.stopPropagation();if(e.disableShowMore)return;P(k,O.find(".qv-global-search-dimmer").height());e.disableShowMore=true;e.mobileExpand=true;var i=w(f.data,n,1,e.qItemMatches.length+15);B.callSearch(k.searchTerms,i).then(function(t){$.showMore(t,e)}).finally(function(){e.disableShowMore=false})};k.getSearchTermGroup=function(t){return k.searchTermGroups.filter(function(e){return e.qSearchTermsMatched.length===t})};k.close=function(){B.closeSearch()};O.on("qv-outside",z);function z(e){var n=t(e.target);if(1===n.closest(".qv-selections-pager").length||1===n.closest(".transparent-overlay-scroll").length)return;B.closeSearch()}k.suggestions=[];k.displaySuggestions=false;k.activeSuggestionIx=-1;k.ignoreQueryChange=false;k.onOutsideSearch=function(){k.isSearchHistoryFeature&&B.showHistory(false)};k.onSuggestSelect=function(t,e){var n,i,a=[];if(!e){t=void 0!==t?t:k.activeSuggestionIx;e=k.suggestions[t]}$.getUnderlinersAndSearchTerms(k.query,a,[]);n=$.getResultingQueryFromSuggestion(a,e);if(n.length>255){N.off();c.showDialog({message:"ErrorDialog.SearchStringTooLong"});i=k.$on("errorHandlerClosed",function(){N.on();i()})}else{k.query=n+" ";k.ignoreQueryChange=false}B.hideSuggestions();k.$broadcast("focusInput");k.getInsightsCharts(e.value)};k.haveUnlockedSelections=function(){return k.currentSelections&&!k.allSelectionsLocked};k.getInsightsCharts=function(t){if(b.getFlag("CAO_MOBILE")){var n=e.getService("qvCaoChartService");if(k.query){k.unableTofetchInsightCharts=false;k.fetchingInsightChartsPending=true;n.getInsights(k.app,t).then(function(t){var e=[].concat(t.recommendations).concat(t.chartMatches);var n=e.map(function(t){return t.visualization.loadChart(k.app)});y.all(n).then(function(t){e=e.map(function(e,n){e=Object.assign({},e,{itemIndex:n,load:true,qItemType:"GenericObject",qTotalNumberOfMatches:0,qIdentifier:t[n].model.id,qItemMatches:[],qTermsMatched:[],qSearchTermsMatched:[]});return e});if(e.length>0){k.suggestedChartGroupTitle=S.get("GlobalSearch.Insight.ChartsTitle",[e.length]);k.insightVisualsGroups=[{qGroupType:"GenericObjectsType",qid:0,qItems:e,insightCharts:true,qSearchTermsMatched:[0],qTotalNumberOfItems:e.length}]}k.fetchingInsightChartsPending=false})},function(){k.unableTofetchInsightCharts=true;k.insightVisualsGroups=[];k.fetchingInsightChartsPending=false})}else k.insightCharts=[]}};this.hideSuggestions=function(){if(k.displaySuggestions){k.displaySuggestions=false;this.resetSuggestions()}};this.hideSoftKeyboard=function(){k.$broadcast("blurInput")};this.showNoResultsMessage=function(){return false};this.searchOutsideSelections=function(){k.outsideSelection=true;k.modelSelections.clearAll();k.$broadcast("focusInput")};this.setShowPartialMatches=function(){k.forcePartials=!k.forcePartials;p.treatAsDesktop()&&k.$broadcast("focusInput")};k.isPartials=function(){return k.searchTermGroups.length&&k.searchTerms.length>k.searchTermGroups[0].qSearchTermsMatched.length};this.resetSuggestions=function(){k.activeSuggestionIx=-1;k.activeSelectIx=-1};this.showSuggestions=function(){k.displaySuggestions=true;k.activeSuggestionIx=-1;k.activeSelectIx=-1};this.showError=function(t){k.displayResult={data:false,visuals:false};k.error.show=true;k.error.translation="ErrorCode."+t.code;t.isHandled=true};this.toogleSuggestions=function(t){t?this.showSuggestions():this.hideSuggestions()};this.emptyResult=function(){k.insightVisualsGroups=[];k.displayResult={data:false,visuals:false};k.activeSelectIx=-1;k.error.show=false;F.search.requestState=h.idle;F.searchVisuals.requestState=h.idle;F.suggest.requestState=h.idle;k.searchTerms=[];k.searchTermGroups=[];k.searchVisualsGroups=[];k.matches=[];k.outsideSelection=false;k.$broadcast("toggleActivityIndicator",false);k.forcePartials=false;k.focusState.reset();this.hideSuggestions();V.removeClass("queryon")};this.moveActiveResult=function(t){k.showMeMoreFocus=false;if(0===t)return;if(t>0){k.activeSelectIx=Math.min(k.activeSelectIx+1,k.searchTermGroups.length);k.activeSelectIx=Math.min(k.activeSelectIx,k.paging.totalRows-1);k.activeSelectIx===k.searchTermGroups.length&&(k.showMeMoreFocus=true)}else t<0&&(k.activeSelectIx=Math.max(k.activeSelectIx-1,0))};this.searchVisuals=function(t){if(!k.isObjectsFeature)return;P(k,T.find("body").height()-H);if(0===t.length)return;F.searchVisuals.idCounter=F.searchVisuals.idCounter+1;var e=F.searchVisuals.idCounter,n=this,i={qAttributes:["qProperty"],qCharEncoding:"Utf16"},a=w(f.visuals,0,-1,20);F.searchVisuals.requestState=h.pending;F.searchVisuals.searchTerms=t;function s(t){k.searchVisualsGroups=[];if(e===F.searchVisuals.idCounter&&F.searchVisuals.requestState===h.pending){F.searchVisuals.requestState=h.idle;F.searchVisuals.searchTerms="";$.transformResult(k,t)}}function r(t){if(t.code===l.NxLocalizedErrorCode.LOCERR_SEARCH_TIMEOUT){n.emptyResult();n.showError(t)}if(t.code===l.NxLocalizedErrorCode.LOCERR_GENERIC_ABORTED)return;F.searchVisuals.requestState=h.idle;F.searchVisuals.searchTerms="";k.displayResult.visuals=false}k.app[f.visuals](i,t,a).then(s,r)};this.search=function(t){P(k,T.find("body").height()-H);k.focusState.reset();if(0===t.length)return;V.addClass("queryon");F.search.idCounter=F.search.idCounter+1;var e=F.search.idCounter,n=this,i=w(f.data,0,5,5);F.search.requestState=h.pending;F.search.searchTerms=t;k.$broadcast("toggleActivityIndicator",true);k.$broadcast("resultScrollToTop");function a(n){k.searchTermGroups=[];k.matches=[];if(e===F.search.idCounter&&F.search.requestState===h.pending){F.search.requestState=h.idle;F.search.searchTerms="";k.searchTerms=t;k.$broadcast("toggleActivityIndicator",false,true);k.$broadcast("resultScrollToTop");$.transformResult(k,n);k.activeSelectIx=-1;k.paging.lastRowIx=k.searchTermGroups.length;k.paging.totalRows=n.qTotalNumberOfGroups}}function s(t){if(t.code===l.NxLocalizedErrorCode.LOCERR_SEARCH_TIMEOUT){n.emptyResult();n.showError(t)}if(t.code===l.NxLocalizedErrorCode.LOCERR_GENERIC_ABORTED)return;F.search.requestState=h.idle;F.search.searchTerms="";k.displayResult.data=false}k.error.show=false;this.callSearch(t,i).then(a,s)};this.loadNextPage=function(){P(k,O.find(".qv-global-search-dimmer").height());var t=w(f.data,k.paging.lastRowIx,5,5),e=this;if(F.result.requestState!==h.idle)return;F.result.requestState=h.pending;k.showMeMoreFocus=false;k.$broadcast("toggleActivityIndicator",true);function n(t){F.result.requestState=h.idle;k.$broadcast("toggleActivityIndicator",false,true);$.transformResult(k,t);k.paging.lastRowIx=k.searchTermGroups.length}function i(){if(i.code===l.NxLocalizedErrorCode.LOCERR_SEARCH_TIMEOUT){e.emptyResult();e.showError(i)}if(i.code===l.NxLocalizedErrorCode.LOCERR_GENERIC_ABORTED)return;F.search.requestState=h.idle;F.search.searchTerms="";k.displayResult.data=false}this.callSearch(k.searchTerms,t).then(n,i)};this.callSearch=function(t,e){return k.app[f.data](C(true),t,e)};this.closeSearch=function(){if(k.isSmallDevice){B.emptyResult();k.query="";k.$broadcast("blurInput")}else M.toggleGlobalSearch(k.app)};this.suggest=function(t){if(0===t.length)return;var e=this;F.suggest.idCounter=F.suggest.idCounter+1;var n=F.suggest.idCounter;F.suggest.requestState=h.pending;F.suggest.suggestTerms=t;function i(t){if(b.getFlag("CAO_MOBILE")){var i=t.qFieldNames.map(function(t){return{qValue:t,qTerm:0}});t.qSuggestions=t.qSuggestions.concat(i)}F.suggest.suggestTerms="";if($.isWhiteSpaceAt(k.query,k.query.length-1)||'"'===k.query.charAt(k.query.length-1))return;if(n===F.suggest.idCounter&&F.suggest.requestState===h.pending){$.transformSuggest(k,t,10);e.toogleSuggestions(k.suggestions.length>0);k.$broadcast("suggestShow",true,true)}F.suggest.requestState=h.idle}function a(t){t.code===l.NxLocalizedErrorCode.LOCERR_SEARCH_TIMEOUT&&(t.isHandled=true);if(t.code===l.NxLocalizedErrorCode.LOCERR_GENERIC_ABORTED)return;F.suggest.requestState=h.idle;F.suggest.suggestTerms=""}k.app.searchSuggest({},t).then(i,a)};this.select=function(t,e){k.$broadcast("blurInput");if(0===t.length||0===k.searchTermGroups.length)return;if(e<0){e=0;k.activeSelectIx=0}var n=[],i=[];$.getUnderlinersAndSearchTerms(k.query,n,i);var a=i;k.app.selectAssociations(C(),t,e).then(function(){k.isSearchHistoryFeature&&k.historyPermission&&m.createEntryInHistory(k,a)});this.emptyResult();k.query="";p.treatAsDesktop()&&!k.isSearchHistoryFeature&&k.$broadcast("focusInput")};this.setTestSearchTermGroups=function(t){k.searchTermGroups=t};this.onNavigateToSheet=function(t){var e=[],n=[];$.getUnderlinersAndSearchTerms(k.query,e,n);k.isSearchHistoryFeature&&k.historyPermission&&""!=k.query&&m.createEntryInHistory(k,n);if(p.treatAsDesktop()){B.emptyResult();k.query="";k.isSearchHistoryFeature?k.$broadcast("blurInput"):k.$broadcast("focusInput")}else D(function(){B.emptyResult();k.query=""},200);d.highlightedCell(t)};this.showMoreHitsForVisual=function(t){var e={qOffset:0,qCount:1,qGroupOptions:[{qGroupType:"GenericObjectsType",qOffset:t.itemIndex,qCount:1}],qGroupItemOptions:[{qGroupItemType:"GenericObject",qOffset:0,qCount:t.qItemMatches.length+15}]};return k.app[f.visuals]({qAttributes:["qProperty"]},k.searchTerms,e).then(function(e){$.showMore(e,t);return t})};this.showHistory=function(t){k.searchInputFocused=t};this.setQueryFromHistory=function(t){k.ignoreQueryChange=false;t>=0&&(k.query=k.searchHistory[t]);this.showHistory(false);k.$broadcast("focusInput");b.getFlag("CAO_MOBILE")&&k.query&&k.getInsightsCharts(k.query)};this.clearHistory=function(){m.clearSearchHistory(k);this.showHistory(false)};this.removeHistory=function(t){m.removeSingleHistory(k,t)}}return k}.apply(e,i),void 0!==a&&(t.exports=a))},874:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(184),n(49),n(221)],a=function(t,e,n){function i(i,a,s){var r,o,l=i.find("input")[0],c=t.getService("$document");r={preventDefault:false,allowInInput:true,delay:0};o={preventDefault:false,allowInInput:true,delay:75};a.focusState.ActiveStateChanged.bind(u);function u(){a.activeSelectIx=a.focusState.activeStateName===a.focusState.Results?0:-1;a.activeHistoryIx=a.focusState.activeStateName===a.focusState.History?0:-1;a.activeSuggestionIx=a.focusState.activeStateName===a.focusState.Suggestions?0:-1;a.activeVisualIx=a.focusState.activeStateName===a.focusState.Visuals?0:-1;a.$broadcast(a.focusState.activeStateName===a.focusState.Visuals?"visualsGroupFocus":"visualsGroupBlur")}function d(){return"INPUT"===c[0].activeElement.tagName}function p(){e.preventDefault();t.$rootScope.$apply()}function h(t){var e,n,i;if(document.selection&&document.selection.createRange){e=document.selection.createRange();n=e.getBookmark();i=n.charCodeAt(2)-2}else t.setSelectionRange&&(i=t.selectionStart);return i===t.value.length}function f(){d()?a.focusState.activeStateName===a.focusState.Suggestions?s.hideSuggestions():a.query?a.query="":a.close():a.close();p()}function g(){if(a.focusState.activeStateName===a.focusState.Suggestions){a.activeSuggestionIx=a.activeSuggestionIx>0?a.activeSuggestionIx-1:a.suggestions.length-1;p()}else if(a.focusState.activeStateName===a.focusState.Visuals){a.$broadcast("visualsGroupMoveActiveVisual",-1);p()}}function v(){if(a.focusState.activeStateName===a.focusState.Suggestions){a.activeSuggestionIx=(a.activeSuggestionIx+1)%a.suggestions.length;p()}else if(a.focusState.activeStateName===a.focusState.Visuals){a.$broadcast("visualsGroupMoveActiveVisual",1);p()}}function m(){var t=a.focusState.activeStateName;a.focusState.previous();if(t===a.focusState.activeStateName)switch(a.focusState.activeStateName){case a.focusState.History:a.activeHistoryIx=Math.max(-1,a.activeHistoryIx-1);break;case a.focusState.Results:s.moveActiveResult(-1);break}p()}function b(){var t=a.focusState.activeStateName;a.focusState.next();if(t===a.focusState.activeStateName)switch(a.focusState.activeStateName){case a.focusState.History:a.activeHistoryIx=Math.min(a.activeHistoryIx+1,a.searchHistory.length-1);break;case a.focusState.Results:s.moveActiveResult(1);break}p()}function y(t){switch(a.focusState.activeStateName){case a.focusState.History:s.setQueryFromHistory(a.activeHistoryIx);break;case a.focusState.Input:a.isPartials()?s.setShowPartialMatches():a.displaySuggestions?S(t,true):a.displayResult.data?n.getFlag("CAO_MOBILE")||s.select(a.searchTerms,0):s.showNoResultsMessage()&&a.haveUnlockedSelections()&&s.searchOutsideSelections();break;case a.focusState.Suggestions:S(t,true);break;case a.focusState.Visuals:a.$broadcast("selectActiveVisualItem");break;case a.focusState.Partials:s.setShowPartialMatches();break;case a.focusState.Results:a.showMeMoreFocus?s.loadNextPage():s.select(a.searchTerms,a.activeSelectIx);break;case a.focusState.StartNewSearch:s.searchOutsideSelections();break}n.getFlag("CAO_MOBILE")&&a.query&&a.getInsightsCharts(a.query);p()}function S(t,e){if(a.displaySuggestions&&(e||h(l))){a.activeSuggestionIx=-1===a.activeSuggestionIx?0:a.activeSuggestionIx;a.onSuggestSelect()}p()}function I(){s.closeSearch();p()}this.keyboardShortcutsGroup=e.createGroup("global-search-"+a.app.id,1);this.keyboardShortcutsGroup.registerKeys("esc",f,r);this.keyboardShortcutsGroup.registerKeys("left",g,o);this.keyboardShortcutsGroup.registerKeys("right",v,o);this.keyboardShortcutsGroup.registerKeys("up",m,o);this.keyboardShortcutsGroup.registerKeys("down",b,o);this.keyboardShortcutsGroup.registerKeys("enter",y,r);this.keyboardShortcutsGroup.registerKeys("tab",S,r);this.keyboardShortcutsGroup.registerKeys("ctrl+f",I,r);this.keyboardShortcutsGroup.on();this.on=function(){this.keyboardShortcutsGroup.on()};this.off=function(){this.keyboardShortcutsGroup.off()};this.delete=function(){this.keyboardShortcutsGroup.delete();a.focusState.ActiveStateChanged.unbind(u)}}return i}.apply(e,i),void 0!==a&&(t.exports=a))},875:function(t,e,n){"use strict";var i,a;!(i=[n(91)],a=function(t){function e(t){return t.libId?t.libIdLabel?t.libIdLabel:"Unknown master item":t.aggr?t.aggr+"("+t.field+")":t.field}function n(n,i){var a=i.filter(function(t){return void 0!==t}).length;var s=n&&n.filter(function(t){return Object.keys(t.msgParams).length===a});var r=null;s&&s.forEach(function(t){if(t.msgParams){var e=t.msgParams;var n=Object.keys(e);var a=true;n.forEach(function(t){var e=i.some(function(e){return e.slot&&e.slot===t});e||(a=false)});a&&(r=t)}});if(!r)return"";var o=[void 0,void 0,void 0,void 0,void 0];Object.keys(r.msgParams).forEach(function(t){var n=i.filter(function(e){return e.slot===t})[0];var a=e(n);o[r.msgParams[t]]=a});return t.get(r.msgId,o)}return{findTitleForChart:n}}.apply(e,i),void 0!==a&&(t.exports=a))},876:function(t,e,n){"use strict";var i,a;!(i=[n(89)],a=function(t){function e(t,e,n,i){this.chartId=t;this.searchReport=n;this.app=i;this.type="found";this.analysisPrecedentId="found";this.appearsOnSheets=e}e.prototype.getTitle=function(){var e=new t;this.app.getObject(this.chartId).then(function(t){t.getLayout().then(function(t){e.resolve(t.title)})});return e.promise};e.prototype.getMatchDetails=function(){var t=[];var e=this.chartId;if(this.searchReport.search){var n=this.searchReport.search["chartFinder-Title"].searchHits;Object.keys(n).forEach(function(i){if(i.includes(e)){var a=n[i].matchingTypes;a.forEach(function(e){t.push({matchedOn:n[i].title,matchedField:e})})}})}return t};e.prototype.getChartType=function(){var e=new t;this.app.getObject(this.chartId).then(function(t){t.getLayout().then(function(t){e.resolve(t.visualization)})});return e.promise};e.prototype.loadChart=function(e){var n=new t;e.getObject(this.chartId).then(function(t){t.getProperties().then(function(e){n.resolve({model:t,options:{interactionState:0,showTitles:false},properties:e})})});return n.promise};return e}.apply(e,i),void 0!==a&&(t.exports=a))},880:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(92),n(404),n(128),n(89),n(367),n(49),n(114),n(123),n(196)],a=function(t,e,n,i,a,s,r,o,l,c){var u=e.extend("CaoChartUiModel",{init:function e(n,i){this.app=i;this.zoomed=false;this.ObjectPlacementService=t.getService("qvObjectPlacementService");this.CaoChartService=t.getService("qvCaoChartService");this.$timeout=t.getService("$timeout");this.chart=n;this.object={};this.zoomedObject={};this.options={};this.zoomedOptions={};this.state="READY";this.modified=false;this.chartTypeImageUrl=void 0;this.chartType=void 0;this.rendered=false;this.renderedCount=0;this.insightFeedback=r.getFlag("CE_PRECEDENTS");this.interaction=true},updateState:function t(e){this.state=e},isHidden:function t(){if(this.isFound())return false;return this.insightFeedback&&this.chart.visualization.visualization.analysis.precedents&&this.chart.visualization.visualization.analysis.precedents.disliked||this.chart.invalidFromLearning},isRendered:function t(){return this.rendered},isFound:function t(){return"found"===this.chart.visualization.type},isGenerated:function t(){return"generated"===this.chart.visualization.type},isModified:function t(){return this.modified},setState:function t(e){this.state=e},setModified:function t(e){this.modified=e},setType:function t(e){this.chart.visualization.type=e},refreshChartType:function t(){var e=this;e.chart.visualization.getChartType().then(function(t){e.chartType=t;e.chartTypeImageUrl=n.getImageNameFromChartType(t)})},getTitle:function t(){return this.chart.visualization.getTitle().then(function(t){return t})},getComplexity:function t(){return this.chart.complexity},getRelevance:function t(){return this.chart.relevance},getMatchRecord:function t(){return this.chart.visualization.visualization.matchRecord},getState:function t(){return this.state},getModel:function t(){return this.chart.model},getObject:function t(){return this.zoomed?this.zoomedObject:this.object},getAnalysisPrecedentId:function t(){return this.chart.visualization.analysisPrecedentId},getMatchDetails:function t(){return this.chart.visualization.getMatchDetails()},getSheetsThisChartAppearsOn:function t(){return this.chart.visualization.appearsOnSheets},getMatches:function t(){return this.chart.visualization.visualization.matchRecord.matches},getFields:function t(){return this.getMatches().filter(function(t){return!t.slotRole})},getMeasures:function t(){return this.getMatches().filter(function(t){return t.slotRole===c.MEASURE})},getDimensions:function t(){return this.getMatches().filter(function(t){return t.slotRole===c.DIMENSION})},getChartType:function t(){return this.chart.visualization.visualization.analysis.analysis},getSearchReport:function t(){return this.chart.visualization.searchReport},getAnalysis:function t(){return this.chart.visualization.visualization.analysis},isObjectInvalid:function t(){return this.zoomed?this.zoomedObject.invalid:this.object.invalid},isViewDataToggled:function t(){return this.zoomed?this.zoomedObject.viewDataToggled:this.object.viewDataToggled},isDataViewSupported:function t(){return this.zoomed?this.zoomedObject.supportViewData&&this.zoomedObject.supportViewData():this.object.supportViewData&&this.object.supportViewData()},toggleDataView:function t(){if(this.zoomed)return this.zoomedObject.toggleDataView();return this.object.toggleDataView()},activateSelectionWatch:function t(e){this.object.selectionsApi.watchActivated(e)},deactivateSelectionWatch:function t(e){this.object.selectionsApi.watchDeactivated(e)},adaptChart:function t(e){var n=this;return this.CaoChartService.adaptRecommendation(n.chart.visualization.visualization,n.app).then(function(t){n.chart.visualization=new s({analysis:t.analysis,matchRecord:t.matchRecord},n.chart.visualization.searchReport,t.properties);delete n.rendered;n.isViewDataToggled()?n.toggleDataView().then(function(){n.shouldRedraw=true}):n.shouldRedraw=true;n.recalculateConfidence=e})},addToNewSheet:function t(){var e=this;return e.chart.model.getProperties().then(function(t){return e.ObjectPlacementService.addToNewSheet(t).then(function(t){e.setType("found");e.chart.visualization.appearsOnSheets.push(t.id);return t})})},addToSheet:function t(e){var n=this;return n.chart.model.getProperties().then(function(t){return n.ObjectPlacementService.addObjectToSheet(t,e,i.getModel()).then(function(t){n.setType("found");n.chart.visualization.appearsOnSheets.push(t.id);return t})})},setChartInteraction:function t(e){if(this.zoomed&&this.zoomedObject&&this.interaction!==e){this.interaction=e;e?this.zoomedObject.on():this.zoomedObject.off()}},setChartInteractionState:function t(e){this.options.interactionState=e},destroyChart:function t(){var e=this;if(e.zoomed){e.zoomed=false;return}if("LOADING"===e.state||"LOADED"===e.state){if(!e.rendered&&e.object&&e.object.subscription){e.rendered=false;e.object.cancel()}e.isGenerated()&&e.chart.model&&e.chart.model.id&&!e.zoomed?e.app.destroySessionObject(e.chart.model.id).then(function(){e.rendered=false;e.state="READY"}):e.state="READY"}},initializeOptions:function t(){this.options={};this.zoomedOptions={};this.options.isReadonly=false;this.options.isPopover=false;this.options.selectionsDisabled=true;this.options.interactionState=l.STATIC;this.options.direction=o.direction;this.zoomedOptions.isReadonly=false;this.zoomedOptions.isPopover=false;this.zoomedOptions.selectionsDisabled=false;this.zoomedOptions.interactionState=l.ANALYSIS;this.zoomedOptions.direction=o.direction},loadChart:function t(e){var n=this;var i=new a;var s;if(n.rendered){n.setState("LOADED");e();i.resolve()}else{n.initializeOptions();var r=n.chart.model?n.app.destroySessionObject(n.chart.model.id):a.when({});r.then(function(){n.chart.visualization.loadChart(n.app).then(function(t){n.object&&n.object.type&&(n.object.type=null);n.zoomedObject&&n.zoomedObject.type&&(n.zoomedObject.type=null);n.chart.model=t.model;n.state="LOADED";function a(){s&&n.$timeout.cancel(s)}var r=function t(){if(n.zoomed){n.renderedCount++;if(n.renderedCount<2)return}n.renderedCount=0;n.rendered=true;e&&e();n.state="LOADED";a();i.resolve()};n.options.onRendered=r;n.zoomedOptions.onRendered=r;var o=function t(){a();i.resolve()};n.options.onCanceled=o;n.zoomedOptions.onCanceled=o;s=n.$timeout(function(){if(!n.allowLongLoad&&!n.rendered&&n.object&&n.object.subscription){n.object.subscription.cancel();n.zoomedObject&&n.zoomedObject.subscription&&n.zoomedObject.subscription.cancel();n.state="MANUAL_LOAD";i.resolve()}},n.chart.suggestedTimeout)},function(){i.resolve()})})}return i.promise}});return u}.apply(e,i),void 0!==a&&(t.exports=a))},881:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={};Object.defineProperties(t,{idle:{value:0},pending:{value:1}});return t}.apply(e,i),void 0!==a&&(t.exports=a))},882:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={};Object.defineProperties(t,{data:{value:"searchResults"},visuals:{value:"searchObjects"},indexProgress:{value:"GetProgress"}});return t}.apply(e,i),void 0!==a&&(t.exports=a))},883:function(t,e,n){"use strict";var i,a;!(i=[n(102)],a=function(t){function e(n,i){var a=n[i];if(!(this instanceof e))throw new Error("FocusState needs to be called with the new keyword");if(!a)throw new Error("Invalid initialStateName provided");t.mixin(this);this.notification("ActiveStateChanged");Object.defineProperties(this,{initialState:{value:a},activeState:{configurable:true,value:a},activeStateName:{configurable:true,value:a.name}})}e.prototype.next=function(){var t=this.activeState;if(t.onBeforeNext&&!t.onBeforeNext())return;var e=t.next();while(e){if(!e.onBeforeEnter||e.onBeforeEnter()){n(this,e);return}e=e.next()}};e.prototype.previous=function(){var t=this.activeState;if(t.onBeforePrevious&&!t.onBeforePrevious())return;var e=t.previous();while(e){if(!e.onBeforeEnter||e.onBeforeEnter()){n(this,e);return}e=e.previous()}};e.prototype.reset=function(){n(this,this.initialState)};i(e,"Input");i(e,"Suggestions");i(e,"History");i(e,"Partials");i(e,"Visuals");i(e,"SuggestedCharts");i(e,"Results");i(e,"StartNewSearch");function n(t,e){Object.defineProperties(t,{activeState:{value:e},activeStateName:{value:e.name}});t.ActiveStateChanged.emit()}function i(t,e){var n={value:e};Object.defineProperty(t,e,n);Object.defineProperty(t.prototype,e,n)}return e}.apply(e,i),void 0!==a&&(t.exports=a))},884:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){function t(t,i,a){var s={};n(s,t.Input,{previous:function t(){return false},onBeforeNext:function t(){return!a.throbber.show},next:e.bind(s,t.Suggestions)});n(s,t.Suggestions,{onBeforeEnter:function t(){return!!a.displaySuggestions},previous:e.bind(s,t.Input),next:e.bind(s,t.History)});n(s,t.History,{onBeforeEnter:function t(){return a.isSearchHistoryFeature&&a.searchInputFocused&&0===a.query.length},onBeforeNext:function t(){return false},onBeforePrevious:function t(){return 0===a.activeHistoryIx},previous:e.bind(s,t.Suggestions),next:e.bind(s,t.Visuals)});n(s,t.Visuals,{onBeforeEnter:function t(){return a.isObjectsFeature&&a.displayResult.visuals&&!a.isSmallDeviceLandscape},previous:e.bind(s,t.History),next:e.bind(s,t.Partials)});n(s,t.Partials,{onBeforeEnter:function t(){return!!a.displayResult.data&&a.isPartials()},previous:e.bind(s,t.Visuals),next:e.bind(s,t.Results)});n(s,t.Results,{onBeforeEnter:function t(){return!!a.displayResult.data&&(!a.isPartials()||a.forcePartials)},onBeforeNext:function t(){return false},onBeforePrevious:function t(){return 0===a.activeSelectIx},previous:e.bind(s,t.Partials),next:e.bind(s,t.StartNewSearch)});n(s,t.StartNewSearch,{onBeforeEnter:function t(){return i.showNoResultsMessage()&&a.haveUnlockedSelections()},previous:e.bind(s,t.Results),next:function t(){return false}});return s}function e(t){var e=this[t];if(!e)throw new Error("Invalid stateName provided");return e}function n(t,e,n){if(t[e])throw new Error("State with name '"+e+"' already exists");n.name=e;t[e]=n}return t}.apply(e,i),void 0!==a&&(t.exports=a))},885:function(t,e,n){"use strict";var i,a;!(i=[n(54),n(886)],a=function(t,e){function n(t){return t.app.id+"."+t.userID+".smartSearch.history"}function i(t){t.storage=o(t);if("NONE"==t.storage)return;var e=n(t);if(t.storage.contains(e)){var i=f(t.storage.get(e));return i}}function a(t,e){var i=n(t),a=[],s=[];if(t.storage.contains(i)){a=t.storage.get(i);s=l(e);var r=c(s,a);var o=f(r);t.storage.set(i,r);t.searchHistory=o}else{s=l(e);a.unshift(s);t.storage.set(i,a);var u=f(a);t.searchHistory=u}}function s(t){var e=n(t);if(t.storage.contains(e)){t.searchHistory=[];t.storage.remove(e)}}function r(t,e){var i=n(t);if(t.storage.contains(i)){var a=t.storage.get(i);a.splice(e,1);t.storage.set(i,a);var s=f(a);t.searchHistory=s}}function o(t){if("DESKTOP"==t.userID){t.historyPermission=true;return e}if(t.userID&&"anonymous"!=t.userID.substring(0,9)){t.historyPermission=true;return e}t.historyPermission=false;return"NONE"}function l(t){return t.map(function(t){return t.startQuote&&t.endQuote?t.string='"'+t.string+'"':t.string})}function c(t,e){var n=d(e);var i=p(t);var a=h(n,i);var s=[];if(a>=0){e.splice(a,1);e.unshift(t);s=u(e)}else{e.unshift(t);s=u(e)}return s}function u(t){t.length>4&&(t.length=4);return t}function d(t){function e(t){return t.toLowerCase()}return t.map(function(t){return t.map(e)})}function p(t){return t.map(function(t){return t.toLowerCase()})}function h(e,n){for(var i=0;i<e.length;i++)if(t.isEqual(e[i],n))return i}function f(t){return t.map(function(t){return t.join(" ")})}return{initHistory:i,createEntryInHistory:a,clearSearchHistory:s,removeSingleHistory:r,getStoragePath:n}}.apply(e,i),void 0!==a&&(t.exports=a))},886:function(t,e,n){"use strict";var i,a;!(i=[n(54),n(118)],a=function(t,e){var n="sessionstorageservice";function i(e){if(!t.isString(e))throw new Error('The key "'+e+'" is not a String.');return n+"."+e}function a(e,n,a){var s=(new Date).getTime(),r,o;if(!t.isString(e))throw new Error('The key "'+e+'" is not a String.');if(!t.isObject(n))throw new Error('The value "'+n+'" for the key "'+e+'" is not valid object.');if(a){if(!t.isNumber(a))throw new Error('The time to live value "'+a+'" is not numeric.');a+=s}o={timeToLive:a,value:n};r=JSON.stringify(o);sessionStorage[i(e)]=r}function s(e){if(!t.isString(e))throw new Error('The key "'+e+'" is not a String.');var n=t.isEmpty(sessionStorage[i(e)]);return!n}function r(e,n){if(!t.isString(e))throw new Error('The key "'+e+'" is not a String.');if(!s(e)){if(void 0!==n)return n;throw new Error('There is no data set for the key "'+e+'". Please use contains() first to verify you should actually do a get().')}var i=o(e);return i.value}function o(t){var e=JSON.parse(sessionStorage[i(t)]);return e}function l(e){if(!t.isString(e))throw new Error('The key "'+e+'" is not a String.');if(!s(e))throw new Error('There is no data set for the key "'+e+'". Please use contains() first to verify you should actually do a get().');delete sessionStorage[i(e)]}function c(){var i,a,s;for(i in sessionStorage)if(e.startsWith(i,n)){i=i.substring(n.length+1);a=o(i);s=(new Date).getTime();t.isNumber(a.timeToLive&&s>a.timeToLive)&&l(i)}}return{set:a,get:r,contains:s,clean:c,remove:l}}.apply(e,i),void 0!==a&&(t.exports=a))},887:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(91),n(90),n(888),n(889),n(139),n(96),n(99),n(169)],a=function(t,e,n,i,a,s,r,o,l){var c=null;function u(t,e){var n;if(t.length!==e.length)return false;for(n=0;n<t.length;++n)if(t[n]!==e[n])return false;return true}e.directive("qvGlobalSearchInput",["$timeout","qvGlobalSearchDataService",function(s,r){return{restrict:"E",replace:true,template:a,require:"^qvGlobalSearch",link:function a(d,p,h,f){var g=p.find("input"),v=[],m=e.getService("$document");g.on("keydown",function(){d.ignoreQueryChange=false});d.$watch("isSelectActiveInSmallDevice",function(t){d.autoFocus=!i.isIos()&&!i.isAndroid()&&!t});d.placeholder=n.get("GlobalSearch.SearchData");function b(e){if(d.isInputFocused){if(1===t(e.target).closest(".qv-global-search-suggest").length||1===t(e.target).closest(".qv-search-last-history").length)return;e.preventDefault();e.stopPropagation();o.preventGestures(this.gestureHandler);d.$apply(function(){f.hideSuggestions();f.hideSoftKeyboard()})}}d.isObjectsFeature&&!l.treatAsDesktop()&&p.on("qv-outside",b);d.$watch("query",function(t){var e=[],n,i;s.cancel(c);f.showHistory(d.isSearchHistoryFeature&&d.isInputFocused&&0===d.query.length);d.ignoreQueryChange||f.resetSuggestions();if(!t||0===t.length){f.emptyResult();d.underlines.length=0;v=[];return}r.getUnderlinersAndSearchTerms(t,d.underlines,e);if(d.ignoreQueryChange){d.ignoreQueryChange=false;return}c=s(function(){if(r.isWhiteSpaceAt(t,t.length-1)||'"'===t.charAt(t.length-1))f.hideSuggestions();else{i=r.getSuggestTerms(t,e);f.suggest(i)}n=e.map(function(t){return t.string});if(e.length>0&&!u(n,v)){f.searchVisuals(n);f.search(n)}else t.length<r.getMinQueryLength()&&f.emptyResult();v=n;c=null},200)});d.$watch("isInputFocused",function(t){d.isSmallDevice&&(t?m.find("body").animate({scrollTop:p.offset().top},100):d.isObjectsFeature&&o.utils.touch&&f.hideSuggestions());d.isSearchHistoryFeature&&t&&0===d.query.length&&f.showHistory(true)});d.$on("focusInput",function(){g.focus()});d.$on("blurInput",function(){g.blur()});d.$on("$destroy",function(){g.off()})}}}]);e.directive("qvGlobalSearchInputHint",["qvGlobalSearchDataService",function(t){return{restrict:"E",replace:true,template:s,require:"^qvGlobalSearch",link:function e(n){function i(){var e=n.suggestions[-1===n.activeSuggestionIx?0:n.activeSuggestionIx],i=[],a=[],s,o,l,c,u;t.getUnderlinersAndSearchTerms(n.query,i,a);s=t.getSuggestTerms(n.query,a);if(!n.displaySuggestions||n.suggestions.length<=0||0===s.length)return;o=t.getUnderlineLengthFromTermIx(i,e.term);c=i.slice(o).reduce(function(t,e){return t+(e.isWhitespace?" ":e.string)},"");l=r.string(c).length;c=r.string(e.value).slice(0,l);u=r.string(e.value).slice(l);n.ignoreQueryChange=true;n.hintString=u}n.$watch("activeSuggestionIx",function(){i()});n.$watchCollection("suggestions",function(){i()});n.$watch("displaySuggestions",function(){i()})}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},888:function(t,e){t.exports='<div class="qv-search-input" ng-class="{\'focus\': isInputFocused}">\n\t<div class="search-field-area">\n\t\t<lui-search class="search-field" query="query" auto-focus="autoFocus" autocomplete="\'off\'" is-focused="isInputFocused" tid="globalSearch.searchField" placeholder="{{placeholder}}" />\n\t</div>\n\t<div class="search-underlines">\n\t\t<span ng-repeat="underline in underlines" class="underline" ng-class="underline.isWhitespace ? \'term-space\' : \'term\' + underline.colorIx">{{underline.string}}</span><qv-global-search-input-hint></qv-global-search-input-hint>\n\t</div>\n</div>\n'},889:function(t,e){t.exports='<span ng-show="displaySuggestions" class="search-suggest" tid="globalSearch.suggestionString">{{hintString}}</span>\n'},890:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(891),n(892),n(893),n(96),n(99),n(49),n(370),n(895)],a=function(t,e,n,i,a,s,r){var o={INITIAL:0,VISUALS_DOCKED:1,DATA_DOCKED:2};t.directive("qvGlobalSearchResult",["$timeout",function(t){return{restrict:"E",template:e,replace:true,require:["^qvGlobalSearch","qvGlobalSearchResult"],controller:function t(){this.getElement=function(){};this.setDockState=function(){}},link:function e(n,i,l,c){var u=c[0],d=c[1],p,h,f=function e(){var a=this,r=0;s.treatAsDesktop()&&!h&&(h=i.find(".qv-smartsearch-visuals-group"));t(function(){if(h&&h.length){r=h[0].offsetTop+h[0].offsetHeight-33;n.fixedbar=a.scrollTop>r}n.scrollShow=a.scrollHeight-a.scrollTop>a.clientHeight})},g=!s.treatAsDesktop()&&n.isObjectsFeature?i.find(".data-container"):i;n.dockState=o.INITIAL;n.caoMobile=r.getFlag("CAO_MOBILE");n.emptyMessageEnabled=false;n.fixedbar=false;n.classes={"qv-global-search-result-throbber-open":n.activity.show,"with-objects":n.isObjectsFeature&&!n.isSmallDeviceLandscape};n.$watch("isObjectsFeature && !isSmallDeviceLandscape",function(t){n.classes["with-objects"]=t});n.$watch("activity.show",function(t){n.classes["qv-global-search-result-throbber-open"]=t});n.$watch(function(){return n.showNoResultsMessage()},function(t){n.classes["noresults"]=t});n.select=function e(i,s){if(a.utils.touch){n.activeResultIx=s;t(function(){u.select(n.searchTerms,i.qId)},100)}else u.select(n.searchTerms,i.qId)};n.loadNextPage=function t(){u.loadNextPage()};d.getElement=function(){return i};d.setDockState=function(e){t(function(){n.dockState=e;n.classes["visuals-docked"]=e===o.VISUALS_DOCKED;n.classes["data-docked"]=e===o.DATA_DOCKED})};n.setShowPartialMatches=function(){u.setShowPartialMatches()};n.showNoResultsMessage=function(){var t;t=n.caoMobile?n.emptyMessageEnabled&&n.searchTerms.length>0&&!n.displayResult.data&&!n.error.show&&!n.activity.show&&0===n.insightVisualsGroups.length&&!n.fetchingInsightChartsPending||n.error.show:n.emptyMessageEnabled&&n.searchTerms.length>0&&!n.displayResult.data&&!n.error.show&&!n.activity.show||n.error.show;return t};u.showNoResultsMessage=function(){return n.showNoResultsMessage()};n.resetDockState=function(){n.dockState=o.INITIAL;s.treatAsDesktop()&&g.animate({scrollTop:0},300,"swing")};p=n.$watch(function(){return g[0]&&g[0].scrollHeight?g[0].scrollHeight:0},function(t){t&&(n.scrollShow=t>g[0].clientHeight)});g.on("scroll",f);n.$on("resultScrollToTop",function(){i[0].scrollTop=0});n.$on("$destroy",function(){p();g.off("scroll",f)})}}}]);t.directive("qvScrollToActive",function(){return{restrict:"A",require:"^qvGlobalSearchResult",link:function t(e,n,i,a){i.$observe("qvScrollToActive",function(t){t=t+""==="true";n.toggleClass("active",t);if(t){var e=a.getElement(),i=n.position();i.top<0?e[0].scrollTop=n[0].offsetTop:i.top+n.height()>e.height()&&n[0].scrollIntoView(false)}})}}});t.directive("qvGlobalSearchResultMsg",function(){return{restrict:"E",template:n,replace:true,require:["^qvGlobalSearch","^qvGlobalSearchResult"],link:function t(e){e.capUnderlineMaxNumber=6}}});t.directive("qvGlobalSearchNoResults",function(){return{restrict:"E",template:i,replace:true,require:["^qvGlobalSearch","^qvGlobalSearchResult"],link:function t(){}}})}.apply(e,i),void 0!==a&&(t.exports=a))},891:function(t,e){t.exports='<div class="qv-global-search-result" ng-class="classes" >\n\n\t<qv-global-search-suggest ng-if="displaySuggestions" class="qv-global-search-suggest" qv-scroll-to-active="{{activeSelectIx === -1 && focusState.activeStateName === focusState.Suggestions}}"></qv-global-search-suggest>\n\n\t<h3 ng-if="isObjectsFeature && ( displayResult.data || showNoResultsMessage() ) && matches.length > 0" class="title-section title-selections" >\n\t\t<span q-translation="GlobalSearch.Selections"></span>\n\t\t<i ng-click="resetDockState();" class="lui-icon lui-icon--arrow-up"></i>\n\t</h3>\n\n\t<qv-global-search-no-results class="search-no-results-message" ng-show="showNoResultsMessage()" ></qv-global-search-no-results>\n\n\t<div ng-if="(outsideSelection || currentSelections) && (!isPartials() || forcePartials)" class="qv-global-search-result-title strong" >\n\t\t<span ng-if="outsideSelection && !currentSelections" tid="globalSearch.matchesWholeDataset" q-translation="GlobalSearch.MatchesWholeDataset"></span>\n\t\t<span ng-if="currentSelections" tid="globalSearch.addToYourSelections" q-translation="GlobalSearch.AddToYourSelections"></span>\n\t</div>\n\n\t<div ng-repeat="m in matches" class="data-matches-group" ng-if="(!isPartials() || forcePartials)">\n\n\t\t<div ng-if="m !== searchTerms.length" class="caption-flex" q-translation="GlobalSearch.MatchedSearchTerms,{{m}}"></div>\n\n\t\t<div class="content-flex" ng-init="parentIndex = $index" ng-class="{ \'touch-off\':!isSmallDevice }" ng-repeat="row in getSearchTermGroup(m)" qv-scroll-to-active="{{( row.qId === activeSelectIx) && focusState.activeStateName === focusState.Results }}" tid="globalSearch.resultGroup" >\n\n\t\t\t<div class="cell" ng-repeat="item in row.qItems" tid="globalSearch.resultField" ng-class="{ \'maxcell\': !$last && !$first, \'maxcellfirst\': ($first && row.qTotalNumberOfItems > 1) }" >\n\t\t\t\t<div class="group-hits" ng-click="select( row, $parentIndex )" ng-class="{ \'shown\': (item.qTotalNumberOfMatches-item.qItemMatches.length) > 0  }">\n\t\t\t\t\t<span class="field-name" tid="globalSearch.resultField.Name">{{item.qIdentifier}}</span>\n\t\t\t\t\t<span ng-repeat="hit in item.qItemMatches" tid="globalSearch.resultField.Hit">\n\t\t\t\t\t\t<qv-global-search-highlights q-text="hit.qText" q-ranges="hit.qRanges"></qv-global-search-highlights >\n\t\t\t\t\t\t<span>{{$last ? \'\' : \', \'}}</span>\n\t\t\t\t\t</span>\n\t\t\t\t\t<div tid="globalSearch.resultField.MoreHits" ng-if="item.qTotalNumberOfMatches-item.qItemMatches.length > 0" ng-click="onShowMoreHits($event, item, row.qId)" class="more-hits"><span class="more-text" q-translation="GlobalSearch.MoreResults,{{(item.qTotalNumberOfMatches-item.qItemMatches.length)}}"></span></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="more-hits-area-mobile" ng-if="item.qTotalNumberOfMatches-item.qItemMatches.length > 0" tid="globalSearch.resultField.MoreHitsMobile" ng-click="onShowMoreHits($event, item, row.qId)">\n\t\t\t\t\t<button class="lui-button lui-button--rounded">\n\t\t\t\t\t\t<span class="lui-button__icon lui-icon lui-icon--more"></span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div ng-hide="matches.length === 0" qv-scroll-to-active="{{showMeMoreFocus}}" class="show-me-more"><button ng-if="paging.totalRows > paging.lastRowIx && (!isPartials() || forcePartials)" tid="globalSearch.showmemore" ng-click="loadNextPage($event)" class="lui-button" q-translation="GlobalSearch.ShowMeMore" ng-class="{\'lui-active\': showMeMoreFocus }"></button></div>\n\n\t<h3 class="title-section title-navigation" ng-if="displayResult.visuals && !isSmallDeviceLandscape" qv-scroll-to-active="{{focusState.activeStateName === focusState.Visuals}}">\n\t\t<span ng-if="!caoMobile" q-translation="GlobalSearch.Navigations"></span>\n\t\t<span ng-if="caoMobile">{{existingChartGroupTitle}}</span>\n\t\t<i ng-click="resetDockState();" class="lui-icon lui-icon--arrow-down"></i>\n\t</h3>\n\n\t<h3 class="title-section title-landscape" ng-if="displayResult.visuals && isSmallDeviceLandscape">\n\t\t<span class="lui-icon lui-icon--object"></span>\n\t\t<span q-translation="GlobalSearch.RotateForVisuals"></span>\n  </h3>\n  \n\t<qv-smartsearch-visuals-group tid="smartsearch-visuals-group" items="searchVisualsGroups" app="app" search-terms="searchTerms" options="{\'preload\': false}" ng-if="displayResult.visuals " ng-hide="isSmallDeviceLandscape"></qv-smartsearch-visuals-group>\n\n\t<h3 class="title-section title-navigation"\n\t\tng-if="insightVisualsGroups.length > 0 && caoMobile && !isSmallDeviceLandscape"\n\t\tqv-scroll-to-active="{{focusState.activeStateName === focusState.SuggestedCharts}}">\n\t\t<span tid="global.search.suggested.charts.title">{{suggestedChartGroupTitle}}</span>\n\t\t<i ng-click="resetDockState();" class="lui-icon lui-icon--arrow-down"></i>\n  </h3>\n  \n  <div class="insight-charts-unavailable" ng-if="unableTofetchInsightCharts === true" q-translation="GlobalSearch.SuggestedChartsUnavailable"></div>\n\t\n\t<div ng-if="isPartials()" qv-scroll-to-active="{{ focusState.activeStateName === focusState.Partials }}" class="qv-global-search-result-message search-partials-message">\n\t\t<qv-global-search-result-msg></qv-global-search-result-msg>\n\t\t<div>\n\t\t\t<button class="lui-button" ng-click="setShowPartialMatches($event)" tid="globalSearch.showPartialMatches" q-translation="{{ !forcePartials?\'GlobalSearch.ShowPartialMatches\' : \'GlobalSearch.HidePartialMatches\' }}"\n\t\t\t ng-class="{ \'lui-active\': focusState.activeStateName === focusState.Partials }"></button>\n\t\t</div>\n\t</div>\n\n\t<qv-smartsearch-visuals-group tid="smartsearch-visuals-group" items="insightVisualsGroups" app="app" search-terms="searchTerms" options="{\'preload\': false}" ng-if="insightVisualsGroups.length > 0 && caoMobile" ng-hide="isSmallDeviceLandscape"></qv-smartsearch-visuals-group>\n\n\t<div class="fixed-bar" ng-show="fixedbar">\n\t\t<span ng-click="resetDockState();" class="lui-fade-button">\n\t\t\t<span class="lui-fade-button__icon lui-icon lui-icon--arrow-down"></span>\n\t\t</span>\n\t</div>\n\n\t<qv-global-search-throbber></qv-global-search-throbber>\n</div>\n'},892:function(t,e){t.exports='<div class="qv-global-search-result-message-inline">\n    <span ng-if="currentSelections" q-translation="GlobalSearch.NoMatchesWithinCurrentSelection"></span>\n    <span ng-if="!currentSelections" q-translation="GlobalSearch.NoMatchesForYourTerms"></span>\n</div>'},893:function(t,e){t.exports='<div>\n    <div class="qv-global-search-result-groups" ng-if="!error.show">\n\n        <div class="qv-global-search-result-message" >            \n            <qv-global-search-result-msg></qv-global-search-result-msg>\n\n            <div ng-if="haveUnlockedSelections()">\n                <button class="lui-button qv-gs-new-search-button" qva-activate="searchOutsideSelections($event)" tid="globalSearch.newSearchJustFor"\n\t\t\t\t\t\tq-translation="GlobalSearch.ClearSelectionAndSearchAgain" q-title-translation="GlobalSearch.ClearSelectionAndSearchAgain"\n\t\t\t\t\t\tng-class="{ \'lui-active\': focusState.activeStateName === focusState.StartNewSearch }"></button>\n            </div>\n        </div>\n    </div>      \n\n    <div class="qv-global-search-result-error" ng-if="error.show">\n        <span q-translation="{{error.translation}}"></span>\n    </div>\n</div>'},894:function(t,e){t.exports="<span ng-repeat=\"slice in slices track by $index\" ng-class=\"slice.highlight ? 'highlighted' + slice.qTerm : ''\">{{slice.qSliceText}}</span>"},895:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(896),n(50),n(97),n(897),n(899),n(371)],a=function(t,e,n,i){var a={MAX_MOBILE_VISUALS:10,PAGE_VISUALS:3,PAGE_VISUALS_PORTRAIT:2,PADDING_PAGES:15};t.directive("qvSmartsearchVisualsGroup",["$timeout",function(t){return{restrict:"E",template:e,replace:true,scope:{items:"=",searchTerms:"=",options:"=",app:"="},controller:function t(){this.loadPage=function(){};this.preparePages=function(){}},link:function e(s,r,o,l){var c=0;s.pageIndex=0;s.activeVisualIx=-1;s.pages=[];s.objects=null;var u=r.find(".visuals-wrapper"),d=false,p=n.isSmallDevice?400:600,h=function t(){p=n.isSmallDevice?400:600;u[0].scrollLeft=s.pageIndex*(u[0].offsetWidth+a.PADDING_PAGES)},f=function t(){l.preparePages(s.items[0].qItems)};n.OrientationChanged.bind(f);n.ViewChanged.bind(f);s.setPageIndex=function(t){s.pageIndex=t;for(var e=0;e<s.pages.length;e++)s.pages[e].forEach(function(n){s.options.preload?n.load=e===t||e===t+1||e===t-1:n.load=e===t})};i.on("update",h);s.goToPage=function(t){l.loadPage(t)};s.onSwipePage=function(t){l.loadPage(s.pageIndex+t)};s.$watch("items",function(t){t&&t.length&&l.preparePages(t[0].qItems)});s.$on("visualsGroupMoveActiveVisual",function(t,e){if(d)return;var n=s.pages.reduce(function(t,e){return t+e.length},0),i,a;i=s.activeVisualIx>0||e>0?(s.activeVisualIx+e)%n:n-1;a=Math.floor(i/c);a!==s.pageIndex&&l.loadPage(a);s.activeVisualIx=i});s.$on("visualsGroupBlur",function(){s.activeVisualIx=-1});s.$on("visualsGroupFocus",function(){s.activeVisualIx=0;0!==s.pageIndex&&l.loadPage(0)});s.$on("$destroy",function(){i.off("update",h);n.OrientationChanged.unbind(f);n.ViewChanged.unbind(f)});l.loadPage=function(e){if(!d&&e>=0&&e<s.pages.length){d=true;u.animate({scrollLeft:e*(u[0].offsetWidth+a.PADDING_PAGES)},p,"swing",function(){d=false;t(function(){s.setPageIndex(e)})})}};l.preparePages=function(t){if(t){g();var e,i=0,r=[];n.orientation===n.Orientation.landscape?e=n.isSmallDevice?1:a.PAGE_VISUALS:n.orientation===n.Orientation.portrait&&(e=n.isSmallDevice?1:a.PAGE_VISUALS_PORTRAIT);c=e;for(var o=0;o<t.length;o++){if(n.isSmallDevice&&r.length>=a.MAX_MOBILE_VISUALS&&r[i].length>=e)break;if(r[i]){if(r[i].length>=e){i++;r.push([])}}else r.push([]);t[o].itemIndex=o;t[o].load=s.options.preload?0===i||1===i:0===i;r[i].push(t[o])}s.pages=r}};function g(){s.pages=[];u.scrollLeft(0);s.pageIndex=0}}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},896:function(t,e){t.exports='<div class="qv-smartsearch-visuals-group" qva-smart-search-swipe-horizontal="onSwipePage(delta)" >\n\t<div class="nav-visual-arrow left" qva-activate="goToPage( pageIndex - 1 );" ng-show="pageIndex > 0">\n\t\t<span class="lui-fade-button">\n\t\t\t<span class="lui-fade-button__icon  lui-icon lui-icon--arrow-left"></span>\n\t\t</span>\n\t</div>\n\t<div class="visuals-wrapper" >\n\t\t<div class="page" tid="swipeable-chart-page-container" ng-repeat="p in pages" ng-class="{ \'first\': $first, \'last\': $last }">\n\t\t\t<div class="content" >\n\t\t\t\t<qv-smartsearch-visual-preview\n\t\t\t\t\tng-repeat="visualItem in p"\n\t\t\t\t\tapp="app"\n\t\t\t\t\tactive-visual-ix="activeVisualIx"\n\t\t\t\t\tvisual-object="visualItem"\n\t\t\t\t\tsearch-terms="searchTerms"\n\t\t\t\t\tng-class="{ \'first\': $first && !$last, \'last\': $last, \'active\': focusState.activeStateName === focusState.Suggestions && activeVisualIx === visualItem.itemIndex }">\n\t\t\t\t</qv-smartsearch-visual-preview>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="nav-visual-arrow right" qva-activate="goToPage( pageIndex + 1 );" ng-show="pageIndex < (pages.length - 1)">\n\t\t<span class="lui-fade-button">\n\t\t\t<span class="lui-fade-button__icon  lui-icon lui-icon--arrow-right"></span>\n\t\t</span>\n\t</div>\n\n\t<qv-global-search-more-indicator pages="pages" active-page-ix="pageIndex" on-page-change="goToPage(index);"></qv-global-search-more-indicator>\n</div>'},897:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(54),n(95),n(105),n(898),n(89),n(114),n(123),n(370),n(169),n(267)],a=function(t,e,n,i,a,s,r,o){t.directive("qvSmartsearchVisualPreview",["$timeout",function(l){var c={TITLE:0,SUBTITLE:1,FOOTNOTE:2,DIMENSION:3,MEASURE:4,ALTERNATIVE_DIMENSION:5,ALTERNATIVE_MEASURE:6,TYPE:7,VALUE:8};function u(t,e){return e.getObject(t.qIdentifier).then(function(t){return{model:t,options:{isReadonly:true,isPopover:false,selectionsDisabled:true,interactionState:o.STATIC,components:{miniChart:{show:false},scrollArea:{showFlag:0}},direction:r.direction}}})}function d(t){var e=t.split("/");e=e.map(function(t){return parseInt(t)}).filter(function(t){return!Number.isNaN(+t)});return e.length?e[0]:-1}function p(t,e){t.id=-1;if(-1!==e.indexOf("qDimensions")||-1!==e.indexOf("qListObjectDef/qDef")){t.id=d(e);t.type=-1===e.indexOf("qLayoutExclude")?c.DIMENSION:c.ALTERNATIVE_DIMENSION;t.isLabel=-1!==e.indexOf("qFieldLabels")}else if(-1!==e.indexOf("qMeasures")){t.id=d(e);t.type=-1===e.indexOf("qLayoutExclude")?c.MEASURE:c.ALTERNATIVE_MEASURE;t.isLabel=-1!==e.indexOf("qLabel")}else{-1!==e.indexOf("subtitle")?t.type=c.SUBTITLE:-1!==e.indexOf("title")?t.type=c.TITLE:-1!==e.indexOf("footnote")?t.type=c.FOOTNOTE:-1!==e.indexOf("type")?t.type=c.TYPE:t.type=c.VALUE;t.isLabel=-1===e.indexOf("qExpr")}t.trans=h(t.type)}function h(t){var e="---";switch(t){case c.TITLE:e="Common.Title";break;case c.DIMENSION:e="Common.Dimensions";break;case c.MEASURE:e="Common.Measures";break;case c.ALTERNATIVE_DIMENSION:e="properties.alternative.dimensions";break;case c.ALTERNATIVE_MEASURE:e="properties.alternative.measures";break;case c.SUBTITLE:e="properties.subtitle";break;case c.FOOTNOTE:e="properties.footnote";break;case c.TYPE:e="properties.type";break;case c.VALUE:e="properties.dataPoints.labelmode.value";break}return e}return{restrict:"E",template:a,replace:true,require:["^qvGlobalSearch"],scope:{visualObject:"=",searchTerms:"=",activeVisualIx:"=",app:"="},link:function a(c,d,h,f){var g=t.getService("$navigationService").Sheets,v=t.getService("qvGlobalSearchDataService").getMaxColorsNum(),m=f[0],b;c.viz=null;c.termsMatched=null;c.extra=false;c.matches=null;c.loadManually=function(t){t.stopPropagation();c.viz.object.retry();c.isManualLoad=false};function y(){c.loadTimer=l(function(){if(c.viz.object){c.viz.object.cancel();c.isManualLoad=true}},c.visualObject.suggestedTimeout);c.viz.options.onRendered=function(){c.loadTimer&&l.cancel(c.loadTimer)}}c.$watch("visualObject.load",function(t){if(true===t){I();if(b)c.viz=b;else{u(c.visualObject,c.app).then(function(t){b=t;c.viz=t;c.viz.object={};c.visualObject.suggestedTimeout&&y()});x(c.visualObject.qItemMatches)}}else c.viz=null});c.$watch("searchTerms",function(t){t&&c.visualObject&&I()});c.$on("selectActiveVisualItem",function(){c.activeVisualIx===c.visualObject.itemIndex&&S()});c.$on("$destroy",function(){b=null});c.showMoreHits=function(t){t.stopPropagation();m.showMoreHitsForVisual(c.visualObject).then(function(t){x(t.qItemMatches)})};function S(t){var e=function t(e){e=e.filter(function(t){return t});return e.length?e[0]:null};w().then(function(a){var s=e(a);if(s){g.navigateToSheet(s.sheet);m.onNavigateToSheet(s.cell.name)}else if(t){var l={isReadonly:true,isPopover:false,selectionsDisabled:true,interactionState:o.ANALYSIS,components:{miniChart:{show:true},scrollArea:{showFlag:1}},direction:r.direction};n.publish(i.Events.PubSub.ExpandSmartSearchSuggestedChart,Object.assign({},t,{options:l}))}})}function I(){c.termsMatched=c.visualObject.qSearchTermsMatched.map(function(t){return{string:c.searchTerms[t],pos:t%v}})}function x(t){c.hitsDisplayed=t.length;var n,i,a;t.forEach(function(t){t.qAttributes&&t.qAttributes.length&&p(t,t.qAttributes[0][1])});n=c.visualObject.qItemMatches.filter(function(e){if(e.isLabel)return true;var n=t.filter(function(t){return t.isLabel&&e.type===t.type&&e.id===t.id&&e!==t});var i=e.qRanges.every(function(t){return n.some(function(e){return e.qRanges.some(function(e){return t.qTerm===e.qTerm})})});return!i});i=e.groupBy(n,function(t){return t.type});a=Object.keys(i).map(function(t){return i[t]});c.matches?a.forEach(function(t,e){if(t.length>c.matches[e].length){var n=c.matches[e].length;for(var i=n;i<t.length;i++)c.matches[e].push(t[i])}}):c.matches=a}function q(t,e,n){var i={sheet:t,cell:e};return e.name===c.visualObject.qIdentifier?s.resolve(i):"filterpane"===e.type?n.getObject(e.name).then(function(t){return t.getLayout().then(function(t){if(t.qChildList&&t.qChildList.qItems.length){var e=t.qChildList.qItems.filter(function(t){return t.qInfo.qId===c.visualObject.qIdentifier});return e.length?i:null}return null})}):s.resolve(null)}function w(){var t,e=[];for(var n=0;n<g.all.mashed.length;n++){t=g.all.mashed[n];for(var i=0;i<t.qData.cells.length;i++)e.push(q(t,t.qData.cells[i],c.app))}return s.all(e)}c.showExtraInfo=function(t){c.extra=!c.extra&&c.matches.length;t.stopPropagation()};c.navigateToSheet=function(t,e){if(!c.isManualLoad){t.stopPropagation();S(e)}}}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},898:function(t,e){t.exports='<div class="visual-item">\n\t<div class="object" qva-activate="navigateToSheet($event, viz)" >\n\t\t<qv-object ng-if="viz && visualObject.load" model="viz.model" options="viz.options" object="viz.object"></qv-object>\n\t\t<div class="transparent-overlay"></div>\n\t\t<div ng-hide="visualObject.load" class="qv-animate progress">\n\t\t\t<div class="progress-loader"></div>\n\t\t</div>\n\t\t<div class="cao-mobile-manual-loader" ng-click="$event.stopPropagation()" ng-if="isManualLoad">\n\t\t\t<ul>\n\t\t\t\t<li class="cao-mobile-loader-text" q-translation="cao.card.complex">\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<lui-button ng-click="loadManually($event)" q-translation="cao.card.complex.load"></lui-button>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n\t<div class="visual-data" qva-activate="showExtraInfo($event);">\n\t\t<div ng-if="visualObject.load" class="keywords">\n\t\t\t<div class="terms">\n\t\t\t\t<span ng-repeat="t in termsMatched"><span ng-if="!$first">&nbsp;</span><span class="highlighted{{t.pos}}">{{t.string}}</span></span>\n\t\t\t</div>\n\t\t\t<div class="lui-fade-button" ng-if="matches.length" tid="swipeableChartPageInfoButton">\n\t\t\t\t<span class="lui-fade-button__icon lui-icon lui-icon--info"></span>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="extra-info" ng-if="visualObject.load" ng-class="{ \'show\': extra }">\n\t\t\t<div ng-if="matches.length" ng-repeat="hits in matches" class="hits">\n\t\t\t\t<div ng-repeat="hit in hits" class="match-hit">\n\t\t\t\t\t<span ng-if="$first"><b q-translation="{{hit.trans}}"></b>: </span><qv-global-search-highlights q-text="hit.qText" q-ranges="hit.qRanges" class="highlights"></qv-global-search-highlights><span ng-if="!$last">,&nbsp;</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="more-hits" qva-activate="showMoreHits($event)" ng-if="$last && (visualObject.qTotalNumberOfMatches-hitsDisplayed) > 0" q-translation="GlobalSearch.MoreResults,{{(visualObject.qTotalNumberOfMatches-hitsDisplayed)}}"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'},899:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(99),n(900)],a=function(t,e,n){t.directive("qvGlobalSearchMoreIndicator",function(){return{replace:true,template:n,restrict:"E",scope:{pages:"=",activePageIx:"=",onPageChange:"&"},link:function t(n){n.touchOn=!e.treatAsDesktop();n.pressedPageIx=void 0;n.onPageClick=function(t){n.pressedPageIx=t;n.onPageChange({index:t})};n.$watch("activePageIx",function(){n.pressedPageIx=void 0})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},900:function(t,e){t.exports='<div class="qv-gs-more-indicator" ng-class="{ \'touch-on\': touchOn }">\n\t<div class="hit-area"  qva-activate="onPageClick($index);" ng-repeat="p in pages">\n\t\t<span tid="swipeableChartPageClickDot" class="dot" ng-class="{ \'active\': $index === activePageIx, \'pressed\': $index === pressedPageIx }"></span>\n\t</div>\n</div>'},901:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(902)],a=function(t,e){t.directive("qvGlobalSearchSuggest",[function(){return{restrict:"E",template:e,replace:true,require:["^qvGlobalSearch"],link:function t(){}}}]);t.directive("qvScrollToActiveSuggestion",function(){return{restrict:"A",link:function t(e,n,i){i.$observe("qvScrollToActiveSuggestion",function(t){t=t+""==="true";if(t){var e=n.position(),i=n.parent(),a=n[0].clientWidth>i[0].clientWidth,s=e.left+n[0].clientWidth-i[0].clientWidth;n[0].scrollIntoView(a);e.left<=i[0].offsetLeft?i.scrollLeft(n[0].offsetLeft-i[0].offsetLeft):s>0&&!a&&(i[0].scrollLeft=i[0].scrollLeft+s)}})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},902:function(t,e){t.exports='<div class="qv-search-suggest-wrapper" tid="globalSearch.suggestions">\n\t<span class="hidden">{{query}}</span>\n    <div ng-show="isSmallDevice" ng-if="!isObjectsFeature" class="dym" q-translation="GlobalSearch.DidYouMean"></div>\n\t<ul class="suggest-popup">\n\t\t<li ng-repeat="suggest in suggestions track by $index" qv-scroll-to-active-suggestion="{{$index === activeSuggestionIx && focusState.activeStateName === focusState.Suggestions}}" ng-class="{active: $index === activeSuggestionIx && focusState.activeStateName === focusState.Suggestions }" qva-activate="onSuggestSelect(null, suggest)" tid="globalSearch.suggestion" bold-suggest=\'{{suggest.value}}\'>\n\t\t\t{{suggest.value}}\n\t\t</li>\n\t</ul>\n</div>\n'},903:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(904),n(169)],a=function(t,e){t.directive("qvGlobalSearchHistory",["$timeout",function(n){return{restrict:"E",template:e,replace:true,require:["^qvGlobalSearch"],link:function e(i,a,s,r){var o=r[0],l=a.find(".history-popup")[0];i.colorsLimit=t.getService("qvGlobalSearchDataService").getMaxColorsNum();i.$watch("searchInputFocused",function(t){t&&n(function(){l.scrollTop=0})});i.onSearchHistorySelect=function(t){o.setQueryFromHistory(t)};i.clearSearchHistory=function(){o.clearHistory()};i.removeSelectedHistory=function(t){o.removeHistory(t)}}}}]);t.directive("qvScrollToActiveHistory",function(){return{restrict:"A",link:function t(e,n,i){i.$observe("qvScrollToActiveHistory",function(t){t=t+""==="true";n.toggleClass("active",t);t&&n[0].scrollIntoView(false)})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},904:function(t,e){t.exports='<div class="qv-search-last-history" tid="globalSearch.searchHistory">\n\t<div class="history-header" ng-show="searchHistory.length">\n\t\t<div class="title"  q-translation="GlobalSearch.RecentSearches"></div>\n\t\t<div class="clear-all-button" q-translation="GlobalSearch.ClearAll" qva-activate="clearSearchHistory($index)"></div>\n\t</div>\n\t<ul class="history-popup" ng-show="searchHistory.length">\n\t\t<li ng-repeat="items in searchHistory track by $index" qva-delegated-activate=".history-query#onSearchHistorySelect($index); .lui-icon--close#removeSelectedHistory($index);" tid="globalSearch.searchHistoryItem" ng-class="{active: $index === activeHistoryIx && focusState.activeStateName === focusState.History}" qv-scroll-to-active-history="{{$index === activeHistoryIx && focusState.activeStateName === focusState.History}}">\n\t\t\t<div class="history-query">{{searchHistory[$index]}}</div>\n\t\t\t<div class="lui-icon lui-icon--close" q-title-translation="Common.Delete" title="Delete"></div>\n\t\t</li>\n\t</ul>\n</div>'},905:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(906),n(163),n(89),n(50),n(97),n(276),n(257),n(371)],a=function(t,e,i,a,s,r){var o={};Object.defineProperties(o,{THROBBER:{value:1e3},INDEX_PROGRESS:{value:5e3},NEXT_INDEX_PROGRESS:{value:500},HIDE_INDEX_DONE:{value:1e3}});t.directive("qvGlobalSearchThrobber",["$timeout","$window","$animate",function(l,c,u){return{replace:true,template:e,restrict:"E",link:function e(d,p){var h=t.getService("qvGlobalSearchService"),f,g,v,m,b=p.find(".qv-gs-index-progress .qv-gs-index-group"),y,S;d.asyncHideActivity=false;d.percentDone=void 0;d.imgSrc=n.p+"img/core/static/smart-search.png";d.pages=[{},{}];d.activePageIx=0;y=function t(){l(function(){b[0].scrollLeft=d.activePageIx*b[0].offsetWidth})};s.OrientationChanged.bind(y);r.on("update",y);d.goToPage=function(t){b.animate({scrollLeft:t*b[0].offsetWidth},400,"swing",function(){l(function(){d.activePageIx=t})})};d.onSwipePage=function(t){if(d.isSmallDevice){var e=t>0?1:0;e!==d.activePageIx&&d.goToPage(e)}};d.openHelp=function(){c.open(i.path+"SmartSearch_Intro")};d.$on("$destroy",function(){l.cancel(f);l.cancel(g);l.cancel(v);l.cancel(m);r.off("update",y);s.OrientationChanged.unbind(y);h.IndexProgressUpdate.unbind($);u.off("removeClass",p[0])});function I(t){var e=a(),n=p.find(t)[0];u.on("removeClass",n,function(t,i){if("close"===i){u.off(n);e.resolve()}});return e.promise}function x(){d.throbber.show=false;d.indexProgress.enabled=false;d.indexProgress.show=false;d.indexProgress.visible=false;d.indexDone.show=false;d.indexDone.visible=false}function q(){if(void 0!==d.percentDone&&d.percentDone<100)return true;return h.couldEngineBeIndexing(d.app)}function w(t){if(!S){h.IndexProgressUpdate.bind($);S=true}l.cancel(m);m=l(function(){h.requestIndexProgressUpdate(d.app)},t||0)}d.showIndexDone=function(){I(".qv-gs-index-done").then(function(){d.indexProgress.show=false;d.indexProgress.visible=false;d.indexDone.visible=true;d.percentDone=void 0;l.cancel(v);v=l(C,o.HIDE_INDEX_DONE)});d.indexDone.show=true};function C(){d.indexDone.visible=false;d.indexDone.show=false;l.cancel(f);d.$emit("updateForceShowDimmer",false);d.asyncHideActivity?O():f=l(T,o.THROBBER)}function P(t){I(".qv-gs-index-progress").then(function(){d.indexProgress.visible=true;d.isSmallDevice||d.$emit("updateForceShowDimmer",true)});d.percentDone=t;d.indexProgress.show=true;d.activity.show=true;d.throbber.show=false;t<100?w(o.NEXT_INDEX_PROGRESS):k()}function E(t){d.percentDone=t;t<100?w(o.NEXT_INDEX_PROGRESS):k()}function k(){l.cancel(m);if(S){h.IndexProgressUpdate.unbind($);S=false}}function T(){d.activity.show=true;d.throbber.show=true;d.emptyMessageEnabled=false}function O(){l.cancel(f);l.cancel(g);l.cancel(v);l.cancel(m);k();d.activity.show=false;d.throbber.show=false;d.indexProgress.enabled=false;d.indexProgress.show=false;d.indexProgress.visible=false;d.emptyMessageEnabled=d.searchTerms.length>0}function A(){d.indexProgress.enabled=true;w()}function $(t,e){if(t!==(d.app.id||"").toUpperCase())return;var n=new Number(e);if(Number.isNaN(+n)||!e){d.indexProgress.enabled=true;w(o.INDEX_PROGRESS);return}if(!d.indexProgress.show&&n<100)P(n);else if(d.indexProgress.show)E(n);else{l.cancel(f);f=l(T,o.THROBBER)}}function D(t,e,n){if(e){d.asyncHideActivity=false;if(d.activity.show)return;x();l.cancel(f);l.cancel(g);if(q())A();else{f=l(T,o.THROBBER);g=l(A,o.INDEX_PROGRESS)}}else{var i=d.percentDone&&d.percentDone<100;if(i&&n){h.setLastKnownIndexProgress(d.app,100);k();d.percentDone=100;d.asyncHideActivity=true}else if(i&&!n){if(!d.isSmallDevice)return;O()}else if(100==d.percentDone){h.setLastKnownIndexProgress(d.app,100);k();d.asyncHideActivity=true}else O()}}d.$on("toggleActivityIndicator",D)}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},906:function(t,e){t.exports='<div ng-show="activity.show" class="qv-qs-throbber-container qv-animate ng-hide">\n\n\t<div class="qv-gs-throbber-dimmer"></div>\n\n\t<div ng-show="throbber.show" class="qv-gs-throbber ng-hide"></div>\n\n\t<div ng-show="indexProgress.show" class="qv-gs-index qv-gs-index-progress qv-animate ng-hide">\n\n\t\t<div class="qv-gs-index-group" qva-smart-search-swipe-horizontal="onSwipePage(delta)">\n\t\t\t<div class="qv-gs-index-section">\n\t\t\t\t<div class="qv-gs-index-content qv-gs-index-content-shrink">\n\t\t\t\t\t<span class="qv-gs-index-header" q-translation="GlobalSearch.PreparingSmartSearch"></span>\n\n\t\t\t\t\t<qv-progress-bar percent-done="percentDone" on-completed="showIndexDone()"></qv-progress-bar>\n\n\t\t\t\t\t<span class="qv-gs-index-text" q-translation="GlobalSearch.NextTimeFaster"></span>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="qv-gs-index-section">\n\t\t\t\t<div class="qv-gs-index-content qv-gs-index-content-shrink">\n\t\t\t\t\t<div class="qv-gs-index-help" qva-activate="openHelp()">\n\t\t\t\t\t\t<span class="qv-gs-index-header" q-translation="GlobalSearch.LearnHowToUse"></span>\n\t\t\t\t\t\t<img ng-src="{{imgSrc}}" class="qv-gs-index-image" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<qv-global-search-more-indicator pages="pages" active-page-ix="activePageIx" on-page-change="goToPage(index);"></qv-global-search-more-indicator>\n\n\t</div>\n\n\t<div ng-show="indexDone.show" class="qv-gs-index qv-gs-index-done qv-animate ng-hide">\n\t\t<div class="qv-gs-index-section qv-gs-index-section-single">\n\t\t\t<div class="qv-gs-index-content qv-gs-index-shrink">\n\t\t\t\t<span class="qv-gs-index-icon lui-icon lui-icon--tick" aria-hidden="true"></span>\n\t\t\t\t<span class="qv-gs-index-text-big" q-translation="GlobalSearch.Done"></span>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n</div>'},907:function(t,e){t.exports='<div class="qv-progress-bar">\n\t<div class="progress-bar-bg">\n\t\t<div class="progress-bar-fg" ng-style="{ width: display }"></div>\n\t</div>\n\n\t<div class="progress-text" ng-bind="display" ng-hide="options.hideText"></div>\n</div>'},908:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(276),n(257)],a=function(t){t.directive("qvMobileIndexProgress",["$timeout",function(e){return{replace:true,template:'<div class="qv-mobile-index-progress"><qv-progress-bar ng-if="showMobileIndexProgressBar" percent-done="indexPercentDone" on-completed="hideMobileIndexProgressWhenDone()" options="progressBarOptions"></qv-progress-bar></div>',restrict:"E",link:function n(i){var a=t.getService("qvGlobalSearchService"),s,r;i.progressBarOptions={hideText:true};a.couldEngineBeIndexing(i.app)&&c(0);i.$on("$destroy",function(){e.cancel(r);a.IndexProgressUpdate.unbind(o)});i.hideMobileIndexProgressWhenDone=function(){i.showMobileIndexProgressBar=false};function o(t,e){if(t!==(i.app.id||"").toUpperCase())return;if(!i.showMobileIndexProgressBar&&e<100){i.indexPercentDone=e;i.showMobileIndexProgressBar=true;c(500)}else if(i.showMobileIndexProgressBar){i.indexPercentDone=e;e<100&&c(500)}else l()}function l(){e.cancel(r);if(s){a.IndexProgressUpdate.unbind(o);s=false}}function c(t){if(!s){a.IndexProgressUpdate.bind(o);s=true}e.cancel(r);r=e(function(){a.requestIndexProgressUpdate(i.app)},t||0)}}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},909:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(54),n(95),n(186),n(93),n(910),n(124),n(120),n(113),n(49),n(91),n(89),n(103),n(229),n(222),n(99),n(134),n(147),n(154),n(106),n(168),n(114),n(105),n(223),n(372),n(911),n(912),n(937),n(939),n(941),n(374),n(212),n(221),n(275),n(945),n(366),n(946),n(267),n(415),n(233),n(368),n(947),n(963)],a=function(t,e,n,i,a,s,r,o,l,c,u,d,p,h,f,g,v,m,b,y,S,I,x,q,w,C,P){var E=["$scope","$element","$window","$timeout","$q","qvCaoService","qvCaoSearchService","qvCaoChartService","qvAppDetailsService","qvCaoRenderService","qvCaoComplexityEstimatorService","qvCaoSelectionService",function(r,l,E,k,T,O,A,$,D,_,M,N){var F=this;var L=new I;var R=T.defer();var j=T.defer();var G=false;var H=0;F.zoomDeferred=null;F.lightEdits=[];r.loadedCount=0;r.query="";r.charts=[];r.chartMatches=[];r.renderableCharts=[];r.fieldList=[];r.debug=c.CAO_DEBUG;r.syncFieldPicker=u.getFlag("CAO_FIELD_PICKER_SYNC");r.insightFeedback=u.getFlag("CE_PRECEDENTS");r.caoTweakEnabled=u.getFlag("CAO_TWEAK");r.nluEnabled=u.getFlag("NLU_INSIGHTS");r.nluQueryInfoVisible=false;r.nluRawResponse=null;r.learningPerformed=false;r.contextPanelVisible=false;r.assetsPanelVisible=true;r.showHidden=false;r.showFieldPicker=true;r.limitedAccess=null;r.scrollContainer=l.find(".qv-cao-scroll-content")[0];r.mouseUp=function(){r.focusBorder=true};r.resultLabel=d.get("cao.search.title",[0,0,0,0]);r.introHeader=r.nluEnabled?d.get("cao.search.intro.nlu.header"):d.get("cao.search.intro.header");r.introDescriptionSearch=d.get("cao.search.intro.description.search");r.introDescriptionNoFields=d.get("cao.search.intro.description.nofields");r.introDescriptionGenerateInsights=d.get("cao.search.intro.description.generateInsights");r.introButton=d.get("cao.search.intro.button");r.goToSheetButton=d.get("cao.search.gotosheet.button");r.cellStatusElem=l.find("#sr-cell-status-label");r.direction=x.direction;r.appPrecedents={enabled:true};r.state="INIT";r.gridScreenReader=d.get("Cao.Accessibility.Object.Description");r.onGridFocus=function(){r.gridScreenReader=G?"":d.get("Cao.Accessibility.Object.Description")};r.onGridBlur=function(){k(function(){G=!!document.activeElement&&document.activeElement.classList.contains("cao-insight-container");r.gridScreenReader=""},1)};o.load();m.getList().then(function(t){r.masterDimensionsListModel=t});S(r,"masterDimensionsListModel",function(){V()});b.getList().then(function(t){r.masterMeasuresListModel=t});S(r,"masterMeasuresListModel",function(){V()});y.getList().then(function(t){r.fieldsListModel=t});S(r,"fieldsListModel",function(){V()});r.updateDirection=function(t){r.direction!==t&&(r.direction=t)};r.closeAndGoToSheet=function(){O.toggleCao();i.publish("cao/insights/close")};x.DirectionChanged.bind(r.updateDirection);s.getApp().then(function(i){j.resolve();r.app=i;r.contextPanelVisible=w.storageObj(i.id).contextPanel;r.assetsPanelVisible=w.storageObj(i.id).assetsPanel;D.get().then(function(t){r.limitedAccess=Boolean(t.model.app.published||!t.model.permissions.update)}).then(function(){p.all({appFieldList:i.getFieldList(),classificationsResult:e.getService("classificationService").getClassification(),appScrape:O.scrapeApp()}).then(function(e){var s=e.classificationsResult?new f(e.classificationsResult):void 0;a.addClassificationDataToFields(e.appFieldList,s);R.resolve();M.init(i);r.state="INTRO";v.treatAsDesktop()&&k(function(){t("#cao-search-input").focus()});A.getMasterItems().then(function(t){r.limitedAccess&&0===t.length&&(r.state="NO_FIELDS")});r.fieldList=e.fieldList;A.clearSelectedFields();A.registerForCaoSearchQuery(n.debounce(B,300));V()},function(){R.reject();z()})});r.app.getLayout().then(function(t){r.permissions=t.permissions})},function(){j.reject();z()});function V(){A.createFieldList().then(function(t){r.fieldList=t})}function B(t){O.setRefreshIndicatorVisibility(false);if("NO_FIELDS"===r.state)return;if(t.showIntro){r.state="INTRO";r.$apply(function(){r.query="";r.charts=[];r.chartMatches=[];r.selectedFieldNames=[]});return}r.query=t.query?t.query:"";r.loadGraphs(t.query);r.selectedFieldNames=t.selectedFields?t.selectedFields:[]}r.refreshCharts=function(){if("INTRO"===r.state){O.setRefreshIndicatorVisibility(false);return}i.publish("cao/insight/refreshPerformed");r.state="LOADING";O.setRefreshIndicatorVisibility(false);r.clearChartSelection();k(function(){_.clearRenderQueue();r.charts=[];r.chartMatches=[]}).then(function(){$.refreshInsights(r.appPrecedents.enabled).then(function(t){r.state="LOADED";r.loadedCount++;r.charts=t.recommendations;r.chartMatches=t.chartMatches;r.learningPerformed=false}).catch(z)})};r.$watch("appPrecedents.enabled",function(t,e){t!=e&&r.refreshCharts()});r.clearInsightResults=function(){i.publish("cao/insights/clear")};r.isClearResultsVisible=function(){return r.caoTweakEnabled&&(r.charts&&r.charts.length>0||r.chartMatches&&r.chartMatches.length>0)};r.setItemAccFocusVisibility=function(){this.itemAccFocus=true};r.removeItemAccFocusVisibility=function(){this.itemAccFocus=false};r.toggleFieldPicker=function(){r.showFieldPicker=!r.showFieldPicker;h.trackEvent(h.customEvents.INSIGHTS_FIELD_PICKER,{type:r.showFieldPicker?"open":"close"});k(r.resizeCharts)};r.resizeCharts=function(){g.resizeCharts(E)};function z(t){H--;t&&(t.norefresh||t.notFound)?t.notFound&&(r.state="NOT_FOUND"):r.state="ERROR";r.learningPerformed=false}r.loadGraphs=function(t){_.clearRenderQueue();O.setRefreshIndicatorVisibility(false);"LOADED"===r.state&&r.$apply(function(){r.charts=[];r.chartMatches=[]});r.state="LOADING";r.showHidden=false;var e=new Date;j.promise.then(function(){R.promise.then(function(){H++;var n;n=r.nluEnabled&&t&&t.length?C.parseQuery(t,r.app.id).then(function(t){r.nluRawResponse=t;i.publish("cao/nlu/new_queries",t);var e=P.buildDataCollection(t);return $.getVisualRecommendations(r.app,e,r.limitedAccess)}):$.getInsights(r.app,t,r.limitedAccess,r.appPrecedents.enabled);n.then(function(t){H--;if(H>0)return;r.state="LOADED";r.loadedCount++;r.charts=t.recommendations;r.chartMatches=t.chartMatches;var n=new Date;var i=(n-e)/1e3;h.trackEvent(h.customEvents.INSIGHTS_SEARCH,{query:r.query,queryTime:i})},z)},z)},z)};r.selectField=function(t){if(r.syncFieldPicker){r.fieldToAdd=t.selected?null:t;r.fieldToRemove=t.selected?t:null}else{r.fieldToAdd=null;k(function(){r.fieldToAdd=t})}i.publish("cao/insight/contextPanelToggled",!!r.insightFeedback&&w.storageObj(r.app.id).contextPanel);r.clearChartSelection()};r.updateFieldPicker=function(){k(function(){r.fieldList=[];r.fieldList=A.getFields()})};r.zoomChart=function(t){F.zoomDeferred=T.defer();r.zoomOpen=true;t.zoomed=true;k(function(){l.find(".qv-cao-zoomed-anmiation-container").addClass("animate-expand");k(function(){r.zoomedChart=t},400)});return F.zoomDeferred.promise};r.exitZoom=function(){k(function(){l.find(".qv-cao-zoomed-anmiation-container").addClass("animate-shrink");r.zoomedChart=void 0;k(function(){r.zoomOpen=false;F.zoomDeferred.resolve()},400)});return F.zoomDeferred.promise};r.sendFeedback=function(t,e){var n=t.getAnalysis();if(e===q.Precedents.PrecedentTypes.Dislike)return n.precedents&&n.precedents.disliked?L.undislikeAnalysis(n).then(function(){delete n.precedents;return false}):L.dislikeAnalysis(n).then(function(t){n.precedents={id:t.nodes[0].id,disliked:true};return true});if(e===q.Precedents.PrecedentTypes.Like)return L.likeAnalysis(n).then(function(t){n.precedents={id:t.nodes[0].id,liked:true};return true})};function U(e){t(e.currentTarget).blur()}r.showHiddenCharts=function(){r.showHidden=!r.showHidden;r.showHidden&&k(function(){var e=t(".qv-cao-section-hidden")[0];e&&e.scrollIntoView&&e.scrollIntoView({behavior:"smooth",block:"start"})})};r.showFoundInsights=function(t){13===t.which?r.chartsToShow={charts:r.chartMatches,activeTab:"found"}:"click"===t.type&&(r.chartsToShow={charts:r.chartMatches,activeTab:"found"});U(t)};r.showGeneratedInsights=function(t){13===t.which?r.chartsToShow={charts:r.renderableCharts,activeTab:"generated"}:"click"===t.type&&(r.chartsToShow={charts:r.renderableCharts,activeTab:"generated"});U(t)};r.isRefreshIndicatorVisible=function(){return O.getRefreshIndicatorVisibility()};r.isCaoInsightContextPanelVisible=function(){return r.caoTweakEnabled&&r.contextPanelVisible&&"ERROR"!==r.state};r.clearChartSelection=function(){N.clearSelection()};r.isChartSelected=function(){var t=N.getSelectedChart();return t&&r.zoomedChart&&r.zoomedChart===t};r.toggleNluQueryInfo=function(){r.nluQueryInfoVisible=!r.nluQueryInfoVisible};function K(t){r.contextPanelVisible=t}function Q(t){r.assetsPanelVisible=t}function W(t){r.learningPerformed=t}i.subscribe("cao/insight/refresh",r.refreshCharts);i.subscribe("cao/insight/contextPanelToggled",K);i.subscribe("cao/insight/assetsPanelToggled",Q);i.subscribe("cao/insight/learningPerformed",W);r.$watchGroup(["charts","chartMatches"],function(){0===r.charts.length&&"LOADED"===r.state&&z({notFound:true});r.renderableCharts=r.charts.filter(function(t){return!r.insightFeedback||!t.isHidden()});r.chartsToShow={charts:r.renderableCharts,activeTab:"generated"};r.hiddenCharts=r.charts.filter(function(t){return t.isHidden()});r.numberOfGeneratedInsights=d.get("cao.search.info.title.generated.plural",r.renderableCharts.length.toString());r.numberOfFoundInsights=d.get("cao.search.info.title.found.plural",r.chartMatches.length.toString());function t(){var t=[];if(r.charts.length+r.chartMatches.length===0)return null;r.charts.length+r.chartMatches.length>0&&t.push(d.get("cao.search.titleResults",[r.charts.length+r.chartMatches.length]));r.renderableCharts.length>0&&t.push(d.get("cao.search.titleGenerated",[r.renderableCharts.length]));r.hiddenCharts.length>0&&t.push(d.get("cao.search.titleHidden",[r.hiddenCharts.length]));switch(t.length){case 3:return d.get("cao.search.titleLength3",t);case 2:return d.get("cao.search.titleLength2",t);default:break}}r.resultLabel=t()});r.$on("$destroy",function(){A.unRegisterFromCaoSearchQuery(B);_.clearRenderQueue();i.unsubscribe("cao/insight/refresh");i.unsubscribe("cao/insight/contextPanelToggled");i.unsubscribe("cao/insight/assetsPanelToggled");i.unsubscribe("cao/insight/learningPerformed");x.DirectionChanged.unbind(r.updateDirection)})}];e.directive("qvCaoComponent",function(){return{restrict:"E",template:r,controller:E,scope:true,replace:true,link:function t(e){l.getList().then(function(t){t.getLayout().then(function(t){e.sheets=t})});e.target=null}}});return"<qv-cao-component></qv-cao-component>"}.apply(e,i),void 0!==a&&(t.exports=a))},910:function(t,e){t.exports='<div class="qv-cao overlay" id="qv-cao-overlay" style="display:none;" ng-keyup="setItemAccFocusVisibility()" ng-mouseup="removeItemAccFocusVisibility()">\n\t<div class="qv-cao-zoomed-chart" ng-if="zoomOpen" ng-class="{\'cao-tweak-width\' : caoTweakEnabled && isChartSelected() && contextPanelVisible}">\n\t\t<div class="qv-cao-zoomed-anmiation-container" ng-if="zoomOpen">\n\t\t\t<qv-cao-insight class="qv-cao-section-result-item qv-cao-section-result-item-zoomed" ng-class="{\'cao-insight-focus\': itemAccFocus}"\n\t\t\t\tng-if="zoomedChart"\n\t\t\t\tchart="zoomedChart"\n\t\t\t\tapp="::app"\n\t\t\t\tdebug="::debug"\n\t\t\t\tsheets="::sheets"\n\t\t\t\tinteractive="::true"\n\t\t\t\talways-show-header="true"\n\t\t\t\theader-icon="lui-icon--arrow-left"\n\t\t\t\theader-action="exitZoom"\n\t\t\t\tpermissions="permissions"\n\t\t\t\tng-keyup="mouseUp"\n\t\t\t\tsend-feedback="sendFeedback(chart, type)"\n\t\t\t\tdirection="direction"\n\t\t\t\tis-cao-context-panel-visible="contextPanelVisible"\n\t\t\t>\n\t\t\t</qv-cao-insight>\n\t\t</div>\n\t</div>\n\n\t<div ng-if="assetsPanelVisible" class="qv-cao-field-picker" ng-class="{ \'hide-field-picker\' : !showFieldPicker, \'field-picker-panel-container\': caoTweakEnabled }" tid="cao-assets-panel">\n\t\t<qv-cao-field-picker\n\t\t\tinsights-loaded="state !== \'INIT\'"\n\t\t\tis-limited ="limitedAccess"\n\t\t\tclass ="field-picker"\n\t\t\ttoggle-field-picker="toggleFieldPicker"\n\t\t\tshow-field-picker="showFieldPicker"\n\t\t\titems="fieldList"\n\t\t\tselect-field="selectField">\n\t\t</qv-cao-field-picker>\n\t</div>\n\n\t<div class="qv-cao-search" ng-class="{ \'hide-field-picker\' : !showFieldPicker, \'search-container-with-context-panel\': caoTweakEnabled, \'search-container-nlu\': nluEnabled }">\n\t\t<div class="qv-cao-insights-header" ng-if="nluEnabled && (state === \'INTRO\' || state === \'INIT\')">\n\t\t\t<h1 q-translation="cao.CognitiveAssociativeOverlay"></h1>\n\t\t\t<button class=\'lui-button\' tid="go-to-sheet-intro-btn" ng-click="closeAndGoToSheet()">\n\t\t\t\t{{ goToSheetButton }}\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="qv-cao-nlu-intro" ng-if="nluEnabled && (state === \'INTRO\' || state === \'INIT\')">\n\t\t\t<div class="qv-cao-intro-image"></div>\n\t\t\t<h1>{{ introHeader }}</h1>\n\t\t</div>\n\t\t<qv-cao-search field-to-remove="fieldToRemove"\n\t\t\t\t\tfield-to-add="fieldToAdd"\n\t\t\t\t\tupdate-field-picker="updateFieldPicker"\n\t\t\t\t\tclear-field-picker="clearFieldPicker"\n\t\t\t\t\tis-limited ="limitedAccess"\n\t\t\t\t\tdirection="direction"\n\t\t\t\t\tdata-disabled="state === \'INIT\'"\n\t\t\t\t\tnlu-query-info-button-visible="state === \'LOADED\'"\n\t\t\t\t\tnlu-query-info-visible="nluQueryInfoVisible"\n\t\t\t\t\ttoggle-nlu-query-info="toggleNluQueryInfo">\n\t\t</qv-cao-search>\n\t\t<div class="qv-cao-search-info" ng-if="nluEnabled && nluQueryInfoVisible">\n\t\t\t<div class="qv-cao-search-info-debug" ng-if="debug">\n\t\t\t\t<h2>Debug Information</h2>\n\t\t\t\t<p class="qv-cao-search-info-response-text">{{ nluRawResponse | json : spacing }}</p>\n\t\t\t</div>\n\t\t</div>\n\t\t<p ng-if="nluEnabled && (state === \'INTRO\' || state === \'INIT\')" class="qv-cao-nlu-intro-suggestion-text" q-translation="cao.search.nlu.suggestedQuestionsText"></p>\n\n\t\t<div class="qv-cao-search-line" ng-if="!nluEnabled || (state !== \'INTRO\' && state !== \'INIT\')"></div>\n\n\t\t<div class="qv-cao-scroll-content">\n\t\t\t<div class="qv-cao-scroll-area">\n\n\t\t\t\t<div class="qv-cao-intro" ng-if="state === \'INTRO\' || state === \'INIT\'">\n\t\t\t\t\t<div class="qv-cao-intro-content">\n\t\t\t\t\t\t<div class="qv-cao-intro-image"></div>\n\t\t\t\t\t\t<h1>{{ introHeader }}</h1>\n\t\t\t\t\t\t<p>{{ introDescriptionSearch }}</p>\n\t\t\t\t\t\t<p ng-if="state === \'INTRO\'">{{ introDescriptionGenerateInsights }}</p>\n\t\t\t\t\t\t<div class="btns">\n\t\t\t\t\t\t\t<button class=\'lui-button lui-button--large\' tid="go-to-sheet-intro-btn" ng-click="closeAndGoToSheet()" ng-if="state === \'INTRO\' ">\n\t\t\t\t\t\t\t\t{{ goToSheetButton }}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button class=\'lui-button lui-button--success lui-button--large\' tid="generate-insights-intro-btn" ng-click="loadGraphs()" ng-if="state === \'INTRO\' ">\n\t\t\t\t\t\t\t\t{{ introButton }}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-if="state === \'INIT\'">\n\t\t\t\t\t\t\t<div class="loader">\n\t\t\t\t\t\t\t\t<qv-spinner show="state === \'INIT\'" show-delay="300" center-in-parent="true"></qv-spinner>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<p q-translation="cao.loading"></p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="qv-cao-intro" ng-if="state === \'NO_FIELDS\'">\n\t\t\t\t\t<div class="qv-cao-intro-content">\n\t\t\t\t\t\t<div class="qv-cao-intro-image"></div>\n\t\t\t\t\t\t<h1>{{ introHeader }}</h1>\n\t\t\t\t\t\t<p>{{ introDescriptionNoFields }}</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="qv-cao-intro" ng-if="state === \'ERROR\'">\n\t\t\t\t\t<div class="qv-cao-intro-content">\n\t\t\t\t\t\t<h1 q-translation="cao.error.header"></h1>\n\t\t\t\t\t\t<p q-translation="cao.error.description"></p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="qv-cao-intro" ng-if="state === \'NOT_FOUND\'">\n\t\t\t\t\t<div class="qv-cao-intro-content">\n\t\t\t\t\t\t<h1 q-translation="cao.error.header"></h1>\n\t\t\t\t\t\t<p q-translation="cao.error.description.notfound"></p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="qv-cao-section qv-cao-section-insights">\n\t\t\t\t\t<div class="qv-cao-loading" ng-if="state === \'LOADING\'">\n\t\t\t\t\t\t<div class="spinner-container">\n\t\t\t\t\t\t\t<qv-spinner show="state === \'LOADING\'" show-delay="300" center-in-parent="true"></qv-spinner>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="qv-cao-section-header"\n\t\t\t\t\t\tng-if="state === \'LOADED\'">\n\t\t\t\t\t\t<p class="qv-cao-section-header-text" ng-if="chartMatches.length === 0">{{resultLabel}}</p>\n\t\t\t\t\t\t<span style="display:none;" ng-show="state === \'LOADED\'" tid="cao-last-loaded-query" test-attribute="{{query}}" test-loaded-count="{{loadedCount}}">\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<ul class="lui-tabset qv-cao-section-header-text" ng-if="chartMatches.length > 0">\n\t\t\t\t\t\t\t<li class="lui-tab cao-tab qv-cao-section-header-tab1" ng-class="{\'lui-active\' : chartsToShow.activeTab === \'generated\'}" tabindex="0" ng-click="showGeneratedInsights($event)" ng-keypress="showGeneratedInsights($event)">\n\t\t\t\t\t\t\t  <span class="lui-tab__text qv-cao-section-header-tab1-text">{{numberOfGeneratedInsights}}</span>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li class="lui-tab cao-tab qv-cao-section-header-tab2" ng-class="{\'lui-active\' : chartsToShow.activeTab === \'found\'}" tabindex="0" ng-click="showFoundInsights($event)" ng-keypress="showFoundInsights($event)">\n\t\t\t\t\t\t\t  <span class="lui-tab__text qv-cao-section-header-tab2-text">{{numberOfFoundInsights}}</span>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<div class="results-action-container" ng-class="{\'results-action-container--tabset\': chartMatches.length > 0}">\n\t\t\t\t\t\t\t<button class="lui-button clear-insights-btn" ng-if="isClearResultsVisible()" tid="clear-insights-btn" ng-click="clearInsightResults()" q-translation="cao.insights.clear"></button>\n\t\t\t\t\t\t\t<button class="lui-button lui-button--success refresh-insights-btn" ng-if="caoTweakEnabled && learningPerformed" tid="refresh-insights-btn" ng-click="refreshCharts()" q-translation="cao.insight.results.refreshButton"></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="qv-cao-section-results" ng-if="state === \'LOADED\'">\n\t\t\t\t\t\t<qv-cao-insight class="qv-cao-section-result-item" ng-class-odd="\'qv-cao-section-result-item-odd\'" ng-focus="onGridFocus()" ng-blur="onGridBlur()" ng-repeat="chart in chartsToShow.charts | orderBy : \'-chart.relevance\'" ng-class="{\'cao-insight-focus\': itemAccFocus}"\n\t\t\t\t\t\t\tgrid-screen-reader="gridScreenReader"\n\t\t\t\t\t\t\tindex="$index"\n\t\t\t\t\t\t\tchart="chart"\n\t\t\t\t\t\t\tapp="::app"\n\t\t\t\t\t\t\tsheets="::sheets"\n\t\t\t\t\t\t\tdebug="::debug"\n\t\t\t\t\t\t\tinteractive="::false"\n\t\t\t\t\t\t\tdirection="direction"\n\t\t\t\t\t\t\tscroll-container="scrollContainer"\n\t\t\t\t\t\t\theader-action="zoomChart"\n\t\t\t\t\t\t\theader-icon="lui-icon--expand"\n\t\t\t\t\t\t\tpermissions="permissions"\n\t\t\t\t\t\t\tsend-feedback="sendFeedback(chart, type)"\n\t\t\t\t\t\t\ton-insight-focus="onGridFocus()"\n\t\t\t\t\t\t\ton-insight-blur="onGridBlur()">\n\t\t\t\t\t\t</qv-cao-insight>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="qv-cao-section-footer" ng-if="state === \'LOADED\' && insightFeedback && hiddenCharts.length > 0 && chartsToShow.activeTab !== \'found\' && !caoTweakEnabled">\n\t\t\t\t\t\t<span q-translation="cao.card.section.hidden,{{hiddenCharts.length}}"></span>\n\t\t\t\t\t\t<a class="lui-fade-button show-more-button" ng-click="showHiddenCharts()">\n\t\t\t\t\t\t\t(<span q-translation="{{ showHidden ? \'cao.card.section.hidden.hide\' : \'cao.card.section.hidden.show\' }}"></span>)\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="qv-cao-section-results qv-cao-section-hidden" ng-if="state === \'LOADED\' && showHidden && chartsToShow.activeTab !== \'found\' && !caoTweakEnabled">\n\t\t\t\t\t\t<qv-cao-insight class="qv-cao-section-result-item" ng-class-odd="\'qv-cao-section-result-item-odd\'" ng-focus="onGridFocus()" ng-blur="onGridBlur()" ng-repeat="chart in hiddenCharts | orderBy : \'-chart.relevance\'" ng-class="{\'cao-insight-focus\': itemAccFocus}"\n\t\t\t\t\t\t\tgrid-screen-reader="gridScreenReader"\n\t\t\t\t\t\t\tindex="$index + renderableCharts.length"\n\t\t\t\t\t\t\tchart="chart"\n\t\t\t\t\t\t\tapp="::app"\n\t\t\t\t\t\t\tsheets="::sheets"\n\t\t\t\t\t\t\tdebug="::debug"\n\t\t\t\t\t\t\tinteractive="::false"\n\t\t\t\t\t\t\tdirection="direction"\n\t\t\t\t\t\t\tscroll-container="scrollContainer"\n\t\t\t\t\t\t\theader-action="zoomChart"\n\t\t\t\t\t\t\theader-icon="lui-icon--expand"\n\t\t\t\t\t\t\tpermissions="permissions"\n\t\t\t\t\t\t\tsend-feedback="sendFeedback(chart, type)"\n\t\t\t\t\t\t\ton-insight-focus="onGridFocus()"\n\t\t\t\t\t\t\ton-insight-blur="onGridBlur()">\n\t\t\t\t\t\t</qv-cao-insight>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="qv-cao-footer" ng-if="nluEnabled && (state === \'INTRO\' || state === \'INIT\')">\n\t\t\t<p>{{ introDescriptionGenerateInsights }}</p>\n\t\t\t<button class=\'lui-button lui-button--success\' tid="generate-insights-intro-btn" ng-click="loadGraphs()">\n\t\t\t\t{{ introButton }}\n\t\t\t</button>\n\t\t</div>\n\t\t<qv-cao-refresh-indicator ng-if="isRefreshIndicatorVisible()" />\n\t</div>\n\n\t<qv-cao-insights-context-panel ng-if="isCaoInsightContextPanelVisible()" app="app" hidden-charts="hiddenCharts" class="context-panel cao-height" tid="cao-context-panel" state="state" insight-feedback="insightFeedback" precedents-enabled="appPrecedents.enabled"></qv-cao-insights-context-panel>\n\t<qv-cao-insights-bottom-panel ng-if="caoTweakEnabled" app="app" insight-feedback="insightFeedback"></qv-cao-insights-bottom-panel>\n</div>\n'},911:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t=function t(){};function e(t){if(t){var e=t.filter(function(t){return t.type.startsWith("master_")});var n=t.filter(function(t){return t.type.startsWith("field")});if(e.length)return e[0];if(n.length)return n[0]}}function n(t,e,n){var i=null;if(e.type.startsWith("master_")){i={libId:e.libId};t.libItems.push(i)}else if("field"===e.type){i={name:e.name};t.fields.push(i)}i&&n&&(i.cond=n)}t.buildDataCollection=function(t){var i={fields:[],libItems:[]};if(t.entities){t.entities.filter(function(t){return"model_element"==t.type}).forEach(function(t){var a=e(t.model_elements);null!=a&&n(i,a)});t.entities.filter(function(t){return"data_value"==t.type&&"filter-category"==t.role}).forEach(function(t){if(t.data_values&&t.data_values.length){var e=t.data_values[0];n(i,e.owner,["==",e.value])}})}if(t.intent){var a=t.intent.name.split("-")[1];a&&(i.analysisTypes=[a])}return i};return t}.apply(e,i),void 0!==a&&(t.exports=a))},912:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(54),n(122),n(94),n(322),n(91),n(90),n(128),n(49),n(103),n(97),n(222),n(105),n(95),n(123),n(223),n(913),n(914),n(915),n(916),n(917),n(918),n(919),n(920),n(934),n(374)],a=function(t,e,n,i,a,s,r,o,l,c,u,d,p,h,f,g,v,m,b,y,S,I,x){var q=["$scope","qvCaoService","qvAccessibilityGridService","$element","$timeout","qvContextMenu","$exportDialog","luiPopover","$window","qvCaoSelectionService",function(e,m,q,w,C,P,E,k,T,O){var A=this;var $=null;var D=[];var _;this.id=o.generateId();this.activeSheet=l.getModel();this.viewDataToggled=false;this.chartLoaded=false;this.contextMenuStatus={open:false};this.lightEditing=c.getFlag("INSIGHT_LIGHT_EDITING");this.generatedChartScreenReaderLabel=r.get("generated.insight.card.screen.reader");this.insightFeedback=c.getFlag("CE_PRECEDENTS");this.insightLearning=c.getFlag("CE_PRECEDENTS");this.caoTweakEnabled=c.getFlag("CAO_TWEAK");this.popupOpen=false;this.shouldFadeToast=false;this.onResize=function(){if(A.row>=0&&A.col>=0){var t=A.row;var e=A.col;A.setRowAndColumn();var n=t!==A.row;n=n||e!==A.col;n&&q.updateItem(A.id,"CaoInsight",A.row,A.col)}};this.resetFocusOnMouseup=function(){A.isFocused=false};this.setFocusOnInsight=function(t){C(function(){A.isFocused=t})};this.setRowAndColumn=function(){var t=3;T.innerWidth<=1024?t=1:T.innerWidth<=1920&&(t=2);A.row=Math.floor(A.index/t);A.col=A.index%t;A.hideConfidenceText=w[0].clientWidth<390};var M=w.find("#sr-cell-status-label");e.accCallback=function(t,e){var n=t===this.col&&e===this.row;A.tabIndex=n?0:-1;n||A.onInsightBlur();C(function(){A.isFocused=!!n})};this.getChartAddMenuItems=function(t){var e=A.chart.isFound();if(e&&!A.isHidden()){var n=A.chart.getSheetsThisChartAppearsOn()[0];t.addItem({translation:A.getSheetName(n),icon:"goto",tid:"cao-external-link",select:function t(){A.gotoSheet(n)}})}var i=[];A.sheets.forEach(function(t){t.permissions&&t.permissions.update&&i.push({translation:t.qMeta.title,tid:"cao-add-to-sheet",icon:"sheet",select:function n(){e&&(A.isCopyMenuItemSelected=true);A.addChartToSheet(t.qInfo.qId)}})});if(A.permissions&&A.permissions.createSheet&&!A.isHidden()){i.push({translation:"cao.search.add.createNewSheet",tid:"cao-add-to-new-sheet",icon:"plus",select:function t(){A.addToNewSheet()}});if(i.length>0){var a=t.addItem({translation:e?"cao.resultitem.contextMenu.copyItem":"cao.resultitem.contextMenu.addItem",icon:e?"copy":"plus",tid:"cao-add"});i.forEach(function(t){a.addItem(t)})}}};this.getChartMenuItems=function(t){var e={translation:"contextMenu.export",tid:"export",icon:"export",select:function t(){A.exportData()}};A.chart.isDataViewSupported()&&A.interactive&&!A.isHidden()&&t.addItem({translation:A.chart.isViewDataToggled()?"contextMenu.viewSource":"contextMenu.viewData",tid:"toggle-flip-to-table",icon:A.chart.isViewDataToggled()?"back":"table",select:function t(){A.flipToTable()}});if(A.chart.isViewDataToggled())A.enableShare&&A.chart.getObject().supportExportData()&&t.addItem(e);else if(!A.isHidden()){A.insightLearning?A.insightLearning&&A.chart.isModified()&&!A.interactive&&!A.caoTweakEnabled&&t.addItem({translation:"cao.insight.inlinerefresh.indicator.action",tid:"cao-learn",icon:"lightbulb",select:function t(){A.refreshAndLearn()}}):t.addItem({translation:"cao.resultitem.info",tid:"cao-open-info",icon:"info",select:function t(){A.openInfo()}});this.getChartAddMenuItems(t);if(A.enableShare&&(A.chart.getObject().supportExport()||A.chart.getObject().supportExportData())){var n=t.addItem({translation:"contextMenu.exportGroup",tid:"cao-share",icon:"export"});if(A.chart.getObject().supportExport()){n.addItem({translation:"contextMenu.export.chart.image",tid:"cao-print-object-image",select:function t(){A.exportToImage()}});n.addItem({translation:"contextMenu.export.chart.pdf",tid:"cao-print-object-pdf",select:function t(){A.exportToPdf()}})}A.enableShare&&A.chart.getObject().supportExportData()&&n.addItem({translation:"contextMenu.export",tid:"export",select:function t(){A.exportData()}})}A.caoTweakEnabled&&A.chart.isGenerated()&&t.addItem({translation:A.isSelected()?"cao.resultitem.finishEditInsightProperties":"cao.resultitem.editInsightProperties",tid:"cao-editInsightProperties",icon:A.isSelected()?"tick":"edit",select:function t(){A.editInsightProperties()}})}A.isHidden()||t.addItem({translation:A.interactive?"cao.resultitem.collapse":"cao.resultitem.expand",tid:"cao-expandCollapseChart",icon:A.interactive?"collapse":"expand",select:function t(){A.headerAction(A.chart)}});this.insightFeedback&&A.chart.isGenerated()&&t.addItem({translation:this.getFeedbackText(),tid:"cao-hideSuggestedChart",icon:"view",select:function t(){A.sendUserFeedback()}})};this.setChartBlurHandler=function(){this.chart.getObject().setOnBlurHandler(function(){q.setFocus("CaoInsight",A);A.isFocused=true})};this.editorKeyDownHandler=function(t){switch(t.which){case 27:A.headerAction(A.chart).then(function(){A.tabIndex=0;A.isFocused=true});M.text(r.get("Accessibility.Object.CloseFullScreenMode"))}};this.keyDownHandler=function(t){switch(t.which){case q.RIGHT_KEY:case q.LEFT_KEY:case q.UP_KEY:case q.DOWN_KEY:this.contextMenuStatus.open&&P.close();if(0===A.tabIndex){t.stopPropagation();t.preventDefault();this.interactive||q.key(t,"CaoInsight")}break;case 9:if(!A.caoTweakEnabled){t.shiftKey&&P.close();A.onInsightBlur();A.isFocused=!A.isFocused}break;case 13:case 32:P.close();t.stopImmediatePropagation();t.stopPropagation();t.preventDefault();if(!A.chart.isObjectInvalid()&&!A.isHidden()){if(t.shiftKey){A.isFocused=false;A.headerAction(A.chart).then(function(){A.tabIndex=0;A.isFocused=true});M.text(r.get("Accessibility.Object.FullScreenMode"))}else if(A.viewDataSupported()&&A.interactive)A.chart.toggleDataView().then(function(){A.chart.isViewDataToggled()&&M.text(r.get("Accessibility.Object.ViewDataMode"))});else if(A.chart.isViewDataToggled()&&"function"===typeof this.chart.getObject().dataViewObject.focus){A.isFocused=false;this.chart.getObject().dataViewObject.focus()}else if("function"===typeof this.chart.getObject().focus){A.isFocused=false;this.chart.getObject().focus()}else M.text(r.get("Accessibility.Object.CannotViewData"));M.text("")}break;case 27:if(this.contextMenuStatus.open)P.close();else if(this.chart.isViewDataToggled())this.chart.toggleDataView().then(function(){A.chart.isViewDataToggled()||M.text(r.get("Accessibility.Object.ViewChartMode"))});else if(this.interactive){A.headerAction(A.chart).then(function(){A.tabIndex=0;A.isFocused=true});M.text(r.get("Accessibility.Object.CloseFullScreenMode"))}A.isFocused=true;break;case 121:if(t.shiftKey&&!this.contextMenuStatus.open){var n=w.offset();t.pageY=n.top+w.height()/2;t.pageX=n.left+w.width()/2;e.$broadcast("cao.openContextMenu",{event:t,closeFn:function t(){A.isFocused=true},element:w.find(".result-item-graph-container")})}break}};this.onBlur=function(){this.isFocused=false;this.onInsightBlur()};this.$onInit=function(){if(this.interactive){this.tabIndex=0;this.isFocused=true}this.initializeState();this.setRowAndColumn();if(this.interactive)this.tabIndex=0;else{$=q.addItem(this.id,e.accCallback,"CaoInsight",this.col,this.row);this.tabIndex=$?0:-1}d.on("end",this.onResize)};this.$onChanges=function(){this.permissions&&(this.enableShare=this.permissions.exportData)};this.$doCheck=function(){A.caoTweakEnabled&&(A.isSelected()?A.chart.setChartInteractionState(g.STATIC):A.chart.setChartInteractionState(g.ANALYSIS))};this.$onDestroy=function(){A.interactive||q.removeItem("CaoInsight",A.id);t(".qv-cao-scroll-content").unbind("scroll",A.closePopups);d.off("end",this.onResize);f.unsubscribe("cao/insights/adapt_chart");A.shouldFadeToastTimer&&C.cancel(A.shouldFadeToastTimer)};this.isSelected=function(){var t=O.getSelectedChart();return t&&A.chart&&A.chart===t};this.onChartLoaded=function(){this.chartLoaded=true;if(A.caoTweakEnabled){A.chart.activateSelectionWatch(function(){A.chart.isInSelectionState=true});A.chart.deactivateSelectionWatch(function(){A.chart.isInSelectionState=false})}};this.initializeState=function(){t(".qv-cao-scroll-content").bind("scroll",A.closePopups);this.chartLoaded="LOADED"===this.chart.getState();this.chart.refreshChartType();this.matchDetails=this.chart.getMatchDetails()};this.chartClick=function(){!A.chartLoaded||A.headerActionInProgress||A.interactive||A.contextMenuStatus.open||A.isHidden()||A.caoTweakEnabled?A.closePopups():A.headerAction(A.chart)};this.editInsightProperties=function(e){if(e){e.preventDefault();e.stopPropagation();A.caoTweakEnabled&&C(function(){t("button.cao-edit-field-header-title.lui-button").first().focus()})}if(this.caoTweakEnabled&&this.chartLoaded&&!this.headerActionInProgress){A.closePopups();if(this.isSelected()){O.clearSelection();v.storageObj(A.app.id).contextPanel||f.publish("cao/insight/contextPanelToggled",false);f.publish("cao/insight/editInsightProperties",false)}else{A.isCaoContextPanelVisible||f.publish("cao/insight/contextPanelToggled",true);f.publish("cao/insight/editInsightProperties",true);O.selectChart(A.chart)}}};this.sendUserFeedback=function(){A.chart.setModified(false);A.feedbackInProgress=true;A.isHidden()||u.trackEvent(u.customEvents.INSIGHTS_HIDE_CHART_CLICKED,{chart:A.chart.getAnalysisPrecedentId()});A.sendFeedback({chart:A.chart,type:h.Precedents.PrecedentTypes.Dislike}).then(function(){A.interactive&&A.headerAction(A.chart)}).finally(function(){A.feedbackInProgress=false})};this.adaptChart=function(t){if(A.chart===t){A.chart.getTitle().then(function(t){A.dataMode&&(A.dataMode=false);A.title=t});A.shouldFadeToast=false;A.shouldFadeToastTimer=C(function(){A.shouldFadeToast=true},5e3)}};f.subscribe("cao/insights/adapt_chart",A.adaptChart);this.refreshAndLearn=function(){A.feedbackInProgress=true;A.sendFeedback({chart:A.chart,type:h.Precedents.PrecedentTypes.Like}).then(function(){A.interactive&&A.headerAction(A.chart)}).finally(function(){u.trackEvent(u.customEvents.INSIGHTS_LEARN_CLICKED);A.feedbackInProgress=false;A.chart.setModified(false)})};this.isHidden=function(){return A.chart.isHidden()};this.getFeedbackText=function(){return A.chart.isHidden()?"cao.card.unhide":"cao.card.hide"};this.addChartToSheet=function(t){A.isChartAdded=true;A.chart.addToSheet(t).then(function(t){F(t)})};this.addToNewSheet=function(){A.chart.addToNewSheet().then(function(t){F(t)})};this.exportToPdf=function(){A.setFocusOnInsight(false);u.trackEvent(u.customEvents.INSIGHTS_EXPORT,{type:"PDF",chart:A.chart.getAnalysisPrecedentId()});var t=s.showForObject(A.chart.getObject(),"Pdf","object",640,480);t.closed.then(function(){A.setFocusOnInsight(true)});A.closePopups()};this.exportToImage=function(){A.setFocusOnInsight(false);u.trackEvent(u.customEvents.INSIGHTS_EXPORT,{type:"IMAGE",chart:A.chart.getAnalysisPrecedentId()});var t=s.showForObject(A.chart.getObject(),"Image","object",640,480);t.closed.then(function(){A.setFocusOnInsight(true)});A.closePopups()};this.exportData=function(){A.setFocusOnInsight(false);u.trackEvent(u.customEvents.INSIGHTS_EXPORT,{type:"DATA",chart:A.chart.getAnalysisPrecedentId()});var t=E.show(A.chart.getModel());t.closed.then(function(){A.setFocusOnInsight(true)});A.closePopups()};this.navigateToSheet=function(t){A.closePopups();m.toggleCao();i.goToSheet(t,Object.keys(a.States)[a.state])};this.gotoSheet=function(){if(1===A.chart.getSheetsThisChartAppearsOn().length)A.navigateToSheet(A.chart.getSheetsThisChartAppearsOn()[0]);else{var t=["$scope",function(t){t.appearsOnSheets=A.chart.getSheetsThisChartAppearsOn();t.getSheetName=A.getSheetName;t.gotoSheet=A.navigateToSheet}];N(x,t,w.find(".gotoSheet")[0],"top")}};this.confidenceClosed=function(){A.headerActionInProgress=false};this.confidenceOpened=function(){A.headerActionInProgress=true};this.closeConfidenceRegistration=function(t){_=t};this.closePopups=n.throttle(function(){_&&_();D.forEach(function(t,e){C(function(){t.close();D.splice(e,1)})});A.headerActionInProgress=false},200,{trailing:false});this.openAddPopover=function(){var t=["$scope",function(t){t.sheets=A.sheets;t.addChartToSheet=A.addChartToSheet;t.addToNewSheet=A.addToNewSheet;t.permissions=A.permissions}];N(b,t,w.find(".add-to-button")[0],"bottom")};this.openDebugInformation=function(){var t=["$scope",function(t){t.debugInformation=A.chart.getSearchReport();t.visualization=A.chart.chart.visualization;t.complexity=A.chart.chart.complexity}];N(y,t,w.find(".debug-information")[0],"bottom")};this.openShare=function(){if(A.popupOpen)A.popupOpen=false;else{A.popupOpen=true;var t=["$scope",function(t){if(!A.chart.isViewDataToggled()&&A.chart.getObject().supportExport()){t.exportToPdf=A.exportToPdf;t.exportToImage=A.exportToImage}A.chart.getObject().supportExportData()&&(t.exportData=A.exportData)}];N(S,t,w.find(".share")[0],"bottom")}};this.openInfo=function(){var t=function t(){C(function(){A.isFocused=true})};C(function(){A.isFocused=false});var e=["$scope",function(t){t.type=A.chart.chart.visualization.type;t.title=A.chart.isGenerated()?"cao.search.info.title.generated":"cao.search.info.title.found";t.matches=[];A.matchDetails&&A.matchDetails.forEach(function(e){var n="";var i="";if(A.chart.isGenerated()){switch(e.matchedOn){case"exactMatch":n=r.get("cao.search.generated.exactMatch");break;case"literalMatch":n=r.get("cao.search.generated.literalMatch");break;case"headMatch":n=r.get("cao.search.generated.headMatch");break;case"headSynonymMatch":n=r.get("cao.search.generated.headSynonymMatch");break;case"headStemMatch":n=r.get("cao.search.generated.headStemMatch");break;case"headStemSynonymMatch":n=r.get("cao.search.generated.headStemSynonymMatch");break;case"partialTokenMatch":n=r.get("cao.search.generated.partialTokenMatch");break;case"substrPartialMatch":n=r.get("cao.search.generated.substrPartialMatch");break;case"semanticMatch":n=r.get("cao.search.generated.semanticMatch");break;case"valueMatch":n=r.get("cao.search.generated.valueMatch");break;default:break}n=n.replace(/\{1\}/g,function(t){return"<b>"+t+"</b>"});i=r.get(n,[A.chart.getSearchReport().search.searchPhrase.text,e.matchedField]);t.matches.push(i)}else if(A.chart.isFound()){switch(e.matchedField){case"titleMatch":n=r.get("cao.search.titleMatch");break;case"subTitleMatch":n=r.get("cao.search.subTitleMatch");break;case"footnoteMatch":n=r.get("cao.search.footnoteMatch");break;case"basedOnMatch":n=r.get("cao.search.basedOnMatch");break;default:break}n=n.replace(/\{1\}/g,function(t){return"<b>"+t+"</b>"});i=r.get(n,[A.chart.getSearchReport().search.searchPhrase.text,e.matchedOn]);t.matches.push(i)}});t.formattedSheetLinks=[];var e=r.get("cao.search.info.found.match");e=e.replace(/\{0\}/g,function(t){return"<b>"+t+"</b>"});A.chart.getSheetsThisChartAppearsOn().forEach(function(n){var i=A.getSheetName(n);var a=r.get(e,[i]);t.formattedSheetLinks.push({label:a,sheetId:n})});t.gotoSheet=A.navigateToSheet}];N(I,e,w.find(".info")[0],"bottom",t)};this.getSheetName=function(t){var e=A.sheets.filter(function(e){return e.qInfo.qId===t})[0];if(e)return e.qMeta.title};function N(t,e,n,i,a){var s={template:t,controller:e,dock:i,closeOnResize:true,alignTo:n};var r=k.show(s);D.push(r);r.closed.then(function(){A.headerActionInProgress=false;A.popupOpen=false;"function"===typeof a&&a()});A.headerActionInProgress=true}function F(t){m.scrapeApp();u.trackEvent(u.customEvents.INSIGHTS_ADD_CHART,{chart:A.chart.getAnalysisPrecedentId()});A.closePopups();C(function(){w.find(".result-item-buttons").addClass("animate")});C(function(){A.addedToSheet=true;A.chart.getSheetsThisChartAppearsOn().indexOf(t.id)>-1&&(A.isCopyMenuItemSelected?A.addOrCopySuccessText="cao.insight.copiedToSheet":A.addOrCopySuccessText="cao.search.addedToSheet");p.resizeCharts(T);C(function(){w.find(".result-item-added").addClass("animate")})},500);C(function(){w.find(".goto-sheet").addClass("animate")},2500);C(function(){A.addedToSheet=false;w.find(".goto-sheet").removeClass("animate");w.find(".result-item-added").removeClass("animate");w.find(".result-item-buttons").removeClass("animate")},4e3)}this.flipToTable=function(){var t=A.chart.isDataViewSupported()&&A.interactive;if(t){u.trackEvent(u.customEvents.INSIGHTS_FLIP_TO_TABLE);A.chart.toggleDataView();A.dataMode=!A.dataMode}};this.viewDataSupported=function(){return A.chart.isDataViewSupported()};e.$watch(function(){return t(".qv-contextmenu").length},function(){if(0===t(".qv-contextmenu").length)C(function(){A.chart.setChartInteraction(true);A.contextMenuStatus={open:0!==t(".qv-contextmenu").length}},300);else{A.chart.setChartInteraction(false);A.contextMenuStatus={open:true}}});e.$watch(function(){return A.chart.shouldRedraw},function(){A.chart.getTitle().then(function(t){A.dataMode&&(A.dataMode=false);A.title=t})})}];var w={transclude:true,template:m,bindings:{chart:"<",app:"<",headerAction:"<",headerIcon:"@",interactive:"<",direction:"<",sheets:"<",alwaysShowHeader:"<",scrollContainer:"<",debug:"<",permissions:"<",index:"<",gridScreenReader:"=",onInsightBlur:"&",onInsightFocus:"&",sendFeedback:"&",isCaoContextPanelVisible:"<"},controller:q};return e.nativeComponent("qvCaoInsight",w)}.apply(e,i),void 0!==a&&(t.exports=a))},913:function(t,e){t.exports='<div class="cao-insight">\n\t<div class="cao-insight-in-selection-overlay" ng-if="$ctrl.chart.isInSelectionState && $ctrl.caoTweakEnabled"></div>\n\t<div class="cao-insight-container" ng-class="{\'zoom\': $ctrl.interactive, \'hidden\': $ctrl.isHidden(), \'generated\': $ctrl.chart.isGenerated(), \'lightedit\': $ctrl.lightEditing && !$ctrl.caoTweakEnabled, \'selected\': $ctrl.isSelected()}" tabindex="{{$ctrl.tabIndex}}"\n\t\tng-keydown="$ctrl.keyDownHandler($event)" focus-when="$ctrl.isFocused" ng-focus="$ctrl.onInsightFocus()" dir="{{$ctrl.direction}}" test-chart-loaded="{{$ctrl.chartLoaded}}">\n\t\t<div class="hidden-screen-reader-label" aria-label="{{$ctrl.gridScreenReader}}"></div>\n\t\t<label class="hidden-screen-reader-label" id="sr-cell-status-label" aria-live="assertive"></label>\n\t\t<div class="result-item-title-bar" dir="{{$ctrl.direction}}" ng-class="{ \'interactive\': $ctrl.interactive}">\n\t\t\t<div class="result-item-title" title="{{ $ctrl.title }}" qva-direction x-dir-setting="{{$ctrl.direction}}" x-dir-text="{{$ctrl.title}}" ng-click="$ctrl.editInsightProperties($event)" tid="insight-chart-edit-button">\n\t\t\t\t<span>{{ $ctrl.title }}</span>\n\t\t\t</div>\n\t\t\t<div class="result-item-title-icons" ng-class="{ \'active\': $ctrl.headerActionInProgress || $ctrl.interactive || $ctrl.isSelected() }" q-title-translation="cao.resultitem.info">\n\t\t\t\t<button ng-click="$ctrl.openInfo()" ng-keyup="$event.keyCode == 13 ? $ctrl.openInfo() : null" class="insight-chart-info-button result-item-title-icon" ng-show="!$ctrl.insightLearning && $ctrl.chartLoaded && !$ctrl.isHidden()">\n\t\t\t\t\t<span class="info lui-icon lui-icon--info"></span>\n\t\t\t\t</button>\n\t\t\t\t<button ng-if="$ctrl.caoTweakEnabled && !$ctrl.isSelected() && $ctrl.chart.isGenerated()" class="result-item-title-icon" ng-click="$ctrl.editInsightProperties($event)" ng-keyup="$event.keyCode == 13 ? $ctrl.editInsightProperties($event) : null"\n\t\t\t\t\tq-title-translation="cao.resultitem.editInsightProperties" tid="insight-chart-edit-properties-button" ng-show="$ctrl.chartLoaded && !$ctrl.isHidden()">\n\t\t\t\t\t<span class="lui-icon--edit lui-icon"></span>\n\t\t\t\t</button>\n\t\t\t\t<button ng-if="$ctrl.caoTweakEnabled && $ctrl.isSelected()" class="result-item-title-icon" ng-click="$ctrl.editInsightProperties($event)" ng-keyup="$event.keyCode == 13 ? $ctrl.editInsightProperties($event) : null" q-title-translation="cao.resultitem.finishEditInsightProperties"\n\t\t\t\t\ttid="insight-chart-finish-edit-properties-button" ng-show="$ctrl.chartLoaded">\n\t\t\t\t\t<span class="lui-icon--tick lui-icon result-item-title-icon-checkmark"></span>\n\t\t\t\t</button>\n\t\t\t\t<button ng-click="$ctrl.openShare()" ng-keyup="$event.keyCode == 13 ? $ctrl.openShare() : null" class="result-item-title-icon" ng-if="$ctrl.enableShare" q-title-translation="contextMenu.exportGroup" tid="insight-chart-export-button" ng-show="$ctrl.chartLoaded && !$ctrl.isHidden()">\n\t\t\t\t\t<span class="share lui-icon lui-icon--export"></span>\n\t\t\t\t</button>\n\t\t\t\t<button ng-click="$ctrl.openDebugInformation()" ng-keyup="$event.keyCode == 13 ? $ctrl.openDebugInformation() : null" class="result-item-title-icon" ng-if="$ctrl.debug">\n\t\t\t\t\t<span class="debug-information lui-icon lui-icon--cogwheel"></span>\n\t\t\t\t</button>\n\t\t\t\t<button tabindex="0" ng-if="!$ctrl.interactive" class="result-item-title-icon" ng-click="$ctrl.headerAction($ctrl.chart)" ng-keyup="$event.keyCode == 13 ? $ctrl.headerAction($ctrl.chart) : null" q-title-translation="cao.resultitem.expand" tid="insight-chart-expand-button"\n\t\t\t\t\tng-show="$ctrl.chartLoaded && !$ctrl.isHidden()">\n\t\t\t\t\t<span class="qv-cao-item-expand-icon lui-icon" ng-class="$ctrl.headerIcon"></span>\n\t\t\t\t</button>\n\t\t\t\t<button ng-if="$ctrl.interactive" class="result-item-title-icon" ng-click="$ctrl.headerAction($ctrl.chart)" ng-keyup="$event.keyCode == 13 ? $ctrl.headerAction($ctrl.chart) : null" q-title-translation="cao.resultitem.collapse" tid="zoomed-chart-shrink-button">\n\t\t\t\t\t<span class="lui-icon--remove lui-icon"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="chart-container">\n\t\t\t<div class="insight">\n\t\t\t\t<qv-cao-insight-chart set-blur-handler="$ctrl.setChartBlurHandler()" get-chart-menu-items="$ctrl.getChartMenuItems(menu)" ng-click="$ctrl.chartClick(id)" class="result-item-graph" chart="$ctrl.chart" app="::$ctrl.app" on-chart-loaded="$ctrl.onChartLoaded()"\n\t\t\t\t\tinteractive="$ctrl.interactive" scroll-container="$ctrl.scrollContainer" object="$ctrl.object" ng-class="{\'clickable\': !$ctrl.contextMenuStatus.open}" context-menu-status="$ctrl.contextMenuStatus" index="$ctrl.index" />\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="result-item-footer" dir="{{$ctrl.direction}}">\n\t\t\t<div ng-if="$ctrl.chart.isGenerated()" aria-hidden="true" class="result-item-buttons" ng-show="!$ctrl.addedToSheet">\n\t\t\t\t<div class="footer-left" ng-if="!$ctrl.interactive">\n\t\t\t\t\t<cao-confidence ng-if="!$ctrl.caoTweakEnabled" class="result-item-title-icon" data-chart="$ctrl.chart" button-id="confidence_{{$parent.$parent.$parent.$parent.$index}}" ng-show="$ctrl.insightLearning" close-notification="$ctrl.closeConfidenceRegistration(handler)"\n\t\t\t\t\t\topened="$ctrl.confidenceOpened()" closed="$ctrl.confidenceClosed()" hide-text="$ctrl.hideConfidenceText"></cao-confidence>\n\t\t\t\t\t<span class="title generated-insight-title" ng-show="!$ctrl.insightLearning" q-translation="cao.search.card.generated" aria-label="{{$ctrl.generatedChartScreenReaderLabel}}"></span>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="footer-right">\n\t\t\t\t\t<div class="feedback-button-container" ng-if="$ctrl.insightFeedback && !$ctrl.caoTweakEnabled" qva-direction x-dir-setting="{{$ctrl.direction}}">\n\t\t\t\t\t\t<lui-button tid="insight-feedback-button" ng-click="$ctrl.sendUserFeedback()" ng-disabled="!$ctrl.chartLoaded || $ctrl.feedbackInProgress" tabindex="-1" q-translation="{{$ctrl.getFeedbackText()}}"\n\t\t\t\t\t\t\tng-class="{\'btn-state-unhide\': $ctrl.chart.isHidden(), \'btn-state-hide\': !$ctrl.chart.isHidden()}">\n\t\t\t\t\t\t</lui-button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="lui-buttongroup" tid="cao-add-to-sheet-button" ng-if="$ctrl.activeSheet.layout.permissions.update && $ctrl.permissions.createSheet">\n\t\t\t\t\t\t<lui-button ng-click="$ctrl.addChartToSheet()" tabindex="-1" ng-disabled="!$ctrl.chartLoaded || $ctrl.isChartAdded" q-translation="cao.search.addToSheet">\n\t\t\t\t\t\t</lui-button>\n\t\t\t\t\t\t<lui-button class="add-to-button" tabindex="-1" q-title-translation="cao.search.addToSheetOptions" ng-disabled="!$ctrl.chartLoaded" ng-click="$ctrl.openAddPopover()">\n\t\t\t\t\t\t\t<span class="lui-overlay-button__caret lui-caret"></span>\n\t\t\t\t\t\t</lui-button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="lui-buttongroup" ng-if="!$ctrl.activeSheet.layout.permissions.update && $ctrl.permissions.createSheet">\n\t\t\t\t\t\t<lui-button class="add-to-button" tabindex="-1" q-title-translation="cao.search.addToSheetOptions" ng-disabled="!$ctrl.chartLoaded" ng-click="$ctrl.openAddPopover()">\n\t\t\t\t\t\t\t<span q-translation="cao.search.addToSheet"></span>\n\t\t\t\t\t\t\t<span class="lui-overlay-button__caret lui-caret"></span>\n\t\t\t\t\t\t</lui-button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div ng-if="$ctrl.chart.isFound()" ng-class="{ \'itemAdded\': $ctrl.addedToSheet }" class="result-item-added result-item-buttons">\n\t\t\t\t<span>\n\t\t\t\t\t<div class="goto-sheet" ng-show="$ctrl.addedToSheet">\n\t\t\t\t\t\t<span class="tick-highlight" qva-direction x-dir-setting="{{$ctrl.direction}}">\n\t\t\t\t\t\t\t<span class="lui-icon lui-icon--tick"></span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span q-translation="{{$ctrl.addOrCopySuccessText}}"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</span>\n\t\t\t\t<a ng-click="$ctrl.gotoSheet($ctrl.chart.getSheetsThisChartAppearsOn()[0])" q-title-translation="Storytelling.Sheet.GoToSheet">\n\t\t\t\t\t<span ng-if="$ctrl.chart.getSheetsThisChartAppearsOn().length === 1" x-dir-text="{{ $ctrl.getSheetName($ctrl.chart.getSheetsThisChartAppearsOn()[0]) }}" qva-direction x-dir-setting="{{$ctrl.direction}}">\n\t\t\t\t\t\t{{ $ctrl.getSheetName($ctrl.chart.getSheetsThisChartAppearsOn()[0]) }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span ng-if="$ctrl.chart.getSheetsThisChartAppearsOn().length > 1" q-translation="cao.search.multipleSources">\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class="gotoSheet lui-icon lui-icon--goto" qva-direction x-dir-setting="{{$ctrl.direction}}"></span>\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="editor cao-chart-light-editing" ng-if="$ctrl.lightEditing && $ctrl.interactive && $ctrl.chart.isGenerated() && !$ctrl.caoTweakEnabled" ng-keydown="$ctrl.editorKeyDownHandler($event)">\n\t\t\x3c!-- TODO: move to directive --\x3e\n\t\t<div class=\'qv-panel-properties\' style="overflow: auto;">\n\t\t\t<qv-cao-insight-editor chart="$ctrl.chart" app="$ctrl.app" />\n\t\t</div>\n\t</div>\n\t<div class="cao-chart-refresh-indicator-container" ng-class="{\'visible\': $ctrl.insightLearning && $ctrl.chart.isModified() && !$ctrl.interactive && !$ctrl.shouldFadeToast, \'fade\': $ctrl.shouldFadeToast}" ng-if="$ctrl.insightLearning && $ctrl.chart.isModified() && !$ctrl.interactive" ng-click="$ctrl.adaptChart($ctrl.chart)">\n\t\t<div class="cao-chart-refresh-indicator-content">\n\t\t\t<div class="cao-chart-refresh-top">\n\t\t\t\t<span class="lui-icon lui-icon--close" ng-click="$ctrl.chart.setModified(false)"></span>\n\t\t\t</div>\n\t\t\t<div class="cao-chart-text" ng-class="{\'cao-chart-text-no-refresh\': $ctrl.caoTweakEnabled}">\n\t\t\t\t<div q-translation="cao.insight.inlinerefresh.indicator.body.lineone" />\n\t\t\t\t<div q-translation="cao.insight.inlinerefresh.indicator.body.linetwo" />\n\t\t\t</div>\n\t\t\t<div class="cao-chart-refresh-indicator-action-container">\n\t\t\t\t<div class="cao-chart-refresh-action">\n\t\t\t\t\t<a class="cao-chart-refresh" ng-click="$ctrl.refreshAndLearn()" q-translation="cao.insight.inlinerefresh.indicator.action" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'},914:function(t,e){t.exports='<lui-popover class="cao-add-popover">\n\t<div class="lui-popover__body lui-nopad popover-body">\n\t\t<ul class="lui-list">\n\t\t\t<li class="lui-list__item lui-list__action" ng-click="addChartToSheet(sheet.qInfo.qId)" ng-repeat="sheet in sheets"\n\t\t\t ng-if="sheet.permissions.update">\n\t\t\t\t<span class="lui-list__aside lui-icon lui-icon--sheet"></span>\n\t\t\t\t<span class="lui-list__text">{{ sheet.qMeta.title }}</span>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item lui-list__action" ng-click="addToNewSheet()">\n\t\t\t\t<span class="lui-list__aside lui-icon lui-icon--plus"></span>\n\t\t\t\t<span class="lui-list__text" q-translation="cao.search.add.createNewSheet"></span>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</lui-popover>'},915:function(t,e){t.exports='<lui-popover class="cao-debug-popover">\n\t<lui-popover-body>\n\t\t<div>\n\t\t\t<b>Debug Information</b>\n\t\t\t<pre>{{ debugInformation | json : spacing }}</pre>\n\t\t\t<b ng-if="visualization.type === \'generated\'">Visualization</b>\n\t\t\t<pre ng-if="visualization.type === \'generated\'">{{ visualization | json : spacing }}</pre>\n\t\t\t<b ng-if="visualization.type === \'generated\'">Complexity</b>\n\t\t\t<pre ng-if="visualization.type === \'generated\'">Estimate: {{ complexity }}</pre>\n\n\t\t\t<b ng-if="visualization.type === \'found\'">Chart</b>\n\t\t\t<pre ng-if="visualization.type === \'found\'">\n{\n  chartId: {{ visualization.chartId }},\n  appearsOnSheets: {{ visualization.appearsOnSheets | json : spacing }}}\n\t\t\t</pre>\n\t\t</div>\n\t</lui-popover-body>\n</lui-popover>\n'},916:function(t,e){t.exports='<lui-popover class="cao-share-popover">\n\t<div class="lui-popover__body lui-nopad popover-body">\n\t\t<ul class="lui-list">\n\t\t\t<li class="lui-list__item lui-list__action" ng-if="exportToImage" ng-click="exportToImage()" tid="share-popover-export-image">\n\t\t\t\t<a class="lui-list__text" q-translation="contextMenu.export.chart.image"></a>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item lui-list__action" ng-if="exportToPdf" ng-click="exportToPdf()" tid="share-popover-export-pdf">\n\t\t\t\t<a class="lui-list__text" q-translation="contextMenu.export.chart.pdf"></a>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item lui-list__action" ng-if="exportData" ng-click="exportData()" tid="share-popover-export-data">\n\t\t\t\t<a class="lui-list__text" q-translation="contextMenu.export"></a>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</lui-popover>'},917:function(t,e){t.exports='<lui-popover class="cao-info-popover">\n    <lui-popover-body>\n        <div>\n            <ul>\n                <li class="cao-popover-title" q-translation="{{ title }}"></li>\n                <li ng-repeat="match in matches" ng-bind-html="match"></li>\n                <li ng-if="matches.length === 0 && type === \'generated\'" q-translation="cao.search.info.body.generated"></li>\n                <li ng-repeat="sheet in formattedSheetLinks">\n                    <a class="gotoSheet" ng-click="gotoSheet(sheet.sheetId)">\n                        <span ng-bind-html="sheet.label"></span>\n                        &nbsp; <span class="lui-icon lui-icon--goto"></span>\n                    </a>\n                </li>\n            </ul>\n        </div>\n    </lui-popover-body>\n</lui-popover>\n'},918:function(t,e){t.exports='<lui-popover class="cao-goto-sheet-popover">\n    <div class="lui-popover__body lui-nopad popover-body">\n        <ul class="lui-list">\n            <li class="lui-list__item lui-list__action" ng-repeat="sheet in appearsOnSheets track by $index" ng-click="gotoSheet(sheet)">\n                <span class="lui-list__aside lui-icon lui-icon--goto"></span>\n                <span class="lui-list__text">{{ getSheetName(sheet) }}</span>\n            </li>\n        </ul>\n    </div>\n</lui-popover>'},919:function(t,e,n){"use strict";var i,a;!(i=[n(48)],a=function(t){var e={restrict:"A",scope:{focusWhen:"="},controller:["$scope","$element",function(t,e){t.$watch("focusWhen",function(t){t?e.focus():false===t&&e.blur()})}]};t.directive("focusWhen",function(){return e})}.apply(e,i),void 0!==a&&(t.exports=a))},920:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(91),n(103),n(49),n(196),n(187),n(178),n(921),n(922),n(923),n(924),n(925),n(926),n(927),n(930),n(218),n(932),n(221)],a=function(t,e,n,i,a,s,r,o,l,c,u,d){var p=["qvCaoSearchService","qvCaoService","qvCaoChartService","qvAppDetailsService","luiPopover",function(t,l,p,h,f){var g=this;var v=[];var m;this.insightLearning=a.getFlag("CE_PRECEDENTS");this.caoTweakEnabled=a.getFlag("CAO_TWEAK");this.$onInit=function(){h.get().then(function(t){m=t.model.app.published||!t.model.permissions.update});e.subscribe(s.PUBSUB_TOPIC,I)};this.$onDestroy=function(){e.unsubscribe(s.PUBSUB_TOPIC)};function b(t){g.chart.setModified(g.chart.isModified()||!t&&g.chart.getMatches().filter(function(t){return t.isDirty}).length>0);g.chart.adaptChart(g.chart.isModified()).then(function(){y()});e.publish("cao/insights/adapt_chart",g.chart)}function y(){v.forEach(function(t,e){t.popup.close();v.splice(e,1)})}function S(t){v.forEach(function(e,n){t===e.id&&v.splice(n,1)})}function I(t){var e=g.chart.getMatches();var n=t.slotA;var a=t.slotB;var s,r;e.forEach(function(t,e){t.slot===n?s=e:t.slot===a&&(r=e)});var o=e[r];e[r]=e[s];e[s]=o;e[r].slot=a;e[s].slot=n;i.trackEvent(i.customEvents.INSIGHTS_LIGHT_EDITING_DRAG_AND_DROP,{chart:g.chart.getAnalysisPrecedentId()});b(true)}this.toggleMatchDetails=function(t){t.expanded=!t.expanded};this.getFields=function(){return g.chart.getMatches().filter(function(t){return!t.slotRole})};this.getMeasures=function(){return g.chart.getMatches().filter(function(t){return t.slotRole===s.MEASURE})};this.getDimensions=function(){return g.chart.getMatches().filter(function(t){return t.slotRole===s.DIMENSION})};this.getDimensionCount=function(){return g.getDimensions().length};this.getMeasureCount=function(){return g.getMeasures().length};this.getFieldCount=function(){return g.getFields().length};this.hasMeasures=function(){return g.chart.getMatches().filter(function(t){return t.slotRole===s.MEASURE}).length>0};this.hasDimensions=function(){return g.chart.getMatches().filter(function(t){return t.slotRole===s.DIMENSION}).length>0};this.applyLearning=function(){p.refreshInsights().then(function(t){var n=t.recommendations.filter(function(t){return t.chart.visualization.visualization.analysis.analysis===g.chart.chart.visualization.visualization.analysis.analysis})[0];if(n){g.chart.chart.visualization=n.chart.visualization;delete g.chart.rendered;g.chart.shouldRedraw=true;g.chart.recalculateConfidence=true}else g.chart.invalidFromLearning=true;l.setRefreshIndicatorVisibility(true);e.publish("cao/insight/learning_applied")})};this.changeAggr=function(t,e){g.chart.getMatches().forEach(function(n){if(n.slot===t.slot){n.isDirty=true;n.aggr=e}});i.trackEvent(i.customEvents.INSIGHTS_LIGHT_EDITING_AGGREGATION_CHANGE,{chart:g.chart.getAnalysisPrecedentId()});b()};this.changeField=function(t,e){g.lastAggr=t.aggr||g.lastAggr;g.chart.getMatches().forEach(function(n){if(n.slot===t.slot){n.isDirty=true;g.caoTweakEnabled&&g.toggleMatchDetails(n);if(e.libId){n.libId=e.libId;n.libIdLabel=e.libIdLabel;delete n.field;delete n.aggr}else{n.field=e.name;n.slotRole!==s.MEASURE||n.aggr||(n.aggr=g.lastAggr);delete n.libId;delete n.libIdLabel}}});i.trackEvent(i.customEvents.INSIGHTS_LIGHT_EDITING_FIELD_CHANGE,{chart:g.chart.getAnalysisPrecedentId()});b()};this.showChangeAggr=function(t,e){var n=["$scope",function(t){t.field=e;t.change=g.changeAggr;t.wrappedAggregations=r.COMMON_FUNCTIONS.map(function(t){return{text:o.getFormattedAggregation(t),action:function n(){g.changeAggr(e,o.getFormattedAggregation(t))}}})}];x(c,n,t.currentTarget,"bottom","cao-changeAggregation_"+e.slot)};this.canChangeAggregation=function(t){if(!t.restrictions)return true;var e=t.restrictions.filter(function(t){return"aggregation"===t.name})[0];return!e};this.showChangeField=function(e,n,i){var a=["$scope",function(e){var a=[];var r=[];var o=[];var l=n.restrictions?n.restrictions.filter(function(t){return"candidates"==t.name})[0]:void 0;function c(t){if(!l)return true;return l.types.indexOf(t)>-1}function u(t){a=c("eField")?t.filter(function(t){return!t.masterItem}):[];r=c("eDimLib")?t.filter(function(t){return t.masterItem&&t.classifications.filter(function(t){return t===s.DIMENSION}).length>0}):[];o=c("eMsrLib")?t.filter(function(t){return t.masterItem&&t.classifications.filter(function(t){return t===s.MEASURE}).length>0}):[];e.field=n;e.fields=a;if(i===s.DIMENSION){e.dimensions=r;e.measures=[]}else if(i===s.MEASURE){e.measures=o;e.dimensions=[]}else{e.dimensions=r;e.measures=o}}function d(n){var i=t.getMatchingFields(n,m);e.highlight=n;u(i)}var p=t.getMatchingFields(void 0,m);u(p);e.change=g.changeField;e.filterFields=d}];x(u,a,e.currentTarget,"bottom","cao-changeField_"+n.slot);g.caoTweakEnabled&&g.toggleMatchDetails(n)};this.showAnalysisInfo=function(t){var e=["$scope",function(t){var e=g.chart.chart.visualization.visualization.analysis.analysis;var i=n.get("cao.insight.analysis."+e);t.analysisTitle=n.get("cao.insight.analysis.popover.title",[i]);t.analysisDescription=n.get("cao.insight.analysis."+e+".description")}];x(d,e,t.currentTarget,"left","cao_analysisPopover")};function x(t,e,n,i,a){if(v.filter(function(t){return t.id===a})[0]){y();return}y();var s={template:t,controller:e,dock:i,alignTo:n,closeOnResize:true,outsideIgnore:a};var r=f.show(s);r.closing.then(function(){S(a)});r.closed.then(function(){n.focus()});v.push({id:a,popup:r})}}];var h={transclude:true,template:l,bindings:{chart:"=",app:"="},controller:p};return t.nativeComponent("qvCaoInsightEditor",h)}.apply(e,i),void 0!==a&&(t.exports=a))},921:function(t,e){t.exports='<div class="title" q-translation="cao.card.title.editor.title" ng-if="!$ctrl.caoTweakEnabled" />\n<div class="cao-editor-field-list">\n    <div class="header">\n        <span q-translation="cao.editor.title" />\n        <a ng-click="$ctrl.showAnalysisInfo($event)" id="cao_analysisPopover" qva-outside-ignore-for="cao_analysisPopover">\n            <span class="lui-icon lui-icon--help" />\n        </a>\n    </div>\n    <div class="analysis-type">\n        <span tid="analyis-type-string" q-translation="{{\'cao.insight.analysis.\' + $ctrl.chart.getChartType()}}" />\n    </div>\n\n    \x3c!--- GENERIC FIELDS --\x3e\n    <div class="header" ng-if="!$ctrl.hasDimensions() && !$ctrl.hasMeasures()">\n        <span q-translation="cao.fieldPicker.tab.fields">\n    </div>\n    <div class="cao-edit-field qv-pp-sortable" qv-cao-field-drop-zone data-slot="{{match.slot}}" data-slot-role="{{match.slotRole}}"\n        ng-repeat="match in $ctrl.getFields()">\n        <div class="cao-edit-field-header" ng-class="{\'draggable\': $ctrl.fieldCount > 1}" qv-cao-field-draggable\n            data-slot="{{match.slot}}" data-slot-role="{{match.slotRole}}">\n            \x3c!-- Header title --\x3e\n            <button class="cao-edit-field-header-title lui-button" ng-click="$ctrl.showChangeField($event, match)" qva-outside-ignore-for="{{\'cao-changeField_\' + match.slot}}">\n                <span ng-if="match.field" ng-class="{\'cao-edit-field-span\' : $ctrl.caoTweakEnabled}">\n                    {{ match.field }}\n                </span>\n                <span ng-if="match.libIdLabel" ng-class="{\'cao-edit-field-span\' : $ctrl.caoTweakEnabled}">\n                    {{ match.libIdLabel }}\n\t\t\t\t</span>\n\t\t\t\t<div class="cao-field-caret-container" ng-if="$ctrl.insightLearning && $ctrl.caoTweakEnabled">\n\t\t\t\t\t<span class="lui-icon lui-button__icon cao-edit-expander-span" ng-class="{\'lui-icon--arrow-right\' : !match.expanded, \'lui-icon--arrow-down\': match.expanded}"></span>\n\t\t\t\t</div>\n            </button>\n            \x3c!-- Header icons --\x3e\n            <button class="lui-button cao-edit-expander" ng-if="!$ctrl.caoTweakEnabled" ng-show="$ctrl.insightLearning" ng-click="$ctrl.toggleMatchDetails( match )">\n                <span class="lui-icon lui-button__icon" ng-class="{\'lui-icon--arrow-right\' : !match.expanded, \'lui-icon--arrow-down\': match.expanded}"></span>\n            </button>\n            <i class="lui-icon lui-icon--draggable cao-edit-field-draggable cao-edit-sortable-handle" ng-if="$ctrl.getFieldCount() > 1"\n                q-title-translation="Common.Move"></i>\n        </div>\n\n        <qv-cao-field-details ng-if="$ctrl.insightLearning && !$ctrl.caoTweakEnabled" class="cao-edit-field-details" data-match="match"\n            data-apply-callback="$ctrl.applyLearning" field-id="details_field_{{$index}}" chart="$ctrl.chart" ng-show="match.expanded" />\n    </div>\n\n\n    \x3c!--- DIMENSIONS--\x3e\n    <div class="header" ng-if="$ctrl.hasDimensions()">\n        <span q-translation="cao.fieldPicker.tab.dimensions">\n    </div>\n    <div class="cao-edit-field qv-pp-sortable" qv-cao-field-drop-zone data-slot="{{match.slot}}" data-slot-role="{{match.slotRole}}"\n        ng-repeat="match in $ctrl.getDimensions()">\n        <div class="cao-edit-field-header" ng-class="{\'draggable\': $ctrl.dimensionCount > 1}" qv-cao-field-draggable\n            data-slot="{{match.slot}}" data-slot-role="{{match.slotRole}}">\n            \x3c!-- Header title --\x3e\n            <button class="cao-edit-field-header-title lui-button" ng-click="$ctrl.showChangeField($event, match, \'dimension\')" qva-outside-ignore-for="{{\'cao-changeField_\' + match.slot}}">\n                <span ng-if="match.field" ng-class="{\'cao-edit-field-span\' : $ctrl.caoTweakEnabled}">\n                    {{ match.field }}\n                </span>\n                <span ng-if="match.libIdLabel" ng-class="{\'cao-edit-field-span\' : $ctrl.caoTweakEnabled}">\n                    {{ match.libIdLabel }}\n\t\t\t\t</span>\n\t\t\t\t<div class="cao-field-caret-container" ng-if="$ctrl.insightLearning && $ctrl.caoTweakEnabled">\n\t\t\t\t\t<span class="lui-icon lui-button__icon cao-edit-expander-span" ng-class="{\'lui-icon--arrow-right\' : !match.expanded, \'lui-icon--arrow-down\': match.expanded}"></span>\n\t\t\t\t</div>\n            </button>\n            \x3c!-- Header icons --\x3e\n            <button class="lui-button cao-edit-expander" ng-if="!$ctrl.caoTweakEnabled" ng-show="$ctrl.insightLearning" ng-click="$ctrl.toggleMatchDetails( match )">\n                <span class="lui-icon lui-button__icon" ng-class="{\'lui-icon--arrow-right\' : !match.expanded, \'lui-icon--arrow-down\': match.expanded}"></span>\n            </button>\n            <i class="lui-icon lui-icon--draggable cao-edit-field-draggable cao-edit-sortable-handle" ng-if="$ctrl.getDimensionCount() > 1"\n                q-title-translation="Common.Move"></i>\n        </div>\n\n        <qv-cao-field-details ng-if="$ctrl.insightLearning && !$ctrl.caoTweakEnabled" class="cao-edit-field-details" data-match="match"\n            data-apply-callback="$ctrl.applyLearning" field-id="details_dimension_{{$index}}" chart="$ctrl.chart"\n            ng-show="match.expanded" />\n    </div>\n\n    \x3c!--- MEASURES --\x3e\n    <div class="header cao-msrs-header" ng-if="$ctrl.hasMeasures()">\n        <span q-translation="cao.fieldPicker.tab.measures">\n    </div>\n    <div class="cao-edit-field qv-pp-sortable" qv-cao-field-drop-zone data-slot="{{match.slot}}" data-slot-role="{{match.slotRole}}"\n        ng-repeat="match in $ctrl.chart.getMatches()" ng-if="match.slotRole === \'measure\'">\n        <div class="cao-edit-field-header" ng-class="{\'draggable\': $ctrl.measureCount > 1}" qv-cao-field-draggable\n            data-slot="{{match.slot}}" data-slot-role="{{match.slotRole}}">\n            \x3c!-- Change aggregation dropdown --\x3e\n            <button ng-if="match.aggr" class="lui-button cao-edit-field-header-aggregation" ng-click="$ctrl.showChangeAggr($event, match)"\n                ng-disabled="!$ctrl.canChangeAggregation( match )" qva-outside-ignore-for="{{\'cao-changeAggregation_\' + match.slot}}" >\n                {{ match.aggr.charAt(0).toUpperCase() + match.aggr.substring(1) }}\n            </button>\n            \x3c!-- Header content --\x3e\n\n            \x3c!-- Header title --\x3e\n            <button class="cao-edit-field-header-title lui-button" ng-click="$ctrl.showChangeField($event, match, \'measure\')" qva-outside-ignore-for="{{\'cao-changeField_\' + match.slot}}">\n                <span ng-if="match.field" ng-class="{\'cao-edit-field-span\' : $ctrl.caoTweakEnabled}">\n                    {{ match.field }}\n                </span>\n                <span ng-if="match.libIdLabel" ng-class="{\'cao-edit-field-span\' : $ctrl.caoTweakEnabled}">\n                    {{ match.libIdLabel }}\n\t\t\t\t</span>\n\t\t\t\t<div class="cao-field-caret-container" ng-if="$ctrl.insightLearning && $ctrl.caoTweakEnabled">\n\t\t\t\t\t<span class="lui-icon lui-button__icon cao-edit-expander-span" ng-class="{\'lui-icon--arrow-right\' : !match.expanded, \'lui-icon--arrow-down\': match.expanded}"></span>\n\t\t\t\t</div>\n            </button>\n            \x3c!-- Header icons --\x3e\n            <button class="lui-button cao-edit-expander" ng-if="!$ctrl.caoTweakEnabled" ng-show="$ctrl.insightLearning" ng-click="$ctrl.toggleMatchDetails( match )">\n                <span class="lui-icon lui-button__icon" ng-class="{\'lui-icon--arrow-right\' : !match.expanded, \'lui-icon--arrow-down\': match.expanded}"></span>\n            </button>\n            <i class="lui-icon lui-icon--draggable cao-edit-field-draggable cao-edit-sortable-handle" ng-if="$ctrl.getMeasureCount() > 1"\n                q-title-translation="Common.Move"></i>\n\n        </div>\n        <qv-cao-field-details ng-if="$ctrl.insightLearning && !$ctrl.caoTweakEnabled" class="cao-edit-field-details" data-match="match"\n            data-apply-callback="$ctrl.applyLearning" field-id="details_measure_{{$index}}" chart="$ctrl.chart" ng-show="match.expanded" />\n    </div>\n</div>'},922:function(t,e){t.exports='<lui-popover class="cao-change-aggr-popover cao-popover">\n    <div class="lui-popover__body lui-nopad popover-body">\n            <qv-action-list items="wrappedAggregations"></qv-action-list>\n    </div>\n</lui-popover>\n\n'},923:function(t,e){t.exports='<lui-popover class="cao-change-field-popover cao-popover">\n    <object-add-typeahead>\n        <lui-popover-header>\n            <div class="lui-input-group">\n                <input class="lui-input lui-input-group__input" type="text" autocomplete="off"\n                    ng-model="search.term" qva-focus="autoFocus" ng-change="filterFields(search.term)" maxlength="255"\n                    object-add-typeahead-input />\n            </div>\n        </lui-popover-header>\n        <div class="lui-popover__body lui-nopad popover-body" object-add-typeahead-menu>\n\n            <ul class="lui-list">\n                <div ng-if="dimensions.length > 0" class="object-add-popover-list-header" q-translation="Common.Dimensions"></div>\n\n                <li class="lui-list__item lui-list__action" ng-repeat="d in dimensions" on-select="change(field, d)"\n                    object-add-typeahead-item="d">\n                    <span class="lui-list__text" qve-highlight text="{{ d.libIdLabel }}" query="highlight"></span>\n                </li>\n\n                <div ng-if="measures.length > 0" class="object-add-popover-list-header" q-translation="Common.Measures"></div>\n\n                <li class="lui-list__item lui-list__action" ng-repeat="m in measures" on-select="change(field, m)"\n                    object-add-typeahead-item="m">\n                    <span class="lui-list__text" qve-highlight text="{{ m.libIdLabel }}" query="highlight"></span>\n                </li>\n\n                <div ng-if="fields.length > 0" class="object-add-popover-list-header" q-translation="Common.Fields"></div>\n\n                <li class="lui-list__item lui-list__action" ng-repeat="f in fields" on-select="change(field, f)"\n                    object-add-typeahead-item="f">\n                    <span class="lui-list__text" qve-highlight text="{{ f.displayNameTokens[0].text }}" query="highlight"></span>\n                </li>\n            </ul>\n            <div class="no-hits" ng-if="(fields.length === 0) && (measures.length === 0) && (dimensions.length == 0)">\n                <span><i q-translation="Toolbox.Search.Nohits" /></span>\n            </div>\n        </div>\n\n    </object-add-typeahead>\n</lui-popover>'},924:function(t,e){t.exports='<lui-popover class="cao-popover cao-analysis-info-popover">\n    <lui-popover-body>\n        <div class="popover-body cao-analysis-info-popover-body">\n            <div class="analysis-header">\n                {{analysisTitle}}\n            </div>\n            {{analysisDescription}}\n        </div>\n    </lui-popover-body>\n</lui-popover>\n'},925:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(196)],a=function(t,e,n){t.directive("qvCaoFieldDropZone",function(){return{restrict:"A",replace:true,scope:{},link:function t(i,a){function s(t,e){return e===t}a.droppable({accept:function t(e){var n=e[0].getAttribute("data-slot");var i=e[0].getAttribute("data-slot-role");var r=a[0].getAttribute("data-slot");var o=a[0].getAttribute("data-slot-role");if(n===r)return false;if(s(o,i)&&s(i,o))return true;return false},drop:function t(i,s){var r=s.draggable[0].getAttribute("data-slot");var o=a[0].getAttribute("data-slot");e.publish(n.PUBSUB_TOPIC,{slotA:r,slotB:o})}})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},926:function(t,e,n){"use strict";var i,a;!(i=[n(48)],a=function(t){t.directive("qvCaoFieldDraggable",function(){return{restrict:"A",replace:true,link:function t(e,n){n.draggable({revert:"invalid",axis:"y",handle:".cao-edit-sortable-handle",helper:"clone",revertDuration:250,zIndex:1e3})}}})}.apply(e,i),void 0!==a&&(t.exports=a))},927:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(928),n(929),n(373)],a=function(t,e,n){t.nativeComponent("qvCaoFieldDetails",{bindings:{match:"<",chart:"<",applyCallback:"<",fieldId:"@"},controller:["qvCaoLearningConfidenceService","luiPopover",function(t,e){var i;var a;this.$onInit=function(){this.showExpression=!this.match.libId;this.searchReport=this.chart.getSearchReport();this.matchDetails=this.chart.getMatchDetails()};this.getDisplayExpressionForMatch=function(t){return t.libId?t.libIdLabel:t.aggr?t.aggr+"("+t.field+")":t.field};this.showFieldInfo=function(s){if(i&&a){a.close();return}var r={reasons:t.getReasonForSelectingField(this.match,this.searchReport,this.matchDetails,true)};var o={template:n,input:r,controller:[function(){}],dock:"bottom",alignTo:s.currentTarget,closeOnResize:true,outsideIgnore:this.fieldId+"_why"};i=true;a=e.show(o);a.closed.then(function(){i=false})}}],template:e})}.apply(e,i),void 0!==a&&(t.exports=a))},928:function(t,e){t.exports='<div class="cao-field-details-recommended" ng-hide="$ctrl.match.isDirty">\n    <span q-translation="cao.insight.editor.details.recommendation.why"/>\n    <a tid="{{$ctrl.fieldId}}_why" id="{{$ctrl.fieldId}}_why" ng-click="$ctrl.showFieldInfo($event)" qva-outside-ignore-for="{{$ctrl.fieldId}}_why">\n        <span class="lui-icon lui-icon--help"/>\n    </a>\n</div>\n<div class="cao-field-details-learn">\n    <cao-help-learn data-match="$ctrl.match" data-apply-callback="$ctrl.applyCallback" button-id="{{$ctrl.fieldId}}" chart="$ctrl.chart"></cao-help-learn>\n</div>\n'},929:function(t,e){t.exports='<lui-popover x-arrow="arrow">\n        <div class="cao-confidence-body">\n            <div class="cao-confidence-body-heading" q-translation="cao.confidence.heading"></div>\n            <ul class="cao-confidence-reason-list">\n                <li class="cao-confidence-reason-item" ng-repeat="reason in input.reasons.learned">\n                    <span class="lui-icon  lui-icon--tick lui-text-success" aria-hidden="true" ng-hide="reason.priority === 0"></span>\n                    <div class="cao-confidence-reason-item__text" ng-bind-html="reason.text"></div>\n                </li>\n                <li class="cao-confidence-reason-item" ng-repeat="reason in input.reasons.search">\n                        <span class="lui-icon  lui-icon--tick lui-text-success" aria-hidden="true" ng-hide="reason.priority === 0"></span>\n                        <div class="cao-confidence-reason-item__text" ng-bind-html="reason.text"></div>\n                    </li>\n            </ul>\n        </div>\n</lui-popover>'},930:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91),n(103),n(196),n(931),n(168)],a=function(t,e,n,i,a,s){t.nativeComponent("caoHelpLearn",{bindings:{applyCallback:"<",match:"<",chart:"<",buttonId:"@"},controller:["$element","luiPopover",function(t,r){var o=this;var l;var c=false;var u=false;o.learningOptions=[];var d=new s;var p=void 0;var h=void 0;var f=void 0;o.$onChange=function(){p=void 0;h=void 0;f=void 0};o.$doCheck=function(){if(o.match.field!==p||o.match.libId!==h||o.match.aggr!==f){p=o.match.field;h=o.match.libId;f=o.match.aggr;if(!u){this.searchReport=this.chart.getSearchReport();this.chartType=this.chart.getChartType();u=true}d.getDislikedItems().then(function(t){t&&t.length>0&&(o.dislikedFields=t[0].nodes);o.updateLearningOptions()})}};var g=function t(e){if(o.dislikedFields&&o.dislikedFields.length>0)return o.dislikedFields.filter(function(t){return t.field?t.field.name===e:t.libItem.libId===e})[0]};o.updateLearningOptions=function(){o.learningOptions=[];if(!o.match)return;var t=g(o.match.field||o.match.libId);if(t){o.learningOptions.push({text:e.get("cao.helpuslearn.useagain"),icon:"plus",action:function e(){d.undislikeItem(t.id).then(function(){l.close();o.applyCallback()});n.trackEvent(n.customEvents.INSIGHTS_PROPOSE_FIELD_AGAIN_CLICKED)}});return}o.match.libId||o.match.isDirty||(o.match.slotRole===i.MEASURE?o.learningOptions.push({text:e.get("cao.helpuslearn.not_a_measure"),icon:"unapprove",action:function t(){d.defineDimension({expr:"["+o.match.field+"]"}).then(function(){l.close();o.applyCallback()});n.trackEvent(n.customEvents.INSIGHTS_NOT_A_MEASURE_CLICKED)}}):o.match.slotRole===i.DIMENSION&&o.learningOptions.push({text:e.get("cao.helpuslearn.not_a_dimension"),icon:"unapprove",action:function t(){d.defineMeasure({expr:"unknown(["+o.match.field+"])"}).then(function(){l.close();o.applyCallback()});n.trackEvent(n.customEvents.INSIGHTS_NOT_A_DIMENSION_CLICKED)}}));o.learningOptions.push({text:e.get("cao.helpuslearn.neveruse"),icon:"minus",action:function t(){if(o.match.field){n.trackEvent(n.customEvents.INSIGHTS_NEVER_PROPOSE_FIELD_CLICKED);d.dislikeField({name:o.match.field}).then(function(){l.close();o.applyCallback()})}else if(o.match.libId){n.trackEvent(n.customEvents.INSIGHTS_NEVER_PROPOSE_LIB_CLICKED);d.dislikeLibItem({name:o.match.libId}).then(function(){l.close();o.applyCallback()})}}});o.isDisabled=0===o.learningOptions.length||o.chart.invalidFromLearning};this.displayHelpUsLearn=function(){if(c&&l){l.close();return}var e={template:a,input:o,controller:[function(){}],dock:"bottom",alignTo:t[0],closeOnResize:true,outsideIgnore:o.buttonId};c=true;l=r.show(e);n.trackEvent(n.customEvents.INSIGHTS_HELP_US_LEARN_CLICKED,{chart:o.chart.getAnalysisPrecedentId()});l.closed.then(function(){document.getElementById(o.buttonId).focus();c=false})}}],template:['<button class="lui-button" ng-click="$ctrl.displayHelpUsLearn()" ng-disabled="$ctrl.isDisabled"  tid="{{$ctrl.buttonId}}" id="{{$ctrl.buttonId}}" qva-outside-ignore-for="{{$ctrl.buttonId}}">','<span class="lui-button__icon  lui-icon  lui-icon--lightbulb" ></span><span class="lui-button__text" q-translation="cao.fieldPicker.helpuslearn.button"></span>',"</button>"].join("")})}.apply(e,i),void 0!==a&&(t.exports=a))},931:function(t,e){t.exports='<lui-popover x-arrow="arrow">\n    <div class="cao-help-learn-body">\n        <qv-action-list items="input.learningOptions"></qv-action-list>\n    </div>\n</lui-popover>'},932:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(933),n(167)],a=function(t,e,n){t.nativeComponent("qvActionList",{bindings:{items:"<"},controller:["$element","$timeout",function(t,e){var i=this;i.selectedIndex=-1;var a;this.$postLink=function(){a=t.find(".lui-list");a.on("keydown",r)};this.$onDestroy=function(){a.off("keydown",r)};this.selectItem=function(t){t.action()};function s(t){e(function(){i.selectedIndex=t})}function r(t){if(t.keyCode===n.ARROW_DOWN){t.preventDefault();i.selectedIndex<i.items.length-1?s(i.selectedIndex+1):s(0)}else if(t.keyCode===n.ARROW_UP){t.preventDefault();0===i.selectedIndex?s(i.items.length-1):s(i.selectedIndex-1)}else if(t.keyCode===n.ENTER||t.keyCode===n.TAB){t.preventDefault();e(function(){i.selectItem(i.items[i.selectedIndex])},0)}}}],template:e})}.apply(e,i),void 0!==a&&(t.exports=a))},933:function(t,e){t.exports='\n    <ul class="lui-list" qva-focus="true" tabindex="0">\n        <li ng-repeat="item in $ctrl.items" class="lui-list__item lui-list__action" ng-class="{ \'lui-disabled\': item.disabled, \'lui-active\': $index === $ctrl.selectedIndex }"\n            ng-click="item.disabled || $ctrl.selectItem(item)">\n            <span class="lui-list__aside  lui-icon lui-icon--{{item.icon}}" ng-if="item.icon"></span>\n            <span class="lui-list__text" tid="{{item.tid}}" q-translation="{{item.text}}"></span>\n        </li>\n    </ul>'},934:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91),n(103),n(935),n(373)],a=function(t,e,n,i){t.nativeComponent("caoConfidence",{bindings:{buttonId:"@",chart:"<",hideText:"<",closeNotification:"&",opened:"&",closed:"&"},controller:["luiPopover","qvCaoLearningConfidenceService",function(t,a){var s=this;var r;var o=false;s.$onInit=function(){l();s.closeNotification({handler:function t(){if(r){r.close();o=false}}})};s.$doCheck=function(){if(s.chart.recalculateConfidence){s.chart.recalculateConfidence=false;l()}};function l(){s.confidenceReasons={learned:[],search:[]};s.confidence=a.determineConfidence(s.chart);s.confidenceTitle=e.get("cao.confidence.title_"+s.confidence);if("empty"===s.confidence)s.emptyConfidence=true;else{var t=s.chart.getMatchDetails();s.chart.getMatches().forEach(function(e){var n=a.getReasonForSelectingField(e,s.chart.getSearchReport(),t,false);s.confidenceReasons.learned=s.confidenceReasons.learned.concat(n.learned);s.confidenceReasons.search=s.confidenceReasons.search.concat(n.search)})}}s.displayConfidenceInfo=function(){var e=this;if(e.emptyConfidence)return;if(o&&r){r.close();return}var a={template:i,input:this,controller:[function(){}],dock:"bottom",alignTo:document.getElementById(e.buttonId),closeOnResize:true,outsideIgnore:this.buttonId};o=true;r=t.show(a);r.opened.then(function(){if(e.opened){n.trackEvent(n.customEvents.INSIGHTS_CONFIDENCE_INDICATOR_CLICKED,{chart:e.chart.getAnalysisPrecedentId()});e.opened()}});r.closed.then(function(){e.closed&&e.closed();o=false})}}],template:['<span class="cao-confidence-container" q-title-translation="cao.confidence.title" aria-label="{{$ctrl.confidenceTitle}}"  >','<span class="cao-confidence-{{$ctrl.confidence}}-icon" ng-class="{\'no-reasons\': $ctrl.emptyConfidence}" ng-click="$ctrl.displayConfidenceInfo()" tid="{{$ctrl.buttonId}}" id="{{$ctrl.buttonId}}" qva-outside-ignore-for="{{$ctrl.buttonId}}"></span>',"</span>"].join("")})}.apply(e,i),void 0!==a&&(t.exports=a))},935:function(t,e){t.exports='<lui-popover x-arrow="arrow">\n    <div class="cao-confidence-body">\n        \x3c!-- <div class="cao-confidence-body-heading" q-translation="cao.confidence.heading"></div> --\x3e\n        <div class="cao-confidence-empty" ng-show="input.emptyConfidence" q-translation="cao.confidence.emptyconfidence"></div>\n\n        <div class="cao-confidence-body-heading-small" q-translation="cao.confidence.learnedbycognitive.title" ng-show="input.confidenceReasons.learned.length > 0"></div>\n        <ul class="cao-confidence-reason-list" ng-hide="input.emptyConfidence">\n            <li class="cao-confidence-reason-item" ng-repeat="reason in input.confidenceReasons.learned">\n                <span class="lui-icon  lui-icon--tick lui-text-success" aria-hidden="true"></span>\n                <div class="cao-confidence-reason-item__text" ng-bind-html="reason.field"></div>\n            </li>\n        </ul>\n\n        <div class="cao-confidence-body-heading-small" q-translation="cao.confidence.relevanttoserach.title" ng-show="input.confidenceReasons.search.length > 0"></div>\n        <ul class="cao-confidence-reason-list" ng-hide="input.emptyConfidence">\n            <li class="cao-confidence-reason-item" ng-repeat="reason in input.confidenceReasons.search">\n                <span class="lui-icon  lui-icon--tick lui-text-success" aria-hidden="true"></span>\n                <div class="cao-confidence-reason-item__text" ng-bind-html="reason.field"></div>\n            </li>\n        </ul>\n\n    </div>\n</lui-popover>'},936:function(t,e){t.exports='<div class="cao-refresh-indicator-container">\n    <div class="cao-refresh-indicator-content">\n        <div q-translation="cao.insight.refresh.indicator.body" />\n        <div class="cao-refresh-action">\n            <a class="cao-refresh" ng-click="$ctrl.refresh()" q-translation="cao.insight.refresh.indicator.action" />\n        </div>\n    </div>\n</div>\n'},937:function(t,e,n){"use strict";var i,a;!(i=[n(10),n(11),n(48),n(54),n(938),n(49),n(111)],a=function(t,e,n,i,a,s){var r={transclude:true,template:a,bindings:{chart:"=",app:"<",interactive:"<",scrollContainer:"<",getChartMenuItems:"&",setBlurHandler:"&",onChartLoaded:"&",contextMenuStatus:"=",index:"<"},controller:["$element","$document","$window","$timeout","$scope","qvCaoRenderService",function(a,r,o,l,c,u){var d=this;d.isLoadingCardImageFlag=s.getFlag("LOADING_CARD_IMAGES");d.caoTweakEnabled=s.getFlag("CAO_TWEAK");function p(){return d.interactive?-99:d.chart.getComplexity()?d.chart.getComplexity():d.index}this.$onInit=function(){this.hasBlurHandler=false;this.isDestroyed=false;this.scrollHander=i.debounce(this.renderChartIfInView,300);this.initializeState()};this.$doCheck=function(){if((this.interactive||this.caoTweakEnabled)&&this.chart.shouldRedraw){delete this.chart.shouldRedraw;d.chart.refreshChartType();d.chart.setState("LOADING");u.enqueueForRender(d.loadChart,p(d.chart.chart.visualization))}if(!this.hasBlurHandler&&this.chart.getObject().setOnBlurHandler){this.setBlurHandler();this.hasBlurHandler=true}};this.$postLink=function(){l(function(){if("READY"===d.chart.getState()&&d.isInView()&&!d.isDestroyed){d.chart.setState("LOADING");u.enqueueForRender(d.loadChart,p(d.chart.chart.visualization))}})};this.$onDestroy=function(){this.isDestroyed=true;u.dequeueRender(d.loadChart);t.element(this.scrollContainer).unbind("scroll",d.scrollHander);t.element(o).unbind("resize",d.renderChartIfInView);this.chart.destroyChart()};this.renderChartIfInView=function(){if(!d.isDestroyed&&d.isInView()&&"READY"===d.chart.getState()){d.chart.setState("LOADING");u.enqueueForRender(d.loadChart,p(d.chart.chart.visualization))}};this.isInView=function(){var t=a[0].getBoundingClientRect();var e=!o.innerHeight||r[0].documentElement.clientHeight;var n=t.top<=e;return n};this.loadManually=function(t){t.stopPropagation();d.chart.setState("LOADING");d.chart.allowLongLoad=true;u.enqueueForRender(d.loadChart,p(d.chart.chart.visualization))};this.loadChart=function(){return d.chart.loadChart(d.onChartLoaded)};this.openContextMenu=function(t,i,a,s){if(!this.contextMenuStatus.open&&this.chart.rendered){var r=n.getService("qvContextMenu").menu();r.onOpen=function(){e(".qv-contextmenu lui-popover").css("max-height",400)};d.getChartMenuItems({menu:r});var o=n.getService("qvContextMenu");o.showInline(r,{position:{x:i.pageX,y:i.pageY},onCloseFn:a},s||i.currentTarget)}};c.$on("cao.openContextMenu",function(t,e){d.openContextMenu(null,e.event,e.closeFn,e.element)});this.initializeState=function(){if(this.scrollContainer){t.element(this.scrollContainer).bind("scroll",this.scrollHander);t.element(o).bind("resize",d.renderChartIfInView)}}}]};n.nativeComponent("qvCaoInsightChart",r)}.apply(e,i),void 0!==a&&(t.exports=a))},938:function(t,e){t.exports='<div class="result-item-graph-container" ng-if="!$ctrl.interactive" qva-context-menu="$ctrl.openContextMenu( item, $event, $ctrl.onCloseContextMenu)"\n    qva-radial-context-menu="$ctrl.openContextMenu( item, $event, $ctrl.onCloseContextMenu)">\n    <qv-object ng-if="$ctrl.chart.getState() === \'LOADED\'" model="$ctrl.chart.chart.model" options="$ctrl.chart.options"\n        object="$ctrl.chart.object" />\n</div>\n\n<div class="result-item-graph-container" ng-if="$ctrl.interactive" qva-context-menu="$ctrl.openContextMenu( item, $event, $ctrl.onCloseContextMenu)"\n    qva-radial-context-menu="$ctrl.openContextMenu( item, $event, $ctrl.onCloseContextMenu)">\n    <qv-object ng-if="$ctrl.chart.getState() === \'LOADED\'" model="$ctrl.chart.chart.model" options="$ctrl.chart.zoomedOptions"\n        object="$ctrl.chart.zoomedObject" />\n</div>\n\n<div class="spinner-container" ng-if="($ctrl.chart.getState() === \'LOADING\' && !$ctrl.isLoadingCardImageFlag)">\n    <qv-spinner show="!$ctrl.chartLoaded && !$ctrl.isLoadingCardImageFlag" show-delay="100" center-in-parent="true"></qv-spinner>\n</div>\n<div class="image-container" ng-if="$ctrl.chart.getState() === \'LOADING\' && $ctrl.isLoadingCardImageFlag">\n    <img ng-src="{{$ctrl.chart.chartTypeImageUrl}}" class="loader-image" />\n</div>\n\n<div class="cao-manual-loader" ng-click="$event.stopPropagation()" ng-if="$ctrl.chart.getState() === \'MANUAL_LOAD\'">\n    <ul>\n        <li class="cao-loader-text" q-translation="cao.card.complex">\n        </li>\n        <li>\n            <lui-button ng-click="$ctrl.loadManually($event)" q-translation="cao.card.complex.load"></lui-button>\n        </li>\n    </ul>\n</div>'},939:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(95),n(940),n(105),n(49),n(159),n(91),n(372),n(93),n(103),n(275),n(212)],a=function(t,e,n,i,a,s,r,o,l,c,u){var d={template:i,bindings:{query:"<",disabled:"<",matchingFields:"<",matchingFieldIndex:"<",fieldToRemove:"<",fieldToAdd:"<",updateFieldPicker:"<",isLimited:"<",direction:"<",nluQueryInfoButtonVisible:"<",nluQueryInfoVisible:"<",toggleNluQueryInfo:"<"},controller:["$timeout","qvCaoSearchService","qvCaoService",function(e,i,d){var p=this;this.selectedSuggestion=null;this.nluEnabled=s.getFlag("NLU_INSIGHTS");this.nluQueries=[];this.NLU_QUERIES_LIMIT=10;this.waitingForAppId=false;this.$onInit=function(){this.initializeState()};this.searchInputPlaceHolder=this.nluEnabled?o.get("cao.search.input.nlu.placeHolder")+r.lrm:o.get("cao.search.input.placeHolder")+r.lrm;this.clearSerchButtonIconScreenReader=o.get("clear.serch.button.icon.screen.reader");this.caoSearchInputSearchScreenReader=o.get("cao.search.input.search.reader");this.caoSearchInputScreenReader=o.get("cao.search.input.screen.reader");this.$onChanges=function(t){this.syncFieldPicker=s.getFlag("CAO_FIELD_PICKER_SYNC");this.syncFieldPicker?t.fieldToAdd&&t.fieldToAdd.currentValue?this.toggleFieldPickerField(this.fieldToAdd):t.fieldToRemove&&t.fieldToRemove.currentValue&&this.toggleFieldPickerField(this.fieldToRemove):t.fieldToAdd&&t.fieldToAdd.currentValue&&this.fieldToAdd&&this.addFieldToQuery(this.fieldToAdd,true)};this.$onDestroy=function(){t("#qv-cao-search-container").off("click",p.caoSearchContainerOnclickHandler);t("#cao-search-input").off("click",p.caoSearchInputOnClickHandler);t(window).off("resize",p.searchSuggestionBoxOnResizeHandler);n.unsubscribe("cao/insights/clear");p.nluEnabled&&n.unsubscribe("cao/nlu/new_queries")};this.caoSearchContainerOnclickHandler=function(t){t.stopPropagation()};this.caoSearchInputOnClickHandler=function(t){t.stopPropagation();p.updateCursorPositionState(t)};this.searchSuggestionBoxOnResizeHandler=function(){p.isMatchingFieldPopupVisible&&e(function(){p.updateMatchingFields();p.showMatchingFieldPopup()},300)};this.toggleCao=function(){d.toggleCao()};this.initializeState=function(){this.queryTokens=[];this.cursorPosition=0;t("#qv-cao-search-container").click(p.caoSearchContainerOnclickHandler);t("#cao-search-input").click(p.caoSearchInputOnClickHandler);t(window).on("resize",p.searchSuggestionBoxOnResizeHandler);if(this.nluEnabled){n.subscribe("cao/nlu/new_queries",p.newNluQuery);c.getApp().then(function(t){p.appId=t.id;p.getNluQueries().then(function(){p.waitingForAppId&&e(function(){p.showSearchHistoryPopup()})})})}};this.handleSearchInputBlur=function(){p.matchingField=null;p.hideMatchingFields();p.hideSearchHistoryPopup()};this.updateCursorPositionState=function(t){p.updateCurrentCursorPositionState(t);if(p.query){var n=i.getCurrentToken(p.query,p.cursorPosition).token;p.cursorPosition<p.query.length+1&&n&&n.word?p.showFields(t):p.hideMatchingFields()}else p.nluEnabled&&(p.nluQueries.length||p.appId?p.nluQueries.length&&e(function(){p.positionSearchResultPopup();p.showSearchHistoryPopup()}):p.waitingForAppId=true)};this.showMatchingFieldPopup=function(){this.isMatchingFieldPopupVisible||(this.isMatchingFieldPopupVisible=true)};this.showSearchHistoryPopup=function(){this.isSearchHistoryPopupVisible||(this.isSearchHistoryPopupVisible=true)};this.hideSearchHistoryPopup=function(){this.isSearchHistoryPopupVisible=false};this.setMatchingFieldIndex=function(t){this.matchingFieldIndex=t};this.toggleFieldPickerField=function(t){if(t&&t.selected){this.removeFieldFromQuery(t);this.syncFieldPicker&&i.selectField(t,false)}else if(t&&!t.selected){this.addFieldToQuery(t);this.fieldToAdd=this.syncFieldPicker?this.fieldToAdd:"";this.syncFieldPicker&&i.selectField(t,true)}this.query&&0!==this.query.trim().length?this.updateInsights(this.query):this.clearQuery()};this.updateInsights=function(t){if(t){i.updateInsights(t.trim());this.trimSpacesOnQuery();this.hideMatchingFields();u.trackEvent(u.customEvents.INSIGHTS_TYPED_QUERY,{query:t})}};this.defaultCursorPosition=function(){return this.query?this.query.length+1:0};this.trimSpacesOnQuery=function(){this.query=this.query.trim();this.query+=" "};this.addFieldToQuery=function(e,n,a){a&&a.preventDefault();var s=t("#cao-search-input")[0];var r=this.cursorPosition?this.cursorPosition:this.defaultCursorPosition();var o=i.addFieldToQuery(e,this.query,r,s.selectionStart,s.selectionEnd);this.cursorPosition=o.cursorPosition;this.query=o.query;this.updateMatchingFields();this.positionCursorAtIndex(this.cursorPosition);this.syncFieldsInQueryWithFieldPicker();this.trimSpacesOnQuery();n&&this.updateInsights(this.query)};this.usePreviousQuery=function(t){p.query=t};this.keydown=function(t,e){switch(t.which){case 38:case 40:e&&(this.selectedSuggestion=e.caoFieldId);break;default:this.selectedSuggestion=null}};this.removeFieldFromQuery=function(t){var e=i.getSelectedFields(this.query);var n=this.cursorPosition?this.cursorPosition:this.defaultCursorPosition();this.query=i.removeFieldFromQuery(t,this.query,e);this.positionCursorAtIndex(n);this.syncFieldsInQueryWithFieldPicker()};this.hideMatchingFields=function(){e(function(){p.isMatchingFieldPopupVisible=false;p.navigatingThroughMatchingFields=false;p.matchingFields=[]})};this.clearQuery=function(){p.query="";p.hideMatchingFields();i.clearSelectedFields();p.syncFieldsInQueryWithFieldPicker();i.showIntro(true)};this.showFields=function(t){t&&this.updateCurrentCursorPositionState(t);this.matchingFields=i.getFields();this.clearHighlightedFields();this.updateMatchingFields();this.showMatchingFieldPopup()};this.positionCursorAtIndex=function(n){this.query&&this.query.length>0&&e(function(){var e=document.getElementById("cao-search-input");var i=n;t("#cao-search-input").focus();e.setSelectionRange(i,i)})};this.updateCurrentCursorPositionState=function(t){this.cursorPosition=t.target.selectionStart};this.scrollFieldIntoView=function(t){if(t&&t.caoFieldId){var e=document.getElementById(t.caoFieldId);e&&e.scrollIntoView&&e.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}};this.updateMatchingFields=function(){e(function(){var t=p.cursorPosition?p.cursorPosition:0;var e=i.getCurrentToken(p.query,t);p.currentToken=e;p.setMatchingFieldIndex(-1);if(null!==e.index&&e.token.word){if(e.token){p.matchingFields=i.getMatchingFields(e.token.word,p.isLimited);p.highlightField(p.matchingFieldIndex)}}else p.hideMatchingFields();p.positionSearchResultPopup()})};this.getNluQueries=function(){return l.getQueries(p.NLU_QUERIES_LIMIT,p.appId).then(function(t){p.nluQueries=t})};this.newNluQuery=function(t){p.nluQueries.push(t)};this.positionSearchResultPopup=function(){var e;if(this.query&&this.query.length>0){var n=this.cursorPosition?this.cursorPosition:0;var a=t("#cao-search-input");var s=t("#qv-cao-search-input-container");if(a.position()&&a.position().left){e=a.position().left;p.nluEnabled&&s&&s.position()&&(e+=s.position().left);var r=i.getCurrentToken(this.query,n);r.token&&(n=r.token.indexStart);e+=i.searchResultPositionRelativeToQuery(this.query,n)}}this.searchResultContainerLeft=e+"px"};this.highlightField=function(t){this.clearHighlightedFields();this.matchingFields.length>0&&t>=0&&(this.matchingFields[t].highlight=true)};this.clearHighlightedFields=function(){this.matchingFields=this.matchingFields.map(function(t){t.highlight=false;return t})};this.syncFieldsInQueryWithFieldPicker=function(){if(this.syncFieldPicker){i.syncFieldsInQueryWithFieldPicker(this.query);this.updateFieldPicker()}};this.getMatchingFields=function(t){this.triggerKeyboardBehaviours(t);if(this.query&&this.query.length>0){p.hideSearchHistoryPopup();var e=this.query.replace(/\s{2,}/g," ");var n="keyup"===t.type&&t.which===a.KeyCodes.Enter&&!this.navigatingThroughMatchingFields;if(!this.navigatingThroughMatchingFields){this.updateMatchingFields();t.which!==a.KeyCodes.Enter&&this.showMatchingFieldPopup()}t.which!==a.KeyCodes.Enter&&t.which!==a.KeyCodes.Tab||(this.isMatchingFieldPopupVisible=false);n&&this.updateInsights(e)}};this.navigateMatchingFields=function(t){this.triggerKeyboardBehaviours(t);this.navigatingThroughMatchingFields=t&&t.which===a.KeyCodes.Down||t.which===a.KeyCodes.Up;var e=t&&"keydown"===t.type&&t.keyCode;var n=e&&this.matchingFields&&this.matchingFields.length>0;if(n){this.matchingField=i.matchingField(t.keyCode,this.matchingFieldIndex,this.matchingFields);this.setMatchingFieldIndex(this.matchingFields.indexOf(this.matchingField));this.scrollFieldIntoView(this.matchingField);if(this.matchingFieldIndex>=0){var s=e&&t.keyCode===a.KeyCodes.Tab&&this.matchingField;var r=e&&t.keyCode===a.KeyCodes.Enter&&this.matchingField;if(s){this.addFieldToQuery(this.matchingField);this.hideMatchingFields()}if(r){this.addFieldToQuery(this.matchingField);this.updateInsights(this.query)}this.navigatingThroughMatchingFields&&this.highlightField(this.matchingFieldIndex)}switch(t.which){case 38:case 40:this.matchingField&&(this.selectedSuggestion=this.matchingField.caoFieldId);break}}t&&t.which===a.KeyCodes.Enter&&!this.query&&this.clearQuery()};n.subscribe("cao/insights/clear",p.clearQuery);this.triggerKeyboardBehaviours=function(t){this.updateCurrentCursorPositionState(t);this.syncFieldsInQueryWithFieldPicker();t.which!==a.KeyCodes.Down&&t.which!==a.KeyCodes.Up&&t.which!==a.KeyCodes.Enter||t.preventDefault();e(function(){t.which===a.KeyCodes.Delete&&p.updateMatchingFields();if(t.which===a.KeyCodes.Esc){p.matchingField=null;p.hideMatchingFields()}})}}]};e.nativeComponent("qvCaoSearch",d)}.apply(e,i),void 0!==a&&(t.exports=a))},940:function(t,e){t.exports='<div id="qv-cao-search-container" class="qv-cao-search-container">\n\t<div class="qv-cao-search-input" ng-class="{\'focus\': $ctrl.isInputFocused, \'qv-cao-search-input--nlu\': $ctrl.nluEnabled}" id="qv-cao-search-input-container">\n\t\t<div class="search-cao-field-area">\n\t\t\t<div class="lui-search search-field" qva-direction x-dir-setting="{{$ctrl.direction}}">\n\t\t\t\t<span class="lui-search__search-icon"></span>\n\t\t\t\t<input class="lui-search__input"\n\t\t\t\t\t   ng-model="$ctrl.query"\n\t\t\t\t\t   auto-focus="autoFocus"\n\t\t\t\t\t   aria-autocomplete="list"\n\t\t\t\t\t   autocomplete="off"\n\t\t\t\t\t   ng-disabled="$ctrl.disabled"\n\t\t\t\t\t   type="text"\n\t\t\t\t\t   is-focused="isInputFocused"\n\t\t\t\t\t   placeholder="{{$ctrl.searchInputPlaceHolder}}"\n\t\t\t\t\t   ng-keydown="$ctrl.navigateMatchingFields($event)"\n\t\t\t\t\t   ng-keyup="$ctrl.getMatchingFields($event)"\n\t\t\t\t\t   tid="caoSearch.searchField"\n\t\t\t\t\t   tabindex="0"\n             role="combobox"\n\t\t\t\t\t   aria-label="{{$ctrl.caoSearchInputSearchScreenReader}}"\n\t\t\t\t\t   aria-activedescendant="{{$ctrl.selectedSuggestion}}"\n\t\t\t\t\t   aria-owns="cao_search_suggestions cao_search_history"\n\t\t\t\t\t   id="cao-search-input"\n\t\t\t\t\t   ng-blur="$ctrl.handleSearchInputBlur()"\n        />\n\t\t\t\t<button aria-label="{{$ctrl.clearSerchButtonIconScreenReader}}" class="lui-icon  lui-icon--remove" tid="cao-search-clear-btn" ng-if="$ctrl.query" q-title-translation="cao.search.clear.tooltip" ng-click="$ctrl.clearQuery()"></button>\n\t\t\t</div>\n\t\t</div>\n\t\t<button class="qv-cao-search-info-button" ng-class="{ \'qv-cao-search-info-button--active\': $ctrl.nluQueryInfoVisible }" ng-if="$ctrl.nluEnabled && $ctrl.nluQueryInfoButtonVisible" ng-click="$ctrl.toggleNluQueryInfo()">\n\t\t\t<i class="lui-icon lui-icon--info"></i>\n\t\t</button>\n\t</div>\n\t<div id="cao_search_suggestions" class="qv-cao-search-suggestions" ng-if="$ctrl.isMatchingFieldPopupVisible"\n\t\t ng-style="{ \'left\': $ctrl.searchResultContainerLeft }">\n\t\t<ul class="lui-list">\n\t\t\t<li class="lui-list__item fields"\n\t\t\t\ttid="caoSearchSuggestionField"\n\t\t\t\tng-class="{\'highlight\': field.highlight}"\n\t\t\t\tng-repeat="field in $ctrl.matchingFields"\n\t\t\t\tng-mousedown="$ctrl.addFieldToQuery(field, true, $event)"\n\t\t\t\tid="{{field.caoFieldId}}"\n\t\t\t\taria-labelledby="{{field.caoFieldId+\'Name\' + \' \' + field.caoFieldId+\'Origin\'}}"\n\t\t\t\t>\n\t\t\t\t<span aria-hidden="true" class="lui-list__text" q-title-translation={{field.qName}} tid="caoSearchSuggestionFieldName" >\n\t\t\t\t\t<span aria-hidden="true" qve-highlight text="{{ field.qName }}" query="$ctrl.currentToken.token.word" ></span>\n\t\t\t\t</span>\n\t\t\t\t<span aria-hidden="true" ng-if="!field.masterItem" class="lui-list__aside field-name" q-title-translation={{field.tablesTooltip}}>{{field.tablesAssociated}}</span></span>\n\t\t\t\t<span aria-hidden="true" ng-if="field.masterItem" class="lui-list__aside field-name">{{field.masterItemTitle}}</span></span>\n\t\t\t\t<p id="{{field.caoFieldId+\'Name\'}}" class="sr-only" >{{ field.qName }}</p>\n\t\t\t\t<p id="{{field.caoFieldId+\'Origin\'}}" class="sr-only" ng-if="!field.masterItem" class="lui-list__aside field-name" q-title-translation={{field.tablesTooltip}}>{{field.tablesAssociated}}</p>\n\t\t\t\t<p id="{{field.caoFieldId+\'Origin\'}}" class="sr-only" ng-if="field.masterItem" class="lui-list__aside field-name">{{field.masterItemTitle}}</p>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n\t<div id="cao_search_history" class="qv-cao-search-history qv-cao-search-suggestions" ng-if="$ctrl.isSearchHistoryPopupVisible"\n\t\tng-style="{ \'left\': $ctrl.searchResultContainerLeft }">\n\t\t<ul class="lui-list">\n\t\t\t<li class="lui-list__item fields"\n\t\t\t\ttid="caoSearchHistoryField"\n\t\t\t\tng-repeat="query in $ctrl.nluQueries"\n\t\t\t\tng-mousedown="$ctrl.usePreviousQuery(query.text)"\n\t\t\t\tid="{{query.id}}"\n\t\t\t\taria-labelledby="{{query.id}}"\n\t\t\t\t>\n\t\t\t\t<span aria-hidden="true" class="lui-list__text" q-title-translation={{query.text}} tid="caoSearchHistoryFieldName">\n\t\t\t\t\t<span aria-hidden="true" qve-highlight text="{{ query.text }}"></span>\n\t\t\t\t</span>\n\t\t\t\t<p id="{{query.id}}" class="sr-only" >{{ query.text }}</p>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</div>\n'},941:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91),n(103),n(95),n(942),n(168),n(49),n(943),n(944)],a=function(t,e,n,i,a,s,r){var o={template:a,bindings:{isLimited:"<",insightsLoaded:"<",items:"<",activeTab:"<",selectField:"<",showFieldPicker:"<",toggleFieldPicker:"&"},controller:["qvCaoService",function(t){var a=this;var o=new s;this.activeTab=null;this.fieldPickerTabDimensions=e.get("cao.fieldPicker.tab.dimensions");this.fieldPickerTabMeasures=e.get("cao.fieldPicker.tab.measures");this.fieldPickerTabFields=e.get("cao.fieldPicker.fields.title");this.fieldPickerTabFieldsScreenReader=e.get("cao.fieldPicker.fields.title");this.fieldPickerTabMasterItemsScreenReader=e.get("cao.fieldPicker.masterItems.title");this.insightLearning=r.getFlag("CE_PRECEDENTS");this.caoTweakEnabled=r.getFlag("CAO_TWEAK");this.useAgainString=e.get("cao.helpuslearn.useagain");this.dislikedFields=[];this.$onInit=function(){this.init()};this.$onDestroy=function(){i.unsubscribe("cao/insight/learning_applied")};this.$onChanges=function(t){if(t.items&&t.items.currentValue){this.items=t.items.currentValue;this.masterItemDimensions=[];this.masterItemMeasures=[];this.fields=[];this.items.forEach(function(t){t.masterItemDimension?a.masterItemDimensions.push(t):t.masterItemMeasures?a.masterItemMeasures.push(t):a.fields.push(t)})}t.isLimited&&t.isLimited.currentValue&&t.isLimited!==t.isLimited.currentValue?this.init():t.isLimited&&false===t.isLimited.currentValue&&this.init();l()};var l=function t(){if(a.insightLearning){if(a.items&&0!==a.items.length)return o.getDislikedItems().then(function(t){t&&t.length>0&&(a.dislikedFields=t[0].nodes)});a.dislikedFields=[]}else a.dislikedFields=[]};this.isDislikedField=function(t){return a.dislikedFields.filter(function(e){return e.field&&e.field.name===t.qName})[0]};this.isDislikedMasterItem=function(t){return a.dislikedFields.filter(function(e){return e.libItem&&e.libItem.libId===t.libId})[0]};this.useFieldAgain=function(e){n.trackEvent(n.customEvents.INSIGHTS_PROPOSE_FIELD_AGAIN_CLICKED);o.undislikeItem(e.id).then(function(){t.setRefreshIndicatorVisibility(true);i.publish("cao/insight/learning_applied")})};this.init=function(){true===this.isLimited?this.setActiveTab("masterItems"):false===this.isLimited&&this.setActiveTab("fields");i.subscribe("cao/insight/learning_applied",l)};this.setActiveTab=function(t){if("fields"===t)if("fields"!==this.activeTab){this.activeTab="fields";this.title=e.get("cao.fieldPicker.fields.title");this.showFieldPicker||this.toggleFieldPicker()}else this.toggleFieldPicker();else if("masterItems"===t)if("masterItems"!==this.activeTab){this.activeTab="masterItems";this.title=e.get("cao.fieldPicker.masterItems.title");this.setMasterItemsSection("measures");this.showFieldPicker||this.toggleFieldPicker()}else this.toggleFieldPicker()};this.setMasterItemsSection=function(t){"measures"===t?this.activeMasterItemSection="measures":"dimensions"===t&&"dimensions"===this.activeMasterItemSection?this.activeMasterItemSection="measures":"dimensions"===t&&"dimensions"!==this.activeMasterItemSection&&(this.activeMasterItemSection="dimensions")}}]};t.nativeComponent("qvCaoFieldPicker",o)}.apply(e,i),void 0!==a&&(t.exports=a))},942:function(t,e){t.exports='<div class="field-picker">\n\t<div class="tabs">\n\t\t<div qva-cao-acc-field-items x-items-type="fieldPickerCategories">\n\t\t\t<div tid="caoFieldPickerFieldTabButton" class="tab" cao-acc-field-item="{\'type\': \'fieldPickerCategories\', \'index\': 0}"\n\t\t\t ng-class="{\'hide-tab\': $ctrl.activeTab === null, \'selected\': $ctrl.activeTab === \'fields\', \'cao-acc-focus\': $ctrl.itemAccFocus}"\n\t\t\t ng-show="!$ctrl.isLimited" aria-label="{{$ctrl.fieldPickerTabFieldsScreenReader}}" ng-click="$ctrl.setActiveTab(\'fields\')"\n\t\t\t q-title-translation="cao.fieldPicker.fields.title">\n\t\t\t\t<span class="lui-icon  lui-icon--database"></span>\n\t\t\t</div>\n\t\t</div>\n\t\t<div qva-cao-acc-field-items x-items-type="fieldPickerCategories">\n\t\t\t<div tid="caoFieldPickerMasterItemsTabButton" class="tab" cao-acc-field-item="{\'type\': \'fieldPickerCategories\', \'index\': 1}"\n\t\t\t ng-class="{\'hide-tab\': $ctrl.activeTab === null, \'selected\': $ctrl.activeTab === \'masterItems\', \'cao-acc-focus\': $ctrl.itemAccFocus}"\n\t\t\t ng-click="$ctrl.setActiveTab(\'masterItems\')" aria-label="{{$ctrl.fieldPickerTabMasterItemsScreenReader}}"\n\t\t\t q-title-translation="cao.fieldPicker.masterItems.title">\n\t\t\t\t<span class="lui-icon  lui-icon--link"></span>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class="tab-content" tid="caoFieldPickerContentContainer">\n\t\t<qv-spinner class="spinner" show="!$ctrl.items" show-delay="500" center-in-parent="true"></qv-spinner>\n\n\t\t<div ng-if="$ctrl.activeTab === \'fields\' && !$ctrl.isLimited && $ctrl.insightsLoaded" class="fields">\n\t\t\t<button class="field-item-header" ng-class="{\'selected\': true}" tabindex="0" tid="caoFieldPickerFieldSectionButton"\n\t\t\t\taria-labelledby="{{caoFieldPickerFieldText}}">\n\t\t\t\t   <span ng-class="{\'cao-acc-focus\': $ctrl.itemAccFocus}" tid="caoFieldPickerFieldText" class="group-name">\n\t\t\t\t\t   {{$ctrl.fieldPickerTabFields}}</span>\n\t\t\t  </button>\n\t\t\t<div class="no-items" ng-if="$ctrl.showFieldPicker && !$ctrl.fields.length" q-translation="cao.fieldPicker.noItems"></div>\n\t\t\t<ul class="lui-list" ng-if="$ctrl.fields.length" qva-cao-acc-field-items x-items-type="fieldItem">\n\t\t\t\t<div ng-repeat="field in $ctrl.fields" class="field-container">\n\t\t\t\t\t<li class="lui-list__item field" tid="caoFieldPickerField" cao-acc-field-item="{\'type\': \'fieldItem\', \'index\': $index}"\n\t\t\t\t\t ng-click="$ctrl.selectField(field)" aria-label="{{field.qName}}" q-title-translation={{field.qName}} ng-class="{\'selected\': field.selected, \'cao-acc-focus\': $ctrl.itemAccFocus, \'disliked\': $ctrl.isDislikedField(field)}">\n\t\t\t\t\t\t<span class="lui-list__aside  lui-icon {{field.classificationIcon}}" ng-if="field.classificationIcon"></span>\n\t\t\t\t\t\t<span class="lui-list__text">{{field.qName}}</span>\n\t\t\t\t\t</li>\n\t\t\t\t\t<div class="field-picker-propose" ng-if="!$ctrl.caoTweakEnabled && $ctrl.isDislikedField(field)" ng-click="$event.stopPropagation(); $ctrl.useFieldAgain($ctrl.isDislikedField(field))"\n\t\t\t\t\t lui-title-tooltip title="{{$ctrl.useAgainString}}" x-dock="top" x-close-on-click="true">\n\t\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--plus"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</ul>\n\t\t</div>\n\n\t\t<div ng-if="$ctrl.activeTab === \'masterItems\' && $ctrl.insightsLoaded" class="master-items" tid="caoFieldPickerMasterItemsContainer">\n\t\t\t<div class="dimensions" ng-class="{\'selected\': $ctrl.activeMasterItemSection === \'dimensions\'}">\n\t\t\t\t<button class="master-item-header" ng-class="{\'selected\': $ctrl.activeMasterItemSection === \'dimensions\'}" ng-keyup="$ctrl.itemAccFocus=true"\n\t\t\t\t ng-mouseup="$ctrl.itemAccFocus=false" tabindex="0" aria-controls="cao-field-picker-dimensions-fields" tid="caoFieldPickerMasterItemsDimensionSectionButton"\n\t\t\t\t ng-click="$ctrl.setMasterItemsSection(\'dimensions\')" aria-labelledby="{{caoFieldPickerMasterItemDimensionText}}">\n\t\t\t\t\t<span ng-class="{\'cao-acc-focus\': $ctrl.itemAccFocus}" tid="caoFieldPickerMasterItemDimensionText" class="group-name">\n\t\t\t\t\t\t{{$ctrl.fieldPickerTabDimensions}}</span>\n\t\t\t\t</button>\n\t\t\t\t<div class="no-items" ng-if="$ctrl.showFieldPicker && !$ctrl.masterItemDimensions.length && $ctrl.activeMasterItemSection === \'dimensions\'"\n\t\t\t\t q-translation="cao.fieldPicker.noItems"></div>\n\t\t\t\t<ul id="cao-field-picker-dimensions-fields" class="lui-list master-item-fields" qva-cao-acc-field-items\n\t\t\t\t x-items-type="masterItemDimension" aria-expanded="$ctrl.activeMasterItemSection === \'dimensions\'">\n\t\t\t\t\t<div ng-repeat="field in $ctrl.masterItemDimensions" class="field-container">\n\t\t\t\t\t\t<li class="lui-list__item field" tid="caoFieldPickerMasterItemDimension" cao-acc-field-item="{\'type\': \'masterItemDimension\', \'index\': $index}"\n\t\t\t\t\t\t aria-label="{{field.qName}}" ng-click="$ctrl.selectField(field)"\n\t\t\t\t\t\t q-title-translation={{field.qName}} ng-class="{\'selected\': field.selected, \'cao-acc-focus\': $ctrl.itemAccFocus, \'disliked\': $ctrl.isDislikedMasterItem(field) }">\n\t\t\t\t\t\t\t<span class="lui-list__text caoFieldPickerMasterItemDimensionText">{{field.qName}}</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<div class="field-picker-propose" ng-if="!$ctrl.caoTweakEnabled && $ctrl.isDislikedMasterItem(field)" ng-click="$event.stopPropagation(); $ctrl.useFieldAgain($ctrl.isDislikedMasterItem(field))"\n\t\t\t\t\t\t lui-title-tooltip title="{{$ctrl.useAgainString}}" x-dock="top" x-close-on-click="true">\n\t\t\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--plus"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</ul>\n\t\t\t</div>\n\n\t\t\t<div class="measures">\n\t\t\t\t<button class="master-item-header measures" ng-class="{\'selected\': $ctrl.activeMasterItemSection === \'measures\'}"\n\t\t\t\t ng-keyup="$ctrl.itemAccFocus=true" ng-mouseup="$ctrl.itemAccFocus=false" tabindex="0" aria-controls="cao-field-picker-measures-fields"\n\t\t\t\t tid="caoFieldPickerMasterItemsMeasureSectionButton" ng-click="$ctrl.setMasterItemsSection(\'measures\')"\n\t\t\t\t aria-labelledby="{{caoFieldPickerMasterItemMeasuresText}}">\n\t\t\t\t\t<span ng-class="{\'cao-acc-focus\': $ctrl.itemAccFocus}" tid="caoFieldPickerMasterItemMeasuresText" class="group-name">{{$ctrl.fieldPickerTabMeasures}}</span>\n\t\t\t\t</button>\n\t\t\t\t<div class="no-items" ng-if="$ctrl.showFieldPicker && $ctrl.showFieldPicker && !$ctrl.masterItemMeasures.length && $ctrl.activeMasterItemSection === \'measures\'"\n\t\t\t\t q-translation="cao.fieldPicker.noItems"></div>\n\t\t\t\t<ul id="cao-field-picker-measures-fields" class="lui-list master-item-fields" qva-cao-acc-field-items x-items-type="masterItemMeasure"\n\t\t\t\t aria-expanded="$ctrl.activeMasterItemSection === \'measures\'">\n\t\t\t\t\t<div ng-repeat="field in $ctrl.masterItemMeasures" class="field-container">\n\t\t\t\t\t\t<li class="lui-list__item field" tid="caoFieldPickerMasterItemMeasure" cao-acc-field-item="{\'type\': \'masterItemMeasure\', \'index\': $index}"\n\t\t\t\t\t\t ng-click="$ctrl.selectField(field)" q-title-translation={{field.qName}}\n\t\t\t\t\t\t aria-label="{{field.qName}}" ng-class="{\'selected\': field.selected, \'cao-acc-focus\': $ctrl.itemAccFocus, \'disliked\': $ctrl.isDislikedMasterItem(field) }">\n\t\t\t\t\t\t\t<span class="lui-list__text">{{field.qName}}</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<div class="field-picker-propose" ng-if="!$ctrl.caoTweakEnabled && $ctrl.isDislikedMasterItem(field)" ng-click="$event.stopPropagation(); $ctrl.useFieldAgain($ctrl.isDislikedMasterItem(field))"\n\t\t\t\t\t\t lui-title-tooltip title="{{$ctrl.useAgainString}}" x-dock="top" x-close-on-click="true">\n\t\t\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--plus"></span>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t</div>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n</div>'},943:function(t,e,n){"use strict";var i,a;!(i=[n(48)],a=function(t){t.directive("qvaCaoAccFieldItems",["qvAccessibilityGridService",function(t){return{restrict:"A",link:function e(n,i,a){n.$on("$destroy",function(){var e=a["itemsType"];t.removeAllItems(e)})}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},944:function(t,e,n){"use strict";var i,a;!(i=[n(48)],a=function(t){t.directive("caoAccFieldItem",["$timeout","qvAccessibilityGridService",function(t,e){return{restrict:"A",scope:{caoAccFieldItem:"="},link:function n(i,a){var s=function e(n,i){var s=n===this.col&&i===this.row;t(function(){a.attr("tabindex",s?0:-1);if(s){a.focus();a.addClass("cao-acc-focus")}else a.removeClass("cao-acc-focus")})};var r=e.addItem(i.caoAccFieldItem.index,s,i.caoAccFieldItem.type,0,i.caoAccFieldItem.index);r&&a.attr("tabindex",0);var o=function t(e){switch(e.which){case 9:case 16:"0"===a.attr("tabindex")&&a.addClass("cao-acc-focus");break}};var l=function n(s){switch(s.which){case e.RIGHT_KEY:case e.LEFT_KEY:case e.UP_KEY:case e.DOWN_KEY:s.stopPropagation();s.preventDefault();t(function(){"0"===a.attr("tabindex")&&e.key(s,i.caoAccFieldItem.type)});break}};a.on("mouseup",function(){a.removeClass("cao-acc-focus")});a.on("keyup",o);a.on("keydown",l)}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},945:function(t,e,n){"use strict";var i,a;!(i=[n(48)],a=function(t){t.service("qvCaoRenderService",[function(){var t;var e=[];var n=false;function i(){e.sort(function(t,e){return t.priority>e.priority});var t=e[0];t.renderFunction().finally(function(){n=false;e.shift();e.length>0&&i()})}var a=function t(a,s){e.push({renderFunction:a,priority:s});if(!n){n=true;i()}};var s=function t(n){e=e.filter(function(t){return t.renderFunction!==n})};var r=function t(){e=[];n=false};t={enqueueForRender:a,dequeueRender:s,clearRenderQueue:r};return t}])}.apply(e,i),void 0!==a&&(t.exports=a))},946:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(103),n(168),n(221),n(212)],a=function(t,e,n){t.service("qvCaoLearningService",[function(){var t;var i=new n;function a(t){e.trackEvent(e.customEvents.INSIGHTS_NOT_A_MEASURE_CLICKED);return i.defineDimension({expr:"["+t+"]"})}function s(t){e.trackEvent(e.customEvents.INSIGHTS_NOT_A_DIMENSION_CLICKED);return i.defineMeasure({expr:"["+t+"]"})}function r(t){return i.dislikeLibItem({name:t})}function o(t){return i.dislikeField({name:t})}function l(t){var n=t.getAnalysis();return i.dislikeAnalysis(n).then(function(i){n.precedents={id:i.nodes[0].id,disliked:true};e.trackEvent(e.customEvents.INSIGHTS_HIDE_CHART_CLICKED,{chart:t.getAnalysisPrecedentId()})})}function c(t){var e=t.getAnalysis();return i.undislikeAnalysis(e).then(function(){delete e.precedents})}function u(t,e){return t.filter(function(t){return t.field?t.field.name===e:t.libItem.name===e})[0]}function d(t){return i.getDislikedItems().then(function(n){var a=n[0].nodes;e.trackEvent(e.customEvents.INSIGHTS_PROPOSE_FIELD_AGAIN_CLICKED);var s=u(a,t);return i.undislikeItem(s.id)})}function p(t){return i.dislikeAnalysis(t).then(function(e){t.precedents={id:e.nodes[0].id,disliked:true};return true})}function h(t){return i.undislikeAnalysis(t).then(function(){delete t.precedents;return false})}function f(){return i.getLearnedItems()}function g(){return i.getDislikedItems()}function v(t){return i.removeDefinedItem(t)}function m(t){return i.undislikeItem(t)}t={applyDimensionLearning:a,applyMeasureLearning:s,dislikeLibItem:r,dislikeField:o,hideChart:l,unHideChart:c,unDislikeItem:d,dislikeAnalysis:p,unDislikeAnalysis:h,getDislikedItems:g,getLearnedItems:f,removeDefinedItem:v,unDislikeField:m};return t}])}.apply(e,i),void 0!==a&&(t.exports=a))},947:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(91),n(113),n(948),n(949),n(950),n(952),n(954),n(956),n(961)],a=function(t,e,n,i,a,s){var r=["$scope","$timeout","qvCaoSelectionService","qvCaoLearningConfidenceService","qvCaoLearningService",function(a,r,o,l,c){var u=this;var d=null;u.hiddenCharts=[];u.fieldRules=[];u.initState=true;u.isCustomPreferences=true;a.customPreferencesToggleOn=i.CAO_DEBUG;a.customPreferencesToggle={value:true};a.$watch("customPreferencesToggle.value",function(t){u.isCustomPreferences=t;u.precedentsEnabled=t});function p(t){var e=[];var n=u.chart.getSearchReport();var i=u.chart.getMatchDetails();t&&t.forEach(function(t){var a=l.getReasonForSelectingField(t,n,i,true);e=e.concat(a.learned);e=e.concat(a.search)});return e}this.handleHiddenCharts=function(t){if(t){var e=t.getAnalysis();return e.precedents&&e.precedents.disliked?c.unDislikeAnalysis(e):c.dislikeAnalysis(e)}};this.noLearningFound=function(){return!u.isFieldRulesSet()};this.isFieldRulesSet=function(){return u.fieldRules&&u.fieldRules.length>0};this.isFieldRulesEnabled=function(){return u.isFieldRulesSet()&&u.isCustomPreferences};this.viewHiddenCharts=function(){e.publish("cao/insight/open_hidden_charts_panel",u.hiddenCharts)};this.refreshPerformed=function(){u.populateFieldRules()};function h(t){return t.replace(/\{0\}/g,function(t){return"<b>"+t+"</b>"})}function f(t){var e=t.nodes;var i=[];e&&e.length>0&&e.forEach(function(t){var e;e=t&&t.libItem&&t.libItem.name?t.libItem.name:t.field.name;var a=h(n.get("cao.insight.contextPanel.customPreferences.dislikedField"));i.push({label:n.get(a,[e]),field:t,valid:true})});return i}function g(t){var e=t.nodes;var i=[];e&&e.length>0&&e.forEach(function(t){var e=h(n.get("cao.insight.contextPanel.customPreferences.definedItems"));i.push({label:n.get(e,[t[t.type].field,t.type]),field:t,valid:true})});return i}var v=5e3;this.updateListTimer=function(){r.cancel(u.cancelStartTimer);this.cancelStartTimer=r(function(){u.populateFieldRules()},v)};this.populateFieldRules=function(){c.getLearnedItems().then(function(t){var e=[];function n(t){return"define"===t.relation}function i(t){return"dislike"===t.relation}var a=t.filter(i)[0];var s=t.filter(n)[0];a&&(e=e.concat(f(a)));s&&(e=e.concat(g(s)));u.fieldRules=e})};this.removeFieldPreference=function(t){if(t.type)return c.removeDefinedItem(t.id);return c.unDislikeField(t.id)};this.reApplyDefinedField=function(t){if("dimension"===t.type)return c.applyDimensionLearning(t.dimension.field);return c.applyMeasureLearning(t.measure.field)};this.reApplyFieldPreference=function(t){if(t.type)return u.reApplyDefinedField(t);if(t.field)return c.dislikeField(t.field.name);if(t.libId)return c.dislikeLibItem(t.libId.name)};this.openGlobalModeSummaryDialog=function(){d=t.getService("luiDialog").show({template:s,input:{title:"cao.insight.contextPanel.HelpTitle",html:s,closeDialog:function t(){d.close();d=null}}})};this.isHiddenCharts=function(){return u.hiddenCharts&&"INTRO"!==u.state&&"INIT"!==u.state};function m(){return{type:"hide",isHiddenChartLearningOption:true,text:n.get("cao.insight.contextPanel.details.hideChart"),subText:n.get("cao.insight.contextPanel.details.hideChart.subtext"),chart:u.chart}}this.getDetailsForSelectedChart=function(){if(this.chart){var t=[];t=t.concat(p(this.chart.getFields()));t=t.concat(p(this.chart.getMeasures()));t=t.concat(p(this.chart.getDimensions()));t.push(m());u.detailsForChart=t}};this.hiddenChartsTitle=function(){return n.get("cao.insight.contextPanel.hiddenCharts",[u.hiddenCharts.length])};this.updateChart=function(t){u.chart=t;u.initState=true;u.hiddenCharts=[];u.chart?u.getDetailsForSelectedChart():u.populateFieldRules()};u.updateChart(o.getSelectedChart());function b(){u.getDetailsForSelectedChart()}this.openDetailsOption=function(t){u.currentDetailsOption&&u.currentDetailsOption===t?u.currentDetailsOption=null:u.currentDetailsOption=t};e.subscribe("cao/insight/selectedChartChanged",this.updateChart);e.subscribe("cao/insight/light_editing",b);e.subscribe("cao/insight/refreshPerformed",u.refreshPerformed);this.$onDestroy=function(){e.unsubscribe("cao/insight/selectedChartChanged");e.unsubscribe("cao/insight/light_editing");e.unsubscribe("cao/insight/refreshPerformed",u.refreshPerformed);u.cancelStartTimer&&r.cancel(u.cancelStartTimer)}}];var o={transclude:true,template:a,bindings:{app:"<",hiddenCharts:"<",state:"<",insightFeedback:"<",precedentsEnabled:"="},controller:r};return t.nativeComponent("qvCaoInsightsContextPanel",o)}.apply(e,i),void 0!==a&&(t.exports=a))},948:function(t,e){t.exports='<div class="cao-insights-context-panel editor">\n\t<div class="cao-insight-context-panel-header">\n\t\t<div class="title" q-translation="{{ $ctrl.chart ? \'cao.insight.contextPanel.header\' : \'cao.insight.contextPanel.global.header\' }}"></div>\n\t\t<span ng-if="!$ctrl.chart" class="lui-icon lui-icon--help lui-icon--small help-icon" ng-click="$ctrl.openGlobalModeSummaryDialog()"></span>\n\t</div>\n\t\n\t<div class="context-panel-content">\n\t\n\t\t<div ng-if="!$ctrl.chart" class="global-mode">\n\t\t\t<div ng-if="$ctrl.isHiddenCharts()" class="hidden-charts">\n\t\t\t\t<button class="hidden-charts-button" ng-click="$ctrl.viewHiddenCharts()">\n\t\t\t\t\t<span class="lui-list__aside">\n\t\t\t\t\t\t<span class="lui-icon hidden-chart-icon"></span>\t\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class="lui-list__aside text-wrapper">\n\t\t\t\t\t\t<span class="lui-list__text title" tid="cao-hidden-charts-title">{{$ctrl.hiddenChartsTitle()}}</span>\t\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class="lui-list__aside ng-scope">\n\t\t\t\t\t\t<span class="lui-icon lui-icon--small lui-icon--arrow-right icon-arrow"></span>\n\t\t\t\t\t</span>\n\t\t\t\t</button>\n\t\t\t\t<qv-cao-hidden-charts-panel on-panel-hide-action="$ctrl.handleHiddenCharts(chart)" hidden-charts="$ctrl.hiddenCharts" hidden-charts-title="$ctrl.hiddenChartsTitle()" />\n\t\t\t</div>\n\t\t\t<div ng-if="$ctrl.noLearningFound()" class="global-mode-no-learning-applied">\n\t\t\t\t<div class="no-learning-icon" />\n\t\t\t\t<p q-translation="cao.insight.contextPanel.noLearningApplied" class="no-learning-text"></p>\n\t\t\t</div>\n\t\t\t<div ng-if="$ctrl.isFieldRulesSet()" class="custom-preferences">\n\t\t\t\t<span class="lui-list__aside">\n\t\t\t\t\t<span class="lui-icon lui-icon--approve"></span>\n\t\t\t\t</span>\n\n\t\t\t\t<div class="spacing">\n\t\t\t\t\t<div class="preferences-header-title">\n\t\t\t\t\t\t<div class="title" q-translation="cao.insight.contextPanel.customPreferences.title"></div>\n\t\t\t\t\t\t<div class="sub-title" ng-if="customPreferencesToggleOn" q-translation="{{ $ctrl.isCustomPreferences ? \'properties.on\' : \'properties.off\' }}"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="switch-toggle" ng-if="customPreferencesToggleOn">\n\t\t\t\t\t\t<lui-switch x-model="customPreferencesToggle.value" tid="cao-custom-preferences-switch" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div ng-if="$ctrl.isFieldRulesEnabled()">\n\t\t\t\t<qv-cao-field-preferences ng-repeat="fieldRule in $ctrl.fieldRules" delete-rule="$ctrl.removeFieldPreference(fieldPref)" re-apply-rule="$ctrl.reApplyFieldPreference(fieldPref)" field-rule="fieldRule" update-list="$ctrl.updateListTimer()" />\n\t\t\t</div>\n\t\t</div>\n\t\t\n\t\t<div ng-if="$ctrl.chart" class="chart-mode">\n\t\t\t<div class=\'qv-panel-properties\' style="overflow: auto;">\n\t\t\t\t<qv-cao-insight-editor ng-if="$ctrl.chart" chart="$ctrl.chart" app="$ctrl.app" />\n\t\t\t</div>\n\n\t\t\t<div class="cao-accordion-panel">\n\t\t\t\t<cao-accordion-control label="cao.insight.contextPanel.details">\n\t\t\t\t\t<qv-cao-details-option ng-repeat="detail in $ctrl.detailsForChart" detail="detail" open-learning-options="$ctrl.openDetailsOption" is-learning-option-open="detail === $ctrl.currentDetailsOption" insight-feedback="$ctrl.insightFeedback"></qv-cao-details-option>\n\t\t\t\t</cao-accordion-control>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'},949:function(t,e){t.exports='<lui-dialog class="selection-insights-dialog" x-variant="{{::variant}}">\n\t<lui-dialog-header>\n\t\t<lui-dialog-title\n\t\t\tq-translation="cao.insight.contextPanel.HelpTitle"\n\t\t></lui-dialog-title>\n\t</lui-dialog-header>\n\t<lui-dialog-body class="q-modal-loading">\n\t\t<p q-translation="cao.insight.contextPanel.HelpText"></p>\n\t</lui-dialog-body>\n\t<lui-dialog-footer>\n\t\t<button\n\t\t\tclass="lui-button close-button"\n\t\t\tng-click="closeDialog();"\n\t\t\tq-translation="Common.Close"\n\t\t\ttid="selection-insights-dialog-help-button"\n\t\t></button>\n\t</lui-dialog-footer>\n</lui-dialog>'},950:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(951)],a=function(t,e){var n=[function(){var t=this;t.expanded=true;this.toggleExpanded=function(){t.expanded=!t.expanded}}];var i={transclude:true,template:e,bindings:{label:"@"},controller:n};return t.nativeComponent("caoAccordionControl",i)}.apply(e,i),void 0!==a&&(t.exports=a))},951:function(t,e){t.exports='<div ng-click="$ctrl.toggleExpanded()"  class="cao-accordion-control" ng-class="{ \'expanded\': $ctrl.expanded }">\n\t<span class="cao-accordion-control-label" q-title-translation="{{$ctrl.label}}" q-translation="{{$ctrl.label}}" />\n\t<span class="cao-accordion-expander lui-icon lui-icon--small lui-icon--arrow-right" ng-class="{ \'expanded\': $ctrl.expanded }"></span>\n</div>\n<div ng-show="$ctrl.expanded">\n\t<ng-transclude></ng-transclude>\n</div>'},952:function(t,e,n){"use strict";var i,a;!(i=[n(11),n(48),n(953)],a=function(t,e,n){var i=["$element","$timeout",function(e,n){this.$onChanges=function(i){i.isLearningOptionOpen&&i.isLearningOptionOpen.currentValue&&n(function(){var n=t(".context-panel-content");if(n.length){var i=e.offset().top-n.offset().top;var a=e.find(".cao-details-option").height();n.scrollTop(i+a)}})}}];var a={transclude:true,template:n,bindings:{detail:"<",openLearningOptions:"<",isLearningOptionOpen:"<",insightFeedback:"<"},controller:i};return e.nativeComponent("qvCaoDetailsOption",a)}.apply(e,i),void 0!==a&&(t.exports=a))},953:function(t,e){t.exports='<div class="cao-details-option" ng-if="(!$ctrl.detail.searchMatch && $ctrl.insightFeedback) || $ctrl.detail.searchMatch">\n\t<button class="details-option-button" ng-class="{\'cao-learning-option-open\': $ctrl.isLearningOptionOpen}" ng-click="$ctrl.openLearningOptions($ctrl.detail)" ng-if="!$ctrl.detail.searchMatch && $ctrl.insightFeedback">\n\t\t<div class="detail-icon">\n\t\t\t<span class="lui-list__aside">\n\t\t\t\t<span class="lui-icon {{ !$ctrl.detail.userMatch ? \'lui-icon--analyze\' : \'lui-icon--approve\' }}"></span>\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="label-title" ng-bind-html="$ctrl.detail.text"></div>\n\t\t<div class="learning-options-toggle">\n\t\t\t<span class="lui-list__aside">\n\t\t\t\t<span class="lui-icon lui-icon--small lui-icon--more more-option" ng-class="{\'panelNotOpened\' : !$ctrl.isLearningOptionOpen}"></span>\n\t\t\t</span>\n\t\t</div>\n\t</button>\n\t<div class="details-option-item no-hover" ng-if="$ctrl.detail.searchMatch">\n\t\t<div class="detail-icon">\n\t\t\t<span class="lui-list__aside">\n\t\t\t\t<span class="lui-icon {{ !$ctrl.detail.userMatch ? \'lui-icon--analyze\' : \'lui-icon--approve\' }}"></span>\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="label-title" ng-bind-html="$ctrl.detail.text"></div>\n\t</div>\n\t<div ng-show="$ctrl.isLearningOptionOpen">\n\t\t<qv-cao-learning-option detail="$ctrl.detail" />\n\t</div>\n</div>'},954:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(196),n(955)],a=function(t,e,n,i){var a=["qvCaoLearningService",function(t){var i=this;i.learningPerformed=false;var a="field";var s="propose";var r="hide";this.getOppositeLearningOptionActionText=function(){if(i.detail&&i.detail.type)return i.detail.type===n.MEASURE?"cao.insight.contextPanel.details.learningOption.dimension":"cao.insight.contextPanel.details.learningOption.measure";return null};function o(){return i.detail.type===n.MEASURE&&!i.learningPerformed||i.detail.type===n.DIMENSION&&i.learningPerformed?t.applyDimensionLearning(i.detail.field):t.applyMeasureLearning(i.detail.field)}function l(){return i.detail.isLibItem?t.dislikeLibItem(i.detail.libItemId):t.dislikeField(i.detail.field)}function c(t){i.learningPerformed=t;e.publish("cao/insight/learningPerformed",!!t)}this.applyLearning=function(){o().then(function(t){t&&t.nodes[0]&&(i.learningQuad=t.nodes[0].id);c(a)})};this.hideChart=function(){t.hideChart(i.detail.chart).then(function(){c(r)})};this.handleNeverPropose=function(){l().then(function(){c(s)})};this.removeFieldPreference=function(e){if(e.type)return t.removeDefinedItem(e.id);return t.unDislikeField(e.id)};this.revertLearningAction=function(){if(i.detail.type&&i.detail.field&&i.learningQuad&&i.learningPerformed==a){t.removeDefinedItem(i.learningQuad);c()}else i.learningPerformed==s?t.unDislikeItem(i.detail.field).then(function(){c()}):t.unHideChart(i.detail.chart).then(function(){c()})}}];var s={template:i,bindings:{detail:"<"},controller:a};return t.nativeComponent("qvCaoLearningOption",s)}.apply(e,i),void 0!==a&&(t.exports=a))},955:function(t,e){t.exports='<div class="cao-learning-option">\n\t<p q-translation="cao.insight.contextPanel.details.learning" />\n\n\t<div ng-if="!$ctrl.detail.isHiddenChartLearningOption && !$ctrl.learningPerformed">\n\t\t<button class="lui-button learning-button" ng-click="$ctrl.applyLearning()" \n\t\t\tq-translation="{{$ctrl.getOppositeLearningOptionActionText()}}" ng-if="$ctrl.getOppositeLearningOptionActionText() && !$ctrl.detail.isLibItem"/>\n\t\t<button class="lui-button learning-button" ng-click="$ctrl.handleNeverPropose()" \n\t\t\tq-translation="cao.insight.contextPanel.details.learningOption.neverPropose" />\n\t</div>\n\n\t<div ng-if="$ctrl.detail.isHiddenChartLearningOption && !$ctrl.learningPerformed">\n\t\t<button class="lui-button learning-button" ng-click="$ctrl.hideChart()" \n\t\t\tq-translation="cao.insight.contextPanel.details.learningOption.hidechart" tid="hide-chart-button" />\n\t\t<p class="hide-subtext" q-translation="{{$ctrl.detail.subText}}" />\n\t</div>\n\n\t<div ng-if="$ctrl.learningPerformed">\n\t\t<button class="lui-button learning-button undo" ng-click="$ctrl.revertLearningAction()" \n\t\t\tq-translation="cao.insight.contextPanel.details.learningOption.undo" />\n\t</div>\n</div>'},956:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(957),n(958)],a=function(t,e,n){var i=[function(){var t=this;this.openPanel=function(){t.isPanelOpened=true};this.closePanel=function(){t.isPanelOpened=false};this.handleHiddenChart=function(n){e.publish("cao/insight/learningPerformed",!!n);return t.onPanelHideAction({chart:n})};e.subscribe("cao/insight/open_hidden_charts_panel",this.openPanel);this.$onDestroy=function(){e.unsubscribe("cao/insight/open_hidden_charts_panel")}}];var a={template:n,controller:i,bindings:{onPanelHideAction:"&",hiddenCharts:"<",hiddenChartsTitle:"<"}};return t.nativeComponent("qvCaoHiddenChartsPanel",a)}.apply(e,i),void 0!==a&&(t.exports=a))},957:function(t,e){t.exports='<div class="hidden-charts-panel" ng-class="{ \'open-panel\': $ctrl.isPanelOpened }">\n\t\t<div class="header" ng-click="$ctrl.closePanel()">\n\t\t\t<div class="header-wrapper">\n\t\t\t\t<div class="back-navigation">\n\t\t\t\t\t<span class="lui-icon back-icon  lui-icon--previous  lui-icon--small" />\n\t\t\t\t</div>\n\t\t\t\t<div class="text-wrapper">\n\t\t\t\t\t<div class="navigation-title" q-translation="cao.insight.hiddenCharts.panel.goBackTitle"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\n\t\t<div class="hidden-charts-content">\n\t\t\t<div class="spacing title">{{$ctrl.hiddenChartsTitle}}</div>\n\t\t\t<div class="spacing sub-title" q-translation="cao.insight.hiddenCharts.panel.subTitle" ng-if="$ctrl.hiddenCharts.length > 0"></div>\n\t\t\t<div class="spacing sub-title" q-translation="cao.insight.hiddenCharts.panel.subTitleNoHiddenCharts" ng-if="$ctrl.hiddenCharts.length === 0"></div>\n\t\t\t<qv-cao-hidden-charts-view chart="chart" index="$index" ng-repeat="chart in $ctrl.hiddenCharts | orderBy : \'-chart.relevance\'"\n\t\t\t\ton-hide-action="$ctrl.handleHiddenChart(chart)"></cao-hidden-charts-view>\n\t\t</div>\n\t</div>\n</div>'},958:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91),n(959),n(264),n(960)],a=function(t,e,n,i,a){var s=["$element","qvCaoRenderService","luiTooltip","luiPopover",function(t,n,s,r){var o=this;var l=[];o.popupOpen=false;o.actionIcon="view";var c=null;var u={template:i.template,controller:i.controller,input:{item:"",style:{width:"150px"}},alignTo:t.find(".hide-action-button")[0],dock:"left"};var d=500;function p(t){var e=[];t&&t.length>0&&(e=t.map(function(t){return t.field||t.libIdLabel}));return e}this.toTitleCase=function(t){if(t)return t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})};this.setFields=function(){if(o.chart){var t=[];var e=[];var n=[];t=t.concat(p(o.chart.getDimensions()));e=e.concat(p(o.chart.getMeasures()));n=n.concat(p(o.chart.getFields()));o.dimensions=t.toString();o.measures=e.toString();o.fields=n.toString()}};function h(){return o.chart.getComplexity()?o.chart.getComplexity():o.index}this.loadChart=function(){return o.chart.loadChart()};function f(t,e,n,i,a){var s={template:t,controller:e,dock:i,closeOnResize:true,alignTo:n};var c=r.show(s);l.push(c);c.closed.then(function(){o.popupOpen=false;"function"===typeof a&&a()})}this.openChartInfoPopover=function(){if(o.popupOpen){o.popupOpen=false;l=[]}else{o.popupOpen=true;var e=["$scope",function(t){t.dimensions=o.dimensions;t.measures=o.measures;t.fields=o.fields}];f(a,e,t.find(".open-chart-info-popover")[0],"bottom")}};this.$onChanges=function(){if(o.chart){n.enqueueForRender(o.loadChart,h());o.chart.refreshChartType();o.setFields()}};this.$onDestroy=function(){o.chart&&this.chart.destroyChart()};this.openTooltip=function(){setTimeout(function(){var t=o.chart.isHidden()?"cao.insight.hiddenCharts.view.unhide":"cao.insight.hiddenCharts.view.hide";u.input.item=e.get(t);c=s.show(u)},d)};this.closeTooltip=function(){setTimeout(function(){c&&c.close()},d)};this.handleHideChartAction=function(){o.closeTooltip();o.onHideAction({chart:o.chart})}}];var r={template:n,bindings:{chart:"<",index:"<",onHideAction:"&"},controller:s};return t.nativeComponent("qvCaoHiddenChartsView",r)}.apply(e,i),void 0!==a&&(t.exports=a))},959:function(t,e){t.exports='<div class="hidden-charts-view" ng-class="{ \'hidden\': !$ctrl.chart.isHidden() }">\n\t\t<div class="title-container spacing">\n\t\t\t<div class="header-title">\n\t\t\t\t<div class="title">\n\t\t\t\t\t{{ $ctrl.toTitleCase($ctrl.chart.chartType) }}\n\t\t\t\t</div>\n\t\t\t\t<div class="open-chart-info-popover" ng-click="$ctrl.openChartInfoPopover()"><span class="lui-icon lui-icon--info" /></div>\n\t\t\t</div>\n\t\t\t<div class="cao-hide-action" >\n\t\t\t\t<span class="lui-list__aside action-button-container">\n\t\t\t\t\t<span \n\t\t\t\t\t\tclass="hide-action-button" \n\t\t\t\t\t\tng-class="$ctrl.chart.isHidden() ? \'icon--view\': \'lui-icon lui-icon--back\'"\n\t\t\t\t\t\tng-click="$ctrl.handleHideChartAction()" \n\t\t\t\t\t\tng-mouseover="$ctrl.openTooltip()" \n\t\t\t\t\t\tng-mouseleave="$ctrl.closeTooltip()"\n\t\t\t\t\t/>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t\n\t\t<div class="spacing content-view">\n\t\t\t<div class="wrapper">\n\t\t\t\t<div class="image-container" ng-if="$ctrl.chart && $ctrl.chart.getState() === \'LOADING\'">\n\t\t\t\t\t<img ng-src="{{$ctrl.chart.chartTypeImageUrl}}" class="loader-image" />\n\t\t\t\t</div>\n\t\t\t\t<qv-object ng-if="$ctrl.chart && $ctrl.chart.getState() === \'LOADED\'" model="$ctrl.chart.chart.model" options="$ctrl.chart.options" object="$ctrl.chart.object" />\n\t\t\t</div>\n\t\t</div>\n</div>'},960:function(t,e){t.exports='<lui-popover class="cao-hidden-charts-popover">\n\t<div class="cao-hidden-charts-popover-body">\n\t\t<ul class="lui-list cao-hidden-charts-popover-list">\n\t\t\t<li class="lui-list__item cao-hidden-charts-popover-list__item" ng-if="dimensions">\n\t\t\t\t<div>\n\t\t\t\t\t<strong q-translation="Common.Dimensions"></strong>:<span>&nbsp;{{ dimensions }}</span>\n\t\t\t\t</div>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item cao-hidden-charts-popover-list__item" ng-if="measures">\n\t\t\t\t<div>\n\t\t\t\t\t<strong q-translation="Common.Measures"></strong>:<span>&nbsp;{{ measures }}</span>\n\t\t\t\t</div>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item cao-hidden-charts-popover-list__item" ng-if="fields">\n\t\t\t\t<div>\n\t\t\t\t\t<strong q-translation="Common.Fields"></strong>:<span>&nbsp;{{ fields }}</span>\n\t\t\t\t</div>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</lui-popover>'},961:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(95),n(91),n(962),n(264)],a=function(t,e,n,i,a){var s=["luiTooltip","$element",function(t,i){var s=this;var r=null;var o={template:a.template,controller:a.controller,input:{item:"",style:{width:"150px"}},alignTo:i.find(".field-rule-action-button")[0],dock:"left"};this.toggleFieldRule=function(){s.fieldRule.valid=!s.fieldRule.valid;e.publish("cao/insight/learningPerformed",true)};this.handleFieldRuleAction=function(){s.closeTooltip();s.fieldRule.valid?s.deleteRule({fieldPref:s.fieldRule.field}).then(function(){s.toggleFieldRule();s.updateList()}):s.reApplyRule({fieldPref:s.fieldRule.field}).then(function(){s.toggleFieldRule()})};this.openTooltip=function(){var e=s.fieldRule.valid?"cao.insight.contextPanel.customPreferences.remove":"cao.insight.contextPanel.customPreferences.restore";o.input.item=n.get(e);r=t.show(o)};this.closeTooltip=function(){r&&r.close()}}];var r={template:i,bindings:{fieldRule:"<",deleteRule:"&",reApplyRule:"&",updateList:"&"},controller:s};return t.nativeComponent("qvCaoFieldPreferences",r)}.apply(e,i),void 0!==a&&(t.exports=a))},962:function(t,e){t.exports='<div class="cao-field-preferences" ng-class="{ \'hidden\': !$ctrl.fieldRule.valid }">\t\n\t<div class="label-title" ng-bind-html="$ctrl.fieldRule.label" />\n\t<div class="field-rule-action-container" >\n\t\t<span class="lui-list__aside action-button-container">\n\t\t\t<span \n\t\t\t\tclass="lui-icon field-rule-action-button" \n\t\t\t\tng-class="$ctrl.fieldRule.valid ? \'lui-icon--bin\': \'lui-icon--back\'"\n\t\t\t\tng-click="$ctrl.handleFieldRuleAction()" \n\t\t\t\tng-mouseover="$ctrl.openTooltip()" \n\t\t\t\tng-mouseleave="$ctrl.closeTooltip()"\n\t\t\t/>\n\t\t</span>\n\t</div>\n</div>'},963:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(10),n(95),n(964),n(223),n(222)],a=function(t,e,n,i,a,s){var r=["$window",function(t){var i=this;i.app=null;i.isToggleContextDisabled=false;this.$onInit=function(){e.element(t).bind("resize",i.autoHidePanels);i.autoHidePanels()};this.$onChanges=function(t){i.app=t.app.currentValue;i.isContextPanelVisible=a.storageObj(i.app.id).contextPanel;i.isAssetsPanelVisible=a.storageObj(i.app.id).assetsPanel};this.autoHidePanels=function(n){var a="string"!==typeof n;var s=e.element(t).innerWidth();s<1200&&(i.isContextPanelVisible&&i.isAssetsPanelVisible&&a?i.toggleContextPanel():i.isAssetsPanelVisible&&i.isContextPanelVisible&&"assets"===n?i.toggleContextPanel():i.isAssetsPanelVisible&&i.isContextPanelVisible&&"context"===n&&i.toggleAssetsPanel())};this.getContextPanelToggleButtonTitle=function(){return i.isContextPanelVisible?"cao.insight.hideContextPanel":"cao.insight.showContextPanel"};this.getHideAssetsButtonTitle=function(){return i.isAssetsPanelVisible?"cao.insight.hideAssetsPanel":"cao.insight.showAssetsPanel"};this.contextPanelToggled=function(){i.autoHidePanels("context");s.resizeCharts(t)};this.toggleContextPanel=function(){if(!i.isToggleContextDisabled){i.isContextPanelVisible=!i.isContextPanelVisible;a.toggleContextPanel(i.app.id);n.publish("cao/insight/contextPanelToggled",i.isContextPanelVisible)}};this.disableToggleContext=function(t){i.isToggleContextDisabled=t};this.assetsPanelToggled=function(e){i.isAssetsPanelVisible=e;i.autoHidePanels("assets");s.resizeCharts(t)};this.toggleAssetsPanel=function(){i.isAssetsPanelVisible=!i.isAssetsPanelVisible;a.toggleAssetsPanel(i.app.id);n.publish("cao/insight/assetsPanelToggled",i.isAssetsPanelVisible)};n.subscribe("cao/insight/contextPanelToggled",this.contextPanelToggled);n.subscribe("cao/insight/assetsPanelToggled",this.assetsPanelToggled);n.subscribe("cao/insight/editInsightProperties",i.disableToggleContext);this.$onDestroy=function(){n.unsubscribe("cao/insight/contextPanelToggled");n.unsubscribe("cao/insight/assetsPanelToggled");n.unsubscribe("cao/insight/editInsightProperties")}}];var o={transclude:true,template:i,bindings:{app:"<",insightFeedback:"<"},controller:r};return t.nativeComponent("qvCaoInsightsBottomPanel",o)}.apply(e,i),void 0!==a&&(t.exports=a))},964:function(t,e){t.exports='\n<div class="cao-insights-bottom-panel">\n\t<div class="hide-assets-panel-container">\n\t\t<button class="bottom-panel-button" ng-class="{ \'lui-active\': $ctrl.isAssetsPanelVisible }" q-title-translation="{{$ctrl.getHideAssetsButtonTitle()}}" tid="bottom-panel-button-left"\n\t\t\tng-click="$ctrl.toggleAssetsPanel()" tabindex="0">\n\t\t\t<span class="lui-icon lui-icon--toggle-left" />\n\t\t\t<span class="label" q-translation="{{$ctrl.getHideAssetsButtonTitle()}}" />\n\t\t</button>\n\t</div>\n\t<div class="hide-insight-properties-container" ng-if="$ctrl.insightFeedback">\n\t\t<button class="bottom-panel-button" ng-class="{ \'lui-active\': $ctrl.isContextPanelVisible, \'disabled\': $ctrl.isToggleContextDisabled }" q-title-translation="{{$ctrl.getContextPanelToggleButtonTitle()}}" tid="bottom-panel-button-right" \n\t\t\tng-click="$ctrl.toggleContextPanel()" tabindex="0" ng-attr-tabindex="{{$ctrl.isToggleContextDisabled ? \'-1\' : \'0\'}}">\n\t\t\t<span class="label" q-translation="{{$ctrl.getContextPanelToggleButtonTitle()}}" />\n\t\t\t<span class="lui-icon lui-icon--toggle-right" />\n\t\t</button>\n\t</div>\n</div>'},965:function(t,e,n){"use strict";var i,a;!(i=[n(966),n(48),n(90),n(967),n(11),n(167),n(277)],a=function(t,e,n,i,a,s){e.service("qvMultiStatePopoverService",["luiPopover",function(e){var r;function o(t,e){var n=t.which;n=t.shiftKey&&s.TAB===n?"SHIFT_TAB":n;switch(n){case s.ARROW_LEFT:case s.ARROW_UP:case"SHIFT_TAB":case s.ESCAPE:a(e).focus();t.preventDefault();break}}return{show:function a(s){var l={handleBtnKeyDown:o,getItems:function t(){return[]},autoFocus:false};s=n.extend(true,{},l,s);r=e.show({template:t,controller:i.controller,alignTo:s.alignToElement,autoFocus:s.autoFocus,input:{title:s.title,getItems:s.getItems,clear:s.clear,click:s.click,onClose:s.onClose,brightCurSel:s.brightCurSel,openTooltip:s.openTooltip,closeTooltip:s.closeTooltip,handleKeyDown:s.handleKeyDown,handleBtnKeyDown:s.handleBtnKeyDown,handlePopoverKeyDown:s.handlePopoverKeyDown,alignToElement:s.alignToElement},closeOnResize:true,dock:"top"});return r},close:function t(){r&&r.close();r=null}}}])}.apply(e,i),void 0!==a&&(t.exports=a))},966:function(t,e){t.exports='<lui-popover class="lui-popover qv-multi-state-popover" ng-class="{ bright: input.brightCurSel }" tid="qv-multi-state-popover">\n\t<lui-popover-header class="lui-popover__header">\n\t\t<div class="lui-popover__title">\n\t\t\t<span ng-if="input.title && input.title.length">{{ input.title }}</span>\n\t\t\t<div class="btn-clearall">\n\t\t\t\t<lui-button \n\t\t\t\t\ttid="qv-multi-state-popover-btn-clear"\n\t\t\t\t\tclass="clear-all-btn lui-button--block"\n\t\t\t\t\tng-keydown="handleBtnKeyDown($event, input.alignToElement)" \n\t\t\t\t\tng-click="input.clear(input.getItems()[0].qField, null, $event)" \n\t\t\t\t\tng-disabled="allItemsNonClearable( input.getItems() )" \n\t\t\t\t\tq-title-translation="AlternateState.Popover.ClearAllStates">\n\t\t\t\t\t<span class="lui-button__text" q-translation="AlternateState.Popover.ClearAllStates"></span>\n\t\t\t\t</lui-button>\n\t\t\t</div>\n\t\t</div>\n\t</lui-popover-header>\t\n\t<lui-popover-body class="lui-popover__body">\n\t\t<ul class="lui-list" qva-direction x-dir-setting="{{input.direction}}">\n\t\t\t<li class="item" ng-repeat="item in input.getItems()" ng-click="input.click($event)" ng-mousemove="input.openTooltip($event, item)" ng-mouseleave="input.closeTooltip()"\n\t\t\t\ttabindex="0" ng-keydown="handleKeyDown($event, item)" aria-label="{{item.screenReaderLabel}}" ng-class="{ \'item-locked\' : item.qLocked }">\n\t\t\t\t<div class="item-container">\n\t\t\t\t\t<div ng-if="item.qLocked" class="icon-lock">\n\t\t\t\t\t\t<span class="lui-icon lui-icon--lock">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="item-component text-container" qva-direction x-dir-text="{{item.displayStateName}}">\n\t\t\t\t\t\t<div class="text">{{ item.displayStateName }}</div>\n\t\t\t\t\t\t<div class="values">{{ item.translation }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div ng-if="!( item.qLocked || item.qOneAndOnlyOne )" class="item-component remove" ng-click="input.clear(item.qField, item.stateName, $event)" q-title-translation="CurrentSelections.Remove">\n\t\t\t\t\t\t<span class="lui-icon lui-icon--remove"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<qv-state-count-bar ng-if="!item.isPlaceHolder && item.isSingleState" state-counts="item.qStateCounts"></qv-state-count-bar>\n\t\t\t</li>\n\t\t</ul>\n\t</lui-popover-body>\n</lui-popover>'},967:function(t,e,n){"use strict";var i,a;!(i=[n(277)],a=function(){var t={template:null,controller:["$scope","$element","$timeout",function(t,e,n){this.close=function(){i()};function i(){n(function(){t.destroyComponent();e.remove()})}t.closingDeferred.promise.then(function(e){t.input.onClose(e);i()});t.allItemsNonClearable=function(t){return!t.some(function(t){var e=!(t.qLocked||t.qOneAndOnlyOne);return e})}}]};return t}.apply(e,i),void 0!==a&&(t.exports=a))},968:function(t,e){t.exports='<div class="current-selections-item" data-tid="current-selections-item"\n\tng-mousemove="openTooltip($event, item)" ng-mouseleave="closeTooltip()" \n\tng-class="{\n\t\t\'active\' : item.qField === activeFieldName,\n\t\t\'dim\' : $parent.itemSelected && !item.active,\n\t\t\'item-locked\' : item.qLocked,\n\t\t\'locked-feedback item-animate-in\' : item.feedbackActive && item.qLocked,\n\t\t\'item-animate-out\' : (!item.feedbackActive && item.qLocked) || (!item.feedbackActive && item.qOneAndOnlyOne),\n\t\t\'single-select-feedback item-animate-in\' : item.feedbackActive && item.qOneAndOnlyOne,\n\t\t\'single-icon\': item.qOneAndOnlyOne || item.qLocked\n\t}">\n\t<div ng-class="{locked:item.qLocked}" class="text">\n\t\t<div class="text-wrap">\n\t\t\t<span ng-class="{ \'lui-icon lui-icon--lock\': item.qLocked }"></span>\n\t\t\t<span class="name" tid="selection-name">{{item.name}}</span>\n\t\t</div>\n\t\t<span class="values">\n\t\t\t<span ng-if="!item.isDefaultState">{{item.displayStateName}}:</span>\n\t\t\t<span tid="current-selection-item-text">{{item.translation}}</span>\n\t\t</span>\n\t</div>\n\t<div class="options" title=" "> \x3c!-- The empty title attribute is neeeded for screen reader not to read anchor title: \'clear selections\' --\x3e\n\t\t<div ng-if="!item.isDefaultState" class="item-component count" title="">\n\t\t\t<span class="field-states-indicator"></span>\n\t\t</div>\n\t\t<a ng-if="!currentSelectionDisabled && (!item.qLocked && !item.isPlaceHolder && !item.qOneAndOnlyOne)" ng-click="clear(item.qField, item.stateName)" class="remove" q-title-translation="CurrentSelections.Remove">\n\t\t\t<span class="lui-clear-all lui-icon lui-icon--remove"></span>\n\t\t</a>\n\t</div>\n\n\t<qv-state-count-bar ng-if="!item.isPlaceHolder && item.isSingleState" state-counts="item.qStateCounts"></qv-state-count-bar>\n</div>'},969:function(t,e){t.exports='<div class="qv-odag-bar" ng-class="{\'inEditMode\': inEditMode, \'inAnalysisMode\': !inEditMode, \'standAlone\': standAlone }">\n\t<div class="leftOdag" qv-pager qv-sortable-list="sortableNavPoints"> \n\t\t<div ng-if="odagNavPoints.items.length === 0" class="drag-help" ng-class="{\'inEditMode\': inEditMode}">{{waterMarkText}}</div>\n\t\t<ul class="list">\n\t\t\t<li ng-repeat="item in odagNavPoints.items track by item.id" class="odag-nav-point" ng-class="item.classList">\n\t\t\t\t<div class="nav-point-container" ng-class="{\'invalid\': item.invalid }">\n\t\t\t\t\t<div ng-if="inEditMode" class="dropArea"></div>\n\t\t\t\t\t<qv-odag-toolbar-navpoint item="item" in-edit-mode="inEditMode"></qv-odag-toolbar-navpoint>\n\t\t\t\t</div>\n\t\t\t</li> \n\t\t</ul>\n\t\t<a class="qv-pager-nav qv-pager-previous" ng-click="prevPage()" q-title-translation="Tooltip.Previous"><i class="lui-icon lui-icon--arrow-left"></i></a>\n\t\t<a class="qv-pager-nav qv-pager-next" ng-click="nextPage()" q-title-translation="Tooltip.Next"><i class="lui-icon lui-icon--arrow-right"></i></a>\t\t\n\t</div>\n </div>\t\n'},970:function(t,e,n){"use strict";var i,a;!(i=[n(89),n(92),n(54),n(102),n(219),n(90)],a=function(t,e,n,i,a,s){var r=e.extend("ODAGNavPoint",{properties:null,parent:null,init:function t(e){i.mixin(this);this.notification("Invalidated");this.parent=e.parent;this.properties={qInfo:{qType:"odagNavPoint"}};this.properties=s.extend(this.properties,e.properties);var a=this;this._sheetInvalidated=function(){a.parent.getProperties().then(function(t){for(var e=0;e<t.navPoints.length;e++){var i=t.navPoints[e];if(i.info.id===a.properties.info.id){if(!n.isEqual(i,n.omit(a.properties,["qInfo"]))){a.properties=s.extend(a.properties,i);a.Invalidated.emit()}break}}})};this.parent.Invalidated.bind(this._sheetInvalidated)},getLayout:function t(){var e=this;this.properties.odagLinkName=null;return a.getList(this.parent.app).then(function(t){if(t.filter(function(t){return t.properties.data.id===e.properties.odagLinkRefID}).length>0)return a.get(e.properties.odagLinkRefID,e.parent.app).then(function(t){e.properties.odagLinkName=t.properties.data.name;return e.properties});e.properties.odagLinkName="";return e.properties})},getProperties:function e(){return t.resolve(this.properties)},getEffectiveProperties:function e(){return t.resolve(this.properties)},clearSoftPatches:function t(){return},removeObject:function t(){this.parent.removeNavPoint(this.properties.info.id)},setProperties:function t(e){var n=this;this.properties=s.extend(this.properties,e);return this.parent.getProperties().then(function(t){for(var e=0;e<t.navPoints.length;e++){var i=t.navPoints[e];if(i.info.id===n.properties.info.id){var a=s.extend({},n.properties);delete a["qInfo"];t.navPoints[e]=a;break}}return n.parent.setProperties(t)})},destroy:function t(){this.parent.Invalidated.unbind(this._sheetInvalidated)}});return r}.apply(e,i),void 0!==a&&(t.exports=a))},971:function(t,e,n){"use strict";var i,a;!(i=[],a=function(){var t={type:"items",component:"accordion",items:{navPointProps:{type:"items",translation:"properties.odagNavProperties",items:{general:{type:"items",grouped:true,items:{title:{type:"string",ref:"title",translation:"Common.Name",minlength:1,readOnly:function t(e,n,i){var a=i.layout;return a&&(a.permissions&&!a.permissions.update||a.qMeta&&a.qMeta.sourceObject&&a.qMeta.sourceObject.length>0)},rollbackInvalid:true}}},odagLinkInfo:{type:"items",items:{odagLinkName:{type:"string",ref:"odagLinkName",translation:"properties.odag.link.name",minlength:1,readOnly:function t(){return true},rollbackInvalid:true}}}}}}};return t}.apply(e,i),void 0!==a&&(t.exports=a))},972:function(t,e){t.exports='<div class="drag-odag-navpoint">\n\t<div class="odag-nav-point-cell" ng-class="{\'active\': item.id === selObject.id, \'popoverOpen\': popover, \'invalid\': item.invalid }" ng-style="item.style" ng-click="onODAGNavPointClicked(item)">\n\t\t<qv-progress-circle ng-if="!inEditMode && !item.invalid" class=" odag-progress-circle" percentage="rowCountPercentage"></qv-progress-circle>\n\t\t<div class="cell-name" ng-if="inEditMode || !item.invalid" title="{{item.data.title}}">{{item.data.title}}</div>\n\t\t<div class="cell-name" ng-if="!inEditMode && item.invalid " q-title-translation="odag.toolbar.navpoint.invalid" q-translation="odag.toolbar.navpoint.invalid"></div>\n\t\t<div ng-if="!inEditMode && !item.invalid" class="arrow lui-icon lui-icon--triangle-bottom"></div>\n\t\t<button ng-if="inEditMode && item.invalid" class="lui-fade-button delete-invalid-navpoint" ng-click="deleteInvalidNavPoint($event, item)">\n\t\t\t<span class="lui-fade-button__icon  lui-icon lui-icon--bin"></span>\n\t\t</button>\n\t</div>\n</div>'},973:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(91),n(49),n(135),n(295),n(138),n(974),n(323),n(976),n(484)],a=function(t,e,i,a,s,r,o){var l={template:o,controller:["$scope","$element","$timeout","odagNavpointService",function(o,l,c,u){var d;var p=t.getService("qvLoader");o.odagNavpointService=u;o.loadingContent={value:true};o.showInfoPopup=false;o.generatedApps=[];o.bindings=[];o.expandedItem={item:null};o.generateAppInProgress=false;o.bindingsPass=true;o.maxGeneratedAppLimitReached=false;o.dismissedMaxGenAppMsg=false;o.dismissMaxGenAppMsgClicked=function(){o.dismissedMaxGenAppMsg=true};o.isGenerateBtnDisabled=function(){o.bindingsPass=o.bindings.filter(function(t){return false===t.bindingPassesConstraint}).length>0;return o.header.invalid||o.maxGeneratedAppLimitReached||o.bindingsPass||!o.item.rowCountPercentage||100!==o.item.rowCountPercentage||a.isSuffixInUse("noData")||o.generateAppInProgress};o.canApplySelectionsForReload=function(){o.bindingsFailed=o.bindings.filter(function(t){return false===t.bindingPassesConstraint}).length>0;return!(o.header.invalid||o.bindingsFailed||!o.item.rowCountPercentage||100!==o.item.rowCountPercentage||a.isSuffixInUse("noData")||o.generateAppInProgress)};o.infoHeader=e.get("odag.toolbar.navpoint.popup.info.header");o.circleModel={chartValue:o.item.rowCountPercentage?o.item.rowCountPercentage:0};o.$watchCollection("item.rowCountPercentageNumber",function(t){o.item.rowCountPercentage=-1===t?NaN:t;o.circleModel.chartValue=o.item.rowCountPercentage?o.item.rowCountPercentage:0});o.header={invalid:false,templateThumbnail:n.p+"img/core/static/Default_thumbnail_app.png",templateName:e.get("Common.Loading"),templateDescription:e.get("Common.Loading")};function h(){return u.updateItemHeader(o.item,o.header)}o.setSelectionState=function(){var t=o.expandedItem.item;i.getFlag("ODAG_SAAS_ENABLED")&&t&&u.getSelections(t.parentContext.app,t.requestId).then(function(t){o.expandedItemSelectionState=u.getSelectedValuesDisplayString(t,{value:false})})};o.loadGeneratedApps=function(){u.loadGeneratedApps(o.item,o.generatedApps).then(function(){o.loadingContent.value=false;o.expandedItem.item&&(o.generatedApps.some(function(t){return o.expandedItem.item.requestId===t.requestId})?o.setSelectionState():o.expandedItem.item=null);o.maxGeneratedAppLimitReached=o.generatedApps.length>=o.item.maxNumberOfApps;g()})};u.initializeBindings(o.item,o.bindings);f().then(function(){o.item.initialized.promise.then(function(){o.actualRowEstFormatted="NaN"===o.item.actualRowEst?e.get("odag.toolbar.navpoint.popup.invalid"):r.format.number(o.item.actualRowEst,{});o.maxRowExpressionCountFormatted=r.format.number(o.item.maxRowExpressionCount,{});h().finally(function(){o.loadGeneratedApps()})})});function f(){d=c(function(){p.close(true).then(function(){p.show({template:s,hugeLoader:false,mediumLoader:true,appendTo:l.find(".odag-popup-body")[0]})})},0,false);return d}function g(){c.cancel(d);d=null;p.close()}o.onApplySelections=function(){u.initializeBindings(o.item,o.bindings)};o.onNavPointInfoClicked=function(t){t.preventDefault();t.stopPropagation();o.showInfoPopup=!o.showInfoPopup};o.deleteGenAppClicked=function(t,e){t.preventDefault();t.stopPropagation();o.showInfoPopup&&(o.showInfoPopup=!o.showInfoPopup);if(e.deleteIcon&&!e.actionInProgress){e.actionInProgress=true;u.deleteGeneratedApp(e).then(function(){o.loadGeneratedApps();o.expandedItem.item&&e.requestId===o.expandedItem.item.requestId&&(o.expandedItem.item=null);e.actionInProgress=false}).catch(function(t){e.actionInProgress=false;throw t})}};o.reloadApp=function(t,e){o.generateAppInProgress=true;u.reloadApp(o.item,t.requestId,e).then(function(){2===e&&(o.expandedItem.item=null);o.loadGeneratedApps();o.generateAppInProgress=false}).catch(function(t){o.generateAppInProgress=false;throw t})};o.onGenerateAppClicked=function(){o.generateAppInProgress=true;o.showInfoPopup=false;u.generateApp(o.item).then(function(){o.generateAppInProgress=false;o.loadGeneratedApps()}).catch(function(t){o.generateAppInProgress=false;throw t})};o.$on("$destroy",function(){u.stopLoadGeneratedApps(o.item);g()})}]};return l}.apply(e,i),void 0!==a&&(t.exports=a))},974:function(t,e){t.exports='<lui-popover id="odag-toolbar-navpoint-popover" ng-class="expandedItem.item? \' request-expanded\' : \'\'" class="odag-toolbar-navpoint-popover"\n x-arrow="arrow">\n\t<lui-popover-header ng-class="{\'invalid\': header.invalid}">\n\t\t<img qva-prevent-drag ng-src="{{ header.imgSrc }}" class="app-thumbnail-img" />\n\t\t<div class="title-description-container">\n\t\t\t<lui-popover-title title="{{header.templateName}}">{{header.templateName}}</lui-popover-title>\n\t\t\t<lui-popover-title ng-if="!header.invalid" class="desciption" title="{{header.templateDescription}}">{{header.templateDescription}}</lui-popover-title>\n\t\t</div>\n\t</lui-popover-header>\n\n\t<lui-popover-body class="odag-popup-body" qva-outside-ignore-for="odag-request-menu">\n\t\t<odag-app-list2 class="odag-app-list-container" applist="generatedApps" reload-app="reloadApp" load-generated-apps="loadGeneratedApps" set-selection-state="setSelectionState"\n\t\t generate-app-in-progress="generateAppInProgress" expanded-item="expandedItem" is-header-invalid="header.invalid" is-generate-btn-disabled="isGenerateBtnDisabled"\n\t\t can-apply-selections-for-reload="canApplySelectionsForReload" expanded-item-selection-state="expandedItemSelectionState"\n\t\t loading="loadingContent.value" delete-clicked="deleteGenAppClicked" on-apply-selections-callback="onApplySelections" open-app-callback="item.openAppCallback"></odag-app-list2>\n\t\t<div ng-if="maxGeneratedAppLimitReached && !dismissedMaxGenAppMsg && !expandedItem.item" class="odag-max-app-limit-reached">\n\t\t\t<div class="max-app-text" q-translation="odag.toolbar.napvoint.popup.maxAppLimitReached"></div>\n\t\t\t<button class="lui-fade-button close-button" q-title-translation="Common.Close" ng-click="dismissMaxGenAppMsgClicked()">\n\t\t\t\t<span class="lui-button__icon  lui-icon lui-icon--small  lui-icon--close"></span>\n\t\t\t</button>\n\t\t</div>\n\t</lui-popover-body>\n\t<div ng-if="showInfoPopup" class="infoPopup">\n\t\t<div class="info-constraints-header">{{infoHeader}}</div>\n\t\t<div class="info-row-count-container">\n\t\t\t<div class="info-section" q-translation="odag.toolbar.navpoint.popup.info.row.count.header"></div>\n\t\t\t<div class="info-row-count-content">\n\t\t\t\t<div class="info-row-count-progress-circle">\n\t\t\t\t\t<circle-chart model=\'circleModel\'></circle-chart>\n\t\t\t\t</div>\n\t\t\t\t<div class="info-row-count-current">\n\t\t\t\t\t<div class="info-row-count-header" q-translation="odag.toolbar.navpoint.popup.info.row.count.current.header"></div>\n\t\t\t\t\t<div class="">{{actualRowEstFormatted}}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="info-row-count-constraint">\n\t\t\t\t\t<div class="info-row-count-header" q-translation="odag.toolbar.navpoint.popup.info.row.count.constraint.header"></div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t< {{maxRowExpressionCountFormatted}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="info-section" q-translation="odag.toolbar.navpoint.popup.info.field.header"></div>\n\t\t\t<div class="info-field-header">\n\t\t\t\t<div class="info-field" q-translation="odag.toolbar.navpoint.popup.info.field.table.header"></div>\n\t\t\t\t<div class="info-value" q-translation="odag.toolbar.navpoint.popup.info.current.table.header"></div>\n\t\t\t\t<div class="info-constraint" q-translation="odag.toolbar.navpoint.popup.info.constraint.table.header"></div>\n\t\t\t</div>\n\t\t\t<div class="info-field-values">\n\t\t\t\t<div ng-repeat="binding in bindings | orderBy: \'-hasConstraint\' " class="info-field-row" ng-if="bindings.length">\n\t\t\t\t\t<div class="info-field-data">{{binding.fieldName}}</div>\n\t\t\t\t\t\n\t\t\t\t\t<div class="info-value-data">\n\t\t\t\t\t\t<div class="info-field-checkmark" ng-if="binding.bindingPassesConstraint">\n\t\t\t\t\t\t\t<span class="lui-icon  lui-icon--tick" aria-hidden="true"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="info-field-warning" ng-if="!binding.bindingPassesConstraint">\n\t\t\t\t\t\t\t<span class="lui-icon  lui-icon--warning-triangle" aria-hidden="true"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-if="binding.hasConstraint">{{binding.values.length}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<div class="info-constraint-data">{{binding.constraint}}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<lui-popover-footer>\n\t\t<lui-button ng-if="!expandedItem.item" class="info-button" ng-class="{\'lui-button--danger\': bindingsPass, \'lui-active\': showInfoPopup}"\n\t\t x-variant="fade" ng-click="onNavPointInfoClicked($event)">\n\t\t\t<span class="lui-icon  lui-button__icon lui-icon--info"></span>\n\t\t</lui-button>\n\t\t<lui-button ng-if="!expandedItem.item" tid="odag-toolbar-navpoint-popover_generate_app_button" ng-disabled="isGenerateBtnDisabled()"\n\t\t ng-click="onGenerateAppClicked()" q-translation="odag.toolbar.navpoint.popup.generate.app"></lui-button>\n\t</lui-popover-footer>\n</lui-popover>'},975:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(380),n(138),n(460),n(91),n(49)],a=function(t,e,n,i,a,s){t.service("odagNavpointServiceUI",["$timeout",function(t){var r;function o(t,e){e.value=true;for(var n=0;n<t.length;n++){var i="";var s=t[n];if(s.selectedSize>1e4){e.value=false;i=a.get("odag.toolbar.navpoint.popup.request.tab.xNumSelectedValues",s.selectedSize);s.valuesDisplayString=i}else{var r=0;for(;r<s.values.length&&r<5;r++){r>0&&(i+=", ");i+=s.values[r].strValue}5===r&&s.values.length>5&&(i+=a.get("odag.toolbar.navpoint.popup.request.tab.moreSelectedValues",[s.values.length-5+""]));s.valuesDisplayString=i}}return t}function l(t,i){var r=new Date(t.modifiedDate);var l=s.getFlag("ODAG_SAAS_ENABLED");function c(t){var e="";if(Intl&&Intl.DateTimeFormat){var i={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"};e=Intl.DateTimeFormat(n.locale.get(),i).format(t)}else e=n.format.date(t,{datetime:"medium"});return e}var u=c(r);var d=null;if(t.loadState&&t.loadState.finishedAt&&"pending"!==t.loadState.status){var p=new Date(t.loadState.finishedAt);d=c(p)}var h="";var f=false;var g="";var v="lui-icon--bin";var m=a.get("odag.toolbar.navpoint.popup.tooltip.delete");var b=[];var y=[];var S=[];g=t.generatedAppOrigName?t.generatedAppOrigName:"";t.generatedApp&&t.generatedApp.name&&(g=t.generatedApp.name);t.validation&&t.validation.contents&&t.validation.contents.forEach(function(t){b.push({id:b.length,message:t});y.push({id:y.length,message:t})});if(!l&&t.loadState&&t.loadState.messages&&t.loadState.messages.progressData){t.loadState.messages.progressData.persistentProgressMessages&&t.loadState.messages.progressData.persistentProgressMessages.forEach(function(t){y.push({id:y.length,message:e.translateMessage(t)})});t.loadState.messages.progressData.transientProgressMessage&&y.push({id:y.length,message:e.translateMessage(t.loadState.messages.progressData.transientProgressMessage)});t.loadState.messages.progressData.errorData&&t.loadState.messages.progressData.errorData.forEach(function(t){S.push({id:S.length,message:t.qErrorString})})}l&&S.push({id:y.length,message:t.errorMessage});switch(t.state){case"validating":case"queued":case"loading":case"canceling":f=true;h="";g=g||a.get("odag.toolbar.navpoint.popup.status.generating");v="lui-icon--remove";m=a.get("odag.toolbar.navpoint.popup.tooltip.cancel");if("canceling"==t.state){v="";u=a.get("odag.toolbar.navpoint.popup.status.canceling");d=u;m=""}break;case"failed":h="warning";g=g||a.get("odag.toolbar.navpoint.popup.status.failed");v="lui-icon--remove";m=a.get("odag.toolbar.navpoint.popup.tooltip.remove");break;case"canceled":h="";v="lui-icon--remove";m=a.get("odag.toolbar.navpoint.popup.tooltip.remove");break;case"succeeded":h="";g=t.generatedApp?t.generatedApp.name:"";v="lui-icon--bin";m=a.get("odag.toolbar.navpoint.popup.tooltip.delete");break}var I={value:false};t.selectionState&&o(t.selectionState,I);var x={name:g,createdDate:t.createdDate,requestId:t.id,owner:t.owner,lastLoadedTime:d,generatedAppId:t.generatedApp?t.generatedApp.id:null,published:!!t.generatedApp&&t.generatedApp.published,publishToStreamName:t.publishToStreamName?t.publishToStreamName:a.get("odag.toolbar.navpoint.popup.request.tab.info.notPublished"),targetSheet:t.targetSheet,timestamp:u,status:h,state:t.state,loading:f,parentContext:i,deleteIcon:v,deleteIconTooltip:m,actionInProgress:false,statusMessageArray:y,selectionsState:t.selectionState,canApplySelections:I.value,progressErrors:S};return x}function c(e){var n=new Image;var a=e.templateThumbnail;if(a){n.src=a;n.onerror=function(){e.imgSrc=i.staticSrc().staticApp()};n.onload=function(){t(function(){e.imgSrc=a})}}}r={createGeneratedAppWrapper:l,updateImageOnItemHeader:c,getSelectedValuesDisplayString:o};return r}])}.apply(e,i),void 0!==a&&(t.exports=a))},976:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(11),n(91),n(49),n(13),n(316),n(977),n(978),n(979),n(323)],a=function(t,e,n,i,a,s,r,o,l){t.nativeComponent("odagAppList2",{bindings:{applist:"<",loading:"<",deleteClicked:"<",isGenerateBtnDisabled:"<",canApplySelectionsForReload:"<",isHeaderInvalid:"<",loadGeneratedApps:"<",setSelectionState:"<",expandedItemSelectionState:"<",onApplySelectionsCallback:"<",openAppCallback:"<",reloadApp:"<",generateAppInProgress:"=",expandedItem:"=",variant:"@"},controller:["$element","$timeout","luiPopover","odagNavpointService",function(t,l,c,u){var d=this;d.helpTextNoGeneratedApps=n.get("odag.toolbar.navpoint.popup.noApps");d.selectedTab="info";d.moreMenuPopup=null;d.moreMenuPopupItem=null;d.reloadMenuPopup=null;d.inputName="";d.appNameValid=true;d.applyInProgress=false;d.isOdagSaas=i.getFlag("ODAG_SAAS_ENABLED");d.openAppClicked=function(t,n,i){n.preventDefault();n.stopPropagation();if(t.openAppCallback&&e.isFunction(t.openAppCallback))t.openAppCallback(i.generatedAppId,i.targetSheet?i.targetSheet:null);else if(i.generatedAppId&&u.ODAG_TERMINAL_STATES.indexOf(i.state)>-1){var s;s=i.targetSheet?a.rootPath+"sense/app/"+i.generatedAppId+"/sheet/"+i.targetSheet:a.rootPath+"sense/app/"+i.generatedAppId;window.open(s)}};d.renameGenApp=function(t,e){u.renameGenApp(d.expandedItem.item.parentContext.app,t,e).then(function(){d.loadGeneratedApps()})};d.applySelectionsClicked=function(t){d.applyInProgress=true;u.applySelections(t).then(function(){d.onApplySelectionsCallback&&d.onApplySelectionsCallback();d.applyInProgress=false})};d.$doCheck=function(){var t=this;if(this.applist&&this.expandedItem.item){var e=this.applist.filter(function(e){return e.requestId===t.expandedItem.item.requestId})[0];if(e){this.expandedItem.item=e;if(this.expandedItemSelectionState&&this.isOdagSaas){this.expandedItem.item.selectionsState=this.expandedItemSelectionState;this.expandedItem.item.canApplySelections=true}}else this.expandedItem.item=null}d.expandedItem&&d.expandedItem.item&&d.requestInProgress(this.expandedItem.item)&&d.applist.some(function(t){if(t.requestId===d.expandedItem.item.requestId&&t.name===d.expandedItem.item.name&&d.inputName!==t.name){d.inputName=t.name;return true}return false})};d.moreMenuClicked=function(t,e){t.preventDefault();t.stopPropagation();if(d.moreMenuPopup)d.moreMenuPopup.close();else{d.moreMenuPopupItem=e;d.moreMenuPopup=c.show({template:r,alignTo:t.target,variant:null,controller:["$scope",function(t){t.canOpenApp=function(){return e.generatedAppId&&u.ODAG_TERMINAL_STATES.indexOf(e.state)>-1};t.openApp=function(n){if(t.canOpenApp()){d.moreMenuPopup.close();d.openAppClicked(d,n,e)}};t.canReloadApp=function(){return d.canReloadApp(e)};t.reloadApp=function(n){n.preventDefault();n.stopPropagation();if(t.canReloadApp()){d.moreMenuPopup.close();return d.reloadApp(e)}};t.deleteApp=function(t){t.preventDefault();t.stopPropagation();d.moreMenuPopup.close();d.deleteClicked(t,e)}}],closeOnResize:true,closeOnEscape:true});d.moreMenuPopup.closed.then(function(){d.moreMenuPopup=null;d.moreMenuPopupItem=null})}};d.onOutsideClick=function(){d.expandedItem.item=null};d.rowClicked=function(t){d.moreMenuPopup&&d.moreMenuPopup.close();d.reloadMenuPopup&&d.reloadMenuPopup.close();d.expandedItem.item=t;if(d.expandedItem.item){d.inputName=d.expandedItem.item.name;d.setSelectionState()}};d.reloadClicked=function(t,e){t.preventDefault();t.stopPropagation();d.reloadApp(e)};d.requestInProgress=function(t){var e=false;switch(t.state){case u.ODAG_STATE.VALIDATING:case u.ODAG_STATE.QUEUED:case u.ODAG_STATE.LOADING:case u.ODAG_STATE.CANCELING:e=true;break}return e};d.canReloadApp=function(t){var e=true;e=t&&!d.isHeaderInvalid&&!d.generateAppInProgress&&!d.requestInProgress(t);return e};d.validateAppName=function(){var t=true;d.inputName&&s.allowedChars(d.inputName)||(t=false);d.appNameValid=t};d.statusClicked=function(t,e){t.preventDefault();t.stopPropagation();d.moreMenuPopup&&d.moreMenuPopup.close();d.reloadMenuPopup&&d.reloadMenuPopup.close();if(d.expandedItem.item===e)d.expandedItem.item=null;else{d.selectedTab="status";d.expandedItem.item=e;d.scrollIfNecessary()}};d.selectTab=function(t){d.selectedTab=t;d.scrollIfNecessary()};d.inputKeyEnter=function(t){var e=t.target;e.blur()};d.onBlurGenAppName=function(){if(d.appNameValid)d.renameGenApp(d.expandedItem.item.requestId,d.inputName);else{d.inputName=d.expandedItem.item.name;d.validateAppName()}};d.scrollIfNecessary=function(){"status"===d.selectedTab&&l(function(){var n=e(t.find(".tab-contents"));n.scrollTop(n[0].scrollHeight)})};d.onReloadMenuClicked=function(t,e){t.preventDefault();t.stopPropagation();if(d.reloadMenuPopup)d.reloadMenuPopup.close();else{d.reloadMenuPopup=c.show({template:o,alignTo:t.target,variant:null,controller:["$scope",function(t){t.canReloadApp=function(){return d.canReloadApp(e)};t.reloadApp=function(n){n.preventDefault();n.stopPropagation();if(t.canReloadApp()){d.reloadMenuPopup.close();return d.reloadApp(e)}};t.canApplySelectionsReloadApp=function(){return d.canApplySelectionsForReload()};t.canCopyApplySelectionsReloadApp=function(){return!d.isGenerateBtnDisabled()};t.applySelectionsReloadApp=function(n){n.preventDefault();n.stopPropagation();if(t.canApplySelectionsReloadApp()){d.reloadMenuPopup.close();d.reloadApp(e,1)}};t.copyApplySelectionsReloadApp=function(n){n.preventDefault();n.stopPropagation();if(t.canApplySelectionsReloadApp()){d.reloadMenuPopup.close();d.reloadApp(e,2)}}}],closeOnResize:true,closeOnEscape:true});d.reloadMenuPopup.closed.then(function(){d.reloadMenuPopup=null})}}}],template:l})}.apply(e,i),void 0!==a&&(t.exports=a))},977:function(t,e){t.exports='<lui-popover x-variant="{{::variant}}" x-arrow="arrow" qva-outside-ignore-for="allOutside">\n\t<lui-popover-body class="lui-nopad">\n\t\t<ul class="lui-list odag-request-menu" tid="odag-request-menu">\n\t\t\t<li class="lui-list__item" style="cursor: pointer" ng-disabled="!canOpenApp()" ng-click="openApp( $event )" tid="openAppFromMenu">\n\t\t\t\t<span class="lui-list__text lui-list__action"\n\t\t\t\t\tq-translation="odag.toolbar.navpoint.popup.request.menu.openApp">\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item" style="cursor: pointer" ng-disabled="!canReloadApp()" ng-click="reloadApp( $event )" tid="reloadFromRequestMenu">\n\t\t\t\t<span class="lui-list__text lui-list__action"\n\t\t\t\t\tq-translation="odag.toolbar.navpoint.popup.request.reload">\n\t\t\t\t</span>\n\t\t\t</li>\t\t\t\n\t\t\t<li class="lui-list__item" style="cursor: pointer" ng-click="deleteApp( $event )" tid="deleteAppFromMenu">\n\t\t\t\t<span class="lui-list__text lui-list__action"\n\t\t\t\t\tq-translation="odag.toolbar.navpoint.popup.request.menu.deleteApp">\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t</ul>\n\t</lui-popover-body>\n</lui-popover>'},978:function(t,e){t.exports='<lui-popover x-variant="{{::variant}}" x-arrow="arrow" qva-outside-ignore-for="allOutside">\n\t<lui-popover-body class="lui-nopad">\n\t\t<ul class="lui-list odag-request-menu" tid="odag-request-reload-menu">\n\t\t\t<li class="lui-list__item" style="cursor: pointer" ng-disabled="!canReloadApp()" ng-click="reloadApp( $event )" tid="reloadFromMenu">\n\t\t\t\t<span class="lui-list__text lui-list__action"\n\t\t\t\t\tq-translation="odag.toolbar.navpoint.popup.request.reload">\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item" style="cursor: pointer" ng-disabled="!canApplySelectionsReloadApp()" ng-click="applySelectionsReloadApp( $event )" tid="applySelectionsReloadFromMenu">\n\t\t\t\t<span class="lui-list__text lui-list__action"\n\t\t\t\t\tq-translation="odag.toolbar.navpoint.popup.request.applySelections.reload">\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t<li class="lui-list__item" style="cursor: pointer" ng-disabled="!canCopyApplySelectionsReloadApp()" ng-click="copyApplySelectionsReloadApp( $event )" tid="copyApplySelectionsReloadFromMenu">\n\t\t\t\t<span class="lui-list__text lui-list__action"\n\t\t\t\t\tq-translation="odag.toolbar.navpoint.popup.request.copyAndApplySelections.reload">\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t</ul>\n\t</lui-popover-body>\n</lui-popover>'},979:function(t,e){t.exports='<div class="odag-app-list2" ng-class="$ctrl.variant">\n\t<div ng-if="$ctrl.applist.length === 0 && !$ctrl.loading" class="description">{{$ctrl.helpTextNoGeneratedApps}}</div>\n\t<ul ng-if="$ctrl.applist.length && !$ctrl.loading && !$ctrl.expandedItem.item" class="generated-apps-list">\n\t\t<li ng-repeat="genAppitem in $ctrl.applist" class="list-item" ng-click="$ctrl.rowClicked(genAppitem)">\n\t\t\t<div class="generated-app-item request-header">\n\t\t\t\t<div class="request-first">\n\t\t\t\t\t<div class="expander lui-icon lui-icon--triangle-right"></div>\n\t\t\t\t\t<div class="request-name-timestamp-area">\n\t\t\t\t\t\t<div class="request-first-top-line">\t\t\t\t\t\t\n\t\t\t\t\t\t\t<div class="name" title="{{genAppitem.name}}" ng-class="{\'generating\': genAppitem.state === \'validating\' || genAppitem.state === \'queued\' || genAppitem.state === \'loading\' || genAppitem.state === \'canceling\'}">{{genAppitem.name}}</div>\n\t\t\t\t\t\t</div>\t\n\t\t\t\t\t\t<div class="request-first-bottom-line timestamp">{{genAppitem.lastLoadedTime ? genAppitem.lastLoadedTime : genAppitem.timestamp }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="request-second">\n\t\t\t\t\t<button class="status-button lui-fade-button" qva-outside-ignore-for="allOutside" ng-click="$ctrl.statusClicked($event, genAppitem)">\n\t\t\t\t\t\t<span ng-hide="genAppitem.loading" class="lui-fade-button__icon lui-icon lui-icon--{{genAppitem.status}}"></span>\n\t\t\t\t\t\t<div ng-if="genAppitem.loading" class="genAppLoading qv-loader"></div>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button ng-if="genAppitem.state === \'validating\' || genAppitem.state === \'queued\' || genAppitem.state === \'loading\'" class="lui-fade-button" title={{genAppitem.deleteIconTooltip}} ng-click="$ctrl.deleteClicked($event, genAppitem)">\n\t\t\t\t\t  <span class="lui-fade-button__icon  lui-icon lui-icon--remove"></span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button ng-if="!$ctrl.requestInProgress( genAppitem )" class="lui-fade-button" q-title-translation="odag.toolbar.navpoint.popup.request.moreMenu.tooltip" ng-click="$ctrl.moreMenuClicked($event, genAppitem)" ng-class="{\'lui-active\': $ctrl.moreMenuPopupItem === genAppitem}">\n\t\t\t\t\t  <span class="lui-fade-button__icon  lui-icon lui-icon--more"></span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button ng-if="!$ctrl.requestInProgress( genAppitem )" ng-disabled="!(genAppitem.state === \'succeeded\' || genAppitem.state === \'failed\' || genAppitem.state === \'canceled\') || !genAppitem.generatedAppId" class="lui-fade-button" q-title-translation="{{ $ctrl.openAppCallback ? \'odag.toolbar.navpoint.popup.request.openApp.generic.tooltip\' : \'odag.toolbar.navpoint.popup.request.openApp.tooltip\'}}" ng-click="$ctrl.openAppClicked($ctrl, $event, genAppitem)">\n\t\t\t\t\t  <span class="lui-fade-button__icon  lui-icon lui-icon--new-tab"></span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\t\t\t\n\t\t</li>\n\t</ul>\n\t<div ng-if="$ctrl.expandedItem.item" class="gen-item-expand" qva-outside="$ctrl.onOutsideClick( $event )">\n\t\t<div class="details-container">\n\t\t\t<div class="request-header" ng-click="$ctrl.rowClicked(null)">\n\t\t\t\t<div class="request-first">\n\t\t\t\t\t<div class="expander lui-icon lui-icon--triangle-bottom" tid="odag-applist-expand"></div>\n\t\t\t\t\t<div class="request-name-timestamp-area">\n\t\t\t\t\t\t<div class="request-first-top-line">\n\t\t\t\t\t\t\t<div class="name" title="{{$ctrl.expandedItem.item.name}}" ng-class="{\'generating\': $ctrl.expandedItem.item.state === \'validating\' || $ctrl.expandedItem.item.state === \'queued\' || $ctrl.expandedItem.item.state === \'loading\' || $ctrl.expandedItem.item.state === \'canceling\'}">{{$ctrl.expandedItem.item.name}}</div>\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="request-first-bottom-line timestamp" >{{$ctrl.expandedItem.item.lastLoadedTime ? $ctrl.expandedItem.item.lastLoadedTime : $ctrl.expandedItem.item.timestamp }}</div>\n\t\t\t\t\t</div>\t\t\t\t\n\t\t\t\t</div>\n\t\t\t\t<div class="request-second">\n\t\t\t\t\t<button class="status-button lui-fade-button" qva-outside-ignore-for="allOutside" ng-click="$ctrl.statusClicked($event, $ctrl.expandedItem.item)">\n\t\t\t\t\t\t<span ng-if="!$ctrl.expandedItem.item.loading" class="lui-fade-button__icon lui-icon lui-icon--{{$ctrl.expandedItem.item.status}}"></span>\n\t\t\t\t\t\t<div ng-if="$ctrl.expandedItem.item.loading" class="genAppLoading qv-loader"></div>\n\t\t\t\t\t</button>\t\t\t\t\t\t\t\t\n\t\t\t\t\t<button ng-if="$ctrl.expandedItem.item.state === \'validating\' || $ctrl.expandedItem.item.state === \'queued\' || $ctrl.expandedItem.item.state === \'loading\'" class="lui-fade-button" title={{$ctrl.expandedItem.item.deleteIconTooltip}} ng-click="$ctrl.deleteClicked($event, $ctrl.expandedItem.item)">\n\t\t\t\t\t  <span class="lui-fade-button__icon  lui-icon lui-icon--remove"></span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button ng-if="$ctrl.expandedItem.item.state === \'succeeded\' || $ctrl.expandedItem.item.state === \'failed\' || $ctrl.expandedItem.item.state === \'canceled\'" class="lui-fade-button" q-title-translation="{{ $ctrl.openAppCallback ? \'odag.toolbar.navpoint.popup.request.openApp.generic.tooltip\' : \'odag.toolbar.navpoint.popup.request.openApp.tooltip\'}}" ng-disabled="!($ctrl.expandedItem.item.state === \'succeeded\' || $ctrl.expandedItem.item.state === \'failed\' || $ctrl.expandedItem.item.state === \'canceled\') || !$ctrl.expandedItem.item.generatedAppId" ng-click="$ctrl.openAppClicked($ctrl, $event, $ctrl.expandedItem.item)">\n\t\t\t\t\t  <span class="lui-fade-button__icon  lui-icon lui-icon--new-tab"></span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\t\n\t\t\t</div>\n\t\t\t<div class="generateAppInput">\n\t\t\t\t<input class="lui-input" ng-disabled="$ctrl.generateAppInProgress || !$ctrl.expandedItem.item.generatedAppId || $ctrl.expandedItem.item.state === \'queued\' || $ctrl.expandedItem.item.state === \'loading\' || $ctrl.expandedItem.item.state === \'validating\' || $ctrl.expandedItem.item.state === \'canceling\'" ng-model="$ctrl.inputName" type="text" name="name" maxlength="255" ng-blur="$ctrl.onBlurGenAppName()" ng-change="$ctrl.validateAppName()" qv-enter="$ctrl.inputKeyEnter($event)" ng-class="{ \'lui-invalid\': !$ctrl.appNameValid }"/>\n\t\t\t</div>\n\t\t\t<div class="action-button-section">\n\t\t\t\t<div class="lui-buttongroup reload-button">\n\t\t\t\t\t<lui-button ng-disabled="!$ctrl.canReloadApp( $ctrl.expandedItem.item )" ng-click="$ctrl.reloadClicked($event, $ctrl.expandedItem.item)" q-translation="odag.toolbar.navpoint.popup.request.reload"></lui-button>\n\t\t\t\t\t<lui-button ng-disabled="!$ctrl.canReloadApp( $ctrl.expandedItem.item ) " class= "reload-drop" tid="odag-reload-dropdown"\n ng-click="$ctrl.onReloadMenuClicked( $event, $ctrl.expandedItem.item )">\n\t\t\t\t\t\t<span class="lui-icon lui-caret"></span>\t\t\t\t\t\t\n\t\t\t\t\t</lui-button>\n\t\t\t\t</div>\n\t\t\t\t<lui-button ng-disabled="$ctrl.expandedItem.item.state !== \'succeeded\' && $ctrl.expandedItem.item.state !== \'failed\' && $ctrl.expandedItem.item.state !== \'canceled\' " tid="odag-applist-delete-app" class="delete-button" ng-click="$ctrl.deleteClicked($event, $ctrl.expandedItem.item)" ><span class="lui-icon  lui-button__icon lui-icon--bin"></span></lui-button>\n\t\t\t</div>\n\n\t\t\t<div class="tab-section">\n\t\t\t\t<div class="tab-header">\n\t\t\t\t\t<ul class="lui-tabset lui-tabset--fill">\n\t\t\t\t\t\t<li class="lui-tab" tabindex="0" ng-class="{\'lui-active\': $ctrl.selectedTab === \'info\' }" ng-click="$ctrl.selectTab(\'info\')">\n\t\t\t\t\t\t\t<span class="lui-tab__text tab-label" q-translation="odag.toolbar.navpoint.popup.request.tab.info"></span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class="lui-tab" tabindex="0" ng-class="{\'lui-active\': $ctrl.selectedTab === \'selections\' }" ng-click="$ctrl.selectTab(\'selections\')">\n\t\t\t\t\t\t\t<span class="lui-tab__text tab-label" q-translation="odag.toolbar.navpoint.popup.request.tab.selections"></span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class="lui-tab" tabindex="0" ng-class="{\'lui-active\': $ctrl.selectedTab === \'status\' }" ng-click="$ctrl.selectTab(\'status\')">\n\t\t\t\t\t\t\t<span class="lui-tab__text tab-label" q-translation="odag.toolbar.navpoint.popup.request.tab.status"></span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t\t<div class="tab-contents">\n\t\t\t\t\t<div class="tab-content selection-tab" ng-if="$ctrl.selectedTab === \'selections\'">\n\t\t\t\t\t\t<div class="info-section selection-tab-top">\n\t\t\t\t\t\t\t<div class="info-text" q-translation="odag.toolbar.navpoint.popup.request.tab.selections.helpText"></div>\n\t\t\t\t\t\t\t<div class="apply-selections-button">\n\t\t\t\t\t\t\t\t<lui-button ng-disabled="($ctrl.expandedItem.item.state !== \'succeeded\' && $ctrl.expandedItem.item.state !== \'failed\' && $ctrl.expandedItem.item.state !== \'canceled\') || $ctrl.applyInProgress" ng-if="$ctrl.expandedItem.item.canApplySelections" ng-click="$ctrl.applySelectionsClicked($ctrl.expandedItem.item)" q-translation="Common.Apply"></lui-button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="selections-field-header">\n\t\t\t\t\t\t\t<div class="selections-field" q-translation="odag.toolbar.navpoint.popup.request.tab.selections.field"></div>\n\t\t\t\t\t\t\t<div class="selections-value" q-translation="odag.toolbar.navpoint.popup.request.tab.selections.values"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="selections-field-values">\n\t\t\t\t\t\t\t<div ng-if="$ctrl.expandedItem.item.selectionsState && $ctrl.expandedItem.item.selectionsState.length" ng-repeat="selection in $ctrl.expandedItem.item.selectionsState" class="selections-field-row">\n\t\t\t\t\t\t\t\t<div class="selections-field-data">{{selection.selectionAppParamName}}</div>\n\t\t\t\t\t\t\t\t<div class="selections-value-data">{{selection.valuesDisplayString}}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div ng-if="!$ctrl.expandedItem.item.selectionsState" q-translation="odag.toolbar.navpoint.popup.request.tab.noSelectedValues"> </div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="selections-no-selections" ng-if="$ctrl.expandedItem.item.selectionsState && $ctrl.expandedItem.item.selectionsState.length === 0" q-translation="odag.toolbar.navpoint.popup.request.tab.selections.noselections" >\n\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="tab-content" ng-if="$ctrl.selectedTab === \'info\'">\n\t\t\t\t\t\t<div class="info-section">\n\t\t\t\t\t\t\t<div class="info-section-label" q-translation="odag.toolbar.navpoint.popup.request.tab.info.status"></div>\n\t\t\t\t\t\t\t<div class="info-section-value" q-translation="odag.toolbar.navpoint.popup.request.tab.status.{{$ctrl.expandedItem.item.state}}"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="info-section">\n\t\t\t\t\t\t\t<div class="info-section-label" q-translation="odag.toolbar.navpoint.popup.request.tab.info.appOwner"></div>\n\t\t\t\t\t\t\t<div ng-if="!$ctrl.isOdagSaas" class="info-section-value">{{$ctrl.expandedItem.item.owner.userDirectory}}\\{{$ctrl.expandedItem.item.owner.userId}} ({{$ctrl.expandedItem.item.owner.name}})</div>\n\t\t\t\t\t\t\t<div ng-if="$ctrl.isOdagSaas" class="info-section-value">({{$ctrl.expandedItem.item.owner.name}})</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="info-section" ng-if="!$ctrl.isOdagSaas">\n\t\t\t\t\t\t\t<div class="info-section-label" q-translation="odag.toolbar.navpoint.popup.request.tab.info.publishToStream"></div>\n\t\t\t\t\t\t\t<div class="info-section-value"> {{$ctrl.expandedItem.item.publishToStreamName}} </div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="tab-content odag-request-status-content" ng-if="$ctrl.selectedTab === \'status\'">\n\t\t\t\t\t\t<div class="info-section">\n\t\t\t\t\t\t\t<div class="info-section-label" q-translation="odag.toolbar.navpoint.popup.request.tab.info.lastCompletedRun"></div>\n\t\t\t\t\t\t\t<div class="info-section-value">{{$ctrl.expandedItem.item.lastLoadedTime ? $ctrl.expandedItem.item.lastLoadedTime : \'Common.None\' | translate }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-repeat="message in $ctrl.expandedItem.item.statusMessageArray" class="info-field-row" ng-if="$ctrl.expandedItem.item.statusMessageArray.length" ng-bind="message.message"></div>\n\t\t\t\t\t\t<div ng-repeat="error in $ctrl.expandedItem.item.progressErrors" class="info-field-row info-field-row-error" ng-if="$ctrl.expandedItem.item.progressErrors.length" ng-bind="error.message"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'},980:function(t,e,n){"use strict";var i,a;!(i=[n(48),n(981)],a=function(t,e){t.directive("qvProgressCircle",function(){return{scope:{percentage:"="},restrict:"E",template:e,link:function t(e,n){function i(){var t=e.percentage;var i=n.find(".progress-circle-svg .bar");var a=i.attr("r");var s=Math.PI*(2*a);if(Number.isNaN(+t)){t=100;i.css({strokeDashoffset:s,fill:"#CCCCCC"})}else{t<0&&(t=0);t>100&&(t=100);var r=(100-t)/100*s;i.css({strokeDashoffset:r});100===e.percentage?i.css({fill:"#61a729"}):i.css({fill:"transparent"})}}e.$watch("percentage",i)},controller:["$scope",function(t){t.$on("$destroy",function(){})}]}})}.apply(e,i),void 0!==a&&(t.exports=a))},981:function(t,e){t.exports='<div class="progress-circle-container" ng-class="{\'full\': percentage === 100}">\n\t<svg class="progress-circle-svg" viewPort="0 0 0 0">\n\t\t<circle class="baseCircle" r="6" cx="8px" cy="8px" fill="transparent" stroke-dasharray="37.699" stroke-dashoffset="0"></circle>\n\t\t<circle class="whiteBar" r="6" cx="8px" cy="8px" fill="transparent" stroke-dasharray="37.699" stroke-dashoffset="0"></circle>\n\t\t<circle class="bar" r="6" cx="8px" cy="8px" fill="transparent" stroke-dasharray="37.699" stroke-dashoffset="0"></circle>\n\t</svg>\n</div>\n'}}]);